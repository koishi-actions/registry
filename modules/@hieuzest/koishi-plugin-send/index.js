var _=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var S=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var b=(e,t)=>()=>(e&&(t=e(e=0)),t);var k=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var l=(e,t,a,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of S(t))!C.call(e,s)&&s!==a&&_(e,s,{get:()=>t[s],enumerable:!(r=x(t,s))||r.enumerable});return e},c=(e,t,a)=>(l(e,t,"default"),a&&l(a,t,"default"));var D=e=>l(_({},"__esModule",{value:!0}),e);import{Buffer as v}from"https://registry.koishi.chat/modules/buffer/index.js";import m from"https://registry.koishi.chat/modules/process/index.js";var f=b(()=>{});var o={};import*as L from"https://registry.koishi.chat/modules/koishi/index.js";var P=b(()=>{f();c(o,L)});var A=k((Q,M)=>{f();var p=Object.defineProperty,I=Object.getOwnPropertyDescriptor,N=Object.getOwnPropertyNames,$=Object.prototype.hasOwnProperty,d=(e,t)=>p(e,"name",{value:t,configurable:!0}),q=(e,t)=>{for(var a in t)p(e,a,{get:t[a],enumerable:!0})},B=(e,t,a,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of N(t))!$.call(e,s)&&s!==a&&p(e,s,{get:()=>t[s],enumerable:!(r=I(t,s))||r.enumerable});return e},J=e=>B(p({},"__esModule",{value:!0}),e),h={};q(h,{default:()=>z});M.exports=J(h);var W=(P(),D(o));function g(e){let t,a;if(typeof e=="string"){let r=e.indexOf(":",e.startsWith("sandbox:")?8:0);t=e.slice(0,r),a=e.slice(r+1)}else{let{}={platform:t,channelId:a}=e}return[t,a]}d(g,"parsePlatform");var u=class{static{d(this,"Send")}static filter=!1;static inject=["database"];constructor(e){e.set("sendPrivateMessage",y),e.set("sendMessage",w)}};async function y(e,t,a={}){let r,[s,i]=g(e);if(s.includes(":")&&(r=this.bots[s]),r||(r=this.bots.find(n=>n.platform===s)),r=await this.serial("send/sendPrivateMessage",this,r,{platform:s,channelId:i},t,a)||r,r)return await r.sendPrivateMessage(i,t,"",a)}d(y,"sendPrivateMessage");async function w(e,t,a,r={}){let s,[i,n]=g(e);if(i.includes(":")&&(s=this.bots[i]),!s){let{assignee:O}=await this.database.getChannel(i,n,["assignee"])||{};s||=this.bots[`${i}:${O}`],s||=this.bots.find(j=>j.platform===i)}if(s=await this.serial("send/sendMessage",this,s,{platform:i,channelId:n},t,a,r)||s,s)return await s.sendMessage(n,t,a,r)}d(w,"sendMessage");(e=>{e.Config=W.Schema.object({})})(u||(u={}));var z=u});export default A();
