import{Buffer as b}from"https://registry.koishi.chat/modules/buffer/index.js";import y from"https://registry.koishi.chat/modules/process/index.js";var x=Object.defineProperty,_=Object.getOwnPropertyNames,$=(e,t,n)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,j=(e,t)=>x(e,"name",{value:t,configurable:!0}),E=(e,t)=>function(){return t||(0,e[_(e)[0]])((t={exports:{}}).exports,t),t.exports},R=(e,t,n)=>($(e,typeof t!="symbol"?t+"":t,n),n),M=E({"packages/inaba/src/index.ts"(e,t){var n=class{constructor(r=Math.random){this.get=r}id(r=8,s=16){let f="";for(let u=0;u<r;++u)f+=n.chars[Math.floor(Math.random()*s)];return f}bool(r){return r>=1?!0:r<=0?!1:this.get()<r}real(...r){let s=r.length>1?r[0]:0,f=r[r.length-1];return this.get()*(f-s)+s}int(...r){return Math.floor(this.real(...r))}splice(r){return r.splice(Math.floor(this.get()*r.length),1)[0]}pick(r,s){if(s===void 0)return this.pick(r,1)[0];let f=r.slice(),u=[];s=Math.min(f.length,s);for(let p=0;p<s;p+=1)u.push(this.splice(f));return u}shuffle(r){return this.pick(r,r.length)}weightedPick(r){let s=Object.entries(r).reduce((p,[,O])=>p+O,0),f=this.get()*s,u=0;for(let p in r)if(u+=r[p],f<u)return p}},i=n;j(i,"Random"),R(i,"chars","0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");var o=new i;for(let r of["id","bool","int","real","splice","pick","shuffle","weightedPick"])i[r]=o[r].bind(o);t.exports=i}}),N=M();import{is as re}from"https://registry.koishi.chat/modules/cosmokit/index.js";export*from"https://registry.koishi.chat/modules/cosmokit/index.js";import{defineProperty as l,is as J,noop as K}from"https://registry.koishi.chat/modules/cosmokit/index.js";var D=Object.defineProperty,c=(e,t)=>D(e,"name",{value:t,configurable:!0});function A(e){return typeof e=="number"&&Math.floor(e)===e}c(A,"isInteger");async function S(e){return new Promise(t=>setTimeout(t,e))}c(S,"sleep");function I(e){return Object.values(e).filter(t=>typeof t=="string")}c(I,"enumKeys");function W(e,t,n){e[t]=n,e[n]=t}c(W,"defineEnumProperty");function v(e,t){return Object.entries(t).forEach(([n,i])=>{if(typeof e[n]>"u")return e[n]=t[n];typeof i=="object"&&typeof e[n]=="object"&&(e[n]=v(e[n],i))}),e}c(v,"merge");function q(e,t){if(!e[t])throw new Error(`missing configuration "${t}"`);return e[t]}c(q,"assertProperty");function F(e){let{message:t,stack:n}=e instanceof Error&&e.stack?e:new Error(e),i=n.split(`
`),o=i.findIndex(r=>r.endsWith(t));return i.slice(o).join(`
`)}c(F,"coerce");function T(e,t,n){e[t]=Reflect.get(e,n),Reflect.deleteProperty(e,n)}c(T,"renameProperty");function B(e,t){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}c(B,"extend");var d=["number","string","bigint","boolean","symbol","function"],V=["Date","RegExp","Set","Map","WeakSet","WeakMap","Array"];function m(e,t){return J("Date",e)?w(e,t):Array.isArray(e)?g(e,t):h(e,t)}c(m,"observeProperty");function a(e){return typeof e=="symbol"||e.startsWith("$")}c(a,"untracked");function h(e,t){let n=t;if(!t){let o=Object.create(null);l(e,"$diff",o),t=c(r=>{a(r)||(o[r]=e[r])},"notify")}return new Proxy(e,{get(o,r){let s=Reflect.get(o,r);return!s||d.includes(typeof s)||a(r)?s:m(s,n||(()=>t(r)))},set(o,r,s){let f=o[r]===s,u=Reflect.set(o,r,s);return f||!u?u:(t(r),!0)},deleteProperty(o,r){let s=!(r in o),f=Reflect.deleteProperty(o,r);return s||!f?f:(t(r),!0)}})}c(h,"observeObject");var z=["pop","shift","splice","sort"];function g(e,t){let n={};for(let i of z)l(e,i,function(...o){return t(),Array.prototype[i].apply(this,o)});return new Proxy(e,{get(i,o){if(o in n)return n[o];let r=i[o];return!r||d.includes(typeof r)||typeof o=="symbol"||isNaN(o)?r:m(r,t)},set(i,o,r){return typeof o!="symbol"&&!isNaN(o)&&i[o]!==r&&t(),Reflect.set(i,o,r)}})}c(g,"observeArray");function w(e,t){for(let n of Object.getOwnPropertyNames(Date.prototype))n!=="valueOf"&&l(e,n,function(...i){let o=e.valueOf(),r=Date.prototype[n].apply(this,i);return e.valueOf()!==o&&t(),r});return e}c(w,"observeDate");function C(e,...t){if(d.includes(typeof e))throw new Error(`cannot observe immutable type "${typeof e}"`);if(!e)throw new Error("cannot observe null or undefined");let n=Object.prototype.toString.call(e).slice(8,-1);if(V.includes(n))throw new Error(`cannot observe instance of type "${n}"`);let i=K;typeof t[0]=="function"&&(i=t.shift());let o=h(e,null);return l(o,"$update",c(function(){let s={...this.$diff};if(Object.keys(s).length){for(let u in this.$diff)delete this.$diff[u];return i(s)}},"$update")),l(o,"$merge",c(function(s){for(let f in s){if(f in this.$diff)throw new Error(`unresolved diff key "${f}"`);e[f]=s[f]}return this},"$merge")),o}c(C,"observe");var P=new Function("context","expr",`
  try {
    with (context) {
      return eval(expr)
    }
  } catch {}
`);function G(e,t,n=/\{\{([\s\S]+?)\}\}/g){let i,o="",r=0;for(;i=n.exec(e);){if(i[0]===e)return P(t,i[1]);o+=e.slice(r,i.index),o+=P(t,i[1])??"",r=i.index+i[0].length}return o+e.slice(r)}c(G,"interpolate");function H(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}c(H,"escapeRegExp");export{N as Random,q as assertProperty,F as coerce,W as defineEnumProperty,I as enumKeys,H as escapeRegExp,B as extend,G as interpolate,A as isInteger,re as isType,v as merge,C as observe,T as renameProperty,S as sleep};
