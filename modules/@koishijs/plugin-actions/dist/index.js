import{ref as b,computed as W,reactive as _t,defineComponent as at,openBlock as L,createElementBlock as D,createElementVNode as I,withModifiers as X,normalizeClass as Q,createCommentVNode as lt,watch as kt,onMounted as At,resolveComponent as $t,createBlock as et,withCtx as ct,unref as S,Fragment as nt,renderList as it,createVNode as zt,Transition as Lt,withDirectives as Et,normalizeStyle as Tt,toDisplayString as It,vShow as St}from"../vue.js";import{store as rt,icons as Dt}from"../client.js";import{useEventListener as Y,useElementSize as bt}from"../vueuse.js";function J(t){return t.type.startsWith("touch")?[...t.targetTouches,...t.changedTouches][0]:t}function jt(){const t=b(""),e=b(false),n=b(true),i=b(0),r=b(0),s=W(()=>!i.value||!r.value?{display:"none"}:{left:i.value+"px",top:r.value+"px"});function u(v,y){const w=J(y);t.value=v,e.value=true,n.value=false,i.value=w.clientX,r.value=w.clientY}function o(v=0,y=false){n.value=true,setTimeout(()=>{n.value&&(e.value=false,y&&(i.value=null,r.value=null))},v)}Y("mousemove",l),Y("touchmove",l);function l(v){if(n.value)return;const y=J(v);r.value=y.clientY,i.value=y.clientX}return _t({style:s,content:t,active:e,inactive:n,activate:u,deactivate:o})}function Bt(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return dt(this.cover(e,n),e,n,t)}function dt(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,s=t._root,u={data:i},o=t._x0,l=t._y0,v=t._x1,y=t._y1,w,d,f,m,c,a,h,g;if(!s)return t._root=u,t;for(;s.length;)if((c=e>=(w=(o+v)/2))?o=w:v=w,(a=n>=(d=(l+y)/2))?l=d:y=d,r=s,!(s=s[h=a<<1|c]))return r[h]=u,t;if(f=+t._x.call(null,s.data),m=+t._y.call(null,s.data),e===f&&n===m)return u.next=s,r?r[h]=u:t._root=u,t;do r=r?r[h]=new Array(4):t._root=new Array(4),(c=e>=(w=(o+v)/2))?o=w:v=w,(a=n>=(d=(l+y)/2))?l=d:y=d;while((h=a<<1|c)===(g=(m>=d)<<1|f>=w));return r[g]=s,r[h]=u,t}function Ot(t){var e,n,i=t.length,r,s,u=new Array(i),o=new Array(i),l=1/0,v=1/0,y=-1/0,w=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(s=+this._y.call(null,e))||(u[n]=r,o[n]=s,r<l&&(l=r),r>y&&(y=r),s<v&&(v=s),s>w&&(w=s));if(l>y||v>w)return this;for(this.cover(l,v).cover(y,w),n=0;n<i;++n)dt(this,u[n],o[n],t[n]);return this}function Xt(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,s=(i=Math.floor(e))+1;else{for(var u=r-n||1,o=this._root,l,v;n>t||t>=r||i>e||e>=s;)switch(v=(e<i)<<1|t<n,l=new Array(4),l[v]=o,o=l,u*=2,v){case 0:r=n+u,s=i+u;break;case 1:n=r-u,s=i+u;break;case 2:r=n+u,i=s-u;break;case 3:n=r-u,i=s-u;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function Yt(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function Pt(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function $(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function Ft(t,e,n){var i,r=this._x0,s=this._y0,u,o,l,v,y=this._x1,w=this._y1,d=[],f=this._root,m,c;for(f&&d.push(new $(f,r,s,y,w)),n==null?n=1/0:(r=t-n,s=e-n,y=t+n,w=e+n,n*=n);m=d.pop();)if(!(!(f=m.node)||(u=m.x0)>y||(o=m.y0)>w||(l=m.x1)<r||(v=m.y1)<s))if(f.length){var a=(u+l)/2,h=(o+v)/2;d.push(new $(f[3],a,h,l,v),new $(f[2],u,h,a,v),new $(f[1],a,o,l,h),new $(f[0],u,o,a,h)),(c=(e>=h)<<1|t>=a)&&(m=d[d.length-1],d[d.length-1]=d[d.length-1-c],d[d.length-1-c]=m)}else{var g=t-+this._x.call(null,f.data),M=e-+this._y.call(null,f.data),p=g*g+M*M;if(p<n){var k=Math.sqrt(n=p);r=t-k,s=e-k,y=t+k,w=e+k,i=f.data}}return i}function Vt(t){if(isNaN(y=+this._x.call(null,t))||isNaN(w=+this._y.call(null,t)))return this;var e,n=this._root,i,r,s,u=this._x0,o=this._y0,l=this._x1,v=this._y1,y,w,d,f,m,c,a,h;if(!n)return this;if(n.length)for(;;){if((m=y>=(d=(u+l)/2))?u=d:l=d,(c=w>=(f=(o+v)/2))?o=f:v=f,e=n,!(n=n[a=c<<1|m]))return this;if(!n.length)break;(e[a+1&3]||e[a+2&3]||e[a+3&3])&&(i=e,h=a)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):e?(s?e[a]=s:delete e[a],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[h]=n:this._root=n),this):(this._root=s,this)}function Gt(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function qt(){return this._root}function Ht(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function Qt(t){var e=[],n,i=this._root,r,s,u,o,l;for(i&&e.push(new $(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(i=n.node,s=n.x0,u=n.y0,o=n.x1,l=n.y1)&&i.length){var v=(s+o)/2,y=(u+l)/2;(r=i[3])&&e.push(new $(r,v,y,o,l)),(r=i[2])&&e.push(new $(r,s,y,v,l)),(r=i[1])&&e.push(new $(r,v,u,o,y)),(r=i[0])&&e.push(new $(r,s,u,v,y))}return this}function Rt(t){var e=[],n=[],i;for(this._root&&e.push(new $(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var r=i.node;if(r.length){var s,u=i.x0,o=i.y0,l=i.x1,v=i.y1,y=(u+l)/2,w=(o+v)/2;(s=r[0])&&e.push(new $(s,u,o,y,w)),(s=r[1])&&e.push(new $(s,y,o,l,w)),(s=r[2])&&e.push(new $(s,u,w,y,v)),(s=r[3])&&e.push(new $(s,y,w,l,v))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function Wt(t){return t[0]}function Jt(t){return arguments.length?(this._x=t,this):this._x}function Kt(t){return t[1]}function Ut(t){return arguments.length?(this._y=t,this):this._y}function wt(t,e,n){var i=new ut(e??Wt,n??Kt,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function ut(t,e,n,i,r,s){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function ft(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var z=wt.prototype=ut.prototype;z.copy=function(){var t=new ut(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=ft(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var r=0;r<4;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(4)}):e.target[r]=ft(i));return t};z.add=Bt;z.addAll=Ot;z.cover=Xt;z.data=Yt;z.extent=Pt;z.find=Ft;z.remove=Vt;z.removeAll=Gt;z.root=qt;z.size=Ht;z.visit=Qt;z.visitAfter=Rt;z.x=Jt;z.y=Ut;function E(t){return function(){return t}}function P(t){return(t()-.5)*1e-6}function Zt(t){return t.index}function ht(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function te(t){var e=Zt,n=w,i,r=E(30),s,u,o,l,v,y=1;t==null&&(t=[]);function w(a){return 1/Math.min(o[a.source.index],o[a.target.index])}function d(a){for(var h=0,g=t.length;h<y;++h)for(var M=0,p,k,A,_,x,C,N;M<g;++M)p=t[M],k=p.source,A=p.target,_=A.x+A.vx-k.x-k.vx||P(v),x=A.y+A.vy-k.y-k.vy||P(v),C=Math.sqrt(_*_+x*x),C=(C-s[M])/C*a*i[M],_*=C,x*=C,A.vx-=_*(N=l[M]),A.vy-=x*N,k.vx+=_*(N=1-N),k.vy+=x*N}function f(){if(u){var a,h=u.length,g=t.length,M=new Map(u.map((k,A)=>[e(k,A,u),k])),p;for(a=0,o=new Array(h);a<g;++a)p=t[a],p.index=a,typeof p.source!="object"&&(p.source=ht(M,p.source)),typeof p.target!="object"&&(p.target=ht(M,p.target)),o[p.source.index]=(o[p.source.index]||0)+1,o[p.target.index]=(o[p.target.index]||0)+1;for(a=0,l=new Array(g);a<g;++a)p=t[a],l[a]=o[p.source.index]/(o[p.source.index]+o[p.target.index]);i=new Array(g),m(),s=new Array(g),c()}}function m(){if(u)for(var a=0,h=t.length;a<h;++a)i[a]=+n(t[a],a,t)}function c(){if(u)for(var a=0,h=t.length;a<h;++a)s[a]=+r(t[a],a,t)}return d.initialize=function(a,h){u=a,v=h,f()},d.links=function(a){return arguments.length?(t=a,f(),d):t},d.id=function(a){return arguments.length?(e=a,d):e},d.iterations=function(a){return arguments.length?(y=+a,d):y},d.strength=function(a){return arguments.length?(n=typeof a=="function"?a:E(+a),m(),d):n},d.distance=function(a){return arguments.length?(r=typeof a=="function"?a:E(+a),c(),d):r},d}var ee={value:()=>{}};function xt(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new R(n)}function R(t){this._=t}function ne(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}R.prototype=xt.prototype={constructor:R,on:function(t,e){var n=this._,i=ne(t+"",n),r,s=-1,u=i.length;if(arguments.length<2){for(;++s<u;)if((r=(t=i[s]).type)&&(r=ie(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<u;)if(r=(t=i[s]).type)n[r]=vt(n[r],t.name,e);else if(e==null)for(r in n)n[r]=vt(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new R(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function ie(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function vt(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=ee,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var F=0,G=0,V=0,mt=1e3,K,q,U=0,B=0,Z=0,H=typeof performance=="object"&&performance.now?performance:Date,Mt=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ct(){return B||(Mt(re),B=H.now()+Z)}function re(){B=0}function ot(){this._call=this._time=this._next=null}ot.prototype=Nt.prototype={constructor:ot,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Ct():+n)+(e==null?0:+e),!this._next&&q!==this&&(q?q._next=this:K=this,q=this),this._call=t,this._time=n,st()},stop:function(){this._call&&(this._call=null,this._time=1/0,st())}};function Nt(t,e,n){var i=new ot;return i.restart(t,e,n),i}function oe(){Ct(),++F;for(var t=K,e;t;)(e=B-t._time)>=0&&t._call.call(void 0,e),t=t._next;--F}function yt(){B=(U=H.now())+Z,F=G=0;try{oe()}finally{F=0,ae(),B=0}}function se(){var t=H.now(),e=t-U;e>mt&&(Z-=e,U=t)}function ae(){for(var t,e=K,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:K=n);q=t,st(i)}function st(t){if(!F){G&&(G=clearTimeout(G));var e=t-B;e>24?(t<1/0&&(G=setTimeout(yt,t-H.now()-Z)),V&&(V=clearInterval(V))):(V||(U=H.now(),V=setInterval(se,mt)),F=1,Mt(yt))}}const ue=1664525,le=1013904223,gt=4294967296;function ce(){let t=1;return()=>(t=(ue*t+le)%gt)/gt}function fe(t){return t.x}function he(t){return t.y}var ve=10,ye=Math.PI*(3-Math.sqrt(5));function ge(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,u=.6,o=new Map,l=Nt(w),v=xt("tick","end"),y=ce();t==null&&(t=[]);function w(){d(),v.call("tick",e),n<i&&(l.stop(),v.call("end",e))}function d(c){var a,h=t.length,g;c===void 0&&(c=1);for(var M=0;M<c;++M)for(n+=(s-n)*r,o.forEach(function(p){p(n)}),a=0;a<h;++a)g=t[a],g.fx==null?g.x+=g.vx*=u:(g.x=g.fx,g.vx=0),g.fy==null?g.y+=g.vy*=u:(g.y=g.fy,g.vy=0);return e}function f(){for(var c=0,a=t.length,h;c<a;++c){if(h=t[c],h.index=c,h.fx!=null&&(h.x=h.fx),h.fy!=null&&(h.y=h.fy),isNaN(h.x)||isNaN(h.y)){var g=ve*Math.sqrt(.5+c),M=c*ye;h.x=g*Math.cos(M),h.y=g*Math.sin(M)}(isNaN(h.vx)||isNaN(h.vy))&&(h.vx=h.vy=0)}}function m(c){return c.initialize&&c.initialize(t,y),c}return f(),e={tick:d,restart:function(){return l.restart(w),e},stop:function(){return l.stop(),e},nodes:function(c){return arguments.length?(t=c,f(),o.forEach(m),e):t},alpha:function(c){return arguments.length?(n=+c,e):n},alphaMin:function(c){return arguments.length?(i=+c,e):i},alphaDecay:function(c){return arguments.length?(r=+c,e):+r},alphaTarget:function(c){return arguments.length?(s=+c,e):s},velocityDecay:function(c){return arguments.length?(u=1-c,e):1-u},randomSource:function(c){return arguments.length?(y=c,o.forEach(m),e):y},force:function(c,a){return arguments.length>1?(a==null?o.delete(c):o.set(c,m(a)),e):o.get(c)},find:function(c,a,h){var g=0,M=t.length,p,k,A,_,x;for(h==null?h=1/0:h*=h,g=0;g<M;++g)_=t[g],p=c-_.x,k=a-_.y,A=p*p+k*k,A<h&&(x=_,h=A);return x},on:function(c,a){return arguments.length>1?(v.on(c,a),e):v.on(c)}}}function pe(){var t,e,n,i,r=E(-30),s,u=1,o=1/0,l=.81;function v(f){var m,c=t.length,a=wt(t,fe,he).visitAfter(w);for(i=f,m=0;m<c;++m)e=t[m],a.visit(d)}function y(){if(t){var f,m=t.length,c;for(s=new Array(m),f=0;f<m;++f)c=t[f],s[c.index]=+r(c,f,t)}}function w(f){var m=0,c,a,h=0,g,M,p;if(f.length){for(g=M=p=0;p<4;++p)(c=f[p])&&(a=Math.abs(c.value))&&(m+=c.value,h+=a,g+=a*c.x,M+=a*c.y);f.x=g/h,f.y=M/h}else{c=f,c.x=c.data.x,c.y=c.data.y;do m+=s[c.data.index];while(c=c.next)}f.value=m}function d(f,m,c,a){if(!f.value)return true;var h=f.x-e.x,g=f.y-e.y,M=a-m,p=h*h+g*g;if(M*M/l<p)return p<o&&(h===0&&(h=P(n),p+=h*h),g===0&&(g=P(n),p+=g*g),p<u&&(p=Math.sqrt(u*p)),e.vx+=h*f.value*i/p,e.vy+=g*f.value*i/p),true;if(f.length||p>=o)return;(f.data!==e||f.next)&&(h===0&&(h=P(n),p+=h*h),g===0&&(g=P(n),p+=g*g),p<u&&(p=Math.sqrt(u*p)));do f.data!==e&&(M=s[f.data.index]*i/p,e.vx+=h*M,e.vy+=g*M);while(f=f.next)}return v.initialize=function(f,m){t=f,n=m,y()},v.strength=function(f){return arguments.length?(r=typeof f=="function"?f:E(+f),y(),v):r},v.distanceMin=function(f){return arguments.length?(u=f*f,v):Math.sqrt(u)},v.distanceMax=function(f){return arguments.length?(o=f*f,v):Math.sqrt(o)},v.theta=function(f){return arguments.length?(l=f*f,v):Math.sqrt(l)},v}function _e(t){var e=E(.1),n,i,r;typeof t!="function"&&(t=E(t==null?0:+t));function s(o){for(var l=0,v=n.length,y;l<v;++l)y=n[l],y.vx+=(r[l]-y.x)*i[l]*o}function u(){if(n){var o,l=n.length;for(i=new Array(l),r=new Array(l),o=0;o<l;++o)i[o]=isNaN(r[o]=+t(n[o],o,n))?0:+e(n[o],o,n)}}return s.initialize=function(o){n=o,u()},s.strength=function(o){return arguments.length?(e=typeof o=="function"?o:E(+o),u(),s):e},s.x=function(o){return arguments.length?(t=typeof o=="function"?o:E(+o),u(),s):t},s}function de(t){var e=E(.1),n,i,r;typeof t!="function"&&(t=E(t==null?0:+t));function s(o){for(var l=0,v=n.length,y;l<v;++l)y=n[l],y.vy+=(r[l]-y.y)*i[l]*o}function u(){if(n){var o,l=n.length;for(i=new Array(l),r=new Array(l),o=0;o<l;++o)i[o]=isNaN(r[o]=+t(n[o],o,n))?0:+e(n[o],o,n)}}return s.initialize=function(o){n=o,u()},s.strength=function(o){return arguments.length?(e=typeof o=="function"?o:E(+o),u(),s):e},s.y=function(o){return arguments.length?(t=typeof o=="function"?o:E(+o),u(),s):t},s}var T;(t=>{t.arrowLength=10,t.arrowOffset=10,t.arrowAngle=Math.PI/6})(T||(T={}));const we={class:"link"},xe=["x1","y1","x2","y2"],me=["x1","y1","x2","y2"],Me=["x1","y1","x2","y2"],Ce=["x1","y1","x2","y2"],Ne=at({__name:"link",props:{link:{}},emits:["mouseenter","mouseleave"],setup(t){const e=t,n=W(()=>{const{source:i,target:r}=e.link,s=r.x-i.x,u=r.y-i.y,o=Math.atan2(u,s),l=r.x-T.arrowOffset*Math.cos(o),v=r.y-T.arrowOffset*Math.sin(o),y=l-T.arrowLength*Math.cos(o-T.arrowAngle),w=v-T.arrowLength*Math.sin(o-T.arrowAngle),d=l-T.arrowLength*Math.cos(o+T.arrowAngle),f=v-T.arrowLength*Math.sin(o+T.arrowAngle);return{x0:l,y0:v,x1:y,y1:w,x2:d,y2:f}});return(i,r)=>(L(),D("g",we,[I("line",{x1:i.link.source.x,y1:i.link.source.y,x2:i.link.target.x,y2:i.link.target.y,class:"shadow",onMouseenter:r[0]||(r[0]=X(s=>i.$emit("mouseenter",i.link,s),["stop","prevent"])),onMouseleave:r[1]||(r[1]=X(s=>i.$emit("mouseleave",i.link,s),["stop","prevent"]))},null,40,xe),I("line",{x1:i.link.source.x,y1:i.link.source.y,x2:i.link.target.x,y2:i.link.target.y,class:Q(i.link.type)},null,10,me),I("line",{x1:n.value.x0,y1:n.value.y0,x2:n.value.x1,y2:n.value.y1},null,8,Me),I("line",{x1:n.value.x0,y1:n.value.y0,x2:n.value.x2,y2:n.value.y2},null,8,Ce)]))}});const tt=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},ke=tt(Ne,[["__scopeId","data-v-90f504a7"]]),Ae={class:"node"},$e=["r","cx","cy"],ze=["r","cx","cy"],Le={key:1,class:"service"},Ee=["x1","y1","x2","y2"],Te=["x1","y1","x2","y2"],Ie=at({__name:"node",props:{node:{},isActive:{type:Boolean}},setup(t){return(e,n)=>(L(),D("g",Ae,[I("circle",{r:e.isActive?12:9,cx:e.node.x,cy:e.node.y},null,8,$e),e.node.isGroup||e.node.isRoot?(L(),D("circle",{key:0,r:e.isActive?8:5,cx:e.node.x,cy:e.node.y},null,8,ze)):lt("",true),e.node.services?(L(),D("g",Le,[I("line",{x1:e.node.x-(e.isActive?5:4),y1:e.node.y,x2:e.node.x+(e.isActive?5:4),y2:e.node.y},null,8,Ee),I("line",{x1:e.node.x,y1:e.node.y-(e.isActive?5:4),x2:e.node.x,y2:e.node.y+(e.isActive?5:4)},null,8,Te)])):lt("",true)]))}});const Se=tt(Ie,[["__scopeId","data-v-39ce2522"]]),De=["width","height","viewBox"],be={class:"links"},je={class:"nodes"},Be=1e3,pt=.001,Oe=at({__name:"index",setup(t){const e=b(),{width:n,height:i}=bt(e),r=jt(),s=b(null),u=b(null),o=b(null),l=_t(rt.insight.nodes),v=W(()=>rt.insight.edges),y=te(v.value).id(_=>_.uid).distance(100),w=ge(l).force("link",y).force("charge",pe().strength(-200)).force("x",_e().strength(.05)).force("y",de().strength(.05)).stop();kt(()=>rt.insight,_=>{if(_){l.slice().forEach((x,C)=>{_.nodes.find(j=>j.uid===x.uid)||l.splice(C,1)});for(const x of _.nodes){const C=l.find(N=>N.uid===x.uid);C?Object.assign(C,x):l.push(x)}w.nodes(l),y.links(_.edges),w.alpha(.3).restart()}}),At(()=>{w.alpha(1).alphaMin(pt).alphaDecay(1-Math.pow(pt,1/Be)).restart()}),Y("mousemove",h),Y("touchmove",h),Y("mouseup",g),Y("touchend",g);function d(_,x){u.value=_;const C=["\u63D2\u4EF6\uFF1A"+_.name];_.services&&C.push("\u63D0\u4F9B\u670D\u52A1\uFF1A"+_.services.join("\uFF0C")),r.activate(C.join(`
`),x)}function f(_,x){s.value!==_&&(u.value=null,r.deactivate(300))}function m(_,x){o.value=_;const N=`${_.type==="dashed"?"\u670D\u52A1":"\u8C03\u7528"}\uFF1A${_.source.name} \u2192 ${_.target.name}`;r.activate(N,x)}function c(_,x){o.value=null,r.deactivate(300)}function a(_,x){s.value=_,w.alphaTarget(.3).restart();const C=J(x);_.lastX=C.clientX,_.lastY=C.clientY,_.fx=_.x,_.fy=_.y}function h(_){const x=s.value;if(!x)return;const C=J(_);x.fx+=C.clientX-x.lastX,x.fy+=C.clientY-x.lastY,x.lastX=C.clientX,x.lastY=C.clientY}function g(_){w.alphaTarget(0);const x=s.value;x&&(x.fx=null,x.fy=null,u.value=null,s.value=null)}const M=()=>({nodes:new Set,links:new Set}),p=_=>({nodes:new Set([_.source,_.target]),links:new Set([_])}),k=_=>{const x={nodes:new Set([_]),links:new Set};let C=true;for(;C;){C=false;for(const N of v.value)x.links.has(N)||x.nodes.has(N.target)&&(x.nodes.add(N.source),x.links.add(N),C=true)}return x},A=W(()=>o.value?p(o.value):u.value?k(u.value):M());return(_,x)=>{const C=$t("k-layout");return L(),et(C,{main:"darker"},{default:ct(()=>[I("div",{ref_key:"root",ref:e,class:Q({insight:true,"has-highlight":S(r).active})},[(L(),D("svg",{ref:"svg",id:"couple",width:S(n),height:S(i),viewBox:`-${S(n)/2} -${S(i)/2} ${S(n)} ${S(i)}`},[I("g",be,[(L(true),D(nt,null,it(v.value,(N,j)=>(L(),et(ke,{key:j,link:N,class:Q({highlight:A.value.links.has(N)}),onMouseenter:m,onMouseleave:c},null,8,["link","class"]))),128))]),I("g",je,[(L(true),D(nt,null,it(l,(N,j)=>(L(),et(Se,{key:j,class:Q({highlight:A.value.nodes.has(N)}),node:N,"is-active":N===u.value,onMouseenter:X(O=>d(N,O),["stop","prevent"]),onMouseleave:X(O=>f(N),["stop","prevent"]),onMousedown:X(O=>a(N,O),["stop","prevent"]),onTouchstart:X(O=>a(N,O),["stop","prevent"])},null,8,["class","node","is-active","onMouseenter","onMouseleave","onMousedown","onTouchstart"]))),128))])],8,De)),zt(Lt,{name:"fade"},{default:ct(()=>[Et(I("div",{class:"tooltip",style:Tt(S(r).style)},[(L(true),D(nt,null,it(S(r).content.split(`
`),(N,j)=>(L(),D("div",{key:j},It(N),1))),128))],4),[[St,S(r).active]])]),_:1})],2)]),_:1})}}});const Xe=tt(Oe,[["__scopeId","data-v-025c99fb"]]),Ye={},Pe={class:"k-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512"},Fe=I("path",{fill:"currentColor",d:"M160 64C160 28.65 188.7 0 224 0C259.3 0 288 28.65 288 64C288 83.36 279.4 100.7 265.8 112.5L304.3 196.5C314.4 193.6 325 192 336 192C367.7 192 396.2 205.1 416.6 226.2L517.4 153.7C513.9 145.8 512 137.1 512 128C512 92.65 540.7 64 576 64C611.3 64 640 92.65 640 128C640 163.3 611.3 192 576 192C561.4 192 547.9 187.1 537.2 178.9L435.3 252.2C443.4 267.7 448 285.3 448 304C448 319.4 444.9 334 439.3 347.3L531.1 402.4C542.6 391 558.5 384 576 384C611.3 384 640 412.7 640 448C640 483.3 611.3 512 576 512C540.7 512 512 483.3 512 448C512 441.7 512.9 435.6 514.6 429.8L422.8 374.8C402.3 399.9 371 416 336 416C279.6 416 232.9 374.3 225.1 320H125.1C118.9 347.6 93.82 368 64 368C28.65 368 0 339.3 0 304C0 268.7 28.65 240 64 240C93.82 240 118.9 260.4 125.1 288H225.1C229.8 255.3 248.7 227.1 275.3 209.9L237.1 126.7C232.9 127.5 228.5 128 224 128C188.7 128 160 99.35 160 64V64zM224 96C241.7 96 256 81.67 256 64C256 46.33 241.7 32 224 32C206.3 32 192 46.33 192 64C192 81.67 206.3 96 224 96zM576 160C593.7 160 608 145.7 608 128C608 110.3 593.7 96 576 96C558.3 96 544 110.3 544 128C544 145.7 558.3 160 576 160zM576 416C558.3 416 544 430.3 544 448C544 465.7 558.3 480 576 480C593.7 480 608 465.7 608 448C608 430.3 593.7 416 576 416zM64 336C81.67 336 96 321.7 96 304C96 286.3 81.67 272 64 272C46.33 272 32 286.3 32 304C32 321.7 46.33 336 64 336zM336 384C380.2 384 416 348.2 416 304C416 259.8 380.2 224 336 224C291.8 224 256 259.8 256 304C256 348.2 291.8 384 336 384z"},null,-1),Ve=[Fe];function Ge(t,e){return L(),D("svg",Pe,Ve)}const qe=tt(Ye,[["render",Ge]]);Dt.register("activity:network",qe);const We=t=>{t.page({path:"/graph",name:"\u4F9D\u8D56\u56FE",icon:"activity:network",order:600,fields:["insight"],component:Xe})};export{We as default};
