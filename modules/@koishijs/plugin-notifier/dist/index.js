import{useRpc as ye,send as me,message as be}from"@koishijs/client";import{defineComponent as ve,inject as xe,computed as we,resolveComponent as W,openBlock as te,createElementBlock as Ae,Fragment as Se,renderList as Oe,createBlock as Ce,withCtx as _e,createVNode as je,unref as Be,h as P}from"vue";var De=Object.defineProperty,u=(e,i)=>De(e,"name",{value:i,configurable:true});function $e(){}u($e,"noop");function j(e){return e==null}u(j,"isNullable");function ke(e){return e&&typeof e=="object"&&!Array.isArray(e)}u(ke,"isPlainObject");function ze(e,i){return Object.fromEntries(Object.entries(e).filter(([l,m])=>i(l,m)))}u(ze,"filterKeys");function ie(e,i){return Object.fromEntries(Object.entries(e).map(([l,m])=>[l,i(m,l)]))}u(ie,"mapValues");function Ne(e,i,l){if(!i)return{...e};const m={};for(const d of i)(l||e[d]!==void 0)&&(m[d]=e[d]);return m}u(Ne,"pick");function Fe(e,i){if(!i)return{...e};const l={...e};for(const m of i)Reflect.deleteProperty(l,m);return l}u(Fe,"omit");function K(e,i,l){return Object.defineProperty(e,i,{writable:true,value:l,enumerable:false})}u(K,"defineProperty");function Le(e,i){return i.every(l=>e.includes(l))}u(Le,"contain");function Re(e,i){return e.filter(l=>i.includes(l))}u(Re,"intersection");function Me(e,i){return e.filter(l=>!i.includes(l))}u(Me,"difference");function Pe(e,i){return Array.from(new Set([...e,...i]))}u(Pe,"union");function Ue(e){return[...new Set(e)]}u(Ue,"deduplicate");function He(e,i){const l=e.indexOf(i);return l>=0?(e.splice(l,1),true):false}u(He,"remove");function oe(e){return Array.isArray(e)?e:j(e)?[]:[e]}u(oe,"makeArray");function B(e,i){return arguments.length===1?l=>B(e,l):e in globalThis&&i instanceof globalThis[e]||Object.prototype.toString.call(i).slice(8,-1)===e}u(B,"is");function R(e){return B("ArrayBuffer",e)||B("SharedArrayBuffer",e)}u(R,"isArrayBufferLike");function ae(e){return R(e)||ArrayBuffer.isView(e)}u(ae,"isArrayBufferSource");var N;(e=>{e.is=R,e.isSource=ae;function i(c){return ArrayBuffer.isView(c)?c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength):c}e.fromSource=i,u(i,"fromSource");function l(c){if(typeof Buffer<"u")return Buffer.from(c).toString("base64");let n="";const f=new Uint8Array(c);for(let h=0;h<f.byteLength;h++)n+=String.fromCharCode(f[h]);return btoa(n)}e.toBase64=l,u(l,"toBase64");function m(c){return typeof Buffer<"u"?i(Buffer.from(c,"base64")):Uint8Array.from(atob(c),n=>n.charCodeAt(0))}e.fromBase64=m,u(m,"fromBase64");function d(c){return typeof Buffer<"u"?Buffer.from(c).toString("hex"):Array.from(new Uint8Array(c),n=>n.toString(16).padStart(2,"0")).join("")}e.toHex=d,u(d,"toHex");function b(c){if(typeof Buffer<"u")return i(Buffer.from(c,"hex"));const n=c.length%2===0?c:c.slice(0,c.length-1),f=[];for(let h=0;h<n.length;h+=2)f.push(parseInt(`${n[h]}${n[h+1]}`,16));return Uint8Array.from(f).buffer}e.fromHex=b,u(b,"fromHex")})(N||(N={}));N.fromBase64;var re=N.toBase64;N.fromHex;N.toHex;function Z(e){return!e||typeof e!="object"?e:Array.isArray(e)?e.map(Z):B("Date",e)?new Date(e.valueOf()):B("RegExp",e)?new RegExp(e.source,e.flags):R(e)?e.slice(0):ArrayBuffer.isView(e)?e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):ie(e,Z)}u(Z,"clone");function J(e,i,l){if(e===i||!l&&j(e)&&j(i))return true;if(typeof e!=typeof i||typeof e!="object"||!e||!i)return false;function m(d,b){return d(e)?d(i)?b(e,i):false:d(i)?false:void 0}return u(m,"check"),m(Array.isArray,(d,b)=>d.length===b.length&&d.every((c,n)=>J(c,b[n])))??m(B("Date"),(d,b)=>d.valueOf()===b.valueOf())??m(B("RegExp"),(d,b)=>d.source===b.source&&d.flags===b.flags)??m(R,(d,b)=>{if(d.byteLength!==b.byteLength)return false;const c=new Uint8Array(d),n=new Uint8Array(b);for(let f=0;f<c.length;f++)if(c[f]!==n[f])return false;return true})??Object.keys({...e,...i}).every(d=>J(e[d],i[d],l))}u(J,"deepEqual");function Ve(e){return e.charAt(0).toUpperCase()+e.slice(1)}u(Ve,"capitalize");function G(e){return e.charAt(0).toLowerCase()+e.slice(1)}u(G,"uncapitalize");function fe(e){return e.replace(/[_-][a-z]/g,i=>i.slice(1).toUpperCase())}u(fe,"camelCase");function se(e){return G(e).replace(/_/g,"-").replace(/.[A-Z]+/g,i=>i[0]+"-"+i.slice(1).toLowerCase())}u(se,"paramCase");function Ee(e){return G(e).replace(/-/g,"_").replace(/.[A-Z]+/g,i=>i[0]+"_"+i.slice(1).toLowerCase())}u(Ee,"snakeCase");var Ie=fe,Ye=se;function ue(e){return e.replace(/\/$/,"")}u(ue,"trimSlash");function We(e){return e.startsWith("/")||(e="/"+e),ue(e)}u(We,"sanitize");var ne;(e=>{e.millisecond=1,e.second=1e3,e.minute=e.second*60,e.hour=e.minute*60,e.day=e.hour*24,e.week=e.day*7;let i=new Date().getTimezoneOffset();function l(s){i=s}e.setTimezoneOffset=l,u(l,"setTimezoneOffset");function m(){return i}e.getTimezoneOffset=m,u(m,"getTimezoneOffset");function d(s=new Date,p){return typeof s=="number"&&(s=new Date(s)),p===void 0&&(p=i),Math.floor((s.valueOf()/e.minute-p)/1440)}e.getDateNumber=d,u(d,"getDateNumber");function b(s,p){const U=new Date(s*e.day);return p===void 0&&(p=i),new Date(+U+p*e.minute)}e.fromDateNumber=b,u(b,"fromDateNumber");const c=/\d+(?:\.\d+)?/.source,n=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(s=>`(${c}${s})?`).join("")}$`);function f(s){const p=n.exec(s);return p?(parseFloat(p[1])*e.week||0)+(parseFloat(p[2])*e.day||0)+(parseFloat(p[3])*e.hour||0)+(parseFloat(p[4])*e.minute||0)+(parseFloat(p[5])*e.second||0):0}e.parseTime=f,u(f,"parseTime");function h(s){const p=f(s);return p?s=Date.now()+p:/^\d{1,2}(:\d{1,2}){1,2}$/.test(s)?s=`${new Date().toLocaleDateString()}-${s}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(s)&&(s=`${new Date().getFullYear()}-${s}`),s?new Date(s):new Date}e.parseDate=h,u(h,"parseDate");function A(s){const p=Math.abs(s);return p>=e.day-e.hour/2?Math.round(s/e.day)+"d":p>=e.hour-e.minute/2?Math.round(s/e.hour)+"h":p>=e.minute-e.second/2?Math.round(s/e.minute)+"m":p>=e.second?Math.round(s/e.second)+"s":s+"ms"}e.format=A,u(A,"format");function O(s,p=2){return s.toString().padStart(p,"0")}e.toDigits=O,u(O,"toDigits");function _(s,p=new Date){return s.replace("yyyy",p.getFullYear().toString()).replace("yy",p.getFullYear().toString().slice(2)).replace("MM",O(p.getMonth()+1)).replace("dd",O(p.getDate())).replace("hh",O(p.getHours())).replace("mm",O(p.getMinutes())).replace("ss",O(p.getSeconds())).replace("SSS",O(p.getMilliseconds(),3))}e.template=_,u(_,"template")})(ne||(ne={}));var Ke=Object.defineProperty,Ze=Object.getOwnPropertyNames,v=(e,i)=>Ke(e,"name",{value:i,configurable:true}),Je=(e,i)=>function(){return i||(0,e[Ze(e)[0]])((i={exports:{}}).exports,i),i.exports},Ge=Je({"src/index.ts"(e,i){var c;var l=Symbol.for("satori.element"),m=(c=class{get data(){return this.attrs}getTagName(){var f;return this.type==="component"?((f=this.attrs.is)==null?void 0:f.name)??"component":this.type}toAttrString(){return Object.entries(this.attrs).map(([f,h])=>j(h)?"":(f=Ye(f),h===true?` ${f}`:h===false?` no-${f}`:` ${f}="${d.escape(""+h,true)}"`)).join("")}toString(f=false){if(this.type==="text"&&"content"in this.attrs)return f?this.attrs.content:d.escape(this.attrs.content);const h=this.children.map(_=>_.toString(f)).join("");if(f)return h;const A=this.toAttrString(),O=this.getTagName();return this.children.length?`<${O}${A}>${h}</${O}>`:`<${O}${A}/>`}},v(c,"ElementConstructor"),c);K(m,"name","Element"),K(m.prototype,l,true);function d(n,...f){const h=Object.create(m.prototype),A={},O=[];if(f[0]&&typeof f[0]=="object"&&!d.isElement(f[0])&&!Array.isArray(f[0])){const _=f.shift();for(const[s,p]of Object.entries(_))j(p)||(s==="children"?f.push(...oe(p)):A[Ie(s)]=p)}for(const _ of f)O.push(...d.toElementArray(_));return typeof n=="function"&&(A.is=n,n="component"),Object.assign(h,{type:n,attrs:A,children:O})}v(d,"Element");var b=new Function("expr","context",`
  try {
    with (context) {
      return eval(expr)
    }
  } catch {}
`);(n=>{n.jsx=n,n.jsxs=n,n.jsxDEV=n,n.Fragment="template";function f(r){return r&&typeof r=="object"&&r[l]}n.isElement=f,v(f,"isElement");function h(r){if(typeof r=="string"||typeof r=="number"||typeof r=="boolean"){if(r=""+r,r)return n("text",{content:r})}else{if(f(r))return r;if(!j(r))throw new TypeError(`Invalid content: ${r}`)}}n.toElement=h,v(h,"toElement");function A(r){return Array.isArray(r)?r.map(h).filter(t=>t):[h(r)].filter(t=>t)}n.toElementArray=A,v(A,"toElementArray");function O(r,t){return typeof r=="string"?$(r,t):A(r)}n.normalize=O,v(O,"normalize");function _(r,t=false){const o=(r??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return t?o.replace(/"/g,"&quot;"):o}n.escape=_,v(_,"escape");function s(r){return r.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#(\d+);/g,(t,o)=>o==="38"?t:String.fromCharCode(+o)).replace(/&#x([0-9a-f]+);/gi,(t,o)=>o==="26"?t:String.fromCharCode(parseInt(o,16))).replace(/&(amp|#38|#x26);/g,"&")}n.unescape=s,v(s,"unescape");function p(r,t={}){var a;const o=$(r);return t.caret?t.type&&((a=o[0])==null?void 0:a.type)!==t.type?void 0:o[0]:M(o,t.type||"*")[0]}n.from=p,v(p,"from");const U=/ *([ >+~]) */g;function H(r){return r.split(",").map(t=>{const o=[];t=t.trim();let a,y=" ";for(;a=U.exec(t);)o.push({type:t.slice(0,a.index),combinator:y}),y=a[1],t=t.slice(a.index+a[0].length);return o.push({type:t,combinator:y}),o})}n.parseSelector=H,v(H,"parseSelector");function M(r,t){if(!r||!t)return[];if(typeof r=="string"&&(r=$(r)),typeof t=="string"&&(t=H(t)),!t.length)return[];let o=[];const a=[];for(const[y,g]of r.entries()){const x=[],C=[...t,...o];o=[];let S=false;for(const w of C){const{type:D,combinator:Y}=w[0];(D===g.type||D==="*")&&(w.length===1?S=true:[" ",">"].includes(w[1].combinator)?x.push(w.slice(1)):w[1].combinator==="+"?o.push(w.slice(1)):t.push(w.slice(1))),Y===" "&&x.push(w)}S&&a.push(r[y]),a.push(...M(g.children,x))}return a}n.select=M,v(M,"select");function F(r,t){if(r=r.trim(),!/^[\w.]+$/.test(r))return b(r,t)??"";let o=t;for(const a of r.split("."))if(o=o[a],j(o))return"";return o??""}n.interpolate=F,v(F,"interpolate");const le=/(?<comment><!--[\s\S]*?-->)|(?<tag><(\/?)([^!\s>/]*)([^>]*?)\s*(\/?)>)/,ce=/(?<comment><!--[\s\S]*?-->)|(?<tag><(\/?)([^!\s>/]*)([^>]*?)\s*(\/?)>)|(?<curly>\{(?<derivative>[@:/#][^\s}]*)?[\s\S]*?\})/,pe=/([^\s=]+)(?:="(?<value1>[^"]*)"|='(?<value2>[^']*)')?/g,de=/([^\s=]+)(?:="(?<value1>[^"]*)"|='(?<value2>[^']*)'|=\{(?<curly>[^}]+)\})?/g;let Q;(r=>{r[r.OPEN=0]="OPEN",r[r.CLOSE=1]="CLOSE",r[r.EMPTY=2]="EMPTY",r[r.CONTINUE=3]="CONTINUE"})(Q||(Q={}));function $(r,t){const o=[];function a(S){S&&o.push(S)}v(a,"pushText");const y=t?ce:le;let g,x=true;for(;g=y.exec(r);){const S=!g.groups.curly;C(r.slice(0,g.index),x,S),x=S,r=r.slice(g.index+g[0].length);const[w,,,D,Y,ge,he]=g;if(!g.groups.comment){if(g.groups.curly){let T="",ee=2;g.groups.derivative&&(T=g.groups.derivative.slice(1),ee={"@":2,"#":0,"/":1,":":3}[g.groups.derivative[0]]),o.push({type:"curly",name:T,position:ee,source:g.groups.curly,extra:g.groups.curly.slice(1+(g.groups.derivative??"").length,-1)});continue}o.push({type:"angle",source:w,name:Y||n.Fragment,position:D?1:he?2:0,extra:ge})}}C(r,x,true);function C(S,w,D){S=s(S),w&&(S=S.replace(/^\s*\n\s*/,"")),D&&(S=S.replace(/\s*\n\s*$/,"")),a(S)}return v(C,"parseContent"),k(X(o),t)}n.parse=$,v($,"parse");function X(r){const t=[[{type:"angle",name:n.Fragment,position:0,source:"",extra:"",children:{default:[]}},"default"]];function o(...a){const[y,g]=t[0];y.children[g].push(...a)}v(o,"pushToken");for(const a of r){if(typeof a=="string"){o(a);continue}const{name:y,position:g}=a;g===1?t[0][0].name===y&&t.shift():g===3?(t[0][0].children[y]=[],t[0][1]=y):g===0?(o(a),a.children={default:[]},t.unshift([a,"default"])):o(a)}return t[t.length-1][0].children.default}v(X,"foldTokens");function k(r,t){const o=[];for(const a of r)if(typeof a=="string")o.push(n("text",{content:a}));else if(a.type==="angle"){const y={},g=t?de:pe;let x;for(;x=g.exec(a.extra);){const[,C,S,w=S,D]=x;D?y[C]=F(D,t):j(w)?C.startsWith("no-")?y[C.slice(3)]=false:y[C]=true:y[C]=s(w)}o.push(n(a.name,y,a.children&&k(a.children.default,t)))}else if(!a.name)o.push(...A(F(a.extra,t)));else if(a.name==="if")b(a.extra,t)?o.push(...k(a.children.default,t)):o.push(...k(a.children.else||[],t));else if(a.name==="each"){const[y,g]=a.extra.split(/\s+as\s+/),x=F(y,t);if(!x||!x[Symbol.iterator])continue;for(const C of x)o.push(...k(a.children.default,{...t,[g]:C}))}return o}v(k,"parseTokens");function V(r,t,o){const{type:a,attrs:y,children:g}=r;if(typeof t=="function")return t(r,o);{let x=t[typeof a=="string"?a:""]??t.default??true;return typeof x=="function"&&(x=x(y,g,o)),x}}v(V,"visit");function E(r,t,o){const a=typeof r=="string"?$(r):r,y=[];return a.forEach(g=>{const{type:x,attrs:C,children:S}=g,w=V(g,t,o);w===true?y.push(n(x,C,E(S,t,o))):w!==false&&y.push(...A(w))}),typeof r=="string"?y.join(""):y}n.transform=E,v(E,"transform");async function I(r,t,o){const a=typeof r=="string"?$(r):r,y=(await Promise.all(a.map(async g=>{const{type:x,attrs:C,children:S}=g,w=await V(g,t,o);return w===true?[n(x,C,await I(S,t,o))]:w!==false?A(w):[]}))).flat(1);return typeof r=="string"?y.join(""):y}n.transformAsync=I,v(I,"transformAsync");function L(r,...t){return(...o)=>{const a=n(r);return t.forEach((y,g)=>{j(o[g])||(a.attrs[y]=o[g])}),o[t.length]&&Object.assign(a.attrs,o[t.length]),a}}v(L,"createFactory"),n.warn=v(()=>{},"warn");function z(r){return(t,...o)=>{let a="base64://";return typeof o[0]=="string"&&(a=`data:${o.shift()};base64,`),B("Buffer",t)?t=a+t.toString("base64"):B("ArrayBuffer",t)?t=a+re(t):ArrayBuffer.isView(t)&&(t=a+re(t.buffer)),t.startsWith("base64://")&&(0,n.warn)('protocol "base64:" is deprecated and will be removed in the future, please use "data:" instead'),n(r,{...o[0],src:t})}}v(z,"createAssetFactory"),n.text=L("text","content"),n.at=L("at","id"),n.sharp=L("sharp","id"),n.quote=L("quote","id"),n.image=z("img"),n.img=z("img"),n.video=z("video"),n.audio=z("audio"),n.file=z("file");function q(r,t){return n("i18n",typeof r=="string"?{path:r}:r,t)}n.i18n=q,v(q,"i18n")})(d||(d={})),i.exports=d}});const Qe=Ge(),Xe=ve({__name:"config",setup(e){const i=xe("manager.settings.current"),l=ye(),m=we(()=>l.value.notifiers.filter(c=>{var n;return((n=c.paths)==null?void 0:n.includes(i.value.path))&&c.content})),d=["div","ul","ol","li","br","span","p","img","audio","video","b","strong","i","em","u","ins","s","del","code"],b=({children:c},n)=>c.map(({type:f,attrs:h,children:A})=>{if(f==="text")return h.content;if(d.includes(f))return P(f,h,{default:()=>b({children:A})});if(f==="spl")return P("span",{class:"spoiler",...h},{default:()=>b({children:A})});if(f==="button")return P(W("el-button"),{...h,onClick:()=>me("notifier/button",h.onClick)},{default:()=>b({children:A})});if(f==="progress")return P(W("el-progress"),h,{default:()=>b({children:A})});if(f==="template")return b({children:A})});return(c,n)=>{const f=W("k-comment");return te(true),Ae(Se,null,Oe(m.value,h=>(te(),Ce(f,{type:h.type},{default:_e(()=>[je(b,{children:Be(Qe).parse(h.content)},null,8,["children"])]),_:2},1032,["type"]))),256)}}});const et=e=>{e.slot({type:"plugin-details",component:Xe,order:0}),e.on("notifier/message",({content:i,type:l})=>{e.effect(()=>{const m=be({message:i,type:l==="primary"?"info":l});return()=>m.close()})})};export{et as default};
