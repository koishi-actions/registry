var Ve=Object.create;var k=Object.defineProperty;var We=Object.getOwnPropertyDescriptor;var Ye=Object.getOwnPropertyNames;var Ke=Object.getPrototypeOf,je=Object.prototype.hasOwnProperty;var ae=(e,i)=>()=>(e&&(i=e(e=0)),i);var de=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports),$e=(e,i)=>{for(var t in i)k(e,t,{get:i[t],enumerable:!0})},H=(e,i,t,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let E of Ye(i))!je.call(e,E)&&E!==t&&k(e,E,{get:()=>i[E],enumerable:!(s=We(i,E))||s.enumerable});return e},R=(e,i,t)=>(H(e,i,"default"),t&&H(t,i,"default")),_e=(e,i,t)=>(t=e!=null?Ve(Ke(e)):{},H(i||!e||!e.__esModule?k(t,"default",{value:e,enumerable:!0}):t,e)),f=e=>H(k({},"__esModule",{value:!0}),e);import{Buffer as j}from"https://registry.koishi.chat/modules/buffer/index.js";import $ from"https://registry.koishi.chat/modules/process/index.js";var O=ae(()=>{});var N={};import*as ot from"https://registry.koishi.chat/modules/@satorijs/core/index.js";var M=ae(()=>{O();R(N,ot)});var le=de((at,xe)=>{xe.exports={name:"@satorijs/adapter-discord",description:"Discord Adapter for Satorijs",version:"4.5.9",type:"module",main:"lib/index.cjs",typings:"lib/index.d.ts",files:["lib","src"],author:"LittleC <i@ltlec.cn>",contributors:["Shigma <shigma10826@gmail.com>","LittleC <i@ltlec.cn>"],license:"MIT",repository:{type:"git",url:"git+https://github.com/satorijs/satori.git",directory:"adapters/discord"},bugs:{url:"https://github.com/satorijs/satori/issues"},homepage:"https://koishi.chat/plugins/adapter/discord.html",keywords:["bot","discord","chatbot","satori","im","chat"],devDependencies:{"@satorijs/core":"^4.2.6",cordis:"^3.18.1"},peerDependencies:{"@satorijs/core":"^4.2.6"}}});var oe=de((dt,pe)=>{O();var Y=Object.defineProperty,Je=Object.getOwnPropertyDescriptor,Qe=Object.getOwnPropertyNames,qe=Object.prototype.hasOwnProperty,_=(e,i)=>Y(e,"name",{value:i,configurable:!0}),Ie=(e,i)=>{for(var t in i)Y(e,t,{get:i[t],enumerable:!0})},ze=(e,i,t,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let E of Qe(i))!qe.call(e,E)&&E!==t&&Y(e,E,{get:()=>i[E],enumerable:!(s=Je(i,E))||s.enumerable});return e},Xe=e=>ze(Y({},"__esModule",{value:!0}),e),Ae={};Ie(Ae,{Discord:()=>Se,DiscordBot:()=>W,DiscordMessageEncoder:()=>b,WsClient:()=>w,default:()=>et});pe.exports=Xe(Ae);var A=(M(),f(N)),Se={};Ie(Se,{ActivityFlag:()=>Ue,ActivityType:()=>ge,AllowedMentionType:()=>ue,ApplicationCommand:()=>h,ApplicationFlag:()=>Re,ApplicationRoleConnection:()=>x,AuditLog:()=>J,AutoModerationAction:()=>q,AutoModerationRule:()=>Q,ButtonStyles:()=>De,Channel:()=>G,ComponentType:()=>Oe,DeviceType:()=>Le,Gateway:()=>I,Guild:()=>z,GuildFeature:()=>Ge,GuildScheduledEvent:()=>Z,IntegrationExpireBehavior:()=>fe,Interaction:()=>S,Internal:()=>o,Invite:()=>X,Locale:()=>ne,MembershipState:()=>Pe,Message:()=>v,OverwriteType:()=>Ne,Permission:()=>Fe,PremiumType:()=>we,StatusType:()=>me,Sticker:()=>F,SystemChannelFlag:()=>Me,TextInputStyles:()=>Ce,UserFlag:()=>be,VisibilityType:()=>He,Webhook:()=>y,adaptSession:()=>re,decodeChannel:()=>p,decodeGuild:()=>ie,decodeGuildMember:()=>V,decodeMessage:()=>C,decodeRole:()=>P,decodeUser:()=>D,encodeCommand:()=>ke,encodeCommandOptions:()=>K,encodeRole:()=>Ee,sanitize:()=>ee,sanitizeCode:()=>te,setupMessageGuildId:()=>U});var d=(M(),f(N)),Ze=(M(),f(N)),o=class Te{constructor(i){this.bot=i}static{_(this,"Internal")}static define(i){for(let t in i)for(let s in i[t]){let E=s;for(let r of(0,Ze.makeArray)(i[t][E]))Te.prototype[r]=async function(...n){let a=n.join(", "),c=t.replace(/\{([^}]+)\}/g,()=>{if(!n.length)throw new Error(`too few arguments for ${t}, received ${a}`);return n.shift()}),l={};if(n.length===1)E==="GET"||E==="DELETE"?l.params=n[0]:l.data=n[0];else if(n.length===2&&E!=="GET"&&E!=="DELETE")l.data=n[0],l.params=n[1];else if(n.length>1)throw new Error(`too many arguments for ${t}, received ${a}`);try{return this.bot.logger.debug(`${E} ${c}`,l),(await this.bot.http(E,c,l)).data}catch(T){throw!this.bot.http.isError(T)||!T.response?T:new Error(`[${T.response.status}] ${JSON.stringify(T.response.data)}`)}}}}},Re=(e=>(e[e.GATEWAY_PRESENCE=4096]="GATEWAY_PRESENCE",e[e.GATEWAY_PRESENCE_LIMITED=8192]="GATEWAY_PRESENCE_LIMITED",e[e.GATEWAY_GUILD_MEMBERS=16384]="GATEWAY_GUILD_MEMBERS",e[e.GATEWAY_GUILD_MEMBERS_LIMITED=32768]="GATEWAY_GUILD_MEMBERS_LIMITED",e[e.VERIFICATION_PENDING_GUILD_LIMIT=65536]="VERIFICATION_PENDING_GUILD_LIMIT",e[e.EMBEDDED=131072]="EMBEDDED",e[e.GATEWAY_MESSAGE_CONTENT=262144]="GATEWAY_MESSAGE_CONTENT",e[e.GATEWAY_MESSAGE_CONTENT_LIMITED=524288]="GATEWAY_MESSAGE_CONTENT_LIMITED",e[e.APPLICATION_COMMAND_BADGE=8388608]="APPLICATION_COMMAND_BADGE",e))(Re||{});o.define({"/oauth2/applications/@me":{GET:"getCurrentBotApplicationInformation"},"/oauth2/@me":{GET:"getCurrentAuthorizationInformation"}});var x;(e=>{let i;(t=>{t[t.INTEGER_LESS_THAN_OR_EQUAL=1]="INTEGER_LESS_THAN_OR_EQUAL",t[t.INTEGER_GREATER_THAN_OR_EQUAL=2]="INTEGER_GREATER_THAN_OR_EQUAL",t[t.INTEGER_EQUAL=3]="INTEGER_EQUAL",t[t.INTEGER_NOT_EQUAL=4]="INTEGER_NOT_EQUAL",t[t.DATETIME_LESS_THAN_OR_EQUAL=5]="DATETIME_LESS_THAN_OR_EQUAL",t[t.DATETIME_GREATER_THAN_OR_EQUAL=6]="DATETIME_GREATER_THAN_OR_EQUAL",t[t.BOOLEAN_EQUAL=7]="BOOLEAN_EQUAL",t[t.BOOLEAN_NOT_EQUAL=8]="BOOLEAN_NOT_EQUAL"})(i=e.MetadataType||(e.MetadataType={}))})(x||(x={}));o.define({"/applications/{application.id}/role-connections/metadata":{GET:"getApplicationRoleConnectionMetadataRecords",PUT:"updateApplicationRoleConnectionMetadataRecords"}});var J;(e=>{let i;(t=>{t[t.GUILD_UPDATE=1]="GUILD_UPDATE",t[t.CHANNEL_CREATE=10]="CHANNEL_CREATE",t[t.CHANNEL_UPDATE=11]="CHANNEL_UPDATE",t[t.CHANNEL_DELETE=12]="CHANNEL_DELETE",t[t.CHANNEL_OVERWRITE_CREATE=13]="CHANNEL_OVERWRITE_CREATE",t[t.CHANNEL_OVERWRITE_UPDATE=14]="CHANNEL_OVERWRITE_UPDATE",t[t.CHANNEL_OVERWRITE_DELETE=15]="CHANNEL_OVERWRITE_DELETE",t[t.MEMBER_KICK=20]="MEMBER_KICK",t[t.MEMBER_PRUNE=21]="MEMBER_PRUNE",t[t.MEMBER_BAN_ADD=22]="MEMBER_BAN_ADD",t[t.MEMBER_BAN_REMOVE=23]="MEMBER_BAN_REMOVE",t[t.MEMBER_UPDATE=24]="MEMBER_UPDATE",t[t.MEMBER_ROLE_UPDATE=25]="MEMBER_ROLE_UPDATE",t[t.MEMBER_MOVE=26]="MEMBER_MOVE",t[t.MEMBER_DISCONNECT=27]="MEMBER_DISCONNECT",t[t.BOT_ADD=28]="BOT_ADD",t[t.ROLE_CREATE=30]="ROLE_CREATE",t[t.ROLE_UPDATE=31]="ROLE_UPDATE",t[t.ROLE_DELETE=32]="ROLE_DELETE",t[t.INVITE_CREATE=40]="INVITE_CREATE",t[t.INVITE_UPDATE=41]="INVITE_UPDATE",t[t.INVITE_DELETE=42]="INVITE_DELETE",t[t.WEBHOOK_CREATE=50]="WEBHOOK_CREATE",t[t.WEBHOOK_UPDATE=51]="WEBHOOK_UPDATE",t[t.WEBHOOK_DELETE=52]="WEBHOOK_DELETE",t[t.EMOJI_CREATE=60]="EMOJI_CREATE",t[t.EMOJI_UPDATE=61]="EMOJI_UPDATE",t[t.EMOJI_DELETE=62]="EMOJI_DELETE",t[t.MESSAGE_DELETE=72]="MESSAGE_DELETE",t[t.MESSAGE_BULK_DELETE=73]="MESSAGE_BULK_DELETE",t[t.MESSAGE_PIN=74]="MESSAGE_PIN",t[t.MESSAGE_UNPIN=75]="MESSAGE_UNPIN",t[t.INTEGRATION_CREATE=80]="INTEGRATION_CREATE",t[t.INTEGRATION_UPDATE=81]="INTEGRATION_UPDATE",t[t.INTEGRATION_DELETE=82]="INTEGRATION_DELETE",t[t.STAGE_INSTANCE_CREATE=83]="STAGE_INSTANCE_CREATE",t[t.STAGE_INSTANCE_UPDATE=84]="STAGE_INSTANCE_UPDATE",t[t.STAGE_INSTANCE_DELETE=85]="STAGE_INSTANCE_DELETE",t[t.STICKER_CREATE=90]="STICKER_CREATE",t[t.STICKER_UPDATE=91]="STICKER_UPDATE",t[t.STICKER_DELETE=92]="STICKER_DELETE",t[t.GUILD_SCHEDULED_EVENT_CREATE=100]="GUILD_SCHEDULED_EVENT_CREATE",t[t.GUILD_SCHEDULED_EVENT_UPDATE=101]="GUILD_SCHEDULED_EVENT_UPDATE",t[t.GUILD_SCHEDULED_EVENT_DELETE=102]="GUILD_SCHEDULED_EVENT_DELETE",t[t.THREAD_CREATE=110]="THREAD_CREATE",t[t.THREAD_UPDATE=111]="THREAD_UPDATE",t[t.THREAD_DELETE=112]="THREAD_DELETE",t[t.APPLICATION_COMMAND_PERMISSION_UPDATE=121]="APPLICATION_COMMAND_PERMISSION_UPDATE",t[t.AUTO_MODERATION_RULE_CREATE=140]="AUTO_MODERATION_RULE_CREATE",t[t.AUTO_MODERATION_RULE_UPDATE=141]="AUTO_MODERATION_RULE_UPDATE",t[t.AUTO_MODERATION_RULE_DELETE=142]="AUTO_MODERATION_RULE_DELETE",t[t.AUTO_MODERATION_BLOCK_MESSAGE=143]="AUTO_MODERATION_BLOCK_MESSAGE",t[t.AUTO_MODERATION_FLAG_TO_CHANNEL=144]="AUTO_MODERATION_FLAG_TO_CHANNEL",t[t.AUTO_MODERATION_USER_COMMUNICATION_DISABLED=145]="AUTO_MODERATION_USER_COMMUNICATION_DISABLED"})(i=e.Type||(e.Type={}))})(J||(J={}));o.define({"/guilds/{guild.id}/audit-logs":{GET:"getGuildAuditLog"}});var Q;(e=>{let i;(E=>{E[E.MESSAGE_SEND=1]="MESSAGE_SEND"})(i=e.EventType||(e.EventType={}));let t;(E=>{E[E.KEYWORD=1]="KEYWORD",E[E.SPAM=3]="SPAM",E[E.KEYWORD_PRESET=4]="KEYWORD_PRESET",E[E.MENTION_SPAM=5]="MENTION_SPAM"})(t=e.TriggerType||(e.TriggerType={}));let s;(E=>{E[E.PROFANITY=1]="PROFANITY",E[E.SEXUAL_CONTEN=2]="SEXUAL_CONTEN",E[E.SLURS=3]="SLURS"})(s=e.KeywordPresetType||(e.KeywordPresetType={}))})(Q||(Q={}));var q;(e=>{let i;(t=>{t[t.BLOCK_MESSAGE=1]="BLOCK_MESSAGE",t[t.SEND_ALERT_MESSAGE=2]="SEND_ALERT_MESSAGE",t[t.TIMEOUT=3]="TIMEOUT"})(i=e.Type||(e.Type={}))})(q||(q={}));o.define({"/guilds/{guild.id}/auto-moderation/rules":{GET:"listAutoModerationRules",POST:"createAutoModerationRule"},"/guilds/{guild.id}/auto-moderation/rules/{rule.id}":{GET:"getAutoModerationRule",PATCH:"modifyAutoModerationRule",DELETE:"deleteAutoModerationRule"}});o.define({"/guilds/{guild.id}/bans":{GET:"getGuildBans"},"/guilds/{guild.id}/bans/{user.id}":{GET:"getGuildBan",PUT:"createGuildBan",DELETE:"removeGuildBan"}});var G;(e=>{let i;(t=>{t[t.GUILD_TEXT=0]="GUILD_TEXT",t[t.DM=1]="DM",t[t.GUILD_VOICE=2]="GUILD_VOICE",t[t.GROUP_DM=3]="GROUP_DM",t[t.GUILD_CATEGORY=4]="GUILD_CATEGORY",t[t.GUILD_NEWS=5]="GUILD_NEWS",t[t.GUILD_STORE=6]="GUILD_STORE",t[t.GUILD_NEWS_THREAD=10]="GUILD_NEWS_THREAD",t[t.GUILD_PUBLIC_THREAD=11]="GUILD_PUBLIC_THREAD",t[t.GUILD_PRIVATE_THREAD=12]="GUILD_PRIVATE_THREAD",t[t.GUILD_STAGE_VOICE=13]="GUILD_STAGE_VOICE",t[t.GUILD_DIRECTORY=14]="GUILD_DIRECTORY",t[t.GUILD_FORUM=15]="GUILD_FORUM"})(i=e.Type||(e.Type={}))})(G||(G={}));var Ne=(e=>(e[e.ROLE=0]="ROLE",e[e.MEMBER=1]="MEMBER",e))(Ne||{}),ue=(e=>(e.ROLE_MENTIONS="roles",e.USER_MENTIONS="users",e.EVERYONE_MENTIONS="everyone",e))(ue||{});o.define({"/users/@me/channels":{POST:["createDM","createGroupDM"]}});o.define({"/guilds/{guild.id}/channels":{GET:"getGuildChannels",POST:"createGuildChannel",PATCH:"modifyGuildChannelPositions"}});o.define({"/channels/{channel.id}":{GET:"getChannel",PATCH:"modifyChannel",DELETE:"deleteChannel"},"/channels/{channel.id}/permissions/{overwrite.id}":{PUT:"editChannelPermissions",DELETE:"deleteChannelPermission"},"/channels/{channel.id}/followers":{POST:"followNewsChannel"},"/channels/{channel.id}/typing":{POST:"triggerTypingIndicator"},"/channels/{channel.id}/recipients/{user.id}":{PUT:"groupDMAddRecipient",DELETE:"groupDMRemoveRecipient"}});var h;(e=>{let i;(E=>{E[E.CHAT_INPUT=1]="CHAT_INPUT",E[E.USER=2]="USER",E[E.MESSAGE=3]="MESSAGE"})(i=e.Type||(e.Type={}));let t;(E=>{E[E.SUB_COMMAND=1]="SUB_COMMAND",E[E.SUB_COMMAND_GROUP=2]="SUB_COMMAND_GROUP",E[E.STRING=3]="STRING",E[E.INTEGER=4]="INTEGER",E[E.BOOLEAN=5]="BOOLEAN",E[E.USER=6]="USER",E[E.CHANNEL=7]="CHANNEL",E[E.ROLE=8]="ROLE",E[E.MENTIONABLE=9]="MENTIONABLE",E[E.NUMBER=10]="NUMBER",E[E.ATTACHMENT=11]="ATTACHMENT"})(t=e.OptionType||(e.OptionType={}));let s;(E=>{E[E.ROLE=1]="ROLE",E[E.USER=2]="USER",E[E.CHANNEL=3]="CHANNEL"})(s=e.PermissionType||(e.PermissionType={}))})(h||(h={}));o.define({"/applications/{application.id}/commands":{GET:"getGlobalApplicationCommands",POST:"createGlobalApplicationCommand",PUT:"bulkOverwriteGlobalApplicationCommands"},"/applications/{application.id}/commands/{command.id}":{GET:"getGlobalApplicationCommand",PATCH:"editGlobalApplicationCommand",DELETE:"deleteGlobalApplicationCommand"},"/applications/{application.id}/guilds/{guild.id}/commands":{GET:"getGuildApplicationCommands",POST:"createGuildApplicationCommand",PUT:"bulkOverwriteGuildApplicationCommands"},"/applications/{application.id}/guilds/{guild.id}/commands/{command.id}":{GET:"getGuildApplicationCommand",PATCH:"editGuildApplicationCommand",DELETE:"deleteGuildApplicationCommand"},"/applications/{application.id}/guilds/{guild.id}/commands/permissions":{GET:"getGuildApplicationCommandPermissions"},"/applications/{application.id}/guilds/{guild.id}/commands/{command.id}/permissions":{GET:"getApplicationCommandPermissions",PUT:"editApplicationCommandPermissions"}});var Oe=(e=>(e[e.ACTION_ROW=1]="ACTION_ROW",e[e.BUTTON=2]="BUTTON",e[e.SELECT_MENU=3]="SELECT_MENU",e[e.TEXT_INPUT=4]="TEXT_INPUT",e[e.USER_SELECT=5]="USER_SELECT",e[e.ROLE_SELECT=6]="ROLE_SELECT",e[e.MENTIONABLE_SELECT=7]="MENTIONABLE_SELECT",e[e.CHANNEL_SELECT=8]="CHANNEL_SELECT",e))(Oe||{}),De=(e=>(e[e.PRIMARY=1]="PRIMARY",e[e.SECONDARY=2]="SECONDARY",e[e.SUCCESS=3]="SUCCESS",e[e.DANGER=4]="DANGER",e[e.LINK=5]="LINK",e))(De||{}),Ce=(e=>(e[e.SHORT=1]="SHORT",e[e.PARAGRAPH=2]="PARAGRAPH",e))(Ce||{}),Le=(e=>(e.AUDIO_INPUT="audioinput",e.AUDIO_OUTPUT="audiooutput",e.VIDEO_INPUT="videoinput",e))(Le||{});o.define({"/guilds/{guild.id}/emojis":{GET:"listGuildEmojis",POST:"createGuildEmoji"},"/guilds/{guild.id}/emojis/{emoji.id}":{GET:"getGuildEmoji",PATCH:"modifyGuildEmoji",DELETE:"deleteGuildEmoji"}});var I;(e=>{let i;(s=>{s[s.DISPATCH=0]="DISPATCH",s[s.HEARTBEAT=1]="HEARTBEAT",s[s.IDENTIFY=2]="IDENTIFY",s[s.PRESENCE_UPDATE=3]="PRESENCE_UPDATE",s[s.VOICE_STATE_UPDATE=4]="VOICE_STATE_UPDATE",s[s.RESUME=6]="RESUME",s[s.RECONNECT=7]="RECONNECT",s[s.REQUEST_GUILD_MEMBERS=8]="REQUEST_GUILD_MEMBERS",s[s.INVALID_SESSION=9]="INVALID_SESSION",s[s.HELLO=10]="HELLO",s[s.HEARTBEAT_ACK=11]="HEARTBEAT_ACK"})(i=e.Opcode||(e.Opcode={}));let t;(s=>{s[s.GUILDS=1]="GUILDS",s[s.GUILD_MEMBERS=2]="GUILD_MEMBERS",s[s.GUILD_BANS=4]="GUILD_BANS",s[s.GUILD_EMOJIS_AND_STICKERS=8]="GUILD_EMOJIS_AND_STICKERS",s[s.GUILD_INTEGRATIONS=16]="GUILD_INTEGRATIONS",s[s.GUILD_WEBHOOKS=32]="GUILD_WEBHOOKS",s[s.GUILD_INVITES=64]="GUILD_INVITES",s[s.GUILD_VOICE_STATES=128]="GUILD_VOICE_STATES",s[s.GUILD_PRESENCES=256]="GUILD_PRESENCES",s[s.GUILD_MESSAGES=512]="GUILD_MESSAGES",s[s.GUILD_MESSAGE_REACTIONS=1024]="GUILD_MESSAGE_REACTIONS",s[s.GUILD_MESSAGE_TYPING=2048]="GUILD_MESSAGE_TYPING",s[s.DIRECT_MESSAGES=4096]="DIRECT_MESSAGES",s[s.DIRECT_MESSAGE_REACTIONS=8192]="DIRECT_MESSAGE_REACTIONS",s[s.DIRECT_MESSAGE_TYPING=16384]="DIRECT_MESSAGE_TYPING",s[s.MESSAGE_CONTENT=32768]="MESSAGE_CONTENT",s[s.GUILD_SCHEDULED_EVENTS=65536]="GUILD_SCHEDULED_EVENTS",s[s.AUTO_MODERATION_CONFIGURATION=1048576]="AUTO_MODERATION_CONFIGURATION",s[s.AUTO_MODERATION_EXECUTION=2097152]="AUTO_MODERATION_EXECUTION"})(t=e.Intent||(e.Intent={}))})(I||(I={}));o.define({"/gateway":{GET:"getGateway"},"/gateway/bot":{GET:"getGatewayBot"}});o.define({"/guilds/{guild.id}/members/{user.id}":{GET:"getGuildMember",PUT:"addGuildMember",PATCH:"modifyGuildMember",DELETE:"removeGuildMember"},"/guilds/{guild.id}/members":{GET:"listGuildMembers"},"/guilds/{guild.id}/members/search":{GET:"searchGuildMembers"},"/guilds/{guild.id}/members/@me":{PATCH:"modifyCurrentMember"},"/guilds/{guild.id}/members/{user.id}/roles/{role.id}":{PUT:"addGuildMemberRole",DELETE:"removeGuildMemberRole"},"/guilds/{guild.id}/prune":{GET:"getGuildPruneCount",POST:"beginGuildPrune"}});o.define({"/guilds/templates/{template.code}":{GET:"getGuildTemplate",POST:"createGuildfromGuildTemplate"},"/guilds/{guild.id}/templates":{GET:"getGuildTemplates",POST:"createGuildTemplate"},"/guilds/{guild.id}/templates/{template.code}":{PUT:"syncGuildTemplate",PATCH:"modifyGuildTemplate",DELETE:"deleteGuildTemplate"}});var z;(e=>{let i;(t=>{let s;(E=>{E.shield="shield",E.banner1="banner1",E.banner2="banner2",E.banner3="banner3",E.banner4="banner4"})(s=t.WidgetStyleOptions||(t.WidgetStyleOptions={}))})(i=e.Params||(e.Params={}))})(z||(z={}));var Me=(e=>(e[e.SUPPRESS_JOIN_NOTIFICATIONS=1]="SUPPRESS_JOIN_NOTIFICATIONS",e[e.SUPPRESS_PREMIUM_SUBSCRIPTIONS=2]="SUPPRESS_PREMIUM_SUBSCRIPTIONS",e[e.SUPPRESS_GUILD_REMINDER_NOTIFICATIONS=4]="SUPPRESS_GUILD_REMINDER_NOTIFICATIONS",e[e.SUPPRESS_JOIN_NOTIFICATION_REPLIES=8]="SUPPRESS_JOIN_NOTIFICATION_REPLIES",e[e.SUPPRESS_ROLE_SUBSCRIPTION_PURCHASE_NOTIFICATIONS=16]="SUPPRESS_ROLE_SUBSCRIPTION_PURCHASE_NOTIFICATIONS",e[e.SUPPRESS_ROLE_SUBSCRIPTION_PURCHASE_NOTIFICATION_REPLIES=32]="SUPPRESS_ROLE_SUBSCRIPTION_PURCHASE_NOTIFICATION_REPLIES",e))(Me||{}),Ge=(e=>(e.ANIMATED_ICON="ANIMATED_ICON",e.BANNER="BANNER",e.COMMERCE="COMMERCE",e.COMMUNITY="COMMUNITY",e.DISCOVERABLE="DISCOVERABLE",e.FEATURABLE="FEATURABLE",e.INVITE_SPLASH="INVITE_SPLASH",e.MEMBER_VERIFICATION_GATE_ENABLED="MEMBER_VERIFICATION_GATE_ENABLED",e.MONETIZATION_ENABLED="MONETIZATION_ENABLED",e.MORE_STICKERS="MORE_STICKERS",e.NEWS="NEWS",e.PARTNERED="PARTNERED",e.PREVIEW_ENABLED="PREVIEW_ENABLED",e.PRIVATE_THREADS="PRIVATE_THREADS",e.ROLE_ICONS="ROLE_ICONS",e.SEVEN_DAY_THREAD_ARCHIVE="SEVEN_DAY_THREAD_ARCHIVE",e.THREE_DAY_THREAD_ARCHIVE="THREE_DAY_THREAD_ARCHIVE",e.TICKETED_EVENTS_ENABLED="TICKETED_EVENTS_ENABLED",e.VANITY_URL="VANITY_URL",e.VERIFIED="VERIFIED",e.VIP_REGIONS="VIP_REGIONS",e.WELCOME_SCREEN_ENABLED="WELCOME_SCREEN_ENABLED",e))(Ge||{});o.define({"/users/@me/guilds":{GET:"getCurrentUserGuilds"},"/users/@me/guilds/{guild.id}/member":{GET:"getCurrentUserGuildMember"},"/users/@me/guilds/{guild.id}":{DELETE:"leaveGuild"}});o.define({"/guilds":{POST:"createGuild"},"/guilds/{guild.id}":{GET:"getGuild",PATCH:"modifyGuild",DELETE:"deleteGuild"},"/guilds/{guild.id}/preview":{GET:"getGuildPreview"},"/guilds/{guild.id}/widget":{GET:"getGuildWidgetSettings",PATCH:"modifyGuildWidget"},"/guilds/{guild.id}/widget.json":{GET:"getGuildWidget"},"/guilds/{guild.id}/widget.png":{GET:"getGuildWidgetImage"},"/guilds/{guild.id}/welcome-screen":{GET:"getGuildWelcomeScreen",PATCH:"modifyGuildWelcomeScreen"}});var fe=(e=>(e[e.REMOVE_ROLE=0]="REMOVE_ROLE",e[e.KICK=1]="KICK",e))(fe||{});o.define({"/guilds/{guild.id}/integrations":{GET:"getGuildIntegrations"},"/guilds/{guild.id}/integrations/{integration.id}":{DELETE:"deleteGuildIntegration"}});var S;(e=>{let i;(t=>{t[t.PING=1]="PING",t[t.APPLICATION_COMMAND=2]="APPLICATION_COMMAND",t[t.MESSAGE_COMPONENT=3]="MESSAGE_COMPONENT",t[t.APPLICATION_COMMAND_AUTOCOMPLETE=4]="APPLICATION_COMMAND_AUTOCOMPLETE",t[t.MODAL_SUBMIT=5]="MODAL_SUBMIT"})(i=e.Type||(e.Type={}))})(S||(S={}));(e=>{let i;(t=>{t[t.PONG=1]="PONG",t[t.CHANNEL_MESSAGE_WITH_SOURCE=4]="CHANNEL_MESSAGE_WITH_SOURCE",t[t.DEFERRED_CHANNEL_MESSAGE_WITH_SOURCE=5]="DEFERRED_CHANNEL_MESSAGE_WITH_SOURCE",t[t.DEFERRED_UPDATE_MESSAGE=6]="DEFERRED_UPDATE_MESSAGE",t[t.UPDATE_MESSAGE=7]="UPDATE_MESSAGE",t[t.APPLICATION_COMMAND_AUTOCOMPLETE_RESULT=8]="APPLICATION_COMMAND_AUTOCOMPLETE_RESULT",t[t.MODAL=9]="MODAL"})(i=e.CallbackType||(e.CallbackType={}))})(S||(S={}));o.define({"/interactions/{interaction.id}/{interaction.token}/callback":{POST:"createInteractionResponse"},"/webhooks/{application.id}/{interaction.token}/messages/@original":{GET:"getOriginalInteractionResponse",PATCH:"editOriginalInteractionResponse",DELETE:"deleteOriginalInteractionResponse"},"/webhooks/{application.id}/{interaction.token}":{POST:"createFollowupMessage"},"/webhooks/{application.id}/{interaction.token}/messages/{message.id}":{GET:"getFollowupMessage",PATCH:"editFollowupMessage",DELETE:"deleteFollowupMessage"}});var X;(e=>{let i;(t=>{t[t.STREAM=1]="STREAM",t[t.EMBEDDED_APPLICATION=2]="EMBEDDED_APPLICATION"})(i=e.TargetType||(e.TargetType={}))})(X||(X={}));o.define({"/invites/{invite.code}":{GET:"getInvite",DELETE:"deleteInvite"},"/guilds/{guild.id}/invites":{GET:"getGuildInvites"},"/guilds/{guild.id}/vanity-url":{GET:"getGuildVanityURL"},"/channels/{channel.id}/invites":{GET:"getChannelInvites",POST:"createChannelInvite"}});var v;(e=>{let i;(E=>{E[E.DEFAULT=0]="DEFAULT",E[E.RECIPIENT_ADD=1]="RECIPIENT_ADD",E[E.RECIPIENT_REMOVE=2]="RECIPIENT_REMOVE",E[E.CALL=3]="CALL",E[E.CHANNEL_NAME_CHANGE=4]="CHANNEL_NAME_CHANGE",E[E.CHANNEL_ICON_CHANGE=5]="CHANNEL_ICON_CHANGE",E[E.CHANNEL_PINNED_MESSAGE=6]="CHANNEL_PINNED_MESSAGE",E[E.GUILD_MEMBER_JOIN=7]="GUILD_MEMBER_JOIN",E[E.USER_PREMIUM_GUILD_SUBSCRIPTION=8]="USER_PREMIUM_GUILD_SUBSCRIPTION",E[E.USER_PREMIUM_GUILD_SUBSCRIPTION_TIER_1=9]="USER_PREMIUM_GUILD_SUBSCRIPTION_TIER_1",E[E.USER_PREMIUM_GUILD_SUBSCRIPTION_TIER_2=10]="USER_PREMIUM_GUILD_SUBSCRIPTION_TIER_2",E[E.USER_PREMIUM_GUILD_SUBSCRIPTION_TIER_3=11]="USER_PREMIUM_GUILD_SUBSCRIPTION_TIER_3",E[E.CHANNEL_FOLLOW_ADD=12]="CHANNEL_FOLLOW_ADD",E[E.GUILD_DISCOVERY_DISQUALIFIED=14]="GUILD_DISCOVERY_DISQUALIFIED",E[E.GUILD_DISCOVERY_REQUALIFIED=15]="GUILD_DISCOVERY_REQUALIFIED",E[E.GUILD_DISCOVERY_GRACE_PERIOD_INITIAL_WARNING=16]="GUILD_DISCOVERY_GRACE_PERIOD_INITIAL_WARNING",E[E.GUILD_DISCOVERY_GRACE_PERIOD_FINAL_WARNING=17]="GUILD_DISCOVERY_GRACE_PERIOD_FINAL_WARNING",E[E.THREAD_CREATED=18]="THREAD_CREATED",E[E.REPLY=19]="REPLY",E[E.CHAT_INPUT_COMMAND=20]="CHAT_INPUT_COMMAND",E[E.THREAD_STARTER_MESSAGE=21]="THREAD_STARTER_MESSAGE",E[E.GUILD_INVITE_REMINDER=22]="GUILD_INVITE_REMINDER",E[E.CONTEXT_MENU_COMMAND=23]="CONTEXT_MENU_COMMAND",E[E.AUTO_MODERATION_ACTION=24]="AUTO_MODERATION_ACTION",E[E.ROLE_SUBSCRIPTION_PURCHASE=25]="ROLE_SUBSCRIPTION_PURCHASE",E[E.INTERACTION_PREMIUM_UPSELL=26]="INTERACTION_PREMIUM_UPSELL",E[E.GUILD_APPLICATION_PREMIUM_SUBSCRIPTION=32]="GUILD_APPLICATION_PREMIUM_SUBSCRIPTION"})(i=e.Type||(e.Type={}));let t;(E=>{E[E.JOIN=1]="JOIN",E[E.SPECTATE=2]="SPECTATE",E[E.LISTEN=3]="LISTEN",E[E.JOIN_REQUEST=5]="JOIN_REQUEST"})(t=e.ActivityType||(e.ActivityType={}));let s;(E=>{E[E.CROSSPOSTED=1]="CROSSPOSTED",E[E.IS_CROSSPOST=2]="IS_CROSSPOST",E[E.SUPPRESS_EMBEDS=4]="SUPPRESS_EMBEDS",E[E.SOURCE_MESSAGE_DELETED=8]="SOURCE_MESSAGE_DELETED",E[E.URGENT=16]="URGENT",E[E.HAS_THREAD=32]="HAS_THREAD",E[E.EPHEMERAL=64]="EPHEMERAL",E[E.LOADING=128]="LOADING",E[E.FAILED_TO_MENTION_SOME_ROLES_IN_THREAD=256]="FAILED_TO_MENTION_SOME_ROLES_IN_THREAD",E[E.SUPPRESS_NOTIFICATIONS=4096]="SUPPRESS_NOTIFICATIONS",E[E.IS_VOICE_MESSAGE=8192]="IS_VOICE_MESSAGE"})(s=e.Flag||(e.Flag={}))})(v||(v={}));o.define({"/channels/{channel.id}/messages":{GET:"getChannelMessages",POST:"createMessage"},"/channels/{channel.id}/messages/{message.id}":{GET:"getChannelMessage",PATCH:"editMessage",DELETE:"deleteMessage"},"/channels/{channel.id}/messages/{message.id}/crosspost":{POST:"crosspostMessage"},"/channels/{channel.id}/messages/bulk-delete":{POST:"bulkDeleteMessages"},"/channels/{channel.id}/pins":{GET:"getPinnedMessages"},"/channels/{channel.id}/pins/{message.id}":{PUT:"pinMessage",DELETE:"unpinMessage"}});var me=(e=>(e.ONLINE="ONLINE",e.DND="DND",e.IDLE="IDLE",e.OFFLINE="OFFLINE",e))(me||{}),ge=(e=>(e[e.GAME=0]="GAME",e[e.STREAMING=1]="STREAMING",e[e.LISTENING=2]="LISTENING",e[e.WATCHING=3]="WATCHING",e[e.CUSTOM=4]="CUSTOM",e[e.COMPETING=5]="COMPETING",e))(ge||{}),Ue=(e=>(e[e.INSTANCE=1]="INSTANCE",e[e.JOIN=2]="JOIN",e[e.SPECTATE=4]="SPECTATE",e[e.JOIN_REQUEST=8]="JOIN_REQUEST",e[e.SYNC=16]="SYNC",e[e.PLAY=32]="PLAY",e[e.PARTY_PRIVACY_FRIENDS=64]="PARTY_PRIVACY_FRIENDS",e[e.PARTY_PRIVACY_VOICE_CHANNEL=128]="PARTY_PRIVACY_VOICE_CHANNEL",e[e.EMBEDDED=256]="EMBEDDED",e))(Ue||{});o.define({"/channels/{channel.id}/messages/{message.id}/reactions/{emoji}/@me":{PUT:"createReaction",DELETE:"deleteOwnReaction"},"/channels/{channel.id}/messages/{message.id}/reactions/{emoji}/{user.id}":{DELETE:"deleteUserReaction"},"/channels/{channel.id}/messages/{message.id}/reactions/{emoji}":{GET:"getReactions",DELETE:"deleteAllReactionsforEmoji"},"/channels/{channel.id}/messages/{message.id}/reactions":{DELETE:"deleteAllReactions"}});var Fe={CREATE_INSTANT_INVITE:1n<<0n,KICK_MEMBERS:1n<<1n,BAN_MEMBERS:1n<<2n,ADMINISTRATOR:1n<<3n,MANAGE_CHANNELS:1n<<4n,MANAGE_GUILD:1n<<5n,ADD_REACTIONS:1n<<6n,VIEW_AUDIT_LOG:1n<<7n,PRIORITY_SPEAKER:1n<<8n,STREAM:1n<<9n,VIEW_CHANNEL:1n<<10n,SEND_MESSAGES:1n<<11n,SEND_TTS_MESSAGES:1n<<12n,MANAGE_MESSAGES:1n<<13n,EMBED_LINKS:1n<<14n,ATTACH_FILES:1n<<15n,READ_MESSAGE_HISTORY:1n<<16n,MENTION_EVERYONE:1n<<17n,USE_EXTERNAL_EMOJIS:1n<<18n,VIEW_GUILD_INSIGHTS:1n<<19n,CONNECT:1n<<20n,SPEAK:1n<<21n,MUTE_MEMBERS:1n<<22n,DEAFEN_MEMBERS:1n<<23n,MOVE_MEMBERS:1n<<24n,USE_VAD:1n<<25n,CHANGE_NICKNAME:1n<<26n,MANAGE_NICKNAMES:1n<<27n,MANAGE_ROLES:1n<<28n,MANAGE_WEBHOOKS:1n<<29n,MANAGE_EMOJIS_AND_STICKERS:1n<<30n,USE_APPLICATION_COMMANDS:1n<<31n,REQUEST_TO_SPEAK:1n<<32n,MANAGE_THREADS:1n<<34n,CREATE_PUBLIC_THREADS:1n<<35n,CREATE_PRIVATE_THREADS:1n<<36n,USE_EXTERNAL_STICKERS:1n<<37n,SEND_MESSAGES_IN_THREADS:1n<<38n,START_EMBEDDED_ACTIVITIES:1n<<39n,MODERATE_MEMBERS:1n<<40n};o.define({"/guilds/{guild.id}/roles":{GET:"getGuildRoles",POST:"createGuildRole",PATCH:"modifyGuildRolePositions"},"/guilds/{guild.id}/roles/{role.id}":{PATCH:"modifyGuildRole",DELETE:"deleteGuildRole"}});var Z;(e=>{let i;(E=>{E[E.GUILD_ONLY=2]="GUILD_ONLY"})(i=e.PrivacyLevel||(e.PrivacyLevel={}));let t;(E=>{E[E.STAGE_INSTANCE=1]="STAGE_INSTANCE",E[E.VOICE=2]="VOICE",E[E.EXTERNAL=3]="EXTERNAL"})(t=e.EntityType||(e.EntityType={}));let s;(E=>{E[E.SCHEDULED=1]="SCHEDULED",E[E.ACTIVE=2]="ACTIVE",E[E.COMPLETED=3]="COMPLETED",E[E.CANCELLED=4]="CANCELLED"})(s=e.Status||(e.Status={}))})(Z||(Z={}));o.define({"/guilds/{guild.id}/scheduled-events":{GET:"listScheduledEventsforGuild",POST:"createGuildScheduledEvent"},"/guilds/{guild.id}/scheduled-events/{guild_scheduled_event.id}":{GET:"getGuildScheduledEvent",PATCH:"modifyGuildScheduledEvent",DELETE:"deleteGuildScheduledEvent"},"/guilds/{guild.id}/scheduled-events/{guild_scheduled_event.id}/users":{GET:"getGuildScheduledEventUsers"}});o.define({"/stage-instances":{POST:"createStageInstance"},"/stage-instances/{channel.id}":{GET:"getStageInstance",PATCH:"modifyStageInstance",DELETE:"deleteStageInstance"}});var F;(e=>{let i;(s=>{s[s.STANDARD=1]="STANDARD",s[s.GUILD=2]="GUILD"})(i=e.Type||(e.Type={}));let t;(s=>{s[s.PNG=1]="PNG",s[s.APNG=2]="APNG",s[s.LOTTIE=3]="LOTTIE",s[s.GIF=4]="GIF"})(t=e.FormatType||(e.FormatType={}))})(F||(F={}));o.define({"/stickers/{sticker.id}":{GET:"getSticker"},"/sticker-packs":{GET:"listNitroStickerPacks"},"/guilds/{guild.id}/stickers":{GET:"listGuildStickers",POST:"createGuildSticker"},"/guilds/{guild.id}/stickers/{sticker.id}":{GET:"getGuildSticker",PATCH:"modifyGuildSticker",DELETE:"deleteGuildSticker"}});var Pe=(e=>(e[e.INVITED=1]="INVITED",e[e.ACCEPTED=2]="ACCEPTED",e))(Pe||{});o.define({"/channels/{channel.id}/messages/{message.id}/threads":{POST:"startThreadFromMessage"},"/channels/{channel.id}/threads":{POST:["startThreadWithoutMessage","startThreadInForumChannel"]},"/channels/{channel.id}/thread-members/@me":{PUT:"joinThread",DELETE:"leaveThread"},"/channels/{channel.id}/thread-members/{user.id}":{PUT:"addThreadMember",DELETE:"removeThreadMember",GET:"getThreadMember"},"/channels/{channel.id}/thread-members":{GET:"listThreadMembers"},"/channels/{channel.id}/threads/archived/public":{GET:"listPublicArchivedThreads"},"/channels/{channel.id}/threads/archived/private":{GET:"listPrivateArchivedThreads"},"/channels/{channel.id}/users/@me/threads/archived/private":{GET:"listJoinedPrivateArchivedThreads"}});var be=(e=>(e[e.NONE=0]="NONE",e[e.DISCORD_EMPLOYEE=1]="DISCORD_EMPLOYEE",e[e.PARTNERED_SERVER_OWNER=2]="PARTNERED_SERVER_OWNER",e[e.HYPESQUAD_EVENTS=4]="HYPESQUAD_EVENTS",e[e.BUG_HUNTER_LEVEL_1=8]="BUG_HUNTER_LEVEL_1",e[e.HOUSE_BRAVERY=64]="HOUSE_BRAVERY",e[e.HOUSE_BRILLIANCE=128]="HOUSE_BRILLIANCE",e[e.HOUSE_BALANCE=256]="HOUSE_BALANCE",e[e.EARLY_SUPPORTER=512]="EARLY_SUPPORTER",e[e.TEAM_USER=1024]="TEAM_USER",e[e.BUG_HUNTER_LEVEL_2=16384]="BUG_HUNTER_LEVEL_2",e[e.VERIFIED_BOT=65536]="VERIFIED_BOT",e[e.EARLY_VERIFIED_BOT_DEVELOPER=131072]="EARLY_VERIFIED_BOT_DEVELOPER",e[e.DISCORD_CERTIFIED_MODERATOR=262144]="DISCORD_CERTIFIED_MODERATOR",e[e.BOT_HTTP_INTERACTIONS=524288]="BOT_HTTP_INTERACTIONS",e[e.ACTIVE_DEVELOPER=4194304]="ACTIVE_DEVELOPER",e))(be||{}),we=(e=>(e[e.NONE=0]="NONE",e[e.NITRO_CLASSIC=1]="NITRO_CLASSIC",e[e.NITRO=2]="NITRO",e[e.NITRO_BASIC=3]="NITRO_BASIC",e))(we||{}),He=(e=>(e[e.NONE=0]="NONE",e[e.EVERYONE=1]="EVERYONE",e))(He||{});o.define({"/users/@me":{GET:"getCurrentUser",PATCH:"modifyCurrentUser"},"/users/{user.id}":{GET:"getUser"},"/users/@me/connections":{GET:"getUserConnections"}});o.define({"/voice/regions":{GET:"listVoiceRegions"},"/guilds/{guild.id}/regions":{GET:"getGuildVoiceRegions"},"/guilds/{guild.id}/voice-states/@me":{PATCH:"modifyCurrentUserVoiceState"},"/guilds/{guild.id}/voice-states/{user.id}":{PATCH:"modifyUserVoiceState"}});var y;(e=>{let i;(t=>{t[t.INCOMING=1]="INCOMING",t[t.CHANNEL_FOLLOWER=2]="CHANNEL_FOLLOWER",t[t.APPLICATION=3]="APPLICATION"})(i=e.Type||(e.Type={}))})(y||(y={}));o.define({"/channels/{channel.id}/webhooks":{POST:"createWebhook",GET:"getChannelWebhooks"},"/guilds/{guild.id}/webhooks":{GET:"getGuildWebhooks"},"/webhooks/{webhook.id}":{GET:"getWebhook",PATCH:"modifyWebhook",DELETE:"deleteWebhook"},"/webhooks/{webhook.id}/{webhook.token}":{GET:"getWebhookwithToken",PATCH:"modifyWebhookwithToken",DELETE:"deleteWebhookwithToken",POST:"executeWebhook"},"/webhooks/{webhook.id}/{webhook.token}/slack":{POST:"executeSlackCompatibleWebhook"},"/webhooks/{webhook.id}/{webhook.token}/github":{POST:"executeGitHubCompatibleWebhook"},"/webhooks/{webhook.id}/{webhook.token}/messages/{message.id}":{GET:"getWebhookMessage",PATCH:"editWebhookMessage",DELETE:"deleteWebhookMessage"}});var ne=["da","de","en-GB","en-US","es-ES","fr","hr","it","lt","hu","nl","no","pl","pt-BR","ro","fi","sv-SE","vi","tr","cs","el","bg","ru","uk","hi","th","zh-CN","ja","zh-TW","ko"],ee=_(e=>e.replace(/[\\*_`~|()\[\]]/g,"\\$&").replace(/@everyone/g,()=>"\\@everyone").replace(/@here/g,()=>"\\@here"),"sanitize"),te=_(e=>e.replace(/(?<=`)(?=`)/g,"​"),"sanitizeCode"),D=_(e=>({id:e.id,nick:e.global_name,name:e.username,userId:e.id,avatar:e.avatar&&`https://cdn.discordapp.com/avatars/${e.id}/${e.avatar}.png`,username:e.username,discriminator:e.discriminator,isBot:e.bot||!1}),"decodeUser"),V=_(e=>({user:e.user&&D(e.user),nick:e.nick,roles:e.roles,joinedAt:e.joined_at&&new Date(e.joined_at).valueOf()}),"decodeGuildMember"),ie=_(e=>({id:e.id,name:e.name,avatar:e.icon&&`https://cdn.discordapp.com/icons/${e.id}/${e.icon}.webp?size=240`}),"decodeGuild"),p=_(e=>({id:e.id,name:e.name,type:e.type===G.Type.DM?d.Universal.Channel.Type.DIRECT:e.type===G.Type.GUILD_VOICE?d.Universal.Channel.Type.VOICE:e.type===G.Type.GUILD_CATEGORY?d.Universal.Channel.Type.CATEGORY:d.Universal.Channel.Type.TEXT,parentId:e.parent_id,position:e.position}),"decodeChannel"),P=_(e=>({...e,permissions:BigInt(e.permissions)}),"decodeRole"),Ee=_(e=>({...e,permissions:e.permissions&&""+e.permissions}),"encodeRole");async function C(e,i,t,s=t,E=!0){let{platform:r}=e;t.id=t.messageId=i.id,t.content="",i.content&&(t.content=i.content.replace(/<@[!&]?(.+?)>/g,(n,a)=>{if(i.mention_roles.includes(a))return(0,d.h)("at",{role:a}).toString();{let c=i.mentions?.find(l=>l.id===a||`${l.username}#${l.discriminator}`===a);return d.h.at(a,{name:c?.username}).toString()}}).replace(/<a?:(.*):(.+?)>/g,(n,a,c)=>{let l=n[1]==="a";return(0,d.h)("face",{id:c,name:a,animated:l,platform:r},[d.h.image(`https://cdn.discordapp.com/emojis/${c}.webp?quality=lossless`)]).toString()}).replace(/@everyone/g,()=>(0,d.h)("at",{type:"all"}).toString()).replace(/@here/g,()=>(0,d.h)("at",{type:"here"}).toString()).replace(/<#(.+?)>/g,(n,a)=>{let c=i.mention_channels?.find(l=>l.id===a);return d.h.sharp(a,{name:c?.name}).toString()})),i.sticker_items&&(t.content+=i.sticker_items.map(n=>(0,d.h)("sticker",{id:n.id,format_type:n.format_type,name:n.name},[d.h.image(`https://media.discordapp.net/stickers/${n.id}.webp?size=160`)])).join("")),i.attachments?.length&&(/\s$/.test(t.content)||(t.content+=" "),t.content+=i.attachments.map(n=>n.height&&n.width&&n.content_type?.startsWith("image/")?(0,d.h)("img",{src:n.url,proxy_url:n.proxy_url,file:n.filename,type:n.content_type,width:n.width,height:n.height}):n.height&&n.width&&n.content_type?.startsWith("video/")?(0,d.h)("video",{src:n.url,proxy_url:n.proxy_url,file:n.filename,type:n.content_type,width:n.width,height:n.height,size:n.size}):n.content_type?.startsWith("audio/")?(0,d.h)("record",{src:n.url,proxy_url:n.proxy_url,file:n.filename,type:n.content_type,size:n.size}):(0,d.h)("file",{src:n.url,proxy_url:n.proxy_url,file:n.filename,type:n.content_type,size:n.size})).join(""));for(let n of i.embeds)n.image&&(t.content+=(0,d.h)("img",{src:n.image.url,proxy_url:n.image.proxy_url})),n.thumbnail&&(t.content+=(0,d.h)("img",{src:n.thumbnail.url,proxy_url:n.thumbnail.proxy_url})),n.video&&(t.content+=(0,d.h)("video",{src:n.video.url,proxy_url:n.video.proxy_url}));if(t.elements=d.h.parse(t.content),E&&i.message_reference?.message_id){let{message_id:n,channel_id:a}=i.message_reference;t.quote=await e.getMessage(a,n,!1)}return t.createdAt=new Date(i.timestamp).valueOf(),t.updatedAt=i.edited_timestamp&&new Date(i.edited_timestamp).valueOf(),s&&(s.channel={id:i.channel_id,type:i.member?d.Universal.Channel.Type.TEXT:d.Universal.Channel.Type.DIRECT},s.user=D(i.author),s.member=i.member&&V(i.member),s.timestamp=new Date(i.timestamp).valueOf()),t}_(C,"decodeMessage");function U(e,i){e.guildId=i,e.isDirect=!i,e.subtype=i?"group":"private"}_(U,"setupMessageGuildId");function m(e,i){if(e.userId=i.user_id,e.messageId=i.message_id,e.guildId=i.guild_id,e.channelId=i.channel_id,e.isDirect=!i.guild_id,e.subtype=i.guild_id?"group":"private",!i.emoji)return;let{id:t,name:s}=i.emoji;e.content=t?`${s}:${t}`:s}_(m,"setupReaction");async function re(e,i){let t=e.session();if(t.setInternal("discord",i),i.t==="MESSAGE_CREATE"){if(U(t,i.d.guild_id),i.d.webhook_id&&!t.isDirect)try{if((await e.ensureWebhook(i.d.channel_id)).id===i.d.webhook_id)return}catch{}t.type="message",await C(e,i.d,t.event.message={},t.event)}else if(i.t==="MESSAGE_UPDATE"){t.type="message-updated";let s=await e._getMessage(i.d.channel_id,i.d.id);await C(e,s,t.event.message={},t.event);let E=await e.internal.getChannel(i.d.channel_id);U(t,E.guild_id)}else if(i.t==="MESSAGE_DELETE")t.type="message-deleted",t.messageId=i.d.id,t.channelId=i.d.channel_id,U(t,i.d.guild_id);else if(i.t==="MESSAGE_REACTION_ADD")t.type="reaction-added",m(t,i.d);else if(i.t==="MESSAGE_REACTION_REMOVE")t.type="reaction-deleted",t.subtype="one",m(t,i.d);else if(i.t==="MESSAGE_REACTION_REMOVE_ALL")t.type="reaction-deleted",t.subtype="all",m(t,i.d);else if(i.t==="MESSAGE_REACTION_REMOVE_EMOJI")t.type="reaction-deleted",t.subtype="emoji",m(t,i.d);else if(i.t==="GUILD_ROLE_CREATE")t.type="guild-role-added",t.guildId=i.d.guild_id,t.roleId=i.d.role.id,t.event.role=P(i.d.role);else if(i.t==="GUILD_ROLE_UPDATE")t.type="guild-role-updated",t.guildId=i.d.guild_id,t.roleId=i.d.role.id,t.event.role=P(i.d.role);else if(i.t==="GUILD_ROLE_DELETE")t.type="guild-role-added",t.guildId=i.d.guild_id,t.roleId=i.d.role_id;else if(i.t==="INTERACTION_CREATE"&&i.d.type===S.Type.APPLICATION_COMMAND){let s=i.d.data,E=e.commands.find(r=>r.name===s.name);if(!E)return;await e.internal.createInteractionResponse(i.d.id,i.d.token,{type:S.CallbackType.DEFERRED_CHANNEL_MESSAGE_WITH_SOURCE}),t.type="interaction/command",t.isDirect=!i.d.guild_id,t.subtype=i.d.guild_id?"group":"private",t.channelId=i.d.channel_id,t.guildId=i.d.guild_id,t.userId=t.isDirect?i.d.user.id:i.d.member.user.id,t.messageId=i.d.id,t.content="",t.event.argv=Be(s,E)}else if(i.t==="INTERACTION_CREATE"&&i.d.type===S.Type.MODAL_SUBMIT){let s=i.d.data;if(!s.custom_id.startsWith("input")&&!s.custom_id.includes(":"))return;let E=s.components[0].components[0].value;await e.internal.createInteractionResponse(i.d.id,i.d.token,{type:S.CallbackType.DEFERRED_UPDATE_MESSAGE}),t.type="interaction/command",t.isDirect=!i.d.guild_id,t.subtype=i.d.guild_id?"group":"private",t.channelId=i.d.channel_id,t.guildId=i.d.guild_id,t.userId=t.isDirect?i.d.user.id:i.d.member.user.id,t.messageId=i.d.id,t.content=E}else if(i.t==="INTERACTION_CREATE"&&i.d.type===S.Type.MESSAGE_COMPONENT){let s=i.d.data.custom_id;s.startsWith("input")&&s.includes(":")?await e.internal.createInteractionResponse(i.d.id,i.d.token,{type:S.CallbackType.MODAL,data:{custom_id:s,title:"Input",components:[{type:1,components:[{custom_id:s,type:4,label:"Command",value:s.slice(s.indexOf(":")+1),style:1}]}]}}):await e.internal.createInteractionResponse(i.d.id,i.d.token,{type:S.CallbackType.DEFERRED_UPDATE_MESSAGE}),t.type="interaction/button",t.isDirect=!i.d.guild_id,t.channelId=i.d.channel_id,t.guildId=i.d.guild_id,t.userId=t.isDirect?i.d.user.id:i.d.member.user.id,t.messageId=i.d.id,t.content="",t.event.button={id:s}}else if(i.t==="CHANNEL_UPDATE")t.type="channel-updated",t.guildId=i.d.guild_id,t.subtype=i.d.guild_id?"group":"private",t.channelId=i.d.id;else return;return t}_(re,"adaptSession");var B={text:h.OptionType.STRING,string:h.OptionType.STRING,boolean:h.OptionType.BOOLEAN,number:h.OptionType.NUMBER,integer:h.OptionType.INTEGER,posint:h.OptionType.INTEGER,natural:h.OptionType.INTEGER,bigint:h.OptionType.INTEGER,user:h.OptionType.STRING,channel:h.OptionType.STRING,guild:h.OptionType.STRING},ce=_(e=>!e||e.length<96?e:e.slice(0,93)+"...","trimDescription"),se=_(e=>({description:ce(e.description[""]||e.name),description_localizations:(0,d.valueMap)((0,d.pick)(e.description,ne),ce)}),"encodeDescription"),ke=_(e=>({...se(e),name:e.name,type:h.Type.CHAT_INPUT,options:K(e)}),"encodeCommand"),Be=_((e,i)=>{let t={name:i.name,arguments:[],options:{}},s=e.options;if(!s)return t;let E=s[0];if(E&&(E.type===h.OptionType.SUB_COMMAND||E.type===h.OptionType.SUB_COMMAND_GROUP)){let r=i.children.find(n=>n.name.endsWith("."+E.name));return r?Be(E,r):t}for(let r of i.arguments){let n=r.name.toLowerCase(),a=s.find(c=>c.name===n)?.value;a!==void 0&&t.arguments.push(a)}for(let r of i.options){let n=r.name.toLowerCase(),a=s.find(c=>c.name===n)?.value;a!==void 0&&(t.options[r.name]=a)}return t},"decodeArgv");function K(e){let i=[];if(e.children.length)i.push(...e.children.map(t=>({name:t.name.slice(e.name.length+1),type:t.children.length?h.OptionType.SUB_COMMAND_GROUP:h.OptionType.SUB_COMMAND,options:K(t),description:t.description[""]||t.name,description_localizations:(0,d.pick)(t.description,ne)})));else{for(let t of e.arguments)i.push({...se(t),name:t.name.toLowerCase().replace(/[^a-z0-9]/g,""),type:B[t.type]??B.text,required:t.required??!1});for(let t of e.options)i.push({...se(t),name:t.name.toLowerCase(),type:B[t.type]??B.text,required:!1,min_value:t.type==="posint"?1:t.type==="natural"?0:void 0})}return i.sort((t,s)=>+s.required-+t.required)}_(K,"encodeCommandOptions");var u=(M(),f(N)),he=class{constructor(e){this.type=e}static{_(this,"State")}author={};quote={};channel={};fakeMessageMap={};threadCreated=!1},b=class extends u.MessageEncoder{static{_(this,"DiscordMessageEncoder")}stack=[new he("message")];buffer="";addition={};figure=null;mode="default";listType=null;rows=[];async getUrl(){let e=this.options?.session?.discord;if(e?.t==="INTERACTION_CREATE")return`/webhooks/${e.d.application_id}/${e.d.token}`;if(this.stack[0].type==="forward"&&this.stack[0].channel?.id)if(this.stack[1].author.name||this.stack[1].author.avatar){let i=await this.ensureWebhook();return`/webhooks/${i.id}/${i.token}?wait=true&thread_id=${this.stack[0].channel?.id}`}else return`/channels/${this.stack[0].channel.id}/messages`;else if(this.stack[0].author.name||this.stack[0].author.avatar||this.stack[0].type==="forward"&&!this.stack[0].threadCreated){let i=await this.ensureWebhook();return`/webhooks/${i.id}/${i.token}?wait=true`}else return`/channels/${this.channelId}/messages`}async post(e,i){try{let t=await this.getUrl(),s=await this.bot.http.post(t,e,{headers:i}),E=this.bot.session(),r=await C(this.bot,s,E.event.message={},E.event);if(E.app.emit(E,"send",E),this.results.push(E.event.message),Object.defineProperty(E.event.message,"channel",{configurable:!0,get:_(()=>E.event.channel,"get")}),this.stack[0].type==="forward"&&!this.stack[0].threadCreated){this.stack[0].threadCreated=!0;let n=await this.bot.internal.startThreadFromMessage(this.channelId,s.id,{name:"Forward",auto_archive_duration:60});this.stack[0].channel=n}return r}catch(t){if(this.bot.http.isError(t)&&t.response){if(t.response.data?.code===10015)return this.bot.logger.debug("webhook has been deleted, recreating..., %o",t.response.data),this.bot.webhookLock[this.channelId]||(this.bot.webhooks[this.channelId]=null),await this.ensureWebhook(),this.post(e,i);t=new Error(`[${t.response.status}] ${JSON.stringify(t.response.data)}`)}this.errors.push(t)}}async sendEmbed(e,i){let{filename:t,data:s,type:E}=await this.bot.ctx.http.file(e.src||e.url,e),r=new FormData,n=new Blob([s],{type:E});return r.append("files[0]",n,e.file||t),r.append("payload_json",JSON.stringify(i)),this.post(r)}async sendAsset(e,i,t){let{handleMixedContent:s,handleExternalAsset:E}=this.bot.config;s==="separate"&&t.content&&(await this.post(t),t.content="");let r=_(async()=>(t.content&&await this.post(t),this.post({...t,content:i.src||i.url})),"sendDirect");if(await this.bot.http.isLocal(i.src||i.url))return await this.sendEmbed(i,t);let n=i.mode||E;return n==="download"||s==="attach"&&t.content||e==="file"?this.sendEmbed(i,t):n==="direct"||await this.checkMediaType(i.src||i.url,e)?r():this.sendEmbed(i,t)}checkMediaType(e,i){return e.startsWith("https://cdn.discordapp.com/")?!0:this.bot.ctx.http.head(e,{headers:{accept:i+"/*"},timeout:1e3}).then(t=>t.get("content-type").startsWith(i),()=>!1)}async ensureWebhook(){return this.bot.ensureWebhook(this.channelId)}async flush(){let e=this.buffer.trim();this.trimButtons(),!(!e&&!this.rows.length)&&(this.addition.components=this.rows,await this.post({...this.addition,content:e}),this.buffer="",this.addition={},this.rows=[])}decodeButton(e,i){let t=1;return e.class==="secondary"&&(t=2),e.class==="danger"&&(t=4),e.class==="success"&&(t=3),e.type==="link"?{type:2,url:e.href,label:i||"Link",style:5}:e.type==="input"?{type:2,custom_id:`input${e.id}:${e.text??""}`,label:i||"Input",style:t}:{type:2,custom_id:e.id,label:i||"Button",style:t}}lastRow(){this.rows.length||this.rows.push({type:1,components:[]});let e=this.rows[this.rows.length-1];return e.components.length>=5&&(this.rows.push({type:1,components:[]}),e=this.rows[this.rows.length-1]),e}trimButtons(){this.rows.length&&this.rows[this.rows.length-1].components.length===0&&this.rows.pop()}async visit(e){let{type:i,attrs:t,children:s}=e;if(i==="text")this.buffer+=ee(t.content);else if(i==="b"||i==="strong")this.buffer+="**",await this.render(s),this.buffer+="**";else if(i==="i"||i==="em")this.buffer+="*",await this.render(s),this.buffer+="*";else if(i==="u"||i==="ins")this.buffer+="__",await this.render(s),this.buffer+="__";else if(i==="s"||i==="del")this.buffer+="~~",await this.render(s),this.buffer+="~~";else if(i==="spl")this.buffer+="||",await this.render(s),this.buffer+="||";else if(i==="code")this.buffer+="``",this.buffer+=te(s.toString()),this.buffer+="``";else if(i==="code-block")this.buffer+=`\`\`\`${t.language??""}
`,this.buffer+=te(s.toString()),this.buffer+="\n```";else if(i==="a")this.buffer+="[",await this.render(s),this.buffer+="]",this.options.linkPreview?this.buffer+=`(${t.href})`:this.buffer+=`(<${t.href}>)`;else if(i==="br")this.buffer+=`
`;else if(i==="p")this.buffer.endsWith(`
`)||(this.buffer+=`
`),await this.render(s),this.buffer.endsWith(`
`)||(this.buffer+=`
`);else if(i==="blockquote")this.buffer.endsWith(`
`)||(this.buffer+=`
`),this.buffer+="> ",await this.render(s),this.buffer+=`
`;else if(i==="ul"||i==="ol")this.listType=i,await this.render(s),this.listType=null;else if(i==="li")this.buffer.endsWith(`
`)||(this.buffer+=`
`),this.listType==="ol"?this.buffer+="0. ":this.listType==="ul"&&(this.buffer+="- "),this.render(s),this.buffer+=`
`;else if(i==="at")t.id?this.buffer+=`<@${t.id}>`:t.type==="all"?this.buffer+="@everyone":t.type==="here"&&(this.buffer+="@here");else if(i==="sharp"&&t.id)this.buffer+=`<#${t.id}>`;else if(i==="face"){if(t.platform&&t.platform!==this.bot.platform)return this.render(s);this.buffer+=`<${t.animated?"a":""}:${t.name}:${t.id}>`}else if((i==="img"||i==="image"||i==="video")&&(t.src||t.url))this.mode==="figure"?this.figure=e:(await this.sendAsset(i,t,{...this.addition,content:this.buffer.trim()}),this.buffer="");else if(i==="share")await this.flush(),await this.post({...this.addition,embeds:[{...t}]});else if(i==="audio")await this.sendAsset("file",t,{...this.addition,content:"",attachments:[{waveform:"",id:0,duration_secs:t.duration??0}],flags:v.Flag.IS_VOICE_MESSAGE}),this.buffer="";else if(i==="author"){let{avatar:E,name:r}=t;E&&(this.addition.avatar_url=E),r&&(this.addition.username=r),this.stack[0].type==="message"&&(this.stack[0].author=t),this.stack[0].type==="forward"&&(this.stack[1].author=t)}else if(i==="quote"){await this.flush();let E=_(n=>n.replace(/\\([\\*_`~|()\[\]])/g,"$1"),"parse"),r=this.stack[this.stack[0].type==="forward"?1:0];if(!r.author.avatar&&!r.author.name&&this.stack[0].type!=="forward")await this.flush(),this.addition.message_reference={message_id:t.id};else{let n=t.id,a=this.session.guildId,c=this.channelId;this.stack[0].type==="forward"&&this.stack[0].fakeMessageMap[t.id]?.length>=1&&(n=this.stack[0].fakeMessageMap[t.id][0].id,c=this.stack[0].fakeMessageMap[t.id][0].channel.id);let l=await this.bot.getMessage(c,n);if(!a){let T=await this.bot.internal.getChannel(c);T.guild_id&&(a=T.guild_id)}if(!a){this.bot.logger.warn("skip <quote> due to missing guild id");return}this.addition.embeds=[{description:[ee(E(l.elements.filter(T=>T.type==="text").join("")).slice(0,30)),`<t:${Math.ceil(l.timestamp/1e3)}:R> [[ ↑ ]](https://discord.com/channels/${a}/${c}/${n})`].join(`

`),author:{name:l.user.name,icon_url:l.user.avatar}}]}}else if(i==="figure")await this.flush(),this.mode="figure",await this.render(s),await this.sendAsset(this.figure.type,this.figure.attrs,{...this.addition,content:this.buffer.trim()}),this.buffer="",this.mode="default";else if(i==="message"&&!t.forward)if(this.mode==="figure")await this.render(s),this.buffer+=`
`;else{let E=+this.results.length;await this.flush(),await this.render(s),await this.flush();let r=+this.results.length,n=this.results.slice(E,r);this.stack[0].type==="forward"&&t.id&&(this.stack[0].fakeMessageMap[t.id]=n),this.stack[0].type==="message"&&(this.stack[0].author={}),this.stack[0].type==="forward"&&(this.stack[1].author={})}else i==="button"?this.lastRow().components.push(this.decodeButton(t,s.join(""))):i==="button-group"?(this.rows.length&&this.rows[this.rows.length-1].components.length&&this.rows.push({type:1,components:[]}),await this.render(s),this.rows.push({type:1,components:[]})):i==="message"&&t.forward?(this.stack.unshift(new he("forward")),await this.render(s),await this.flush(),await this.bot.internal.modifyChannel(this.stack[0].channel.id,{archived:!0,locked:!0}),this.stack.shift()):await this.render(s)}};(e=>{e.Config=u.Schema.object({handleExternalAsset:u.Schema.union([u.Schema.const("download").description("先下载后发送"),u.Schema.const("direct").description("直接发送链接"),u.Schema.const("auto").description("发送一个 HEAD 请求，根据返回的 Content-Type 决定发送方式")]).role("radio").description("发送外链资源时采用的方式。").default("auto"),handleMixedContent:u.Schema.union([u.Schema.const("separate").description("将每个不同形式的内容分开发送"),u.Schema.const("attach").description("图片前如果有文本内容，则将文本作为图片的附带信息进行发送"),u.Schema.const("auto").description("如果图片本身采用直接发送则与前面的文本分开，否则将文本作为图片的附带信息发送")]).role("radio").description("发送图文等混合内容时采用的方式。").default("auto")}).description("发送设置")})(b||(b={}));var g=(M(),f(N)),w=class extends g.Adapter.WsClient{static{_(this,"WsClient")}_d=0;_ping;_sessionId="";_resumeUrl;async prepare(){if(this._resumeUrl)return this.bot.http.ws(this._resumeUrl+"/?v=10&encoding=json");let{url:e}=await this.bot.internal.getGatewayBot();return this.bot.http.ws(e+"/?v=10&encoding=json")}heartbeat(){this.bot.logger.debug(`heartbeat d ${this._d}`),this.socket.send(JSON.stringify({op:I.Opcode.HEARTBEAT,d:this._d}))}accept(){this.socket.addEventListener("message",async({data:e})=>{let i;e=e.toString();try{i=JSON.parse(e)}catch{return this.bot.logger.warn("cannot parse message",e)}if(this.bot.logger.debug(i),i.s&&(this._d=i.s),i.op===I.Opcode.HELLO&&(this._ping=setInterval(()=>this.heartbeat(),i.d.heartbeat_interval),this._sessionId?(this.bot.logger.debug("resuming"),this.socket.send(JSON.stringify({op:I.Opcode.RESUME,d:{token:this.bot.config.token,session_id:this._sessionId,seq:this._d}}))):this.socket.send(JSON.stringify({op:I.Opcode.IDENTIFY,d:{token:this.bot.config.token,properties:{},compress:!1,intents:this.bot.config.intents}}))),i.op===I.Opcode.INVALID_SESSION){if(i.d)return;this._sessionId="",this.bot.logger.warn("offline: invalid session"),this.socket?.close()}if(i.op===I.Opcode.DISPATCH){if(this.bot.dispatch(this.bot.session({type:"internal",_type:"discord/"+i.t.toLowerCase().replace(/_/g,"-"),_data:i.d})),i.t==="READY")return this._sessionId=i.d.session_id,this._resumeUrl=i.d.resume_gateway_url,this.bot.user=D(i.d.user),this.bot.logger.debug("session_id "+this._sessionId),this.bot.online();if(i.t==="RESUMED")return this.bot.online();let t=await re(this.bot,i);t&&this.bot.dispatch(t)}i.op===I.Opcode.RECONNECT&&(this.bot.logger.warn("offline: discord request reconnect"),this.socket?.close())}),this.socket.addEventListener("close",()=>{clearInterval(this._ping)})}};(e=>{e.Options=g.Schema.intersect([g.Schema.object({intents:g.Schema.bitset(I.Intent).description("需要订阅的机器人事件。").default(0|I.Intent.GUILD_MESSAGES|I.Intent.GUILD_MESSAGE_REACTIONS|I.Intent.DIRECT_MESSAGES|I.Intent.DIRECT_MESSAGE_REACTIONS|I.Intent.MESSAGE_CONTENT)}).description("推送设置"),g.Adapter.WsClientConfig])})(w||(w={}));var ye=le(),W=class extends A.Bot{static{_(this,"DiscordBot")}static MessageEncoder=b;static inject=["http"];http;internal;webhooks={};webhookLock={};commands=[];constructor(e,i){super(e,i,"discord"),this.http=e.http.extend({...i,headers:{Authorization:i.type==="user"?i.token:`Bot ${i.token}`,"User-Agent":`Satori (https://koishi.chat/, ${ye.version})`,...i.headers}}),this.internal=new o(this),this.proxyUrls.push("https://cdn.discordapp.com/"),e.plugin(w,this)}async _ensureWebhook(e){let i,t=await this.internal.getChannelWebhooks(e),s=this.selfId;return t.find(E=>E.name==="Koishi"&&E.user.id===s)?i=t.find(E=>E.name==="Koishi"&&E.user.id===this.selfId):i=await this.internal.createWebhook(e,{name:"Koishi"}),this.webhooks[e]=i}async ensureWebhook(e){return this.webhooks[e]===null&&(delete this.webhooks[e],delete this.webhookLock[e]),this.webhooks[e]?(delete this.webhookLock[e],this.webhooks[e]):this.webhookLock[e]||=this._ensureWebhook(e)}async getLogin(){let e=await this.internal.getCurrentUser();return this.user=D(e),this.toJSON()}async deleteMessage(e,i){await this.internal.deleteMessage(e,i)}async editMessage(e,i,t){let s=A.h.normalize(t);if(t=s.toString(),s.find(r=>r.type==="img"||r.type==="image"))throw new Error("You can't include embed object(s) while editing message.");await this.internal.editMessage(e,i,{content:t})}async _getMessage(e,i){return this.config.type==="user"?(await this.internal.getChannelMessages(e,{around:i,limit:1}))[0]:await this.internal.getChannelMessage(e,i)}async getMessage(e,i,t=!0){let s=await this._getMessage(e,i);return await C(this,s,{},void 0,t)}async getMessageList(e,i,t="before",s,E="asc"){let r=await this.internal.getChannelMessages(e,{[t]:i,limit:s&&Math.min(s,100)}),n=await Promise.all(r.reverse().map(l=>C(this,l,{},void 0,!1))),a=n.at(t==="after"?-1:0)?.id,c=n.at(t==="before"?0:-1)?.id;return E==="desc"&&n.reverse(),{data:n,prev:a,next:c}}async getUser(e){let i=await this.internal.getUser(e);return D(i)}async getGuildMemberList(e,i){let s=(await this.internal.listGuildMembers(e,{after:i,limit:1e3})).map(E=>V(E));return{data:s,next:s[999]?.user.id}}async getChannel(e){let i=await this.internal.getChannel(e);return p(i)}async getGuildMember(e,i){let t=await this.internal.getGuildMember(e,i);return V(t)}async kickGuildMember(e,i){return this.internal.removeGuildMember(e,i)}async getGuild(e){let i=await this.internal.getGuild(e);return ie(i)}async getGuildList(e){let t=(await this.internal.getCurrentUserGuilds({after:e,limit:200})).map(ie);return{data:t,next:t[199]?.id}}async getChannelList(e){return{data:(await this.internal.getGuildChannels(e)).map(p)}}createReaction(e,i,t){return this.internal.createReaction(e,i,t)}deleteReaction(e,i,t,s){return s?this.internal.deleteUserReaction(e,i,t,s):this.internal.deleteOwnReaction(e,i,t)}clearReaction(e,i,t){return t?this.internal.deleteAllReactionsForEmoji(e,i,t):this.internal.deleteAllReactions(e,i)}async getReactionList(e,i,t,s){let E=await this.internal.getReactions(e,i,t,{after:s,limit:100});return{data:E.map(D),next:E[99]?.id}}setGuildMemberRole(e,i,t){return this.internal.addGuildMemberRole(e,i,t)}unsetGuildMemberRole(e,i,t){return this.internal.removeGuildMemberRole(e,i,t)}async getGuildRoleList(e){return{data:(await this.internal.getGuildRoles(e)).map(P)}}async createGuildRole(e,i){let t=await this.internal.createGuildRole(e,Ee(i));return P(t)}async updateGuildRole(e,i,t){await this.internal.modifyGuildRole(e,i,Ee(t))}deleteGuildRole(e,i){return this.internal.deleteGuildRole(e,i)}async createDirectChannel(e){let i=await this.internal.createDM({recipient_id:e});return p(i)}async updateCommands(e){if(!this.config.slash)return;this.commands=e;let i=e.map(ke);i.length&&(this.logger.debug("update %d command(s)",i.length),await this.internal.bulkOverwriteGlobalApplicationCommands(this.selfId,i))}};(e=>{e.Config=A.Schema.intersect([A.Schema.object({type:A.Schema.union(["bot","user"]).default("bot").description("登录方式")}),A.Schema.union([A.Schema.object({type:A.Schema.const("bot"),token:A.Schema.string().description("机器人的用户令牌。").role("secret").required()}),A.Schema.object({type:A.Schema.const("user"),token:A.Schema.string().description("从网页端获取的用户令牌。").role("secret").required()})]),A.Schema.object({slash:A.Schema.boolean().description("是否启用斜线指令。").default(!0)}).description("功能设置"),w.Options,b.Config,A.HTTP.createConfig("https://discord.com/api/v10")])})(W||(W={}));var et=W});var L={};$e(L,{default:()=>tt});O();var ve=_e(oe(),1);R(L,_e(oe(),1));var tt=ve.DiscordBot;export{tt as default};
