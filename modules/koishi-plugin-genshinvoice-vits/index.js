var u=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var G=Object.prototype.hasOwnProperty;var c=(H,_)=>()=>(H&&(_=H(H=0)),_);var N=(H,_)=>()=>(_||H((_={exports:{}}).exports,_),_.exports);var s=(H,_,Z,t)=>{if(_&&typeof _=="object"||typeof _=="function")for(let e of C(_))!G.call(H,e)&&e!==Z&&u(H,e,{get:()=>_[e],enumerable:!(t=q(_,e))||t.enumerable});return H},i=(H,_,Z)=>(s(H,_,"default"),Z&&s(Z,_,"default"));var V=H=>s(u({},"__esModule",{value:!0}),H);import{Buffer as m}from"https://registry.koishi.chat/modules/buffer/index.js";import d from"https://registry.koishi.chat/modules/process/index.js";var n=c(()=>{});var r={};import*as T from"https://registry.koishi.chat/modules/koishi/index.js";var f=c(()=>{n();i(r,T)});var z=N((W,g)=>{n();var o=Object.defineProperty,A=Object.getOwnPropertyDescriptor,B=Object.getOwnPropertyNames,E=Object.prototype.hasOwnProperty,h=(H,_)=>o(H,"name",{value:_,configurable:!0}),I=(H,_)=>{for(var Z in _)o(H,Z,{get:_[Z],enumerable:!0})},J=(H,_,Z,t)=>{if(_&&typeof _=="object"||typeof _=="function")for(let e of B(_))!E.call(H,e)&&e!==Z&&o(H,e,{get:()=>_[e],enumerable:!(t=A(_,e))||t.enumerable});return H},M=H=>J(o({},"__esModule",{value:!0}),H),v={};I(v,{default:()=>$});g.exports=M(v);var a=(f(),V(r)),b=["派蒙_ZH","纳西妲_ZH","娜维娅_ZH","凯亚_ZH","荒泷一斗_ZH","林尼_ZH","温迪_ZH","阿贝多_ZH","芙宁娜_ZH","钟离_ZH","赛诺_ZH","提纳里_ZH","那维莱特_ZH","枫原万叶_ZH","艾尔海森_ZH","八重神子_ZH","宵宫_ZH","卡维_ZH","迪希雅_ZH","莱依拉_ZH","诺艾尔_ZH","莫娜_ZH","托马_ZH","柯莱_ZH","凝光_ZH","神里绫华_ZH","北斗_ZH","莱欧斯利_ZH","妮露_ZH","可莉_ZH","迪奥娜_ZH","丽莎_ZH","琳妮特_ZH","五郎_ZH","雷电将军_ZH","芭芭拉_ZH","珊瑚宫心海_ZH","鹿野院平藏_ZH","琴_ZH","魈_ZH","达达利亚_ZH","胡桃_ZH","砂糖_ZH","安柏_ZH","重云_ZH","夜兰_ZH","班尼特_ZH","流浪者_ZH","珐露珊_ZH","辛焱_ZH","香菱_ZH","迪卢克_ZH","刻晴_ZH","烟绯_ZH","夏沃蕾_ZH","久岐忍_ZH","早柚_ZH","云堇_ZH","夏洛蒂_ZH","优菈_ZH","克洛琳德_ZH","神里绫人_ZH","甘雨_ZH","千织_ZH","行秋_ZH","戴因斯雷布_ZH","希格雯_ZH","阿蕾奇诺_ZH","荧_ZH","空_ZH","闲云_ZH","菲谢尔_ZH","白术_ZH","绮良良_ZH","申鹤_ZH","九条裟罗_ZH","菲米尼_ZH","艾梅莉埃_ZH","雷泽_ZH","嘉明_ZH","多莉_ZH","凯瑟琳_ZH","迪娜泽黛_ZH","坎蒂丝_ZH","罗莎莉亚_ZH","米卡_ZH","萍姥姥_ZH","赛索斯_ZH","留云借风真君_ZH","埃德_ZH","爱贝尔_ZH","瑶瑶_ZH","伊迪娅_ZH","七七_ZH","式大将_ZH","奥兹_ZH","德沃沙克_ZH","泽维尔_ZH","哲平_ZH","大肉丸_ZH","浮游水蕈兽·元素生命_ZH","旁白_ZH","蒂玛乌斯_ZH","塞琉斯_ZH","欧菲妮_ZH","昆钧_ZH","主持人_ZH","言笑_ZH","迈勒斯_ZH","艾德加_ZH","拉赫曼_ZH","杜拉夫_ZH","伊利亚斯_ZH","爱德琳_ZH","居勒什_ZH","埃洛伊_ZH","远黛_ZH","弗洛莱恩_ZH","柊千里_ZH","艾莉丝_ZH","塞塔蕾_ZH","海芭夏_ZH","回声海螺_ZH","席尔万_ZH","阿扎尔_ZH","探长_ZH","博士_ZH","天叔_ZH","杏仁_ZH","祖莉亚·德斯特雷_ZH","三月七_ZH","瓦尔特_ZH","丹恒_ZH","砂金_ZH","希儿_ZH","姬子_ZH","流萤_ZH","穹_ZH","星_ZH","希露瓦_ZH","娜塔莎_ZH","黄泉_ZH","黑天鹅_ZH","佩拉_ZH","布洛妮娅_ZH","虎克_ZH","素裳_ZH","克拉拉_ZH","符玄_ZH","白露_ZH","景元_ZH","杰帕德_ZH","藿藿_ZH","星期日_ZH","桑博_ZH","卡芙卡_ZH","艾丝妲_ZH","托帕_ZH","真理医生_ZH","桂乃芬_ZH","加拉赫_ZH","米沙_ZH","知更鸟_ZH","彦卿_ZH","玲可_ZH","波提欧_ZH","黑塔_ZH","驭空_ZH","停云_ZH","镜流_ZH","银枝_ZH","银狼_ZH","卢卡_ZH","帕姆_ZH","罗刹_ZH","阮•梅_ZH","翡翠_ZH","青雀_ZH","阿兰_ZH","浮烟_ZH","螺丝咕姆_ZH","花火_ZH","史瓦罗_ZH","明曦_ZH","寒鸦_ZH","雪衣_ZH","乔瓦尼_ZH","伦纳德_ZH","公输师傅_ZH","晴霓_ZH","奥列格_ZH","丹枢_ZH","刃_ZH","尾巴_ZH","可可利亚_ZH","青镞_ZH","半夏_ZH","梦主_ZH","哲_ZH","铃_ZH","猫又_ZH","妮可_ZH","格莉丝_ZH","莱卡恩_ZH","珂蕾妲_ZH","陌生人_ZH","比利_ZH","丽娜_ZH","「11号」_ZH","朱鸢_ZH","安比_ZH","安东_ZH","本_ZH","奥利_ZH","可琳_ZH","青衣_ZH","艾莲_ZH","贝蒂_ZH","邦布（铃）_ZH","邦布（哲）_ZH","「鼹鼠先生」_ZH","阿弥_ZH","莉莉可_ZH","埃顿校长_ZH","苍角_ZH","AI_ZH","珀尔曼_ZH","白噪声_ZH","蕾莎婆婆_ZH","匪徒老大_ZH","莎拉_ZH","电视记者_ZH","乔普师傅_ZH","德琳_ZH","哈金斯_ZH","恩佐_ZH","霍尔斯_ZH","安娜塔莎_ZH","杜拉西_ZH","雅_ZH","店员_ZH","汉斯_ZH","调查协会的考核官_ZH","盖尔_ZH","芮恩_ZH","亚莎_ZH","苏茜_ZH","乔纳_ZH","阿尔贝托_ZH","莉夏_ZH","周五_ZH","悠真_ZH","扳机_ZH","丹_ZH","「牧羊人」_ZH","炸弹_ZH","露西_ZH","莱特_ZH","克萝拉_ZH","秧秧_ZH","长离_ZH","忌炎_ZH","凌阳_ZH","炽霞_ZH","吟霖_ZH","今汐_ZH","秋水_ZH","漂泊者女主_ZH","漂泊者男主_ZH","伤痕_ZH","白芷_ZH","散华_ZH","鉴心_ZH","莫特斐_ZH","辛夷_ZH","「角」_ZH","维里奈_ZH","安可_ZH","桃祈_ZH"],U=["生气/angry","开心/happy","中立/neutral","难过/sad","<unk>"],p=class extends a.Service{constructor(H,_){super(H,"vits",!0),this.config=_,H.command("vits <content:text>","语音生成",{checkUnknown:!0}).alias("say").option("speaker","--spkr [value:string]",{fallback:_.speaker}).option("language","--lang [value:string]",{fallback:_.language,hidden:!0}).option("length","--len [value:number]",{fallback:_.length}).option("noise","[value:number]",{fallback:_.noise}).option("noisew","[value:number]",{fallback:_.noisew}).option("sdp_ratio","--sdp [value:number]",{fallback:_.sdp_ratio}).option("emotion","[value:string]",{fallback:_.emotion}).action(async({options:Z},t)=>t?/<.*\/>/gm.test(t)?"输入的内容不是纯文本。":await l(this.ctx.http,Z,t):"内容未输入。")}static{h(this,"GenshinVits")}static inject={required:["http"]};say(H){let _=typeof H.speaker_id=="number"?b[H.speaker_id]:this.config.speaker;return l(this.ctx.http,{...this.config,speaker:_},H.input)}};async function l(H,_,Z){let{speaker:t,sdp_ratio:e,noise:k,noisew:y,length:w,language:x,emotion:S}=_,O={data:[Z,t,e,k,y,w,x,!1,1,.2,S,"",.7],fn_index:0},{data:P,duration:j}=await H.post("https://bv2.firefly.matce.cn/run/predict",O),D=P[1].name;return a.h.audio(`https://bv2.firefly.matce.cn/file=${D}`,{type:"voice",duration:j})}h(l,"isay");(H=>{H.Config=a.Schema.object({speaker:a.Schema.union(b).default("派蒙_ZH").description("发言的角色。"),sdp_ratio:a.Schema.number().min(0).max(1).step(.1).role("slider").default(.2).description("SDP 在合成时的占比，理论上此比率越高，合成的语音语调方差越大。"),noise:a.Schema.number().min(.1).max(2).step(.1).role("slider").default(.6).description("样本噪声，控制合成的随机性。"),noisew:a.Schema.number().min(.1).max(2).step(.1).role("slider").default(.8).description("随机时长预测器噪声，控制音素发音长度。"),length:a.Schema.number().min(.1).max(2).step(.1).role("slider").default(1).description("调节语音长度，相当于调节语速，该数值越大语速越慢。"),emotion:a.Schema.union(U).default("中立/neutral").description("情感。"),language:a.Schema.union(["ZH"]).default("ZH").description("语言。").hidden()})})(p||(p={}));var $=p});export default z();
