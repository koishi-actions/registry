var QO=Object.defineProperty;var ew=(s,n,i)=>n in s?QO(s,n,{enumerable:true,configurable:true,writable:true,value:i}):s[n]=i;var Qr=(s,n,i)=>(ew(s,typeof n!="symbol"?n+"":n,i),i);import{send as Rn,store as Yn,icons as tw}from"../client.js";import{defineComponent as et,ref as be,watch as Mt,resolveComponent as Ze,openBlock as ie,createBlock as Ye,withCtx as We,createElementVNode as le,createVNode as De,createTextVNode as Dt,computed as me,createElementBlock as Se,normalizeClass as tt,renderSlot as Qt,toDisplayString as Pt,Fragment as xt,renderList as ni,normalizeProps as sw,guardReactiveProps as iw,createCommentVNode as ot,warn as nw,getCurrentInstance as oc,unref as ge,onMounted as xs,watchEffect as rw,onBeforeUnmount as ba,inject as ri,isRef as ha,onScopeDispose as $y,provide as ac,mergeProps as Pl,toRef as tn,onUnmounted as ow,useAttrs as aw,useSlots as yy,shallowRef as W_,nextTick as ps,withDirectives as Hs,resolveDynamicComponent as ti,withModifiers as si,normalizeStyle as Qs,vShow as $i,Text as lw,reactive as In,h as ju,toRefs as Ry,Transition as lc,withKeys as la,isVNode as Iy,render as Cy,toRaw as nf,pushScopeId as Pf,popScopeId as Uf,onUpdated as Oy,vModelText as wy,customRef as cw,shallowReadonly as uw,getCurrentScope as hw,TransitionGroup as dw,markRaw as ky,createStaticVNode as _w,createApp as pw,KeepAlive as gw}from"../vue.js";import{isClient as Ir,useResizeObserver as fw}from"../vueuse.js";function mw(s,n){for(var i=0;i<n.length;i++){const o=n[i];if(typeof o!="string"&&!Array.isArray(o)){for(const l in o)if(l!=="default"&&!(l in s)){const h=Object.getOwnPropertyDescriptor(o,l);h&&Object.defineProperty(s,l,h.get?h:{enumerable:true,get:()=>o[l]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}const Ew={class:"dialog-footer"},bw=et({__name:"import",props:["modelValue"],emits:["update:modelValue","callback"],setup(s,{emit:n}){const i=s,o=be(""),l=be(false),h=be(false);function f(){n("update:modelValue",false),n("callback",o.value,h.value),o.value="",h.value=false}return Mt(i,u=>{l.value=i.modelValue}),Mt(l,u=>{n("update:modelValue",u)}),(u,p)=>{const c=Ze("el-input"),_=Ze("el-checkbox"),m=Ze("el-button"),E=Ze("el-dialog");return ie(),Ye(E,{modelValue:l.value,"onUpdate:modelValue":p[4]||(p[4]=b=>l.value=b),title:"\u5BFC\u5165\u63D2\u4EF6",width:"700px"},{footer:We(()=>[le("span",Ew,[De(m,{onClick:p[2]||(p[2]=b=>n("update:modelValue"))},{default:We(()=>[Dt("\u5173\u95ED")]),_:1}),De(m,{type:"primary",onClick:p[3]||(p[3]=b=>f())},{default:We(()=>[Dt(" \u5BFC\u5165 ")]),_:1})])]),default:We(()=>[De(c,{type:"textarea",rows:"10","input-style":"height: 200px;resize:none;",modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=b=>o.value=b)},null,8,["modelValue"]),De(_,{label:"\u4F5C\u4E3A\u5168\u65B0\u63D2\u4EF6\u5BFC\u5165",modelValue:h.value,"onUpdate:modelValue":p[1]||(p[1]=b=>h.value=b)},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),vw=et({__name:"export",props:["modelValue"],emits:["update:modelValue"],setup(s,{emit:n}){const i=s,o=be(false);Mt(i,h=>{o.value=h.modelValue});const l=me(()=>o.value??"");return(h,f)=>{const u=Ze("el-input"),p=Ze("el-dialog");return ie(),Ye(p,{modelValue:o.value,"onUpdate:modelValue":f[1]||(f[1]=c=>o.value=c),title:"\u5BFC\u51FA\u63D2\u4EF6",width:"700px"},{default:We(()=>[De(u,{type:"textarea",rows:"10","input-style":"height: 200px;resize:none;",modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=c=>l.value=c),readonly:""},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),Tw=et({__name:"blockly-tab-item",props:{label:{},value:{},modelValue:{}},emits:["update:modelValue"],setup(s){return(n,i)=>(ie(),Se("div",{class:tt(["k-tab-item k-menu-item",{active:n.value===n.modelValue}]),onClick:i[0]||(i[0]=o=>n.$emit("update:modelValue",n.value))},[Qt(n.$slots,"default",{},()=>[Dt(Pt(n.label.name)+" ",1),le("span",{class:tt({dot:true,enabled:n.label.enabled,edited:n.label.edited})},null,2)],true)],2))}});const Jn=(s,n)=>{const i=s.__vccOpts||s;for(const[o,l]of n)i[o]=l;return i},Sw=Jn(Tw,[["__scopeId","data-v-57c080b0"]]),$w=et({__name:"blockly-tab-group",props:{data:{},modelValue:{},filter:{type:Function}},emits:["update:modelValue"],setup(s,{emit:n}){const i=s;console.info(i.data);const o=me({get:()=>i.modelValue,set:l=>n("update:modelValue",l)});return(l,h)=>(ie(true),Se(xt,null,ni(l.data,(f,u)=>(ie(),Se(xt,{key:u},[!l.filter||l.filter(u)?(ie(),Ye(Sw,{key:0,modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=p=>o.value=p),label:f,value:u},{default:We(()=>[Qt(l.$slots,"default",sw(iw({id:f})))]),_:2},1032,["modelValue","label","value"])):ot("",true)],64))),128))}});const yw='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',Rw=s=>getComputedStyle(s).position==="fixed"?false:s.offsetParent!==null,Kv=s=>Array.from(s.querySelectorAll(yw)).filter(n=>Iw(n)&&Rw(n)),Iw=s=>{if(s.tabIndex>0||s.tabIndex===0&&s.getAttribute("tabIndex")!==null)return true;if(s.disabled)return false;switch(s.nodeName){case"A":return!!s.href&&s.rel!=="ignore";case"INPUT":return!(s.type==="hidden"||s.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return true;default:return false}},Cw=()=>Ir&&/firefox/i.test(window.navigator.userAgent),ca=()=>{},Ow=Object.prototype.hasOwnProperty,Xu=(s,n)=>Ow.call(s,n),ww=Array.isArray,rf=s=>typeof s=="function",vr=s=>typeof s=="string",kw=s=>typeof s=="symbol",Hl=s=>s!==null&&typeof s=="object",Aw=s=>{const n=Object.create(null);return i=>n[i]||(n[i]=s(i))},Lw=/-(\w)/g,Nw=Aw(s=>s.replace(Lw,(n,i)=>i?i.toUpperCase():""));var Mw=typeof global=="object"&&global&&global.Object===Object&&global;const Dw=Mw;var xw=typeof self=="object"&&self&&self.Object===Object&&self,Bw=Dw||xw||Function("return this")();const Ff=Bw;var Pw=Ff.Symbol;const da=Pw;var Ay=Object.prototype,Uw=Ay.hasOwnProperty,Fw=Ay.toString,kl=da?da.toStringTag:void 0;function Gw(s){var n=Uw.call(s,kl),i=s[kl];try{s[kl]=void 0;var o=true}catch{}var l=Fw.call(s);return o&&(n?s[kl]=i:delete s[kl]),l}var Hw=Object.prototype,Vw=Hw.toString;function Ww(s){return Vw.call(s)}var zw="[object Null]",jw="[object Undefined]",Yv=da?da.toStringTag:void 0;function Ly(s){return s==null?s===void 0?jw:zw:Yv&&Yv in Object(s)?Gw(s):Ww(s)}function Xw(s){return s!=null&&typeof s=="object"}var Kw="[object Symbol]";function Gf(s){return typeof s=="symbol"||Xw(s)&&Ly(s)==Kw}function Yw(s,n){for(var i=-1,o=s==null?0:s.length,l=Array(o);++i<o;)l[i]=n(s[i],i,s);return l}var qw=Array.isArray;const Hf=qw;var Jw=1/0,qv=da?da.prototype:void 0,Jv=qv?qv.toString:void 0;function Ny(s){if(typeof s=="string")return s;if(Hf(s))return Yw(s,Ny)+"";if(Gf(s))return Jv?Jv.call(s):"";var n=s+"";return n=="0"&&1/s==-Jw?"-0":n}function My(s){var n=typeof s;return s!=null&&(n=="object"||n=="function")}var Zw="[object AsyncFunction]",Qw="[object Function]",ek="[object GeneratorFunction]",tk="[object Proxy]";function sk(s){if(!My(s))return false;var n=Ly(s);return n==Qw||n==ek||n==Zw||n==tk}var ik=Ff["__core-js_shared__"];const z_=ik;var Zv=function(){var s=/[^.]+$/.exec(z_&&z_.keys&&z_.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function nk(s){return!!Zv&&Zv in s}var rk=Function.prototype,ok=rk.toString;function ak(s){if(s!=null){try{return ok.call(s)}catch{}try{return s+""}catch{}}return""}var lk=/[\\^$.*+?()[\]{}|]/g,ck=/^\[object .+?Constructor\]$/,uk=Function.prototype,hk=Object.prototype,dk=uk.toString,_k=hk.hasOwnProperty,pk=RegExp("^"+dk.call(_k).replace(lk,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function gk(s){if(!My(s)||nk(s))return false;var n=sk(s)?pk:ck;return n.test(ak(s))}function fk(s,n){return s==null?void 0:s[n]}function Dy(s,n){var i=fk(s,n);return gk(i)?i:void 0}function mk(s,n){return s===n||s!==s&&n!==n}var Ek=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bk=/^\w*$/;function vk(s,n){if(Hf(s))return false;var i=typeof s;return i=="number"||i=="symbol"||i=="boolean"||s==null||Gf(s)?true:bk.test(s)||!Ek.test(s)||n!=null&&s in Object(n)}var Tk=Dy(Object,"create");const Vl=Tk;function Sk(){this.__data__=Vl?Vl(null):{},this.size=0}function $k(s){var n=this.has(s)&&delete this.__data__[s];return this.size-=n?1:0,n}var yk="__lodash_hash_undefined__",Rk=Object.prototype,Ik=Rk.hasOwnProperty;function Ck(s){var n=this.__data__;if(Vl){var i=n[s];return i===yk?void 0:i}return Ik.call(n,s)?n[s]:void 0}var Ok=Object.prototype,wk=Ok.hasOwnProperty;function kk(s){var n=this.__data__;return Vl?n[s]!==void 0:wk.call(n,s)}var Ak="__lodash_hash_undefined__";function Lk(s,n){var i=this.__data__;return this.size+=this.has(s)?0:1,i[s]=Vl&&n===void 0?Ak:n,this}function co(s){var n=-1,i=s==null?0:s.length;for(this.clear();++n<i;){var o=s[n];this.set(o[0],o[1])}}co.prototype.clear=Sk;co.prototype.delete=$k;co.prototype.get=Ck;co.prototype.has=kk;co.prototype.set=Lk;function Nk(){this.__data__=[],this.size=0}function ih(s,n){for(var i=s.length;i--;)if(mk(s[i][0],n))return i;return-1}var Mk=Array.prototype,Dk=Mk.splice;function xk(s){var n=this.__data__,i=ih(n,s);if(i<0)return false;var o=n.length-1;return i==o?n.pop():Dk.call(n,i,1),--this.size,true}function Bk(s){var n=this.__data__,i=ih(n,s);return i<0?void 0:n[i][1]}function Pk(s){return ih(this.__data__,s)>-1}function Uk(s,n){var i=this.__data__,o=ih(i,s);return o<0?(++this.size,i.push([s,n])):i[o][1]=n,this}function va(s){var n=-1,i=s==null?0:s.length;for(this.clear();++n<i;){var o=s[n];this.set(o[0],o[1])}}va.prototype.clear=Nk;va.prototype.delete=xk;va.prototype.get=Bk;va.prototype.has=Pk;va.prototype.set=Uk;var Fk=Dy(Ff,"Map");const Gk=Fk;function Hk(){this.size=0,this.__data__={hash:new co,map:new(Gk||va),string:new co}}function Vk(s){var n=typeof s;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?s!=="__proto__":s===null}function nh(s,n){var i=s.__data__;return Vk(n)?i[typeof n=="string"?"string":"hash"]:i.map}function Wk(s){var n=nh(this,s).delete(s);return this.size-=n?1:0,n}function zk(s){return nh(this,s).get(s)}function jk(s){return nh(this,s).has(s)}function Xk(s,n){var i=nh(this,s),o=i.size;return i.set(s,n),this.size+=i.size==o?0:1,this}function go(s){var n=-1,i=s==null?0:s.length;for(this.clear();++n<i;){var o=s[n];this.set(o[0],o[1])}}go.prototype.clear=Hk;go.prototype.delete=Wk;go.prototype.get=zk;go.prototype.has=jk;go.prototype.set=Xk;var Kk="Expected a function";function Vf(s,n){if(typeof s!="function"||n!=null&&typeof n!="function")throw new TypeError(Kk);var i=function(){var o=arguments,l=n?n.apply(this,o):o[0],h=i.cache;if(h.has(l))return h.get(l);var f=s.apply(this,o);return i.cache=h.set(l,f)||h,f};return i.cache=new(Vf.Cache||go),i}Vf.Cache=go;var Yk=500;function qk(s){var n=Vf(s,function(o){return i.size===Yk&&i.clear(),o}),i=n.cache;return n}var Jk=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zk=/\\(\\)?/g,Qk=qk(function(s){var n=[];return s.charCodeAt(0)===46&&n.push(""),s.replace(Jk,function(i,o,l,h){n.push(l?h.replace(Zk,"$1"):o||i)}),n});const eA=Qk;function tA(s){return s==null?"":Ny(s)}function sA(s,n){return Hf(s)?s:vk(s,n)?[s]:eA(tA(s))}var iA=1/0;function nA(s){if(typeof s=="string"||Gf(s))return s;var n=s+"";return n=="0"&&1/s==-iA?"-0":n}function rA(s,n){n=sA(n,s);for(var i=0,o=n.length;s!=null&&i<o;)s=s[nA(n[i++])];return i&&i==o?s:void 0}function oA(s,n,i){var o=s==null?void 0:rA(s,n);return o===void 0?i:o}function xy(s){for(var n=-1,i=s==null?0:s.length,o={};++n<i;){var l=s[n];o[l[0]]=l[1]}return o}function By(s){return s==null}const Py=s=>s===void 0,Ku=s=>typeof s=="number",Qv=s=>typeof Element>"u"?false:s instanceof Element,aA=s=>vr(s)?!Number.isNaN(Number(s)):false,eT=s=>Object.keys(s);class lA extends Error{constructor(n){super(n),this.name="ElementPlusError"}}function cA(s,n){throw new lA(`[${s}] ${n}`)}const Uy=(s="")=>s.split(" ").filter(n=>!!n.trim()),tT=(s,n)=>{if(!s||!n)return false;if(n.includes(" "))throw new Error("className should not contain space.");return s.classList.contains(n)},uA=(s,n)=>{!s||!n.trim()||s.classList.add(...Uy(n))},hA=(s,n)=>{!s||!n.trim()||s.classList.remove(...Uy(n))},dA=(s,n)=>{var i;if(!Ir||!s||!n)return"";let o=Nw(n);o==="float"&&(o="cssFloat");try{const l=s.style[o];if(l)return l;const h=(i=document.defaultView)==null?void 0:i.getComputedStyle(s,"");return h?h[o]:""}catch{return s.style[o]}};function of(s,n="px"){if(!s)return"";if(Ku(s)||aA(s))return`${s}${n}`;if(vr(s))return s}let Ru;const _A=s=>{var n;if(!Ir)return 0;if(Ru!==void 0)return Ru;const i=document.createElement("div");i.className=`${s}-scrollbar__wrap`,i.style.visibility="hidden",i.style.width="100px",i.style.position="absolute",i.style.top="-9999px",document.body.appendChild(i);const o=i.offsetWidth;i.style.overflow="scroll";const l=document.createElement("div");l.style.width="100%",i.appendChild(l);const h=l.offsetWidth;return(n=i.parentNode)==null||n.removeChild(i),Ru=o-h,Ru};/*! Element Plus Icons Vue v2.1.0 */var Cn=(s,n)=>{let i=s.__vccOpts||s;for(let[o,l]of n)i[o]=l;return i},pA={name:"CircleCheck"},gA={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},fA=le("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),mA=le("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"},null,-1),EA=[fA,mA];function bA(s,n,i,o,l,h){return ie(),Se("svg",gA,EA)}var vA=Cn(pA,[["render",bA],["__file","circle-check.vue"]]),TA={name:"CircleCloseFilled"},SA={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},$A=le("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"},null,-1),yA=[$A];function RA(s,n,i,o,l,h){return ie(),Se("svg",SA,yA)}var Fy=Cn(TA,[["render",RA],["__file","circle-close-filled.vue"]]),IA={name:"CircleClose"},CA={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},OA=le("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248L466.752 512z"},null,-1),wA=le("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),kA=[OA,wA];function AA(s,n,i,o,l,h){return ie(),Se("svg",CA,kA)}var Gy=Cn(IA,[["render",AA],["__file","circle-close.vue"]]),LA={name:"Close"},NA={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},MA=le("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1),DA=[MA];function xA(s,n,i,o,l,h){return ie(),Se("svg",NA,DA)}var BA=Cn(LA,[["render",xA],["__file","close.vue"]]),PA={name:"Hide"},UA={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},FA=le("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2L371.2 588.8ZM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"},null,-1),GA=le("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"},null,-1),HA=[FA,GA];function VA(s,n,i,o,l,h){return ie(),Se("svg",UA,HA)}var WA=Cn(PA,[["render",VA],["__file","hide.vue"]]),zA={name:"InfoFilled"},jA={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},XA=le("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"},null,-1),KA=[XA];function YA(s,n,i,o,l,h){return ie(),Se("svg",jA,KA)}var Hy=Cn(zA,[["render",YA],["__file","info-filled.vue"]]),qA={name:"Loading"},JA={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ZA=le("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1),QA=[ZA];function eL(s,n,i,o,l,h){return ie(),Se("svg",JA,QA)}var Vy=Cn(qA,[["render",eL],["__file","loading.vue"]]),tL={name:"SuccessFilled"},sL={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},iL=le("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z"},null,-1),nL=[iL];function rL(s,n,i,o,l,h){return ie(),Se("svg",sL,nL)}var Wy=Cn(tL,[["render",rL],["__file","success-filled.vue"]]),oL={name:"View"},aL={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},lL=le("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1),cL=[lL];function uL(s,n,i,o,l,h){return ie(),Se("svg",aL,cL)}var hL=Cn(oL,[["render",uL],["__file","view.vue"]]),dL={name:"WarningFilled"},_L={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},pL=le("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256zm0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4z"},null,-1),gL=[pL];function fL(s,n,i,o,l,h){return ie(),Se("svg",_L,gL)}var zy=Cn(dL,[["render",fL],["__file","warning-filled.vue"]]);const jy="__epPropKey",Tr=s=>s,mL=s=>Hl(s)&&!!s[jy],Xy=(s,n)=>{if(!Hl(s)||mL(s))return s;const{values:i,required:o,default:l,type:h,validator:f}=s,p={type:h,required:!!o,validator:i||f?c=>{let _=false,m=[];if(i&&(m=Array.from(i),Xu(s,"default")&&m.push(l),_||(_=m.includes(c))),f&&(_||(_=f(c))),!_&&m.length>0){const E=[...new Set(m)].map(b=>JSON.stringify(b)).join(", ");nw(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${E}], got value ${JSON.stringify(c)}.`)}return _}:void 0,[jy]:true};return Xu(s,"default")&&(p.default=l),p},rh=s=>xy(Object.entries(s).map(([n,i])=>[n,Xy(i,n)])),Yu=Tr([String,Object,Function]),EL={Close:BA,SuccessFilled:Wy,InfoFilled:Hy,WarningFilled:zy,CircleCloseFilled:Fy},sT={success:Wy,warning:zy,error:Fy,info:Hy},bL={validating:Vy,success:vA,error:Gy},Wf=(s,n)=>{if(s.install=i=>{for(const o of[s,...Object.values(n??{})])i.component(o.name,o)},n)for(const[i,o]of Object.entries(n))s[i]=o;return s},vL=s=>(s.install=ca,s),zf={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},af="update:modelValue",Ky=["","default","small","large"],TL=s=>["",...Ky].includes(s);var Gu=(s=>(s[s.TEXT=1]="TEXT",s[s.CLASS=2]="CLASS",s[s.STYLE=4]="STYLE",s[s.PROPS=8]="PROPS",s[s.FULL_PROPS=16]="FULL_PROPS",s[s.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",s[s.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",s[s.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",s[s.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",s[s.NEED_PATCH=512]="NEED_PATCH",s[s.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",s[s.HOISTED=-1]="HOISTED",s[s.BAIL=-2]="BAIL",s))(Gu||{});const SL=s=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(s),$L=s=>s,yL=["class","style"],RL=/^on[A-Z]/,IL=(s={})=>{const{excludeListeners:n=false,excludeKeys:i}=s,o=me(()=>((i==null?void 0:i.value)||[]).concat(yL)),l=oc();return l?me(()=>{var h;return xy(Object.entries((h=l.proxy)==null?void 0:h.$attrs).filter(([f])=>!o.value.includes(f)&&!(n&&RL.test(f))))}):me(()=>({}))},CL=({from:s,replacement:n,scope:i,version:o,ref:l,type:h="API"},f)=>{Mt(()=>ge(f),u=>{},{immediate:true})},OL=(s,n,i)=>{let o={offsetX:0,offsetY:0};const l=u=>{const p=u.clientX,c=u.clientY,{offsetX:_,offsetY:m}=o,E=s.value.getBoundingClientRect(),b=E.left,T=E.top,y=E.width,g=E.height,$=document.documentElement.clientWidth,R=document.documentElement.clientHeight,v=-b+_,S=-T+m,O=$-b-y+_,w=R-T-g+m,A=L=>{const x=Math.min(Math.max(_+L.clientX-p,v),O),B=Math.min(Math.max(m+L.clientY-c,S),w);o={offsetX:x,offsetY:B},s.value.style.transform=`translate(${of(x)}, ${of(B)})`},I=()=>{document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",I)};document.addEventListener("mousemove",A),document.addEventListener("mouseup",I)},h=()=>{n.value&&s.value&&n.value.addEventListener("mousedown",l)},f=()=>{n.value&&s.value&&n.value.removeEventListener("mousedown",l)};xs(()=>{rw(()=>{i.value?h():f()})}),ba(()=>{f()})};var wL={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const kL=s=>(n,i)=>AL(n,i,ge(s)),AL=(s,n,i)=>oA(i,s,s).replace(/\{(\w+)\}/g,(o,l)=>{var h;return`${(h=n==null?void 0:n[l])!=null?h:`{${l}}`}`}),LL=s=>{const n=me(()=>ge(s).name),i=ha(s)?s:be(s);return{lang:n,locale:i,t:kL(s)}},Yy=Symbol("localeContextKey"),NL=s=>{const n=s||ri(Yy,be());return LL(me(()=>n.value||wL))};let ML;function DL(s,n=ML){n&&n.active&&n.effects.push(s)}const xL=s=>{const n=new Set(s);return n.w=0,n.n=0,n},qy=s=>(s.w&Cr)>0,Jy=s=>(s.n&Cr)>0,BL=({deps:s})=>{if(s.length)for(let n=0;n<s.length;n++)s[n].w|=Cr},PL=s=>{const{deps:n}=s;if(n.length){let i=0;for(let o=0;o<n.length;o++){const l=n[o];qy(l)&&!Jy(l)?l.delete(s):n[i++]=l,l.w&=~Cr,l.n&=~Cr}n.length=i}};let Nl=0,Cr=1;const lf=30;let Tn;class UL{constructor(n,i=null,o){this.fn=n,this.scheduler=i,this.active=true,this.deps=[],this.parent=void 0,DL(this,o)}run(){if(!this.active)return this.fn();let n=Tn,i=Hu;for(;n;){if(n===this)return;n=n.parent}try{return this.parent=Tn,Tn=this,Hu=true,Cr=1<<++Nl,Nl<=lf?BL(this):iT(this),this.fn()}finally{Nl<=lf&&PL(this),Cr=1<<--Nl,Tn=this.parent,Hu=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Tn===this?this.deferStop=true:this.active&&(iT(this),this.onStop&&this.onStop(),this.active=false)}}function iT(s){const{deps:n}=s;if(n.length){for(let i=0;i<n.length;i++)n[i].delete(s);n.length=0}}let Hu=true;function FL(s,n){let i=false;Nl<=lf?Jy(s)||(s.n|=Cr,i=!qy(s)):i=!s.has(Tn),i&&(s.add(Tn),Tn.deps.push(s))}function GL(s,n){const i=ww(s)?s:[...s];for(const o of i)o.computed&&nT(o);for(const o of i)o.computed||nT(o)}function nT(s,n){(s!==Tn||s.allowRecurse)&&(s.scheduler?s.scheduler():s.run())}new Set(Object.getOwnPropertyNames(Symbol).filter(s=>s!=="arguments"&&s!=="caller").map(s=>Symbol[s]).filter(kw));function oh(s){const n=s&&s.__v_raw;return n?oh(n):s}function HL(s){Hu&&Tn&&(s=oh(s),FL(s.dep||(s.dep=xL())))}function VL(s,n){s=oh(s);const i=s.dep;i&&GL(i)}class WL{constructor(n,i,o,l){this._setter=i,this.dep=void 0,this.__v_isRef=true,this.__v_isReadonly=false,this._dirty=true,this.effect=new UL(n,()=>{this._dirty||(this._dirty=true,VL(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!l,this.__v_isReadonly=o}get value(){const n=oh(this);return HL(n),(n._dirty||!n._cacheable)&&(n._dirty=false,n._value=n.effect.run()),n._value}set value(n){this._setter(n)}}function zL(s,n,i=false){let o,l;const h=rf(s);return h?(o=s,l=ca):(o=s.get,l=s.set),new WL(o,l,h||!l,i)}const cf="el",jL="is-",eo=(s,n,i,o,l)=>{let h=`${s}-${n}`;return i&&(h+=`-${i}`),o&&(h+=`__${o}`),l&&(h+=`--${l}`),h},Zy=Symbol("namespaceContextKey"),Qy=s=>{const n=s||ri(Zy,be(cf));return me(()=>ge(n)||cf)},qn=(s,n)=>{const i=Qy(n);return{namespace:i,b:(y="")=>eo(i.value,s,y,"",""),e:y=>y?eo(i.value,s,"",y,""):"",m:y=>y?eo(i.value,s,"","",y):"",be:(y,g)=>y&&g?eo(i.value,s,y,g,""):"",em:(y,g)=>y&&g?eo(i.value,s,"",y,g):"",bm:(y,g)=>y&&g?eo(i.value,s,y,"",g):"",bem:(y,g,$)=>y&&g&&$?eo(i.value,s,y,g,$):"",is:(y,...g)=>{const $=g.length>=1?g[0]:true;return y&&$?`${jL}${y}`:""},cssVar:y=>{const g={};for(const $ in y)y[$]&&(g[`--${i.value}-${$}`]=y[$]);return g},cssVarName:y=>`--${i.value}-${y}`,cssVarBlock:y=>{const g={};for(const $ in y)y[$]&&(g[`--${i.value}-${s}-${$}`]=y[$]);return g},cssVarBlockName:y=>`--${i.value}-${s}-${y}`}},XL=(s,n={})=>{ha(s)||cA("[useLockscreen]","You need to pass a ref param to this function");const i=n.ns||qn("popup"),o=zL(()=>i.bm("parent","hidden"));if(!Ir||tT(document.body,o.value))return;let l=0,h=false,f="0";const u=()=>{setTimeout(()=>{hA(document==null?void 0:document.body,o.value),h&&document&&(document.body.style.width=f)},200)};Mt(s,p=>{if(!p){u();return}h=!tT(document.body,o.value),h&&(f=document.body.style.width),l=_A(i.namespace.value);const c=document.documentElement.clientHeight<document.body.scrollHeight,_=dA(document.body,"overflowY");l>0&&(c||_==="scroll")&&h&&(document.body.style.width=`calc(100% - ${l}px)`),uA(document.body,o.value)}),$y(()=>u())},eR=s=>{const n=oc();return me(()=>{var i,o;return(o=(i=n==null?void 0:n.proxy)==null?void 0:i.$props)==null?void 0:o[s]})},KL=(s,n)=>{let i;Mt(()=>s.value,o=>{var l,h;o?(i=document.activeElement,ha(n)&&((h=(l=n.value).focus)==null||h.call(l))):i.focus()})},tR=s=>{if(!s)return{onClick:ca,onMousedown:ca,onMouseup:ca};let n=false,i=false;return{onClick:f=>{n&&i&&s(f),n=i=false},onMousedown:f=>{n=f.target===f.currentTarget},onMouseup:f=>{i=f.target===f.currentTarget}}},rT={prefix:Math.floor(Math.random()*1e4),current:0},YL=Symbol("elIdInjection"),qL=()=>oc()?ri(YL,rT):rT,uf=s=>{const n=qL(),i=Qy();return me(()=>ge(s)||`${i.value}-id-${n.prefix}-${n.current++}`)};let aa=[];const oT=s=>{const n=s;n.key===zf.esc&&aa.forEach(i=>i(n))},JL=s=>{xs(()=>{aa.length===0&&document.addEventListener("keydown",oT),Ir&&aa.push(s)}),ba(()=>{aa=aa.filter(n=>n!==s),aa.length===0&&Ir&&document.removeEventListener("keydown",oT)})},aT=be(0),sR=2e3,iR=Symbol("zIndexContextKey"),ZL=s=>{const n=s||ri(iR,void 0),i=me(()=>{const h=ge(n);return Ku(h)?h:sR}),o=me(()=>i.value+aT.value);return{initialZIndex:i,currentZIndex:o,nextZIndex:()=>(aT.value++,o.value)}};function QL(s){const n=be();function i(){if(s.value==null)return;const{selectionStart:l,selectionEnd:h,value:f}=s.value;if(l==null||h==null)return;const u=f.slice(0,Math.max(0,l)),p=f.slice(Math.max(0,h));n.value={selectionStart:l,selectionEnd:h,value:f,beforeTxt:u,afterTxt:p}}function o(){if(s.value==null||n.value==null)return;const{value:l}=s.value,{beforeTxt:h,afterTxt:f,selectionStart:u}=n.value;if(h==null||f==null||u==null)return;let p=l.length;if(l.endsWith(f))p=l.length-f.length;else if(l.startsWith(h))p=h.length;else{const c=h[u-1],_=l.indexOf(c,u-1);_!==-1&&(p=_+1)}s.value.setSelectionRange(p,p)}return[i,o]}const nR=Xy({type:String,values:Ky,required:false}),rR=Symbol("size"),eN=()=>{const s=ri(rR,{});return me(()=>ge(s.size)||"")},oR=Symbol(),qu=be();function jf(s,n=void 0){const i=oc()?ri(oR,qu):qu;return s?me(()=>{var o,l;return(l=(o=i.value)==null?void 0:o[s])!=null?l:n}):i}function tN(s,n){const i=jf(),o=qn(s,me(()=>{var u;return((u=i.value)==null?void 0:u.namespace)||cf})),l=NL(me(()=>{var u;return(u=i.value)==null?void 0:u.locale})),h=ZL(me(()=>{var u;return((u=i.value)==null?void 0:u.zIndex)||sR})),f=me(()=>{var u;return ge(n)||((u=i.value)==null?void 0:u.size)||""});return sN(me(()=>ge(i)||{})),{ns:o,locale:l,zIndex:h,size:f}}const sN=(s,n,i=false)=>{var o;const l=!!oc(),h=l?jf():void 0,f=(o=n==null?void 0:n.provide)!=null?o:l?ac:void 0;if(!f)return;const u=me(()=>{const p=ge(s);return h!=null&&h.value?iN(h.value,p):p});return f(oR,u),f(Yy,me(()=>u.value.locale)),f(Zy,me(()=>u.value.namespace)),f(iR,me(()=>u.value.zIndex)),f(rR,{size:me(()=>u.value.size||"")}),(i||!qu.value)&&(qu.value=u.value),u},iN=(s,n)=>{var i;const o=[...new Set([...eT(s),...eT(n)])],l={};for(const h of o)l[h]=(i=n[h])!=null?i:s[h];return l};var Ta=(s,n)=>{const i=s.__vccOpts||s;for(const[o,l]of n)i[o]=l;return i};const nN=rh({size:{type:Tr([Number,String])},color:{type:String}}),rN=et({name:"ElIcon",inheritAttrs:false}),oN=et({...rN,props:nN,setup(s){const n=s,i=qn("icon"),o=me(()=>{const{size:l,color:h}=n;return!l&&!h?{}:{fontSize:Py(l)?void 0:of(l),"--color":h}});return(l,h)=>(ie(),Se("i",Pl({class:ge(i).b(),style:ge(o)},l.$attrs),[Qt(l.$slots,"default")],16))}});var aN=Ta(oN,[["__file","/home/runner/work/element-plus/element-plus/packages/components/icon/src/icon.vue"]]);const fr=Wf(aN),Xf=Symbol("formContextKey"),aR=Symbol("formItemContextKey"),lR=(s,n={})=>{const i=be(void 0),o=n.prop?i:eR("size"),l=n.global?i:eN(),h=n.form?{size:void 0}:ri(Xf,void 0),f=n.formItem?{size:void 0}:ri(aR,void 0);return me(()=>o.value||ge(s)||(f==null?void 0:f.size)||(h==null?void 0:h.size)||l.value||"")},Kf=s=>{const n=eR("disabled"),i=ri(Xf,void 0);return me(()=>n.value||ge(s)||(i==null?void 0:i.disabled)||false)},cR=()=>{const s=ri(Xf,void 0),n=ri(aR,void 0);return{form:s,formItem:n}},lN=(s,{formItemContext:n,disableIdGeneration:i,disableIdManagement:o})=>{i||(i=be(false)),o||(o=be(false));const l=be();let h;const f=me(()=>{var u;return!!(!s.label&&n&&n.inputIds&&((u=n.inputIds)==null?void 0:u.length)<=1)});return xs(()=>{h=Mt([tn(s,"id"),i],([u,p])=>{const c=u??(p?void 0:uf().value);c!==l.value&&(n!=null&&n.removeInputId&&(l.value&&n.removeInputId(l.value),!(o!=null&&o.value)&&!p&&c&&n.addInputId(c)),l.value=c)},{immediate:true})}),ow(()=>{h&&h(),n!=null&&n.removeInputId&&l.value&&n.removeInputId(l.value)}),{isLabeledByFormItem:f,inputId:l}};let Qi;const cN=`
  height:0 !important;
  visibility:hidden !important;
  ${Cw()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,uN=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function hN(s){const n=window.getComputedStyle(s),i=n.getPropertyValue("box-sizing"),o=Number.parseFloat(n.getPropertyValue("padding-bottom"))+Number.parseFloat(n.getPropertyValue("padding-top")),l=Number.parseFloat(n.getPropertyValue("border-bottom-width"))+Number.parseFloat(n.getPropertyValue("border-top-width"));return{contextStyle:uN.map(f=>`${f}:${n.getPropertyValue(f)}`).join(";"),paddingSize:o,borderSize:l,boxSizing:i}}function lT(s,n=1,i){var o;Qi||(Qi=document.createElement("textarea"),document.body.appendChild(Qi));const{paddingSize:l,borderSize:h,boxSizing:f,contextStyle:u}=hN(s);Qi.setAttribute("style",`${u};${cN}`),Qi.value=s.value||s.placeholder||"";let p=Qi.scrollHeight;const c={};f==="border-box"?p=p+h:f==="content-box"&&(p=p-l),Qi.value="";const _=Qi.scrollHeight-l;if(Ku(n)){let m=_*n;f==="border-box"&&(m=m+l+h),p=Math.max(m,p),c.minHeight=`${m}px`}if(Ku(i)){let m=_*i;f==="border-box"&&(m=m+l+h),p=Math.min(m,p)}return c.height=`${p}px`,(o=Qi.parentNode)==null||o.removeChild(Qi),Qi=void 0,c}const dN=rh({id:{type:String,default:void 0},size:nR,disabled:Boolean,modelValue:{type:Tr([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:Tr([Boolean,Object]),default:false},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:false},clearable:{type:Boolean,default:false},showPassword:{type:Boolean,default:false},showWordLimit:{type:Boolean,default:false},suffixIcon:{type:Yu},prefixIcon:{type:Yu},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:true},inputStyle:{type:Tr([Object,Array,String]),default:()=>$L({})}}),_N={[af]:s=>vr(s),input:s=>vr(s),change:s=>vr(s),focus:s=>s instanceof FocusEvent,blur:s=>s instanceof FocusEvent,clear:()=>true,mouseleave:s=>s instanceof MouseEvent,mouseenter:s=>s instanceof MouseEvent,keydown:s=>s instanceof Event,compositionstart:s=>s instanceof CompositionEvent,compositionupdate:s=>s instanceof CompositionEvent,compositionend:s=>s instanceof CompositionEvent},pN=["role"],gN=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],fN=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],mN=et({name:"ElInput",inheritAttrs:false}),EN=et({...mN,props:dN,emits:_N,setup(s,{expose:n,emit:i}){const o=s,l=aw(),h=yy(),f=me(()=>{const $e={};return o.containerRole==="combobox"&&($e["aria-haspopup"]=l["aria-haspopup"],$e["aria-owns"]=l["aria-owns"],$e["aria-expanded"]=l["aria-expanded"]),$e}),u=me(()=>[o.type==="textarea"?g.b():y.b(),y.m(b.value),y.is("disabled",T.value),y.is("exceed",re.value),{[y.b("group")]:h.prepend||h.append,[y.bm("group","append")]:h.append,[y.bm("group","prepend")]:h.prepend,[y.m("prefix")]:h.prefix||o.prefixIcon,[y.m("suffix")]:h.suffix||o.suffixIcon||o.clearable||o.showPassword,[y.bm("suffix","password-clear")]:D.value&&P.value},l.class]),p=me(()=>[y.e("wrapper"),y.is("focus",v.value)]),c=IL({excludeKeys:me(()=>Object.keys(f.value))}),{form:_,formItem:m}=cR(),{inputId:E}=lN(o,{formItemContext:m}),b=lR(),T=Kf(),y=qn("input"),g=qn("textarea"),$=W_(),R=W_(),v=be(false),S=be(false),O=be(false),w=be(false),A=be(),I=W_(o.inputStyle),L=me(()=>$.value||R.value),x=me(()=>{var $e;return($e=_==null?void 0:_.statusIcon)!=null?$e:false}),B=me(()=>(m==null?void 0:m.validateState)||""),H=me(()=>B.value&&bL[B.value]),F=me(()=>w.value?hL:WA),X=me(()=>[l.style,o.inputStyle]),Z=me(()=>[o.inputStyle,I.value,{resize:o.resize}]),J=me(()=>By(o.modelValue)?"":String(o.modelValue)),D=me(()=>o.clearable&&!T.value&&!o.readonly&&!!J.value&&(v.value||S.value)),P=me(()=>o.showPassword&&!T.value&&!o.readonly&&!!J.value&&(!!J.value||v.value)),V=me(()=>o.showWordLimit&&!!c.value.maxlength&&(o.type==="text"||o.type==="textarea")&&!T.value&&!o.readonly&&!o.showPassword),j=me(()=>J.value.length),re=me(()=>!!V.value&&j.value>Number(c.value.maxlength)),G=me(()=>!!h.suffix||!!o.suffixIcon||D.value||o.showPassword||V.value||!!B.value&&x.value),[ae,de]=QL($);fw(R,$e=>{if(W(),!V.value||o.resize!=="both")return;const rt=$e[0],{width:pt}=rt.contentRect;A.value={right:`calc(100% - ${pt+15+6}px)`}});const fe=()=>{const{type:$e,autosize:rt}=o;if(!(!Ir||$e!=="textarea"||!R.value))if(rt){const pt=Hl(rt)?rt.minRows:void 0,ts=Hl(rt)?rt.maxRows:void 0,ye=lT(R.value,pt,ts);I.value={overflowY:"hidden",...ye},ps(()=>{R.value.offsetHeight,I.value=ye})}else I.value={minHeight:lT(R.value).minHeight}},W=($e=>{let rt=false;return()=>{var pt;if(rt||!o.autosize)return;((pt=R.value)==null?void 0:pt.offsetParent)===null||($e(),rt=true)}})(fe),Q=()=>{const $e=L.value;!$e||$e.value===J.value||($e.value=J.value)},ce=async $e=>{ae();let{value:rt}=$e.target;if(o.formatter&&(rt=o.parser?o.parser(rt):rt,rt=o.formatter(rt)),!O.value){if(rt===J.value){Q();return}i(af,rt),i("input",rt),await ps(),Q(),de()}},Ee=$e=>{i("change",$e.target.value)},Xe=$e=>{i("compositionstart",$e),O.value=true},Re=$e=>{var rt;i("compositionupdate",$e);const pt=(rt=$e.target)==null?void 0:rt.value,ts=pt[pt.length-1]||"";O.value=!SL(ts)},_t=$e=>{i("compositionend",$e),O.value&&(O.value=false,ce($e))},Ct=()=>{w.value=!w.value,Rt()},Rt=async()=>{var $e;await ps(),($e=L.value)==null||$e.focus()},ct=()=>{var $e;return($e=L.value)==null?void 0:$e.blur()},Ut=$e=>{v.value=true,i("focus",$e)},Ui=$e=>{var rt;v.value=false,i("blur",$e),o.validateEvent&&((rt=m==null?void 0:m.validate)==null||rt.call(m,"blur").catch(pt=>void 0))},ai=$e=>{S.value=false,i("mouseleave",$e)},li=$e=>{S.value=true,i("mouseenter",$e)},ci=$e=>{i("keydown",$e)},ks=()=>{var $e;($e=L.value)==null||$e.select()},Es=()=>{i(af,""),i("change",""),i("clear"),i("input","")};return Mt(()=>o.modelValue,()=>{var $e;ps(()=>fe()),o.validateEvent&&(($e=m==null?void 0:m.validate)==null||$e.call(m,"change").catch(rt=>void 0))}),Mt(J,()=>Q()),Mt(()=>o.type,async()=>{await ps(),Q(),fe()}),xs(()=>{!o.formatter&&o.parser,Q(),ps(fe)}),n({input:$,textarea:R,ref:L,textareaStyle:Z,autosize:tn(o,"autosize"),focus:Rt,blur:ct,select:ks,clear:Es,resizeTextarea:fe}),($e,rt)=>Hs((ie(),Se("div",Pl(ge(f),{class:ge(u),style:ge(X),role:$e.containerRole,onMouseenter:li,onMouseleave:ai}),[ot(" input "),$e.type!=="textarea"?(ie(),Se(xt,{key:0},[ot(" prepend slot "),$e.$slots.prepend?(ie(),Se("div",{key:0,class:tt(ge(y).be("group","prepend"))},[Qt($e.$slots,"prepend")],2)):ot("v-if",true),le("div",{class:tt(ge(p))},[ot(" prefix slot "),$e.$slots.prefix||$e.prefixIcon?(ie(),Se("span",{key:0,class:tt(ge(y).e("prefix"))},[le("span",{class:tt(ge(y).e("prefix-inner")),onClick:Rt},[Qt($e.$slots,"prefix"),$e.prefixIcon?(ie(),Ye(ge(fr),{key:0,class:tt(ge(y).e("icon"))},{default:We(()=>[(ie(),Ye(ti($e.prefixIcon)))]),_:1},8,["class"])):ot("v-if",true)],2)],2)):ot("v-if",true),le("input",Pl({id:ge(E),ref_key:"input",ref:$,class:ge(y).e("inner")},ge(c),{type:$e.showPassword?w.value?"text":"password":$e.type,disabled:ge(T),formatter:$e.formatter,parser:$e.parser,readonly:$e.readonly,autocomplete:$e.autocomplete,tabindex:$e.tabindex,"aria-label":$e.label,placeholder:$e.placeholder,style:$e.inputStyle,form:o.form,onCompositionstart:Xe,onCompositionupdate:Re,onCompositionend:_t,onInput:ce,onFocus:Ut,onBlur:Ui,onChange:Ee,onKeydown:ci}),null,16,gN),ot(" suffix slot "),ge(G)?(ie(),Se("span",{key:1,class:tt(ge(y).e("suffix"))},[le("span",{class:tt(ge(y).e("suffix-inner")),onClick:Rt},[!ge(D)||!ge(P)||!ge(V)?(ie(),Se(xt,{key:0},[Qt($e.$slots,"suffix"),$e.suffixIcon?(ie(),Ye(ge(fr),{key:0,class:tt(ge(y).e("icon"))},{default:We(()=>[(ie(),Ye(ti($e.suffixIcon)))]),_:1},8,["class"])):ot("v-if",true)],64)):ot("v-if",true),ge(D)?(ie(),Ye(ge(fr),{key:1,class:tt([ge(y).e("icon"),ge(y).e("clear")]),onMousedown:si(ge(ca),["prevent"]),onClick:Es},{default:We(()=>[De(ge(Gy))]),_:1},8,["class","onMousedown"])):ot("v-if",true),ge(P)?(ie(),Ye(ge(fr),{key:2,class:tt([ge(y).e("icon"),ge(y).e("password")]),onClick:Ct},{default:We(()=>[(ie(),Ye(ti(ge(F))))]),_:1},8,["class"])):ot("v-if",true),ge(V)?(ie(),Se("span",{key:3,class:tt(ge(y).e("count"))},[le("span",{class:tt(ge(y).e("count-inner"))},Pt(ge(j))+" / "+Pt(ge(c).maxlength),3)],2)):ot("v-if",true),ge(B)&&ge(H)&&ge(x)?(ie(),Ye(ge(fr),{key:4,class:tt([ge(y).e("icon"),ge(y).e("validateIcon"),ge(y).is("loading",ge(B)==="validating")])},{default:We(()=>[(ie(),Ye(ti(ge(H))))]),_:1},8,["class"])):ot("v-if",true)],2)],2)):ot("v-if",true)],2),ot(" append slot "),$e.$slots.append?(ie(),Se("div",{key:1,class:tt(ge(y).be("group","append"))},[Qt($e.$slots,"append")],2)):ot("v-if",true)],64)):(ie(),Se(xt,{key:1},[ot(" textarea "),le("textarea",Pl({id:ge(E),ref_key:"textarea",ref:R,class:ge(g).e("inner")},ge(c),{tabindex:$e.tabindex,disabled:ge(T),readonly:$e.readonly,autocomplete:$e.autocomplete,style:ge(Z),"aria-label":$e.label,placeholder:$e.placeholder,form:o.form,onCompositionstart:Xe,onCompositionupdate:Re,onCompositionend:_t,onInput:ce,onFocus:Ut,onBlur:Ui,onChange:Ee,onKeydown:ci}),null,16,fN),ge(V)?(ie(),Se("span",{key:0,style:Qs(A.value),class:tt(ge(y).e("count"))},Pt(ge(j))+" / "+Pt(ge(c).maxlength),7)):ot("v-if",true)],64))],16,pN)),[[$i,$e.type!=="hidden"]])}});var bN=Ta(EN,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const uR=Wf(bN),j_="focus-trap.focus-after-trapped",X_="focus-trap.focus-after-released",vN="focus-trap.focusout-prevented",cT={cancelable:true,bubbles:false},TN={cancelable:true,bubbles:false},uT="focusAfterTrapped",hT="focusAfterReleased",SN=Symbol("elFocusTrap"),Yf=be(),ah=be(0),qf=be(0);let Iu=0;const hR=s=>{const n=[],i=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const l=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||l?NodeFilter.FILTER_SKIP:o.tabIndex>=0||o===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)n.push(i.currentNode);return n},dT=(s,n)=>{for(const i of s)if(!$N(i,n))return i},$N=(s,n)=>{if(getComputedStyle(s).visibility==="hidden")return true;for(;s;){if(n&&s===n)return false;if(getComputedStyle(s).display==="none")return true;s=s.parentElement}return false},yN=s=>{const n=hR(s),i=dT(n,s),o=dT(n.reverse(),s);return[i,o]},RN=s=>s instanceof HTMLInputElement&&"select"in s,pr=(s,n)=>{if(s&&s.focus){const i=document.activeElement;s.focus({preventScroll:true}),qf.value=window.performance.now(),s!==i&&RN(s)&&n&&s.select()}};function _T(s,n){const i=[...s],o=s.indexOf(n);return o!==-1&&i.splice(o,1),i}const IN=()=>{let s=[];return{push:o=>{const l=s[0];l&&o!==l&&l.pause(),s=_T(s,o),s.unshift(o)},remove:o=>{var l,h;s=_T(s,o),(h=(l=s[0])==null?void 0:l.resume)==null||h.call(l)}}},CN=(s,n=false)=>{const i=document.activeElement;for(const o of s)if(pr(o,n),document.activeElement!==i)return},pT=IN(),ON=()=>ah.value>qf.value,Cu=()=>{Yf.value="pointer",ah.value=window.performance.now()},gT=()=>{Yf.value="keyboard",ah.value=window.performance.now()},wN=()=>(xs(()=>{Iu===0&&(document.addEventListener("mousedown",Cu),document.addEventListener("touchstart",Cu),document.addEventListener("keydown",gT)),Iu++}),ba(()=>{Iu--,Iu<=0&&(document.removeEventListener("mousedown",Cu),document.removeEventListener("touchstart",Cu),document.removeEventListener("keydown",gT))}),{focusReason:Yf,lastUserFocusTimestamp:ah,lastAutomatedFocusTimestamp:qf}),Ou=s=>new CustomEvent(vN,{...TN,detail:s}),kN=et({name:"ElFocusTrap",inheritAttrs:false,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[uT,hT,"focusin","focusout","focusout-prevented","release-requested"],setup(s,{emit:n}){const i=be();let o,l;const{focusReason:h}=wN();JL(T=>{s.trapped&&!f.paused&&n("release-requested",T)});const f={paused:false,pause(){this.paused=true},resume(){this.paused=false}},u=T=>{if(!s.loop&&!s.trapped||f.paused)return;const{key:y,altKey:g,ctrlKey:$,metaKey:R,currentTarget:v,shiftKey:S}=T,{loop:O}=s,w=y===zf.tab&&!g&&!$&&!R,A=document.activeElement;if(w&&A){const I=v,[L,x]=yN(I);if(L&&x){if(!S&&A===x){const H=Ou({focusReason:h.value});n("focusout-prevented",H),H.defaultPrevented||(T.preventDefault(),O&&pr(L,true))}else if(S&&[L,I].includes(A)){const H=Ou({focusReason:h.value});n("focusout-prevented",H),H.defaultPrevented||(T.preventDefault(),O&&pr(x,true))}}else if(A===I){const H=Ou({focusReason:h.value});n("focusout-prevented",H),H.defaultPrevented||T.preventDefault()}}};ac(SN,{focusTrapRef:i,onKeydown:u}),Mt(()=>s.focusTrapEl,T=>{T&&(i.value=T)},{immediate:true}),Mt([i],([T],[y])=>{T&&(T.addEventListener("keydown",u),T.addEventListener("focusin",_),T.addEventListener("focusout",m)),y&&(y.removeEventListener("keydown",u),y.removeEventListener("focusin",_),y.removeEventListener("focusout",m))});const p=T=>{n(uT,T)},c=T=>n(hT,T),_=T=>{const y=ge(i);if(!y)return;const g=T.target,$=T.relatedTarget,R=g&&y.contains(g);s.trapped||$&&y.contains($)||(o=$),R&&n("focusin",T),!f.paused&&s.trapped&&(R?l=g:pr(l,true))},m=T=>{const y=ge(i);if(!(f.paused||!y))if(s.trapped){const g=T.relatedTarget;!By(g)&&!y.contains(g)&&setTimeout(()=>{if(!f.paused&&s.trapped){const $=Ou({focusReason:h.value});n("focusout-prevented",$),$.defaultPrevented||pr(l,true)}},0)}else{const g=T.target;g&&y.contains(g)||n("focusout",T)}};async function E(){await ps();const T=ge(i);if(T){pT.push(f);const y=T.contains(document.activeElement)?o:document.activeElement;if(o=y,!T.contains(y)){const $=new Event(j_,cT);T.addEventListener(j_,p),T.dispatchEvent($),$.defaultPrevented||ps(()=>{let R=s.focusStartEl;vr(R)||(pr(R),document.activeElement!==R&&(R="first")),R==="first"&&CN(hR(T),true),(document.activeElement===y||R==="container")&&pr(T)})}}}function b(){const T=ge(i);if(T){T.removeEventListener(j_,p);const y=new CustomEvent(X_,{...cT,detail:{focusReason:h.value}});T.addEventListener(X_,c),T.dispatchEvent(y),!y.defaultPrevented&&(h.value=="keyboard"||!ON()||T.contains(document.activeElement))&&pr(o??document.body),T.removeEventListener(X_,p),pT.remove(f)}}return xs(()=>{s.trapped&&E(),Mt(()=>s.trapped,T=>{T?E():b()})}),ba(()=>{s.trapped&&b()}),{onKeydown:u}}});function AN(s,n,i,o,l,h){return Qt(s.$slots,"default",{handleKeydown:s.onKeydown})}var LN=Ta(kN,[["render",AN],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const dR=Symbol("buttonGroupContextKey"),NN=(s,n)=>{CL({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},me(()=>s.type==="text"));const i=ri(dR,void 0),o=jf("button"),{form:l}=cR(),h=lR(me(()=>i==null?void 0:i.size)),f=Kf(),u=be(),p=yy(),c=me(()=>s.type||(i==null?void 0:i.type)||""),_=me(()=>{var T,y,g;return(g=(y=s.autoInsertSpace)!=null?y:(T=o.value)==null?void 0:T.autoInsertSpace)!=null?g:false}),m=me(()=>s.tag==="button"?{ariaDisabled:f.value||s.loading,disabled:f.value||s.loading,autofocus:s.autofocus,type:s.nativeType}:{}),E=me(()=>{var T;const y=(T=p.default)==null?void 0:T.call(p);if(_.value&&(y==null?void 0:y.length)===1){const g=y[0];if((g==null?void 0:g.type)===lw){const $=g.children;return/^\p{Unified_Ideograph}{2}$/u.test($.trim())}}return false});return{_disabled:f,_size:h,_type:c,_ref:u,_props:m,shouldAddSpace:E,handleClick:T=>{s.nativeType==="reset"&&(l==null||l.resetFields()),n("click",T)}}},MN=["default","primary","success","warning","info","danger","text",""],DN=["button","submit","reset"],hf=rh({size:nR,disabled:Boolean,type:{type:String,values:MN,default:""},icon:{type:Yu},nativeType:{type:String,values:DN,default:"button"},loading:Boolean,loadingIcon:{type:Yu,default:()=>Vy},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:Tr([String,Object]),default:"button"}}),xN={click:s=>s instanceof MouseEvent};function ws(s,n){BN(s)&&(s="100%");var i=PN(s);return s=n===360?s:Math.min(n,Math.max(0,parseFloat(s))),i&&(s=parseInt(String(s*n),10)/100),Math.abs(s-n)<1e-6?1:(n===360?s=(s<0?s%n+n:s%n)/parseFloat(String(n)):s=s%n/parseFloat(String(n)),s)}function wu(s){return Math.min(1,Math.max(0,s))}function BN(s){return typeof s=="string"&&s.indexOf(".")!==-1&&parseFloat(s)===1}function PN(s){return typeof s=="string"&&s.indexOf("%")!==-1}function _R(s){return s=parseFloat(s),(isNaN(s)||s<0||s>1)&&(s=1),s}function ku(s){return s<=1?"".concat(Number(s)*100,"%"):s}function so(s){return s.length===1?"0"+s:String(s)}function UN(s,n,i){return{r:ws(s,255)*255,g:ws(n,255)*255,b:ws(i,255)*255}}function fT(s,n,i){s=ws(s,255),n=ws(n,255),i=ws(i,255);var o=Math.max(s,n,i),l=Math.min(s,n,i),h=0,f=0,u=(o+l)/2;if(o===l)f=0,h=0;else{var p=o-l;switch(f=u>.5?p/(2-o-l):p/(o+l),o){case s:h=(n-i)/p+(n<i?6:0);break;case n:h=(i-s)/p+2;break;case i:h=(s-n)/p+4;break}h/=6}return{h,s:f,l:u}}function K_(s,n,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?s+(n-s)*(6*i):i<1/2?n:i<2/3?s+(n-s)*(2/3-i)*6:s}function FN(s,n,i){var o,l,h;if(s=ws(s,360),n=ws(n,100),i=ws(i,100),n===0)l=i,h=i,o=i;else{var f=i<.5?i*(1+n):i+n-i*n,u=2*i-f;o=K_(u,f,s+1/3),l=K_(u,f,s),h=K_(u,f,s-1/3)}return{r:o*255,g:l*255,b:h*255}}function mT(s,n,i){s=ws(s,255),n=ws(n,255),i=ws(i,255);var o=Math.max(s,n,i),l=Math.min(s,n,i),h=0,f=o,u=o-l,p=o===0?0:u/o;if(o===l)h=0;else{switch(o){case s:h=(n-i)/u+(n<i?6:0);break;case n:h=(i-s)/u+2;break;case i:h=(s-n)/u+4;break}h/=6}return{h,s:p,v:f}}function GN(s,n,i){s=ws(s,360)*6,n=ws(n,100),i=ws(i,100);var o=Math.floor(s),l=s-o,h=i*(1-n),f=i*(1-l*n),u=i*(1-(1-l)*n),p=o%6,c=[i,f,h,h,u,i][p],_=[u,i,i,f,h,h][p],m=[h,h,u,i,i,f][p];return{r:c*255,g:_*255,b:m*255}}function ET(s,n,i,o){var l=[so(Math.round(s).toString(16)),so(Math.round(n).toString(16)),so(Math.round(i).toString(16))];return o&&l[0].startsWith(l[0].charAt(1))&&l[1].startsWith(l[1].charAt(1))&&l[2].startsWith(l[2].charAt(1))?l[0].charAt(0)+l[1].charAt(0)+l[2].charAt(0):l.join("")}function HN(s,n,i,o,l){var h=[so(Math.round(s).toString(16)),so(Math.round(n).toString(16)),so(Math.round(i).toString(16)),so(VN(o))];return l&&h[0].startsWith(h[0].charAt(1))&&h[1].startsWith(h[1].charAt(1))&&h[2].startsWith(h[2].charAt(1))&&h[3].startsWith(h[3].charAt(1))?h[0].charAt(0)+h[1].charAt(0)+h[2].charAt(0)+h[3].charAt(0):h.join("")}function VN(s){return Math.round(parseFloat(s)*255).toString(16)}function bT(s){return Ti(s)/255}function Ti(s){return parseInt(s,16)}function WN(s){return{r:s>>16,g:(s&65280)>>8,b:s&255}}var df={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function zN(s){var n={r:0,g:0,b:0},i=1,o=null,l=null,h=null,f=false,u=false;return typeof s=="string"&&(s=KN(s)),typeof s=="object"&&(Wn(s.r)&&Wn(s.g)&&Wn(s.b)?(n=UN(s.r,s.g,s.b),f=true,u=String(s.r).substr(-1)==="%"?"prgb":"rgb"):Wn(s.h)&&Wn(s.s)&&Wn(s.v)?(o=ku(s.s),l=ku(s.v),n=GN(s.h,o,l),f=true,u="hsv"):Wn(s.h)&&Wn(s.s)&&Wn(s.l)&&(o=ku(s.s),h=ku(s.l),n=FN(s.h,o,h),f=true,u="hsl"),Object.prototype.hasOwnProperty.call(s,"a")&&(i=s.a)),i=_R(i),{ok:f,format:s.format||u,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:i}}var jN="[-\\+]?\\d+%?",XN="[-\\+]?\\d*\\.\\d+%?",Er="(?:".concat(XN,")|(?:").concat(jN,")"),Y_="[\\s|\\(]+(".concat(Er,")[,|\\s]+(").concat(Er,")[,|\\s]+(").concat(Er,")\\s*\\)?"),q_="[\\s|\\(]+(".concat(Er,")[,|\\s]+(").concat(Er,")[,|\\s]+(").concat(Er,")[,|\\s]+(").concat(Er,")\\s*\\)?"),en={CSS_UNIT:new RegExp(Er),rgb:new RegExp("rgb"+Y_),rgba:new RegExp("rgba"+q_),hsl:new RegExp("hsl"+Y_),hsla:new RegExp("hsla"+q_),hsv:new RegExp("hsv"+Y_),hsva:new RegExp("hsva"+q_),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function KN(s){if(s=s.trim().toLowerCase(),s.length===0)return false;var n=false;if(df[s])s=df[s],n=true;else if(s==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i=en.rgb.exec(s);return i?{r:i[1],g:i[2],b:i[3]}:(i=en.rgba.exec(s),i?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=en.hsl.exec(s),i?{h:i[1],s:i[2],l:i[3]}:(i=en.hsla.exec(s),i?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=en.hsv.exec(s),i?{h:i[1],s:i[2],v:i[3]}:(i=en.hsva.exec(s),i?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=en.hex8.exec(s),i?{r:Ti(i[1]),g:Ti(i[2]),b:Ti(i[3]),a:bT(i[4]),format:n?"name":"hex8"}:(i=en.hex6.exec(s),i?{r:Ti(i[1]),g:Ti(i[2]),b:Ti(i[3]),format:n?"name":"hex"}:(i=en.hex4.exec(s),i?{r:Ti(i[1]+i[1]),g:Ti(i[2]+i[2]),b:Ti(i[3]+i[3]),a:bT(i[4]+i[4]),format:n?"name":"hex8"}:(i=en.hex3.exec(s),i?{r:Ti(i[1]+i[1]),g:Ti(i[2]+i[2]),b:Ti(i[3]+i[3]),format:n?"name":"hex"}:false)))))))))}function Wn(s){return!!en.CSS_UNIT.exec(String(s))}var YN=function(){function s(n,i){n===void 0&&(n=""),i===void 0&&(i={});var o;if(n instanceof s)return n;typeof n=="number"&&(n=WN(n)),this.originalInput=n;var l=zN(n);this.originalInput=n,this.r=l.r,this.g=l.g,this.b=l.b,this.a=l.a,this.roundA=Math.round(100*this.a)/100,this.format=(o=i.format)!==null&&o!==void 0?o:l.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=l.ok}return s.prototype.isDark=function(){return this.getBrightness()<128},s.prototype.isLight=function(){return!this.isDark()},s.prototype.getBrightness=function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},s.prototype.getLuminance=function(){var n=this.toRgb(),i,o,l,h=n.r/255,f=n.g/255,u=n.b/255;return h<=.03928?i=h/12.92:i=Math.pow((h+.055)/1.055,2.4),f<=.03928?o=f/12.92:o=Math.pow((f+.055)/1.055,2.4),u<=.03928?l=u/12.92:l=Math.pow((u+.055)/1.055,2.4),.2126*i+.7152*o+.0722*l},s.prototype.getAlpha=function(){return this.a},s.prototype.setAlpha=function(n){return this.a=_R(n),this.roundA=Math.round(100*this.a)/100,this},s.prototype.isMonochrome=function(){var n=this.toHsl().s;return n===0},s.prototype.toHsv=function(){var n=mT(this.r,this.g,this.b);return{h:n.h*360,s:n.s,v:n.v,a:this.a}},s.prototype.toHsvString=function(){var n=mT(this.r,this.g,this.b),i=Math.round(n.h*360),o=Math.round(n.s*100),l=Math.round(n.v*100);return this.a===1?"hsv(".concat(i,", ").concat(o,"%, ").concat(l,"%)"):"hsva(".concat(i,", ").concat(o,"%, ").concat(l,"%, ").concat(this.roundA,")")},s.prototype.toHsl=function(){var n=fT(this.r,this.g,this.b);return{h:n.h*360,s:n.s,l:n.l,a:this.a}},s.prototype.toHslString=function(){var n=fT(this.r,this.g,this.b),i=Math.round(n.h*360),o=Math.round(n.s*100),l=Math.round(n.l*100);return this.a===1?"hsl(".concat(i,", ").concat(o,"%, ").concat(l,"%)"):"hsla(".concat(i,", ").concat(o,"%, ").concat(l,"%, ").concat(this.roundA,")")},s.prototype.toHex=function(n){return n===void 0&&(n=false),ET(this.r,this.g,this.b,n)},s.prototype.toHexString=function(n){return n===void 0&&(n=false),"#"+this.toHex(n)},s.prototype.toHex8=function(n){return n===void 0&&(n=false),HN(this.r,this.g,this.b,this.a,n)},s.prototype.toHex8String=function(n){return n===void 0&&(n=false),"#"+this.toHex8(n)},s.prototype.toHexShortString=function(n){return n===void 0&&(n=false),this.a===1?this.toHexString(n):this.toHex8String(n)},s.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},s.prototype.toRgbString=function(){var n=Math.round(this.r),i=Math.round(this.g),o=Math.round(this.b);return this.a===1?"rgb(".concat(n,", ").concat(i,", ").concat(o,")"):"rgba(".concat(n,", ").concat(i,", ").concat(o,", ").concat(this.roundA,")")},s.prototype.toPercentageRgb=function(){var n=function(i){return"".concat(Math.round(ws(i,255)*100),"%")};return{r:n(this.r),g:n(this.g),b:n(this.b),a:this.a}},s.prototype.toPercentageRgbString=function(){var n=function(i){return Math.round(ws(i,255)*100)};return this.a===1?"rgb(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%)"):"rgba(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%, ").concat(this.roundA,")")},s.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return false;for(var n="#"+ET(this.r,this.g,this.b,false),i=0,o=Object.entries(df);i<o.length;i++){var l=o[i],h=l[0],f=l[1];if(n===f)return h}return false},s.prototype.toString=function(n){var i=!!n;n=n??this.format;var o=false,l=this.a<1&&this.a>=0,h=!i&&l&&(n.startsWith("hex")||n==="name");return h?n==="name"&&this.a===0?this.toName():this.toRgbString():(n==="rgb"&&(o=this.toRgbString()),n==="prgb"&&(o=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(o=this.toHexString()),n==="hex3"&&(o=this.toHexString(true)),n==="hex4"&&(o=this.toHex8String(true)),n==="hex8"&&(o=this.toHex8String()),n==="name"&&(o=this.toName()),n==="hsl"&&(o=this.toHslString()),n==="hsv"&&(o=this.toHsvString()),o||this.toHexString())},s.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},s.prototype.clone=function(){return new s(this.toString())},s.prototype.lighten=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.l+=n/100,i.l=wu(i.l),new s(i)},s.prototype.brighten=function(n){n===void 0&&(n=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(n/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(n/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(n/100)))),new s(i)},s.prototype.darken=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.l-=n/100,i.l=wu(i.l),new s(i)},s.prototype.tint=function(n){return n===void 0&&(n=10),this.mix("white",n)},s.prototype.shade=function(n){return n===void 0&&(n=10),this.mix("black",n)},s.prototype.desaturate=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.s-=n/100,i.s=wu(i.s),new s(i)},s.prototype.saturate=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.s+=n/100,i.s=wu(i.s),new s(i)},s.prototype.greyscale=function(){return this.desaturate(100)},s.prototype.spin=function(n){var i=this.toHsl(),o=(i.h+n)%360;return i.h=o<0?360+o:o,new s(i)},s.prototype.mix=function(n,i){i===void 0&&(i=50);var o=this.toRgb(),l=new s(n).toRgb(),h=i/100,f={r:(l.r-o.r)*h+o.r,g:(l.g-o.g)*h+o.g,b:(l.b-o.b)*h+o.b,a:(l.a-o.a)*h+o.a};return new s(f)},s.prototype.analogous=function(n,i){n===void 0&&(n=6),i===void 0&&(i=30);var o=this.toHsl(),l=360/i,h=[this];for(o.h=(o.h-(l*n>>1)+720)%360;--n;)o.h=(o.h+l)%360,h.push(new s(o));return h},s.prototype.complement=function(){var n=this.toHsl();return n.h=(n.h+180)%360,new s(n)},s.prototype.monochromatic=function(n){n===void 0&&(n=6);for(var i=this.toHsv(),o=i.h,l=i.s,h=i.v,f=[],u=1/n;n--;)f.push(new s({h:o,s:l,v:h})),h=(h+u)%1;return f},s.prototype.splitcomplement=function(){var n=this.toHsl(),i=n.h;return[this,new s({h:(i+72)%360,s:n.s,l:n.l}),new s({h:(i+216)%360,s:n.s,l:n.l})]},s.prototype.onBackground=function(n){var i=this.toRgb(),o=new s(n).toRgb(),l=i.a+o.a*(1-i.a);return new s({r:(i.r*i.a+o.r*o.a*(1-i.a))/l,g:(i.g*i.a+o.g*o.a*(1-i.a))/l,b:(i.b*i.a+o.b*o.a*(1-i.a))/l,a:l})},s.prototype.triad=function(){return this.polyad(3)},s.prototype.tetrad=function(){return this.polyad(4)},s.prototype.polyad=function(n){for(var i=this.toHsl(),o=i.h,l=[this],h=360/n,f=1;f<n;f++)l.push(new s({h:(o+f*h)%360,s:i.s,l:i.l}));return l},s.prototype.equals=function(n){return this.toRgbString()===new s(n).toRgbString()},s}();function _r(s,n=20){return s.mix("#141414",n).toString()}function qN(s){const n=Kf(),i=qn("button");return me(()=>{let o={};const l=s.color;if(l){const h=new YN(l),f=s.dark?h.tint(20).toString():_r(h,20);if(s.plain)o=i.cssVarBlock({"bg-color":s.dark?_r(h,90):h.tint(90).toString(),"text-color":l,"border-color":s.dark?_r(h,50):h.tint(50).toString(),"hover-text-color":`var(${i.cssVarName("color-white")})`,"hover-bg-color":l,"hover-border-color":l,"active-bg-color":f,"active-text-color":`var(${i.cssVarName("color-white")})`,"active-border-color":f}),n.value&&(o[i.cssVarBlockName("disabled-bg-color")]=s.dark?_r(h,90):h.tint(90).toString(),o[i.cssVarBlockName("disabled-text-color")]=s.dark?_r(h,50):h.tint(50).toString(),o[i.cssVarBlockName("disabled-border-color")]=s.dark?_r(h,80):h.tint(80).toString());else{const u=s.dark?_r(h,30):h.tint(30).toString(),p=h.isDark()?`var(${i.cssVarName("color-white")})`:`var(${i.cssVarName("color-black")})`;if(o=i.cssVarBlock({"bg-color":l,"text-color":p,"border-color":l,"hover-bg-color":u,"hover-text-color":p,"hover-border-color":u,"active-bg-color":f,"active-border-color":f}),n.value){const c=s.dark?_r(h,50):h.tint(50).toString();o[i.cssVarBlockName("disabled-bg-color")]=c,o[i.cssVarBlockName("disabled-text-color")]=s.dark?"rgba(255, 255, 255, 0.5)":`var(${i.cssVarName("color-white")})`,o[i.cssVarBlockName("disabled-border-color")]=c}}}return o})}const JN=et({name:"ElButton"}),ZN=et({...JN,props:hf,emits:xN,setup(s,{expose:n,emit:i}){const o=s,l=qN(o),h=qn("button"),{_ref:f,_size:u,_type:p,_disabled:c,_props:_,shouldAddSpace:m,handleClick:E}=NN(o,i);return n({ref:f,size:u,type:p,disabled:c,shouldAddSpace:m}),(b,T)=>(ie(),Ye(ti(b.tag),Pl({ref_key:"_ref",ref:f},ge(_),{class:[ge(h).b(),ge(h).m(ge(p)),ge(h).m(ge(u)),ge(h).is("disabled",ge(c)),ge(h).is("loading",b.loading),ge(h).is("plain",b.plain),ge(h).is("round",b.round),ge(h).is("circle",b.circle),ge(h).is("text",b.text),ge(h).is("link",b.link),ge(h).is("has-bg",b.bg)],style:ge(l),onClick:ge(E)}),{default:We(()=>[b.loading?(ie(),Se(xt,{key:0},[b.$slots.loading?Qt(b.$slots,"loading",{key:0}):(ie(),Ye(ge(fr),{key:1,class:tt(ge(h).is("loading"))},{default:We(()=>[(ie(),Ye(ti(b.loadingIcon)))]),_:1},8,["class"]))],64)):b.icon||b.$slots.icon?(ie(),Ye(ge(fr),{key:1},{default:We(()=>[b.icon?(ie(),Ye(ti(b.icon),{key:0})):Qt(b.$slots,"icon",{key:1})]),_:3})):ot("v-if",true),b.$slots.default?(ie(),Se("span",{key:2,class:tt({[ge(h).em("text","expand")]:ge(m)})},[Qt(b.$slots,"default")],2)):ot("v-if",true)]),_:3},16,["class","style","onClick"]))}});var QN=Ta(ZN,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button.vue"]]);const eM={size:hf.size,type:hf.type},tM=et({name:"ElButtonGroup"}),sM=et({...tM,props:eM,setup(s){const n=s;ac(dR,In({size:tn(n,"size"),type:tn(n,"type")}));const i=qn("button");return(o,l)=>(ie(),Se("div",{class:tt(`${ge(i).b("group")}`)},[Qt(o.$slots,"default")],2))}});var pR=Ta(sM,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button-group.vue"]]);const iM=Wf(QN,{ButtonGroup:pR});vL(pR);var Ri=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jf(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function nM(s){if(s.__esModule)return s;var n=s.default;if(typeof n=="function"){var i=function o(){if(this instanceof o){var l=[null];l.push.apply(l,arguments);var h=Function.bind.apply(n,l);return new h}return n.apply(this,arguments)};i.prototype=n.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:true}),Object.keys(s).forEach(function(o){var l=Object.getOwnPropertyDescriptor(s,o);Object.defineProperty(i,o,l.get?l:{enumerable:true,get:function(){return s[o]}})}),i}const _f="_trap-focus-children",io=[],vT=s=>{if(io.length===0)return;const n=io[io.length-1][_f];if(n.length>0&&s.code===zf.tab){if(n.length===1){s.preventDefault(),document.activeElement!==n[0]&&n[0].focus();return}const i=s.shiftKey,o=s.target===n[0],l=s.target===n[n.length-1];o&&i&&(s.preventDefault(),n[n.length-1].focus()),l&&!i&&(s.preventDefault(),n[0].focus())}},rM={beforeMount(s){s[_f]=Kv(s),io.push(s),io.length<=1&&document.addEventListener("keydown",vT)},updated(s){ps(()=>{s[_f]=Kv(s)})},unmounted(){io.shift(),io.length===0&&document.removeEventListener("keydown",vT)}},oM=rh({mask:{type:Boolean,default:true},customMaskEvent:{type:Boolean,default:false},overlayClass:{type:Tr([String,Array,Object])},zIndex:{type:Tr([String,Number])}}),aM={click:s=>s instanceof MouseEvent},lM="overlay";var cM=et({name:"ElOverlay",props:oM,emits:aM,setup(s,{slots:n,emit:i}){const o=qn(lM),l=p=>{i("click",p)},{onClick:h,onMousedown:f,onMouseup:u}=tR(s.customMaskEvent?void 0:l);return()=>s.mask?De("div",{class:[o.b(),s.overlayClass],style:{zIndex:s.zIndex},onClick:h,onMousedown:f,onMouseup:u},[Qt(n,"default")],Gu.STYLE|Gu.CLASS|Gu.PROPS,["onClick","onMouseup","onMousedown"]):ju("div",{class:s.overlayClass,style:{zIndex:s.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Qt(n,"default")])}});const uM=cM,hM=et({name:"ElMessageBox",directives:{TrapFocus:rM},components:{ElButton:iM,ElFocusTrap:LN,ElInput:uR,ElOverlay:uM,ElIcon:fr,...EL},inheritAttrs:false,props:{buttonSize:{type:String,validator:TL},modal:{type:Boolean,default:true},lockScroll:{type:Boolean,default:true},showClose:{type:Boolean,default:true},closeOnClickModal:{type:Boolean,default:true},closeOnPressEscape:{type:Boolean,default:true},closeOnHashChange:{type:Boolean,default:true},center:Boolean,draggable:Boolean,roundButton:{default:false,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(s,{emit:n}){const{locale:i,zIndex:o,ns:l,size:h}=tN("message-box",me(()=>s.buttonSize)),{t:f}=i,{nextZIndex:u}=o,p=be(false),c=In({autofocus:true,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:false,distinguishCancelAndClose:false,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:true,modalClass:"",showCancelButton:false,showConfirmButton:true,type:"",title:void 0,showInput:false,action:"",confirmButtonLoading:false,cancelButtonLoading:false,confirmButtonDisabled:false,editorErrorMessage:"",validateError:false,zIndex:u()}),_=me(()=>{const Z=c.type;return{[l.bm("icon",Z)]:Z&&sT[Z]}}),m=uf(),E=uf(),b=me(()=>c.icon||sT[c.type]||""),T=me(()=>!!c.message),y=be(),g=be(),$=be(),R=be(),v=be(),S=me(()=>c.confirmButtonClass);Mt(()=>c.inputValue,async Z=>{await ps(),s.boxType==="prompt"&&Z!==null&&B()},{immediate:true}),Mt(()=>p.value,Z=>{var J,D;Z&&(s.boxType!=="prompt"&&(c.autofocus?$.value=(D=(J=v.value)==null?void 0:J.$el)!=null?D:y.value:$.value=y.value),c.zIndex=u()),s.boxType==="prompt"&&(Z?ps().then(()=>{var P;R.value&&R.value.$el&&(c.autofocus?$.value=(P=H())!=null?P:y.value:$.value=y.value)}):(c.editorErrorMessage="",c.validateError=false))});const O=me(()=>s.draggable);OL(y,g,O),xs(async()=>{await ps(),s.closeOnHashChange&&window.addEventListener("hashchange",w)}),ba(()=>{s.closeOnHashChange&&window.removeEventListener("hashchange",w)});function w(){p.value&&(p.value=false,ps(()=>{c.action&&n("action",c.action)}))}const A=()=>{s.closeOnClickModal&&x(c.distinguishCancelAndClose?"close":"cancel")},I=tR(A),L=Z=>{if(c.inputType!=="textarea")return Z.preventDefault(),x("confirm")},x=Z=>{var J;s.boxType==="prompt"&&Z==="confirm"&&!B()||(c.action=Z,c.beforeClose?(J=c.beforeClose)==null||J.call(c,Z,c,w):w())},B=()=>{if(s.boxType==="prompt"){const Z=c.inputPattern;if(Z&&!Z.test(c.inputValue||""))return c.editorErrorMessage=c.inputErrorMessage||f("el.messagebox.error"),c.validateError=true,false;const J=c.inputValidator;if(typeof J=="function"){const D=J(c.inputValue);if(D===false)return c.editorErrorMessage=c.inputErrorMessage||f("el.messagebox.error"),c.validateError=true,false;if(typeof D=="string")return c.editorErrorMessage=D,c.validateError=true,false}}return c.editorErrorMessage="",c.validateError=false,true},H=()=>{const Z=R.value.$refs;return Z.input||Z.textarea},F=()=>{x("close")},X=()=>{s.closeOnPressEscape&&F()};return s.lockScroll&&XL(p),KL(p),{...Ry(c),ns:l,overlayEvent:I,visible:p,hasMessage:T,typeClass:_,contentId:m,inputId:E,btnSize:h,iconComponent:b,confirmButtonClasses:S,rootRef:y,focusStartRef:$,headerRef:g,inputRef:R,confirmRef:v,doClose:w,handleClose:F,onCloseRequested:X,handleWrapperClick:A,handleInputEnter:L,handleAction:x,t:f}}}),dM=["aria-label","aria-describedby"],_M=["aria-label"],pM=["id"];function gM(s,n,i,o,l,h){const f=Ze("el-icon"),u=Ze("close"),p=Ze("el-input"),c=Ze("el-button"),_=Ze("el-focus-trap"),m=Ze("el-overlay");return ie(),Ye(lc,{name:"fade-in-linear",onAfterLeave:n[11]||(n[11]=E=>s.$emit("vanish")),persisted:""},{default:We(()=>[Hs(De(m,{"z-index":s.zIndex,"overlay-class":[s.ns.is("message-box"),s.modalClass],mask:s.modal},{default:We(()=>[le("div",{role:"dialog","aria-label":s.title,"aria-modal":"true","aria-describedby":s.showInput?void 0:s.contentId,class:tt(`${s.ns.namespace.value}-overlay-message-box`),onClick:n[8]||(n[8]=(...E)=>s.overlayEvent.onClick&&s.overlayEvent.onClick(...E)),onMousedown:n[9]||(n[9]=(...E)=>s.overlayEvent.onMousedown&&s.overlayEvent.onMousedown(...E)),onMouseup:n[10]||(n[10]=(...E)=>s.overlayEvent.onMouseup&&s.overlayEvent.onMouseup(...E))},[De(_,{loop:"",trapped:s.visible,"focus-trap-el":s.rootRef,"focus-start-el":s.focusStartRef,onReleaseRequested:s.onCloseRequested},{default:We(()=>[le("div",{ref:"rootRef",class:tt([s.ns.b(),s.customClass,s.ns.is("draggable",s.draggable),{[s.ns.m("center")]:s.center}]),style:Qs(s.customStyle),tabindex:"-1",onClick:n[7]||(n[7]=si(()=>{},["stop"]))},[s.title!==null&&s.title!==void 0?(ie(),Se("div",{key:0,ref:"headerRef",class:tt(s.ns.e("header"))},[le("div",{class:tt(s.ns.e("title"))},[s.iconComponent&&s.center?(ie(),Ye(f,{key:0,class:tt([s.ns.e("status"),s.typeClass])},{default:We(()=>[(ie(),Ye(ti(s.iconComponent)))]),_:1},8,["class"])):ot("v-if",true),le("span",null,Pt(s.title),1)],2),s.showClose?(ie(),Se("button",{key:0,type:"button",class:tt(s.ns.e("headerbtn")),"aria-label":s.t("el.messagebox.close"),onClick:n[0]||(n[0]=E=>s.handleAction(s.distinguishCancelAndClose?"close":"cancel")),onKeydown:n[1]||(n[1]=la(si(E=>s.handleAction(s.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[De(f,{class:tt(s.ns.e("close"))},{default:We(()=>[De(u)]),_:1},8,["class"])],42,_M)):ot("v-if",true)],2)):ot("v-if",true),le("div",{id:s.contentId,class:tt(s.ns.e("content"))},[le("div",{class:tt(s.ns.e("container"))},[s.iconComponent&&!s.center&&s.hasMessage?(ie(),Ye(f,{key:0,class:tt([s.ns.e("status"),s.typeClass])},{default:We(()=>[(ie(),Ye(ti(s.iconComponent)))]),_:1},8,["class"])):ot("v-if",true),s.hasMessage?(ie(),Se("div",{key:1,class:tt(s.ns.e("message"))},[Qt(s.$slots,"default",{},()=>[s.dangerouslyUseHTMLString?(ie(),Ye(ti(s.showInput?"label":"p"),{key:1,for:s.showInput?s.inputId:void 0,innerHTML:s.message},null,8,["for","innerHTML"])):(ie(),Ye(ti(s.showInput?"label":"p"),{key:0,for:s.showInput?s.inputId:void 0},{default:We(()=>[Dt(Pt(s.dangerouslyUseHTMLString?"":s.message),1)]),_:1},8,["for"]))])],2)):ot("v-if",true)],2),Hs(le("div",{class:tt(s.ns.e("input"))},[De(p,{id:s.inputId,ref:"inputRef",modelValue:s.inputValue,"onUpdate:modelValue":n[2]||(n[2]=E=>s.inputValue=E),type:s.inputType,placeholder:s.inputPlaceholder,"aria-invalid":s.validateError,class:tt({invalid:s.validateError}),onKeydown:la(s.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),le("div",{class:tt(s.ns.e("errormsg")),style:Qs({visibility:s.editorErrorMessage?"visible":"hidden"})},Pt(s.editorErrorMessage),7)],2),[[$i,s.showInput]])],10,pM),le("div",{class:tt(s.ns.e("btns"))},[s.showCancelButton?(ie(),Ye(c,{key:0,loading:s.cancelButtonLoading,class:tt([s.cancelButtonClass]),round:s.roundButton,size:s.btnSize,onClick:n[3]||(n[3]=E=>s.handleAction("cancel")),onKeydown:n[4]||(n[4]=la(si(E=>s.handleAction("cancel"),["prevent"]),["enter"]))},{default:We(()=>[Dt(Pt(s.cancelButtonText||s.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):ot("v-if",true),Hs(De(c,{ref:"confirmRef",type:"primary",loading:s.confirmButtonLoading,class:tt([s.confirmButtonClasses]),round:s.roundButton,disabled:s.confirmButtonDisabled,size:s.btnSize,onClick:n[5]||(n[5]=E=>s.handleAction("confirm")),onKeydown:n[6]||(n[6]=la(si(E=>s.handleAction("confirm"),["prevent"]),["enter"]))},{default:We(()=>[Dt(Pt(s.confirmButtonText||s.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[$i,s.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,dM)]),_:3},8,["z-index","overlay-class","mask"]),[[$i,s.visible]])]),_:3})}var fM=Ta(hM,[["render",gM],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const Wl=new Map,mM=s=>{let n=document.body;return s.appendTo&&(vr(s.appendTo)&&(n=document.querySelector(s.appendTo)),Qv(s.appendTo)&&(n=s.appendTo),Qv(n)||(n=document.body)),n},EM=(s,n,i=null)=>{const o=De(fM,s,rf(s.message)||Iy(s.message)?{default:rf(s.message)?s.message:()=>s.message}:null);return o.appContext=i,Cy(o,n),mM(s).appendChild(n.firstElementChild),o.component},bM=()=>document.createElement("div"),vM=(s,n)=>{const i=bM();s.onVanish=()=>{Cy(null,i),Wl.delete(l)},s.onAction=h=>{const f=Wl.get(l);let u;s.showInput?u={value:l.inputValue,action:h}:u=h,s.callback?s.callback(u,o.proxy):h==="cancel"||h==="close"?s.distinguishCancelAndClose&&h!=="cancel"?f.reject("close"):f.reject("cancel"):f.resolve(u)};const o=EM(s,i,n),l=o.proxy;for(const h in s)Xu(s,h)&&!Xu(l.$props,h)&&(l[h]=s[h]);return l.visible=true,l};function Sa(s,n=null){if(!Ir)return Promise.reject();let i;return vr(s)||Iy(s)?s={message:s}:i=s.callback,new Promise((o,l)=>{const h=vM(s,n??Sa._context);Wl.set(h,{options:s,callback:i,resolve:o,reject:l})})}const TM=["alert","confirm","prompt"],SM={alert:{closeOnPressEscape:false,closeOnClickModal:false},confirm:{showCancelButton:true},prompt:{showCancelButton:true,showInput:true}};TM.forEach(s=>{Sa[s]=$M(s)});function $M(s){return(n,i,o,l)=>{let h="";return Hl(i)?(o=i,h=""):Py(i)?h="":h=i,Sa(Object.assign({title:h,message:n,type:"",...SM[s]},o,{boxType:s}),l)}}Sa.close=()=>{Wl.forEach((s,n)=>{n.doClose()}),Wl.clear()};Sa._context=null;const gr=Sa;gr.install=s=>{gr._context=s._context,s.config.globalProperties.$msgbox=gr,s.config.globalProperties.$messageBox=gr,s.config.globalProperties.$alert=gr.alert,s.config.globalProperties.$confirm=gr.confirm,s.config.globalProperties.$prompt=gr.prompt};const Ml=gr,yM={name:"import"},RM={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:{height:"24px"}},IM=le("path",{fill:"currentColor",d:"M263 383C258.3 387.7 256 393.8 256 400s2.344 12.28 7.031 16.97c9.375 9.375 24.56 9.375 33.94 0l80-80c9.375-9.375 9.375-24.56 0-33.94l-80-80c-9.375-9.375-24.56-9.375-33.94 0s-9.375 24.56 0 33.94L302.1 296H24C10.75 296 0 306.8 0 320s10.75 24 24 24h278.1L263 383zM493.3 93.38l-74.63-74.64C406.6 6.742 390.3 0 373.4 0H192C156.7 0 127.1 28.66 128 64l.0078 168c.002 13.26 10.75 24 24 24s24-10.75 23.1-24L176 64.13c0-8.836 7.162-16 16-16h160L352 128c0 17.67 14.33 32 32 32h79.1v288c0 8.836-7.164 16-16 16H192c-8.838 0-16-7.164-16-16l-.002-40C176 394.7 165.3 384 152 384s-24 10.75-23.1 24L128 448c.002 35.34 28.65 64 64 64H448c35.2 0 64-28.8 64-64V138.6C512 121.7 505.3 105.4 493.3 93.38z"},null,-1),CM=[IM];function OM(s,n,i,o,l,h){return ie(),Se("svg",RM,CM)}const wM=Jn(yM,[["render",OM]]),kM={},AM={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",style:{height:"24px"},fill:"currentColor"},LM=le("path",{d:"M320 464c8.8 0 16-7.2 16-16V160H256c-17.7 0-32-14.3-32-32V48H64c-8.8 0-16 7.2-16 16V448c0 8.8 7.2 16 16 16H320zM0 64C0 28.7 28.7 0 64 0H229.5c17 0 33.3 6.7 45.3 18.7l90.5 90.5c12 12 18.7 28.3 18.7 45.3V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64z"},null,-1),NM=[LM];function MM(s,n){return ie(),Se("svg",AM,NM)}const DM=Jn(kM,[["render",MM]]);/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const xM=4,TT=0,ST=1,BM=2;function $a(s){let n=s.length;for(;--n>=0;)s[n]=0}const PM=0,gR=1,UM=2,FM=3,GM=258,Zf=29,cc=256,zl=cc+1+Zf,ua=30,Qf=19,fR=2*zl+1,no=15,J_=16,HM=7,em=256,mR=16,ER=17,bR=18,pf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Vu=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),VM=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),vR=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),WM=512,jn=new Array((zl+2)*2);$a(jn);const Ul=new Array(ua*2);$a(Ul);const jl=new Array(WM);$a(jl);const Xl=new Array(GM-FM+1);$a(Xl);const tm=new Array(Zf);$a(tm);const Ju=new Array(ua);$a(Ju);function Z_(s,n,i,o,l){this.static_tree=s,this.extra_bits=n,this.extra_base=i,this.elems=o,this.max_length=l,this.has_stree=s&&s.length}let TR,SR,$R;function Q_(s,n){this.dyn_tree=s,this.max_code=0,this.stat_desc=n}const yR=s=>s<256?jl[s]:jl[256+(s>>>7)],Kl=(s,n)=>{s.pending_buf[s.pending++]=n&255,s.pending_buf[s.pending++]=n>>>8&255},ii=(s,n,i)=>{s.bi_valid>J_-i?(s.bi_buf|=n<<s.bi_valid&65535,Kl(s,s.bi_buf),s.bi_buf=n>>J_-s.bi_valid,s.bi_valid+=i-J_):(s.bi_buf|=n<<s.bi_valid&65535,s.bi_valid+=i)},Sn=(s,n,i)=>{ii(s,i[n*2],i[n*2+1])},RR=(s,n)=>{let i=0;do i|=s&1,s>>>=1,i<<=1;while(--n>0);return i>>>1},zM=s=>{s.bi_valid===16?(Kl(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0):s.bi_valid>=8&&(s.pending_buf[s.pending++]=s.bi_buf&255,s.bi_buf>>=8,s.bi_valid-=8)},jM=(s,n)=>{const i=n.dyn_tree,o=n.max_code,l=n.stat_desc.static_tree,h=n.stat_desc.has_stree,f=n.stat_desc.extra_bits,u=n.stat_desc.extra_base,p=n.stat_desc.max_length;let c,_,m,E,b,T,y=0;for(E=0;E<=no;E++)s.bl_count[E]=0;for(i[s.heap[s.heap_max]*2+1]=0,c=s.heap_max+1;c<fR;c++)_=s.heap[c],E=i[i[_*2+1]*2+1]+1,E>p&&(E=p,y++),i[_*2+1]=E,!(_>o)&&(s.bl_count[E]++,b=0,_>=u&&(b=f[_-u]),T=i[_*2],s.opt_len+=T*(E+b),h&&(s.static_len+=T*(l[_*2+1]+b)));if(y!==0){do{for(E=p-1;s.bl_count[E]===0;)E--;s.bl_count[E]--,s.bl_count[E+1]+=2,s.bl_count[p]--,y-=2}while(y>0);for(E=p;E!==0;E--)for(_=s.bl_count[E];_!==0;)m=s.heap[--c],!(m>o)&&(i[m*2+1]!==E&&(s.opt_len+=(E-i[m*2+1])*i[m*2],i[m*2+1]=E),_--)}},IR=(s,n,i)=>{const o=new Array(no+1);let l=0,h,f;for(h=1;h<=no;h++)l=l+i[h-1]<<1,o[h]=l;for(f=0;f<=n;f++){let u=s[f*2+1];u!==0&&(s[f*2]=RR(o[u]++,u))}},XM=()=>{let s,n,i,o,l;const h=new Array(no+1);for(i=0,o=0;o<Zf-1;o++)for(tm[o]=i,s=0;s<1<<pf[o];s++)Xl[i++]=o;for(Xl[i-1]=o,l=0,o=0;o<16;o++)for(Ju[o]=l,s=0;s<1<<Vu[o];s++)jl[l++]=o;for(l>>=7;o<ua;o++)for(Ju[o]=l<<7,s=0;s<1<<Vu[o]-7;s++)jl[256+l++]=o;for(n=0;n<=no;n++)h[n]=0;for(s=0;s<=143;)jn[s*2+1]=8,s++,h[8]++;for(;s<=255;)jn[s*2+1]=9,s++,h[9]++;for(;s<=279;)jn[s*2+1]=7,s++,h[7]++;for(;s<=287;)jn[s*2+1]=8,s++,h[8]++;for(IR(jn,zl+1,h),s=0;s<ua;s++)Ul[s*2+1]=5,Ul[s*2]=RR(s,5);TR=new Z_(jn,pf,cc+1,zl,no),SR=new Z_(Ul,Vu,0,ua,no),$R=new Z_(new Array(0),VM,0,Qf,HM)},CR=s=>{let n;for(n=0;n<zl;n++)s.dyn_ltree[n*2]=0;for(n=0;n<ua;n++)s.dyn_dtree[n*2]=0;for(n=0;n<Qf;n++)s.bl_tree[n*2]=0;s.dyn_ltree[em*2]=1,s.opt_len=s.static_len=0,s.sym_next=s.matches=0},OR=s=>{s.bi_valid>8?Kl(s,s.bi_buf):s.bi_valid>0&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0},$T=(s,n,i,o)=>{const l=n*2,h=i*2;return s[l]<s[h]||s[l]===s[h]&&o[n]<=o[i]},ep=(s,n,i)=>{const o=s.heap[i];let l=i<<1;for(;l<=s.heap_len&&(l<s.heap_len&&$T(n,s.heap[l+1],s.heap[l],s.depth)&&l++,!$T(n,o,s.heap[l],s.depth));)s.heap[i]=s.heap[l],i=l,l<<=1;s.heap[i]=o},yT=(s,n,i)=>{let o,l,h=0,f,u;if(s.sym_next!==0)do o=s.pending_buf[s.sym_buf+h++]&255,o+=(s.pending_buf[s.sym_buf+h++]&255)<<8,l=s.pending_buf[s.sym_buf+h++],o===0?Sn(s,l,n):(f=Xl[l],Sn(s,f+cc+1,n),u=pf[f],u!==0&&(l-=tm[f],ii(s,l,u)),o--,f=yR(o),Sn(s,f,i),u=Vu[f],u!==0&&(o-=Ju[f],ii(s,o,u)));while(h<s.sym_next);Sn(s,em,n)},gf=(s,n)=>{const i=n.dyn_tree,o=n.stat_desc.static_tree,l=n.stat_desc.has_stree,h=n.stat_desc.elems;let f,u,p=-1,c;for(s.heap_len=0,s.heap_max=fR,f=0;f<h;f++)i[f*2]!==0?(s.heap[++s.heap_len]=p=f,s.depth[f]=0):i[f*2+1]=0;for(;s.heap_len<2;)c=s.heap[++s.heap_len]=p<2?++p:0,i[c*2]=1,s.depth[c]=0,s.opt_len--,l&&(s.static_len-=o[c*2+1]);for(n.max_code=p,f=s.heap_len>>1;f>=1;f--)ep(s,i,f);c=h;do f=s.heap[1],s.heap[1]=s.heap[s.heap_len--],ep(s,i,1),u=s.heap[1],s.heap[--s.heap_max]=f,s.heap[--s.heap_max]=u,i[c*2]=i[f*2]+i[u*2],s.depth[c]=(s.depth[f]>=s.depth[u]?s.depth[f]:s.depth[u])+1,i[f*2+1]=i[u*2+1]=c,s.heap[1]=c++,ep(s,i,1);while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1],jM(s,n),IR(i,p,s.bl_count)},RT=(s,n,i)=>{let o,l=-1,h,f=n[0*2+1],u=0,p=7,c=4;for(f===0&&(p=138,c=3),n[(i+1)*2+1]=65535,o=0;o<=i;o++)h=f,f=n[(o+1)*2+1],!(++u<p&&h===f)&&(u<c?s.bl_tree[h*2]+=u:h!==0?(h!==l&&s.bl_tree[h*2]++,s.bl_tree[mR*2]++):u<=10?s.bl_tree[ER*2]++:s.bl_tree[bR*2]++,u=0,l=h,f===0?(p=138,c=3):h===f?(p=6,c=3):(p=7,c=4))},IT=(s,n,i)=>{let o,l=-1,h,f=n[0*2+1],u=0,p=7,c=4;for(f===0&&(p=138,c=3),o=0;o<=i;o++)if(h=f,f=n[(o+1)*2+1],!(++u<p&&h===f)){if(u<c)do Sn(s,h,s.bl_tree);while(--u!==0);else h!==0?(h!==l&&(Sn(s,h,s.bl_tree),u--),Sn(s,mR,s.bl_tree),ii(s,u-3,2)):u<=10?(Sn(s,ER,s.bl_tree),ii(s,u-3,3)):(Sn(s,bR,s.bl_tree),ii(s,u-11,7));u=0,l=h,f===0?(p=138,c=3):h===f?(p=6,c=3):(p=7,c=4)}},KM=s=>{let n;for(RT(s,s.dyn_ltree,s.l_desc.max_code),RT(s,s.dyn_dtree,s.d_desc.max_code),gf(s,s.bl_desc),n=Qf-1;n>=3&&s.bl_tree[vR[n]*2+1]===0;n--);return s.opt_len+=3*(n+1)+5+5+4,n},YM=(s,n,i,o)=>{let l;for(ii(s,n-257,5),ii(s,i-1,5),ii(s,o-4,4),l=0;l<o;l++)ii(s,s.bl_tree[vR[l]*2+1],3);IT(s,s.dyn_ltree,n-1),IT(s,s.dyn_dtree,i-1)},qM=s=>{let n=4093624447,i;for(i=0;i<=31;i++,n>>>=1)if(n&1&&s.dyn_ltree[i*2]!==0)return TT;if(s.dyn_ltree[9*2]!==0||s.dyn_ltree[10*2]!==0||s.dyn_ltree[13*2]!==0)return ST;for(i=32;i<cc;i++)if(s.dyn_ltree[i*2]!==0)return ST;return TT};let CT=false;const JM=s=>{CT||(XM(),CT=true),s.l_desc=new Q_(s.dyn_ltree,TR),s.d_desc=new Q_(s.dyn_dtree,SR),s.bl_desc=new Q_(s.bl_tree,$R),s.bi_buf=0,s.bi_valid=0,CR(s)},wR=(s,n,i,o)=>{ii(s,(PM<<1)+(o?1:0),3),OR(s),Kl(s,i),Kl(s,~i),i&&s.pending_buf.set(s.window.subarray(n,n+i),s.pending),s.pending+=i},ZM=s=>{ii(s,gR<<1,3),Sn(s,em,jn),zM(s)},QM=(s,n,i,o)=>{let l,h,f=0;s.level>0?(s.strm.data_type===BM&&(s.strm.data_type=qM(s)),gf(s,s.l_desc),gf(s,s.d_desc),f=KM(s),l=s.opt_len+3+7>>>3,h=s.static_len+3+7>>>3,h<=l&&(l=h)):l=h=i+5,i+4<=l&&n!==-1?wR(s,n,i,o):s.strategy===xM||h===l?(ii(s,(gR<<1)+(o?1:0),3),yT(s,jn,Ul)):(ii(s,(UM<<1)+(o?1:0),3),YM(s,s.l_desc.max_code+1,s.d_desc.max_code+1,f+1),yT(s,s.dyn_ltree,s.dyn_dtree)),CR(s),o&&OR(s)},e1=(s,n,i)=>(s.pending_buf[s.sym_buf+s.sym_next++]=n,s.pending_buf[s.sym_buf+s.sym_next++]=n>>8,s.pending_buf[s.sym_buf+s.sym_next++]=i,n===0?s.dyn_ltree[i*2]++:(s.matches++,n--,s.dyn_ltree[(Xl[i]+cc+1)*2]++,s.dyn_dtree[yR(n)*2]++),s.sym_next===s.sym_end);var t1=JM,s1=wR,i1=QM,n1=e1,r1=ZM,o1={_tr_init:t1,_tr_stored_block:s1,_tr_flush_block:i1,_tr_tally:n1,_tr_align:r1};const a1=(s,n,i,o)=>{let l=s&65535|0,h=s>>>16&65535|0,f=0;for(;i!==0;){f=i>2e3?2e3:i,i-=f;do l=l+n[o++]|0,h=h+l|0;while(--f);l%=65521,h%=65521}return l|h<<16|0};var Yl=a1;const l1=()=>{let s,n=[];for(var i=0;i<256;i++){s=i;for(var o=0;o<8;o++)s=s&1?3988292384^s>>>1:s>>>1;n[i]=s}return n},c1=new Uint32Array(l1()),u1=(s,n,i,o)=>{const l=c1,h=o+i;s^=-1;for(let f=o;f<h;f++)s=s>>>8^l[(s^n[f])&255];return s^-1};var $s=u1,uo={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ya={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:h1,_tr_stored_block:ff,_tr_flush_block:d1,_tr_tally:Sr,_tr_align:_1}=o1,{Z_NO_FLUSH:$r,Z_PARTIAL_FLUSH:p1,Z_FULL_FLUSH:g1,Z_FINISH:Mi,Z_BLOCK:OT,Z_OK:Os,Z_STREAM_END:wT,Z_STREAM_ERROR:$n,Z_DATA_ERROR:f1,Z_BUF_ERROR:tp,Z_DEFAULT_COMPRESSION:m1,Z_FILTERED:E1,Z_HUFFMAN_ONLY:Au,Z_RLE:b1,Z_FIXED:v1,Z_DEFAULT_STRATEGY:T1,Z_UNKNOWN:S1,Z_DEFLATED:lh}=ya,$1=9,y1=15,R1=8,I1=29,C1=256,mf=C1+1+I1,O1=30,w1=19,k1=2*mf+1,A1=15,Et=3,br=258,yn=br+Et+1,L1=32,_a=42,sm=57,Ef=69,bf=73,vf=91,Tf=103,ro=113,Dl=666,Vs=1,Ra=2,ho=3,Ia=4,N1=3,oo=(s,n)=>(s.msg=uo[n],n),kT=s=>s*2-(s>4?9:0),mr=s=>{let n=s.length;for(;--n>=0;)s[n]=0},M1=s=>{let n,i,o,l=s.w_size;n=s.hash_size,o=n;do i=s.head[--o],s.head[o]=i>=l?i-l:0;while(--n);n=l,o=n;do i=s.prev[--o],s.prev[o]=i>=l?i-l:0;while(--n)};let D1=(s,n,i)=>(n<<s.hash_shift^i)&s.hash_mask,yr=D1;const Si=s=>{const n=s.state;let i=n.pending;i>s.avail_out&&(i=s.avail_out),i!==0&&(s.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+i),s.next_out),s.next_out+=i,n.pending_out+=i,s.total_out+=i,s.avail_out-=i,n.pending-=i,n.pending===0&&(n.pending_out=0))},yi=(s,n)=>{d1(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,n),s.block_start=s.strstart,Si(s.strm)},Lt=(s,n)=>{s.pending_buf[s.pending++]=n},Al=(s,n)=>{s.pending_buf[s.pending++]=n>>>8&255,s.pending_buf[s.pending++]=n&255},Sf=(s,n,i,o)=>{let l=s.avail_in;return l>o&&(l=o),l===0?0:(s.avail_in-=l,n.set(s.input.subarray(s.next_in,s.next_in+l),i),s.state.wrap===1?s.adler=Yl(s.adler,n,l,i):s.state.wrap===2&&(s.adler=$s(s.adler,n,l,i)),s.next_in+=l,s.total_in+=l,l)},kR=(s,n)=>{let i=s.max_chain_length,o=s.strstart,l,h,f=s.prev_length,u=s.nice_match;const p=s.strstart>s.w_size-yn?s.strstart-(s.w_size-yn):0,c=s.window,_=s.w_mask,m=s.prev,E=s.strstart+br;let b=c[o+f-1],T=c[o+f];s.prev_length>=s.good_match&&(i>>=2),u>s.lookahead&&(u=s.lookahead);do if(l=n,!(c[l+f]!==T||c[l+f-1]!==b||c[l]!==c[o]||c[++l]!==c[o+1])){o+=2,l++;do;while(c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&o<E);if(h=br-(E-o),o=E-br,h>f){if(s.match_start=n,f=h,h>=u)break;b=c[o+f-1],T=c[o+f]}}while((n=m[n&_])>p&&--i!==0);return f<=s.lookahead?f:s.lookahead},pa=s=>{const n=s.w_size;let i,o,l;do{if(o=s.window_size-s.lookahead-s.strstart,s.strstart>=n+(n-yn)&&(s.window.set(s.window.subarray(n,n+n-o),0),s.match_start-=n,s.strstart-=n,s.block_start-=n,s.insert>s.strstart&&(s.insert=s.strstart),M1(s),o+=n),s.strm.avail_in===0)break;if(i=Sf(s.strm,s.window,s.strstart+s.lookahead,o),s.lookahead+=i,s.lookahead+s.insert>=Et)for(l=s.strstart-s.insert,s.ins_h=s.window[l],s.ins_h=yr(s,s.ins_h,s.window[l+1]);s.insert&&(s.ins_h=yr(s,s.ins_h,s.window[l+Et-1]),s.prev[l&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=l,l++,s.insert--,!(s.lookahead+s.insert<Et)););}while(s.lookahead<yn&&s.strm.avail_in!==0)},AR=(s,n)=>{let i=s.pending_buf_size-5>s.w_size?s.w_size:s.pending_buf_size-5,o,l,h,f=0,u=s.strm.avail_in;do{if(o=65535,h=s.bi_valid+42>>3,s.strm.avail_out<h||(h=s.strm.avail_out-h,l=s.strstart-s.block_start,o>l+s.strm.avail_in&&(o=l+s.strm.avail_in),o>h&&(o=h),o<i&&(o===0&&n!==Mi||n===$r||o!==l+s.strm.avail_in)))break;f=n===Mi&&o===l+s.strm.avail_in?1:0,ff(s,0,0,f),s.pending_buf[s.pending-4]=o,s.pending_buf[s.pending-3]=o>>8,s.pending_buf[s.pending-2]=~o,s.pending_buf[s.pending-1]=~o>>8,Si(s.strm),l&&(l>o&&(l=o),s.strm.output.set(s.window.subarray(s.block_start,s.block_start+l),s.strm.next_out),s.strm.next_out+=l,s.strm.avail_out-=l,s.strm.total_out+=l,s.block_start+=l,o-=l),o&&(Sf(s.strm,s.strm.output,s.strm.next_out,o),s.strm.next_out+=o,s.strm.avail_out-=o,s.strm.total_out+=o)}while(f===0);return u-=s.strm.avail_in,u&&(u>=s.w_size?(s.matches=2,s.window.set(s.strm.input.subarray(s.strm.next_in-s.w_size,s.strm.next_in),0),s.strstart=s.w_size,s.insert=s.strstart):(s.window_size-s.strstart<=u&&(s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,s.insert>s.strstart&&(s.insert=s.strstart)),s.window.set(s.strm.input.subarray(s.strm.next_in-u,s.strm.next_in),s.strstart),s.strstart+=u,s.insert+=u>s.w_size-s.insert?s.w_size-s.insert:u),s.block_start=s.strstart),s.high_water<s.strstart&&(s.high_water=s.strstart),f?Ia:n!==$r&&n!==Mi&&s.strm.avail_in===0&&s.strstart===s.block_start?Ra:(h=s.window_size-s.strstart,s.strm.avail_in>h&&s.block_start>=s.w_size&&(s.block_start-=s.w_size,s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,h+=s.w_size,s.insert>s.strstart&&(s.insert=s.strstart)),h>s.strm.avail_in&&(h=s.strm.avail_in),h&&(Sf(s.strm,s.window,s.strstart,h),s.strstart+=h,s.insert+=h>s.w_size-s.insert?s.w_size-s.insert:h),s.high_water<s.strstart&&(s.high_water=s.strstart),h=s.bi_valid+42>>3,h=s.pending_buf_size-h>65535?65535:s.pending_buf_size-h,i=h>s.w_size?s.w_size:h,l=s.strstart-s.block_start,(l>=i||(l||n===Mi)&&n!==$r&&s.strm.avail_in===0&&l<=h)&&(o=l>h?h:l,f=n===Mi&&s.strm.avail_in===0&&o===l?1:0,ff(s,s.block_start,o,f),s.block_start+=o,Si(s.strm)),f?ho:Vs)},sp=(s,n)=>{let i,o;for(;;){if(s.lookahead<yn){if(pa(s),s.lookahead<yn&&n===$r)return Vs;if(s.lookahead===0)break}if(i=0,s.lookahead>=Et&&(s.ins_h=yr(s,s.ins_h,s.window[s.strstart+Et-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),i!==0&&s.strstart-i<=s.w_size-yn&&(s.match_length=kR(s,i)),s.match_length>=Et)if(o=Sr(s,s.strstart-s.match_start,s.match_length-Et),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=Et){s.match_length--;do s.strstart++,s.ins_h=yr(s,s.ins_h,s.window[s.strstart+Et-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart;while(--s.match_length!==0);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=yr(s,s.ins_h,s.window[s.strstart+1]);else o=Sr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(o&&(yi(s,false),s.strm.avail_out===0))return Vs}return s.insert=s.strstart<Et-1?s.strstart:Et-1,n===Mi?(yi(s,true),s.strm.avail_out===0?ho:Ia):s.sym_next&&(yi(s,false),s.strm.avail_out===0)?Vs:Ra},ra=(s,n)=>{let i,o,l;for(;;){if(s.lookahead<yn){if(pa(s),s.lookahead<yn&&n===$r)return Vs;if(s.lookahead===0)break}if(i=0,s.lookahead>=Et&&(s.ins_h=yr(s,s.ins_h,s.window[s.strstart+Et-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=Et-1,i!==0&&s.prev_length<s.max_lazy_match&&s.strstart-i<=s.w_size-yn&&(s.match_length=kR(s,i),s.match_length<=5&&(s.strategy===E1||s.match_length===Et&&s.strstart-s.match_start>4096)&&(s.match_length=Et-1)),s.prev_length>=Et&&s.match_length<=s.prev_length){l=s.strstart+s.lookahead-Et,o=Sr(s,s.strstart-1-s.prev_match,s.prev_length-Et),s.lookahead-=s.prev_length-1,s.prev_length-=2;do++s.strstart<=l&&(s.ins_h=yr(s,s.ins_h,s.window[s.strstart+Et-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart);while(--s.prev_length!==0);if(s.match_available=0,s.match_length=Et-1,s.strstart++,o&&(yi(s,false),s.strm.avail_out===0))return Vs}else if(s.match_available){if(o=Sr(s,0,s.window[s.strstart-1]),o&&yi(s,false),s.strstart++,s.lookahead--,s.strm.avail_out===0)return Vs}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(o=Sr(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<Et-1?s.strstart:Et-1,n===Mi?(yi(s,true),s.strm.avail_out===0?ho:Ia):s.sym_next&&(yi(s,false),s.strm.avail_out===0)?Vs:Ra},x1=(s,n)=>{let i,o,l,h;const f=s.window;for(;;){if(s.lookahead<=br){if(pa(s),s.lookahead<=br&&n===$r)return Vs;if(s.lookahead===0)break}if(s.match_length=0,s.lookahead>=Et&&s.strstart>0&&(l=s.strstart-1,o=f[l],o===f[++l]&&o===f[++l]&&o===f[++l])){h=s.strstart+br;do;while(o===f[++l]&&o===f[++l]&&o===f[++l]&&o===f[++l]&&o===f[++l]&&o===f[++l]&&o===f[++l]&&o===f[++l]&&l<h);s.match_length=br-(h-l),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=Et?(i=Sr(s,1,s.match_length-Et),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(i=Sr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),i&&(yi(s,false),s.strm.avail_out===0))return Vs}return s.insert=0,n===Mi?(yi(s,true),s.strm.avail_out===0?ho:Ia):s.sym_next&&(yi(s,false),s.strm.avail_out===0)?Vs:Ra},B1=(s,n)=>{let i;for(;;){if(s.lookahead===0&&(pa(s),s.lookahead===0)){if(n===$r)return Vs;break}if(s.match_length=0,i=Sr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,i&&(yi(s,false),s.strm.avail_out===0))return Vs}return s.insert=0,n===Mi?(yi(s,true),s.strm.avail_out===0?ho:Ia):s.sym_next&&(yi(s,false),s.strm.avail_out===0)?Vs:Ra};function bn(s,n,i,o,l){this.good_length=s,this.max_lazy=n,this.nice_length=i,this.max_chain=o,this.func=l}const xl=[new bn(0,0,0,0,AR),new bn(4,4,8,4,sp),new bn(4,5,16,8,sp),new bn(4,6,32,32,sp),new bn(4,4,16,16,ra),new bn(8,16,32,32,ra),new bn(8,16,128,128,ra),new bn(8,32,128,256,ra),new bn(32,128,258,1024,ra),new bn(32,258,258,4096,ra)],P1=s=>{s.window_size=2*s.w_size,mr(s.head),s.max_lazy_match=xl[s.level].max_lazy,s.good_match=xl[s.level].good_length,s.nice_match=xl[s.level].nice_length,s.max_chain_length=xl[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=Et-1,s.match_available=0,s.ins_h=0};function U1(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=lh,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(k1*2),this.dyn_dtree=new Uint16Array((2*O1+1)*2),this.bl_tree=new Uint16Array((2*w1+1)*2),mr(this.dyn_ltree),mr(this.dyn_dtree),mr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(A1+1),this.heap=new Uint16Array(2*mf+1),mr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*mf+1),mr(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const uc=s=>{if(!s)return 1;const n=s.state;return!n||n.strm!==s||n.status!==_a&&n.status!==sm&&n.status!==Ef&&n.status!==bf&&n.status!==vf&&n.status!==Tf&&n.status!==ro&&n.status!==Dl?1:0},LR=s=>{if(uc(s))return oo(s,$n);s.total_in=s.total_out=0,s.data_type=S1;const n=s.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?sm:n.wrap?_a:ro,s.adler=n.wrap===2?0:1,n.last_flush=-2,h1(n),Os},NR=s=>{const n=LR(s);return n===Os&&P1(s.state),n},F1=(s,n)=>uc(s)||s.state.wrap!==2?$n:(s.state.gzhead=n,Os),MR=(s,n,i,o,l,h)=>{if(!s)return $n;let f=1;if(n===m1&&(n=6),o<0?(f=0,o=-o):o>15&&(f=2,o-=16),l<1||l>$1||i!==lh||o<8||o>15||n<0||n>9||h<0||h>v1||o===8&&f!==1)return oo(s,$n);o===8&&(o=9);const u=new U1;return s.state=u,u.strm=s,u.status=_a,u.wrap=f,u.gzhead=null,u.w_bits=o,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=l+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+Et-1)/Et),u.window=new Uint8Array(u.w_size*2),u.head=new Uint16Array(u.hash_size),u.prev=new Uint16Array(u.w_size),u.lit_bufsize=1<<l+6,u.pending_buf_size=u.lit_bufsize*4,u.pending_buf=new Uint8Array(u.pending_buf_size),u.sym_buf=u.lit_bufsize,u.sym_end=(u.lit_bufsize-1)*3,u.level=n,u.strategy=h,u.method=i,NR(s)},G1=(s,n)=>MR(s,n,lh,y1,R1,T1),H1=(s,n)=>{if(uc(s)||n>OT||n<0)return s?oo(s,$n):$n;const i=s.state;if(!s.output||s.avail_in!==0&&!s.input||i.status===Dl&&n!==Mi)return oo(s,s.avail_out===0?tp:$n);const o=i.last_flush;if(i.last_flush=n,i.pending!==0){if(Si(s),s.avail_out===0)return i.last_flush=-1,Os}else if(s.avail_in===0&&kT(n)<=kT(o)&&n!==Mi)return oo(s,tp);if(i.status===Dl&&s.avail_in!==0)return oo(s,tp);if(i.status===_a&&i.wrap===0&&(i.status=ro),i.status===_a){let l=lh+(i.w_bits-8<<4)<<8,h=-1;if(i.strategy>=Au||i.level<2?h=0:i.level<6?h=1:i.level===6?h=2:h=3,l|=h<<6,i.strstart!==0&&(l|=L1),l+=31-l%31,Al(i,l),i.strstart!==0&&(Al(i,s.adler>>>16),Al(i,s.adler&65535)),s.adler=1,i.status=ro,Si(s),i.pending!==0)return i.last_flush=-1,Os}if(i.status===sm){if(s.adler=0,Lt(i,31),Lt(i,139),Lt(i,8),i.gzhead)Lt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Lt(i,i.gzhead.time&255),Lt(i,i.gzhead.time>>8&255),Lt(i,i.gzhead.time>>16&255),Lt(i,i.gzhead.time>>24&255),Lt(i,i.level===9?2:i.strategy>=Au||i.level<2?4:0),Lt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Lt(i,i.gzhead.extra.length&255),Lt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(s.adler=$s(s.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Ef;else if(Lt(i,0),Lt(i,0),Lt(i,0),Lt(i,0),Lt(i,0),Lt(i,i.level===9?2:i.strategy>=Au||i.level<2?4:0),Lt(i,N1),i.status=ro,Si(s),i.pending!==0)return i.last_flush=-1,Os}if(i.status===Ef){if(i.gzhead.extra){let l=i.pending,h=(i.gzhead.extra.length&65535)-i.gzindex;for(;i.pending+h>i.pending_buf_size;){let u=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+u),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>l&&(s.adler=$s(s.adler,i.pending_buf,i.pending-l,l)),i.gzindex+=u,Si(s),i.pending!==0)return i.last_flush=-1,Os;l=0,h-=u}let f=new Uint8Array(i.gzhead.extra);i.pending_buf.set(f.subarray(i.gzindex,i.gzindex+h),i.pending),i.pending+=h,i.gzhead.hcrc&&i.pending>l&&(s.adler=$s(s.adler,i.pending_buf,i.pending-l,l)),i.gzindex=0}i.status=bf}if(i.status===bf){if(i.gzhead.name){let l=i.pending,h;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>l&&(s.adler=$s(s.adler,i.pending_buf,i.pending-l,l)),Si(s),i.pending!==0)return i.last_flush=-1,Os;l=0}i.gzindex<i.gzhead.name.length?h=i.gzhead.name.charCodeAt(i.gzindex++)&255:h=0,Lt(i,h)}while(h!==0);i.gzhead.hcrc&&i.pending>l&&(s.adler=$s(s.adler,i.pending_buf,i.pending-l,l)),i.gzindex=0}i.status=vf}if(i.status===vf){if(i.gzhead.comment){let l=i.pending,h;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>l&&(s.adler=$s(s.adler,i.pending_buf,i.pending-l,l)),Si(s),i.pending!==0)return i.last_flush=-1,Os;l=0}i.gzindex<i.gzhead.comment.length?h=i.gzhead.comment.charCodeAt(i.gzindex++)&255:h=0,Lt(i,h)}while(h!==0);i.gzhead.hcrc&&i.pending>l&&(s.adler=$s(s.adler,i.pending_buf,i.pending-l,l))}i.status=Tf}if(i.status===Tf){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Si(s),i.pending!==0))return i.last_flush=-1,Os;Lt(i,s.adler&255),Lt(i,s.adler>>8&255),s.adler=0}if(i.status=ro,Si(s),i.pending!==0)return i.last_flush=-1,Os}if(s.avail_in!==0||i.lookahead!==0||n!==$r&&i.status!==Dl){let l=i.level===0?AR(i,n):i.strategy===Au?B1(i,n):i.strategy===b1?x1(i,n):xl[i.level].func(i,n);if((l===ho||l===Ia)&&(i.status=Dl),l===Vs||l===ho)return s.avail_out===0&&(i.last_flush=-1),Os;if(l===Ra&&(n===p1?_1(i):n!==OT&&(ff(i,0,0,false),n===g1&&(mr(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Si(s),s.avail_out===0))return i.last_flush=-1,Os}return n!==Mi?Os:i.wrap<=0?wT:(i.wrap===2?(Lt(i,s.adler&255),Lt(i,s.adler>>8&255),Lt(i,s.adler>>16&255),Lt(i,s.adler>>24&255),Lt(i,s.total_in&255),Lt(i,s.total_in>>8&255),Lt(i,s.total_in>>16&255),Lt(i,s.total_in>>24&255)):(Al(i,s.adler>>>16),Al(i,s.adler&65535)),Si(s),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Os:wT)},V1=s=>{if(uc(s))return $n;const n=s.state.status;return s.state=null,n===ro?oo(s,f1):Os},W1=(s,n)=>{let i=n.length;if(uc(s))return $n;const o=s.state,l=o.wrap;if(l===2||l===1&&o.status!==_a||o.lookahead)return $n;if(l===1&&(s.adler=Yl(s.adler,n,i,0)),o.wrap=0,i>=o.w_size){l===0&&(mr(o.head),o.strstart=0,o.block_start=0,o.insert=0);let p=new Uint8Array(o.w_size);p.set(n.subarray(i-o.w_size,i),0),n=p,i=o.w_size}const h=s.avail_in,f=s.next_in,u=s.input;for(s.avail_in=i,s.next_in=0,s.input=n,pa(o);o.lookahead>=Et;){let p=o.strstart,c=o.lookahead-(Et-1);do o.ins_h=yr(o,o.ins_h,o.window[p+Et-1]),o.prev[p&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=p,p++;while(--c);o.strstart=p,o.lookahead=Et-1,pa(o)}return o.strstart+=o.lookahead,o.block_start=o.strstart,o.insert=o.lookahead,o.lookahead=0,o.match_length=o.prev_length=Et-1,o.match_available=0,s.next_in=f,s.input=u,s.avail_in=h,o.wrap=l,Os};var z1=G1,j1=MR,X1=NR,K1=LR,Y1=F1,q1=H1,J1=V1,Z1=W1,Q1="pako deflate (from Nodeca project)",Fl={deflateInit:z1,deflateInit2:j1,deflateReset:X1,deflateResetKeep:K1,deflateSetHeader:Y1,deflate:q1,deflateEnd:J1,deflateSetDictionary:Z1,deflateInfo:Q1};const eD=(s,n)=>Object.prototype.hasOwnProperty.call(s,n);var tD=function(s){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const i=n.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(const o in i)eD(i,o)&&(s[o]=i[o])}}return s},sD=s=>{let n=0;for(let o=0,l=s.length;o<l;o++)n+=s[o].length;const i=new Uint8Array(n);for(let o=0,l=0,h=s.length;o<h;o++){let f=s[o];i.set(f,l),l+=f.length}return i},ch={assign:tD,flattenChunks:sD};let DR=true;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{DR=false}const ql=new Uint8Array(256);for(let s=0;s<256;s++)ql[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;ql[254]=ql[254]=1;var iD=s=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(s);let n,i,o,l,h,f=s.length,u=0;for(l=0;l<f;l++)i=s.charCodeAt(l),(i&64512)===55296&&l+1<f&&(o=s.charCodeAt(l+1),(o&64512)===56320&&(i=65536+(i-55296<<10)+(o-56320),l++)),u+=i<128?1:i<2048?2:i<65536?3:4;for(n=new Uint8Array(u),h=0,l=0;h<u;l++)i=s.charCodeAt(l),(i&64512)===55296&&l+1<f&&(o=s.charCodeAt(l+1),(o&64512)===56320&&(i=65536+(i-55296<<10)+(o-56320),l++)),i<128?n[h++]=i:i<2048?(n[h++]=192|i>>>6,n[h++]=128|i&63):i<65536?(n[h++]=224|i>>>12,n[h++]=128|i>>>6&63,n[h++]=128|i&63):(n[h++]=240|i>>>18,n[h++]=128|i>>>12&63,n[h++]=128|i>>>6&63,n[h++]=128|i&63);return n};const nD=(s,n)=>{if(n<65534&&s.subarray&&DR)return String.fromCharCode.apply(null,s.length===n?s:s.subarray(0,n));let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(s[o]);return i};var rD=(s,n)=>{const i=n||s.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(s.subarray(0,n));let o,l;const h=new Array(i*2);for(l=0,o=0;o<i;){let f=s[o++];if(f<128){h[l++]=f;continue}let u=ql[f];if(u>4){h[l++]=65533,o+=u-1;continue}for(f&=u===2?31:u===3?15:7;u>1&&o<i;)f=f<<6|s[o++]&63,u--;if(u>1){h[l++]=65533;continue}f<65536?h[l++]=f:(f-=65536,h[l++]=55296|f>>10&1023,h[l++]=56320|f&1023)}return nD(h,l)},oD=(s,n)=>{n=n||s.length,n>s.length&&(n=s.length);let i=n-1;for(;i>=0&&(s[i]&192)===128;)i--;return i<0||i===0?n:i+ql[s[i]]>n?i:n},Jl={string2buf:iD,buf2string:rD,utf8border:oD};function aD(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var xR=aD;const BR=Object.prototype.toString,{Z_NO_FLUSH:lD,Z_SYNC_FLUSH:cD,Z_FULL_FLUSH:uD,Z_FINISH:hD,Z_OK:Zu,Z_STREAM_END:dD,Z_DEFAULT_COMPRESSION:_D,Z_DEFAULT_STRATEGY:pD,Z_DEFLATED:gD}=ya;function hc(s){this.options=ch.assign({level:_D,method:gD,chunkSize:16384,windowBits:15,memLevel:8,strategy:pD},s||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=false,this.chunks=[],this.strm=new xR,this.strm.avail_out=0;let i=Fl.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(i!==Zu)throw new Error(uo[i]);if(n.header&&Fl.deflateSetHeader(this.strm,n.header),n.dictionary){let o;if(typeof n.dictionary=="string"?o=Jl.string2buf(n.dictionary):BR.call(n.dictionary)==="[object ArrayBuffer]"?o=new Uint8Array(n.dictionary):o=n.dictionary,i=Fl.deflateSetDictionary(this.strm,o),i!==Zu)throw new Error(uo[i]);this._dict_set=true}}hc.prototype.push=function(s,n){const i=this.strm,o=this.options.chunkSize;let l,h;if(this.ended)return false;for(n===~~n?h=n:h=n===true?hD:lD,typeof s=="string"?i.input=Jl.string2buf(s):BR.call(s)==="[object ArrayBuffer]"?i.input=new Uint8Array(s):i.input=s,i.next_in=0,i.avail_in=i.input.length;;){if(i.avail_out===0&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(h===cD||h===uD)&&i.avail_out<=6){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(l=Fl.deflate(i,h),l===dD)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),l=Fl.deflateEnd(this.strm),this.onEnd(l),this.ended=true,l===Zu;if(i.avail_out===0){this.onData(i.output);continue}if(h>0&&i.next_out>0){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(i.avail_in===0)break}return true};hc.prototype.onData=function(s){this.chunks.push(s)};hc.prototype.onEnd=function(s){s===Zu&&(this.result=ch.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};function im(s,n){const i=new hc(n);if(i.push(s,true),i.err)throw i.msg||uo[i.err];return i.result}function fD(s,n){return n=n||{},n.raw=true,im(s,n)}function mD(s,n){return n=n||{},n.gzip=true,im(s,n)}var ED=hc,bD=im,vD=fD,TD=mD,SD=ya,$D={Deflate:ED,deflate:bD,deflateRaw:vD,gzip:TD,constants:SD};const Lu=16209,yD=16191;var RD=function(n,i){let o,l,h,f,u,p,c,_,m,E,b,T,y,g,$,R,v,S,O,w,A,I,L,x;const B=n.state;o=n.next_in,L=n.input,l=o+(n.avail_in-5),h=n.next_out,x=n.output,f=h-(i-n.avail_out),u=h+(n.avail_out-257),p=B.dmax,c=B.wsize,_=B.whave,m=B.wnext,E=B.window,b=B.hold,T=B.bits,y=B.lencode,g=B.distcode,$=(1<<B.lenbits)-1,R=(1<<B.distbits)-1;e:do{T<15&&(b+=L[o++]<<T,T+=8,b+=L[o++]<<T,T+=8),v=y[b&$];t:for(;;){if(S=v>>>24,b>>>=S,T-=S,S=v>>>16&255,S===0)x[h++]=v&65535;else if(S&16){O=v&65535,S&=15,S&&(T<S&&(b+=L[o++]<<T,T+=8),O+=b&(1<<S)-1,b>>>=S,T-=S),T<15&&(b+=L[o++]<<T,T+=8,b+=L[o++]<<T,T+=8),v=g[b&R];s:for(;;){if(S=v>>>24,b>>>=S,T-=S,S=v>>>16&255,S&16){if(w=v&65535,S&=15,T<S&&(b+=L[o++]<<T,T+=8,T<S&&(b+=L[o++]<<T,T+=8)),w+=b&(1<<S)-1,w>p){n.msg="invalid distance too far back",B.mode=Lu;break e}if(b>>>=S,T-=S,S=h-f,w>S){if(S=w-S,S>_&&B.sane){n.msg="invalid distance too far back",B.mode=Lu;break e}if(A=0,I=E,m===0){if(A+=c-S,S<O){O-=S;do x[h++]=E[A++];while(--S);A=h-w,I=x}}else if(m<S){if(A+=c+m-S,S-=m,S<O){O-=S;do x[h++]=E[A++];while(--S);if(A=0,m<O){S=m,O-=S;do x[h++]=E[A++];while(--S);A=h-w,I=x}}}else if(A+=m-S,S<O){O-=S;do x[h++]=E[A++];while(--S);A=h-w,I=x}for(;O>2;)x[h++]=I[A++],x[h++]=I[A++],x[h++]=I[A++],O-=3;O&&(x[h++]=I[A++],O>1&&(x[h++]=I[A++]))}else{A=h-w;do x[h++]=x[A++],x[h++]=x[A++],x[h++]=x[A++],O-=3;while(O>2);O&&(x[h++]=x[A++],O>1&&(x[h++]=x[A++]))}}else if(S&64){n.msg="invalid distance code",B.mode=Lu;break e}else{v=g[(v&65535)+(b&(1<<S)-1)];continue s}break}}else if(S&64)if(S&32){B.mode=yD;break e}else{n.msg="invalid literal/length code",B.mode=Lu;break e}else{v=y[(v&65535)+(b&(1<<S)-1)];continue t}break}}while(o<l&&h<u);O=T>>3,o-=O,T-=O<<3,b&=(1<<T)-1,n.next_in=o,n.next_out=h,n.avail_in=o<l?5+(l-o):5-(o-l),n.avail_out=h<u?257+(u-h):257-(h-u),B.hold=b,B.bits=T};const oa=15,AT=852,LT=592,NT=0,ip=1,MT=2,ID=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),CD=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),OD=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),wD=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),kD=(s,n,i,o,l,h,f,u)=>{const p=u.bits;let c=0,_=0,m=0,E=0,b=0,T=0,y=0,g=0,$=0,R=0,v,S,O,w,A,I=null,L;const x=new Uint16Array(oa+1),B=new Uint16Array(oa+1);let H=null,F,X,Z;for(c=0;c<=oa;c++)x[c]=0;for(_=0;_<o;_++)x[n[i+_]]++;for(b=p,E=oa;E>=1&&x[E]===0;E--);if(b>E&&(b=E),E===0)return l[h++]=1<<24|64<<16|0,l[h++]=1<<24|64<<16|0,u.bits=1,0;for(m=1;m<E&&x[m]===0;m++);for(b<m&&(b=m),g=1,c=1;c<=oa;c++)if(g<<=1,g-=x[c],g<0)return-1;if(g>0&&(s===NT||E!==1))return-1;for(B[1]=0,c=1;c<oa;c++)B[c+1]=B[c]+x[c];for(_=0;_<o;_++)n[i+_]!==0&&(f[B[n[i+_]]++]=_);if(s===NT?(I=H=f,L=20):s===ip?(I=ID,H=CD,L=257):(I=OD,H=wD,L=0),R=0,_=0,c=m,A=h,T=b,y=0,O=-1,$=1<<b,w=$-1,s===ip&&$>AT||s===MT&&$>LT)return 1;for(;;){F=c-y,f[_]+1<L?(X=0,Z=f[_]):f[_]>=L?(X=H[f[_]-L],Z=I[f[_]-L]):(X=32+64,Z=0),v=1<<c-y,S=1<<T,m=S;do S-=v,l[A+(R>>y)+S]=F<<24|X<<16|Z|0;while(S!==0);for(v=1<<c-1;R&v;)v>>=1;if(v!==0?(R&=v-1,R+=v):R=0,_++,--x[c]===0){if(c===E)break;c=n[i+f[_]]}if(c>b&&(R&w)!==O){for(y===0&&(y=b),A+=m,T=c-y,g=1<<T;T+y<E&&(g-=x[T+y],!(g<=0));)T++,g<<=1;if($+=1<<T,s===ip&&$>AT||s===MT&&$>LT)return 1;O=R&w,l[O]=b<<24|T<<16|A-h|0}}return R!==0&&(l[A+R]=c-y<<24|64<<16|0),u.bits=b,0};var Gl=kD;const AD=0,PR=1,UR=2,{Z_FINISH:DT,Z_BLOCK:LD,Z_TREES:Nu,Z_OK:_o,Z_STREAM_END:ND,Z_NEED_DICT:MD,Z_STREAM_ERROR:xi,Z_DATA_ERROR:FR,Z_MEM_ERROR:GR,Z_BUF_ERROR:DD,Z_DEFLATED:xT}=ya,uh=16180,BT=16181,PT=16182,UT=16183,FT=16184,GT=16185,HT=16186,VT=16187,WT=16188,zT=16189,Qu=16190,zn=16191,np=16192,jT=16193,rp=16194,XT=16195,KT=16196,YT=16197,qT=16198,Mu=16199,Du=16200,JT=16201,ZT=16202,QT=16203,eS=16204,tS=16205,op=16206,sS=16207,iS=16208,Xt=16209,HR=16210,VR=16211,xD=852,BD=592,PD=15,UD=PD,nS=s=>(s>>>24&255)+(s>>>8&65280)+((s&65280)<<8)+((s&255)<<24);function FD(){this.strm=null,this.mode=0,this.last=false,this.wrap=0,this.havedict=false,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const fo=s=>{if(!s)return 1;const n=s.state;return!n||n.strm!==s||n.mode<uh||n.mode>VR?1:0},WR=s=>{if(fo(s))return xi;const n=s.state;return s.total_in=s.total_out=n.total=0,s.msg="",n.wrap&&(s.adler=n.wrap&1),n.mode=uh,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(xD),n.distcode=n.distdyn=new Int32Array(BD),n.sane=1,n.back=-1,_o},zR=s=>{if(fo(s))return xi;const n=s.state;return n.wsize=0,n.whave=0,n.wnext=0,WR(s)},jR=(s,n)=>{let i;if(fo(s))return xi;const o=s.state;return n<0?(i=0,n=-n):(i=(n>>4)+5,n<48&&(n&=15)),n&&(n<8||n>15)?xi:(o.window!==null&&o.wbits!==n&&(o.window=null),o.wrap=i,o.wbits=n,zR(s))},XR=(s,n)=>{if(!s)return xi;const i=new FD;s.state=i,i.strm=s,i.window=null,i.mode=uh;const o=jR(s,n);return o!==_o&&(s.state=null),o},GD=s=>XR(s,UD);let rS=true,ap,lp;const HD=s=>{if(rS){ap=new Int32Array(512),lp=new Int32Array(32);let n=0;for(;n<144;)s.lens[n++]=8;for(;n<256;)s.lens[n++]=9;for(;n<280;)s.lens[n++]=7;for(;n<288;)s.lens[n++]=8;for(Gl(PR,s.lens,0,288,ap,0,s.work,{bits:9}),n=0;n<32;)s.lens[n++]=5;Gl(UR,s.lens,0,32,lp,0,s.work,{bits:5}),rS=false}s.lencode=ap,s.lenbits=9,s.distcode=lp,s.distbits=5},KR=(s,n,i,o)=>{let l;const h=s.state;return h.window===null&&(h.wsize=1<<h.wbits,h.wnext=0,h.whave=0,h.window=new Uint8Array(h.wsize)),o>=h.wsize?(h.window.set(n.subarray(i-h.wsize,i),0),h.wnext=0,h.whave=h.wsize):(l=h.wsize-h.wnext,l>o&&(l=o),h.window.set(n.subarray(i-o,i-o+l),h.wnext),o-=l,o?(h.window.set(n.subarray(i-o,i),0),h.wnext=o,h.whave=h.wsize):(h.wnext+=l,h.wnext===h.wsize&&(h.wnext=0),h.whave<h.wsize&&(h.whave+=l))),0},VD=(s,n)=>{let i,o,l,h,f,u,p,c,_,m,E,b,T,y,g=0,$,R,v,S,O,w,A,I;const L=new Uint8Array(4);let x,B;const H=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(fo(s)||!s.output||!s.input&&s.avail_in!==0)return xi;i=s.state,i.mode===zn&&(i.mode=np),f=s.next_out,l=s.output,p=s.avail_out,h=s.next_in,o=s.input,u=s.avail_in,c=i.hold,_=i.bits,m=u,E=p,I=_o;e:for(;;)switch(i.mode){case uh:if(i.wrap===0){i.mode=np;break}for(;_<16;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if(i.wrap&2&&c===35615){i.wbits===0&&(i.wbits=15),i.check=0,L[0]=c&255,L[1]=c>>>8&255,i.check=$s(i.check,L,2,0),c=0,_=0,i.mode=BT;break}if(i.head&&(i.head.done=false),!(i.wrap&1)||(((c&255)<<8)+(c>>8))%31){s.msg="incorrect header check",i.mode=Xt;break}if((c&15)!==xT){s.msg="unknown compression method",i.mode=Xt;break}if(c>>>=4,_-=4,A=(c&15)+8,i.wbits===0&&(i.wbits=A),A>15||A>i.wbits){s.msg="invalid window size",i.mode=Xt;break}i.dmax=1<<i.wbits,i.flags=0,s.adler=i.check=1,i.mode=c&512?zT:zn,c=0,_=0;break;case BT:for(;_<16;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if(i.flags=c,(i.flags&255)!==xT){s.msg="unknown compression method",i.mode=Xt;break}if(i.flags&57344){s.msg="unknown header flags set",i.mode=Xt;break}i.head&&(i.head.text=c>>8&1),i.flags&512&&i.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,i.check=$s(i.check,L,2,0)),c=0,_=0,i.mode=PT;case PT:for(;_<32;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}i.head&&(i.head.time=c),i.flags&512&&i.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,L[2]=c>>>16&255,L[3]=c>>>24&255,i.check=$s(i.check,L,4,0)),c=0,_=0,i.mode=UT;case UT:for(;_<16;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}i.head&&(i.head.xflags=c&255,i.head.os=c>>8),i.flags&512&&i.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,i.check=$s(i.check,L,2,0)),c=0,_=0,i.mode=FT;case FT:if(i.flags&1024){for(;_<16;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}i.length=c,i.head&&(i.head.extra_len=c),i.flags&512&&i.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,i.check=$s(i.check,L,2,0)),c=0,_=0}else i.head&&(i.head.extra=null);i.mode=GT;case GT:if(i.flags&1024&&(b=i.length,b>u&&(b=u),b&&(i.head&&(A=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(o.subarray(h,h+b),A)),i.flags&512&&i.wrap&4&&(i.check=$s(i.check,o,b,h)),u-=b,h+=b,i.length-=b),i.length))break e;i.length=0,i.mode=HT;case HT:if(i.flags&2048){if(u===0)break e;b=0;do A=o[h+b++],i.head&&A&&i.length<65536&&(i.head.name+=String.fromCharCode(A));while(A&&b<u);if(i.flags&512&&i.wrap&4&&(i.check=$s(i.check,o,b,h)),u-=b,h+=b,A)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=VT;case VT:if(i.flags&4096){if(u===0)break e;b=0;do A=o[h+b++],i.head&&A&&i.length<65536&&(i.head.comment+=String.fromCharCode(A));while(A&&b<u);if(i.flags&512&&i.wrap&4&&(i.check=$s(i.check,o,b,h)),u-=b,h+=b,A)break e}else i.head&&(i.head.comment=null);i.mode=WT;case WT:if(i.flags&512){for(;_<16;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if(i.wrap&4&&c!==(i.check&65535)){s.msg="header crc mismatch",i.mode=Xt;break}c=0,_=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=true),s.adler=i.check=0,i.mode=zn;break;case zT:for(;_<32;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}s.adler=i.check=nS(c),c=0,_=0,i.mode=Qu;case Qu:if(i.havedict===0)return s.next_out=f,s.avail_out=p,s.next_in=h,s.avail_in=u,i.hold=c,i.bits=_,MD;s.adler=i.check=1,i.mode=zn;case zn:if(n===LD||n===Nu)break e;case np:if(i.last){c>>>=_&7,_-=_&7,i.mode=op;break}for(;_<3;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}switch(i.last=c&1,c>>>=1,_-=1,c&3){case 0:i.mode=jT;break;case 1:if(HD(i),i.mode=Mu,n===Nu){c>>>=2,_-=2;break e}break;case 2:i.mode=KT;break;case 3:s.msg="invalid block type",i.mode=Xt}c>>>=2,_-=2;break;case jT:for(c>>>=_&7,_-=_&7;_<32;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if((c&65535)!==(c>>>16^65535)){s.msg="invalid stored block lengths",i.mode=Xt;break}if(i.length=c&65535,c=0,_=0,i.mode=rp,n===Nu)break e;case rp:i.mode=XT;case XT:if(b=i.length,b){if(b>u&&(b=u),b>p&&(b=p),b===0)break e;l.set(o.subarray(h,h+b),f),u-=b,h+=b,p-=b,f+=b,i.length-=b;break}i.mode=zn;break;case KT:for(;_<14;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if(i.nlen=(c&31)+257,c>>>=5,_-=5,i.ndist=(c&31)+1,c>>>=5,_-=5,i.ncode=(c&15)+4,c>>>=4,_-=4,i.nlen>286||i.ndist>30){s.msg="too many length or distance symbols",i.mode=Xt;break}i.have=0,i.mode=YT;case YT:for(;i.have<i.ncode;){for(;_<3;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}i.lens[H[i.have++]]=c&7,c>>>=3,_-=3}for(;i.have<19;)i.lens[H[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,x={bits:i.lenbits},I=Gl(AD,i.lens,0,19,i.lencode,0,i.work,x),i.lenbits=x.bits,I){s.msg="invalid code lengths set",i.mode=Xt;break}i.have=0,i.mode=qT;case qT:for(;i.have<i.nlen+i.ndist;){for(;g=i.lencode[c&(1<<i.lenbits)-1],$=g>>>24,R=g>>>16&255,v=g&65535,!($<=_);){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if(v<16)c>>>=$,_-=$,i.lens[i.have++]=v;else{if(v===16){for(B=$+2;_<B;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if(c>>>=$,_-=$,i.have===0){s.msg="invalid bit length repeat",i.mode=Xt;break}A=i.lens[i.have-1],b=3+(c&3),c>>>=2,_-=2}else if(v===17){for(B=$+3;_<B;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}c>>>=$,_-=$,A=0,b=3+(c&7),c>>>=3,_-=3}else{for(B=$+7;_<B;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}c>>>=$,_-=$,A=0,b=11+(c&127),c>>>=7,_-=7}if(i.have+b>i.nlen+i.ndist){s.msg="invalid bit length repeat",i.mode=Xt;break}for(;b--;)i.lens[i.have++]=A}}if(i.mode===Xt)break;if(i.lens[256]===0){s.msg="invalid code -- missing end-of-block",i.mode=Xt;break}if(i.lenbits=9,x={bits:i.lenbits},I=Gl(PR,i.lens,0,i.nlen,i.lencode,0,i.work,x),i.lenbits=x.bits,I){s.msg="invalid literal/lengths set",i.mode=Xt;break}if(i.distbits=6,i.distcode=i.distdyn,x={bits:i.distbits},I=Gl(UR,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,x),i.distbits=x.bits,I){s.msg="invalid distances set",i.mode=Xt;break}if(i.mode=Mu,n===Nu)break e;case Mu:i.mode=Du;case Du:if(u>=6&&p>=258){s.next_out=f,s.avail_out=p,s.next_in=h,s.avail_in=u,i.hold=c,i.bits=_,RD(s,E),f=s.next_out,l=s.output,p=s.avail_out,h=s.next_in,o=s.input,u=s.avail_in,c=i.hold,_=i.bits,i.mode===zn&&(i.back=-1);break}for(i.back=0;g=i.lencode[c&(1<<i.lenbits)-1],$=g>>>24,R=g>>>16&255,v=g&65535,!($<=_);){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if(R&&!(R&240)){for(S=$,O=R,w=v;g=i.lencode[w+((c&(1<<S+O)-1)>>S)],$=g>>>24,R=g>>>16&255,v=g&65535,!(S+$<=_);){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}c>>>=S,_-=S,i.back+=S}if(c>>>=$,_-=$,i.back+=$,i.length=v,R===0){i.mode=tS;break}if(R&32){i.back=-1,i.mode=zn;break}if(R&64){s.msg="invalid literal/length code",i.mode=Xt;break}i.extra=R&15,i.mode=JT;case JT:if(i.extra){for(B=i.extra;_<B;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}i.length+=c&(1<<i.extra)-1,c>>>=i.extra,_-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=ZT;case ZT:for(;g=i.distcode[c&(1<<i.distbits)-1],$=g>>>24,R=g>>>16&255,v=g&65535,!($<=_);){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if(!(R&240)){for(S=$,O=R,w=v;g=i.distcode[w+((c&(1<<S+O)-1)>>S)],$=g>>>24,R=g>>>16&255,v=g&65535,!(S+$<=_);){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}c>>>=S,_-=S,i.back+=S}if(c>>>=$,_-=$,i.back+=$,R&64){s.msg="invalid distance code",i.mode=Xt;break}i.offset=v,i.extra=R&15,i.mode=QT;case QT:if(i.extra){for(B=i.extra;_<B;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}i.offset+=c&(1<<i.extra)-1,c>>>=i.extra,_-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){s.msg="invalid distance too far back",i.mode=Xt;break}i.mode=eS;case eS:if(p===0)break e;if(b=E-p,i.offset>b){if(b=i.offset-b,b>i.whave&&i.sane){s.msg="invalid distance too far back",i.mode=Xt;break}b>i.wnext?(b-=i.wnext,T=i.wsize-b):T=i.wnext-b,b>i.length&&(b=i.length),y=i.window}else y=l,T=f-i.offset,b=i.length;b>p&&(b=p),p-=b,i.length-=b;do l[f++]=y[T++];while(--b);i.length===0&&(i.mode=Du);break;case tS:if(p===0)break e;l[f++]=i.length,p--,i.mode=Du;break;case op:if(i.wrap){for(;_<32;){if(u===0)break e;u--,c|=o[h++]<<_,_+=8}if(E-=p,s.total_out+=E,i.total+=E,i.wrap&4&&E&&(s.adler=i.check=i.flags?$s(i.check,l,E,f-E):Yl(i.check,l,E,f-E)),E=p,i.wrap&4&&(i.flags?c:nS(c))!==i.check){s.msg="incorrect data check",i.mode=Xt;break}c=0,_=0}i.mode=sS;case sS:if(i.wrap&&i.flags){for(;_<32;){if(u===0)break e;u--,c+=o[h++]<<_,_+=8}if(i.wrap&4&&c!==(i.total&4294967295)){s.msg="incorrect length check",i.mode=Xt;break}c=0,_=0}i.mode=iS;case iS:I=ND;break e;case Xt:I=FR;break e;case HR:return GR;case VR:default:return xi}return s.next_out=f,s.avail_out=p,s.next_in=h,s.avail_in=u,i.hold=c,i.bits=_,(i.wsize||E!==s.avail_out&&i.mode<Xt&&(i.mode<op||n!==DT))&&KR(s,s.output,s.next_out,E-s.avail_out),m-=s.avail_in,E-=s.avail_out,s.total_in+=m,s.total_out+=E,i.total+=E,i.wrap&4&&E&&(s.adler=i.check=i.flags?$s(i.check,l,E,s.next_out-E):Yl(i.check,l,E,s.next_out-E)),s.data_type=i.bits+(i.last?64:0)+(i.mode===zn?128:0)+(i.mode===Mu||i.mode===rp?256:0),(m===0&&E===0||n===DT)&&I===_o&&(I=DD),I},WD=s=>{if(fo(s))return xi;let n=s.state;return n.window&&(n.window=null),s.state=null,_o},zD=(s,n)=>{if(fo(s))return xi;const i=s.state;return i.wrap&2?(i.head=n,n.done=false,_o):xi},jD=(s,n)=>{const i=n.length;let o,l,h;return fo(s)||(o=s.state,o.wrap!==0&&o.mode!==Qu)?xi:o.mode===Qu&&(l=1,l=Yl(l,n,i,0),l!==o.check)?FR:(h=KR(s,n,i,i),h?(o.mode=HR,GR):(o.havedict=1,_o))};var XD=zR,KD=jR,YD=WR,qD=GD,JD=XR,ZD=VD,QD=WD,ex=zD,tx=jD,sx="pako inflate (from Nodeca project)",Xn={inflateReset:XD,inflateReset2:KD,inflateResetKeep:YD,inflateInit:qD,inflateInit2:JD,inflate:ZD,inflateEnd:QD,inflateGetHeader:ex,inflateSetDictionary:tx,inflateInfo:sx};function ix(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=false}var nx=ix;const YR=Object.prototype.toString,{Z_NO_FLUSH:rx,Z_FINISH:ox,Z_OK:Zl,Z_STREAM_END:cp,Z_NEED_DICT:up,Z_STREAM_ERROR:ax,Z_DATA_ERROR:oS,Z_MEM_ERROR:lx}=ya;function dc(s){this.options=ch.assign({chunkSize:1024*64,windowBits:15,to:""},s||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(s&&s.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=false,this.chunks=[],this.strm=new xR,this.strm.avail_out=0;let i=Xn.inflateInit2(this.strm,n.windowBits);if(i!==Zl)throw new Error(uo[i]);if(this.header=new nx,Xn.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=Jl.string2buf(n.dictionary):YR.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(i=Xn.inflateSetDictionary(this.strm,n.dictionary),i!==Zl)))throw new Error(uo[i])}dc.prototype.push=function(s,n){const i=this.strm,o=this.options.chunkSize,l=this.options.dictionary;let h,f,u;if(this.ended)return false;for(n===~~n?f=n:f=n===true?ox:rx,YR.call(s)==="[object ArrayBuffer]"?i.input=new Uint8Array(s):i.input=s,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),h=Xn.inflate(i,f),h===up&&l&&(h=Xn.inflateSetDictionary(i,l),h===Zl?h=Xn.inflate(i,f):h===oS&&(h=up));i.avail_in>0&&h===cp&&i.state.wrap>0&&s[i.next_in]!==0;)Xn.inflateReset(i),h=Xn.inflate(i,f);switch(h){case ax:case oS:case up:case lx:return this.onEnd(h),this.ended=true,false}if(u=i.avail_out,i.next_out&&(i.avail_out===0||h===cp))if(this.options.to==="string"){let p=Jl.utf8border(i.output,i.next_out),c=i.next_out-p,_=Jl.buf2string(i.output,p);i.next_out=c,i.avail_out=o-c,c&&i.output.set(i.output.subarray(p,p+c),0),this.onData(_)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(!(h===Zl&&u===0)){if(h===cp)return h=Xn.inflateEnd(this.strm),this.onEnd(h),this.ended=true,true;if(i.avail_in===0)break}}return true};dc.prototype.onData=function(s){this.chunks.push(s)};dc.prototype.onEnd=function(s){s===Zl&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ch.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};function nm(s,n){const i=new dc(n);if(i.push(s),i.err)throw i.msg||uo[i.err];return i.result}function cx(s,n){return n=n||{},n.raw=true,nm(s,n)}var ux=dc,hx=nm,dx=cx,_x=nm,px=ya,gx={Inflate:ux,inflate:hx,inflateRaw:dx,ungzip:_x,constants:px};const{Deflate:p5,deflate:g5,deflateRaw:f5,gzip:fx}=$D,{Inflate:m5,inflate:E5,inflateRaw:b5,ungzip:mx}=gx;var Ex=fx,bx=mx;function vx(s){let n=new Uint8Array(s.length);for(let i=0;i<s.length;i++)n[i]=s.charCodeAt(i);return n.buffer}const Tx=`{
  "name": "koishi-plugin-blockly",
  "description": "Use blockly to develop a simple koishi plugin",
  "version": "0.6.3",
  "main": "lib/index.js",
  "typings": "lib/index.d.ts",
  "repository": {
    "type": "git",
    "url": "https://github.com/koishijs/koishi-plugin-blockly.git"
  },
  "homepage": "https://blockly.koishi.chat",
  "files": [
    "lib",
    "dist",
    "media"
  ],
  "license": "AGPL-3.0",
  "scripts": {
    "docs:dev": "vitepress dev docs --open",
    "docs:build": "vitepress build docs",
    "docs:serve": "vitepress serve docs",
    "test": "yakumo mocha -r esbuild-register -r yml-register --exit"
  },
  "keywords": [
    "chatbot",
    "koishi",
    "plugin",
    "blockly",
    "lowcode",
    "program",
    "develop",
    "flowgraph",
    "dataflow",
    "visualization"
  ],
  "koishi": {
    "browser": true,
    "public": [
      "dist"
    ],
    "description": {
      "en": "Use blockly to develop a simple koishi plugin",
      "zh": "Blockly \u53EF\u89C6\u5316\u7F16\u7A0B\u63D2\u4EF6"
    }
  },
  "peerDependencies": {
    "@koishijs/plugin-console": "^5.7.7",
    "koishi": "^4.12.8"
  },
  "devDependencies": {
    "@baklavajs/themes": "^2.0.1-next.0",
    "@highlightjs/vue-plugin": "^2.1.2",
    "@koishijs/client": "^5.7.6",
    "@koishijs/plugin-console": "^5.7.6",
    "@koishijs/vitepress": "^1.9.5",
    "@mit-app-inventor/blockly-block-lexical-variables": "^0.0.13",
    "@types/node": "^18.16.8",
    "@types/pako": "^2.0.0",
    "@types/semver": "^7.5.0",
    "@types/uuid": "^9.0.1",
    "baklavajs": "2.0.2-beta.3",
    "blockly": "9.2.1",
    "chai": "^4.3.7",
    "element-plus": "^2.3.4",
    "highlight.js": "^11.8.0",
    "koishi": "^4.11.6",
    "mocha": "^10.2.0",
    "pako": "^2.1.0",
    "sass": "^1.62.1",
    "semver": "^7.5.0",
    "typescript": "^4.9.5",
    "uuid": "^9.0.0",
    "vitepress": "1.0.0-alpha.26",
    "xterm": "^5.1.0",
    "yakumo-mocha": "^0.3.1"
  },
  "dependencies": {
    "jsonpath-plus": "^7.2.0",
    "uuid": "^9.0.0"
  }
}
`,Sx=JSON.parse(Tx),qR=1,$f=Sx.version??"0.0.0";function $x(s,n,i){const l=encodeURI(JSON.stringify({version:qR,plugin_version:$f,vendors:[],body:i,name:s,uuid:n})),h=btoa(String.fromCharCode.apply(null,Ex(l)));let f=`\u63D2\u4EF6\u540D\u79F0: ${s}
`;return f+=`\u5BFC\u51FA\u65F6\u95F4: ${new Date().toLocaleString()}
`,f+=`-=-=-=-=--=-=-=-=- BEGIN KOISHI BLOCKLY BLOCK V1 -=-=--=-=-=--=-=--=-=-=-
`,f+=`${h.replace(/(.{64})/g,`$1
`)}
`,f+=`-=-=--=-=-=--=-=-=-=- END KOISHI BLOCKLY BLOCK V1 -=-=--=-=-=--=-=--=-=-=-
`,f.replace(`

`,`
`)}function yx(s){var l;const n=(l=s.match(/[=–-]+\s+BEGIN KOISHI BLOCKLY BLOCK V1\s+[=–-]+\n([\s\S]+)\n[=–-]+\s+END KOISHI BLOCKLY BLOCK V1\s+[=–-]+/))==null?void 0:l[1].replace(/[\r\n\t ]/g,"");if(!n)return null;const i=bx(vx(atob(n)),{to:"string"});if(!i)return null;const o=JSON.parse(decodeURI(i));return o||null}const Rx=`export const name = "{{name}}"
export const using = {{using}}
export async function apply(ctx){
{{apply}}
}
`;var hp={exports:{}},dp={exports:{}},_p={exports:{}},pp={exports:{}},aS;function rm(){return aS||(aS=1,function(s,n){(function(i,o){s.exports=o()})(Ri,function(){var i={},o=function(e,t,r,a){e=e+" was deprecated in "+t+" and will be deleted in "+r+".",a&&(e+=`
Use `+a+" instead."),console.warn(e)},l=function(e,t){h(),Fc=setTimeout(function(){t&&t.handleRightClick(e)},rO)},h=function(){Fc&&(clearTimeout(Fc),Fc=0)},f=function(){Uc=null},u=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&c(e)},p=function(e){return`${e.pointerId}`},c=function(e){const t=p(e);return Uc?Uc===t:e.type==="pointerdown"?(Uc=t,true):false},_=function(e){if(o("setClientFromTouch()","version 9","version 10"),e.type.startsWith("touch")&&e.changedTouches){const t=e.changedTouches[0];e.clientX=t.clientX,e.clientY=t.clientY}},m=function(e){return o("isMouseOrTouchEvent()","version 9","version 10"),e.type.startsWith("touch")||e.type.startsWith("mouse")||e.type.startsWith("pointer")},E=function(e){return o("isTouchEvent()","version 9","version 10"),e.type.startsWith("touch")||e.type.startsWith("pointer")},b=function(e){o("splitEventByTouches()","version 9","version 10");const t=[];if(e.changedTouches)for(let r=0;r<e.changedTouches.length;r++)t[r]={type:e.type,changedTouches:[e.changedTouches[r]],target:e.target,stopPropagation(){e.stopPropagation()},preventDefault(){e.preventDefault()}};else t.push(e);return t},T=function(e,t,r,a,d,C){function M(z){(d||u(z))&&(r?a.call(r,z):a(z))}if(C!==void 0&&o("The opt_noPreventDefault argument of conditionalBind","version 9","version 10"),C=[],t in xr)for(let z=0;z<xr[t].length;z++){const he=xr[t][z];e.addEventListener(he,M,false),C.push([e,he,M])}else e.addEventListener(t,M,false),C.push([e,t,M]);return C},y=function(e,t,r,a){function d(M){r?a.call(r,M):a(M)}const C=[];if(t in xr)for(let M=0;M<xr[t].length;M++){const z=xr[t][M];e.addEventListener(z,d,false),C.push([e,z,d])}else e.addEventListener(t,d,false),C.push([e,t,d]);return C},g=function(e){const t=e[e.length-1][2];for(;e.length;){const r=e.pop();r[0].removeEventListener(r[1],r[2],false)}return t},$=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||e.target.getAttribute("data-is-text-input")==="true")return true;if(e.target instanceof HTMLInputElement)return e=e.target,e.type==="text"||e.type==="number"||e.type==="email"||e.type==="password"||e.type==="search"||e.type==="tel"||e.type==="url";if(e.target instanceof HTMLTextAreaElement)return true}return false},R=function(e){return e.ctrlKey&&od?true:e.button===2},v=function(e,t,r){const a=t.createSVGPoint();return a.x=e.clientX,a.y=e.clientY,r||(r=t.getScreenCTM().inverse()),a.matrixTransform(r)},S=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*tb,y:e.deltaY*tb};case 2:return{x:e.deltaX*sb,y:e.deltaY*sb}}},O=function(e){return Lo[e]||null},w=function(){const e=[];for(const t in Lo)e.push(Lo[t]);return e},A=function(e){Lo[e.id]=e},I=function(e){delete Lo[e.id]},L=function(){return ib},x=function(e){ib=e},B=function(){return ld},H=function(e){ld=e},F=function(){return nb},X=function(e){nb=e},Z=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),r=e.getCachedParentSvgSize();var a=t.parentElement;if(a instanceof HTMLElement){var d=a.offsetWidth;a=a.offsetHeight,r.width!==d&&(t.setAttribute("width",d+"px"),e.setCachedParentSvgSize(d,null)),r.height!==a&&(t.setAttribute("height",a+"px"),e.setCachedParentSvgSize(null,a)),e.resize()}},J=function(e,t){const r=Object.create(null),a=e.getDescendants(true);t&&(e=e.getNextBlock())&&(e=a.indexOf(e),a.splice(e,a.length-e));for(let d=0,C;C=a[d];d++)r[C.type]?r[C.type]++:r[C.type]=1;return r},D=function(e){return function(){this.jsonInit(e)}},P=function(e){cd.defineBlocksWithJsonArrayInternal(e)},V=function(e){re(j(e))},j=function(e){const t={};for(let r=0;r<e.length;r++){const a=e[r];if(!a){console.warn(`Block definition #${r} in JSON array is ${a}. Skipping`);continue}const d=a.type;d?t[d]={init:D(a)}:console.warn(`Block definition #${r} in JSON array is missing a type attribute. Skipping.`)}return t},re=function(e){for(const t of Object.keys(e)){const r=e[t];t in Ys&&console.warn(`Block definiton "${t}" overwrites previous definition.`),Ys[t]=r}},G=function(e,t,r){e=document.createElementNS(No,String(e));for(const a in t)e.setAttribute(a,`${t[a]}`);return r&&r.appendChild(e),e},ae=function(e,t){return t=t.split(" "),t.every(r=>e.classList.contains(r))?false:(e.classList.add(...t),true)},de=function(e,t){e.classList.remove(...t.split(" "))},fe=function(e,t){return t=t.split(" "),t.every(r=>!e.classList.contains(r))?false:(e.classList.remove(...t),true)},ee=function(e,t){return e.classList.contains(t)},W=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},Q=function(e,t){const r=t.nextSibling;if(t=t.parentNode,!t)throw Error("Reference node has no parent.");r?t.insertBefore(e,r):t.appendChild(e)},ce=function(e,t){return!!(e.compareDocumentPosition(t)&un.DOCUMENT_POSITION_CONTAINED_BY)},Ee=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},Xe=function(){ud++,Vi||(Vi=Object.create(null))},Re=function(){ud--,ud||(Vi=null)},_t=function(e){const t=e.textContent+`
`+e.className.baseVal;let r;if(Vi&&(r=Vi[t]))return r;try{r=e.getComputedTextLength()}catch{return 8*e.textContent.length}return Vi&&(Vi[t]=r),r},Ct=function(e,t,r,a){return Rt(e,t+"pt",r,a)},Rt=function(e,t,r,a){const d=e.textContent;e=d+`
`+e.className.baseVal;var C;return Vi&&(C=Vi[e])||(Wc||(C=document.createElement("canvas"),C.className="blocklyComputeCanvas",document.body.appendChild(C),Wc=C.getContext("2d")),Wc.font=r+" "+t+" "+a,C=d?Wc.measureText(d).width:0,Vi&&(Vi[e]=C)),C},ct=function(e,t,r,a){const d=document.createElement("span");d.style.font=r+" "+t+" "+a,d.textContent=e,e=document.createElement("div"),e.style.width="1px",e.style.height="0",t=document.createElement("div"),t.setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),t.appendChild(d),t.appendChild(e),document.body.appendChild(t),r={height:0,baseline:0};try{t.style.alignItems="baseline",r.baseline=e.offsetTop-d.offsetTop,t.style.alignItems="flex-end",r.height=e.offsetTop-d.offsetTop}finally{document.body.removeChild(t)}return r},Ut=function(e){return e*Math.PI/180},Ui=function(e){return 180*e/Math.PI},ai=function(e,t,r){if(r<e){const a=r;r=e,e=a}return Math.max(e,Math.min(t,r))},li=function(e){return rb.getSizeInternal(e)},ci=function(e){if(Es(e,"display")!=="none")return ks(e);const t=e.style,r=t.display,a=t.visibility,d=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const C=e.offsetWidth;return e=e.offsetHeight,t.display=r,t.position=d,t.visibility=a,new Ts(C,e)},ks=function(e){return new Ts(e.offsetWidth,e.offsetHeight)},Es=function(e,t){return e=window.getComputedStyle(e),e[t]||e.getPropertyValue(t)},$e=function(e,t){return o("Blockly.utils.style.getCascadedStyle","version 9","version 10"),e.currentStyle?e.currentStyle[t]:""},rt=function(e){const t=new we(0,0);e=e.getBoundingClientRect();var r=document.documentElement;return r=new we(window.pageXOffset||r.scrollLeft,window.pageYOffset||r.scrollTop),t.x=e.left+r.x,t.y=e.top+r.y,t},pt=function(){const e=document.body,t=document.documentElement;return new we(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},ts=function(e){const t=parseFloat(Es(e,"borderLeftWidth")),r=parseFloat(Es(e,"borderRightWidth")),a=parseFloat(Es(e,"borderTopWidth"));return e=parseFloat(Es(e,"borderBottomWidth")),new Zt(a,e,t,r)},ye=function(e,t,r){e=Zn(e,t,r),t.scrollLeft=e.x,t.scrollTop=e.y},Zn=function(e,t,r){var a=rt(e),d=rt(t),C=ts(t);const M=a.x-d.x-C.left;return a=a.y-d.y-C.top,d=ks(e),e=t.clientWidth-d.width,d=t.clientHeight-d.height,C=t.scrollLeft,t=t.scrollTop,r?(C+=M-e/2,t+=a-d/2):(C+=Math.min(M,Math.max(M-e,0)),t+=Math.min(a,Math.max(a-d,0))),new we(C,t)},Qn=function(){vt||(vt=document.createElement("div"),vt.className="blocklyDropDownDiv",(F()||document.body).appendChild(vt),xo=document.createElement("div"),xo.className="blocklyDropDownContent",vt.appendChild(xo),Ur=document.createElement("div"),Ur.className="blocklyDropDownArrow",vt.appendChild(Ur),vt.style.opacity="0",vt.style.transition="transform "+jc+"s, opacity "+jc+"s",vt.addEventListener("focusin",function(){ae(vt,"blocklyFocused")}),vt.addEventListener("focusout",function(){fe(vt,"blocklyFocused")}))},Fi=function(e){pd=e},er=function(){return nr},Ot=function(){return xo},ss=function(){xo.textContent="",xo.style.width=""},N=function(e,t){vt.style.backgroundColor=e,vt.style.borderColor=t},U=function(e,t,r,a){return ut(ne(t),e,r,a)},q=function(e,t,r){return ab=true,ut(oe(e),e,t,r)},ne=function(e){var t=e.getSvgRoot();const r=e.workspace.scale,a=e.height*r;return e=e.width*r,t=rt(t),new Zt(t.y,t.y+a,t.x,t.x+e)},oe=function(e){return e=e.getScaledBBox(),new Zt(e.top,e.bottom,e.left,e.right)},ut=function(e,t,r,a){const d=e.left+(e.right-e.left)/2,C=e.bottom;e=e.top,a&&(e+=a),a=t.getSourceBlock();let M=a.workspace;for(;M.options.parentWorkspace;)M=M.options.parentWorkspace;return Fi(M.getParentSvg().parentNode),wn(t,a.RTL,d,C,d,e,r)},wn=function(e,t,r,a,d,C,M){return nr=e,Pr=M||null,vt.style.direction=t?"rtl":"ltr",e=L(),Mo=e.getRenderer().getClassName(),Do=e.getTheme().getClassName(),Mo&&ae(vt,Mo),Do&&ae(vt,Do),Ue(r,a,d,C)},wa=function(e,t,r,a){return e=pe(e,r.left,r.right,a.width),{initialX:e.divX,initialY:t,finalX:e.divX,finalY:t+dd,arrowX:e.arrowX,arrowY:-(Ga/2+hd),arrowAtTop:true,arrowVisible:true}},kn=function(e,t,r,a){return e=pe(e,r.left,r.right,a.width),{initialX:e.divX,initialY:t-a.height,finalX:e.divX,finalY:t-a.height-dd,arrowX:e.arrowX,arrowY:a.height-2*hd-Ga/2,arrowAtTop:false,arrowVisible:true}},K=function(e,t,r){return e=pe(e,t.left,t.right,r.width),{initialX:e.divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:false}},pe=function(e,t,r,a){return t=ai(t,e-a/2,r-a),e=e-Ga/2-t,r=ob,e=ai(r,e,a-r-Ga),{arrowX:e,divX:t}},Le=function(){return!!nr},qe=function(e,t){return nr===e?(t?wt():Gt(),true):false},Gt=function(){vt.style.transform="translate(0, 0)",vt.style.opacity="0",_d=setTimeout(function(){wt()},1e3*jc),Pr&&(Pr(),Pr=null)},wt=function(){Le()&&(_d&&clearTimeout(_d),vt.style.transform="",vt.style.left="",vt.style.top="",vt.style.opacity="0",vt.style.display="none",vt.style.backgroundColor="",vt.style.borderColor="",Pr&&(Pr(),Pr=null),ss(),nr=null,Mo&&(fe(vt,Mo),Mo=""),Do&&(fe(vt,Do),Do=""),L().markFocused())},Ue=function(e,t,r,a){e=gd.getPositionMetrics(e,t,r,a),e.arrowVisible?(Ur.style.display="",Ur.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",Ur.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):Ur.style.display="none",t=Math.floor(e.initialX),r=Math.floor(e.initialY),a=Math.floor(e.finalX);const d=Math.floor(e.finalY);return vt.style.left=t+"px",vt.style.top=r+"px",vt.style.display="block",vt.style.opacity="1",vt.style.transform="translate("+(a-t)+"px,"+(d-r)+"px)",!!e.arrowAtTop},Be=function(){if(nr){var e=nr.getSourceBlock();e=ab?oe(nr):ne(e);const t=e.left+(e.right-e.left)/2;Ue(t,e.bottom,t,e.top)}else Gt()},Ie=function(e,t,r,a){if(!(e instanceof Te)&&typeof e!="string"||String(e).trim()==="")throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=String(e).toLowerCase(),typeof t!="string"||t.trim()==="")throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const d=t.toLowerCase();if(!r)throw Error("Can not register a null value");let C=rr[e],M=Xc[e];if(C||(C=rr[e]=Object.create(null),M=Xc[e]=Object.create(null)),gs(e,r),!a&&C[d])throw Error('Name "'+d+'" with type "'+e+'" already registered.');C[d]=r,M[d]=t},gs=function(e,t){switch(e){case String(Te.FIELD):if(typeof t.fromJson!="function")throw Error('Type "'+e+'" must have a fromJson function')}},Ht=function(e,t){e=String(e).toLowerCase(),t=t.toLowerCase();const r=rr[e];r&&r[t]?(delete rr[e][t],delete Xc[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},tr=function(e,t,r){e=String(e).toLowerCase(),t=t.toLowerCase();const a=rr[e];if(!a||!a[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",r)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return a[t]},mo=function(e,t){return e=String(e).toLowerCase(),t=t.toLowerCase(),(e=rr[e])?!!e[t]:false},on=function(e,t,r){return tr(e,t,r)},Eo=function(e,t,r){return tr(e,t,r)},Or=function(e,t,r){e=String(e).toLowerCase();var a=rr[e];if(!a){if(a=`Unable to find [${e}] in the registry.`,r)throw Error(`${a} You must require or register a ${e} plugin.`);return console.warn(a),null}if(!t)return a;e=Xc[e],r=Object.create(null),t=Object.keys(a);for(let d=0;d<t.length;d++){const C=t[d];r[e[C]]=a[C]}return r},js=function(e,t,r){return t=t.plugins[e.toString()]||Dn,typeof t=="function"?t:on(e,t,r)},wr=function(){return"blockly-"+(lO++).toString(36)},ui=function(){return cb.genUid()},As=function(e){Ha=e},Ls=function(){return Ha},Pe=function(e){Ed.fireInternal(e)},Th=function(e){as()&&(Go.length||setTimeout(mc,0),Go.push(e))},mc=function(){const e=bo(Go,true);Go.length=0;for(let t=0,r;r=e[t];t++){if(!r.workspaceId)continue;const a=O(r.workspaceId);a&&a.fireChangeListener(r)}},bo=function(e,t){e=e.slice(),t||e.reverse();const r=[],a=Object.create(null);for(let M=0,z;z=e[M];M++)if(!z.isNull()){var d=[z.isUiEvent?Wa:z.type,z.blockId,z.workspaceId].join(" "),C=a[d];const he=C?C.event:null;C?z.type===Ps&&C.index===M-1?(d=z,he.newParentId=d.newParentId,he.newInputName=d.newInputName,he.newCoordinate=d.newCoordinate,C.index=M):z.type===vs&&z.element===he.element&&z.name===he.name?he.newValue=z.newValue:z.type===Gr?(C=z,he.viewTop=C.viewTop,he.viewLeft=C.viewLeft,he.scale=C.scale,he.oldScale=C.oldScale):(z.type!==ar||he.type!==xn)&&(a[d]={event:z,index:M},r.push(z)):(a[d]={event:z,index:M},r.push(z))}e=r.filter(function(M){return!M.isNull()}),t||e.reverse();for(let M=1,z;z=e[M];M++)z.type===vs&&z.element==="mutation"&&e.unshift(e.splice(M,1)[0]);return e},Ci=function(){for(let e=0,t;t=Go[e];e++)t.recordUndo=false},Yt=function(){fd++},qt=function(){fd--},as=function(){return fd===0},Bt=function(){return ub},He=function(e){Ed.setGroupInternal(e)},vo=function(e){ub=typeof e=="boolean"?e?ui():"":e},To=function(e){const t=[];e=e.getDescendants(false);for(let r=0,a;a=e[r];r++)t[r]=a.id;return t},Oe=function(e,t){var r=ve(e.type);if(!r)throw Error("Unknown event type.");return ze(r)?r.fromJson(e,t):(r=new r,r.fromJson(e),r.workspaceId=t.id,r)},ze=function(e){return Object.getOwnPropertyDescriptors(e).fromJson&&typeof e.fromJson=="function"},ve=function(e){const t=on(Te.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},Nt=function(e){if((e.type===Ps||e.type===ys)&&e.workspaceId){var t=O(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const r=Ha;try{Ha=false;const a=e.getParent();if(a&&a.isEnabled()){const d=e.getDescendants(false);for(let C=0,M;M=d[C];C++)M.setEnabled(true)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do e.setEnabled(false),e=e.getNextBlock();while(e)}finally{Ha=r}}}},ls=function(e){({document:Vr=Vr,DOMParser:su=su,XMLSerializer:iu=iu}=e)},hi=function(){return o("Blockly.utils.xml.getDocument","version 9","version 10"),Vr},an=function(e){o("Blockly.utils.xml.setDocument","version 9","version 10"),Vr=e},ht=function(e){return Vr.createElementNS(bd,e)},is=function(e){return Vr.createTextNode(e)},di=function(e){return new su().parseFromString(e,"text/xml")},ka=function(e){return new iu().serializeToString(e)},kr=function(e,t){hb(e,t)},Ec=function(e){hb=e},Aa=function(e,t){pb.confirmInternal(e,t)},Sh=function(e,t){db(e,t)},$h=function(e){db=e},La=function(e,t,r){_b(e,t,r)},So=function(e){_b=e},$o=function(e){e=e.getAllBlocks(false);const t=new Set;for(let r=0;r<e.length;r++){const a=e[r].getVarModels();if(a)for(let d=0;d<a.length;d++){const C=a[d];C.getId()&&t.add(C)}}return Array.from(t.values())},Oi=function(e){e=e.getAllBlocks(false);const t=new Set;for(let a=0,d;d=e[a];a++){var r=d.getDeveloperVariables;if(r){r=r();for(let C=0;C<r.length;C++)t.add(r[C])}}return Array.from(t.values())},Na=function(e){let t=[];const r=document.createElement("button");return r.setAttribute("text","%{BKY_NEW_VARIABLE}"),r.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(a){kt(a.getTargetWorkspace())}),t.push(r),e=yo(e),t=t.concat(e)},yo=function(e){e=e.getVariablesOfType("");const t=[];if(0<e.length){var r=e[e.length-1];if(Ys.variables_set){var a=ht("block");a.setAttribute("type","variables_set"),a.setAttribute("gap",Ys.math_change?"8":"24"),a.appendChild(Ae(r)),t.push(a)}if(Ys.math_change&&(a=ht("block"),a.setAttribute("type","math_change"),a.setAttribute("gap",Ys.variables_get?"20":"8"),a.appendChild(Ae(r)),r=Bs('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),a.appendChild(r),t.push(a)),Ys.variables_get){e.sort(Za.compareByName);for(let d=0,C;C=e[d];d++)r=ht("block"),r.setAttribute("type","variables_get"),r.setAttribute("gap","8"),r.appendChild(Ae(C)),t.push(r)}}return t},st=function(e){return Sd.generateUniqueNameInternal(e)},bc=function(e){return cs(ru.charAt(0),e.getAllVariableNames())},cs=function(e,t){if(!t.length)return e;const r=ru;let a="",d=r.indexOf(e);for(;;){let C=false;for(let M=0;M<t.length;M++)if(t[M].toLowerCase()===e){C=true;break}if(!C)break;d++,d===r.length&&(d=0,a=`${Number(a)+1}`),e=r.charAt(d)+a}return e},kt=function(e,t,r){function a(C){Gi(je.NEW_VARIABLE_TITLE,C,function(M){if(M){const z=Ro(M,e);if(z){let he;z.type===d?he=je.VARIABLE_ALREADY_EXISTS.replace("%1",z.name):(he=je.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,he=he.replace("%1",z.name).replace("%2",z.type)),kr(he,function(){a(M)})}else e.createVariable(M,d),t&&t(M)}else t&&t(null)})}const d=r||"";a("")},Ar=function(e,t,r){function a(d){const C=je.RENAME_VARIABLE_TITLE.replace("%1",t.name);Gi(C,d,function(M){if(M){var z=Ma(M,t.type,e);z?(z=je.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",z.name).replace("%2",z.type),kr(z,function(){a(M)})):(e.renameVariableById(t.getId(),M),r&&r(M))}else r&&r(null)})}a("")},Gi=function(e,t,r){La(e,t,function(a){a&&(a=a.replace(/[\s\xa0]+/g," ").trim(),a===je.RENAME_VARIABLE||a===je.NEW_VARIABLE)&&(a=null),r(a)})},Ma=function(e,t,r){r=r.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let a=0,d;d=r[a];a++)if(d.name.toLowerCase()===e&&d.type!==t)return d;return null},Ro=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let r=0,a;a=t[r];r++)if(a.name.toLowerCase()===e)return a;return null},Ae=function(e){const t=ht("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type),e=is(e.name),t.appendChild(e),t},Fe=function(e,t,r,a){let d=nt(e,t,r,a);return d||(d=At(e,t,r,a)),d},nt=function(e,t,r,a){const d=e.getPotentialVariableMap();let C=null;if(t&&(C=e.getVariableById(t),!C&&d&&(C=d.getVariableById(t)),C))return C;if(r){if(a===void 0)throw Error("Tried to look up a variable by name without a type");C=e.getVariable(r,a),!C&&d&&(C=d.getVariable(r,a))}return C},At=function(e,t,r,a){const d=e.getPotentialVariableMap();return r||(r=st(e.isFlyout?e.targetWorkspace:e)),d?d.createVariable(r,a,t):e.createVariable(r,a,t)},fs=function(e,t){e=e.getAllVariables();const r=[];if(t.length!==e.length)for(let a=0;a<e.length;a++){const d=e[a];t.indexOf(d)===-1&&r.push(d)}return r},us=function(e){if(yd)throw Error("CSS already injected");Rd+=`
`+e},vc=function(e,t){yd||(yd=true,e&&(e=t.replace(/[\\/]$/,""),t=Rd.replace(/<<<PATH>>>/g,e),Rd="",e=document.createElement("style"),e.id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},_i=function(e){const t=new we(0,0);var r=e.x&&e.getAttribute("x");const a=e.y&&e.getAttribute("y");return r&&(t.x=parseInt(r)),a&&(t.y=parseInt(a)),(r=(r=e.getAttribute("transform"))&&r.match(gb))&&(t.x+=Number(r[1]),r[3]&&(t.y+=Number(r[3]))),(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&(e=e.match(fb))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},Tc=function(e){let t=0,r=0;for(;e;){const a=_i(e);if(t+=a.x,r+=a.y,(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1)break;e=e.parentNode}return new we(t,r)},bm=function(){return o("Blockly.utils.svgMath.is3dSupported","version 9","version 10"),true},yh=function(){const e=pt();return new Zt(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},Rh=function(){const e=document.documentElement,t=window;return new we(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},vm=function(e,t){var r=t.x;t=t.y;const a=e.getInjectionDiv().getBoundingClientRect();return r=new we(r-a.left,t-a.top),t=e.getOriginOffsetInPixels(),we.difference(r,t).scale(1/e.scale)},P0=function(e,t){const r=ht("xml");var a=Tm($o(e));a.hasChildNodes()&&r.appendChild(a),a=e.getTopComments(true);for(let d=0;d<a.length;d++)r.appendChild(a[d].toXmlWithXY(t));for(e=e.getTopBlocks(true),a=0;a<e.length;a++)r.appendChild(Sc(e[a],t));return r},Tm=function(e){const t=ht("variables");for(let r=0;r<e.length;r++){const a=e[r],d=ht("variable");d.appendChild(is(a.name)),a.type&&d.setAttribute("type",a.type),d.id=a.getId(),t.appendChild(d)}return t},Sc=function(e,t){if(e.isInsertionMarker()&&(e=e.getChildren(false)[0],!e))return new DocumentFragment;let r=0;e.workspace.RTL&&(r=e.workspace.getWidth()),t=Lr(e,t);const a=e.getRelativeToSurfaceXY();return t.setAttribute("x",Math.round(e.workspace.RTL?r-a.x:a.x)),t.setAttribute("y",Math.round(a.y)),t},U0=function(e){if(e.isSerializable()){const t=ht("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},F0=function(e,t){for(let r=0;r<e.inputList.length;r++){const a=e.inputList[r];for(let d=0;d<a.fieldRow.length;d++){const C=U0(a.fieldRow[d]);C&&t.appendChild(C)}}},Lr=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(false)[0])?Lr(t):new DocumentFragment;const r=ht(e.isShadow()?"shadow":"block");if(r.setAttribute("type",e.type),t||r.setAttribute("id",e.id),e.mutationToDom){var a=e.mutationToDom();a&&(a.hasChildNodes()||a.hasAttributes())&&r.appendChild(a)}if(F0(e,r),a=e.getCommentText()){var d=e.commentModel.size,C=e.commentModel.pinned,M=ht("comment");M.appendChild(is(a)),M.setAttribute("pinned",C),M.setAttribute("h",d.height),M.setAttribute("w",d.width),r.appendChild(M)}for(e.data&&(a=ht("data"),a.appendChild(is(e.data)),r.appendChild(a)),a=0;a<e.inputList.length;a++){d=e.inputList[a];var z=void 0;if(C=true,d.type!==it.DUMMY){M=d.connection.targetBlock(),d.type===it.VALUE?z=ht("value"):d.type===it.STATEMENT&&(z=ht("statement"));const ke=d.connection.getShadowDom();!ke||M&&M.isShadow()||z.appendChild(Sm(ke,t)),M&&(M=Lr(M,t),M.nodeType===un.ELEMENT_NODE&&(z.appendChild(M),C=false)),z.setAttribute("name",d.name),C||r.appendChild(z)}}e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&r.setAttribute("inline",e.inputsInline.toString()),e.isCollapsed()&&r.setAttribute("collapsed","true"),e.isEnabled()||r.setAttribute("disabled","true"),e.isDeletable()||e.isShadow()||r.setAttribute("deletable","false"),e.isMovable()||e.isShadow()||r.setAttribute("movable","false"),e.isEditable()||r.setAttribute("editable","false"),z=e.getNextBlock();let he;return z&&(a=Lr(z,t),a.nodeType===un.ELEMENT_NODE&&(he=ht("next"),he.appendChild(a),r.appendChild(he))),e=e.nextConnection&&e.nextConnection.getShadowDom(),!e||z&&z.isShadow()||he.appendChild(Sm(e,t)),r},Sm=function(e,t){let r=e=e.cloneNode(true),a;for(;r;)if(t&&r.nodeName==="shadow"&&r.removeAttribute("id"),r.firstChild)r=r.firstChild;else{for(;r&&!r.nextSibling;){a=r,r=r.parentNode;let d;a.nodeType===un.TEXT_NODE&&a.data.trim()===""&&((d=r)==null?void 0:d.firstChild)!==a&&W(a)}r&&(a=r,r=r.nextSibling,a.nodeType===un.TEXT_NODE&&a.data.trim()===""&&W(a))}return e},wi=function(e){return ka(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},G0=function(e){e=wi(e).split("<");let t="";for(let r=1;r<e.length;r++){const a=e[r];a[0]==="/"&&(t=t.substring(2)),e[r]=t+"<"+a,a[0]!=="/"&&a.slice(-2)!=="/>"&&(t+="  ")}return e=e.join(`
`),e=e.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),e.replace(/^\n/,"")},Bs=function(e){const t=di(e);if(!t||!t.documentElement||t.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+e);return t.documentElement},H0=function(e,t){return t.setResizesEnabled(false),t.clear(),e=Da(e,t),t.setResizesEnabled(true),e},Da=function(e,t){let r=0;t.RTL&&(r=t.getWidth());const a=[];Xe();const d=Bt();d||He(true),t.setResizesEnabled&&t.setResizesEnabled(false);let C=true;try{for(let M=0,z;z=e.childNodes[M];M++){const he=z.nodeName.toLowerCase(),ke=z;if(he==="block"||he==="shadow"&&!Ls()){const ft=Io(ke,t);a.push(ft.id);const Wt=ke.hasAttribute("x")?parseInt(ke.getAttribute("x")):10,vi=ke.hasAttribute("y")?parseInt(ke.getAttribute("y")):10;isNaN(Wt)||isNaN(vi)||ft.moveBy(t.RTL?r-Wt:Wt,vi),C=false}else{if(he==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(he==="comment")t.rendered?Ms.fromXmlRendered(ke,t,r):_n.fromXml(ke,t);else if(he==="variables"){if(C)$m(ke,t);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");C=false}}}}finally{d||He(false),Re()}return t.setResizesEnabled&&t.setResizesEnabled(true),Pe(new(ve(Fo))(t)),a},V0=function(e,t){if(!t.getBlocksBoundingBox)return Da(e,t);var r=t.getBlocksBoundingBox();if(e=Da(e,t),r&&r.top!==r.bottom){var a=r.bottom;r=t.RTL?r.right:r.left;var d=1/0;let C=-1/0,M=1/0;for(let z=0;z<e.length;z++){const he=t.getBlockById(e[z]).getRelativeToSurfaceXY();he.y<M&&(M=he.y),he.x<d&&(d=he.x),he.x>C&&(C=he.x)}for(a=a-M+10,r=t.RTL?r-C:r-d,d=0;d<e.length;d++)t.getBlockById(e[d]).moveBy(r,a)}return e},Io=function(e,t){Yt();var r=t.getAllVariables();let a;try{if(a=Ih(e,t),t.rendered){const d=a,C=a.getDescendants(false);d.setConnectionTracking(false);for(let M=C.length-1;0<=M;M--)C[M].initSvg();for(let M=C.length-1;0<=M;M--)C[M].render(false);setTimeout(function(){d.disposed||d.setConnectionTracking(true)},1),d.updateDisabled(),t.resizeContents()}else{const d=a.getDescendants(false);for(let C=d.length-1;0<=C;C--)d[C].initModel()}}finally{qt()}if(as()){for(e=fs(t,r),t=0;t<e.length;t++)r=e[t],Pe(new(ve(Fr))(r));Pe(new(ve(ys))(a))}return a},$m=function(e,t){for(let r=0;r<e.children.length;r++){const a=e.children[r],d=a.getAttribute("type"),C=a.getAttribute("id");t.createVariable(a.textContent,d,C)}},W0=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let r=0;r<e.children.length;r++){const a=e.children[r];if(a.nodeType!==un.TEXT_NODE)switch(a.nodeName.toLowerCase()){case"mutation":t.mutation.push(a);break;case"comment":t.comment.push(a);break;case"data":t.data.push(a);break;case"title":case"field":t.field.push(a);break;case"value":case"statement":t.input.push(a);break;case"next":t.next.push(a);break;default:console.warn("Ignoring unknown tag: "+a.nodeName)}}return t},z0=function(e,t){let r=false;for(let a=0;a<e.length;a++){const d=e[a];t.domToMutation&&(t.domToMutation(d),t.initSvg&&(r=true))}return r},j0=function(e,t){for(let a=0;a<e.length;a++){var r=e[a];const d=r.textContent,C=r.getAttribute("pinned")==="true",M=parseInt(r.getAttribute("w"));if(r=parseInt(r.getAttribute("h")),t.setCommentText(d),t.commentModel.pinned=C,isNaN(M)||isNaN(r)||(t.commentModel.size=new Ts(M,r)),C&&t.getCommentIcon&&!t.isInFlyout){const z=t;setTimeout(function(){z.getCommentIcon().setVisible(true)},1)}}},X0=function(e,t){for(let r=0;r<e.length;r++)t.data=e[r].textContent},K0=function(e,t){for(let r=0;r<e.length;r++){const a=e[r],d=a.getAttribute("name");J0(t,d,a)}},ym=function(e){const t={childBlockElement:null,childShadowElement:null};for(let r=0;r<e.childNodes.length;r++){const a=e.childNodes[r];a.nodeType===un.ELEMENT_NODE&&(a.nodeName.toLowerCase()==="block"?t.childBlockElement=a:a.nodeName.toLowerCase()==="shadow"&&(t.childShadowElement=a))}return t},Y0=function(e,t,r,a){for(let C=0;C<e.length;C++){var d=e[C];const M=d.getAttribute("name"),z=r.getInput(M);if(!z){console.warn("Ignoring non-existent input "+M+" in block "+a);break}if(d=ym(d),d.childBlockElement){if(!z.connection)throw TypeError("Input connection does not exist.");Ih(d.childBlockElement,t,z.connection,false)}if(d.childShadowElement){let he;(he=z.connection)==null||he.setShadowDom(d.childShadowElement)}}},q0=function(e,t,r){for(let a=0;a<e.length;a++){const d=ym(e[a]);if(d.childBlockElement){if(!r.nextConnection)throw TypeError("Next statement does not exist.");if(r.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Ih(d.childBlockElement,t,r.nextConnection,true)}d.childShadowElement&&r.nextConnection&&r.nextConnection.setShadowDom(d.childShadowElement)}},Ih=function(e,t,r,a){const d=e.getAttribute("type");if(!d)throw TypeError("Block type unspecified: "+e.outerHTML);var C=e.getAttribute("id");C=t.newBlock(d,C);const M=W0(e),z=z0(M.mutation,C);if(j0(M.comment,C),X0(M.data,C),r)if(a)if(C.previousConnection)r.connect(C.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(C.outputConnection)r.connect(C.outputConnection);else if(C.previousConnection)r.connect(C.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(K0(M.field,C),Y0(M.input,t,C,d),q0(M.next,t,C),z&&C.initSvg(),(t=e.getAttribute("inline"))&&C.setInputsInline(t==="true"),(t=e.getAttribute("disabled"))&&C.setEnabled(t!=="true"&&t!=="disabled"),(t=e.getAttribute("deletable"))&&C.setDeletable(t==="true"),(t=e.getAttribute("movable"))&&C.setMovable(t==="true"),(t=e.getAttribute("editable"))&&C.setEditable(t==="true"),(t=e.getAttribute("collapsed"))&&C.setCollapsed(t==="true"),e.nodeName.toLowerCase()==="shadow"){for(e=C.getChildren(false),t=0;t<e.length;t++)if(!e[t].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(C.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");C.setShadow(true)}return C},J0=function(e,t,r){const a=e.getField(t);a?a.fromXml(r):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},Z0=function(e){for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];if(r.nodeName.toLowerCase()==="next"){e.removeChild(r);break}}},Q0=function(e,t){return o("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith"),e.startsWith(t)},$c=function(e){return e.length?e.reduce(function(t,r){return t.length<r.length?t:r}).length:0},Rm=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||$c(e);let a;for(a=0;a<t;a++){for(var d=e[0][a],C=1;C<e.length;C++)if(d!==e[C][a])return r;d===" "&&(r=a+1)}for(d=1;d<e.length;d++)if((C=e[d][a])&&C!==" ")return r;return t},Im=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||$c(e);let a;for(a=0;a<t;a++){for(var d=e[0].substr(-a-1,1),C=1;C<e.length;C++)if(d!==e[C].substr(-a-1,1))return r;d===" "&&(r=a+1)}for(d=1;d<e.length;d++)if((C=e[d].charAt(e[d].length-a-1))&&C!==" ")return r;return t},Cm=function(e,t){e=e.split(`
`);for(let r=0;r<e.length;r++)e[r]=eI(e[r],t);return e.join(`
`)},eI=function(e,t){if(e.length<=t)return e;const r=e.trim().split(/\s+/);for(var a=0;a<r.length;a++)r[a].length>t&&(t=r[a].length);var d=-1/0;let C,M=1;do{a=d,C=e,e=[],d=r.length/M;let z=1;for(let he=0;he<r.length-1;he++)z<(he+1.5)/d?(z++,e[he]=true):e[he]=false;e=Om(r,e,t),d=Ch(r,e,t),e=tI(r,e),M++}while(d>a);return C},Ch=function(e,t,r){const a=[0],d=[];for(var C=0;C<e.length;C++)a[a.length-1]+=e[C].length,t[C]===true?(a.push(0),d.push(e[C].charAt(e[C].length-1))):t[C]===false&&a[a.length-1]++;for(e=Math.max(...a),t=0,C=0;C<a.length;C++)t-=2*Math.pow(Math.abs(r-a[C]),1.5),t-=Math.pow(e-a[C],1.5),".?!".indexOf(d[C])!==-1?t+=r/3:",;)]}".indexOf(d[C])!==-1&&(t+=r/4);return 1<a.length&&a[a.length-1]<=a[a.length-2]&&(t+=.5),t},Om=function(e,t,r){let a=Ch(e,t,r),d;for(let C=0;C<t.length-1;C++){if(t[C]===t[C+1])continue;const M=[].concat(t);M[C]=!M[C],M[C+1]=!M[C+1];const z=Ch(e,M,r);z>a&&(a=z,d=M)}return d?Om(e,d,r):t},tI=function(e,t){const r=[];for(let a=0;a<e.length;a++)r.push(e[a]),t[a]!==void 0&&r.push(t[a]?`
`:" ");return r.join("")},wm=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},sI=function(e){au=e},iI=function(){return au},nI=function(){return el},rI=function(){return ds},xa=function(e){if(e=km(e)){for(e=e.tooltip;typeof e=="function";)e=e();if(typeof e!="string")throw Error("Tooltip function must return a string.");return e}return""},km=function(e){for(;e&&e.tooltip;){if(typeof e.tooltip=="string"||typeof e.tooltip=="function")return e;e=e.tooltip}return null},Am=function(){ds||(ds=document.createElement("div"),ds.className="blocklyTooltipDiv",(F()||document.body).appendChild(ds))},yc=function(e){e.mouseOverWrapper_=y(e,"pointerover",null,oI),e.mouseOutWrapper_=y(e,"pointerout",null,aI),e.addEventListener("pointermove",Lm,false)},Rc=function(e){e&&(g(e.mouseOverWrapper_),g(e.mouseOutWrapper_),e.removeEventListener("pointermove",Lm))},oI=function(e){Vo||(e=km(e.currentTarget),Ai!==e&&(Nr(),sl=null,Ai=e),clearTimeout(Eb))},aI=function(e){Vo||(Eb=setTimeout(function(){sl=Ai=null,Nr()},1),clearTimeout(tl))},Lm=function(e){if(Ai&&Ai.tooltip&&!Vo)if(el){const t=Cd-e.pageX;e=Od-e.pageY,Math.sqrt(t*t+e*e)>bb&&Nr()}else sl!==Ai&&(clearTimeout(tl),Cd=e.pageX,Od=e.pageY,tl=setTimeout(hI,vb))},Nm=function(){sl=Ai=null,Nr()},Nr=function(){el&&(el=false,ds&&(ds.style.display="none")),tl&&clearTimeout(tl)},Mm=function(){Nr(),Vo=true},Dm=function(){Vo=false},lI=function(){ds&&Ai&&(typeof au=="function"?au(ds,Ai):cI())},cI=function(){var e=xa(Ai);e=Cm(e,mb),e=e.split(`
`);for(let t=0;t<e.length;t++){const r=document.createElement("div");r.appendChild(document.createTextNode(e[t])),ds.appendChild(r)}},uI=function(e){const t=document.documentElement.clientWidth,r=document.documentElement.clientHeight;let a=Cd;a=e?a-(wd+ds.offsetWidth):a+wd;let d=Od+kd;return d+ds.offsetHeight>r+window.scrollY&&(d-=ds.offsetHeight+2*kd),e?a=Math.max(lu-window.scrollX,a):a+ds.offsetWidth>t+window.scrollX-2*lu&&(a=t-ds.offsetWidth-2*lu),{x:a,y:d}},hI=function(){if(!Vo&&(sl=Ai,ds)){ds.textContent="",lI();var e=Ai.RTL;ds.style.direction=e?"rtl":"ltr",ds.style.display="block",el=true;var{x:t,y:r}=uI(e);ds.style.left=t+"px",ds.style.top=r+"px"}},xm=function(){return Ad},dI=function(e){Ad=e},Bm=function(){return Ld},_I=function(e){Ld=e},Mr=function(e){e=String(e).toLowerCase().trim();var t=Tb[e];if(t||(t=e.substring(0,2)==="0x"?"#"+e.substring(2):e,t=t[0]==="#"?t:"#"+t,/^#[0-9a-f]{6}$/.test(t)))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var r=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return r&&(e=Number(r[1]),t=Number(r[2]),r=Number(r[3]),0<=e&&256>e&&0<=t&&256>t&&0<=r&&256>r)?Ic(e,t,r):null},Ic=function(e,t,r){return t=e<<16|t<<8|r,16>e?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},Oh=function(e){return e=Mr(e),e?(e=parseInt(e.substr(1),16),[e>>16,e>>8&255,e&255]):[0,0,0]},wh=function(e,t,r){let a=0,d=0,C=0;if(t===0)C=d=a=r;else{const M=Math.floor(e/60),z=e/60-M;e=r*(1-t);const he=r*(1-t*z);switch(t=r*(1-t*(1-z)),M){case 1:a=he,d=r,C=e;break;case 2:a=e,d=r,C=t;break;case 3:a=e,d=he,C=r;break;case 4:a=t,d=e,C=r;break;case 5:a=r,d=e,C=he;break;case 6:case 0:a=r,d=t,C=e}}return Ic(Math.floor(a),Math.floor(d),Math.floor(C))},Co=function(e,t,r){return e=Mr(e),!e||(t=Mr(t),!t)?null:(e=Oh(e),t=Oh(t),Ic(Math.round(t[0]+r*(e[0]-t[0])),Math.round(t[1]+r*(e[1]-t[1])),Math.round(t[2]+r*(e[2]-t[2]))))},kh=function(e){return wh(e,Ad,255*Ld)},Ah=function(e,t){const r=[];var a=e.split("");a.push("");var d=0;e=[];let C=null;for(let he=0;he<a.length;he++){var M=a[he];if(d===0)M==="%"?((d=e.join(""))&&r.push(d),e.length=0,d=1):e.push(M);else if(d===1)M==="%"?(e.push(M),d=0):t&&"0"<=M&&"9">=M?(d=2,C=M,(M=e.join(""))&&r.push(M),e.length=0):M==="{"?d=3:(e.push("%",M),d=0);else if(d===2)if("0"<=M&&"9">=M)C+=M;else{var z=void 0;r.push(parseInt((z=C)!=null?z:"",10)),he--,d=0}else d===3&&(M===""?(e.splice(0,0,"%{"),he--,d=0):M!=="}"?e.push(M):(d=e.join(""),/[A-Z]\w*/i.test(d)?(M=d.toUpperCase(),(M=M.startsWith("BKY_")?M.substring(4):null)&&M in je?(d=je[M],typeof d=="string"?Array.prototype.push.apply(r,Ah(d,t)):t?r.push(String(d)):r.push(d)):r.push("%{"+d+"}")):r.push("%{"+d+"}"),d=e.length=0))}for((t=e.join(""))&&r.push(t),z=[],e.length=0,a=0;a<r.length;a++)typeof r[a]=="string"?e.push(r[a]):((t=e.join(""))&&z.push(t),e.length=0,z.push(r[a]));return(t=e.join(""))&&z.push(t),e.length=0,z},Lh=function(e){return Ah(e,true)},Jt=function(e){return typeof e!="string"?e:(e=Ah(e,false),e.length?String(e[0]):"")},Cc=function(e){let t=true;const r=je,a=e.match(/%{BKY_[A-Z]\w*}/ig);if(a)for(let d=0;d<a.length;d++){const C=a[d].toUpperCase();r[C.slice(6,-1)]===void 0&&(console.warn("No message string for "+a[d]+" in "+e),t=false)}return t},Oo=function(e){const t=typeof e=="string"?Jt(e):e;var r=Number(t);if(!isNaN(r)&&0<=r&&360>=r)return{hue:r,hex:wh(r,xm(),255*Bm())};if(r=Mr(t))return{hue:null,hex:r};throw r='Invalid colour: "'+t+'"',e!==t&&(r+=' (from "'+e+'")'),Error(r)},wo=function(){return ji},pI=function(e){ji=e},Pm=function(){ji||(ji=document.createElement("div"),ji.className="blocklyWidgetDiv",(F()||document.body).appendChild(ji))},Nh=function(e,t,r){ln(),cu=e,uu=r,(e=ji)&&(e.style.direction=t?"rtl":"ltr",e.style.display="block",t=L(),Wo=t.getRenderer().getClassName(),zo=t.getTheme().getClassName(),Wo&&ae(e,Wo),zo&&ae(e,zo))},ln=function(){if(Um()){cu=null;var e=ji;e&&(e.style.display="none",e.style.left="",e.style.top="",uu&&uu(),uu=null,e.textContent="",Wo&&(fe(e,Wo),Wo=""),zo&&(fe(e,zo),zo=""),L().markFocused())}},Um=function(){return!!cu},Mh=function(e){cu===e&&ln()},Fm=function(e,t,r){ji.style.left=e+"px",ji.style.top=t+"px",ji.style.height=r+"px"},Gm=function(e,t,r,a){const d=fI(e,t,r);e=gI(e,t,r,a),0>d?Fm(e,0,r.height+d):Fm(e,d,r.height)},gI=function(e,t,r,a){return a?Math.min(Math.max(t.right-r.width,e.left),e.right-r.width):Math.max(Math.min(t.left,e.right-r.width),e.left)},fI=function(e,t,r){return t.bottom+r.height>=e.bottom?t.top-r.height:t.bottom},ki=function(e,t){Ie(Te.FIELD,e,t)},mI=function(e){Ht(Te.FIELD,e)},Dh=function(e){return Sb.fromJsonInternal(e)},EI=function(e){const t=Eo(Te.FIELD,e.type);if(t){if(typeof t.fromJson!="function")throw new TypeError("returned Field was not a IRegistrableField");return t.fromJson(e)}return console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null},cn=function(e,t){e.setAttribute(_O,t)},zt=function(e,t,r){Array.isArray(r)&&(r=r.join(" ")),e.setAttribute(dO+t,`${r}`)},bI=function(e){return e!==dt.SKIP_SETUP},vI=function(e){let t=false;const r=e.map(([M,z])=>typeof M=="string"?[Jt(M),z]:(t=true,[M.alt!==null?Object.assign({},M,{alt:Jt(M.alt)}):Object.assign({},M),z]));if(t||2>e.length)return{options:r};var a=r.map(([M])=>M),d=$c(a);e=Rm(a,d);const C=Im(a,d);return!e&&!C||d<=e+C?{options:r}:(d=e?a[0].substring(0,e-1):void 0,a=C?a[0].substr(1-C):void 0,{options:TI(r,e,C),prefix:d,suffix:a})},TI=function(e,t,r){return e.map(([a,d])=>[a.substring(t,a.length-r),d])},Hm=function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=false;for(let r=0;r<e.length;r++){const a=e[r];Array.isArray(a)?typeof a[1]!="string"?(t=true,console.error("Invalid option["+r+"]: Each FieldDropdown option id must be a string. Found "+a[1]+" in: ",a)):a[0]&&typeof a[0]!="string"&&typeof a[0].src!="string"&&(t=true,console.error("Invalid option["+r+"]: Each FieldDropdown option must have a string label or image description. Found"+a[0]+" in: ",a)):(t=true,console.error("Invalid option["+r+"]: Each FieldDropdown option must be an array. Found: ",a))}if(t)throw TypeError("Found invalid FieldDropdown options.")},SI=function(e,t){o("Blockly.utils.object.inherits","version 9","version 10"),e.superClass_=t.prototype,Object.setPrototypeOf(e,t),e.prototype=Object.create(t.prototype),e.prototype.constructor=e},$I=function(e,t){o("Blockly.utils.object.mixin","May 2022","May 2023","Object.assign");for(const r in t)e[r]=t[r]},sr=function(e,t){for(const r in t)e[r]=t[r]!==null&&typeof t[r]=="object"?sr(e[r]||Object.create(null),t[r]):t[r];return e},yI=function(e){return o("Blockly.utils.object.values","version 9","version 10","Object.values"),Object.values(e)},Oc=function(e){return e?((e instanceof Element||typeof e=="string")&&(e=Wm(e),e=CI(e)),RI(e),e):null},RI=function(e){const t=e.kind;if(e=e.contents,t&&t!==yb&&t!==Pd)throw Error("Invalid toolbox kind "+t+". Please supply either "+yb+" or "+Pd);if(!e)throw Error("Toolbox must have a contents attribute.")},wc=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:Ph(e):[]},xh=function(e){return Rb.hasCategoriesInternal(e)},II=function(e){if(!e)return false;const t=e.kind;return t?t===Pd:!!e.contents.filter(function(r){return r.kind.toUpperCase()==="CATEGORY"}).length},Bh=function(e){return e&&e.contents?!!e.contents.filter(function(t){return t.kind.toUpperCase()==="CATEGORY"}).length:false},CI=function(e){const t={contents:Ph(e)};return e instanceof Node&&Vm(e,t),t},Ph=function(e){const t=[];let r=e.childNodes;r||(r=e);for(let a=0,d;d=r[a];a++){if(!d.tagName)continue;e={};const C=d.tagName.toUpperCase();e.kind=C,C==="BLOCK"?e.blockxml=d:d.childNodes&&0<d.childNodes.length&&(e.contents=Ph(d)),Vm(d,e),t.push(e)}return t},Vm=function(e,t){for(let r=0;r<e.attributes.length;r++){const a=e.attributes[r];-1<a.nodeName.indexOf("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[a.nodeName.replace("css-","")]=a.value):t[a.nodeName]=a.value}},Wm=function(e){let t=null;if(e)if(typeof e=="string"){if(t=Bs(e),t.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},kc=function(e,t){if(typeof e!="string"||e.trim()==="")throw Error('Error: Invalid extension name "'+e+'"');if(jo[e])throw Error('Error: Extension "'+e+'" is already registered.');if(typeof t!="function")throw Error('Error: Extension "'+e+'" must be a function');jo[e]=t},OI=function(e,t){if(!t||typeof t!="object")throw Error('Error: Mixin "'+e+'" must be a object');kc(e,function(){this.mixin(t)})},wI=function(e,t,r,a){const d='Error when registering mutator "'+e+'": ';Xm(d,t);const C=jm(t,d);if(r&&typeof r!="function")throw Error(d+'Extension "'+e+'" is not a function');kc(e,function(){C&&this.setMutator(new i.Mutator$$module$build$src$core$mutator(a||[],this)),this.mixin(t),r&&r.apply(this)})},kI=function(e){zm(e)?delete jo[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},zm=function(e){return!!jo[e]},Uh=function(e,t,r){const a=jo[e];if(typeof a!="function")throw Error('Error: Extension "'+e+'" not found.');let d;if(r?AI(e,t):d=Gh(t),a.apply(t),r)Xm('Error after applying mutator "'+e+'": ',t);else if(!MI(d,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},AI=function(e,t){if(Gh(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},LI=function(e,t){return Fh(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},NI=function(e,t){return Fh(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},jm=function(e,t){return Fh(e.compose,e.decompose,t+" compose/decompose")},Fh=function(e,t,r){if(e&&t){if(typeof e!="function"||typeof t!="function")throw Error(r+" must be a function");return true}if(!e&&!t)return false;throw Error(r+"Must have both or neither functions")},Xm=function(e,t){const r=LI(t,e),a=NI(t,e);if(!r&&!a)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");jm(t,e)},Gh=function(e){const t=[];return e.domToMutation!==void 0&&t.push(e.domToMutation),e.mutationToDom!==void 0&&t.push(e.mutationToDom),e.saveExtraState!==void 0&&t.push(e.saveExtraState),e.loadExtraState!==void 0&&t.push(e.loadExtraState),e.compose!==void 0&&t.push(e.compose),e.decompose!==void 0&&t.push(e.decompose),t},MI=function(e,t){if(t=Gh(t),t.length!==e.length)return false;for(let r=0;r<t.length;r++)if(e[r]!==t[r])return false;return true},Ac=function(e){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")e();else{const t=setInterval(function(){document.readyState==="complete"&&(clearInterval(t),e())},10)}},DI=function(e,t){const r=[];return typeof document=="object"&&Ac(function(){for(const a in t)Cc(t[a])}),function(){this.type&&r.indexOf(this.type)===-1&&(xI(this,e,t),r.push(this.type)),this.setTooltip(function(){var a=String(this.getFieldValue(e));let d=t[a];return d===null?r.indexOf(this.type)===-1&&(a="No tooltip mapping for value "+a+" of field "+e,this.type!==null&&(a+=" of block type "+this.type),console.warn(a+".")):d=Jt(d),d}.bind(this))}},xI=function(e,t,r){var a=e.getField(t);if(a instanceof Ki&&!a.isOptionListDynamic()){a=a.getOptions();for(let d=0;d<a.length;d++){const C=a[d][1];r[C]===null&&console.warn("No tooltip mapping for value "+C+" of field "+t+" of block type "+e.type)}}},BI=function(e,t){return typeof document=="object"&&Ac(function(){Cc(e)}),function(){this.setTooltip(function(){const r=this.getField(t);return Jt(e).replace("%1",r?r.getText():"")}.bind(this))}},PI=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},Xs=function(e,t){return t=e.indexOf(t),t===-1?false:(e.splice(t,1),true)},Ge=function(e,t){return" "+e+","+t+" "},pi=function(e,t){return" "+e+t.join("")},Ns=function(e,t){return" M "+e+","+t+" "},Vt=function(e,t){return" m "+e+","+t+" "},An=function(e,t){return" l "+e+","+t+" "},Ba=function(e){return" l"+e.join("")},Me=function(e,t){return" "+e+" "+t+" "},hs=function(e,t,r,a){return e+" "+r+" "+r+" "+t+a},UI=function(e){return o("Blockly.utils.getRelativeXY","December 2021","December 2022","Blockly.utils.svgMath.getRelativeXY"),_i(e)},FI=function(e){return o("Blockly.utils.getInjectionDivXY_","December 2021","December 2022","Blockly.utils.svgMath.getInjectionDivXY"),Tc(e)},GI=function(e){return o("Blockly.utils.tokenizeInterpolation","December 2021","December 2022","Blockly.utils.parsing.tokenizeInterpolation"),Lh(e)},HI=function(e){return o("Blockly.utils.replaceMessageReferences","December 2021","December 2022","Blockly.utils.parsing.replaceMessageReferences"),Jt(e)},VI=function(e){return o("Blockly.utils.checkMessageReferences","December 2021","December 2022","Blockly.utils.parsing.checkMessageReferences"),Cc(e)},WI=function(){return o("Blockly.utils.is3dSupported","December 2021","December 2022","Blockly.utils.svgMath.is3dSupported"),bm()},zI=function(){return o("Blockly.utils.getViewportBBox","December 2021","December 2022","Blockly.utils.svgMath.getViewportBBox"),yh()},jI=function(e,t){return o("Blockly.utils.arrayRemove","December 2021","December 2022","Blockly.array.removeElem"),Xs(e,t)},XI=function(){return o("Blockly.utils.getDocumentScroll","December 2021","December 2022","Blockly.utils.svgMath.getDocumentScroll"),Rh()},KI=function(e,t){return o("Blockly.utils.getBlockTypeCounts","December 2021","December 2022","Blockly.common.getBlockTypeCounts"),J(e,t)},YI=function(e,t){return o("Blockly.utils.screenToWsCoordinates","December 2021","December 2022","Blockly.utils.svgMath.screenToWsCoordinates"),vm(e,t)},qI=function(e){return o("Blockly.utils.parseBlockColour","December 2021","December 2022","Blockly.utils.parsing.parseBlockColour"),Oo(e)},JI=function(e){o("Blockly.utils.runAfterPageLoad","December 2021","December 2022"),Ac(e)},Hh=function(e,t){Ie(Te.SERIALIZER,e,t)},ZI=function(e){Ht(Te.SERIALIZER,e)},Ln=function(e,{addCoordinates:t=false,addInputBlocks:r=true,addNextBlocks:a=true,doFullSerialization:d=true}={}){if(e.isInsertionMarker())return null;const C={type:e.type,id:e.id};return t&&eC(e,C),QI(e,C),tC(e,C),sC(e,C),iC(e,C,d),r&&nC(e,C,d),a&&rC(e,C,d),C},QI=function(e,t){e.isCollapsed()&&(t.collapsed=true),e.isEnabled()||(t.enabled=false),e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},eC=function(e,t){const r=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(r.RTL?r.getWidth()-e.x:e.x),t.y=Math.round(e.y)},tC=function(e,t){e.saveExtraState?(e=e.saveExtraState(),e!==null&&(t.extraState=e)):e.mutationToDom&&(e=e.mutationToDom(),e!==null&&(t.extraState=wi(e).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},sC=function(e,t){e.getCommentText()&&(t.icons={comment:{text:e.getCommentText(),pinned:e.commentModel.pinned,height:Math.round(e.commentModel.size.height),width:Math.round(e.commentModel.size.width)}})},iC=function(e,t,r){const a=Object.create(null);for(let d=0;d<e.inputList.length;d++){const C=e.inputList[d];for(let M=0;M<C.fieldRow.length;M++){const z=C.fieldRow[M];z.isSerializable()&&(a[z.name]=z.saveState(r))}}Object.keys(a).length&&(t.fields=a)},nC=function(e,t,r){const a=Object.create(null);for(let d=0;d<e.inputList.length;d++){const C=e.inputList[d];if(C.type===it.DUMMY)continue;const M=Km(C.connection,r);M&&(a[C.name]=M)}Object.keys(a).length&&(t.inputs=a)},rC=function(e,t,r){e.nextConnection&&(e=Km(e.nextConnection,r))&&(t.next=e)},Km=function(e,t){const r=e.getShadowState(true);if(e=e.targetBlock(),!r&&!e)return null;const a=Object.create(null);return r&&(a.shadow=r),e&&!e.isShadow()&&(a.block=Ln(e,{doFullSerialization:t})),a},Dr=function(e,t,{recordUndo:r=false}={}){return Vh(e,t,{recordUndo:r})},Vh=function(e,t,{parentConnection:r,isShadow:a=false,recordUndo:d=false}={}){const C=Ls();As(d),(d=Bt())||He(true),Yt();const M=Ym(e,t,{parentConnection:r,isShadow:a});return qt(),Pe(new(ve(ys))(M)),He(d),As(C),t.rendered&&setTimeout(()=>{M.disposed||M.setConnectionTracking(true)},1),M},Ym=function(e,t,{parentConnection:r,isShadow:a=false}={}){if(!e.type)throw new Ob(e);const d=t.newBlock(e.type,e.id);return d.setShadow(a),oC(d,e),aC(d,e),lC(d,e),cC(r,d,e),uC(d,e),hC(d,e),dC(d,e),_C(d,e),pC(d,t.rendered),d},oC=function(e,t){let r=t.x===void 0?0:t.x;t=t.y===void 0?0:t.y;const a=e.workspace;r=a.RTL?a.getWidth()-r:r,e.moveBy(r,t)},aC=function(e,t){t.collapsed&&e.setCollapsed(true),t.enabled===false&&e.setEnabled(false),t.inline!==void 0&&e.setInputsInline(t.inline),t.data!==void 0&&(e.data=t.data)},lC=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(Bs(t.extraState)))},cC=function(e,t,r){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new kb(r);if(e.type===it.VALUE){var a=t.outputConnection;if(!a)throw new ll("output",t,r)}else if(a=t.previousConnection,!a)throw new ll("previous",t,r);if(!e.connect(a)){const d=t.workspace.connectionChecker;throw new wb(d.getErrorMessage(d.canConnectWithReason(a,e,false),a,e),e.type===it.VALUE?"output connection":"previous connection",t,r)}}},uC=function(e,t){t.icons&&(t=t.icons.comment)&&(e.setCommentText(t.text),"pinned"in t&&(e.commentModel.pinned=t.pinned),"width"in t&&"height"in t&&(e.commentModel.size=new Ts(t.width,t.height)),t.pinned&&e.rendered&&!e.isInFlyout&&setTimeout(()=>e.getCommentIcon().setVisible(true),1))},hC=function(e,t){if(t.fields){var r=Object.keys(t.fields);for(let a=0;a<r.length;a++){const d=r[a],C=t.fields[d],M=e.getField(d);M?M.loadState(C):console.warn(`Ignoring non-existant field ${d} in block ${e.type}`)}}},dC=function(e,t){if(t.inputs){var r=Object.keys(t.inputs);for(let a=0;a<r.length;a++){const d=r[a],C=e.getInput(d);if(!C||!C.connection)throw new ll(d,e,t);qm(C.connection,t.inputs[d])}}},_C=function(e,t){if(t.next){if(!e.nextConnection)throw new ll("next",e,t);qm(e.nextConnection,t.next)}},qm=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&Ym(t.block,e.getSourceBlock().workspace,{parentConnection:e})},pC=function(e,t){if(t)for(e.setConnectionTracking(false),e.initSvg(),e.render(false),e=e.getIcons(),t=0;t<e.length;t++)e[t].computeIconLocation();else e.initModel()},gC=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},fC=function(e,t){let r=null;t=t.outputConnection;const a=t.getConnectionChecker();for(let d=0,C;C=e.inputList[d];d++){const M=C.connection;if(M&&a.canConnect(t,M,false)){if(r)return null;r=M}}return r},mC=function(e,t){let r;for(;r=fC(e,t);)if(e=r.targetBlock(),!e||e.isShadow())return r;return null},Lc=function(e){let t=e.outputConnection;return(!t||e.previousConnection&&e.previousConnection.isConnected())&&(t=e.previousConnection),t},Jm=function(e){const t=e.workspace;var r=e.getSvgRoot();t.getAudioManager().play("delete");const a=t.getSvgXY(r);r=r.cloneNode(true),r.setAttribute("transform","translate("+a.x+","+a.y+")"),t.getParentSvg().appendChild(r),Zm(r,{x:a.x,y:a.y,width:e.width,height:e.height},t.RTL,new Date,t.scale)},Zm=function(e,t,r,a,d){const C=(new Date().getTime()-a.getTime())/150;1<C?W(e):(e.setAttribute("transform","translate("+(t.x+(r?-1:1)*t.width*d/2*C)+","+(t.y+t.height*d*C)+") scale("+(1-C)*d+")"),setTimeout(Zm,10,e,t,r,a,d))},Qm=function(e){const t=e.workspace,r=t.scale;if(t.getAudioManager().play("click"),!(1>r)){var a=t.getSvgXY(e.getSvgRoot());e.outputConnection?(a.x+=(e.RTL?3:-3)*r,a.y+=13*r):e.previousConnection&&(a.x+=(e.RTL?-23:23)*r,a.y+=3*r),e=G(te.CIRCLE,{cx:a.x,cy:a.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg()),eE(e,new Date,r)}},eE=function(e,t,r){const a=(new Date().getTime()-t.getTime())/150;1<a?W(e):(e.setAttribute("r",(25*a*r).toString()),e.style.opacity=(1-a).toString(),pu=setTimeout(eE,10,e,t,r))},tE=function(e){if(Pa(),e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),dl=e.getSvgRoot(),sE(dl,t,new Date)}},sE=function(e,t,r){const a=(new Date().getTime()-r.getTime())/200;let d="";1>=a&&(d=`skewX(${Math.round(Math.sin(a*Math.PI*3)*(1-a)*t)})`,pu=setTimeout(sE,10,e,t,r)),e.skew_=d,e.setAttribute("transform",e.translate_+e.skew_)},Pa=function(){if(dl){pu&&clearTimeout(pu);const e=dl;e.skew_="",e.setAttribute("transform",e.translate_),dl=null}},Ua=function(e){zd.copyInternal(e)},EC=function(e){Fn=e.toCopyData()},Wh=function(){if(!Fn)return null;let e=Fn.source;return e.isFlyout&&(e=e.targetWorkspace),Fn.typeCounts&&e.isCapacityAvailable(Fn.typeCounts)?e.paste(Fn.saveInfo):null},Nc=function(e){return zd.duplicateInternal(e)},bC=function(e){const t=Fn;Ua(e);let r,a,d;return e=(d=(r=e.toCopyData())==null||(a=r.source)==null?void 0:a.paste(Fn.saveInfo))!=null?d:null,Fn=t,e},iE=function(){return gl},nE=function(e){gl=e},Mc=function(e,t,r){if(Nh(jd,r,rE),t.length){var a=vC(t,r);fl=a,TC(a,e,r),setTimeout(function(){a.focus()},1),gl=null}else Dc()},vC=function(e,t){const r=new Nd;r.setRole(Zs.MENU);for(let a=0;a<e.length;a++){const d=e[a],C=new Md(d.text);C.setRightToLeft(t),C.setRole(Zs.MENUITEM),r.addChild(C),C.setEnabled(d.enabled),d.enabled&&C.onAction(function(){Dc(),d.callback(d.scope)},{})}return r},TC=function(e,t,r){const a=yh();t=new Zt(t.clientY+a.top,t.clientY+a.top,t.clientX+a.left,t.clientX+a.left),SC(e);const d=e.getSize();r&&(t.left+=d.width,t.right+=d.width,a.left+=d.width,a.right+=d.width),Gm(a,t,d,r),e.focus()},SC=function(e){var t=wo();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),ae(t,"blocklyContextMenu"),T(t,"contextmenu",null,$C),e.focus()},$C=function(e){e.preventDefault(),e.stopPropagation()},Dc=function(){Mh(jd),gl=null},rE=function(){fl&&(fl.dispose(),fl=null)},yC=function(e,t){return()=>{Yt();let r;try{r=Io(t,e.workspace);const a=e.getRelativeToSurfaceXY();a.x=e.RTL?a.x-i.config$$module$build$src$core$config.snapRadius:a.x+i.config$$module$build$src$core$config.snapRadius,a.y+=2*i.config$$module$build$src$core$config.snapRadius,r.moveBy(a.x,a.y)}finally{qt()}as()&&!r.isShadow()&&Pe(new(ve(ys))(r)),r.select()}},oE=function(e){return{text:je.REMOVE_COMMENT,enabled:true,callback:function(){He(true),e.dispose(),He(false)}}},aE=function(e){return{text:je.DUPLICATE_COMMENT,enabled:true,callback:function(){Nc(e)}}},RC=function(e,t){const r={enabled:true};return r.text=je.ADD_COMMENT,r.callback=function(){const a=new Ms(e,je.WORKSPACE_COMMENT_DEFAULT_TEXT,Ms.DEFAULT_SIZE,Ms.DEFAULT_SIZE);var d=e.getInjectionDiv().getBoundingClientRect();d=new we(t.clientX-d.left,t.clientY-d.top);const C=e.getOriginOffsetInPixels();d=we.difference(d,C),d.scale(1/e.scale),a.moveBy(d.x,d.y),e.rendered&&(a.initSvg(),a.render(),a.select())},r},zh=function(e,t,r,a,d,C){const M=C.scrollbar&&C.scrollbar.canScrollVertically();return e.horizontal===qo.LEFT?(r=d.absoluteMetrics.left+r,M&&C.RTL&&(r+=jt.scrollbarThickness)):(r=d.absoluteMetrics.left+d.viewMetrics.width-t.width-r,M&&!C.RTL&&(r-=jt.scrollbarThickness)),e.vertical===Gn.TOP?e=d.absoluteMetrics.top+a:(e=d.absoluteMetrics.top+d.viewMetrics.height-t.height-a,C.scrollbar&&C.scrollbar.canScrollHorizontally()&&(e-=jt.scrollbarThickness)),new Zt(e,e+t.height,r,r+t.width)},jh=function(e,t){return{horizontal:t.toolboxMetrics.position===Je.LEFT||e.horizontalLayout&&!e.RTL?qo.RIGHT:qo.LEFT,vertical:t.toolboxMetrics.position===Je.BOTTOM?Gn.TOP:Gn.BOTTOM}},Xh=function(e,t,r,a){const d=e.left,C=e.right-e.left,M=e.bottom-e.top;for(let z=0;z<a.length;z++){const he=a[z];e.intersects(he)&&(e=r===ur.UP?he.top-M-t:he.bottom+t,e=new Zt(e,e+M,d,d+C),z=-1)}return e},lE=function(){It.registry.register({name:gn.ESCAPE,preconditionFn(e){return!e.options.readOnly},callback(e){return e.hideChaff(),true},keyCodes:[xe.ESC]})},cE=function(){It.registry.register({name:gn.DELETE,preconditionFn(e){const t=B();return!e.options.readOnly&&t!=null&&t.isDeletable()},callback(e,t){return t.preventDefault(),pn.inProgress()?false:(B().checkAndDelete(),true)},keyCodes:[xe.DELETE,xe.BACKSPACE]})},uE=function(){const e=It.registry.createSerializedKey(xe.C,[xe.CTRL]),t=It.registry.createSerializedKey(xe.C,[xe.ALT]),r=It.registry.createSerializedKey(xe.C,[xe.META]);It.registry.register({name:gn.COPY,preconditionFn(a){const d=B();return!a.options.readOnly&&!pn.inProgress()&&d!=null&&d.isDeletable()&&d.isMovable()},callback(a,d){return d.preventDefault(),a.hideChaff(),Ua(B()),true},keyCodes:[e,t,r]})},hE=function(){const e=It.registry.createSerializedKey(xe.X,[xe.CTRL]),t=It.registry.createSerializedKey(xe.X,[xe.ALT]),r=It.registry.createSerializedKey(xe.X,[xe.META]);It.registry.register({name:gn.CUT,preconditionFn(a){const d=B();return!a.options.readOnly&&!pn.inProgress()&&d!=null&&d instanceof Li&&d.isDeletable()&&d.isMovable()&&!d.workspace.isFlyout},callback(){const a=B();return a?(Ua(a),a.checkAndDelete(),true):false},keyCodes:[e,t,r]})},dE=function(){const e=It.registry.createSerializedKey(xe.V,[xe.CTRL]),t=It.registry.createSerializedKey(xe.V,[xe.ALT]),r=It.registry.createSerializedKey(xe.V,[xe.META]);It.registry.register({name:gn.PASTE,preconditionFn(a){return!a.options.readOnly&&!pn.inProgress()},callback(){return!!Wh()},keyCodes:[e,t,r]})},_E=function(){const e=It.registry.createSerializedKey(xe.Z,[xe.CTRL]),t=It.registry.createSerializedKey(xe.Z,[xe.ALT]),r=It.registry.createSerializedKey(xe.Z,[xe.META]);It.registry.register({name:gn.UNDO,preconditionFn(a){return!a.options.readOnly&&!pn.inProgress()},callback(a){return a.hideChaff(),a.undo(false),true},keyCodes:[e,t,r]})},pE=function(){const e=It.registry.createSerializedKey(xe.Z,[xe.SHIFT,xe.CTRL]),t=It.registry.createSerializedKey(xe.Z,[xe.SHIFT,xe.ALT]),r=It.registry.createSerializedKey(xe.Z,[xe.SHIFT,xe.META]),a=It.registry.createSerializedKey(xe.Y,[xe.CTRL]);It.registry.register({name:gn.REDO,preconditionFn(d){return!pn.inProgress()&&!d.options.readOnly},callback(d){return d.hideChaff(),d.undo(true),true},keyCodes:[e,t,r,a]})},gE=function(){lE(),cE(),uE(),hE(),dE(),_E(),pE()},ko=function(e){return e.startPublishing!==void 0&&e.stopPublishing!==void 0},IC=function(e){return e.doProcedureUpdate!==void 0},ir=function(e){for(const t of e.getAllBlocks(false))IC(t)&&t.doProcedureUpdate()},Kh=function(e){const t=e.getBlocksByType("procedures_defnoreturn",false).map(function(r){return r.getProcedureDef()});return e=e.getBlocksByType("procedures_defreturn",false).map(function(r){return r.getProcedureDef()}),t.sort(fE),e.sort(fE),[t,e]},fE=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},mE=function(e,t){if(t.isInFlyout)return e;for(e=e||je.UNNAMED_KEY||"unnamed";!CC(e,t.workspace,t);){const r=e.match(/^(.*?)(\d+)$/);e=r?r[1]+(parseInt(r[2])+1):e+"2"}return e},CC=function(e,t,r){return!EE(e,t,r)},EE=function(e,t,r){t=t.getAllBlocks(false);for(let d=0;d<t.length;d++)if(t[d]!==r){var a=t[d];if(a.getProcedureDef&&(a=a.getProcedureDef(),Ni.equals(a[0],e)))return true}return false},OC=function(e){var t=this.getSourceBlock();if(!t)throw new _s;e=e.trim();const r=mE(e,t),a=this.getValue();if(a!==e&&a!==r)for(e=t.workspace.getAllBlocks(false),t=0;t<e.length;t++){const d=e[t];d.renameProcedure&&d.renameProcedure(a,r)}return r},Yh=function(e){function t(C,M){for(let he=0;he<C.length;he++){var z=C[he][0];const ke=C[he][1],ft=ht("block");ft.setAttribute("type",M),ft.setAttribute("gap","16");const Wt=ht("mutation");for(Wt.setAttribute("name",z),ft.appendChild(Wt),z=0;z<ke.length;z++){const vi=ht("arg");vi.setAttribute("name",ke[z]),Wt.appendChild(vi)}r.push(ft)}}const r=[];if(Ys.procedures_defnoreturn){var a=ht("block");a.setAttribute("type","procedures_defnoreturn"),a.setAttribute("gap","16");var d=ht("field");d.setAttribute("name","NAME"),d.appendChild(is(je.PROCEDURES_DEFNORETURN_PROCEDURE)),a.appendChild(d),r.push(a)}return Ys.procedures_defreturn&&(a=ht("block"),a.setAttribute("type","procedures_defreturn"),a.setAttribute("gap","16"),d=ht("field"),d.setAttribute("name","NAME"),d.appendChild(is(je.PROCEDURES_DEFRETURN_PROCEDURE)),a.appendChild(d),r.push(a)),Ys.procedures_ifreturn&&(a=ht("block"),a.setAttribute("type","procedures_ifreturn"),a.setAttribute("gap","16"),r.push(a)),r.length&&r[r.length-1].setAttribute("gap","24"),e=Kh(e),t(e[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),r},bE=function(e){var t=[],r=e.getBlocksByType("procedures_mutatorarg",false);for(let C=0,M;M=r[C];C++)t.push(M.getFieldValue("NAME"));r=ht("xml");const a=ht("block");a.setAttribute("type","procedures_mutatorarg");const d=ht("field");d.setAttribute("name","NAME"),t=cs(a_,t),t=is(t),d.appendChild(t),a.appendChild(d),r.appendChild(a),e.updateToolbox(r)},vE=function(e){if(e.type===xn&&e.bubbleType==="mutator"&&e.isOpen&&e.blockId){e=O(e.workspaceId).getBlockById(e.blockId);var t=e.type;(t==="procedures_defnoreturn"||t==="procedures_defreturn")&&(e=e.mutator.getWorkspace(),bE(e),e.addChangeListener(wC))}},wC=function(e){(e.type===ys||e.type===dn||e.type===vs)&&(e=O(e.workspaceId),bE(e))},TE=function(e,t){const r=[];t=t.getAllBlocks(false);for(let d=0;d<t.length;d++){var a=t[d];a.getProcedureCall&&(a=a.getProcedureCall())&&Ni.equals(a,e)&&r.push(t[d])}return r},kC=function(e){const t=Ls();var r=e.getProcedureDef()[0];const a=e.mutationToDom(true);e=TE(r,e.workspace);for(let C=0,M;M=e[C];C++){r=(r=M.mutationToDom())&&wi(r),M.domToMutation&&M.domToMutation(a);var d=M.mutationToDom();d=d&&wi(d),r!==d&&(As(false),Pe(new(ve(vs))(M,"mutation",null,r,d)),As(t))}},AC=function(e,t){t=t.getAllBlocks(false);for(let a=0;a<t.length;a++){var r=t[a];if(r.getProcedureDef&&(r=r.getProcedureDef())&&Ni.equals(r[0],e))return t[a]}return null},SE=function(e){return e.isDynamic},xc=function(){return tv},LC=function(){o("Blockly.blockRendering.debug.stopDebugger()","version 8","version 10","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)"),tv=false},Fa=function(e,t){Ie(Te.RENDERER,e,t)},NC=function(e){Ht(Te.RENDERER,e)},MC=function(){o("Blockly.blockRendering.stopDebugger()","September 2021","September 2022","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)"),LC()},$E=function(e,t,r){return e=new(on(Te.RENDERER,e))(e),e.init(t,r),e},yE=function(e){kt(e.getTargetWorkspace(),void 0,"String")},RE=function(e){kt(e.getTargetWorkspace(),void 0,"Number")},IE=function(e){kt(e.getTargetWorkspace(),void 0,"Colour")},qh=function(e){let t=[],r=document.createElement("button");return r.setAttribute("text",je.NEW_STRING_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(r),r=document.createElement("button"),r.setAttribute("text",je.NEW_NUMBER_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(r),r=document.createElement("button"),r.setAttribute("text",je.NEW_COLOUR_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(r),e.registerButtonCallback("CREATE_VARIABLE_STRING",yE),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",RE),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",IE),e=CE(e),t=t.concat(e)},CE=function(e){e=e.getAllVariables();const t=[];if(0<e.length){if(Ys.variables_set_dynamic){var r=e[e.length-1];const a=ht("block");a.setAttribute("type","variables_set_dynamic"),a.setAttribute("gap","24"),a.appendChild(Ae(r)),t.push(a)}if(Ys.variables_get_dynamic){e.sort(Za.compareByName);for(let a=0,d;d=e[a];a++)r=ht("block"),r.setAttribute("type","variables_get_dynamic"),r.setAttribute("gap","8"),r.appendChild(Ae(d)),t.push(r)}}return t},DC=function(e){e.resizeContents()},xC=function(e){const t=Object.create(null),r=Or(Te.SERIALIZER,true);for(const a in r){let d;const C=(d=r[a])==null?void 0:d.save(e);C&&(t[a]=C)}return t},BC=function(e,t,{recordUndo:r=false}={}){var a=Or(Te.SERIALIZER,true);if(a){a=Object.entries(a).sort((C,M)=>M[1].priority-C[1].priority);var d=Ls();As(r),(r=Bt())||He(true),Xe(),t instanceof Ji&&t.setResizesEnabled(false);for(const[,C]of a.reverse()){let M;(M=C)==null||M.clear(t)}for(let[C,M]of a.reverse())if(e[C]){let z;(z=M)==null||z.load(e[C],t)}t instanceof Ji&&t.setResizesEnabled(true),Re(),Pe(new(ve(Fo))(t)),He(r),As(d)}},Jh=function(e){const t={id:e.getId(),name:e.getName(),returnTypes:e.getReturnTypes()};return e.getParameters().length&&(t.parameters=e.getParameters().map(r=>Zh(r))),t},Zh=function(e){const t={id:e.getId(),name:e.getName()};return e.getTypes().length&&(t.types=e.getTypes()),t},Qh=function(e,t,r,a){if(e=new e(a,r.name,r.id).setReturnTypes(r.returnTypes),!r.parameters)return e;for(const[d,C]of r.parameters.entries())e.insertParameter(ed(t,C,a),d);return e},ed=function(e,t,r){return e=new e(r,t.name,t.id),t.types&&e.setTypes(t.types),e},Bc=function(e,t,r){const a=r.getBoundingRectangle(),d=a.right-a.left,C=ai(t.top,a.top,t.top+t.height-(a.bottom-a.top))-a.top;let M=t.left;return t=t.left+t.width-d,e.RTL?M=Math.min(t,M):t=Math.max(M,t),(e=ai(M,a.left,t)-a.left)||C?(r.moveBy(e,C),true):false},OE=function(e){return t=>{var r=e.getMetricsManager();if(r.hasFixedEdges()&&!e.isDragging()){var a;if(md.indexOf((a=t.type)!=null?a:"")!==-1){a=r.getScrollMetrics(true);const d=PC(e,t);d&&(r=Bt(),He(t.group),Bc(e,a,d)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),r!==null&&He(r))}else t.type===Gr&&t.scale&&t.oldScale&&t.scale>t.oldScale&&td(e)}}},PC=function(e,t){let r=null;switch(t.type){case ys:case Ps:(r=e.getBlockById(t.blockId))&&(r=r.getRootBlock());break;case Hr:case Bn:r=e.getCommentById(t.commentId)}return r},td=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(true);var r=e.getTopBoundedElements();for(let a=0,d;d=r[a];a++)Bc(e,t,d)}},UC=function(e,t){if(typeof e=="string"&&(e=document.getElementById(e)||document.querySelector(e)),!e||!ce(document,e))throw Error("Error: container is not in current document.");t=new Yi(t||{});const r=document.createElement("div");r.className="injectionDiv",r.tabIndex=0,zt(r,Ft.LABEL,je.WORKSPACE_ARIA_LABEL),e.appendChild(r),e=FC(r,t);const a=new xv(r),d=new Dv(r),C=GC(e,t,a,d);return HC(C),x(C),Z(C),r.addEventListener("focusin",function(){x(C)}),C},FC=function(e,t){e.setAttribute("dir","LTR"),vc(t.hasCss,t.pathToMedia),e=G(te.SVG,{xmlns:No,"xmlns:html":Hi,"xmlns:xlink":qs,version:"1.1",class:"blocklySvg",tabindex:"0"},e);const r=G(te.DEFS,{},e),a=String(Math.random()).substring(2);return t.gridPattern=o_.createDom(a,t.gridOptions,r),e},GC=function(e,t,r,a){t.parentWorkspace=null,t=new Ji(t,r,a),r=t.options,t.scale=r.zoomOptions.startScale,e.appendChild(t.createDom("blocklyMainBackground")),a=t.getInjectionDiv();var d=t.getRenderer().getClassName();return d&&ae(a,d),(d=t.getTheme().getClassName())&&ae(a,d),!r.hasCategories&&r.languageTree&&(a=t.addFlyout(te.SVG),Q(a,e)),r.hasTrashcan&&t.addTrashcan(),r.zoomOptions&&r.zoomOptions.controls&&t.addZoomControls(),t.getThemeManager().subscribe(e,"workspaceBackgroundColour","background-color"),t.translate(0,0),t.addChangeListener(OE(t)),Z(t),Pm(),Qn(),Am(),t},HC=function(e){const t=e.options;var r=e.getParentSvg();if(T(r.parentNode,"contextmenu",null,function(a){$(a)||a.preventDefault()}),r=T(window,"resize",null,function(){e.hideChaff(true),Z(e),td(e)}),e.setResizeHandlerWrapper(r),WC(),t.languageTree){r=e.getToolbox();const a=e.getFlyout(true);r?r.init():a&&(a.init(e),a.show(t.languageTree),typeof a.scrollToStart=="function"&&a.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new S_(e,t.moveOptions.scrollbars===true||!!t.moveOptions.scrollbars.horizontal,t.moveOptions.scrollbars===true||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&zC(t.pathToMedia,e)},VC=function(e){const t=L();t&&!($(e)||t.rendered&&!t.isVisible())&&It.registry.onKeyDown(t,e)},WC=function(){Bv||(T(document,"scroll",null,function(){const e=w();for(let t=0,r;r=e[t];t++)r instanceof Ji&&r.updateInverseScreenCTM()}),T(document,"keydown",null,VC),y(document,"touchend",null,h),y(document,"touchcancel",null,h),Ao&&T(window,"orientationchange",document,function(){Z(L())})),Bv=true},zC=function(e,t){function r(){for(;d.length;)g(d.pop());a.preload()}const a=t.getAudioManager();a.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),a.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),a.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const d=[];d.push(T(document,"pointermove",null,r,true)),d.push(T(document,"touchstart",null,r,true))},wE=function(e,t,r){if(e=e.getProcedureMap().get(t),!e)throw Error("Cannot rename the parameter of a procedure that does not exist in the procedure map");return e.getParameters().find(a=>a.getId()===r)},kE=function(){St.registry.register({displayText(){return je.UNDO},preconditionFn(e){return 0<e.workspace.getUndoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(false)},scopeType:St.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},AE=function(){St.registry.register({displayText(){return je.REDO},preconditionFn(e){return 0<e.workspace.getRedoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(true)},scopeType:St.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},LE=function(){St.registry.register({displayText(){return je.CLEAN_UP},preconditionFn(e){return e.workspace.isMovable()?1<e.workspace.getTopBlocks(false).length?"enabled":"disabled":"hidden"},callback(e){e.workspace.cleanUp()},scopeType:St.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},NE=function(e,t){function r(C){d--,C.setCollapsed(e),d===0&&He(false)}let a=0,d=0;He(true);for(let C=0;C<t.length;C++){let M=t[C];for(;M;)d++,setTimeout(r.bind(null,M),a),M=M.getNextBlock(),a+=10}},ME=function(){St.registry.register({displayText(){return je.COLLAPSE_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(false);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(!r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){NE(true,e.workspace.getTopBlocks(true))},scopeType:St.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},DE=function(){St.registry.register({displayText(){return je.EXPAND_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(false);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){NE(false,e.workspace.getTopBlocks(true))},scopeType:St.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},xE=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(false));else{e=e.getChildren(false);for(let r=0;r<e.length;r++)xE(e[r],t)}},sd=function(e){const t=[];e=e.getTopBlocks(true);for(let r=0;r<e.length;r++)xE(e[r],t);return t},Pc=function(e,t){He(t);const r=e.shift();r&&(r.isDeadOrDying()?Pc(e,t):(r.dispose(false,true),setTimeout(Pc,10,e,t))),He(false)},BE=function(){St.registry.register({displayText(e){return e.workspace?(e=sd(e.workspace).length,e===1?je.DELETE_BLOCK:je.DELETE_X_BLOCKS.replace("%1",String(e))):""},preconditionFn(e){return e.workspace&&0<sd(e.workspace).length?"enabled":"disabled"},callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=sd(e.workspace),r=ui();2>t.length?Pc(t,r):Aa(je.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(a){a&&Pc(t,r)})}},scopeType:St.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},jC=function(){kE(),AE(),LE(),ME(),DE(),BE()},PE=function(){St.registry.register({displayText(){return je.DUPLICATE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(e){e.block&&Nc(e.block)},scopeType:St.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},UE=function(){St.registry.register({displayText(e){return e.block.getCommentIcon()?je.REMOVE_COMMENT:je.ADD_COMMENT},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden"},callback(e){e=e.block,e.getCommentIcon()?e.setCommentText(null):e.setCommentText("")},scopeType:St.ScopeType.BLOCK,id:"blockComment",weight:2})},FE=function(){St.registry.register({displayText(e){return e.block.getInputsInline()?je.EXTERNAL_INPUTS:je.INLINE_INPUTS},preconditionFn(e){if(e=e.block,!e.isInFlyout&&e.isMovable()&&!e.isCollapsed()){for(let t=1;t<e.inputList.length;t++)if(e.inputList[t-1].type!==it.STATEMENT&&e.inputList[t].type!==it.STATEMENT)return"enabled"}return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:St.ScopeType.BLOCK,id:"blockInline",weight:3})},GE=function(){St.registry.register({displayText(e){return e.block.isCollapsed()?je.EXPAND_BLOCK:je.COLLAPSE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:St.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},HE=function(){St.registry.register({displayText(e){return e.block.isEnabled()?je.DISABLE_BLOCK:je.ENABLE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.workspace.options.disable&&e.isEditable()?e.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback(e){e=e.block;const t=Bt();t||He(true),e.setEnabled(!e.isEnabled()),t||He(false)},scopeType:St.ScopeType.BLOCK,id:"blockDisable",weight:5})},VE=function(){St.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(false).length,(t=t.getNextBlock())&&(e-=t.getDescendants(false).length),e===1?je.DELETE_BLOCK:je.DELETE_X_BLOCKS.replace("%1",String(e))},preconditionFn(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback(e){e.block&&e.block.checkAndDelete()},scopeType:St.ScopeType.BLOCK,id:"blockDelete",weight:6})},WE=function(){St.registry.register({displayText(){return je.HELP},preconditionFn(e){return e=e.block,(typeof e.helpUrl=="function"?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block.showHelp()},scopeType:St.ScopeType.BLOCK,id:"blockHelp",weight:7})},XC=function(){PE(),UE(),FE(),GE(),HE(),VE(),WE()},zE=function(){jC(),XC()},KC=function(e){const t=[];e=e.getDescendants(false);for(let r=0,a;a=e[r];r++){const d=a.getIcons();for(let C=0;C<d.length;C++){const M={location:d[C].getIconLocation(),icon:d[C]};t.push(M)}}return t},YC=function(e){L().hideChaff(e)},qC=function(e){o("Blockly.resizeSvgContents","December 2021","December 2022","Blockly.WorkspaceSvg.resizeSvgContents"),DC(e)},JC=function(e){o("Blockly.copy","December 2021","December 2022","Blockly.clipboard.copy"),Ua(e)},ZC=function(){return o("Blockly.paste","December 2021","December 2022","Blockly.clipboard.paste"),!!Wh()},QC=function(e){o("Blockly.duplicate","December 2021","December 2022","Blockly.clipboard.duplicate"),Nc(e)},eO=function(e){return o("Blockly.isNumber","December 2021","December 2022","Blockly.utils.string.isNumber"),wm(e)},tO=function(e){return o("Blockly.hueToHex","December 2021","December 2022","Blockly.utils.colour.hueToHex"),kh(e)},sO=function(e,t,r,a){return o("Blockly.bindEvent_","December 2021","December 2022","Blockly.browserEvents.bind"),y(e,t,r,a)},iO=function(e){return o("Blockly.unbindEvent_","December 2021","December 2022","Blockly.browserEvents.unbind"),g(e)},nO=function(e,t,r,a,d,C){return o("Blockly.bindEventWithChecks_","December 2021","December 2022","Blockly.browserEvents.conditionalBind"),T(e,t,r,a,d)},Ve=Ve||{};Ve.scope={},Ve.ASSUME_ES5=false,Ve.ASSUME_NO_NATIVE_MAP=false,Ve.ASSUME_NO_NATIVE_SET=false,Ve.SIMPLE_FROUND_POLYFILL=false,Ve.ISOLATE_POLYFILLS=false,Ve.FORCE_POLYFILL_PROMISE=false,Ve.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=false,Ve.defineProperty=Ve.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},Ve.getGlobal=function(e){e=[typeof globalThis=="object"&&globalThis,e,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ri=="object"&&Ri];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},Ve.global=Ve.getGlobal(this),Ve.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",Ve.TRUST_ES6_POLYFILLS=!Ve.ISOLATE_POLYFILLS||Ve.IS_SYMBOL_NATIVE,Ve.polyfills={},Ve.propertyToPolyfillSymbol={},Ve.POLYFILL_PREFIX="$jscp$",Ve.polyfill=function(e,t,r,a){t&&(Ve.ISOLATE_POLYFILLS?Ve.polyfillIsolated(e,t,r,a):Ve.polyfillUnisolated(e,t,r,a))},Ve.polyfillUnisolated=function(e,t,r,a){for(r=Ve.global,e=e.split("."),a=0;a<e.length-1;a++){var d=e[a];if(!(d in r))return;r=r[d]}e=e[e.length-1],a=r[e],t=t(a),t!=a&&t!=null&&Ve.defineProperty(r,e,{configurable:true,writable:true,value:t})},Ve.polyfillIsolated=function(e,t,r,a){var d=e.split(".");e=d.length===1,a=d[0],a=!e&&a in Ve.polyfills?Ve.polyfills:Ve.global;for(var C=0;C<d.length-1;C++){var M=d[C];if(!(M in a))return;a=a[M]}d=d[d.length-1],r=Ve.IS_SYMBOL_NATIVE&&r==="es6"?a[d]:null,t=t(r),t!=null&&(e?Ve.defineProperty(Ve.polyfills,d,{configurable:true,writable:true,value:t}):t!==r&&(Ve.propertyToPolyfillSymbol[d]===void 0&&(r=1e9*Math.random()>>>0,Ve.propertyToPolyfillSymbol[d]=Ve.IS_SYMBOL_NATIVE?Ve.global.Symbol(d):Ve.POLYFILL_PREFIX+r+"$"+d),Ve.defineProperty(a,Ve.propertyToPolyfillSymbol[d],{configurable:true,writable:true,value:t})))},Ve.polyfill("globalThis",function(e){return e||Ve.global},"es_2020","es3"),Ve.polyfill("Object.getOwnPropertyDescriptors",function(e){return e||function(t){for(var r={},a=Reflect.ownKeys(t),d=0;d<a.length;d++)r[a[d]]=Object.getOwnPropertyDescriptor(t,a[d]);return r}},"es8","es5"),Ve.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:false,value:e[t++]}:{done:true}}},Ve.arrayIterator=function(e){return{next:Ve.arrayIteratorImpl(e)}},Ve.initSymbol=function(){},Ve.iteratorPrototype=function(e){return e={next:e},e[Symbol.iterator]=function(){return this},e},Ve.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var r=0,a=false,d={next:function(){if(!a&&r<e.length){var C=r++;return{value:t(C,e[C]),done:false}}return a=true,{done:true,value:void 0}}};return d[Symbol.iterator]=function(){return d},d},Ve.polyfill("Array.prototype.values",function(e){return e||function(){return Ve.iteratorFromArray(this,function(t,r){return r})}},"es8","es3"),Ve.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Ve.polyfill("Object.values",function(e){return e||function(t){var r=[],a;for(a in t)Ve.owns(t,a)&&r.push(t[a]);return r}},"es8","es3"),Ve.polyfill("Array.prototype.flat",function(e){return e||function(t){t=t===void 0?1:t;for(var r=[],a=0;a<this.length;a++){var d=this[a];Array.isArray(d)&&0<t?(d=Array.prototype.flat.call(d,t-1),r.push.apply(r,d)):r.push(d)}return r}},"es9","es5"),Ve.polyfill("Object.entries",function(e){return e||function(t){var r=[],a;for(a in t)Ve.owns(t,a)&&r.push([a,t[a]]);return r}},"es8","es3");var Ks=Ks||{};Ks.global=globalThis||root,Ks.define=function(e,t){return t},Ks.DEBUG=false,Ks.DISALLOW_TEST_ONLY_CODE=!Ks.DEBUG,Ks.provide=function(e){},Ks.module=function(e){},Ks.module.get=function(e){},Ks.module.declareLegacyNamespace=function(){},Ks.setTestOnly=function(e){if(Ks.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},Ks.require=function(e){},Ks.requireType=function(e){};var bs={};bs.warn=o;var rO=750,jE="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Uc=null,xr={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Fc=0,gi={};gi.TOUCH_ENABLED=jE,gi.TOUCH_MAP=xr,gi.checkTouchIdentifier=c,gi.clearTouchIdentifier=f,gi.getTouchIdentifierFromEvent=p,gi.isMouseOrTouchEvent=m,gi.isTouchEvent=E,gi.longStart=l,gi.longStop=h,gi.setClientFromTouch=_,gi.shouldHandleEvent=u,gi.splitEventByTouches=b;var id,XE,KE,YE,Gc,Hc,nd,qE,JE,ZE;(function(e){function t(a){return r.indexOf(a.toUpperCase())!==-1}id=e;const r=id.toUpperCase();XE=t("JavaFX"),KE=t("WebKit"),YE=t("Gecko")&&!KE,Gc=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Hc=t("iPad")||t("Macintosh")&&0<e,nd=t("iPhone")&&!Hc,qE=t("Macintosh"),JE=Hc||Gc&&!t("Mobile")||t("Silk"),ZE=!JE&&(nd||Gc)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var oO=id,QE=XE,rd=YE,Vc=Gc,Ao=Hc,eb=nd,od=qE,ad=ZE,Nn={};Nn.ANDROID=Vc,Nn.GECKO=rd,Nn.IPAD=Ao,Nn.IPHONE=eb,Nn.JavaFx=QE,Nn.MAC=od,Nn.MOBILE=ad,Nn.raw=oO;var tb=40,sb=125,Mn={};Mn.bind=y,Mn.conditionalBind=T,Mn.getScrollDeltaPixels=S,Mn.isRightButton=R,Mn.isTargetInput=$,Mn.mouseToSvg=v,Mn.unbind=g;var Ys=Object.create(null),Lo,ib,ld,nb,Br,cd;Lo=Object.create(null),ld=null,Br=[],cd={defineBlocksWithJsonArrayInternal:V},i.module$build$src$core$common={},i.module$build$src$core$common.TEST_ONLY=cd,i.module$build$src$core$common.createBlockDefinitionsFromJsonArray=j,i.module$build$src$core$common.defineBlocks=re,i.module$build$src$core$common.defineBlocksWithJsonArray=P,i.module$build$src$core$common.draggingConnections=Br,i.module$build$src$core$common.getAllWorkspaces=w,i.module$build$src$core$common.getBlockTypeCounts=J,i.module$build$src$core$common.getMainWorkspace=L,i.module$build$src$core$common.getParentContainer=F,i.module$build$src$core$common.getSelected=B,i.module$build$src$core$common.getWorkspaceById=O,i.module$build$src$core$common.registerWorkspace=A,i.module$build$src$core$common.setMainWorkspace=x,i.module$build$src$core$common.setParentContainer=X,i.module$build$src$core$common.setSelected=H,i.module$build$src$core$common.svgResize=Z,i.module$build$src$core$common.unregisterWorkpace=I;var No="http://www.w3.org/2000/svg",Hi="http://www.w3.org/1999/xhtml",qs="http://www.w3.org/1999/xlink",un;(function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_POSITION_CONTAINED_BY=16]="DOCUMENT_POSITION_CONTAINED_BY"})(un||(un={}));var Vi=null,ud=0,Wc=null,ms={};ms.HTML_NS=Hi,ms.NodeType=un,ms.SVG_NS=No,ms.XLINK_NS=qs,ms.addClass=ae,ms.containsNode=ce,ms.createSvgElement=G,ms.getFastTextWidth=Ct,ms.getFastTextWidthWithSizeString=Rt,ms.getTextWidth=_t,ms.hasClass=ee,ms.insertAfter=Q,ms.measureFontMetrics=ct,ms.removeClass=fe,ms.removeClasses=de,ms.removeNode=W,ms.setCssTransform=Ee,ms.startTextWidthCache=Xe,ms.stopTextWidthCache=Re;var zc={};zc.clamp=ai,zc.toDegrees=Ui,zc.toRadians=Ut;var Zt=class{constructor(e,t,r,a){this.top=e,this.bottom=t,this.left=r,this.right=a}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return!(this.left>e.right||this.right<e.left||this.top>e.bottom||this.bottom<e.top)}},we=class{constructor(e,t){this.x=e,this.y=t}clone(){return new we(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t?true:e&&t?e.x===t.x&&e.y===t.y:false}static distance(e,t){const r=e.x-t.x;return e=e.y-t.y,Math.sqrt(r*r+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new we(e.x-t.x,e.y-t.y)}static sum(e,t){return new we(e.x+t.x,e.y+t.y)}},Ts=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t?true:e&&t?e.width===t.width&&e.height===t.height:false}},rb={getSizeInternal:ci},hn={};hn.TEST_ONLY=rb,hn.getBorderBox=ts,hn.getCascadedStyle=$e,hn.getComputedStyle=Es,hn.getContainerOffsetToScrollInto=Zn,hn.getPageOffset=rt,hn.getSize=li,hn.getViewportPageOffset=pt,hn.scrollIntoContainerView=ye;var Ga=16,hd=1,ob=12,dd=16,jc=.25,_d=null,Pr=null,Mo="",Do="",vt,xo,Ur,pd=null,nr=null,ab=null,gd={getBoundsInfo:function(){const e=rt(pd),t=li(pd);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,r,a){const d=gd.getBoundsInfo(),C=li(vt);return t+C.height<d.bottom?wa(e,t,d,C):a-C.height>d.top?kn(r,a,d,C):t+C.height<document.documentElement.clientHeight?wa(e,t,d,C):a-C.height>document.documentElement.clientTop?kn(r,a,d,C):K(e,d,C)}},ns={};ns.ANIMATION_TIME=jc,ns.ARROW_HORIZONTAL_PADDING=ob,ns.ARROW_SIZE=Ga,ns.BORDER_SIZE=hd,ns.PADDING_Y=dd,ns.TEST_ONLY=gd,ns.clearContent=ss,ns.createDom=Qn,ns.getContentDiv=Ot,ns.getOwner=er,ns.getPositionX=pe,ns.hide=Gt,ns.hideIfOwner=qe,ns.hideWithoutAnimation=wt,ns.isVisible=Le,ns.repositionForWindowResize=Be,ns.setBoundsElement=Fi,ns.setColour=N,ns.show=wn,ns.showPositionedByBlock=U,ns.showPositionedByField=q;var rr=Object.create(null),aO={typeMap:rr},Xc=Object.create(null),Dn="default",Te=class{constructor(e){this.name=e}toString(){return this.name}};Te.CONNECTION_CHECKER=new Te("connectionChecker"),Te.CURSOR=new Te("cursor"),Te.EVENT=new Te("event"),Te.FIELD=new Te("field"),Te.RENDERER=new Te("renderer"),Te.TOOLBOX=new Te("toolbox"),Te.THEME=new Te("theme"),Te.TOOLBOX_ITEM=new Te("toolboxItem"),Te.FLYOUTS_VERTICAL_TOOLBOX=new Te("flyoutsVerticalToolbox"),Te.FLYOUTS_HORIZONTAL_TOOLBOX=new Te("flyoutsHorizontalToolbox"),Te.METRICS_MANAGER=new Te("metricsManager"),Te.BLOCK_DRAGGER=new Te("blockDragger"),Te.SERIALIZER=new Te("serializer");var Wi={};Wi.DEFAULT=Dn,Wi.TEST_ONLY=aO,Wi.Type=Te,Wi.getAllItems=Or,Wi.getClass=on,Wi.getClassFromOptions=js,Wi.getObject=Eo,Wi.hasItem=mo,Wi.register=Ie,Wi.unregister=Ht;var lb="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",cb={genUid:()=>{const e=lb.length,t=[];for(let r=0;20>r;r++)t[r]=lb.charAt(Math.random()*e);return t.join("")}},lO=0,Kc={};Kc.TEST_ONLY=cb,Kc.genUid=ui,Kc.getNextUniqueId=wr;var ub="",Ha=true,fd=0,ys="create",dn="delete",vs="change",Ps="move",Fr="var_create",Bo="var_delete",Va="var_rename",Wa="ui",Po="drag",or="selected",ar="click",za="marker_move",xn="bubble_open",ja="trashcan_open",Xa="toolbox_item_select",Ka="theme_change",Gr="viewport_change",Hr="comment_create",Uo="comment_delete",Ya="comment_change",Bn="comment_move",Fo="finished_loading",Yc="procedure_create",qa="procedure_delete",qc="procedure_rename",Jc="procedure_enable",Zc="procedure_change_return",Qc="procedure_parameter_create",eu="procedure_parameter_delete",tu="procedure_parameter_rename",md=[ys,Ps,Hr,Bn],Go=[],Ed={FIRE_QUEUE:Go,fireNow:mc,fireInternal:Th,setGroupInternal:vo},Ke={};Ke.BLOCK_CHANGE=vs,Ke.BLOCK_CREATE=ys,Ke.BLOCK_DELETE=dn,Ke.BLOCK_DRAG=Po,Ke.BLOCK_MOVE=Ps,Ke.BUBBLE_OPEN=xn,Ke.BUMP_EVENTS=md,Ke.CHANGE=vs,Ke.CLICK=ar,Ke.COMMENT_CHANGE=Ya,Ke.COMMENT_CREATE=Hr,Ke.COMMENT_DELETE=Uo,Ke.COMMENT_MOVE=Bn,Ke.CREATE=ys,Ke.DELETE=dn,Ke.FINISHED_LOADING=Fo,Ke.MARKER_MOVE=za,Ke.MOVE=Ps,Ke.PROCEDURE_CHANGE_RETURN=Zc,Ke.PROCEDURE_CREATE=Yc,Ke.PROCEDURE_DELETE=qa,Ke.PROCEDURE_ENABLE=Jc,Ke.PROCEDURE_PARAMETER_CREATE=Qc,Ke.PROCEDURE_PARAMETER_DELETE=eu,Ke.PROCEDURE_PARAMETER_RENAME=tu,Ke.PROCEDURE_RENAME=qc,Ke.SELECTED=or,Ke.TEST_ONLY=Ed,Ke.THEME_CHANGE=Ka,Ke.TOOLBOX_ITEM_SELECT=Xa,Ke.TRASHCAN_OPEN=ja,Ke.UI=Wa,Ke.VAR_CREATE=Fr,Ke.VAR_DELETE=Bo,Ke.VAR_RENAME=Va,Ke.VIEWPORT_CHANGE=Gr,Ke.clearPendingUndo=Ci,Ke.disable=Yt,Ke.disableOrphans=Nt,Ke.enable=qt,Ke.filter=bo,Ke.fire=Pe,Ke.fromJson=Oe,Ke.get=ve,Ke.getDescendantIds=To,Ke.getGroup=Bt,Ke.getRecordUndo=Ls,Ke.isEnabled=as,Ke.setGroup=He,Ke.setRecordUndo=As;var it;(function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY"})(it||(it={})),i.module$build$src$core$input_types={},i.module$build$src$core$input_types.inputTypes=it;var Vr,su,iu,bd;({document:Vr,DOMParser:su,XMLSerializer:iu}=globalThis),bd="https://developers.google.com/blockly/xml",i.module$build$src$core$utils$xml={},i.module$build$src$core$utils$xml.NAME_SPACE=bd,i.module$build$src$core$utils$xml.createElement=ht,i.module$build$src$core$utils$xml.createTextNode=is,i.module$build$src$core$utils$xml.domToText=ka,i.module$build$src$core$utils$xml.getDocument=hi,i.module$build$src$core$utils$xml.injectDependencies=ls,i.module$build$src$core$utils$xml.setDocument=an,i.module$build$src$core$utils$xml.textToDomDocument=di;var hb=function(e,t){window.alert(e),t&&t()},db=function(e,t){t(window.confirm(e))},_b=function(e,t,r){r(window.prompt(e,t))},pb={confirmInternal:Sh},Js={};Js.TEST_ONLY=pb,Js.alert=kr,Js.confirm=Aa,Js.prompt=La,Js.setAlert=Ec,Js.setConfirm=$h,Js.setPrompt=So;var je,vd;je=Object.create(null),vd=function(e){Object.keys(e).forEach(function(t){je[t]=e[t]})},i.module$build$src$core$msg={},i.module$build$src$core$msg.Msg=je,i.module$build$src$core$msg.setLocale=vd;var Wr=class{constructor(){this.workspaceId=void 0,this.isUiEvent=false,this.type="",this.group=Bt(),this.recordUndo=Ls()}toJson(){return{type:this.type,group:this.group}}fromJson(e){this.isBlank=false,this.group=e.group||""}static fromJson(e,t,r){return o("Blockly.Events.Abstract.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),r.isBlank=false,r.group=e.group||"",r.workspaceId=t.id,r}isNull(){return false}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=O(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},Ja=class extends Wr{constructor(e){super(),this.isBlank=typeof e>"u",e&&(this.varId=e.getId(),this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}fromJson(e){o("Blockly.Events.VarBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.varId=e.varId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Ja),t.varId=e.varId,t}},Td=class extends Ja{constructor(e){super(e),this.type=Fr,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}fromJson(e){o("Blockly.Events.VarCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.varType=e.varType,this.varName=e.varName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Td),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.createVariable(this.varName,this.varType,this.varId):t.deleteVariableById(this.varId)}};Ie(Te.EVENT,Fr,Td);var Za=class{constructor(e,t,r,a){this.workspace=e,this.name=t,this.type=r||"",this.id_=a||ui()}getId(){return this.id_}static compareByName(e,t){return e.name.localeCompare(t.name,void 0,{sensitivity:"base"})}},nu,ru,Sd;nu="VARIABLE",ru="ijkmnopqrstuvwxyzabcdefgh",Sd={generateUniqueNameInternal:bc},i.module$build$src$core$variables={},i.module$build$src$core$variables.CATEGORY_NAME=nu,i.module$build$src$core$variables.TEST_ONLY=Sd,i.module$build$src$core$variables.VAR_LETTER_OPTIONS=ru,i.module$build$src$core$variables.allDeveloperVariables=Oi,i.module$build$src$core$variables.allUsedVarModels=$o,i.module$build$src$core$variables.createVariableButtonHandler=kt,i.module$build$src$core$variables.flyoutCategory=Na,i.module$build$src$core$variables.flyoutCategoryBlocks=yo,i.module$build$src$core$variables.generateUniqueName=st,i.module$build$src$core$variables.generateUniqueNameFromOptions=cs,i.module$build$src$core$variables.generateVariableFieldDom=Ae,i.module$build$src$core$variables.getAddedVariables=fs,i.module$build$src$core$variables.getOrCreateVariablePackage=Fe,i.module$build$src$core$variables.getVariable=nt,i.module$build$src$core$variables.nameUsedWithAnyType=Ro,i.module$build$src$core$variables.promptName=Gi,i.module$build$src$core$variables.renameVariable=Ar;var _n=class{constructor(e,t,r,a,d){this.workspace=e,this.editable_=this.movable_=this.deletable_=true,this.disposed_=false,this.isComment=true,this.id=d&&!e.getCommentById(d)?d:ui(),e.addTopComment(this),this.xy_=new we(0,0),this.height_=r,this.width_=a,this.RTL=e.RTL,this.content_=t,_n.fireCreateEvent(this)}dispose(){this.disposed_||(as()&&Pe(new(ve(Uo))(this)),this.workspace.removeTopComment(this),this.disposed_=true)}getHeight(){return this.height_}setHeight(e){this.height_=e}getWidth(){return this.width_}setWidth(e){this.width_=e}getXY(){return new we(this.xy_.x,this.xy_.y)}moveBy(e,t){const r=new(ve(Bn))(this);this.xy_.translate(e,t),r.recordNew(),Pe(r)}isDeletable(){return this.deletable_&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(e){this.deletable_=e}isMovable(){return this.movable_&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(e){this.movable_=e}isEditable(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(e){this.editable_=e}getContent(){return this.content_}setContent(e){this.content_!==e&&(Pe(new(ve(Ya))(this,this.content_,e)),this.content_=e)}toXmlWithXY(e){return e=this.toXml(e),e.setAttribute("x",`${Math.round(this.xy_.x)}`),e.setAttribute("y",`${Math.round(this.xy_.y)}`),e.setAttribute("h",`${this.height_}`),e.setAttribute("w",`${this.width_}`),e}toXml(e){const t=ht("comment");return e||(t.id=this.id),t.textContent=this.getContent(),t}static fireCreateEvent(e){if(as()){const t=Bt();t||He(true);try{Pe(new(ve(Hr))(e))}finally{t||He(false)}}}static fromXml(e,t){var r=_n.parseAttributes(e);return t=new _n(t,r.content,r.h,r.w,r.id),r=e.getAttribute("x"),e=e.getAttribute("y"),r=r?parseInt(r,10):NaN,e=e?parseInt(e,10):NaN,isNaN(r)||isNaN(e)||t.moveBy(r,e),_n.fireCreateEvent(t),t}static parseAttributes(e){const t=e.getAttribute("h"),r=e.getAttribute("w"),a=e.getAttribute("x"),d=e.getAttribute("y"),C=e.getAttribute("id");if(!C)throw Error("No ID present in XML comment definition.");let M;return{id:C,h:t?parseInt(t):100,w:r?parseInt(r):100,x:a?parseInt(a):NaN,y:d?parseInt(d):NaN,content:(M=e.textContent)!=null?M:""}}},zi=class extends Wr{constructor(e){super(),this.isBlank=true,this.recordUndo=false,this.isUiEvent=true,this.isBlank=typeof e>"u",this.workspaceId=e||""}},$d=class extends zi{constructor(e,t,r){super(r),this.type=or,this.oldElementId=e??void 0,this.newElementId=t??void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}fromJson(e){o("Blockly.Events.Selected.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldElementId=e.oldElementId,this.newElementId=e.newElementId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new $d),t.oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};Ie(Te.EVENT,or,$d);var yd=false,Rd=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
}

.blocklyNonSelectable {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.blocklyWsDragSurface {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
}

/* Added as a separate rule with multiple classes to make it more specific
   than a bootstrap rule that selects svg:root. See issue #1275 for context.
*/
.blocklyWsDragSurface.blocklyOverflowVisible {
  overflow: visible;
}

.blocklyBlockDragSurface {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: visible !important;
  z-index: 50;  /* Display below toolbox, but above everything else. */
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
  overflow: auto;
  overflow-x: hidden;
  position: relative;
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
}

.blocklyDropDownButton {
  display: inline-block;
  float: left;
  padding: 0;
  margin: 4px;
  border-radius: 4px;
  outline: none;
  border: 1px solid;
  transition: box-shadow .1s;
  cursor: pointer;
}

.blocklyArrowTop {
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyArrowBottom {
  border-bottom: 1px solid;
  border-right: 1px solid;
  border-bottom-right-radius: 4px;
  border-color: inherit;
}

.blocklyResizeSE {
  cursor: se-resize;
  fill: #aaa;
}

.blocklyResizeSW {
  cursor: sw-resize;
  fill: #aaa;
}

.blocklyResizeLine {
  stroke: #515A5A;
  stroke-width: 1;
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  /* backup for browsers (e.g. IE11) that don't support grab */
  cursor: url("<<<PATH>>>/handopen.cur"), auto;
  cursor: grab;
  cursor: -webkit-grab;
}

  /* backup for browsers (e.g. IE11) that don't support grabbing */
.blocklyDragging {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Change the cursor on the whole drag surface in case the mouse gets
   ahead of block during a drag. This way the cursor is still a closed hand.
  */
.blocklyBlockDragSurface .blocklyDraggable {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabled>.blocklyPath {
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyMultilineText {
  font-family: monospace;
}

.blocklyNonEditableText>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

/*
  Don't allow users to select text.  It gets annoying when trying to
  drag a block and selected text moves instead.
*/
.blocklySvg text,
.blocklyBlockDragSurface text {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  cursor: inherit;
}

.blocklyHidden {
  display: none;
}

.blocklyFieldDropdown:not(.blocklyHidden) {
  display: block;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Edge and IE introduce a close icon when the input value is longer than a
   certain length. This affects our sizing calculations of the text input.
   Hiding the close icon to avoid that. */
.blocklyHtmlInput::-ms-clear {
  display: none;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  position: relative;  /* Compatibility with gapi, reset from goog-menu */
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}
`,Id={};Id.inject=vc,Id.register=us;var te=class{constructor(e){this.tagName=e}toString(){return this.tagName}};te.ANIMATE=new te("animate"),te.CIRCLE=new te("circle"),te.CLIPPATH=new te("clipPath"),te.DEFS=new te("defs"),te.FECOMPOSITE=new te("feComposite"),te.FECOMPONENTTRANSFER=new te("feComponentTransfer"),te.FEFLOOD=new te("feFlood"),te.FEFUNCA=new te("feFuncA"),te.FEGAUSSIANBLUR=new te("feGaussianBlur"),te.FEPOINTLIGHT=new te("fePointLight"),te.FESPECULARLIGHTING=new te("feSpecularLighting"),te.FILTER=new te("filter"),te.FOREIGNOBJECT=new te("foreignObject"),te.G=new te("g"),te.IMAGE=new te("image"),te.LINE=new te("line"),te.PATH=new te("path"),te.PATTERN=new te("pattern"),te.POLYGON=new te("polygon"),te.RECT=new te("rect"),te.SVG=new te("svg"),te.TEXT=new te("text"),te.TSPAN=new te("tspan");var gb=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,fb=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,cO={XY_REGEX:gb,XY_STYLE_REGEX:fb},lr={};lr.TEST_ONLY=cO,lr.getDocumentScroll=Rh,lr.getInjectionDivXY=Tc,lr.getRelativeXY=_i,lr.getViewportBBox=yh,lr.is3dSupported=bm,lr.screenToWsCoordinates=vm;var Rs=8,ou=3,uO=2,Ms=class extends _n{constructor(e,t,r,a,d){super(e,t,r,a,d),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.eventsInit_=false,this.deleteIconBorder_=this.deleteGroup_=this.resizeGroup_=this.foreignObject_=this.svgHandleTarget_=this.svgRectTarget_=this.textarea_=null,this.rendered_=this.autoLayout_=this.focused_=false,this.svgGroup_=G(te.G,{class:"blocklyComment"}),this.svgGroup_.translate_="",this.workspace=e,this.svgRect_=G(te.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:ou,ry:ou}),this.svgGroup_.appendChild(this.svgRect_),this.useDragSurface_=!!e.getBlockDragSurface(),this.render()}dispose(){this.disposed_||(B()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),as()&&Pe(new(ve(Uo))(this)),W(this.svgGroup_),this.disposeInternal_(),Yt(),super.dispose(),qt())}initSvg(e){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit_||(T(this.svgRectTarget_,"pointerdown",this,this.pathMouseDown_),T(this.svgHandleTarget_,"pointerdown",this,this.pathMouseDown_)),this.eventsInit_=true,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!e&&this.textarea_&&this.textarea_.select()}pathMouseDown_(e){const t=this.workspace.getGesture(e);t&&t.handleBubbleStart(e,this)}showContextMenu(e){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts")}select(){if(B()!==this){var e=null;if(B()){e=B().id,Yt();try{B().unselect()}finally{qt()}}e=new(ve(or))(e,this.id,this.workspace.id),Pe(e),H(this),this.addSelect()}}unselect(){if(B()===this){var e=new(ve(or))(this.id,null,this.workspace.id);Pe(e),H(null),this.removeSelect(),this.blurFocus()}}addSelect(){ae(this.svgGroup_,"blocklySelected"),this.setFocus()}removeSelect(){ae(this.svgGroup_,"blocklySelected"),this.blurFocus()}addFocus(){ae(this.svgGroup_,"blocklyFocused")}removeFocus(){fe(this.svgGroup_,"blocklyFocused")}getRelativeToSurfaceXY(){let e=0,t=0;const r=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;let a=this.getSvgRoot();if(a)do{var d=_i(a);e+=d.x,t+=d.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===a&&(d=this.workspace.getBlockDragSurface().getSurfaceTranslation(),e+=d.x,t+=d.y),a=a.parentNode}while(a&&a!==this.workspace.getBubbleCanvas()&&a!==r);return this.xy_=new we(e,t)}moveBy(e,t){const r=new(ve(Bn))(this),a=this.getRelativeToSurfaceXY();this.translate(a.x+e,a.y+t),this.xy_=new we(a.x+e,a.y+t),r.recordNew(),Pe(r),this.workspace.resizeContents()}translate(e,t){this.xy_=new we(e,t),this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")}moveToDragSurface(){if(this.useDragSurface_){var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(e.x,e.y),this.workspace.getBlockDragSurface().setBlocksAndShow(this.getSvgRoot())}}moveDuringDrag(e,t){e?e.translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))}moveTo(e,t){this.translate(e,t)}clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform")}getBoundingRectangle(){var e=this.getRelativeToSurfaceXY();const t=this.getHeightWidth(),r=e.y,a=e.y+t.height;let d;return this.RTL?(d=e.x-t.width,e=e.x):(d=e.x,e=e.x+t.width),new Zt(r,a,d,e)}updateMovable(){this.isMovable()?ae(this.svgGroup_,"blocklyDraggable"):fe(this.svgGroup_,"blocklyDraggable")}setMovable(e){super.setMovable(e),this.updateMovable()}setEditable(e){super.setEditable(e),this.textarea_&&(this.textarea_.readOnly=!e)}setDragging(e){e?(e=this.getSvgRoot(),e.translate_="",e.skew_="",ae(this.svgGroup_,"blocklyDragging")):fe(this.svgGroup_,"blocklyDragging")}getSvgRoot(){return this.svgGroup_}getContent(){return this.textarea_?this.textarea_.value:this.content_}setContent(e){super.setContent(e),this.textarea_&&(this.textarea_.value=e)}setDeleteStyle(e){e?ae(this.svgGroup_,"blocklyDraggingDelete"):fe(this.svgGroup_,"blocklyDraggingDelete")}setAutoLayout(e){}toXmlWithXY(e){let t=0;this.workspace.RTL&&(t=this.workspace.getWidth()),e=this.toXml(e);const r=this.getRelativeToSurfaceXY();return e.setAttribute("x",Math.round(this.workspace.RTL?t-r.x:r.x)),e.setAttribute("y",Math.round(r.y)),e.setAttribute("h",this.getHeight()),e.setAttribute("w",this.getWidth()),e}toCopyData(){return{saveInfo:this.toXmlWithXY(),source:this.workspace,typeCounts:null}}getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()}}render(){if(!this.rendered_){var e=this.getHeightWidth();this.createEditor_(),this.svgGroup_.appendChild(this.foreignObject_),this.svgHandleTarget_=G(te.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup_.appendChild(this.svgHandleTarget_),this.svgRectTarget_=G(te.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:ou,ry:ou}),this.svgGroup_.appendChild(this.svgRectTarget_),this.addResizeDom_(),this.isDeletable()&&this.addDeleteDom_(),this.setSize_(e.width,e.height),this.textarea_.value=this.content_,this.rendered_=true,this.resizeGroup_&&T(this.resizeGroup_,"pointerdown",this,this.resizeMouseDown_),this.isDeletable()&&(T(this.deleteGroup_,"pointerdown",this,this.deleteMouseDown_),T(this.deleteGroup_,"pointerout",this,this.deleteMouseOut_),T(this.deleteGroup_,"pointerup",this,this.deleteMouseUp_))}}createEditor_(){this.foreignObject_=G(te.FOREIGNOBJECT,{x:0,y:Ms.TOP_OFFSET,class:"blocklyCommentForeignObject"});const e=document.createElementNS(Hi,"body");e.setAttribute("xmlns",Hi),e.className="blocklyMinimalBody";const t=document.createElementNS(Hi,"textarea");return t.className="blocklyCommentTextarea",t.setAttribute("dir",this.RTL?"RTL":"LTR"),t.readOnly=!this.isEditable(),e.appendChild(t),this.textarea_=t,this.foreignObject_.appendChild(e),T(t,"wheel",this,function(r){r.stopPropagation()}),T(t,"change",this,function(r){this.setContent(t.value)}),this.foreignObject_}addResizeDom_(){this.resizeGroup_=G(te.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup_),G(te.POLYGON,{points:"0,x x,x x,0".replace(/x/g,Rs.toString())},this.resizeGroup_),G(te.LINE,{class:"blocklyResizeLine",x1:Rs/3,y1:Rs-1,x2:Rs-1,y2:Rs/3},this.resizeGroup_),G(te.LINE,{class:"blocklyResizeLine",x1:2*Rs/3,y1:Rs-1,x2:Rs-1,y2:2*Rs/3},this.resizeGroup_)}addDeleteDom_(){this.deleteGroup_=G(te.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup_),this.deleteIconBorder_=G(te.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup_),G(te.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup_),G(te.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup_)}resizeMouseDown_(e){this.unbindDragEvents_(),R(e)||(this.workspace.startDrag(e,new we(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper_=T(document,"pointerup",this,this.resizeMouseUp_),this.onMouseMoveWrapper_=T(document,"pointermove",this,this.resizeMouseMove_),this.workspace.hideChaff()),e.stopPropagation()}deleteMouseDown_(e){this.deleteIconBorder_&&ae(this.deleteIconBorder_,"blocklyDeleteIconHighlighted"),e.stopPropagation()}deleteMouseOut_(e){this.deleteIconBorder_&&fe(this.deleteIconBorder_,"blocklyDeleteIconHighlighted")}deleteMouseUp_(e){this.dispose(),e.stopPropagation()}unbindDragEvents_(){this.onMouseUpWrapper_&&(g(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(g(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}resizeMouseUp_(e){f(),this.unbindDragEvents_()}resizeMouseMove_(e){this.autoLayout_=false,e=this.workspace.moveDrag(e),this.setSize_(this.RTL?-e.x:e.x,e.y)}resizeComment_(){const e=this.getHeightWidth(),t=Ms.TOP_OFFSET,r=2*uO;this.foreignObject_.setAttribute("width",e.width),this.foreignObject_.setAttribute("height",(e.height-t).toString()),this.RTL&&this.foreignObject_.setAttribute("x",(-e.width).toString()),this.textarea_.style.width=e.width-r+"px",this.textarea_.style.height=e.height-r-t+"px"}setSize_(e,t){e=Math.max(e,45),t=Math.max(t,20+Ms.TOP_OFFSET),this.width_=e,this.height_=t,this.svgRect_.setAttribute("width",e),this.svgRect_.setAttribute("height",t),this.svgRectTarget_.setAttribute("width",e),this.svgRectTarget_.setAttribute("height",t),this.svgHandleTarget_.setAttribute("width",e),this.svgHandleTarget_.setAttribute("height",Ms.TOP_OFFSET),this.RTL&&(this.svgRect_.setAttribute("transform","scale(-1 1)"),this.svgRectTarget_.setAttribute("transform","scale(-1 1)")),this.resizeGroup_&&(this.RTL?(this.resizeGroup_.setAttribute("transform","translate("+(-e+Rs)+","+(t-Rs)+") scale(-1 1)"),this.deleteGroup_.setAttribute("transform","translate("+(-e+Rs)+","+-Rs+") scale(-1 1)")):(this.resizeGroup_.setAttribute("transform","translate("+(e-Rs)+","+(t-Rs)+")"),this.deleteGroup_.setAttribute("transform","translate("+(e-Rs)+","+-Rs+")"))),this.resizeComment_()}disposeInternal_(){this.svgHandleTarget_=this.svgRectTarget_=this.foreignObject_=this.textarea_=null,this.disposed_=true}setFocus(){this.focused_=true,setTimeout(()=>{this.disposed_||(this.textarea_.focus(),this.addFocus(),this.svgRectTarget_&&ae(this.svgRectTarget_,"blocklyCommentTargetFocused"),this.svgHandleTarget_&&ae(this.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))},0)}blurFocus(){this.focused_=false,setTimeout(()=>{this.disposed_||(this.textarea_.blur(),this.removeFocus(),this.svgRectTarget_&&fe(this.svgRectTarget_,"blocklyCommentTargetFocused"),this.svgHandleTarget_&&fe(this.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))},0)}static fromXmlRendered(e,t,r){Yt();let a;try{const d=_n.parseAttributes(e);if(a=new Ms(t,d.content,d.h,d.w,d.id),t.rendered&&(a.initSvg(true),a.render()),!isNaN(d.x)&&!isNaN(d.y))if(t.RTL){const C=r||t.getWidth();a.moveBy(C-d.x,d.y)}else a.moveBy(d.x,d.y)}finally{qt()}return _n.fireCreateEvent(a),a}};Ms.DEFAULT_SIZE=100,Ms.TOP_OFFSET=10,us(`
.blocklyCommentForeignObject {
  position: relative;
  z-index: 0;
}

.blocklyCommentRect {
  fill: #E7DE8E;
  stroke: #bcA903;
  stroke-width: 1px;
}

.blocklyCommentTarget {
  fill: transparent;
  stroke: #bcA903;
}

.blocklyCommentTargetFocused {
  fill: none;
}

.blocklyCommentHandleTarget {
  fill: none;
}

.blocklyCommentHandleTargetFocused {
  fill: transparent;
}

.blocklyFocused>.blocklyCommentRect {
  fill: #B9B272;
  stroke: #B9B272;
}

.blocklySelected>.blocklyCommentTarget {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCommentDeleteIcon {
  cursor: pointer;
  fill: #000;
  display: none;
}

.blocklySelected > .blocklyCommentDeleteIcon {
  display: block;
}

.blocklyDeleteIconShape {
  fill: #000;
  stroke: #000;
  stroke-width: 1px;
}

.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {
  stroke: #fc3;
}
`),i.module$build$src$core$xml={},i.module$build$src$core$xml.appendDomToWorkspace=V0,i.module$build$src$core$xml.blockToDom=Lr,i.module$build$src$core$xml.blockToDomWithXY=Sc,i.module$build$src$core$xml.clearWorkspaceAndLoadFromXml=H0,i.module$build$src$core$xml.deleteNext=Z0,i.module$build$src$core$xml.domToBlock=Io,i.module$build$src$core$xml.domToPrettyText=G0,i.module$build$src$core$xml.domToText=wi,i.module$build$src$core$xml.domToVariables=$m,i.module$build$src$core$xml.domToWorkspace=Da,i.module$build$src$core$xml.textToDom=Bs,i.module$build$src$core$xml.variablesToDom=Tm,i.module$build$src$core$xml.workspaceToDom=P0;var Ho=class extends Wr{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}fromJson(e){o("Blockly.Events.BlockBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.blockId=e.blockId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Ho),t.blockId=e.blockId,t}},zr=class extends Ho{constructor(e,t,r,a,d){super(e),this.type=vs,e&&(this.element=t,this.name=r||void 0,this.oldValue=a,this.newValue=d)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}fromJson(e){o("Blockly.Events.BlockChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.element=e.element,this.name=e.name,this.oldValue=e.oldValue,this.newValue=e.newValue}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new zr),t.element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(t=t.getBlockById(this.blockId),!t)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");switch(t.mutator&&t.mutator.setVisible(false),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":t.setEnabled(!e);break;case"inline":t.setInputsInline(!!e);break;case"mutation":const r=zr.getExtraBlockState_(t);t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(Bs(e||"<mutation/>")),Pe(new zr(t,"mutation",null,r,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState())?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?wi(e):""}};Ie(Te.EVENT,vs,zr);var Qa=class{constructor(e){this.workspace=e,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),t.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,t)),this.setMarkerSvg(t.getDrawer().createDom()),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(t)t.dispose(),this.markers.delete(e);else throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor_}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=e)&&(e=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(e),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(e){e?(this.workspace.getBlockCanvas().appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null}setMarkerSvg(e){e?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(e,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(e)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const e=Object.keys(this.markers);for(let t=0,r;r=e[t];t++)this.unregisterMarker(r);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};Qa.LOCAL_MARKER="local_marker_1",i.module$build$src$core$utils$string={},i.module$build$src$core$utils$string.commonWordPrefix=Rm,i.module$build$src$core$utils$string.commonWordSuffix=Im,i.module$build$src$core$utils$string.isNumber=wm,i.module$build$src$core$utils$string.shortestStringLength=$c,i.module$build$src$core$utils$string.startsWith=Q0,i.module$build$src$core$utils$string.wrap=Cm;var au=void 0,el=false,Vo=false,mb=50,Eb=0,tl=0,Cd=0,Od=0,Ai=null,sl=null,wd=0,kd=10,bb=10,vb=750,lu=5,ds=null,rs={};rs.HOVER_MS=vb,rs.LIMIT=mb,rs.MARGINS=lu,rs.OFFSET_X=wd,rs.OFFSET_Y=kd,rs.RADIUS_OK=bb,rs.bindMouseEvents=yc,rs.block=Mm,rs.createDom=Am,rs.dispose=Nm,rs.getCustomTooltip=iI,rs.getDiv=rI,rs.getTooltipOfObject=xa,rs.hide=Nr,rs.isVisible=nI,rs.setCustomTooltip=sI,rs.unbindMouseEvents=Rc,rs.unblock=Dm;var Ad=.45,Ld=.65,Tb={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Ds={};Ds.blend=Co,Ds.getHsvSaturation=xm,Ds.getHsvValue=Bm,Ds.hexToRgb=Oh,Ds.hsvToHex=wh,Ds.hueToHex=kh,Ds.names=Tb,Ds.parse=Mr,Ds.rgbToHex=Ic,Ds.setHsvSaturation=dI,Ds.setHsvValue=_I;var il={};il.checkMessageReferences=Cc,il.parseBlockColour=Oo,il.replaceMessageReferences=Jt,il.tokenizeInterpolation=Lh;var hO=class{},cu=null,uu=null,Wo="",zo="",ji,Xi={};Xi.createDom=Pm,Xi.getDiv=wo,Xi.hide=ln,Xi.hideIfOwner=Mh,Xi.isVisible=Um,Xi.positionWithAnchor=Gm,Xi.show=Nh,Xi.testOnly_setDiv=pI;var dt=class{constructor(e,t,r){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=false,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=true,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=true,this.SERIALIZABLE=false,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Ts(0,0),e!==dt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(Jt(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=e}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=G(te.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}createBorderRect_(){this.borderRect_=G(te.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=G(te.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");yc(e),this.mouseDownWrapper_=T(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return e=this.saveLegacyState(dt),e!==null?e:this.getValue()}loadState(e){this.loadLegacyState(dt,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?(e=ht("field"),e.setAttribute("name",this.name||""),wi(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml?(this.fromXml(Bs(t)),true):false}dispose(){qe(this),Mh(this),Rc(this.getClickTarget_()),this.mouseDownWrapper_&&g(this.mouseDownWrapper_),W(this.fieldGroup_),this.disposed=true}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(ae(e,"blocklyEditableText"),fe(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(ae(e,"blocklyNonEditableText"),fe(e,"blocklyEditableText"),e.style.cursor=""))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==dt.prototype.showEditor_}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=false;return this.name&&(this.SERIALIZABLE?e=true:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=true)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}updateSize_(e){const t=this.getConstants();e=e!==void 0?e:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let r=2*e,a=t.FIELD_TEXT_HEIGHT,d=0;this.textElement_&&(d=Ct(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY),r+=d),this.borderRect_&&(a=Math.max(a,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=a,this.size_.width=r,this.positionTextElement_(e,d),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var r=this.getConstants(),a=this.size_.height/2,d;this.textElement_.setAttribute("x",`${(d=this.getSourceBlock())!=null&&d.RTL?this.size_.width-t-e:e}`),this.textElement_.setAttribute("y",`${r.FIELD_TEXT_BASELINE_CENTER?a:a-r.FIELD_TEXT_HEIGHT/2+r.FIELD_TEXT_BASELINE}`)}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",`${this.size_.width}`),this.borderRect_.setAttribute("height",`${this.size_.height}`),this.borderRect_.setAttribute("rx",`${this.getConstants().FIELD_BORDER_RECT_RADIUS}`),this.borderRect_.setAttribute("ry",`${this.getConstants().FIELD_BORDER_RECT_RADIUS}`))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=false):this.visible_&&this.size_.width===0&&(this.render_(),this.size_.width!==0&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Ts(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new _s;if(this.borderRect_){var r=this.borderRect_.getBoundingClientRect();e=rt(this.borderRect_),t=r.width,r=r.height}else{r=this.sourceBlock_.getHeightWidth();const a=t.workspace.scale;e=this.getAbsoluteXY_(),t=(r.width+1)*a,r=(r.height+1)*a,rd?(e.x+=1.5*a,e.y+=1.5*a):(e.x-=.5*a,e.y-=.5*a)}return new Zt(e.y,e.y+r,e.x,e.x+t)}getDisplayText_(){let e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"\u2026"),e=e.replace(/\s/g,dt.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="\u200F"),e):dt.NBSP}getText(){const e=this.getText_();return String(e!==null?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=true,this.constants_=null}forceRerender(){this.isDirty_=true,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())}setValue(e){if(e!==null){var t=this.doClassValidation_(e);if(e=this.processValidation_(e,t),!(e instanceof Error)){if((t=this.getValidator())&&(t=t.call(this,e),e=this.processValidation_(e,t),e instanceof Error))return;if(t=this.sourceBlock_,!t||!t.disposed){var r=this.getValue();r===e?this.doValueUpdate_(e):(this.doValueUpdate_(e),t&&as()&&Pe(new(ve(vs))(t,"field",this.name||null,r,e)),this.isDirty_&&this.forceRerender())}}}}processValidation_(e,t){return t===null?(this.doValueInvalid_(e),this.isDirty_&&this.forceRerender(),Error()):(t!==void 0&&(e=t),e)}getValue(){return this.value_}doClassValidation_(e){return e??null}doValueUpdate_(e){this.value_=e,this.isDirty_=true}doValueInvalid_(e){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||e===""||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip_=e}getTooltip(){const e=this.getClickTarget_();return xa(e||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return rt(this.getClickTarget_())}referencesVariables(){return false}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new _s;const r=t.inputList;for(let a=0;a<t.inputList.length;a++){const d=r[a],C=d.fieldRow;for(let M=0;M<C.length;M++)if(C[M]===this){e=d;break}}return e}getFlipRtl(){return false}isTabNavigable(){return false}onShortcut(e){return false}setCursorSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.cursorSvg_=e}else this.cursorSvg_=null}setMarkerSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.markerSvg_=e}else this.markerSvg_=null}updateMarkers_(){var e=this.getSourceBlock();if(!e)throw new _s;e=e.workspace,e.keyboardAccessibilityMode&&this.cursorSvg_&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg_&&e.getMarker(Qa.LOCAL_MARKER).draw()}};dt.NBSP="\xA0",dt.SKIP_SETUP=new hO;var _s=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},Sb={fromJsonInternal:EI},nl={};nl.TEST_ONLY=Sb,nl.fromJson=Dh,nl.register=ki,nl.unregister=mI;var dO="aria-",_O="role",Zs;(function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem"})(Zs||(Zs={}));var Ft;(function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin"})(Ft||(Ft={}));var rl={};rl.Role=Zs,rl.State=Ft,rl.setRole=cn,rl.setState=zt;var xe;(function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"})(xe||(xe={}));var Nd=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu goog-menu blocklyNonSelectable",t.tabIndex=0,this.roleName&&cn(t,this.roleName),this.element=t;for(let r=0,a;a=this.menuItems[r];r++)t.appendChild(a.createDom());return this.mouseOverHandler=T(t,"pointerover",this,this.handleMouseOver,true),this.clickHandler=T(t,"pointerdown",this,this.handleClick,true),this.mouseEnterHandler=T(t,"pointerenter",this,this.handleMouseEnter,true),this.mouseLeaveHandler=T(t,"pointerleave",this,this.handleMouseLeave,true),this.onKeyDownHandler=T(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&(e.focus({preventScroll:true}),ae(e,"blocklyFocused"))}blur(){const e=this.getElement();e&&(e.blur(),fe(e,"blocklyFocused"))}setRole(e){this.roleName=e}dispose(){this.mouseOverHandler&&(g(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(g(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(g(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(g(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(g(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e=0,t;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){for(let r=0,a;a=this.menuItems[r];r++)if(a.getElement()===e)return a}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;t&&(t.setHighlighted(false),this.highlightedItem=null),e&&(e.setHighlighted(true),this.highlightedItem=e,t=this.getElement(),ye(e.getElement(),t),zt(t,Ft.ACTIVEDESCENDANT,e.getId()))}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>e?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){e+=t;let r;for(;r=this.menuItems[e];){if(r.isEnabled()){this.setHighlighted(r);break}e+=t}}handleMouseOver(e){(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){const t=this.openingCoords;if(this.openingCoords=null,t&&typeof e.clientX=="number"){const r=new we(e.clientX,e.clientY);if(1>we.distance(t,r))return}(e=this.getMenuItem(e.target))&&e.performAction()}handleMouseEnter(e){this.focus()}handleMouseLeave(e){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.keyCode){case xe.ENTER:case xe.SPACE:t&&t.performAction();break;case xe.UP:this.highlightPrevious();break;case xe.DOWN:this.highlightNext();break;case xe.PAGE_UP:case xe.HOME:this.highlightFirst();break;case xe.PAGE_DOWN:case xe.END:this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=li(e);return t.height=e.scrollHeight,t}},Md=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=true,this.element=null,this.rightToLeft=false,this.roleName=null,this.highlight=this.checked=this.checkable=false,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=wr(),this.element=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var r=document.createElement("div");r.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",t.appendChild(r)}return r=this.content,typeof this.content=="string"&&(r=document.createTextNode(this.content)),t.appendChild(r),e.appendChild(t),this.roleName&&cn(e,this.roleName),zt(e,Ft.SELECTED,this.checkable&&this.checked||false),zt(e,Ft.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return(e=this.opt_value)!=null?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?(ae(t,"blocklyMenuItemHighlight"),ae(t,"goog-menuitem-highlight")):(fe(t,"blocklyMenuItemHighlight"),fe(t,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(e,t){this.actionHandler=e.bind(t)}},Ki=class extends dt{constructor(e,t,r){super(dt.SKIP_SETUP),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null,this.SERIALIZABLE=true,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions_=null,bI(e)&&(Array.isArray(e)?(Hm(e),e=vI(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption_=this.getOptions(false)[0],r&&this.configure_(r),this.setValue(this.selectedOption_[1]),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(false),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(Ki,e)||(this.isOptionListDynamic()&&this.getOptions(false),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=G(te.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&ae(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((e=this.getSourceBlock())!=null&&e.isShadow())}createTextArrow_(){this.arrow_=G(te.TSPAN,{},this.textElement_);let e;this.arrow_.appendChild(document.createTextNode((e=this.getSourceBlock())!=null&&e.RTL?Ki.ARROW_CHAR+" ":" "+Ki.ARROW_CHAR));let t;(t=this.getSourceBlock())!=null&&t.RTL?this.getTextElement().insertBefore(this.arrow_,this.textContent_):this.getTextElement().appendChild(this.arrow_)}createSVGArrow_(){this.svgArrow_=G(te.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(qs,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new _s;this.dropdownCreate_(),this.menu_.openingCoords=e&&typeof e.clientX=="number"?new we(e.clientX,e.clientY):null,ss(),e=this.menu_.render(Ot()),ae(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(e=t.isShadow()?t.getParent().getColour():t.getColour(),t=t.isShadow()?t.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,N(e,t)),q(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()}dropdownCreate_(){const e=this.getSourceBlock();if(!e)throw new _s;const t=new Nd;t.setRole(Zs.LISTBOX),this.menu_=t;const r=this.getOptions(false);this.selectedMenuItem_=null;for(let d=0;d<r.length;d++){const[C,M]=r[d];if(typeof C=="object"){var a=new Image(C.width,C.height);a.src=C.src,a.alt=C.alt||""}else a=C;a=new Md(a,M),a.setRole(Zs.OPTION),a.setRightToLeft(e.RTL),a.setCheckable(true),t.addChild(a),a.setChecked(M===this.value_),M===this.value_&&(this.selectedMenuItem_=a),a.onAction(this.handleMenuActionEvent_,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()}handleMenuActionEvent_(e){qe(this,true),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:e&&this.generatedOptions_?this.generatedOptions_:(this.generatedOptions_=this.menuGenerator_(),Hm(this.generatedOptions_),this.generatedOptions_)}doClassValidation_(e){return this.getOptions(true).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(true);for(let t=0,r;r=e[t];t++)r[1]===this.value_&&(this.selectedOption_=r)}applyColour(){const e=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",e.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow_&&(this.sourceBlock_.isShadow()?this.arrow_.style.fill=e.colourSecondary:this.arrow_.style.fill=e.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement_.style.display="none";const e=this.selectedOption_&&this.selectedOption_[0];e&&typeof e=="object"?this.renderSelectedImage_(e):this.renderSelectedText_(),this.positionBorderRect_()}renderSelectedImage_(e){const t=this.getSourceBlock();if(!t)throw new _s;this.imageElement_.style.display="",this.imageElement_.setAttributeNS(qs,"xlink:href",e.src),this.imageElement_.setAttribute("height",`${e.height}`),this.imageElement_.setAttribute("width",`${e.width}`);const r=Number(e.height);e=Number(e.width);var a=!!this.borderRect_;const d=Math.max(a?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,r+gO);a=a?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let C;C=this.svgArrow_?this.positionSVGArrow_(e+a,d/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):Ct(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=e+C+2*a,this.size_.height=d;let M=0;t.RTL?this.imageElement_.setAttribute("x",(a+C).toString()):(M=e+C,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",a.toString())),this.imageElement_.setAttribute("y",(d/2-r/2).toString()),this.positionTextElement_(M+a,e+C)}renderSelectedText_(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();ae(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const r=Ct(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let a=0;this.svgArrow_&&(a=this.positionSVGArrow_(r+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=r+a+2*t,this.size_.height=e,this.positionTextElement_(t,r)}positionSVGArrow_(e,t){if(!this.svgArrow_)return 0;const r=this.getSourceBlock();if(!r)throw new _s;const a=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,d=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,C=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(r.RTL?a:e+d)+","+t+")"),C+d}getText_(){if(!this.selectedOption_)return null;const e=this.selectedOption_[0];return typeof e=="object"?e.alt:e}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}};Ki.CHECKMARK_OVERHANG=25,Ki.MAX_MENU_HEIGHT_VH=.45,Ki.ARROW_CHAR="\u25BE";var pO=5,gO=2*pO;ki("field_dropdown",Ki),i.module$build$src$core$field_dropdown={},i.module$build$src$core$field_dropdown.FieldDropdown=Ki;var Dd=class extends zi{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=xn,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=r)}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}fromJson(e){o("Blockly.Events.BubbleOpen.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isOpen=e.isOpen,this.bubbleType=e.bubbleType,this.blockId=e.blockId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Dd),t.isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}},xd;(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(xd||(xd={})),Ie(Te.EVENT,xn,Dd);var jt=class{constructor(e,t,r,a,d){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new we(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=true,this.position=new we(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=r||false,this.margin=d!==void 0?d:jt.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),a&&(e+=" "+a),this.outerSvg=G(te.SVG,{class:e}),a=G(te.G,{},this.outerSvg),this.svgBackground=G(te.RECT,{class:"blocklyScrollbarBackground"},a),e=Math.floor((jt.scrollbarThickness-5)/2),this.svgHandle=G(te.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},a),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),Q(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=T(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=T(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=jt.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),g(this.onMouseDownBarWrapper_),g(this.onMouseDownHandleWrapper_),W(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,Ee(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&(e=this.workspace.getMetrics(),!e)||this.oldHostMetrics&&jt.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop:true}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=jt.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=jt.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-jt.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(false);else{this.pair||this.setVisible(true);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var r=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=jt.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-jt.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(false);else{this.pair||this.setVisible(true);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var r=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){const t=e!==this.isVisible();if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),f(),this.cleanUp(),R(e))e.stopPropagation();else{var t=v(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var r=Tc(this.svgHandle);r=this.horizontal?r.x:r.y;var a=this.handlePosition,d=.95*this.handleLength;t<=r?a-=d:t>=r+this.handleLength&&(a+=d),this.setHandlePosition(this.constrainHandlePosition(a)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),R(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.workspace.setupDragSurface(),this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=T(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=T(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){this.workspace.resetDragSurface(),f(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(true),this.onMouseUpWrapper_&&(g(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(g(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||t===void 0)&&this.updateMetrics()}setOrigin(e,t){this.origin=new we(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};jt.scrollbarThickness=jE?25:15,jt.DEFAULT_SCROLLBAR_MARGIN=.5;var Qe=class{constructor(e,t,r,a,d,C){this.resizeGroup=this.bubbleBack=this.bubbleArrow=this.bubbleGroup=null,this.height=this.width=this.relativeTop=this.relativeLeft=0,this.autoLayout=true,this.onMouseDownResizeWrapper=this.onMouseDownBubbleWrapper=this.moveCallback=this.resizeCallback=null,this.rendered=this.disposed=false,this.workspace_=e,this.content_=t,this.shape_=r,r=Qe.ARROW_ANGLE,this.workspace_.RTL&&(r=-r),this.arrowRadians=Ut(r),e.getBubbleCanvas().appendChild(this.createDom(t,!(!d||!C))),this.setAnchorLocation(a),d&&C||(e=this.content_.getBBox(),d=e.width+2*Qe.BORDER_WIDTH,C=e.height+2*Qe.BORDER_WIDTH),this.setBubbleSize(d,C),this.positionBubble(),this.renderArrow(),this.rendered=true}createDom(e,t){this.bubbleGroup=G(te.G,{});var r={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return QE&&(r={}),r=G(te.G,r,this.bubbleGroup),this.bubbleArrow=G(te.PATH,{},r),this.bubbleBack=G(te.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Qe.BORDER_WIDTH,ry:Qe.BORDER_WIDTH},r),t?(this.resizeGroup=G(te.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup),t=2*Qe.BORDER_WIDTH,G(te.POLYGON,{points:"0,x x,x x,0".replace(/x/g,t.toString())},this.resizeGroup),G(te.LINE,{class:"blocklyResizeLine",x1:t/3,y1:t-1,x2:t-1,y2:t/3},this.resizeGroup),G(te.LINE,{class:"blocklyResizeLine",x1:2*t/3,y1:t-1,x2:t-1,y2:2*t/3},this.resizeGroup)):this.resizeGroup=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper=T(this.bubbleBack,"pointerdown",this,this.bubbleMouseDown),this.resizeGroup&&(this.onMouseDownResizeWrapper=T(this.resizeGroup,"pointerdown",this,this.resizeMouseDown))),this.bubbleGroup.appendChild(e),this.bubbleGroup}getSvgRoot(){return this.bubbleGroup}setSvgId(e){let t;(t=this.bubbleGroup)==null||t.setAttribute("data-block-id",e)}bubbleMouseDown(e){const t=this.workspace_.getGesture(e);t&&t.handleBubbleStart(e,this)}showContextMenu(e){}isDeletable(){return false}setDeleteStyle(e){}resizeMouseDown(e){this.promote(),Qe.unbindDragEvents(),R(e)||(this.workspace_.startDrag(e,new we(this.workspace_.RTL?-this.width:this.width,this.height)),Qe.onMouseUpWrapper=T(document,"pointerup",this,Qe.bubbleMouseUp),Qe.onMouseMoveWrapper=T(document,"pointermove",this,this.resizeMouseMove),this.workspace_.hideChaff()),e.stopPropagation()}resizeMouseMove(e){this.autoLayout=false,e=this.workspace_.moveDrag(e),this.setBubbleSize(this.workspace_.RTL?-e.x:e.x,e.y),this.workspace_.RTL&&this.positionBubble()}registerResizeEvent(e){this.resizeCallback=e}registerMoveEvent(e){this.moveCallback=e}promote(){let e;const t=(e=this.bubbleGroup)==null?void 0:e.parentNode;return(t==null?void 0:t.lastChild)!==this.bubbleGroup&&this.bubbleGroup?(t==null||t.appendChild(this.bubbleGroup),true):false}setAnchorLocation(e){this.anchorXY=e,this.rendered&&this.positionBubble()}layoutBubble(){var e=this.workspace_.getMetricsManager().getViewMetrics(true),t=this.getOptimalRelativeLeft(e),r=this.getOptimalRelativeTop(e),a=this.shape_.getBBox();const d={x:t,y:-this.height-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},C={x:-this.width-30,y:r};r={x:a.width,y:r};var M={x:t,y:a.height};t=a.width<a.height?r:M,a=a.width<a.height?M:r,r=this.getOverlap(d,e),M=this.getOverlap(C,e);const z=this.getOverlap(t,e);e=this.getOverlap(a,e),e=Math.max(r,M,z,e),r===e?(this.relativeLeft=d.x,this.relativeTop=d.y):M===e?(this.relativeLeft=C.x,this.relativeTop=C.y):z===e?(this.relativeLeft=t.x,this.relativeTop=t.y):(this.relativeLeft=a.x,this.relativeTop=a.y)}getOverlap(e,t){var r=this.workspace_.RTL?this.anchorXY.x-e.x-this.width:e.x+this.anchorXY.x;return e=e.y+this.anchorXY.y,Math.max(0,Math.min(1,(Math.min(r+this.width,t.left+t.width)-Math.max(r,t.left))*(Math.min(e+this.height,t.top+t.height)-Math.max(e,t.top))/(this.width*this.height)))}getOptimalRelativeLeft(e){let t=-this.width/4;if(this.width>e.width)return t;if(this.workspace_.RTL){var r=this.anchorXY.x-t,a=e.left+e.width;e=e.left+jt.scrollbarThickness/this.workspace_.scale,r-this.width<e?t=-(e-this.anchorXY.x+this.width):r>a&&(t=-(a-this.anchorXY.x))}else{r=t+this.anchorXY.x,a=r+this.width;const d=e.left;e=e.left+e.width-jt.scrollbarThickness/this.workspace_.scale,r<d?t=d-this.anchorXY.x:a>e&&(t=e-this.anchorXY.x-this.width)}return t}getOptimalRelativeTop(e){let t=-this.height/4;if(this.height>e.height)return t;const r=this.anchorXY.y+t,a=r+this.height,d=e.top;e=e.top+e.height-jt.scrollbarThickness/this.workspace_.scale;const C=this.anchorXY.y;return r<d?t=d-C:a>e&&(t=e-C-this.height),t}positionBubble(){let e=this.anchorXY.x;e=this.workspace_.RTL?e-(this.relativeLeft+this.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchorXY.y)}moveTo(e,t){let r;(r=this.bubbleGroup)==null||r.setAttribute("transform","translate("+e+","+t+")")}setDragging(e){!e&&this.moveCallback&&this.moveCallback()}getBubbleSize(){return new Ts(this.width,this.height)}setBubbleSize(e,t){const r=2*Qe.BORDER_WIDTH;e=Math.max(e,r+45),t=Math.max(t,r+20),this.width=e,this.height=t;let a;(a=this.bubbleBack)==null||a.setAttribute("width",e.toString());let d;(d=this.bubbleBack)==null||d.setAttribute("height",t.toString()),this.resizeGroup&&(this.workspace_.RTL?this.resizeGroup.setAttribute("transform","translate("+2*Qe.BORDER_WIDTH+","+(t-r)+") scale(-1 1)"):this.resizeGroup.setAttribute("transform","translate("+(e-r)+","+(t-r)+")")),this.autoLayout&&this.layoutBubble(),this.positionBubble(),this.renderArrow(),this.resizeCallback&&this.resizeCallback()}renderArrow(){const e=[];var t=this.width/2,r=this.height/2,a=-this.relativeLeft,d=-this.relativeTop;if(t===a&&r===d)e.push("M "+t+","+r);else{d-=r,a-=t,this.workspace_.RTL&&(a*=-1);var C=Math.sqrt(d*d+a*a),M=Math.acos(a/C);0>d&&(M=2*Math.PI-M);var z=M+Math.PI/2;z>2*Math.PI&&(z-=2*Math.PI);var he=Math.sin(z);const Wt=Math.cos(z);var ke=this.getBubbleSize();z=(ke.width+ke.height)/Qe.ARROW_THICKNESS,z=Math.min(z,ke.width,ke.height)/4,ke=1-Qe.ANCHOR_RADIUS/C,a=t+ke*a,d=r+ke*d,ke=t+z*Wt;const vi=r+z*he;t-=z*Wt,r-=z*he,he=M+this.arrowRadians,he>2*Math.PI&&(he-=2*Math.PI),M=Math.sin(he)*C/Qe.ARROW_BEND,C=Math.cos(he)*C/Qe.ARROW_BEND,e.push("M"+ke+","+vi),e.push("C"+(ke+C)+","+(vi+M)+" "+a+","+d+" "+a+","+d),e.push("C"+a+","+d+" "+(t+C)+","+(r+M)+" "+t+","+r)}e.push("z");let ft;(ft=this.bubbleArrow)==null||ft.setAttribute("d",e.join(" "))}setColour(e){let t;(t=this.bubbleBack)==null||t.setAttribute("fill",e);let r;(r=this.bubbleArrow)==null||r.setAttribute("fill",e)}dispose(){this.onMouseDownBubbleWrapper&&g(this.onMouseDownBubbleWrapper),this.onMouseDownResizeWrapper&&g(this.onMouseDownResizeWrapper),Qe.unbindDragEvents(),W(this.bubbleGroup),this.disposed=true}moveDuringDrag(e,t){e?e.translateSurface(t.x,t.y):this.moveTo(t.x,t.y),this.relativeLeft=this.workspace_.RTL?this.anchorXY.x-t.x-this.width:t.x-this.anchorXY.x,this.relativeTop=t.y-this.anchorXY.y,this.renderArrow()}getRelativeToSurfaceXY(){return new we(this.workspace_.RTL?-this.relativeLeft+this.anchorXY.x-this.width:this.anchorXY.x+this.relativeLeft,this.anchorXY.y+this.relativeTop)}setAutoLayout(e){this.autoLayout=e}static unbindDragEvents(){Qe.onMouseUpWrapper&&(g(Qe.onMouseUpWrapper),Qe.onMouseUpWrapper=null),Qe.onMouseMoveWrapper&&(g(Qe.onMouseMoveWrapper),Qe.onMouseMoveWrapper=null)}static bubbleMouseUp(e){f(),Qe.unbindDragEvents()}static textToDom(e){const t=G(te.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:Qe.BORDER_WIDTH});e=e.split(`
`);for(let r=0;r<e.length;r++){const a=G(te.TSPAN,{dy:"1em",x:Qe.BORDER_WIDTH},t),d=document.createTextNode(e[r]);a.appendChild(d)}return t}static createNonEditableBubble(e,t,r){if(r=new Qe(t.workspace,e,t.pathObject.svgPath,r,null,null),r.setSvgId(t.id),t.RTL){t=e.getBBox().width;for(let a=0,d;d=e.childNodes[a];a++)d.setAttribute("text-anchor","end"),d.setAttribute("x",(t+Qe.BORDER_WIDTH).toString())}return r}};Qe.BORDER_WIDTH=6,Qe.ARROW_THICKNESS=5,Qe.ARROW_ANGLE=20,Qe.ARROW_BEND=4,Qe.ANCHOR_RADIUS=8,Qe.onMouseUpWrapper=null,Qe.onMouseMoveWrapper=null;var Bd,$b;Bd=28,i.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:Bd,connectingSnapRadius:Bd,currentConnectionPreference:8,bumpDelay:250},$b={},$b.config=i.config$$module$build$src$core$config;var hu=class{constructor(e){this.iconGroup_=null,this.collapseHidden=true,this.SIZE=17,this.iconXY_=this.bubble_=null,e||o("Calling the Icon constructor with a null block","version 9","version 10","a non-null block"),this.block_=e}createIcon(){this.iconGroup_||(this.iconGroup_=G(te.G,{class:"blocklyIconGroup"}),this.getBlock().isInFlyout&&ae(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.getBlock().getSvgRoot().appendChild(this.iconGroup_),T(this.iconGroup_,"pointerup",this,this.iconClick_),this.updateEditable())}dispose(){W(this.iconGroup_),this.setVisible(false)}updateEditable(){}isVisible(){return!!this.bubble_}iconClick_(e){this.getBlock().workspace.isDragging()||this.getBlock().isInFlyout||R(e)||this.setVisible(!this.isVisible())}applyColour(){this.bubble_&&this.isVisible()&&this.bubble_.setColour(this.getBlock().style.colourPrimary)}setIconLocation(e){this.iconXY_=e,this.bubble_&&this.isVisible()&&this.bubble_.setAnchorLocation(e)}computeIconLocation(){var e=this.getBlock().getRelativeToSurfaceXY();const t=_i(this.iconGroup_);e=new we(e.x+t.x+this.SIZE/2,e.y+t.y+this.SIZE/2),we.equals(this.getIconLocation(),e)||this.setIconLocation(e)}getIconLocation(){return this.iconXY_}getCorrectedSize(){return new Ts(this.SIZE,this.SIZE-2)}drawIcon_(e){}setVisible(e){}getBlock(){if(!this.block_)throw Error("Block is not set for this icon.");return this.block_}},ol={};ol.deepMerge=sr,ol.inherits=SI,ol.mixin=$I,ol.values=yI;var jr=class{constructor(e,t,r,a){this.name=e,this.startHats=false,this.blockStyles=t||Object.create(null),this.categoryStyles=r||Object.create(null),this.componentStyles=a||Object.create(null),this.fontStyle=Object.create(null),Ie(Te.THEME,e,this)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){return(e=this.componentStyles[e])&&typeof e=="string"&&this.getComponentStyle(e)?this.getComponentStyle(e):e?String(e):null}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const r=new jr(e);let a=t.base;if(a){if(typeof a=="string"){let d;a=(d=Eo(Te.THEME,a))!=null?d:void 0}a instanceof jr&&(sr(r,a),r.name=e)}return sr(r.blockStyles,t.blockStyles),sr(r.categoryStyles,t.categoryStyles),sr(r.componentStyles,t.componentStyles),sr(r.fontStyle,t.fontStyle),t.startHats!==null&&(r.startHats=t.startHats),r}},fO={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},mO={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},du=new jr("classic",fO,mO),Pd="categoryToolbox",yb="flyoutToolbox",Je;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(Je||(Je={}));var Rb={hasCategoriesInternal:II},cr={};cr.Position=Je,cr.TEST_ONLY=Rb,cr.convertFlyoutDefToJsonArray=wc,cr.convertToolboxDefToJson=Oc,cr.hasCategories=xh,cr.isCategoryCollapsible=Bh,cr.parseToolboxTree=Wm;var Yi=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,r=false;var a=false,d=false,C=false,M=false,z=false;const he=!!e.readOnly;if(!he){var ke;t=Oc((ke=e.toolbox)!=null?ke:null),r=xh(t),a=e.trashcan,a=a===void 0?r:a,d=e.collapse,d=d===void 0?r:d,C=e.comments,C=C===void 0?r:C,M=e.disable,M=M===void 0?r:M,z=e.sounds,z=z===void 0?true:z}ke=e.maxTrashcanContents,a?ke===void 0&&(ke=32):ke=0;const ft=!!e.rtl;let Wt=e.horizontalLayout;Wt===void 0&&(Wt=false);var vi=e.toolboxPosition!=="end";vi=Wt?vi?Je.TOP:Je.BOTTOM:vi===ft?Je.RIGHT:Je.LEFT;let G_=e.css;G_===void 0&&(G_=true);let H_="https://blockly-demo.appspot.com/static/media/";e.media?H_=e.media.endsWith("/")?e.media:e.media+"/":"path"in e&&(o("path","Nov 2014","Jul 2023","media"),H_=e.path+"media/");const Wv=e.oneBasedIndex,JO=e.renderer||"geras",ZO=e.plugins||{};let V_=e.modalInputs;V_===void 0&&(V_=true),this.RTL=ft,this.oneBasedIndex=Wv===void 0?true:Wv,this.collapse=d,this.comments=C,this.disable=M,this.readOnly=he,this.maxBlocks=e.maxBlocks||1/0;let zv;this.maxInstances=(zv=e.maxInstances)!=null?zv:null,this.modalInputs=V_,this.pathToMedia=H_,this.hasCategories=r,this.moveOptions=Yi.parseMoveOptions_(e,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=a,this.maxTrashcanContents=ke,this.hasSounds=z,this.hasCss=G_,this.horizontalLayout=Wt,this.languageTree=t,this.gridOptions=Yi.parseGridOptions_(e),this.zoomOptions=Yi.parseZoomOptions_(e),this.toolboxPosition=vi,this.theme=Yi.parseThemeOptions_(e),this.renderer=JO;let jv;this.rendererOverrides=(jv=e.rendererOverrides)!=null?jv:null;let Xv;this.parentWorkspace=(Xv=e.parentWorkspace)!=null?Xv:null,this.plugins=ZO}static parseMoveOptions_(e,t){const r=e.move||{},a={};return r.scrollbars===void 0&&e.scrollbars===void 0?a.scrollbars=t:typeof r.scrollbars=="object"?(a.scrollbars={horizontal:!!r.scrollbars.horizontal,vertical:!!r.scrollbars.vertical},a.scrollbars.horizontal&&a.scrollbars.vertical?a.scrollbars=true:a.scrollbars.horizontal||a.scrollbars.vertical||(a.scrollbars=false)):a.scrollbars=!!r.scrollbars||!!e.scrollbars,a.wheel=a.scrollbars&&r.wheel!==void 0?!!r.wheel:typeof a.scrollbars=="object",a.drag=a.scrollbars?r.drag===void 0?true:!!r.drag:false,a}static parseZoomOptions_(e){e=e.zoom||{};const t={};return t.controls=e.controls===void 0?false:!!e.controls,t.wheel=e.wheel===void 0?false:!!e.wheel,t.startScale=e.startScale===void 0?1:Number(e.startScale),t.maxScale=e.maxScale===void 0?3:Number(e.maxScale),t.minScale=e.minScale===void 0?.3:Number(e.minScale),t.scaleSpeed=e.scaleSpeed===void 0?1.2:Number(e.scaleSpeed),t.pinch=e.pinch===void 0?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions_(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=e.length===void 0?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions_(e){return e=e.theme||du,typeof e=="string"?Eo(Te.THEME,e):e instanceof jr?e:jr.defineTheme(e.name||"builtin"+wr(),e)}},Ib;i.Mutator$$module$build$src$core$mutator=class extends hu{constructor(e,t){t||o("Calling the Mutator constructor without passing the block it is attached to","version 9","version 10","the constructor by passing the list of subblocks and the block instance to attach the mutator to"),super(t??null),this.workspace_=null,this.workspaceHeight=this.workspaceWidth=0,this.updateWorkspacePid=this.sourceListener=this.rootBlock=this.svgDialog=null,this.quarkNames=e}setBlock(e){this.block_=e}getWorkspace(){return this.workspace_}drawIcon_(e){G(te.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},e),G(te.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},e),G(te.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},e)}iconClick_(e){this.getBlock().isEditable()&&super.iconClick_(e)}createEditor(){if(this.svgDialog=G(te.SVG,{x:Qe.BORDER_WIDTH,y:Qe.BORDER_WIDTH}),this.quarkNames.length){var e=ht("xml");for(let a=0,d;d=this.quarkNames[a];a++){var t=ht("block");t.setAttribute("type",d),e.appendChild(t)}}else e=null;var r=this.getBlock();return t=new Yi({disable:false,parentWorkspace:r.workspace,media:r.workspace.options.pathToMedia,rtl:r.RTL,horizontalLayout:false,renderer:r.workspace.options.renderer,rendererOverrides:r.workspace.options.rendererOverrides}),t.toolboxPosition=r.RTL?Je.RIGHT:Je.LEFT,(r=!!e)&&(t.languageTree=Oc(e)),this.workspace_=this.newWorkspaceSvg(t),this.workspace_.internalIsMutator=true,this.workspace_.addChangeListener(Nt),e=r?this.workspace_.addFlyout(te.G):null,t=this.workspace_.createDom("blocklyMutatorBackground"),e&&t.insertBefore(e,this.workspace_.svgBlockCanvas_),this.svgDialog.appendChild(t),this.svgDialog}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}updateEditable(){super.updateEditable(),this.getBlock().isInFlyout||(this.getBlock().isEditable()?this.iconGroup_&&fe(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(false),this.iconGroup_&&ae(this.iconGroup_,"blocklyIconGroupReadonly")))}resizeBubble(){if(this.workspace_){var e=2*Qe.BORDER_WIDTH,t=this.workspace_.getCanvas(),r=t.getBBox(),a=r.width+r.x,d=r.height+3*e,C=this.workspace_.getFlyout();if(C){const M=C.getWorkspace().getMetricsManager().getScrollMetrics();d=Math.max(d,M.height+20),a+=C.getWidth()}(C=this.getBlock().RTL)&&(a=-r.x),a+=3*e,(Math.abs(this.workspaceWidth-a)>e||Math.abs(this.workspaceHeight-d)>e)&&(this.workspaceWidth=a,this.workspaceHeight=d,this.bubble_.setBubbleSize(a+e,d+e),this.svgDialog.setAttribute("width",`${a}`),this.svgDialog.setAttribute("height",`${d}`),this.workspace_.setCachedParentSvgSize(a,d)),C&&t.setAttribute("transform",`translate(${this.workspaceWidth}, 0)`),this.workspace_.resize()}}onBubbleMove(){this.workspace_&&this.workspace_.recordDragTargets()}setVisible(e){if(e!==this.isVisible()){var t=this.getBlock();if(Pe(new(ve(xn))(t,e,"mutator")),e){this.bubble_=new Qe(t.workspace,this.createEditor(),t.pathObject.svgPath,this.iconXY_,null,null),e=this.workspace_,this.bubble_.setSvgId(t.id),this.bubble_.registerMoveEvent(this.onBubbleMove.bind(this));var r=e.options.languageTree,a=e.getFlyout();r&&(a.init(e),a.show(r)),this.rootBlock=t.decompose(e),r=this.rootBlock.getDescendants(false);for(let d=0,C;C=r[d];d++)C.render();if(this.rootBlock.setMovable(false),this.rootBlock.setDeletable(false),a?(r=2*a.CORNER_RADIUS,a=this.rootBlock.RTL?a.getWidth()+r:r):a=r=16,t.RTL&&(a=-a),this.rootBlock.moveBy(a,r),t.saveConnections){const d=this.rootBlock;t.saveConnections(d),this.sourceListener=()=>{const C=this.getBlock();C.saveConnections&&C.saveConnections(d)},t.workspace.addChangeListener(this.sourceListener)}this.resizeBubble(),e.addChangeListener(this.workspaceChanged.bind(this)),this.updateWorkspace(),this.applyColour()}else this.svgDialog=null,this.workspace_.dispose(),this.rootBlock=this.workspace_=null,(a=this.bubble_)==null||a.dispose(),this.bubble_=null,this.workspaceHeight=this.workspaceWidth=0,this.sourceListener&&(t.workspace.removeChangeListener(this.sourceListener),this.sourceListener=null)}}workspaceChanged(e){this.shouldIgnoreMutatorEvent_(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.updateWorkspace()},0))}shouldIgnoreMutatorEvent_(e){return e.isUiEvent||e.type===ys||e.type===vs&&e.element==="disabled"}updateWorkspace(){if(!this.workspace_.isDragging()){var e=this.workspace_.getTopBlocks(false);for(let a=0,d;d=e[a];a++){var t=d.getRelativeToSurfaceXY();if(20>t.y&&d.moveBy(0,20-t.y),d.RTL){var r=-20;const C=this.workspace_.getFlyout();C&&(r-=C.getWidth()),t.x>r&&d.moveBy(r-t.x,0)}else 20>t.x&&d.moveBy(20-t.x,0)}}if(this.rootBlock&&this.rootBlock.workspace===this.workspace_){(e=Bt())||He(true);const a=this.getBlock();if(t=zr.getExtraBlockState_(a),r=a.rendered,a.rendered=false,a.compose(this.rootBlock),a.rendered=r,a.initSvg(),a.rendered&&a.render(),r=zr.getExtraBlockState_(a),t!==r){Pe(new(ve(vs))(a,"mutation",null,t,r));const d=Bt();setTimeout(function(){const C=Bt();He(d),a.bumpNeighbours(),He(C)},i.config$$module$build$src$core$config.bumpDelay)}this.workspace_.isDragging()||setTimeout(()=>this.resizeBubble(),0),He(e)}}dispose(){this.getBlock().mutator=null,super.dispose()}updateBlockStyle(){var e=this.workspace_;if(e&&e.getAllBlocks(false)){const t=e.getAllBlocks(false);for(let r=0,a;a=t[r];r++)a.setStyle(a.getStyleName());if(e=e.getFlyout()){e=e.getWorkspace().getAllBlocks(false);for(let r=0,a;a=e[r];r++)a.setStyle(a.getStyleName())}}}static reconnect(e,t,r){if(!e||!e.getSourceBlock().workspace)return false;r=t.getInput(r).connection;const a=e.targetBlock();return a&&a!==t||!r||r.targetConnection===e?false:(r.isConnected()&&r.disconnect(),r.connect(e),true)}static findParentWs(e){let t=null;if(e&&e.options){const r=e.options.parentWorkspace;e.isFlyout?r&&r.options&&(t=r.options.parentWorkspace):r&&(t=r)}return t}},Ib={},Ib.Mutator=i.Mutator$$module$build$src$core$mutator;var jo=Object.create(null),EO={allExtensions:jo};kc("parent_tooltip_when_inline",PI),i.module$build$src$core$extensions={},i.module$build$src$core$extensions.TEST_ONLY=EO,i.module$build$src$core$extensions.apply=Uh,i.module$build$src$core$extensions.buildTooltipForDropdown=DI,i.module$build$src$core$extensions.buildTooltipWithFieldText=BI,i.module$build$src$core$extensions.isRegistered=zm,i.module$build$src$core$extensions.register=kc,i.module$build$src$core$extensions.registerMixin=OI,i.module$build$src$core$extensions.registerMutator=wI,i.module$build$src$core$extensions.runAfterPageLoad=Ac,i.module$build$src$core$extensions.unregister=kI;var Cb={};Cb.removeElem=Xs;var Pn={};Pn.arc=hs,Pn.curve=pi,Pn.line=Ba,Pn.lineOnAxis=Me,Pn.lineTo=An,Pn.moveBy=Vt,Pn.moveTo=Ns,Pn.point=Ge;var gt={};gt.Coordinate=we,gt.KeyCodes=xe,gt.Rect=Zt,gt.Size=Ts,gt.Svg=te,gt.aria=rl,gt.array=Cb,gt.arrayRemove=jI,gt.browserEvents=Mn,gt.checkMessageReferences=VI,gt.colour=Ds,gt.deprecation=bs,gt.dom=ms,gt.extensions=i.module$build$src$core$extensions,gt.getBlockTypeCounts=KI,gt.getDocumentScroll=XI,gt.getInjectionDivXY_=FI,gt.getRelativeXY=UI,gt.getViewportBBox=zI,gt.idGenerator=Kc,gt.is3dSupported=WI,gt.math=zc,gt.object=ol,gt.parseBlockColour=qI,gt.parsing=il,gt.replaceMessageReferences=HI,gt.runAfterPageLoad=JI,gt.screenToWsCoordinates=YI,gt.string=i.module$build$src$core$utils$string,gt.style=hn,gt.svgMath=lr,gt.svgPaths=Pn,gt.tokenizeInterpolation=GI,gt.toolbox=cr,gt.userAgent=Nn,gt.xml=i.module$build$src$core$utils$xml;var Ud=class extends zi{constructor(e,t){super(t),this.type=ja,this.isOpen=e}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}fromJson(e){o("Blockly.Events.TrashcanOpen.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isOpen=e.isOpen}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Ud),t.isOpen=e.isOpen,t}};Ie(Te.EVENT,ja,Ud);var Un=class{constructor(e){this.name_=e}toString(){return this.name_}};Un.POSITIONABLE=new Un("positionable"),Un.DRAG_TARGET=new Un("drag_target"),Un.DELETE_AREA=new Un("delete_area"),Un.AUTOHIDEABLE=new Un("autohideable");var Ss=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const r=e.component.id;if(!t&&this.componentData.has(r)){var a;throw Error('Plugin "'+r+'" with capabilities "'+((a=this.componentData.get(r))==null?void 0:a.capabilities)+'" already added.')}for(this.componentData.set(r,e),t=[],a=0;a<e.capabilities.length;a++){const d=String(e.capabilities[a]).toLowerCase();if(t.push(d),this.capabilityToComponentIds.has(d)){let C;(C=this.capabilityToComponentIds.get(d))==null||C.push(r)}else this.capabilityToComponentIds.set(d,[r])}this.componentData.get(r).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let r=0;r<t.capabilities.length;r++){const a=String(t.capabilities[r]).toLowerCase();Xs(this.capabilityToComponentIds.get(a),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');if(this.hasCapability(e,t))console.warn('Plugin "'+e+'already has capability "'+t+'"');else{t=String(t).toLowerCase();var r;(r=this.componentData.get(e))==null||r.capabilities.push(t);var a;(a=this.capabilityToComponentIds.get(t))==null||a.push(e)}}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=String(t).toLowerCase(),Xs(this.componentData.get(e).capabilities,t),Xs(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+`doesn't have capability "`+t+'" to remove')}hasCapability(e,t){return t=String(t).toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.indexOf(t)!==-1}getComponent(e){let t;return(t=this.componentData.get(e))==null?void 0:t.component}getComponents(e,t){if(e=String(e).toLowerCase(),e=this.capabilityToComponentIds.get(e),!e)return[];const r=[];if(t){const a=[];e.forEach(d=>{a.push(this.componentData.get(d))}),a.sort(function(d,C){return d.weight-C.weight}),a.forEach(function(d){r.push(d.component)})}else e.forEach(a=>{r.push(this.componentData.get(a).component)});return r}};Ss.Capability=Un;var al=class extends Error{},Ob=class extends al{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},ll=class extends al{constructor(e,t,r){super(`The block ${t.toDevString()} is missing a(n) ${e}
connection`),this.block=t,this.state=r}},wb=class extends al{constructor(e,t,r,a){super(`The block ${r.toDevString()} could not connect its
${t} to its parent, because: ${e}`),this.childBlock=r,this.childState=a}},kb=class extends al{constructor(e){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=e}},Xo={};Xo.BadConnectionCheck=wb,Xo.DeserializationError=al,Xo.MissingBlockType=Ob,Xo.MissingConnection=ll,Xo.RealChildOfShadow=kb;var Ab=100,Lb=75,Nb=50,_u={};_u.BLOCKS=Nb,_u.PROCEDURES=Lb,_u.VARIABLES=Ab;var Fd={};Fd.register=Hh,Fd.unregister=ZI;var Mb=class{constructor(){this.priority=Nb}save(e){const t=[];for(const r of e.getTopBlocks(false))(e=Ln(r,{addCoordinates:true,doFullSerialization:false}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const r of e)Dr(r,t,{recordUndo:Ls()})}clear(e){for(const t of e.getTopBlocks(false))t.dispose(false)}};Hh("blocks",new Mb);var cl={};cl.BlockSerializer=Mb,cl.append=Dr,cl.appendInternal=Vh,cl.save=Ln;var Gd=class extends Ho{constructor(e){super(e),this.type=ys,e&&(e.isShadow()&&(this.recordUndo=false),this.xml=Sc(e),this.ids=To(e),this.json=Ln(e,{addCoordinates:true}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=wi(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}fromJson(e){o("Blockly.Events.BlockCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.xml=Bs(e.xml),this.ids=e.ids,this.json=e.json,e.recordUndo!==void 0&&(this.recordUndo=e.recordUndo)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Gd),t.xml=Bs(e.xml),t.ids=e.ids,t.json=e.json,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(e)Dr(this.json,t);else for(e=0;e<this.ids.length;e++){const r=this.ids[e],a=t.getBlockById(r);a?a.dispose(false):r===this.blockId&&console.warn("Can't uncreate non-existent block: "+r)}}};Ie(Te.EVENT,ys,Gd);var Hd=class extends Ho{constructor(e){if(super(e),this.type=dn,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=false),this.oldXml=Sc(e),this.ids=To(e),this.wasShadow=e.isShadow(),this.oldJson=Ln(e,{addCoordinates:true})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=wi(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}fromJson(e){o("Blockly.Events.BlockDelete.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldXml=Bs(e.oldXml),this.ids=e.ids,this.wasShadow=e.wasShadow||this.oldXml.tagName.toLowerCase()==="shadow",this.oldJson=e.oldJson,e.recordUndo!==void 0&&(this.recordUndo=e.recordUndo)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Hd),t.oldXml=Bs(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||t.oldXml.tagName.toLowerCase()==="shadow",t.oldJson=e.oldJson,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const r=this.ids[e],a=t.getBlockById(r);a?a.dispose(false):r===this.blockId&&console.warn("Can't delete non-existent block: "+r)}else Dr(this.oldJson,t)}};Ie(Te.EVENT,dn,Hd);var Ne;(function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(Ne||(Ne={})),i.module$build$src$core$connection_type={},i.module$build$src$core$connection_type.ConnectionType=Ne;var Tt=class{constructor(e,t){this.type=t,this.targetConnection=null,this.disposed=false,this.shadowDom_=this.check_=null,this.y=this.x=0,this.shadowState_=null,this.sourceBlock_=e}connect_(e){const t=Ne.INPUT_VALUE,r=this.getSourceBlock();var a=e.getSourceBlock();e.isConnected()&&e.disconnect();let d;if(this.isConnected()){const M=this.stashShadowState_(),z=this.targetBlock();z.isShadow()?z.dispose(false):(this.disconnect(),d=z),this.applyShadowState_(M)}let C;as()&&(C=new(ve(Ps))(a)),gC(this,e),a.setParent(r),C&&(C.recordNew(),Pe(C)),d&&(e=this.type===t?d.outputConnection:d.previousConnection,(a=Tt.getConnectionForOrphanedConnection(a,e))?e.connect(a):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.setShadowStateInternal_();const e=this.targetBlock();e&&e.unplug()}this.disposed=true}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Ne.INPUT_VALUE||this.type===Ne.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return true;if(this.getConnectionChecker().canConnect(this,e,false)){const t=Bt();t||He(true),this.isSuperior()?this.connect_(e):e.connect_(this),t||He(false)}return this.isConnected()}disconnect(){var e=this.targetConnection;if(!e)throw Error("Source connection not connected.");if(e.targetConnection!==this)throw Error("Target connection not connected to source connection.");let t,r;this.isSuperior()?(t=this.sourceBlock_,r=e.getSourceBlock(),e=this):(t=e.getSourceBlock(),r=this.sourceBlock_);const a=Bt();a||He(true),this.disconnectInternal_(t,r),r.isShadow()||e.respawnShadow_(),a||He(false)}disconnectInternal_(e,t){let r;as()&&(r=new(ve(Ps))(t)),(e=this.targetConnection)&&(e.targetConnection=null),this.targetConnection=null,t.setParent(null),r&&(r.recordNew(),Pe(r))}respawnShadow_(){this.createShadowBlock_(true)}targetBlock(){if(this.isConnected()){let e,t;return(t=(e=this.targetConnection)==null?void 0:e.getSourceBlock())!=null?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,false)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check_=e,this.onCheckChanged_()):this.check_=null,this}getCheck(){return this.check_}setShadowDom(e){this.setShadowStateInternal_({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Lr(this.targetBlock()):this.shadowDom_}setShadowState(e){this.setShadowStateInternal_({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?Ln(this.targetBlock()):this.shadowState_}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let r=0;r<t.length;r++)if(t[r].connection===this){e=t[r];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let r=0,a;a=e.inputList[r];r++)if(a.connection===this){t=a;break}if(t)t='Input "'+t.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return t+e.toDevString()}stashShadowState_(){const e=this.getShadowDom(true),t=this.getShadowState(true);return this.shadowState_=this.shadowDom_=null,{shadowDom:e,shadowState:t}}applyShadowState_({shadowDom:e,shadowState:t}){this.shadowDom_=e,this.shadowState_=t}setShadowStateInternal_({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom_=e,this.shadowState_=t,(e=this.targetBlock())?e.isShadow()?(e.dispose(false),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock())):(e=this.createShadowBlock_(false),this.serializeShadow_(e),e&&e.dispose(false)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock()))}createShadowBlock_(e){var t=this.getSourceBlock();const r=this.getShadowState(),a=this.getShadowDom();if(t.isDeadOrDying()||!r&&!a)return null;if(r)return t=Vh(r,t.workspace,{parentConnection:e?this:void 0,isShadow:true,recordUndo:false});if(a){if(t=Io(a,t.workspace),e)if(this.type===Ne.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===Ne.NEXT_STATEMENT){if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return t}return null}serializeShadow_(e){e&&(this.shadowDom_=Lr(e),this.shadowState_=Ln(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===Ne.OUTPUT_VALUE)return mC(e,t.getSourceBlock());e=e.lastConnectionInStack(true);const r=t.getConnectionChecker();return e&&r.canConnect(t,e,false)?e:null}};Tt.CAN_CONNECT=0,Tt.REASON_SELF_CONNECTION=1,Tt.REASON_WRONG_TYPE=2,Tt.REASON_TARGET_NULL=3,Tt.REASON_CHECKS_FAILED=4,Tt.REASON_DIFFERENT_WORKSPACES=5,Tt.REASON_SHADOW_PARENT=6,Tt.REASON_DRAG_CHECKS_FAILED=7,Tt.REASON_PREVIOUS_AND_OUTPUT=8;var ul="_TEMP_COLLAPSED_INPUT",hl="_TEMP_COLLAPSED_FIELD",Vd={};Vd.COLLAPSED_FIELD_NAME=hl,Vd.COLLAPSED_INPUT_NAME=ul,i.FieldLabel$$module$build$src$core$field_label=class extends dt{constructor(e,t,r){super(dt.SKIP_SETUP),this.class_=null,this.EDITABLE=false,e!==dt.SKIP_SETUP&&(r?this.configure_(r):this.class_=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class_=e.class)}initView(){this.createTextElement_(),this.class_&&ae(this.getTextElement(),this.class_)}doClassValidation_(e){return e==null?null:String(e)}setClass(e){this.textElement_&&(this.class_&&fe(this.textElement_,this.class_),e&&ae(this.textElement_,e)),this.class_=e}static fromJson(e){return new this(Jt(e.text),void 0,e)}},ki("field_label",i.FieldLabel$$module$build$src$core$field_label),i.FieldLabel$$module$build$src$core$field_label.prototype.DEFAULT_VALUE="",i.FieldLabel$$module$build$src$core$field_label;var Ko=class{constructor(e,t,r,a){if(this.type=e,this.name=t,this.connection=a,this.fieldRow=[],this.align=i.Align$$module$build$src$core$input.LEFT,this.visible=true,e!==it.DUMMY&&!t)throw Error("Value inputs and statement inputs must have non-empty name.");this.sourceBlock=r}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,r){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||t===""&&r)&&(typeof t=="string"&&(t=Dh({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.rendered&&(t.init(),t.applyColour()),t.name=r,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&(this.sourceBlock.render(),this.sourceBlock.bumpNeighbours())),e}removeField(e,t){for(let r=0,a;a=this.fieldRow[r];r++)if(a.name===e)return a.dispose(),this.fieldRow.splice(r,1),this.sourceBlock.rendered&&(this.sourceBlock.render(),this.sourceBlock.bumpNeighbours()),true;if(t)return false;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let a=0,d;d=this.fieldRow[a];a++)d.setVisible(e);if(this.connection){var r=this.connection;e?t=r.startTrackingAll():r.stopTrackingAll(),(r=r.targetBlock())&&(r.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e=0,t;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.render(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init()}dispose(){for(let e=0,t;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}},Wd;(function(e){e=e.Align||(e.Align={}),e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(Ko||(Ko={})),i.Align$$module$build$src$core$input=Ko.Align,Wd={},Wd.Align=i.Align$$module$build$src$core$input,Wd.Input=Ko;var _e=class{constructor(e,t,r){if(this.wsCoordinate_=null,!t)throw Error("Cannot create a node without a location.");this.type_=e,this.isConnection_=_e.isConnectionType_(e),this.location_=t,this.processParams_(r||null)}processParams_(e){e&&e.wsCoordinate&&(this.wsCoordinate_=e.wsCoordinate)}getLocation(){return this.location_}getType(){return this.type_}getWsCoordinate(){return this.wsCoordinate_}isConnection(){return this.isConnection_}findNextForInput_(){var e=this.location_.getParentInput();const t=e.getSourceBlock();for(e=t.inputList.indexOf(e),e+=1;e<t.inputList.length;e++){const r=t.inputList[e],a=r.fieldRow;for(let d=0;d<a.length;d++){const C=a[d];if(C.isClickable()||_e.NAVIGATE_ALL_FIELDS)return _e.createFieldNode(C)}if(r.connection)return _e.createInputNode(r)}return null}findNextForField_(){var e=this.location_,t=e.getParentInput();const r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var a=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)+1;a<r.inputList.length;a++){t=r.inputList[a];const d=t.fieldRow;for(;e<d.length;){if(d[e].isClickable()||_e.NAVIGATE_ALL_FIELDS)return _e.createFieldNode(d[e]);e++}if(e=0,t.connection)return _e.createInputNode(t)}return null}findPrevForInput_(){const e=this.location_.getParentInput(),t=e.getSourceBlock();for(var r=t.inputList.indexOf(e);0<=r;r--){var a=t.inputList[r];if(a.connection&&a!==e)return _e.createInputNode(a);a=a.fieldRow;for(let d=a.length-1;0<=d;d--){const C=a[d];if(C.isClickable()||_e.NAVIGATE_ALL_FIELDS)return _e.createFieldNode(C)}}return null}findPrevForField_(){var e=this.location_;const t=e.getParentInput(),r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var a=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)-1;0<=a;a--){var d=r.inputList[a];if(d.connection&&d!==t)return _e.createInputNode(d);for(d=d.fieldRow;-1<e;){if(d[e].isClickable()||_e.NAVIGATE_ALL_FIELDS)return _e.createFieldNode(d[e]);e--}0<=a-1&&(e=r.inputList[a-1].fieldRow.length-1)}return null}navigateBetweenStacks_(e){var t=this.getLocation();if(t.getSourceBlock){var r=t.getSourceBlock();r&&(t=r)}if(!t||t.isDeadOrDying())return null;r=t.getRootBlock(),t=r.workspace.getTopBlocks(true);for(let a=0;a<t.length;a++)if(r.id===t[a].id)return e=a+(e?1:-1),e===-1||e===t.length?null:_e.createStackNode(t[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")}findTopASTNodeForBlock_(e){const t=Lc(e);return t?_e.createConnectionNode(t):_e.createBlockNode(e)}getOutAstNodeForBlock_(e){if(!e)return null;e=e.getTopStackBlock();const t=Lc(e);return t&&t.targetConnection&&t.targetConnection.getParentInput()?_e.createInputNode(t.targetConnection.getParentInput()):_e.createStackNode(e)}findFirstFieldOrInput_(e){e=e.inputList;for(let t=0;t<e.length;t++){const r=e[t],a=r.fieldRow;for(let d=0;d<a.length;d++){const C=a[d];if(C.isClickable()||_e.NAVIGATE_ALL_FIELDS)return _e.createFieldNode(C)}if(r.connection)return _e.createInputNode(r)}return null}getSourceBlock(){return this.getType()===_e.types.BLOCK?this.getLocation():this.getType()===_e.types.STACK?this.getLocation():this.getType()===_e.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type_){case _e.types.STACK:return this.navigateBetweenStacks_(true);case _e.types.OUTPUT:return _e.createBlockNode(this.location_.getSourceBlock());case _e.types.FIELD:return this.findNextForField_();case _e.types.INPUT:return this.findNextForInput_();case _e.types.BLOCK:return _e.createConnectionNode(this.location_.nextConnection);case _e.types.PREVIOUS:return _e.createBlockNode(this.location_.getSourceBlock());case _e.types.NEXT:return _e.createConnectionNode(this.location_.targetConnection)}return null}in(){switch(this.type_){case _e.types.WORKSPACE:const e=this.location_.getTopBlocks(true);if(0<e.length)return _e.createStackNode(e[0]);break;case _e.types.STACK:return this.findTopASTNodeForBlock_(this.location_);case _e.types.BLOCK:return this.findFirstFieldOrInput_(this.location_);case _e.types.INPUT:return _e.createConnectionNode(this.location_.targetConnection)}return null}prev(){switch(this.type_){case _e.types.STACK:return this.navigateBetweenStacks_(false);case _e.types.FIELD:return this.findPrevForField_();case _e.types.INPUT:return this.findPrevForInput_();case _e.types.BLOCK:var e=Lc(this.location_);return _e.createConnectionNode(e);case _e.types.PREVIOUS:if((e=this.location_.targetConnection)&&!e.getParentInput())return _e.createConnectionNode(e);break;case _e.types.NEXT:return _e.createBlockNode(this.location_.getSourceBlock())}return null}out(){switch(this.type_){case _e.types.STACK:var e=this.location_,t=e.getRelativeToSurfaceXY();return t=new we(t.x,t.y+_e.DEFAULT_OFFSET_Y),_e.createWorkspaceNode(e.workspace,t);case _e.types.OUTPUT:return e=this.location_,(t=e.targetConnection)?_e.createConnectionNode(t):_e.createStackNode(e.getSourceBlock());case _e.types.FIELD:if(e=this.location_.getSourceBlock(),!e)throw Error("The current AST location is not associated with a block");return _e.createBlockNode(e);case _e.types.INPUT:return _e.createBlockNode(this.location_.getSourceBlock());case _e.types.BLOCK:return this.getOutAstNodeForBlock_(this.location_);case _e.types.PREVIOUS:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock());case _e.types.NEXT:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock())}return null}static isConnectionType_(e){switch(e){case _e.types.PREVIOUS:case _e.types.NEXT:case _e.types.INPUT:case _e.types.OUTPUT:return true}return false}static createFieldNode(e){return e?new _e(_e.types.FIELD,e):null}static createConnectionNode(e){if(!e)return null;const t=e.type;return t===Ne.INPUT_VALUE||t===Ne.NEXT_STATEMENT&&e.getParentInput()?_e.createInputNode(e.getParentInput()):t===Ne.NEXT_STATEMENT?new _e(_e.types.NEXT,e):t===Ne.OUTPUT_VALUE?new _e(_e.types.OUTPUT,e):t===Ne.PREVIOUS_STATEMENT?new _e(_e.types.PREVIOUS,e):null}static createInputNode(e){return e&&e.connection?new _e(_e.types.INPUT,e.connection):null}static createBlockNode(e){return e?new _e(_e.types.BLOCK,e):null}static createStackNode(e){return e?new _e(_e.types.STACK,e):null}static createWorkspaceNode(e,t){return t&&e?new _e(_e.types.WORKSPACE,e,{wsCoordinate:t}):null}static createTopNode(e){const t=Lc(e);return t?_e.createConnectionNode(t):_e.createBlockNode(e)}};_e.NAVIGATE_ALL_FIELDS=false,_e.DEFAULT_OFFSET_Y=-20,function(e){e=e.types||(e.types={}),e.FIELD="field",e.BLOCK="block",e.INPUT="input",e.OUTPUT="output",e.NEXT="next",e.PREVIOUS="previous",e.STACK="stack",e.WORKSPACE="workspace"}(_e||(_e={}));var Yo=class{constructor(e,t,r){if(this.data=null,this.disposed=false,this.hue_=null,this.colour_="#000000",this.styleName_="",this.loadExtraState=this.saveExtraState=this.domToMutation=this.mutationToDom=this.destroy=this.init=void 0,this.suppressPrefixSuffix=false,this.decompose=this.compose=this.getDeveloperVariables=void 0,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=false,this.tooltip="",this.contextMenu=true,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=true,this.collapsed_=this.isShadow_=false,this.outputShape_=null,this.disposing=false,this.comment=null,this.isInsertionMarker_=false,this.hat=void 0,this.onchangeWrapper_=this.helpUrl=this.rendered=null,this.statementInputCount=0,this.workspace=e,this.id=r&&!e.getBlockById(r)?r:ui(),e.setBlockById(this.id,this),this.commentModel={text:null,pinned:false,size:new Ts(160,80)},this.xy_=new we(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,r=Ys[t],!r||typeof r!="object")throw TypeError("Invalid block definition for type: "+t);Object.assign(this,r)}e.addTopBlock(this),e.addTypedBlock(this),new.target===Yo&&this.doInit_()}doInit_(){const e=Bt();e||He(true);const t=Ls();try{typeof this.init=="function"&&(As(false),this.init(),As(t)),as()&&Pe(new(ve(ys))(this))}finally{e||He(false),As(t)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(e){if(!this.isDeadOrDying()){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(e),as()&&Pe(new(ve(dn))(this)),Yt();try{this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=true;for(let r=this.childBlocks_.length-1;0<=r;r--)this.childBlocks_[r].dispose(false);for(let r=0,a;a=this.inputList[r];r++)a.dispose();this.inputList.length=0;const t=this.getConnections_(true);for(let r=0,a;a=t[r];r++)a.dispose()}finally{qt(),typeof this.destroy=="function"&&this.destroy(),this.disposed=true}}}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(let e=0,t;t=this.inputList[e];e++)for(let r=0,a;a=t.fieldRow[r];r++)a.initModel&&a.initModel()}unplug(e){this.outputConnection&&this.unplugFromRow_(e),this.previousConnection&&this.unplugFromStack_(e)}unplugFromRow_(e){let t=null;this.outputConnection.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&e&&(e=this.getOnlyValueConnection_())&&e.isConnected()&&!e.targetBlock().isShadow()&&(e=e.targetConnection,e==null||e.disconnect(),this.workspace.connectionChecker.canConnect(e,t,false)?t.connect(e):e==null||e.onFailedConnect(t))}getOnlyValueConnection_(){let e=null;for(let t=0;t<this.inputList.length;t++){const r=this.inputList[t].connection;if(r&&r.type===Ne.INPUT_VALUE&&r.targetConnection){if(e)return null;e=r}}return e}unplugFromStack_(e){let t=null;this.previousConnection.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect());const r=this.getNextBlock();e&&r&&!r.isShadow()&&(e=this.nextConnection.targetConnection,e==null||e.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,false)&&t.connect(e))}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t=0,r;r=this.inputList[t];t++)r.connection&&e.push(r.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const r=t.targetBlock();if(!r||e&&r.isShadow())return t;t=r.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t=0,r;r=this.inputList[t];t++)if(r.connection&&r.connection.targetBlock()===e)return r;return null}getSurroundParent(){let e=this,t;do if(t=e,e=e.getParent(),!e)return null;while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getFirstStatementConnection(){for(let e=0,t;t=this.inputList[e];e++)if(t.connection&&t.connection.type===Ne.NEXT_STATEMENT)return t.connection;return null}getRootBlock(){let e,t=this;do e=t,t=e.parentBlock_;while(t);return e}getTopStackBlock(){let e=this,t;do t=e.getPreviousBlock();while(t&&t.getNextBlock()===e&&(e=t));return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let r=0,a;a=this.inputList[r];r++)if(a.connection){var t=a.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),r=!!t;if(r&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!r&&e)throw Error("Block not connected to new parent.");if(r&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?Xs(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],r=this.getChildren(e);for(let a,d=0;a=r[d];d++)t.push(...a.getDescendants(e));return t}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setDeletable(e){this.deletable_=e}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setMovable(e){this.movable_=e}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(J(this,true)):true}isShadow(){return this.isShadow_}setShadow(e){this.isShadow_=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setEditable(e){this.editable_=e;for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)d.updateEditable()}isDisposed(){return this.disposed}getMatchingConnection(e,t){const r=this.getConnections_(true);if(e=e.getConnections_(true),r.length!==e.length)throw Error("Connection lists did not match in length.");for(let a=0;a<e.length;a++)if(e[a]===t)return r[a];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return xa(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(e){e=Oo(e),this.hue_=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&typeof e!="function")throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=e,this.onchangeWrapper_=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(e){if(typeof e!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(e===void 0?"nothing":e+" of type "+typeof e)+" instead");for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)if(d.name===e)return d;return null}getVars(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)d.referencesVariables()&&e.push(d.getValue());return e}getVarModels(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)if(d.referencesVariables()){const C=this.workspace.getVariableById(d.getValue());C&&e.push(C)}return e}updateVarName(e){for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)d.referencesVariables()&&e.getId()===d.getValue()&&d.refreshVariableName()}renameVarById(e,t){for(let r=0,a;a=this.inputList[r];r++)for(let d=0,C;C=a.fieldRow[d];d++)C.referencesVariables()&&e===C.getValue()&&C.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const r=this.getField(t);if(!r)throw Error('Field "'+t+'" not found.');r.setValue(e)}setPreviousStatement(e,t){if(e)t===void 0&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Ne.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)t===void 0&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Ne.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)t===void 0&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Ne.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(Pe(new(ve(vs))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type===it.DUMMY&&this.inputList[e].type===it.DUMMY)return false;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type===it.VALUE&&this.inputList[e].type===it.DUMMY)return true;return false}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(e){if(this.isEnabled()!==e){const t=this.disabled;this.disabled=!e,Pe(new(ve(vs))(this,"disabled",null,t,!e))}}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(e.disabled)return true;e=e.getSurroundParent()}return false}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(Pe(new(ve(vs))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){function r(ke){let ft=ke.getCheck();return!ft&&ke.targetConnection&&(ft=ke.targetConnection.getCheck()),!!ft&&(ft.indexOf("Boolean")!==-1||ft.indexOf("Number")!==-1)}function a(){let ke,ft;M&&M.getType()===((ke=z)==null?void 0:ke.getType())&&M.getLocation()===((ft=z)==null?void 0:ft.getLocation())&&(M=null)}var d=[];t=t||"?";const C=_e.NAVIGATE_ALL_FIELDS;_e.NAVIGATE_ALL_FIELDS=true;let M=_e.createBlockNode(this);const z=M;for(;M;){switch(M.getType()){case _e.types.INPUT:var he=M.getLocation();M.in()?r(he)&&d.push("("):d.push(t);break;case _e.types.FIELD:he=M.getLocation(),he.name!==hl&&d.push(he.getText())}if(he=M,M=he.in()||he.next(),!M){for(M=he.out(),a();M&&!M.next();)M=M.out(),a(),M&&M.getType()===_e.types.INPUT&&r(M.getLocation())&&d.push(")");M&&(M=M.next())}}for(_e.NAVIGATE_ALL_FIELDS=C,t=2;t<d.length;t++)d[t-2]==="("&&d[t]===")"&&(d[t-2]=d[t-1],d.splice(t-1,2));return d=d.reduce(function(ke,ft){return ke+(ke.substr(-1)==="("||ft===")"?"":" ")+ft},""),d=d.trim()||"???",e&&d.length>e&&(d=d.substring(0,e-3)+"..."),d}appendValueInput(e){return this.appendInput_(it.VALUE,e)}appendStatementInput(e){return this.appendInput_(it.STATEMENT,e)}appendDummyInput(e){return this.appendInput_(it.DUMMY,e||"")}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");e.style?this.jsonInitStyle_(e,t):this.jsonInitColour_(e,t);for(var r=0;e["message"+r]!==void 0;)this.interpolate_(e["message"+r],e["args"+r]||[],e["lastDummyAlign"+r],t),r++;if(e.inputsInline!==void 0&&this.setInputsInline(e.inputsInline),e.output!==void 0&&this.setOutput(true,e.output),e.outputShape!==void 0&&this.setOutputShape(e.outputShape),e.previousStatement!==void 0&&this.setPreviousStatement(true,e.previousStatement),e.nextStatement!==void 0&&this.setNextStatement(true,e.nextStatement),e.tooltip!==void 0&&(r=Jt(e.tooltip),this.setTooltip(r)),e.enableContextMenu!==void 0&&(this.contextMenu=!!e.enableContextMenu),e.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),e.helpUrl!==void 0&&(r=Jt(e.helpUrl),this.setHelpUrl(r)),typeof e.extensions=="string"&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),e.mutator!==void 0&&Uh(e.mutator,this,true),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Uh(e[t],this,false)}jsonInitColour_(e,t){if("colour"in e)if(e.colour===void 0)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch{console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle_(e,t){e=e.style;try{this.setStyle(e)}catch{console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(t!==void 0&&typeof t!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const r in e)this[r]!==void 0&&t.push(r);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate_(e,t,r,a){e=Lh(e),this.validateTokens_(e,t.length),t=this.interpolateArguments_(e,t,r),r=[];for(let d=0,C;C=t[d];d++)if(this.isInputKeyword_(C.type)){if(e=this.inputFromJson_(C,a)){for(let M=0,z;z=r[M];M++)e.appendField(z[0],z[1]);r.length=0}}else(e=this.fieldFromJson_(C))&&r.push([e,C.name])}validateTokens_(e,t){const r=[];let a=0;for(let d=0;d<e.length;d++){const C=e[d];if(typeof C=="number"){if(1>C||C>t)throw Error('Block "'+this.type+'": Message index %'+C+" out of range.");if(r[C])throw Error('Block "'+this.type+'": Message index %'+C+" duplicated.");r[C]=true,a++}}if(a!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments_(e,t,r){const a=[];for(let d=0;d<e.length;d++){let C=e[d];typeof C=="number"&&(C=t[C-1]),!(typeof C=="string"&&(C=this.stringToFieldJson_(C),!C))&&a.push(C)}return(e=a.length)&&!this.isInputKeyword_(a[e-1].type)&&(e={type:"input_dummy"},r&&(e.align=r),a.push(e)),a}fieldFromJson_(e){const t=Dh(e);return!t&&e.alt?typeof e.alt=="string"?(e=this.stringToFieldJson_(e.alt))?this.fieldFromJson_(e):null:this.fieldFromJson_(e.alt):t}inputFromJson_(e,t){var r={LEFT:i.Align$$module$build$src$core$input.LEFT,RIGHT:i.Align$$module$build$src$core$input.RIGHT,CENTRE:i.Align$$module$build$src$core$input.CENTRE,CENTER:i.Align$$module$build$src$core$input.CENTRE};let a=null;switch(e.type){case"input_value":a=this.appendValueInput(e.name);break;case"input_statement":a=this.appendStatementInput(e.name);break;case"input_dummy":a=this.appendDummyInput(e.name)}return a?(e.check&&a.setCheck(e.check),e.align&&(r=r[e.align.toUpperCase()],r===void 0?console.warn(t+"Illegal align value: ",e.align):a.setAlign(r)),a):null}isInputKeyword_(e){return e==="input_value"||e==="input_statement"||e==="input_dummy"}stringToFieldJson_(e){return(e=e.trim())?{type:"field_label",text:e}:null}appendInput_(e,t){let r=null;return(e===it.VALUE||e===it.STATEMENT)&&(r=this.makeConnection_(e)),e===it.STATEMENT&&this.statementInputCount++,e=new Ko(e,t,this,r),this.inputList.push(e),e}moveInputBefore(e,t){if(e!==t){var r=-1,a=t?-1:this.inputList.length;for(let d=0,C;C=this.inputList[d];d++)if(C.name===e){if(r=d,a!==-1)break}else if(t&&C.name===t&&(a=d,r!==-1))break;if(r===-1)throw Error('Named input "'+e+'" not found.');if(a===-1)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(r,a)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const r=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,r)}removeInput(e,t){for(let r=0,a;a=this.inputList[r];r++)if(a.name===e)return a.type===it.STATEMENT&&this.statementInputCount--,a.dispose(),this.inputList.splice(r,1),true;if(t)return false;throw Error("Input not found: "+e)}getInput(e){for(let t=0,r;r=this.inputList[t];t++)if(r.name===e)return r;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){return this.commentModel.text}setCommentText(e){this.commentModel.text!==e&&(Pe(new(ve(vs))(this,"comment",null,this.commentModel.text,e)),this.comment=this.commentModel.text=e)}setWarningText(e,t){}setMutator(e){}getRelativeToSurfaceXY(){return this.xy_}moveBy(e,t){if(this.parentBlock_)throw Error("Block has parent.");const r=new(ve(Ps))(this);this.xy_.translate(e,t),r.recordNew(),Pe(r)}makeConnection_(e){return new Tt(this,e)}allInputsFilled(e){if(e===void 0&&(e=true),!e&&this.isShadow())return false;for(let r=0,a;a=this.inputList[r];r++)if(a.connection){var t=a.connection.targetBlock();if(!t||!t.allInputsFilled(e))return false}return(t=this.getNextBlock())?t.allInputsFilled(e):true}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};Yo.COLLAPSED_INPUT_NAME=ul,Yo.COLLAPSED_FIELD_NAME=hl;var pu=null,dl=null,_l={};_l.connectionUiEffect=Qm,_l.disconnectUiEffect=tE,_l.disconnectUiStop=Pa,_l.disposeUiEffect=Jm;var Db=class extends hu{constructor(e){super(e),this.cachedText="",this.paragraphElement_=this.textarea_=this.foreignObject=this.onInputWrapper=this.onChangeWrapper=this.onWheelWrapper=this.onMouseUpWrapper=null,this.model=e.commentModel;let t;this.model.text=(t=this.model.text)!=null?t:"",this.createIcon()}drawIcon_(e){G(te.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},e),G(te.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},e),G(te.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},e)}createEditor(){this.foreignObject=G(te.FOREIGNOBJECT,{x:Qe.BORDER_WIDTH,y:Qe.BORDER_WIDTH});const e=document.createElementNS(Hi,"body");e.setAttribute("xmlns",Hi),e.className="blocklyMinimalBody";const t=this.textarea_=document.createElementNS(Hi,"textarea");t.className="blocklyCommentTextarea",t.setAttribute("dir",this.getBlock().RTL?"RTL":"LTR");let r;return t.value=(r=this.model.text)!=null?r:"",this.resizeTextarea(),e.appendChild(t),this.foreignObject.appendChild(e),this.onMouseUpWrapper=T(t,"focus",this,this.startEdit,true),this.onWheelWrapper=T(t,"wheel",this,function(a){a.stopPropagation()}),this.onChangeWrapper=T(t,"change",this,function(a){this.cachedText!==this.model.text&&Pe(new(ve(vs))(this.getBlock(),"comment",null,this.cachedText,this.model.text))}),this.onInputWrapper=T(t,"input",this,function(a){this.model.text=t.value}),setTimeout(t.focus.bind(t),0),this.foreignObject}updateEditable(){super.updateEditable(),this.isVisible()&&(this.disposeBubble(),this.createBubble())}onBubbleResize(){this.isVisible()&&this.bubble_&&(this.model.size=this.bubble_.getBubbleSize(),this.resizeTextarea())}resizeTextarea(){if(this.textarea_&&this.foreignObject){var e=this.model.size,t=2*Qe.BORDER_WIDTH,r=e.width-t;e=e.height-t,this.foreignObject.setAttribute("width",`${r}`),this.foreignObject.setAttribute("height",`${e}`),this.textarea_.style.width=r-4+"px",this.textarea_.style.height=e-4+"px"}}setVisible(e){e!==this.isVisible()&&(Pe(new(ve(xn))(this.getBlock(),e,"comment")),(this.model.pinned=e)?this.createBubble():this.disposeBubble())}createBubble(){this.getBlock().isEditable()?this.createEditableBubble():this.createNonEditableBubble()}createEditableBubble(){const e=this.getBlock();this.bubble_=new Qe(e.workspace,this.createEditor(),e.pathObject.svgPath,this.iconXY_,this.model.size.width,this.model.size.height),this.bubble_.setSvgId(e.id),this.bubble_.registerResizeEvent(this.onBubbleResize.bind(this)),this.applyColour()}createNonEditableBubble(){let e;this.paragraphElement_=Qe.textToDom((e=this.model.text)!=null?e:""),this.bubble_=Qe.createNonEditableBubble(this.paragraphElement_,this.getBlock(),this.iconXY_),this.applyColour()}disposeBubble(){this.onMouseUpWrapper&&(g(this.onMouseUpWrapper),this.onMouseUpWrapper=null),this.onWheelWrapper&&(g(this.onWheelWrapper),this.onWheelWrapper=null),this.onChangeWrapper&&(g(this.onChangeWrapper),this.onChangeWrapper=null),this.onInputWrapper&&(g(this.onInputWrapper),this.onInputWrapper=null),this.bubble_&&(this.bubble_.dispose(),this.bubble_=null),this.paragraphElement_=this.foreignObject=this.textarea_=null}startEdit(e){let t;(t=this.bubble_)!=null&&t.promote()&&this.textarea_.focus(),this.cachedText=this.model.text}getBubbleSize(){return this.model.size}setBubbleSize(e,t){this.bubble_?this.bubble_.setBubbleSize(e,t):(this.model.size.width=e,this.model.size.height=t)}updateText(){if(this.textarea_){let e;this.textarea_.value=(e=this.model.text)!=null?e:""}else this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model.text)}dispose(){this.getBlock().comment=null,super.dispose()}};us(`
.blocklyCommentTextarea {
  background-color: #fef49c;
  border: 0;
  display: block;
  margin: 0;
  outline: 0;
  padding: 3px;
  resize: none;
  text-overflow: hidden;
}
`);var Fn=null,zd={duplicateInternal:bC,copyInternal:EC},pl={};pl.TEST_ONLY=zd,pl.copy=Ua,pl.duplicate=Nc,pl.paste=Wh;var gl,jd,fl;gl=null,jd={},fl=null,i.module$build$src$core$contextmenu={},i.module$build$src$core$contextmenu.callbackFactory=yC,i.module$build$src$core$contextmenu.commentDeleteOption=oE,i.module$build$src$core$contextmenu.commentDuplicateOption=aE,i.module$build$src$core$contextmenu.dispose=rE,i.module$build$src$core$contextmenu.getCurrentBlock=iE,i.module$build$src$core$contextmenu.hide=Dc,i.module$build$src$core$contextmenu.setCurrentBlock=nE,i.module$build$src$core$contextmenu.show=Mc,i.module$build$src$core$contextmenu.workspaceCommentOption=RC;var St=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(e){if(this.registry_.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registry_.set(e.id,e)}unregister(e){if(!this.registry_.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registry_.delete(e)}getItem(e){let t;return(t=this.registry_.get(e))!=null?t:null}getContextMenuOptions(e,t){const r=[];for(const d of this.registry_.values())if(e===d.scopeType){var a=d.preconditionFn(t);a!=="hidden"&&(a={text:typeof d.displayText=="function"?d.displayText(t):d.displayText,enabled:a==="enabled",callback:d.callback,scope:t,weight:d.weight},r.push(a))}return r.sort(function(d,C){return d.weight-C.weight}),r}};(function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",e.registry=new e})(St||(St={})),St.ScopeType;var xb=30,Bb=true,Xr=[];Xr[Ne.INPUT_VALUE]=Ne.OUTPUT_VALUE,Xr[Ne.OUTPUT_VALUE]=Ne.INPUT_VALUE,Xr[Ne.NEXT_STATEMENT]=Ne.PREVIOUS_STATEMENT,Xr[Ne.PREVIOUS_STATEMENT]=Ne.NEXT_STATEMENT;var Xd="RENAME_VARIABLE_ID",Kd="DELETE_VARIABLE_ID",Pb=class{constructor(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"}setDrawer(e){this.drawer_=e}getDrawer(){return this.drawer_}getCurNode(){return this.curNode_}setCurNode(e){const t=this.curNode_;this.curNode_=e,this.drawer_&&this.drawer_.draw(t,this.curNode_)}draw(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)}hide(){this.drawer_&&this.drawer_.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},Yd=class extends Pb{constructor(){super(),this.type="cursor"}next(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()===_e.types.NEXT||e.getType()===_e.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e}in(){var e=this.getCurNode();if(!e)return null;(e.getType()===_e.types.PREVIOUS||e.getType()===_e.types.OUTPUT)&&(e=e.next());let t,r;return(e=(r=(t=e)==null?void 0:t.in())!=null?r:null)&&this.setCurNode(e),e}prev(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()===_e.types.NEXT||e.getType()===_e.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e}out(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()===_e.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null}};Ie(Te.CURSOR,Dn,Yd);var ml=class extends Yd{constructor(){super()}next(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null}in(){return this.next()}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null}out(){return this.prev()}getNextNode_(e,t){if(!e)return null;const r=e.in()||e.next();return t(r)?r:r?this.getNextNode_(r,t):(e=this.findSiblingOrParent_(e.out()),t(e)?e:e?this.getNextNode_(e,t):null)}getPreviousNode_(e,t){if(!e)return null;let r=e.prev();return r=r?this.getRightMostChild_(r):e.out(),t(r)?r:r?this.getPreviousNode_(r,t):null}validNode_(e){let t=false;return e=e&&e.getType(),(e===_e.types.OUTPUT||e===_e.types.INPUT||e===_e.types.FIELD||e===_e.types.NEXT||e===_e.types.PREVIOUS||e===_e.types.WORKSPACE)&&(t=true),t}findSiblingOrParent_(e){if(!e)return null;const t=e.next();return t||this.findSiblingOrParent_(e.out())}getRightMostChild_(e){if(!e.in())return e;for(e=e.in();e&&e.next();)e=e.next();return this.getRightMostChild_(e)}};ml.registrationName="basicCursor",Ie(Te.CURSOR,ml.registrationName,ml);var Ub=class extends ml{validNode_(e){let t=false;const r=e&&e.getType();return e&&(e=e.getLocation(),r===_e.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(t=true)),t}},qd=10,Us=class extends Tt{constructor(e,t){super(e,t),this.targetConnection=this.highlightPath=null,this.db_=e.workspace.connectionDBList[t],this.dbOpposite_=e.workspace.connectionDBList[Xr[t]],this.offsetInBlock_=new we(0,0),this.trackedState_=Us.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState_===Us.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e){if(!this.sourceBlock_.workspace.isDragging()){var t=this.sourceBlock_.getRootBlock();if(!t.isInFlyout){var r=false;if(!t.isMovable()){if(t=e.getSourceBlock().getRootBlock(),!t.isMovable())return;e=this,r=true}var a=B()==t;a||t.addSelect();var d=e.x+i.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*qd)-this.x,C=e.y+i.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*qd)-this.y;r&&(C=-C),t.RTL&&(d=e.x-i.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*qd)-this.x),t.moveBy(d,C),a||t.removeSelect()}}}moveTo(e,t){this.trackedState_===Us.TrackedState.WILL_TRACK?(this.db_.addConnection(this,t),this.trackedState_=Us.TrackedState.TRACKED):this.trackedState_===Us.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,t)),this.x=e,this.y=t}moveBy(e,t){this.moveTo(this.x+e,this.y+t)}moveToOffset(e){this.moveTo(e.x+this.offsetInBlock_.x,e.y+this.offsetInBlock_.y)}setOffsetInBlock(e,t){this.offsetInBlock_.x=e,this.offsetInBlock_.y=t}getOffsetInBlock(){return this.offsetInBlock_}tighten(){const e=this.targetConnection.x-this.x,t=this.targetConnection.y-this.y;if(e!==0||t!==0){const a=this.targetBlock();var r=a.getSvgRoot();if(!r)throw Error("block is not rendered.");r=_i(r),a.getSvgRoot().setAttribute("transform","translate("+(r.x-e)+","+(r.y-t)+")"),a.moveConnections(-e,-t)}}closest(e,t){return this.dbOpposite_.searchForClosest(this,e,t)}highlight(){if(!this.highlightPath){var e=this.sourceBlock_.workspace.getRenderer().getConstants(),t=e.shapeFor(this);this.type===Ne.INPUT_VALUE||this.type===Ne.OUTPUT_VALUE?(e=e.TAB_OFFSET_FROM_TOP,t=Vt(0,-e)+Me("v",e)+t.pathDown+Me("v",e)):(e=e.NOTCH_OFFSET_LEFT-e.CORNER_RADIUS,t=Vt(-e,0)+Me("h",e)+t.pathLeft+Me("h",e)),e=this.sourceBlock_.getRelativeToSurfaceXY(),this.highlightPath=G(te.PATH,{class:"blocklyHighlightedConnectionPath",d:t,transform:"translate("+(this.x-e.x)+","+(this.y-e.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())}}unhighlight(){this.highlightPath&&(W(this.highlightPath),this.highlightPath=null)}setTracking(e){e&&this.trackedState_===Us.TrackedState.TRACKED||!e&&this.trackedState_===Us.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db_.addConnection(this,this.y),this.trackedState_=Us.TrackedState.TRACKED):(this.trackedState_===Us.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=Us.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(false),this.targetConnection){const r=this.targetBlock().getDescendants(false);for(let a=0;a<r.length;a++){var e=r[a],t=e.getConnections_(true);for(let d=0;d<t.length;d++)t[d].setTracking(false);for(e=e.getIcons(),t=0;t<e.length;t++)e[t].setVisible(false)}}}startTrackingAll(){this.setTracking(true);let e=[];if(this.type!==Ne.INPUT_VALUE&&this.type!==Ne.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let r;t.isCollapsed()?(r=[],t.outputConnection&&r.push(t.outputConnection),t.nextConnection&&r.push(t.nextConnection),t.previousConnection&&r.push(t.previousConnection)):r=t.getConnections_(true);for(let a=0;a<r.length;a++)e.push(...r[a].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(Ls()){const r=Bt();setTimeout(function(){t.isDisposed()||t.getParent()||(He(r),this.bumpAwayFrom(e),He(false))}.bind(this),i.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal_(e,t){super.disconnectInternal_(e,t),e.rendered&&e.render(),t.rendered&&(t.updateDisabled(),t.render(),t.getSvgRoot().style.display="block")}respawnShadow_(){super.respawnShadow_();var e=this.targetBlock();e&&(e.initSvg(),e.render(false),e=this.getSourceBlock(),e.rendered&&e.render())}neighbours(e){return this.dbOpposite_.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock();const r=t.rendered,a=e.rendered;r&&t.updateDisabled(),a&&e.updateDisabled(),r&&a&&(this.type===Ne.NEXT_STATEMENT||this.type===Ne.PREVIOUS_STATEMENT?e.render():t.render()),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,false)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}};(function(e){e=e.TrackedState||(e.TrackedState={}),e[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"})(Us||(Us={})),Us.TrackedState;var Fb=class extends hu{constructor(e){super(e),this.paragraphElement=null,this.collapseHidden=false,this.createIcon(),this.text=Object.create(null)}drawIcon_(e){G(te.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},e),G(te.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},e),G(te.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},e)}setVisible(e){e!==this.isVisible()&&(Pe(new(ve(xn))(this.getBlock(),e,"warning")),e?this.createBubble():this.disposeBubble())}createBubble(){this.paragraphElement=Qe.textToDom(this.getText()),this.bubble_=Qe.createNonEditableBubble(this.paragraphElement,this.getBlock(),this.iconXY_),this.applyColour()}disposeBubble(){this.bubble_&&(this.bubble_.dispose(),this.bubble_=null),this.paragraphElement=null}setText(e,t){this.text[t]!==e&&(e?this.text[t]=e:delete this.text[t],this.isVisible()&&(this.setVisible(false),this.setVisible(true)))}getText(){const e=[];for(const t in this.text)e.push(this.text[t]);return e.join(`
`)}dispose(){this.getBlock().warning=null,super.dispose()}},Li=class extends Yo{constructor(e,t,r){super(e,t,r),this.renderingDebugger=null,this.width=this.height=0,this.warningTextDb=new Map,this.warning=this.commentIcon_=this.mutator=null,this.eventsInit_=this.renderIsInProgress_=this.rendered=false,this.workspace=e,this.decompose=this.decompose,this.compose=this.compose,this.saveConnections=this.saveConnections,this.customContextMenu=this.customContextMenu,this.svgGroup_=G(te.G,{}),this.svgGroup_.translate_="",this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup_,this.style),this.useDragSurface_=!!e.getBlockDragSurface(),e=this.pathObject.svgPath,e.tooltip=this,yc(e),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(let t=0,r;r=this.inputList[t];t++)r.init();var e=this.getIcons();for(let t=0;t<e.length;t++)e[t].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||T(e,"pointerdown",this,this.onMouseDown_),this.eventsInit_=true,e.parentNode||this.workspace.getCanvas().appendChild(e)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(B()!==this){var e=null;if(B()){e=B().id,Yt();try{B().unselect()}finally{qt()}}e=new(ve(or))(e,this.id,this.workspace.id),Pe(e),H(this),this.addSelect()}}unselect(){if(B()===this){var e=new(ve(or))(this.id,null,this.workspace.id);e.workspaceId=this.workspace.id,Pe(e),H(null),this.removeSelect()}}getIcons(){const e=[];return this.mutator&&e.push(this.mutator),this.commentIcon_&&e.push(this.commentIcon_),this.warning&&e.push(this.warning),e}setParent(e){const t=this.parentBlock_;if(e!==t){Xe(),super.setParent(e),Re();var r=this.getSvgRoot();if(!this.workspace.isClearing&&r){var a=this.getRelativeToSurfaceXY();e?(e.getSvgRoot().appendChild(r),e=this.getRelativeToSurfaceXY(),this.moveConnections(e.x-a.x,e.y-a.y)):t&&(this.workspace.getCanvas().appendChild(r),this.translate(a.x,a.y)),this.applyColour()}}}getRelativeToSurfaceXY(){let e=0,t=0;const r=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;let a=this.getSvgRoot();if(a)do{var d=_i(a);e+=d.x,t+=d.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===a&&(d=this.workspace.getBlockDragSurface().getSurfaceTranslation(),e+=d.x,t+=d.y),a=a.parentNode}while(a&&a!==this.workspace.getCanvas()&&a!==r);return new we(e,t)}moveBy(e,t){if(this.parentBlock_)throw Error("Block has parent.");const r=as();let a=null;r&&(a=new(ve(Ps))(this));const d=this.getRelativeToSurfaceXY();this.translate(d.x+e,d.y+t),this.moveConnections(e,t),r&&a&&(a.recordNew(),Pe(a)),this.workspace.resizeContents()}translate(e,t){this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")}moveToDragSurface(){if(this.useDragSurface_){var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(e.x,e.y),(e=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(e)}}moveTo(e){const t=this.getRelativeToSurfaceXY();this.moveBy(e.x-t.x,e.y-t.y)}moveOffDragSurface(e){this.useDragSurface_&&(this.translate(e.x,e.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))}moveDuringDrag(e){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(e.x,e.y):(this.svgGroup_.translate_="translate("+e.x+","+e.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))}clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform")}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var e=this.workspace.getGrid();if(e&&e.shouldSnap()){var t=e.getSpacing(),r=t/2,a=this.getRelativeToSurfaceXY();e=Math.round(Math.round((a.x-r)/t)*t+r-a.x),t=Math.round(Math.round((a.y-r)/t)*t+r-a.y),(e||t)&&this.moveBy(e,t)}}}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY(),t=this.getHeightWidth();let r,a;return this.RTL?(r=e.x-t.width,a=e.x):(r=e.x,a=e.x+t.width),new Zt(e.y,e.y+t.height,r,a)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e=0,t;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),e?this.rendered&&this.render():this.updateCollapsed_())}updateCollapsed_(){var e=this.isCollapsed();const t=ul,r=hl;for(let d=0,C;C=this.inputList[d];d++)C.name!==t&&C.setVisible(!e);if(e){e=this.getIcons();for(let d=0,C;C=e[d];d++)C.setVisible(false);e=this.toString(xb);var a=this.getField(r);a?a.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new i.FieldLabel$$module$build$src$core$field_label(e),r)}else this.updateDisabled(),this.removeInput(t)}tab(e,t){const r=new Ub;r.setCurNode(_e.createFieldNode(e)),e=r.getCurNode(),t?r.next():r.prev(),(t=r.getCurNode())&&t!==e&&(t.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(t))}onMouseDown_(e){const t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}showHelp(){const e=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const e=St.registry.getContextMenuOptions(St.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e}showContextMenu(e){const t=this.generateContextMenu();t&&t.length&&(Mc(e,t,this.RTL),nE(this))}moveConnections(e,t){if(this.rendered){for(var r=this.getConnections_(false),a=0;a<r.length;a++)r[a].moveBy(e,t);for(r=this.getIcons(),a=0;a<r.length;a++)r[a].computeIconLocation();for(r=0;r<this.childBlocks_.length;r++)this.childBlocks_[r].moveConnections(e,t)}}setDragging(e){if(e){var t=this.getSvgRoot();t.translate_="",t.skew_="",Br.push(...this.getConnections_(true)),ae(this.svgGroup_,"blocklyDragging")}else Br.length=0,fe(this.svgGroup_,"blocklyDragging");for(t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(true))}getSvgRoot(){return this.svgGroup_}dispose(e,t){if(!this.isDeadOrDying()){Nm(),Rc(this.pathObject.svgPath),Xe();var r=this.workspace;B()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),iE()===this&&Dc(),t&&this.rendered&&(this.unplug(e),Jm(this)),this.rendered=false;for(var a of this.warningTextDb.values())clearTimeout(a);for(this.warningTextDb.clear(),t=this.getIcons(),a=0;a<t.length;a++)t[a].dispose();B()===this&&H(null),super.dispose(!!e),W(this.svgGroup_),r.resizeContents(),this.svgGroup_=null,Re()}}checkAndDelete(){this.workspace.isFlyout||(He(true),this.workspace.hideChaff(),this.outputConnection?this.dispose(false,true):this.dispose(true,true),He(false))}toCopyData(){return this.isInsertionMarker_?null:{saveInfo:Ln(this,{addCoordinates:true,addNextBlocks:false}),source:this.workspace,typeCounts:J(this,true)}}applyColour(){this.pathObject.applyColour(this);const e=this.getIcons();for(let t=0;t<e.length;t++)e[t].applyColour();for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)d.applyColour()}updateDisabled(){const e=this.getChildren(false);if(this.applyColour(),!this.isCollapsed())for(let t=0,r;r=e[t];t++)r.rendered&&r.updateDisabled()}getCommentIcon(){return this.commentIcon_}setCommentText(e){this.commentModel.text!==e&&(super.setCommentText(e),e=e!==null,!!this.commentIcon_===e?this.commentIcon_.updateText():(e?this.comment=this.commentIcon_=new Db(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))}setWarningText(e,t){const r=t||"";if(r)this.warningTextDb.has(r)&&(clearTimeout(this.warningTextDb.get(r)),this.warningTextDb.delete(r));else{for(var a of this.warningTextDb.values())clearTimeout(a);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(r,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(r),this.setWarningText(e,r))},100));else{if(this.isInFlyout&&(e=null),t=false,typeof e=="string"){a=this.getSurroundParent();let d=null;for(;a;)a.isCollapsed()&&(d=a),a=a.getSurroundParent();d&&d.setWarningText(je.COLLAPSED_WARNINGS_WARNING,Li.COLLAPSED_WARNING_ID),this.warning||(this.warning=new Fb(this),t=true),this.warning.setText(e,r)}else this.warning&&!r?(this.warning.dispose(),t=true):this.warning&&(t=this.warning.getText(),this.warning.setText("",r),(a=this.warning.getText())||this.warning.dispose(),t=t!==a);t&&this.rendered&&(this.render(),this.bumpNeighbours())}}setMutator(e){this.mutator&&this.mutator!==e&&this.mutator.dispose(),e&&(e.setBlock(this),this.mutator=e,e.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())}setEnabled(e){this.isEnabled()!==e&&(super.setEnabled(e),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(e){this.rendered&&this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(true)}removeSelect(){this.pathObject.updateSelected(false)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,t)this.hat=t.hat,this.pathObject.setStyle(t),this.colour_=t.colourPrimary,this.style=t,this.applyColour();else throw Error("Invalid style name: "+e)}bringToFront(){let e=this;do{const t=e.getSvgRoot(),r=t.parentNode,a=r.childNodes;a[a.length-1]!==t&&r.appendChild(t),e=e.getParent()}while(e)}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}setNextStatement(e,t){super.setNextStatement(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}setOutput(e,t){super.setOutput(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}setInputsInline(e){super.setInputsInline(e),this.rendered&&(this.render(),this.bumpNeighbours())}removeInput(e,t){return e=super.removeInput(e,t),this.rendered&&(this.render(),this.bumpNeighbours()),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}appendInput_(e,t){return e=super.appendInput_(e,t),this.rendered&&(this.render(),this.bumpNeighbours()),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var r=this.inputList[t].connection;r&&(r.setTracking(e),(r=r.targetBlock())&&r.setConnectionTracking(e))}}getConnections_(e){const t=[];if((e||this.rendered)&&(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_))for(let r=0,a;a=this.inputList[r];r++)a.connection&&t.push(a.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Us(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){this.getRootBlock().bumpNeighboursInternal()}bumpNeighboursInternal(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(false)){if(t.isSuperior()){let r;(r=t.targetBlock())==null||r.bumpNeighboursInternal()}for(const r of t.neighbours(i.config$$module$build$src$core$config.snapRadius))r.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&r.isConnected()||(t.isSuperior()?r.bumpAwayFrom(t):t.bumpAwayFrom(r)))}}scheduleSnapAndBump(){const e=Bt();setTimeout(()=>{He(e),this.snapToGrid(),He(false)},i.config$$module$build$src$core$config.bumpDelay/2),setTimeout(()=>{He(e),this.bumpNeighbours(),He(false)},i.config$$module$build$src$core$config.bumpDelay)}positionNearConnection(e,t){e.type!==Ne.NEXT_STATEMENT&&e.type!==Ne.INPUT_VALUE||this.moveBy(t.x-e.x,t.y-e.y)}getFirstStatementConnection(){return super.getFirstStatementConnection()}getChildren(e){return super.getChildren(e)}render(e){if(!this.renderIsInProgress_){this.renderIsInProgress_=true;try{if(this.rendered=true,Xe(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),e!==false){const t=this.getParent();t?t.render(true):this.workspace.resizeContents()}Re(),this.updateMarkers_()}finally{this.renderIsInProgress_=false}}}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(Qa.LOCAL_MARKER).draw()}updateConnectionLocations_(){const e=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(e),this.outputConnection&&this.outputConnection.moveToOffset(e);for(let t=0;t<this.inputList.length;t++){const r=this.inputList[t].connection;r&&(r.moveToOffset(e),r.isConnected()&&r.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(e),this.nextConnection.isConnected()&&this.nextConnection.tighten())}setCursorSvg(e){this.pathObject.setCursorSvg(e)}setMarkerSvg(e){this.pathObject.setMarkerSvg(e)}getHeightWidth(){let e=this.height,t=this.width;var r=this.getNextBlock();if(r){r=r.getHeightWidth();const a=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=r.height-a,t=Math.max(t,r.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}};Li.INLINE=-1,Li.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Gb=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return false}},gu=class extends Gb{constructor(){super(),this.wouldDelete_=false}wouldDelete(e,t){return e instanceof Li?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e&&!t)):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},Gn;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"})(Gn||(Gn={}));var qo;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(qo||(qo={}));var ur;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"})(ur||(ur={}));var Kr={};Kr.bumpDirection=ur,Kr.bumpPositionRect=Xh,Kr.getCornerOppositeToolbox=jh,Kr.getStartPositionRect=zh,Kr.horizontalPosition=qo,Kr.verticalPosition=Gn;var Fs={width:96,height:124,url:"sprites.png"},Hb=class extends gu{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents_=[],this.flyout=null,this.isLidOpen=false,this.minOpenness_=0,this.lidTask_=this.svgLid_=this.svgGroup_=null,this.top_=this.left_=this.lidOpen_=0,this.initialized_=false,0>=this.workspace.options.maxTrashcanContents||(e=new Yi({scrollbars:true,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:true}}),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===Je.TOP?Je.BOTTOM:Je.TOP,this.flyout=new(js(Te.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,true))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===Je.RIGHT?Je.LEFT:Je.RIGHT,this.flyout=new(js(Te.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,true))(e)),this.workspace.addChangeListener(this.onDelete_.bind(this)))}createDom(){this.svgGroup_=G(te.G,{class:"blocklyTrash"});let e;const t=String(Math.random()).substring(2);e=G(te.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_),G(te.RECT,{width:Jo,height:fu,y:Zo},e);const r=G(te.IMAGE,{width:Fs.width,x:-Jd,height:Fs.height,y:-Zd,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_);return r.setAttributeNS(qs,"xlink:href",this.workspace.options.pathToMedia+Fs.url),e=G(te.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),G(te.RECT,{width:Jo,height:Zo},e),this.svgLid_=G(te.IMAGE,{width:Fs.width,x:-Jd,height:Fs.height,y:-Zd,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS(qs,"xlink:href",this.workspace.options.pathToMedia+Fs.url),y(this.svgGroup_,"pointerdown",this,this.blockMouseDownWhenOpenable_),y(this.svgGroup_,"pointerup",this,this.click),y(r,"pointerover",this,this.mouseOver_),y(r,"pointerout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_}init(){0<this.workspace.options.maxTrashcanContents&&(Q(this.flyout.createDom(te.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[Ss.Capability.AUTOHIDEABLE,Ss.Capability.DELETE_AREA,Ss.Capability.DRAG_TARGET,Ss.Capability.POSITIONABLE]}),this.initialized_=true,this.setLidOpen(false)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&(W(this.svgGroup_),this.svgGroup_=null),this.svgLid_=null,this.lidTask_&&clearTimeout(this.lidTask_)}hasContents_(){return!!this.contents_.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents_.map(function(r){return JSON.parse(r)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let r;(r=this.flyout)==null||r.show(e),t.cursor=""},10),this.fireUiEvent_(true)}}closeFlyout(){if(this.contentsIsOpen()){var e;(e=this.flyout)==null||e.hide(),this.fireUiEvent_(false),this.workspace.recordDragTargets()}}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())}position(e,t){if(this.initialized_){var r=jh(this.workspace,e);e=zh(r,new Ts(Jo,fu+Zo),bO,Vb,e,this.workspace),t=Xh(e,Vb,r.vertical===Gn.TOP?ur.DOWN:ur.UP,t),this.top_=t.top,this.left_=t.left;var a;(a=this.svgGroup_)==null||a.setAttribute("transform","translate("+this.left_+","+this.top_+")")}}getBoundingRectangle(){return new Zt(this.top_,this.top_+fu+Zo,this.left_,this.left_+Jo)}getClientRect(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect();const t=e.top+Zd-mu;return e=e.left+Jd-mu,new Zt(t,t+Zo+fu+2*mu,e,e+Jo+2*mu)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(false)}onDrop(e){setTimeout(this.setLidOpen.bind(this,false),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask_&&clearTimeout(this.lidTask_),this.isLidOpen=e,this.animateLid_())}animateLid_(){const e=SO;var t=1/(e+1);this.lidOpen_+=this.isLidOpen?t:-t,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*zb),t=Wb+this.lidOpen_*($O-Wb),this.svgGroup_&&(this.svgGroup_.style.opacity=t.toString()),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),TO/e))}setLidAngle_(e){const t=this.workspace.toolboxPosition===Je.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let r;(r=this.svgLid_)==null||r.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:Jo-4)+","+(Zo-2)+")")}setMinOpenness_(e){this.minOpenness_=e,this.isLidOpen||this.setLidAngle_(e*zb)}closeLid(){this.setLidOpen(false)}click(){this.hasContents_()&&this.openFlyout()}fireUiEvent_(e){e=new(ve(ja))(e,this.workspace.id),Pe(e)}blockMouseDownWhenOpenable_(e){!this.contentsIsOpen()&&this.hasContents_()&&e.stopPropagation()}mouseOver_(){this.hasContents_()&&this.setLidOpen(true)}mouseOut_(){this.setLidOpen(false)}onDelete_(e){if(!(0>=this.workspace.options.maxTrashcanContents||e.type!==dn||e.type!==dn||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson_(e.oldJson)),this.contents_.indexOf(e)===-1){for(this.contents_.unshift(e);this.contents_.length>this.workspace.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(vO)}}}cleanBlockJson_(e){function t(r){if(r){if(delete r.id,delete r.x,delete r.y,delete r.enabled,r.icons&&r.icons.comment){var a=r.icons.comment;delete a.height,delete a.width,delete a.pinned}a=r.inputs;for(var d in a){var C=a[d];const M=C.block;C=C.shadow,M&&t(M),C&&t(C)}r.next&&(d=r.next,r=d.block,d=d.shadow,r&&t(r),d&&t(d))}}return e=JSON.parse(JSON.stringify(e)),t(e),Object.assign({},{kind:"BLOCK"},e)}},Jo=47,fu=44,Zo=16,Vb=20,bO=20,mu=10,Jd=0,Zd=32,vO=.1,TO=80,SO=4,Wb=.4,$O=.8,zb=45,Qd=class extends zi{constructor(e,t,r){super(r),this.type=Xa,this.oldItem=e??void 0,this.newItem=t??void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}fromJson(e){o("Blockly.Events.ToolboxItemSelect.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldItem=e.oldItem,this.newItem=e.newItem}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Qd),t.oldItem=e.oldItem,t.newItem=e.newItem,t}};Ie(Te.EVENT,Xa,Qd);var e_=class{constructor(e,t,r){this.id_=e.toolboxitemid||wr(),this.level_=(this.parent_=r||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return false}isCollapsible(){return false}dispose(){}setVisible_(e){}},qi=class extends e_{constructor(e,t,r){super(e,t,r),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=false,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const r=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(r)}}parseCategoryDef_(e){this.name_="name"in e?Jt(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),cn(this.htmlDiv_,Zs.TREEITEM),zt(this.htmlDiv_,Ft.SELECTED,false),zt(this.htmlDiv_,Ft.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),cn(this.iconDom_,Zs.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&zt(this.htmlDiv_,Ft.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ae(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&ae(e,t),t=`${qi.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&ae(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ae(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&ae(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=qi.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle_(t);if(e)return this.parseColour_(e)}return""}getColourfromStyle_(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour_(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(e){if(e=Jt(e),e==null||e==="")return"";var t=Number(e);return isNaN(t)?(t=Mr(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):kh(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&de(e,t),(t=this.cssConfig_.openicon)&&ae(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&de(e,t),(t=this.cssConfig_.closedicon)&&ae(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(false)}show(){this.setVisible_(true)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return false;return true}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const r=this.parseColour_(qi.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||r,t&&ae(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&fe(this.rowDiv_,t);zt(this.htmlDiv_,Ft.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_=typeof e=="string"?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:wc(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){W(this.htmlDiv_)}};qi.registrationName="category",qi.nestedPadding=19,qi.borderWidth=8,qi.defaultBackgroundColour="#57e",us(`
.blocklyTreeRow:not(.blocklyTreeSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {
  margin: 1px 5px 1px 0;
}

.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {
  margin: 1px 0 1px 5px;
}

.blocklyTreeRow {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyTreeIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyTreeIconClosed {
  background-position: -32px -1px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {
  background-position: 0 -1px;
}

.blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: -32px -17px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: 0 -17px;
}

.blocklyTreeIconOpen {
  background-position: -16px -1px;
}

.blocklyTreeSelected>.blocklyTreeIconOpen {
  background-position: -16px -17px;
}

.blocklyTreeLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyTreeLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyTreeSelected .blocklyTreeLabel {
  color: #fff;
}
`),Ie(Te.TOOLBOX_ITEM,qi.registrationName,qi);var El=class extends e_{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ae(e,t),this.htmlDiv_=e}getDiv(){return this.htmlDiv_}dispose(){W(this.htmlDiv_)}};El.registrationName="sep",us(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),Ie(Te.TOOLBOX_ITEM,El.registrationName,El);var Qo=class extends qi{constructor(e,t,r){super(e,t,r),this.subcategoriesDiv_=null,this.expanded_=false,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxContents",e}parseContents_(e){const t=e.contents;let r=true;if(e.custom)this.flyoutItems_=e.custom;else if(t)for(e=0;e<t.length;e++){const a=t[e];!mo(Te.TOOLBOX_ITEM,a.kind)||a.kind.toLowerCase()===El.registrationName&&r?(this.flyoutItems_.push(a),r=true):(this.createToolboxItem_(a),r=false)}}createToolboxItem_(e){let t=e.kind;t.toUpperCase()==="CATEGORY"&&Bh(e)&&(t=Qo.registrationName),e=new(on(Te.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),cn(this.subcategoriesDiv_,Zs.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ae(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");var r=this.cssConfig_.contents;for(r&&ae(t,r),r=0;r<e.length;r++){const a=e[r];a.init();const d=a.getDiv();if(t.appendChild(d),a.getClickTarget){let C;(C=a.getClickTarget())==null||C.setAttribute("id",a.getId())}}return t}setExpanded(e){this.expanded_!==e&&((this.expanded_=e)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),zt(this.htmlDiv_,Ft.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize())}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let r=0;r<t.length;r++)t[r].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return true}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Qo.registrationName="collapsibleCategory",Ie(Te.TOOLBOX_ITEM,Qo.registrationName,Qo);var jb=class extends gu{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=false,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout_=e.options.horizontalLayout,this.RTL=e.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return false}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),Q(this.flyout_.createDom("svg"),t),this.setVisible(true),this.flyout_.init(e),this.render(this.toolboxDef_),e=e.getThemeManager(),e.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[Ss.Capability.AUTOHIDEABLE,Ss.Capability.DELETE_AREA,Ss.Capability.DRAG_TARGET]})}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,cn(this.contentsDiv_,Zs.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),ae(e,"blocklyToolboxDiv"),ae(e,"blocklyNonSelectable"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return ae(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=T(e,"pointerdown",this,this.onClick_,false),this.boundEvents_.push(e),t=T(t,"keydown",this,this.onKeyDown_,false),this.boundEvents_.push(t)}onClick_(e){if(R(e)||e.target===this.HtmlDiv)L().hideChaff(false);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t),t.isSelectable()&&(this.setSelectedItem(t),t.onClick(e))),L().hideChaff(true)}f()}onKeyDown_(e){let t=false;switch(e.keyCode){case xe.DOWN:t=this.selectNext_();break;case xe.UP:t=this.selectPrevious_();break;case xe.LEFT:t=this.selectParent_();break;case xe.RIGHT:t=this.selectChild_();break;case xe.ENTER:case xe.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=true);break;default:t=false}if(!t&&this.selectedItem_){const r=this.selectedItem_;r.onKeyDown&&(t=r.onKeyDown(e))}t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=new Yi({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:true}});return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?js(Te.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,true):js(Te.FLYOUTS_VERTICAL_TOOLBOX,e.options,true))(t)}render(e){this.toolboxDef_=e;for(let t=0;t<this.contents_.length;t++){const r=this.contents_[t];r&&r.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let r=0;r<e.length;r++)this.createToolboxItem_(e[r],t);this.contentsDiv_.appendChild(t)}createToolboxItem_(e,t){var r=e.kind;r.toUpperCase()==="CATEGORY"&&Bh(e)&&(r=Qo.registrationName),(r=on(Te.TOOLBOX_ITEM,r.toLowerCase()))&&(e=new r(e,this),e.init(),this.addToolboxItem_(e),(r=e.getDiv())&&t.appendChild(r),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return this.contents_}addStyle(e){e&&this.HtmlDiv&&ae(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&fe(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,r=t+e.height,a=e.left;return e=a+e.width,this.toolboxPosition===Je.TOP?new Zt(-1e7,r,-1e7,1e7):this.toolboxPosition===Je.BOTTOM?new Zt(t,1e7,-1e7,1e7):this.toolboxPosition===Je.LEFT?new Zt(-1e7,1e7,-1e7,e):new Zt(-1e7,1e7,a,1e7)}wouldDelete(e,t){return e instanceof Li?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(true)}onDragExit(e){this.updateCursorDeleteStyle_(false)}onDrop(e){this.updateCursorDeleteStyle_(false)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(false),this.wouldDelete_=e,this.updateCursorDeleteStyle_(true))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contentMap_[e]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===Je.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===Je.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition===Je.LEFT?e.scrollX+t.width:e.scrollX,this.toolboxPosition===Je.TOP?e.scrollY+t.height:e.scrollY),Z(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let e=0;e<this.contents_.length;e++){const t=this.contents_[e];t.refreshTheme&&t.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!e.isSelectable()||(this.shouldDeselectItem_(t,e)&&t!==null&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&e!==null&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent_(t,e))}shouldDeselectItem_(e,t){return e!==null&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return t!==null&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(false),zt(this.contentsDiv_,Ft.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(true),zt(this.contentsDiv_,Ft.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e],e.isSelectable()&&this.setSelectedItem(e))}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout_.show(t.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(e,t){const r=e&&e.getName();let a=t&&t.getName();e===t&&(a=null),e=new(ve(Xa))(r,a,this.workspace_.id),Pe(e)}selectParent_(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),true):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),true):false:false}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return false;const e=this.selectedItem_;return e.isExpanded()?this.selectNext_():e.toggleExpanded(),true}selectNext_(){if(!this.selectedItem_)return false;let e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[++e];if(t&&t.isSelectable())return this.setSelectedItem(t),true}return false}selectPrevious_(){if(!this.selectedItem_)return false;let e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[--e];if(t&&t.isSelectable())return this.setSelectedItem(t),true}return false}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)g(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),W(this.HtmlDiv)}};us(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolboxDiv {
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxContents {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxContents:focus {
  outline: none;
}
`),Ie(Te.TOOLBOX,Dn,jb);var yO={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},RO={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},IO=new jr("zelos",yO,RO),t_={};t_.Classic=du,t_.Zelos=IO;var s_=class extends zi{constructor(e,t,r){t=e?e.workspace.id:t,t===null&&(t=void 0),super(t),this.type=ar,this.blockId=e?e.id:void 0,this.targetType=r}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}fromJson(e){o("Blockly.Events.Click.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.targetType=e.targetType,this.blockId=e.blockId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new s_),t.targetType=e.targetType,t.blockId=e.blockId,t}},i_;(function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"})(i_||(i_={})),Ie(Te.EVENT,ar,s_);var Xb=class{constructor(e,t){this.bubble=e,this.workspace=t,this.dragTarget_=null,this.wouldDeleteBubble_=false,this.startXY_=this.bubble.getRelativeToSurfaceXY(),this.dragSurface_=t.getBlockDragSurface()}startBubbleDrag(){Bt()||He(true),this.workspace.setResizesEnabled(false),this.bubble.setAutoLayout(false),this.dragSurface_&&(this.bubble.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.bubble.getSvgRoot())),this.bubble.setDragging&&this.bubble.setDragging(true)}dragBubble(e,t){t=this.pixelsToWorkspaceUnits_(t),t=we.sum(this.startXY_,t),this.bubble.moveDuringDrag(this.dragSurface_,t),t=this.dragTarget_,this.dragTarget_=this.workspace.getDragTarget(e),e=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),e!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==t&&(t&&t.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble)),this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(e){return e&&this.workspace.getComponentManager().hasCapability(e.id,Ss.Capability.DELETE_AREA)?e.wouldDelete(this.bubble,false):false}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(e,t){this.dragBubble(e,t),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?e=this.startXY_:(e=this.pixelsToWorkspaceUnits_(t),e=we.sum(this.startXY_,e)),this.bubble.moveTo(e.x,e.y),this.dragTarget_&&this.dragTarget_.onDrop(this.bubble),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.bubble.dispose()):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace.getBubbleCanvas()),this.bubble.setDragging&&this.bubble.setDragging(false),this.fireMoveEvent_()),this.workspace.setResizesEnabled(true),He(false)}fireMoveEvent_(){if(this.bubble instanceof Ms){const e=new(ve(Bn))(this.bubble);e.setOldCoordinate(this.startXY_),e.recordNew(),Pe(e)}}pixelsToWorkspaceUnits_(e){return e=new we(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}},Kb=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new we(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){B()&&B().unselect(),this.workspace.setupDragSurface()}endDrag(e){this.drag(e),this.workspace.resetDragSurface()}drag(e){if(e=we.sum(this.startScrollXY_,e),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(e.x,this.workspace.scrollY);else if(this.verticalScrollEnabled_)this.workspace.scroll(this.workspace.scrollX,e.y);else throw new TypeError("Invalid state.")}},CO=5,OO=6,pn=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY_=new we(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.hasExceededDragRadius_=false,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isMultiTouch_=this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=false,this.cachedPoints=new Map,this.startDistance_=this.previousScale_=0,this.currentDropdownOwner=this.isPinchZoomEnabled_=this.onStartWrapper_=null,this.mostRecentEvent_=e,this.currentDragDeltaXY_=new we(0,0),this.healStack_=!Bb}dispose(){f(),Dm(),this.creatorWorkspace.clearGesture(),this.onMoveWrapper_&&g(this.onMoveWrapper_),this.onUpWrapper_&&g(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.onStartWrapper_&&g(this.onStartWrapper_)}updateFromEvent_(e){const t=new we(e.clientX,e.clientY);this.updateDragDelta_(t)&&(this.updateIsDragging_(),h()),this.mostRecentEvent_=e}updateDragDelta_(e){return this.currentDragDeltaXY_=we.difference(e,this.mouseDownXY_),this.hasExceededDragRadius_?false:this.hasExceededDragRadius_=we.magnitude(this.currentDragDeltaXY_)>(this.flyout_?i.config$$module$build$src$core$config.flyoutDragRadius:i.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout_(){let e;if(!this.targetBlock_||(e=this.flyout_)==null||!e.isBlockCreatable(this.targetBlock_))return false;if(!this.flyout_.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout_.isScrollable()||this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)?(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Bt()||He(true),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),true):false}updateIsDraggingBubble_(){return this.startBubble_?(this.startDraggingBubble_(),true):false}updateIsDraggingBlock_(){if(!this.targetBlock_)return false;if(this.flyout_){if(this.updateIsDraggingFromFlyout_())return this.startDraggingBlock_(),true}else if(this.targetBlock_.isMovable())return this.startDraggingBlock_(),true;return false}updateIsDraggingWorkspace_(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new Kb(this.startWorkspace_),this.workspaceDragger_.startDrag())}updateIsDragging_(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=true,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()}startDraggingBlock_(){this.blockDragger_=new(js(Te.BLOCK_DRAGGER,this.creatorWorkspace.options,true))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)}startDraggingBubble_(){if(!this.startBubble_)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger_=new Xb(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,$(e)?this.cancel():(this.hasStarted_=true,Pa(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=er(),this.startWorkspace_.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=e,Mm(),this.targetBlock_&&this.targetBlock_.select(),R(e)?this.handleRightClick(e):(e.type.toLowerCase()==="pointerdown"&&e.pointerType!=="mouse"&&l(e,this),this.mouseDownXY_=new we(e.clientX,e.clientY),this.healStack_=e.altKey||e.ctrlKey||e.metaKey,this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.onStartWrapper_=T(document,"pointerdown",null,this.handleStart.bind(this),true),this.onMoveWrapper_=T(document,"pointermove",null,this.handleMove.bind(this),true),this.onUpWrapper_=T(document,"pointerup",null,this.handleUp.bind(this),true),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&h())}handleMove(e){this.isDragging()&&u(e)||!this.isMultiTouch()?(this.updateFromEvent_(e),this.workspaceDragger_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.bubbleDragger_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),h())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!u(e))return;if(this.updateFromEvent_(e),h(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=true,this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(e,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(e,this.currentDragDeltaXY_):this.workspaceDragger_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(e)}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=p(e);this.cachedPoints.set(t,this.getTouchPoint(e));var r=Array.from(this.cachedPoints.keys());r.length===2&&(t=this.cachedPoints.get(r[0]),r=this.cachedPoints.get(r[1]),this.startDistance_=we.distance(t,r),this.isMultiTouch_=true,e.preventDefault())}handleTouchMove(e){const t=p(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled_&&this.cachedPoints.size===2?this.handlePinch_(e):this.handleMove(e)}handlePinch_(e){var t=Array.from(this.cachedPoints.keys()),r=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),r=we.distance(r,t)/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){if(t=r-this.previousScale_,t=0<t?t*CO:t*OO,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const a=this.startWorkspace_,d=v(e,a.getParentSvg(),a.getInverseScreenCTM());a.zoom(d.x,d.y,t)}this.previousScale_=r,e.preventDefault()}handleTouchEnd(e){e=p(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale_=0)}getTouchPoint(e){return this.startWorkspace_?new we(e.pageX,e.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(h(),this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.workspaceDragger_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())}handleRightClick(e){this.targetBlock_?(this.bringBlockToFront_(),this.targetBlock_.workspace.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(e)):this.startBubble_?this.startBubble_.showContextMenu(e):this.startWorkspace_&&!this.flyout_&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()}handleWsStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(t),this.mostRecentEvent_=e,this.doStart(e)}fireWorkspaceClick_(e){Pe(new(ve(ar))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent_=e}handleBubbleStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent_=e}doBubbleClick_(){this.startBubble_ instanceof Ms&&(this.startBubble_.setFocus(),this.startBubble_.select())}doFieldClick_(){if(!this.startField_)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField_&&this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()}doBlockClick_(){if(this.flyout_&&this.flyout_.autoClose){if(!this.targetBlock_)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock_.isEnabled()&&(Bt()||He(true),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");const e=new(ve(ar))(this.startBlock_,this.startWorkspace_.id,"block");Pe(e)}this.bringBlockToFront_(),He(false)}doWorkspaceClick_(e){e=this.creatorWorkspace,B()&&B().unselect(),this.fireWorkspaceClick_(this.startWorkspace_||e)}bringBlockToFront_(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()}setStartField(e){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=e)}setStartBubble(e){this.startBubble_||(this.startBubble_=e)}setStartBlock(e){this.startBlock_||this.startBubble_||(this.startBlock_=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock_(e.getRootBlock()):this.setTargetBlock_(e))}setTargetBlock_(e){e.isShadow()?this.setTargetBlock_(e.getParent()):this.targetBlock_=e}setStartWorkspace_(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout_(e){this.flyout_||(this.flyout_=e)}isBubbleClick_(){return!!this.startBubble_&&!this.hasExceededDragRadius_}isBlockClick_(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()}isFieldClick_(){return(this.startField_?this.startField_.isClickable():false)&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)}isWorkspaceClick_(){return!this.startBlock_&&!this.startBubble_&&!this.startField_&&!this.hasExceededDragRadius_}isDragging(){return!!this.workspaceDragger_||!!this.blockDragger_||!!this.bubbleDragger_}hasStarted(){return this.hasStarted_}getInsertionMarkers(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]}getCurrentDragger(){let e,t;return(t=(e=this.blockDragger_)!=null?e:this.workspaceDragger_)!=null?t:this.bubbleDragger_}static inProgress(){const e=w();for(let t=0,r;r=e[t];t++)if(r.currentGesture_)return true;return false}},It=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),(t=e.keyCodes)&&0<t.length)for(let r=0;r<t.length;r++)this.addKeyMapping(t[r],e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),true):(console.warn(`Keyboard shortcut named "${e}" not found.`),false)}addKeyMapping(e,t,r){e=String(e);const a=this.keyMap.get(e);if(a&&!r)throw Error(`Shortcut named "${t}" collides with shortcuts "${a}"`);a&&r?a.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,r){const a=this.keyMap.get(e);if(!a)return r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),false;const d=a.indexOf(t);return-1<d?(a.splice(d,1),a.length===0&&this.keyMap.delete(e),true):(r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),false)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,true)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,r]of this.keyMap)e[t]=r;return e}getRegistry(){const e=Object.create(null);for(const[t,r]of this.shortcuts)e[t]=r;return sr(Object.create(null),e)}onKeyDown(e,t){var r=this.serializeKeyEvent_(t);if(r=this.getShortcutNamesByKeyCode(r),!r)return false;for(let a=0,d;d=r[a];a++){const C=this.shortcuts.get(d);let M,z;if((M=C)==null||!M.preconditionFn||(z=C)!=null&&z.preconditionFn(e)){let he,ke;if((he=C)!=null&&he.callback&&((ke=C)!=null&&ke.callback(e,t,C)))return true}}return false}getShortcutNamesByKeyCode(e){return this.keyMap.get(e)||[]}getKeyCodesByShortcutName(e){const t=[];for(const[r,a]of this.keyMap)-1<a.indexOf(e)&&t.push(r);return t}serializeKeyEvent_(e){let t="";for(const r in It.modifierKeys)e.getModifierState(r)&&(t!==""&&(t+="+"),t+=r);return t!==""&&e.keyCode?t=t+"+"+e.keyCode:e.keyCode&&(t=e.keyCode.toString()),t}checkModifiers_(e){for(let t=0,r;r=e[t];t++)if(!(r in It.modifierKeys))throw Error(r+" is not a valid modifier key.")}createSerializedKey(e,t){let r="";if(t){this.checkModifiers_(t);for(const a in It.modifierKeys)-1<t.indexOf(It.modifierKeys[a])&&(r!==""&&(r+="+"),r+=a)}return r!==""&&e?r=r+"+"+e:e&&(r=e.toString()),r}};It.registry=new It,function(e){e=e.modifierKeys||(e.modifierKeys={}),e[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(It||(It={}));var gn;(function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"})(gn||(gn={})),gE();var fn={};fn.names=gn,fn.registerCopy=uE,fn.registerCut=hE,fn.registerDefaultShortcuts=gE,fn.registerDelete=cE,fn.registerEscape=lE,fn.registerPaste=dE,fn.registerRedo=pE,fn.registerUndo=_E;var n_=class extends zi{constructor(e,t){super(t),this.type=Ka,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}fromJson(e){o("Blockly.Events.ThemeChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.themeName=e.themeName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new n_),t.themeName=e.themeName,t}};Ie(Te.EVENT,Ka,n_);var r_=class extends zi{constructor(e,t,r,a,d){super(a),this.type=Gr,this.viewTop=e,this.viewLeft=t,this.scale=r,this.oldScale=d}toJson(){const e=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}fromJson(e){o("Blockly.Events.Viewport.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.viewTop=e.viewTop,this.viewLeft=e.viewLeft,this.scale=e.scale,this.oldScale=e.oldScale}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new r_),t.viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};Ie(Te.EVENT,Gr,r_);var ea=class{constructor(e){this.connectionChecker=e,this.connections_=[]}addConnection(e,t){t=this.calculateIndexForYPos_(t),this.connections_.splice(t,0,e)}findIndexOfConnection_(e,t){if(!this.connections_.length)return-1;const r=this.calculateIndexForYPos_(t);if(r>=this.connections_.length)return-1;t=e.y;let a=r;for(;0<=a&&this.connections_[a].y===t;){if(this.connections_[a]===e)return a;a--}for(a=r;a<this.connections_.length&&this.connections_[a].y===t;){if(this.connections_[a]===e)return a;a++}return-1}calculateIndexForYPos_(e){if(!this.connections_.length)return 0;let t=0,r=this.connections_.length;for(;t<r;){const a=Math.floor((t+r)/2);if(this.connections_[a].y<e)t=a+1;else if(this.connections_[a].y>e)r=a;else{t=a;break}}return t}removeConnection(e,t){if(e=this.findIndexOfConnection_(e,t),e===-1)throw Error("Unable to find connection in connectionDB.");this.connections_.splice(e,1)}getNeighbours(e,t){function r(ke){const ft=d-a[ke].x,Wt=C-a[ke].y;return Math.sqrt(ft*ft+Wt*Wt)<=t&&he.push(a[ke]),Wt<t}const a=this.connections_,d=e.x,C=e.y;e=0;let M=a.length-2,z=M;for(;e<z;)a[z].y<C?e=z:M=z,z=Math.floor((e+M)/2);const he=[];if(M=e=z,a.length){for(;0<=e&&r(e);)e--;do M++;while(M<a.length&&r(M))}return he}isInYRange_(e,t,r){return Math.abs(this.connections_[e].y-t)<=r}searchForClosest(e,t,r){if(!this.connections_.length)return{connection:null,radius:t};const a=e.y,d=e.x;e.x=d+r.x,e.y=a+r.y;var C=this.calculateIndexForYPos_(e.y);r=null;let M=t,z,he=C-1;for(;0<=he&&this.isInYRange_(he,e.y,t);)z=this.connections_[he],this.connectionChecker.canConnect(e,z,true,M)&&(r=z,M=z.distanceFrom(e)),he--;for(;C<this.connections_.length&&this.isInYRange_(C,e.y,t);)z=this.connections_[C],this.connectionChecker.canConnect(e,z,true,M)&&(r=z,M=z.distanceFrom(e)),C++;return e.x=d,e.y=a,{connection:r,radius:M}}static init(e){const t=[];return t[Ne.INPUT_VALUE]=new ea(e),t[Ne.OUTPUT_VALUE]=new ea(e),t[Ne.NEXT_STATEMENT]=new ea(e),t[Ne.PREVIOUS_STATEMENT]=new ea(e),t}},o_=class{constructor(e,t){this.pattern=e;let r;this.spacing=(r=t.spacing)!=null?r:0;let a;this.length=(a=t.length)!=null?a:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling;let d;this.snapToGrid=(d=t.snap)!=null?d:false}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(e){var t=this.spacing*e||100;this.pattern.setAttribute("width",t.toString()),this.pattern.setAttribute("height",t.toString()),t=Math.floor(this.spacing/2)+.5;let r=t-this.length/2,a=t+this.length/2;t*=e,r*=e,a*=e,this.setLineAttributes(this.line1,e,r,a,t,t),this.setLineAttributes(this.line2,e,t,t,r,a)}setLineAttributes(e,t,r,a,d,C){e&&(e.setAttribute("stroke-width",t.toString()),e.setAttribute("x1",r.toString()),e.setAttribute("y1",d.toString()),e.setAttribute("x2",a.toString()),e.setAttribute("y2",C.toString()))}moveTo(e,t){this.pattern.setAttribute("x",e.toString()),this.pattern.setAttribute("y",t.toString())}static createDom(e,t,r){e=G(te.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},r);let a,d;if(0<((a=t.length)!=null?a:1)&&0<((d=t.spacing)!=null?d:0)){G(te.LINE,{stroke:t.colour},e);let C;(C=t.length)!=null&&C&&G(te.LINE,{stroke:t.colour},e)}else G(te.LINE,{},e);return e}},Ni=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap_=null,this.variablePrefix_=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap_=null}setVariableMap(e){this.variableMap_=e}getNameForUserVariable_(e){return this.variableMap_?(e=this.variableMap_.getVariableById(e))?e.name:null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(e){e=$o(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),i.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let r=e;t===i.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable_(e))&&(r=e),e=r.toLowerCase();const a=t===i.NameType$$module$build$src$core$names.VARIABLE||t===i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"";this.db.has(t)||this.db.set(t,new Map);const d=this.db.get(t);return d.has(e)?a+d.get(e):(t=this.getDistinctName(r,t),d.set(e,t.substr(a.length)),t)}getUserNames(e){let t;return(e=(t=this.db.get(e))==null?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName_(e);let r="";for(;this.dbReverse.has(e+r)||this.reservedWords.has(e+r);)r=r?r+1:2;return e+=r,this.dbReverse.add(e),(t===i.NameType$$module$build$src$core$names.VARIABLE||t===i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"")+e}safeName_(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".indexOf(e[0])!==-1&&(e="my_"+e)):e=je.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}};(function(e){e=e.NameType||(e.NameType={}),e.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"})(Ni||(Ni={})),i.NameType$$module$build$src$core$names=Ni.NameType,Ni.DEVELOPER_VARIABLE_TYPE=i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,i.module$build$src$core$names={},i.module$build$src$core$names.NameType=i.NameType$$module$build$src$core$names,i.module$build$src$core$names.Names=Ni;var Yb=class extends Map{constructor(e){super(),this.workspace=e}set(e,t){return this.get(e)===t?this:(super.set(e,t),Pe(new(ve(Yc))(this.workspace,t)),ko(t)&&t.startPublishing(),this)}delete(e){const t=this.get(e);return e=super.delete(e),e&&(ir(this.workspace),Pe(new(ve(qa))(this.workspace,t)),ko(t)&&t.stopPublishing(),e)}clear(){if(this.size){for(const e of this.keys()){const t=this.get(e);super.delete(e),Pe(new(ve(qa))(this.workspace,t))}ir(this.workspace)}}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},bl=class{constructor(e,t,r){this.workspace=e,this.parameters=[],this.returnTypes=null,this.enabled=true,this.shouldFireEvents=false,this.id=r??ui(),this.name=t}setName(e){if(e===this.name)return this;const t=this.name;return this.name=e,ir(this.workspace),this.shouldFireEvents&&Pe(new(ve(qc))(this.workspace,this,t)),this}insertParameter(e,t){return this.parameters[t]&&this.parameters[t].getId()===e.getId()?this:(this.parameters.splice(t,0,e),e.setProcedureModel(this),ko(e)&&(this.shouldFireEvents?e.startPublishing():e.stopPublishing()),ir(this.workspace),this.shouldFireEvents&&Pe(new(ve(Qc))(this.workspace,this,e,t)),this)}deleteParameter(e){if(!this.parameters[e])return this;const t=this.parameters[e];return this.parameters.splice(e,1),ir(this.workspace),ko(t)&&t.stopPublishing(),this.shouldFireEvents&&Pe(new(ve(eu))(this.workspace,this,t,e)),this}setReturnTypes(e){if(e&&e.length)throw Error("The built-in ProcedureModel does not support typing. You need to implement your own custom ProcedureModel.");if(!!e==!!this.returnTypes)return this;const t=this.returnTypes;return this.returnTypes=e,ir(this.workspace),this.shouldFireEvents&&Pe(new(ve(Zc))(this.workspace,this,t)),this}setEnabled(e){return e===this.enabled?this:(this.enabled=e,ir(this.workspace),this.shouldFireEvents&&Pe(new(ve(Jc))(this.workspace,this)),this)}getId(){return this.id}getName(){return this.name}getParameter(e){return this.parameters[e]}getParameters(){return[...this.parameters]}getReturnTypes(){return this.returnTypes}getEnabled(){return this.enabled}startPublishing(){this.shouldFireEvents=true;for(const e of this.parameters)ko(e)&&e.startPublishing()}stopPublishing(){this.shouldFireEvents=false;for(const e of this.parameters)ko(e)&&e.stopPublishing()}},ta=class{constructor(e,t,r){this.workspace=e,this.shouldFireEvents=false,this.procedureModel=null,this.id=r??ui();let a;this.variable=(a=this.workspace.getVariable(t))!=null?a:e.createVariable(t)}setName(e){if(e===this.variable.name)return this;const t=this.variable.name;let r;return this.variable=(r=this.workspace.getVariable(e))!=null?r:this.workspace.createVariable(e),ir(this.workspace),this.shouldFireEvents&&Pe(new(ve(tu))(this.workspace,this.procedureModel,this,t)),this}setTypes(e){throw Error("The built-in ParameterModel does not support typing. You need to implement your own custom ParameterModel.")}getName(){return this.variable.name}getTypes(){return[]}getId(){return this.id}getVariableModel(){return this.variable}startPublishing(){this.shouldFireEvents=true}stopPublishing(){this.shouldFireEvents=false}setProcedureModel(e){return this.procedureModel=e,this}},Eu,a_;Eu="PROCEDURE",a_="x",i.module$build$src$core$procedures={},i.module$build$src$core$procedures.CATEGORY_NAME=Eu,i.module$build$src$core$procedures.DEFAULT_ARG=a_,i.module$build$src$core$procedures.ObservableParameterModel=ta,i.module$build$src$core$procedures.ObservableProcedureMap=Yb,i.module$build$src$core$procedures.ObservableProcedureModel=bl,i.module$build$src$core$procedures.allProcedures=Kh,i.module$build$src$core$procedures.findLegalName=mE,i.module$build$src$core$procedures.flyoutCategory=Yh,i.module$build$src$core$procedures.getCallers=TE,i.module$build$src$core$procedures.getDefinition=AC,i.module$build$src$core$procedures.isNameUsed=EE,i.module$build$src$core$procedures.mutateCallers=kC,i.module$build$src$core$procedures.mutatorOpenListener=vE,i.module$build$src$core$procedures.rename=OC;var wO=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return e.type&this.FIELD}isHat(e){return e.type&this.HAT}isIcon(e){return e.type&this.ICON}isSpacer(e){return e.type&this.SPACER}isInRowSpacer(e){return e.type&this.IN_ROW_SPACER}isInput(e){return e.type&this.INPUT}isExternalInput(e){return e.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(e){return e.type&this.INLINE_INPUT}isStatementInput(e){return e.type&this.STATEMENT_INPUT}isPreviousConnection(e){return e.type&this.PREVIOUS_CONNECTION}isNextConnection(e){return e.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(e){return e.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(e){return e.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(e){return e.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(e){return e.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(e){return e.type&this.RIGHT_SQUARE_CORNER}isCorner(e){return e.type&this.CORNER}isJaggedEdge(e){return e.type&this.JAGGED_EDGE}isRow(e){return e.type&this.ROW}isBetweenRowSpacer(e){return e.type&this.BETWEEN_ROW_SPACER}isTopRow(e){return e.type&this.TOP_ROW}isBottomRow(e){return e.type&this.BOTTOM_ROW}isTopOrBottomRow(e){return e.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(e){return e.type&this.INPUT_ROW}},Y=new wO,mn=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=Y.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},vl=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=false,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=false,this.align=null,this.constants_=e,this.type=Y.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(Y.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return true}endsWithElemSpacer(){return true}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(Y.isSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(Y.isSpacer(t))return t}return null}},l_=class extends vl{constructor(e){super(e),this.hasNextConnection=false,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=Y.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return true}measure(){let e=0,t=0,r=0;for(let a=0;a<this.elements.length;a++){const d=this.elements[a];t+=d.width,Y.isSpacer(d)||(Y.isNextConnection(d)?r=Math.max(r,d.height):e=Math.max(e,d.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.descenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return false}endsWithElemSpacer(){return false}},Yr=class extends mn{constructor(e,t){super(e),this.connectionModel=t,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.type|=Y.CONNECTION}},Hn=class extends Yr{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=Y.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},bu=class extends Hn{constructor(e,t){super(e,t),this.height=0,this.type|=Y.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},qr=class extends mn{constructor(e,t,r){super(e),this.field=t,this.parentInput=r,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=Y.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},c_=class extends mn{constructor(e){super(e),this.type|=Y.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},qb=class extends mn{constructor(e,t){super(e),this.icon=t,this.flipRtl=false,this.isVisible=t.isVisible(),this.type|=Y.ICON,e=t.getCorrectedSize(),this.height=e.height,this.width=e.width}},fi=class extends mn{constructor(e,t){super(e),this.type=this.type|Y.SPACER|Y.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},u_=class extends Hn{constructor(e,t){super(e,t),this.type|=Y.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},Tl=class extends Hn{constructor(e,t){super(e,t),this.type|=Y.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},h_=class extends vl{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=Y.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const r=this.elements[t];this.width+=r.width,Y.isInput(r)&&r instanceof Hn&&(Y.isStatementInput(r)&&r instanceof Tl?e+=r.connectedBlockWidth:Y.isExternalInput(r)&&r instanceof bu&&r.connectedBlockWidth!==0&&(e+=r.connectedBlockWidth-r.connectionWidth)),Y.isSpacer(r)||(this.height=Math.max(this.height,r.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},Jb=class extends mn{constructor(e){super(e),this.type|=Y.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},Zb=class extends Yr{constructor(e,t){super(e,t),this.type|=Y.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Qb=class extends Yr{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=Y.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},ev=class extends Yr{constructor(e,t){super(e,t),this.type|=Y.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Sl=class extends mn{constructor(e,t){super(e),this.type=(t&&t!=="left"?Y.RIGHT_ROUND_CORNER:Y.LEFT_ROUND_CORNER)|Y.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},d_=class extends vl{constructor(e,t,r){super(e),this.height=t,this.width=r,this.precedesStatement=this.followsStatement=false,this.widthWithConnectedBlocks=0,this.type=this.type|Y.SPACER|Y.BETWEEN_ROW_SPACER,this.elements=[new fi(this.constants_,r)]}measure(){}},$l=class extends mn{constructor(e,t){super(e),this.type=(t&&t!=="left"?Y.RIGHT_SQUARE_CORNER:Y.LEFT_SQUARE_CORNER)|Y.CORNER,this.width=this.height=this.constants_.NO_PADDING}},__=class extends vl{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=false,this.connection=null,this.type|=Y.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,r=e.getPreviousBlock();return!!e.outputConnection||t||(r?r.getNextBlock()===e:false)}hasRightSquareCorner(e){return true}measure(){let e=0,t=0,r=0;for(let a=0;a<this.elements.length;a++){const d=this.elements[a];t+=d.width,Y.isSpacer(d)||(Y.isHat(d)&&d instanceof c_?r=Math.max(r,d.ascenderHeight):e=Math.max(e,d.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.capline=this.ascenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return false}endsWithElemSpacer(){return false}},yl=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=false,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=false,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=false,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs_=null,this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=false,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=Vt(0,0),this.FIELD_TEXT_BASELINE_CENTER=true,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const r in t)this.blockStyles[r]=this.validatedBlockStyle_(t[r]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=e.startHats!==void 0?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=ct("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.indexOf("auto_")===0?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=Oo(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?Oo(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?Oo(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Co("#fff",e,.6)||e}generateTertiaryColour_(e){return Co("#fff",e,.3)||e}dispose(){this.embossFilter_&&W(this.embossFilter_),this.disabledPattern_&&W(this.disabledPattern_),this.debugFilter_&&W(this.debugFilter_),this.cssNode_=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH,r=Ba([Ge(t,e/4),Ge(2*-t,e/2),Ge(t,e/4)]);return{height:e,width:t,path:r}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=pi("c",[Ge(30,-e),Ge(70,-e),Ge(t,0)]);return{height:e,width:t,path:r}}makePuzzleTab(){function e(C){C=C?-1:1;const M=-C;var z=r/2;const he=z+2.5,ke=z+.5,ft=Ge(-t,C*z);return z=Ge(t,C*z),pi("c",[Ge(0,C*he),Ge(-t,M*ke),ft])+pi("s",[Ge(t,2.5*M),z])}const t=this.TAB_WIDTH,r=this.TAB_HEIGHT,a=e(true),d=e(false);return{type:this.SHAPES.PUZZLE,width:t,height:r,pathDown:d,pathUp:a}}makeNotch(){function e(M){return Ba([Ge(M*a,r),Ge(3*M,0),Ge(M*a,-r)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,a=(t-3)/2,d=e(1),C=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:d,pathRight:C}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=hs("a","0 0,0",e,Ge(-e,e)),r=hs("a","0 0,0",e,Ge(e,e));return{width:e,height:e,pathTop:t,pathBottom:r}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=Vt(0,e)+hs("a","0 0,1",e,Ge(e,-e)),r=hs("a","0 0,1",e,Ge(e,e)),a=hs("a","0 0,1",e,Ge(-e,-e)),d=hs("a","0 0,1",e,Ge(-e,e));return{topLeft:t,topRight:r,bottomRight:d,bottomLeft:a,rightHeight:e}}shapeFor(e){switch(e.type){case Ne.INPUT_VALUE:case Ne.OUTPUT_VALUE:return this.PUZZLE_TAB;case Ne.PREVIOUS_STATEMENT:case Ne.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,r){this.injectCSS_(t,r),this.defs_=G(te.DEFS,{},e),e=G(te.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs_),G(te.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=G(te.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),G(te.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),G(te.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),G(te.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter_=e,e=G(te.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs_),G(te.RECT,{width:10,height:10,fill:"#aaa"},e),G(te.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern_=e,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter_){const e=G(te.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs_),t=G(te.FECOMPONENTTRANSFER,{result:"outBlur"},e);G(te.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),G(te.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),G(te.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter_=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode_=document.getElementById(e);const r=t.join(`
`);this.cssNode_?this.cssNode_.firstChild.textContent=r:(t=document.createElement("style"),t.id=e,e=document.createTextNode(r),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode_=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect,`,`${e} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},tv=false,mi=class{constructor(e){this.constants=e,this.debugElements_=[],this.svgRoot_=null,this.randomColour_=""}clearElems(){for(let e=0;e<this.debugElements_.length;e++)W(this.debugElements_[e]);this.debugElements_=[]}drawSpacerRow(e,t,r){if(mi.config.rowSpacers){var a=Math.abs(e.height),d=0>e.height;d&&(t-=a),this.debugElements_.push(G(te.RECT,{class:"rowSpacerRect blockRenderDebug",x:r?-(e.xPos+e.width):e.xPos,y:t,width:e.width,height:a,stroke:d?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}}drawSpacerElem(e,t,r){if(mi.config.elemSpacers){t=Math.abs(e.width);var a=0>e.width,d=a?e.xPos-t:e.xPos;r&&(d=-(d+t)),this.debugElements_.push(G(te.RECT,{class:"elemSpacerRect blockRenderDebug",x:d,y:e.centerline-e.height/2,width:t,height:e.height,stroke:"pink",fill:a?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}}drawRenderedElem(e,t){if(mi.config.elems){let r=e.xPos;t&&(r=-(r+e.width)),t=e.centerline-e.height/2,this.debugElements_.push(G(te.RECT,{class:"rowRenderingRect blockRenderDebug",x:r,y:t,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),Y.isField(e)&&e instanceof qr&&e.field instanceof i.FieldLabel$$module$build$src$core$field_label&&this.debugElements_.push(G(te.RECT,{class:"rowRenderingRect blockRenderDebug",x:r,y:t+this.constants.FIELD_TEXT_BASELINE,width:e.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}Y.isInput(e)&&e instanceof Hn&&mi.config.connections&&this.drawConnection(e.connectionModel)}drawConnection(e){if(mi.config.connections){var t="",r=0,a="";e.type===Ne.INPUT_VALUE?(r=4,t="magenta",a="none"):e.type===Ne.OUTPUT_VALUE?(r=2,a=t="magenta"):e.type===Ne.NEXT_STATEMENT?(r=4,t="goldenrod",a="none"):e.type===Ne.PREVIOUS_STATEMENT&&(r=2,a=t="goldenrod"),this.debugElements_.push(G(te.CIRCLE,{class:"blockRenderDebug",cx:e.getOffsetInBlock().x,cy:e.getOffsetInBlock().y,r,fill:a,stroke:t},this.svgRoot_))}}drawRenderedRow(e,t,r){mi.config.rows&&(this.debugElements_.push(G(te.RECT,{class:"elemRenderingRect blockRenderDebug",x:r?-(e.xPos+e.width):e.xPos,y:e.yPos,width:e.width,height:e.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),Y.isTopOrBottomRow(e)||mi.config.connectedBlockBounds&&this.debugElements_.push(G(te.RECT,{class:"connectedBlockWidth blockRenderDebug",x:r?-(e.xPos+e.widthWithConnectedBlocks):e.xPos,y:e.yPos,width:e.widthWithConnectedBlocks,height:e.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))}drawRowWithElements(e,t,r){for(let a=0;a<e.elements.length;a++){const d=e.elements[a];d?Y.isSpacer(d)?this.drawSpacerElem(d,e.height,r):this.drawRenderedElem(d,r):console.warn("A row has an undefined or null element.",e,d)}this.drawRenderedRow(e,t,r)}drawBoundingBox(e){if(mi.config.blockBounds){var t=e.RTL?-e.width:0;this.debugElements_.push(G(te.RECT,{class:"blockBoundingBox blockRenderDebug",x:t,y:0,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),mi.config.connectedBlockBounds&&(t=e.RTL?-e.widthWithChildren:0,this.debugElements_.push(G(te.RECT,{class:"blockRenderDebug",x:t,y:0,width:e.widthWithChildren,height:e.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))}}drawDebug(e,t){this.clearElems(),this.svgRoot_=e.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);let r=0;for(let a=0;a<t.rows.length;a++){const d=t.rows[a];Y.isBetweenRowSpacer(d)?this.drawSpacerRow(d,r,t.RTL):this.drawRowWithElements(d,r,t.RTL),r+=d.height}e.previousConnection&&this.drawConnection(e.previousConnection),e.nextConnection&&this.drawConnection(e.nextConnection),e.outputConnection&&this.drawConnection(e.outputConnection),t.rightSide&&this.drawRenderedElem(t.rightSide,t.RTL),this.drawBoundingBox(t),this.drawRender(e.pathObject.svgPath)}drawRender(e){mi.config.render&&(e.setAttribute("filter","url(#"+this.constants.debugFilterId+")"),setTimeout(function(){e.setAttribute("filter","")},100))}};mi.config={rowSpacers:true,elemSpacers:true,rows:true,elems:true,connections:true,blockBounds:true,connectedBlockBounds:true,render:true};var Rl=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){if(this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),xc()){let e;(e=this.block_.renderingDebugger)==null||e.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}hideHiddenIcons_(){for(let e=0,t;t=this.info_.hiddenIcons[e];e++){let r;(r=t.icon.iconGroup_)==null||r.setAttribute("display","none")}}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=Vt(e.xPos,this.info_.startY);for(let r=0,a;a=t[r];r++)Y.isLeftRoundedCorner(a)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:Y.isRightRoundedCorner(a)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:Y.isPreviousConnection(a)&&a instanceof Yr?this.outlinePath_+=a.shape.pathLeft:Y.isHat(a)?this.outlinePath_+=this.constants_.START_HAT.path:Y.isSpacer(a)&&(this.outlinePath_+=Me("h",a.width));this.outlinePath_+=Me("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+Me("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const r=SE(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=Me("H",t.xPos+t.width)+r+Me("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var r=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+Me("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var a=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=Me("H",r)+t+Me("v",a)+this.constants_.INSIDE_CORNERS.pathBottom+Me("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=Me("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let r=0,a="";for(let d=t.length-1,C;C=t[d];d--)Y.isNextConnection(C)&&C instanceof Yr?a+=C.shape.pathRight:Y.isLeftSquareCorner(C)?a+=Me("H",e.xPos):Y.isLeftRoundedCorner(C)?a+=this.constants_.OUTSIDE_CORNERS.bottomLeft:Y.isRightRoundedCorner(C)?(a+=this.constants_.OUTSIDE_CORNERS.bottomRight,r=this.constants_.OUTSIDE_CORNERS.rightHeight):Y.isSpacer(C)&&(a+=Me("h",-1*C.width));this.outlinePath_+=Me("V",e.baseline-r),this.outlinePath_+=a}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=SE(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=Me("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e=0,t;t=this.info_.rows[e];e++)for(let r=0,a;a=t.elements[r];r++)Y.isInlineInput(a)?this.drawInlineInput_(a):(Y.isIcon(a)||Y.isField(a))&&this.layoutField_(a)}layoutField_(e){const t=Y.isField(e)?e.field.getSvgRoot():e.icon.iconGroup_,r=e.centerline-e.height/2;let a=e.xPos,d="";this.info_.RTL&&(a=-(a+e.width),e.flipRtl&&(a+=e.width,d="scale(-1 1)")),Y.isIcon(e)?(t.setAttribute("display","block"),t.setAttribute("transform","translate("+a+","+r+")"),e.icon.computeIconLocation()):t.setAttribute("transform","translate("+a+","+r+")"+d),this.info_.isInsertionMarker&&t.setAttribute("display","none")}drawInlineInput_(e){const t=e.width,r=e.height,a=e.connectionOffsetY,d=e.connectionHeight+a;this.inlinePath_+=Ns(e.xPos+e.connectionWidth,e.centerline-r/2)+Me("v",a)+e.shape.pathDown+Me("v",r-d)+Me("h",t-e.connectionWidth)+Me("v",-r)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-r:r,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}},sa=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new Qb(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new __(this.constants_),this.bottomRow=new l_(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new h_(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let r=0,a;a=t[r];r++){const d=new qb(this.constants_,a);this.isCollapsed&&a.collapseHidden?this.hiddenIcons.push(d):e.elements.push(d)}t=void 0;for(let r=0,a;a=this.block_.inputList[r];r++)if(a.isVisible()){this.shouldStartNewRow_(a,t)&&(this.rows.push(e),e=new h_(this.constants_),this.inputRows.push(e));for(let d=0,C;C=a.fieldRow[d];d++)e.elements.push(new qr(this.constants_,C,a));this.addInput_(a,e),t=a}this.isCollapsed&&(e.hasJaggedEdge=true,e.elements.push(new Jb(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let r=this.topRow.hasLeftSquareCorner(this.block_)?$l:Sl;this.topRow.elements.push(new r(this.constants_)),t?(e=new c_(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=true,this.topRow.connection=new ev(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0].type===it.STATEMENT&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,r=this.topRow.hasRightSquareCorner(this.block_)?$l:Sl,this.topRow.elements.push(new r(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===it.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new $l(this.constants_)):this.bottomRow.elements.push(new Sl(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new Zb(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new $l(this.constants_,"right")):this.bottomRow.elements.push(new Sl(this.constants_,"right"))}addInput_(e,t){this.isInline&&e.type===it.VALUE?(t.elements.push(new u_(this.constants_,e)),t.hasInlineInput=true):e.type===it.STATEMENT?(t.elements.push(new Tl(this.constants_,e)),t.hasStatement=true):e.type===it.VALUE?(t.elements.push(new bu(this.constants_,e)),t.hasExternalInput=true):e.type===it.DUMMY&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=true),t.align===null&&(t.align=e.align)}shouldStartNewRow_(e,t){return t?e.type===it.STATEMENT||t.type===it.STATEMENT?true:e.type===it.VALUE||e.type===it.DUMMY?!this.isInline:false:false}addElemSpacing_(){for(let e=0,t;t=this.rows[e];e++){const r=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new fi(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let a=0;a<r.length-1;a++){t.elements.push(r[a]);const d=this.getInRowSpacing_(r[a],r[a+1]);t.elements.push(new fi(this.constants_,d))}t.elements.push(r[r.length-1]),t.endsWithElemSpacer()&&t.elements.push(new fi(this.constants_,this.getInRowSpacing_(r[r.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&Y.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&Y.isInput(e)&&!t){if(Y.isExternalInput(e))return this.constants_.NO_PADDING;if(Y.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Y.isStatementInput(e))return this.constants_.NO_PADDING}return e&&Y.isLeftSquareCorner(e)&&t&&(Y.isPreviousConnection(t)||Y.isNextConnection(t))?t.notchOffset:e&&Y.isLeftRoundedCorner(e)&&t&&(Y.isPreviousConnection(t)||Y.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,r=0;for(let d=0,C;C=this.rows[d];d++){if(C.measure(),t=Math.max(t,C.width),C.hasStatement){var a=C.getLastInput();let M,z;a=C.width-((z=(M=a)==null?void 0:M.width)!=null?z:0),e=Math.max(e,a)}r=Math.max(r,C.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let d=0,C;C=this.rows[d];d++)C.hasStatement&&(C.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,r),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t=0,r;r=this.rows[t];t++)if(r.hasStatement)this.alignStatementRow_(r);else{var e=r.width;e=this.getDesiredRowWidth_(r)-e,0<e&&this.addAlignmentPadding_(r,e),Y.isTopOrBottomRow(r)&&(r.widthWithConnectedBlocks=r.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const r=e.getFirstSpacer(),a=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===i.Align$$module$build$src$core$input.LEFT&&a)a.width+=t;else if(e.align===i.Align$$module$build$src$core$input.CENTRE&&r&&a)r.width+=t/2,a.width+=t/2;else if(e.align===i.Align$$module$build$src$core$input.RIGHT&&r)r.width+=t;else if(a)a.width+=t;else return;e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var r=e.width-t.width,a=this.statementEdge;r=a-r,0<r&&this.addAlignmentPadding_(e,r),r=e.width,a=this.getDesiredRowWidth_(e),t.width+=a-r,t.height=Math.max(t.height,e.height),e.width+=a-r,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var r=this.getSpacerRowHeight_(e,t);const a=this.getSpacerRowWidth_(e,t);return r=new d_(this.constants_,r,a),e.hasStatement&&(r.followsStatement=true),t.hasStatement&&(r.precedesStatement=true),r}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return Y.isSpacer(t)?e.yPos+t.height/2:Y.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,Y.isNextConnection(t)?e+t.height/2:e-t.height/2):Y.isTopRow(e)?Y.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let r=0,a;a=e.elements[r];r++)Y.isSpacer(a)&&(a.height=e.height),a.xPos=t,a.centerline=this.getElemCenterline_(e,a),t+=a.width}finalize_(){let e=0,t=0;for(let r=0,a;a=this.rows[r];r++)a.yPos=t,a.xPos=this.startX,t+=a.height,e=Math.max(e,a.widthWithConnectedBlocks),this.recordElemPositions_(a);if(this.outputConnection&&this.block_.nextConnection){const r=this.block_.nextConnection.targetBlock();r&&(e=Math.max(e,r.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}},p_=class extends zi{constructor(e,t,r,a){let d=e?e.workspace.id:void 0;a&&a.getType()===_e.types.WORKSPACE&&(d=a.getLocation().id),super(d),this.type=za,this.blockId=e==null?void 0:e.id,this.oldNode=r||void 0,this.newNode=a,this.isCursor=t}toJson(){const e=super.toJson();if(this.isCursor===void 0)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e}fromJson(e){o("Blockly.Events.MarkerMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isCursor=e.isCursor,this.blockId=e.blockId,this.oldNode=e.oldNode,this.newNode=e.newNode}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new p_),t.isCursor=e.isCursor,t.blockId=e.blockId,t.oldNode=e.oldNode,t.newNode=e.newNode,t}};Ie(Te.EVENT,za,p_);var kO="blocklyCursor",AO="blocklyMarker",LO=.75,g_=class{constructor(e,t,r){this.workspace=e,this.marker=r,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent_=null,this.constants_=t,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=r.colour||e}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return this.marker.type==="cursor"}createDom(){const e=this.isCursor()?kO:AO;return this.svgGroup_=G(te.G,{class:e}),this.createDomInternal_(),this.svgGroup_}setParent_(e){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent_=e}draw(e,t){if(t){this.constants_=this.workspace.getRenderer().getConstants();var r=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||r,this.applyColour_(t),this.showAtLocation_(t),this.fireMarkerEvent_(e,t),e=this.currentMarkerSvg.childNodes[0],e!==void 0&&e.beginElement&&e.beginElement()}else this.hide()}showAtLocation_(e){const t=e.getLocation().type;e.getType()===_e.types.BLOCK?this.showWithBlock_(e):e.getType()===_e.types.OUTPUT?this.showWithOutput_(e):t===Ne.INPUT_VALUE?this.showWithInput_(e):t===Ne.NEXT_STATEMENT?this.showWithNext_(e):e.getType()===_e.types.PREVIOUS?this.showWithPrevious_(e):e.getType()===_e.types.FIELD?this.showWithField_(e):e.getType()===_e.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()===_e.types.STACK&&this.showWithStack_(e)}showWithBlockPrevOutput_(e){e=e.getSourceBlock();const t=e.width;var r=e.height,a=r*LO;const d=this.constants_.CURSOR_BLOCK_PADDING;e.previousConnection?(r=this.constants_.shapeFor(e.previousConnection),this.positionPrevious_(t,d,a,r)):e.outputConnection?(a=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(t,r,a)):this.positionBlock_(t,d,a),this.setParent_(e),this.showCurrent_()}showWithBlock_(e){this.showWithBlockPrevOutput_(e)}showWithPrevious_(e){this.showWithBlockPrevOutput_(e)}showWithOutput_(e){this.showWithBlockPrevOutput_(e)}showWithCoordinates_(e){var t=e.getWsCoordinate();e=t.x,t=t.y,this.workspace.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,t,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(e){e=e.getLocation();const t=e.getSize().width,r=e.getSize().height;this.positionRect_(0,0,t,r),this.setParent_(e),this.showCurrent_()}showWithInput_(e){e=e.getLocation();const t=e.getSourceBlock();this.positionInput_(e),this.setParent_(t),this.showCurrent_()}showWithNext_(e){var t=e.getLocation();e=t.getSourceBlock();let r=0;t=t.getOffsetInBlock().y;const a=e.getHeightWidth().width;this.workspace.RTL&&(r=-a),this.positionLine_(r,t,a),this.setParent_(e),this.showCurrent_()}showWithStack_(e){e=e.getLocation();var t=e.getHeightWidth();const r=t.width+this.constants_.CURSOR_STACK_PADDING;t=t.height+this.constants_.CURSOR_STACK_PADDING;const a=-this.constants_.CURSOR_STACK_PADDING/2,d=-this.constants_.CURSOR_STACK_PADDING/2;let C=a;this.workspace.RTL&&(C=-(r+a)),this.positionRect_(C,d,r,t),this.setParent_(e),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(e,t,r){if(e=Vt(-t,r)+Me("V",-t)+Me("H",e+2*t)+Me("V",r),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(e){const t=e.getOffsetInBlock().x,r=e.getOffsetInBlock().y;e=Ns(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+t+","+r+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(e,t,r){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${e}`),this.markerSvgLine_.setAttribute("y",`${t}`),this.markerSvgLine_.setAttribute("width",`${r}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(e,t,r){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");e=Vt(e,0)+Me("h",-(e-r.width))+Me("v",this.constants_.TAB_OFFSET_FROM_TOP)+r.pathDown+Me("V",t)+Me("H",e),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(e,t,r,a){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");e=Vt(-t,r)+Me("V",-t)+Me("H",this.constants_.NOTCH_OFFSET_LEFT)+a.pathLeft+Me("H",e+2*t)+Me("V",r),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(e,t,r,a){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${e}`),this.markerSvgRect_.setAttribute("y",`${t}`),this.markerSvgRect_.setAttribute("width",`${r}`),this.markerSvgRect_.setAttribute("height",`${a}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl_(e){e.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent_(e,t){const r=t.getSourceBlock();e=new(ve(za))(r,this.isCursor(),e,t),Pe(e)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=G(te.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=G(te.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=G(te.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=G(te.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=G(te.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){const e=this.getBlinkProperties_();G(te.ANIMATE,e,this.markerSvgLine_),G(te.ANIMATE,e,this.markerInput_),G(te.ANIMATE,Object.assign({},e,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(e){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(e=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",e),this.markerInput_.firstElementChild.setAttribute("values",e),this.markerBlock_.firstElementChild.setAttribute("values",e))}dispose(){this.svgGroup_&&W(this.svgGroup_)}},vu=class{constructor(e,t,r){this.markerSvg=this.cursorSvg=null,this.constants=r,this.style=t,this.svgRoot=e,this.svgPath=G(te.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?ae(this.svgRoot,e):fe(this.svgRoot,e))}updateHighlighted(e){e?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}},sv="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",Ei=class{constructor(e){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=false,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,H(e),this.topBlock=e,this.workspace=e.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections()}dispose(){this.availableConnections.length=0,Yt();try{this.firstMarker&&this.firstMarker.dispose(),this.lastMarker&&this.lastMarker.dispose()}finally{qt()}}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){Yt(),this.hidePreview(),qt();var{local:e,closest:t}=this.activeCandidate;if(e.connect(t),this.topBlock.rendered){const r=e.isSuperior()?t:e;Qm(r.getSourceBlock()),this.topBlock.getRootBlock().bringToFront()}}}update(e,t){const r=this.getCandidate(e);((this.wouldDeleteBlock=this.shouldDelete(!!r,t))||this.shouldUpdatePreviews(r,e))&&(Yt(),this.maybeHidePreview(r),this.maybeShowPreview(r),qt())}createMarkerBlock(e){var t=e.type;Yt();let r;try{if(r=this.workspace.newBlock(t),r.setInsertionMarker(true),e.saveExtraState){var a=e.saveExtraState();a&&r.loadExtraState&&r.loadExtraState(a)}else if(e.mutationToDom){const d=e.mutationToDom();d&&r.domToMutation&&r.domToMutation(d)}for(t=0;t<e.inputList.length;t++){const d=e.inputList[t];if(d.name===ul)continue;const C=r.inputList[t];if(!C)throw Error(sv.replace("%1","an input"));for(a=0;a<d.fieldRow.length;a++){const M=d.fieldRow[a],z=C.fieldRow[a];if(!z)throw Error(sv.replace("%1","a field"));z.setValue(M.getValue())}}r.setCollapsed(e.isCollapsed()),r.setInputsInline(e.getInputsInline()),r.initSvg(),r.getSvgRoot().setAttribute("visibility","hidden")}finally{qt()}return r}initAvailableConnections(){const e=this.topBlock.getConnections_(false),t=this.topBlock.lastConnectionInStack(true);if(t&&t!==this.topBlock.nextConnection){if(e.push(t),this.lastOnStack=t,this.lastMarker){Yt();try{this.lastMarker.dispose()}finally{qt()}}this.lastMarker=this.createMarkerBlock(t.getSourceBlock())}return e}shouldUpdatePreviews(e,t){if(!e)return!!this.activeCandidate;if(!this.activeCandidate)return true;const{local:r,closest:a}=this.activeCandidate;if(a===e.closest&&r===e.local)return false;const d=r.x+t.x-a.x;return t=r.y+t.y-a.y,e.radius<Math.sqrt(d*d+t*t)-i.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(e){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let t=this.getStartRadius(),r=null;for(let a=0;a<this.availableConnections.length;a++){const d=this.availableConnections[a],C=d.closest(t,e);C.connection&&(r={closest:C.connection,local:d,radius:C.radius},t=C.radius)}return r}getStartRadius(){return this.activeCandidate?i.config$$module$build$src$core$config.connectingSnapRadius:i.config$$module$build$src$core$config.snapRadius}shouldDelete(e,t){return t&&this.workspace.getComponentManager().hasCapability(t.id,Ss.Capability.DELETE_AREA)?t.wouldDelete(this.topBlock,e):false}maybeShowPreview(e){if(!this.wouldDeleteBlock&&e){var t=e.closest,r;t===((r=this.activeCandidate)==null?void 0:r.closest)||t.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=e,this.showPreview(this.activeCandidate))}}showPreview(e){const t=this.workspace.getRenderer();switch(t.getConnectionPreviewMethod(e.closest,e.local,this.topBlock)){case Ei.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(e);break;case Ei.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(e);break;case Ei.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(e)}t.shouldHighlightConnection(e.closest)&&e.closest.highlight()}maybeHidePreview(e){if(!e)this.hidePreview();else if(this.activeCandidate){const t=this.activeCandidate.local!==e.local;(this.activeCandidate.closest!==e.closest||t||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let e;const t=(e=this.activeCandidate)==null?void 0:e.closest;t&&t.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(t)&&t.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(e){const{local:t,closest:r}=e;let a=(e=this.lastOnStack&&t===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!a)throw Error("Cannot show the insertion marker because there is no insertion marker block");let d;try{d=a.getMatchingConnection(t.getSourceBlock(),t)}catch{if(this.firstMarker=this.createMarkerBlock(this.topBlock),a=e?this.lastMarker:this.firstMarker,!a)throw Error("Cannot show the insertion marker because there is no insertion marker block");d=a.getMatchingConnection(t.getSourceBlock(),t)}if(!d)throw Error("Cannot show the insertion marker because there is no associated connection");if(d===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");a.render(),a.rendered=true,a.getSvgRoot().setAttribute("visibility","visible"),d&&r&&a.positionNearConnection(d,r),r&&d.connect(r),this.markerConnection=d}hideInsertionMarker(){if(this.markerConnection){var e=this.markerConnection,t=e.getSourceBlock(),r=t.previousConnection,a=t.outputConnection,d=e===t.nextConnection;if(a=e.type===Ne.INPUT_VALUE&&!(a&&a.targetConnection),d&&(!r||!r.targetConnection)||a?e.targetBlock().unplug(false):e.type!==Ne.NEXT_STATEMENT||d?t.unplug(true):((d=e.targetConnection)&&d.getSourceBlock().unplug(false),r=r?r.targetConnection:null,t.unplug(true),r&&d&&r.connect(d)),e.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(e=t.getSvgRoot())&&e.setAttribute("visibility","hidden")}}showInsertionInputOutline(e){e=e.closest,this.highlightedBlock=e.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(e,true)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,false),this.highlightedBlock=null}}showReplacementFade(e){if(this.fadedBlock=e.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(true)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(false),this.fadedBlock=null)}getInsertionMarkers(){const e=[];return this.firstMarker&&e.push(this.firstMarker),this.lastMarker&&e.push(this.lastMarker),e}};(function(e){e=e.PREVIEW_TYPE||(e.PREVIEW_TYPE={}),e[e.INSERTION_MARKER=0]="INSERTION_MARKER",e[e.INPUT_OUTLINE=1]="INPUT_OUTLINE",e[e.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"})(Ei||(Ei={})),Ei.PREVIEW_TYPE;var Il=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName())}refreshDom(e,t){const r=this.getConstants();r.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=r.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new yl}makeRenderInfo_(e){return new sa(this,e)}makeDrawer_(e,t){return new Rl(e,t)}makeDebugger_(){return new mi(this.getConstants())}makeMarkerDrawer(e,t){return new g_(e,this.getConstants(),t)}makePathObject(e,t){return new vu(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return true}orphanCanConnectAtEnd(e,t,r){return!!Tt.getConnectionForOrphanedConnection(e,r===Ne.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}getConnectionPreviewMethod(e,t,r){return t.type===Ne.OUTPUT_VALUE||t.type===Ne.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(r,e.targetBlock(),t.type)?Ei.PREVIEW_TYPE.INSERTION_MARKER:Ei.PREVIEW_TYPE.REPLACEMENT_FADE:Ei.PREVIEW_TYPE.INSERTION_MARKER}render(e){xc()&&!e.renderingDebugger&&(e.renderingDebugger=this.makeDebugger_());const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},$t={};$t.BottomRow=l_,$t.Connection=Yr,$t.ConstantProvider=yl,$t.Debug=mi,$t.Drawer=Rl,$t.ExternalValueInput=bu,$t.Field=qr,$t.Hat=c_,$t.Icon=qb,$t.InRowSpacer=fi,$t.InlineInput=u_,$t.InputConnection=Hn,$t.InputRow=h_,$t.JaggedEdge=Jb,$t.MarkerSvg=g_,$t.Measurable=mn,$t.NextConnection=Zb,$t.OutputConnection=Qb,$t.PathObject=vu,$t.PreviousConnection=ev,$t.RenderInfo=sa,$t.Renderer=Il,$t.RoundCorner=Sl,$t.Row=vl,$t.SpacerRow=d_,$t.SquareCorner=$l,$t.StatementInput=Tl,$t.TopRow=__,$t.Types=Y,$t.init=$E,$t.register=Fa,$t.stopDebugger=MC,$t.unregister=NC;var iv=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&fe(e,t),(t=this.theme.getClassName())&&ae(e,t));for(let r=0,a;a=this.subscribedWorkspaces_[r];r++)a.refreshTheme();for(const[r,a]of this.componentDB)for(const d of a){e=d.element,t=d.propertyName;const C=this.theme&&this.theme.getComponentStyle(r);e.style[t]=C||""}for(const r of this.subscribedWorkspaces_)r.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces_.push(e)}unsubscribeWorkspace(e){if(!Xs(this.subscribedWorkspaces_,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,r){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:r}),t=this.theme&&this.theme.getComponentStyle(t),e.style[r]=t||""}unsubscribe(e){if(e)for(const[t,r]of this.componentDB){for(let a=r.length-1;0<=a;a--)r[a].element===e&&r.splice(a,1);r.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces_=this.theme=this.owner_=null,this.componentDB.clear()}},f_="VARIABLE_DYNAMIC",hr={};hr.CATEGORY_NAME=f_,hr.flyoutCategory=qh,hr.flyoutCategoryBlocks=CE,hr.onCreateVariableButtonClick_Colour=IE,hr.onCreateVariableButtonClick_Number=RE,hr.onCreateVariableButtonClick_String=yE;var nv=class{canConnect(e,t,r,a){return this.canConnectWithReason(e,t,r,a)===Tt.CAN_CONNECT}canConnectWithReason(e,t,r,a){const d=this.doSafetyChecks(e,t);return d!==Tt.CAN_CONNECT?d:this.doTypeChecks(e,t)?r&&!this.doDragChecks(e,t,a||0)?Tt.REASON_DRAG_CHECKS_FAILED:Tt.CAN_CONNECT:Tt.REASON_CHECKS_FAILED}getErrorMessage(e,t,r){switch(e){case Tt.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Tt.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Tt.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Tt.REASON_TARGET_NULL:return"Target connection is null.";case Tt.REASON_CHECKS_FAILED:return"Connection checks failed. "+(t+" expected "+t.getCheck()+", found "+r.getCheck());case Tt.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Tt.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Tt.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return Tt.REASON_TARGET_NULL;let r,a,d;return e.isSuperior()?(r=e.getSourceBlock(),a=t.getSourceBlock(),d=t):(a=e.getSourceBlock(),r=t.getSourceBlock(),d=e,e=t),r===a?Tt.REASON_SELF_CONNECTION:d.type!==Xr[e.type]?Tt.REASON_WRONG_TYPE:r.workspace!==a.workspace?Tt.REASON_DIFFERENT_WORKSPACES:r.isShadow()&&!a.isShadow()?Tt.REASON_SHADOW_PARENT:d.type===Ne.OUTPUT_VALUE&&a.previousConnection&&a.previousConnection.isConnected()||d.type===Ne.PREVIOUS_STATEMENT&&a.outputConnection&&a.outputConnection.isConnected()?Tt.REASON_PREVIOUS_AND_OUTPUT:Tt.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return true;for(let r=0;r<e.length;r++)if(t.indexOf(e[r])!==-1)return true;return false}doDragChecks(e,t,r){if(e.distanceFrom(t)>r||t.getSourceBlock().isInsertionMarker())return false;switch(t.type){case Ne.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case Ne.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return false;break;case Ne.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return false;break;case Ne.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection)return false;break;default:return false}return Br.indexOf(t)===-1}canConnectToPrevious_(e,t){return e.targetConnection||Br.indexOf(t)!==-1?false:t.targetConnection?(e=t.targetBlock(),e.isInsertionMarker()?!e.getPreviousBlock():false):true}};Ie(Te.CONNECTION_CHECKER,Dn,nv);var m_=class extends Ja{constructor(e){super(e),this.type=Bo,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}fromJson(e){o("Blockly.Events.VarDelete.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.varType=e.varType,this.varName=e.varName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new m_),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.deleteVariableById(this.varId):t.createVariable(this.varName,this.varType,this.varId)}};Ie(Te.EVENT,Bo,m_);var E_=class extends Ja{constructor(e,t){super(e),this.type=Va,e&&(this.oldName=e.name,this.newName=typeof t>"u"?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}fromJson(e){o("Blockly.Events.VarRename.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldName=e.oldName,this.newName=e.newName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new E_),t.oldName=e.oldName,t.newName=e.newName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");e?t.renameVariableById(this.varId,this.newName):t.renameVariableById(this.varId,this.oldName)}};Ie(Te.EVENT,Va,E_);var b_=class{constructor(e){this.workspace=e,this.variableMap=new Map}clear(){this.variableMap.clear()}renameVariable(e,t){if(e.name!==t){var r=this.getVariable(t,e.type),a=this.workspace.getAllBlocks(false);He(true);try{r&&r.getId()!==e.getId()?this.renameVariableWithConflict_(e,t,r,a):this.renameVariableAndUses_(e,t,a)}finally{He(false)}}}renameVariableById(e,t){const r=this.getVariableById(e);if(!r)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(r,t)}renameVariableAndUses_(e,t,r){for(Pe(new(ve(Va))(e,t)),e.name=t,t=0;t<r.length;t++)r[t].updateVarName(e)}renameVariableWithConflict_(e,t,r,a){const d=e.type;for(t!==r.name&&this.renameVariableAndUses_(r,t,a),t=0;t<a.length;t++)a[t].renameVarById(e.getId(),r.getId());Pe(new(ve(Bo))(e)),Xs(this.variableMap.get(d),e)}createVariable(e,t,r){var a=this.getVariable(e,t);if(a){if(r&&a.getId()!==r)throw Error('Variable "'+e+'" is already in use and its id is "'+a.getId()+'" which conflicts with the passed in id, "'+r+'".');return a}if(r&&this.getVariableById(r))throw Error('Variable id, "'+r+'", is already in use.');return a=r||ui(),t=t||"",a=new Za(this.workspace,e,t,a),e=this.variableMap.get(t)||[],e.push(a),this.variableMap.delete(t),this.variableMap.set(t,e),Pe(new(ve(Fr))(a)),a}deleteVariable(e){const t=e.getId(),r=this.variableMap.get(e.type);if(r){for(let a=0;a<r.length;a++)if(r[a].getId()===t){r.splice(a,1),Pe(new(ve(Bo))(e));break}}}deleteVariableById(e){const t=this.getVariableById(e);if(t){var r=t.name;const a=this.getVariableUsesById(e);for(let d=0,C;C=a[d];d++)if(C.type==="procedures_defnoreturn"||C.type==="procedures_defreturn"){e=String(C.getFieldValue("NAME")),r=je.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",r).replace("%2",e),kr(r);return}1<a.length?(r=je.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(a.length)).replace("%2",r),Aa(r,d=>{d&&t&&this.deleteVariableInternal(t,a)})):this.deleteVariableInternal(t,a)}else console.warn("Can't delete non-existent variable: "+e)}deleteVariableInternal(e,t){const r=Bt();r||He(true);try{for(let a=0;a<t.length;a++)t[a].dispose(true);this.deleteVariable(e)}finally{r||He(false)}}getVariable(e,t){if(t=this.variableMap.get(t||"")){for(let r=0,a;a=t[r];r++)if(Ni.equals(a.name,e))return a}return null}getVariableById(e){for(const[,t]of this.variableMap)for(const r of t)if(r.getId()===e)return r;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?e.slice():[]}getVariableTypes(e){const t=new Set(this.variableMap.keys());if(e&&e.getPotentialVariableMap())for(const r of e.getPotentialVariableMap().variableMap.keys())t.add(r);return t.has("")||t.add(""),Array.from(t.values())}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(t);return e}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(e=>e.name)}getVariableUsesById(e){const t=[],r=this.workspace.getAllBlocks(false);for(let a=0;a<r.length;a++){const d=r[a].getVarModels();if(d)for(let C=0;C<d.length;C++)d[C].getId()===e&&t.push(r[a])}return t}},Vn=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=false,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Yb(this),this.potentialVariableMap=null,this.id=ui(),A(this),this.options=e||new Yi({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(js(Te.CONNECTION_CHECKER,this.options,true))(this),this.variableMap=new b_(this)}dispose(){this.listeners.length=0,this.clear(),I(this)}sortObjects_(e,t){return e=e.getRelativeToSurfaceXY(),t=t.getRelativeToSurfaceXY(),e.y+Vn.prototype.sortObjects_.offset*e.x-(t.y+Vn.prototype.sortObjects_.offset*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!Xs(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e){const t=[].concat(this.topBlocks);return e&&1<t.length&&(this.sortObjects_.offset=Math.sin(Ut(Vn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){Xs(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&(this.sortObjects_.offset=Math.sin(Ut(Vn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e.filter(function(r){return!r.isInsertionMarker()})):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!Xs(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e){const t=[].concat(this.topComments);return e&&1<t.length&&(this.sortObjects_.offset=Math.sin(Ut(Vn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t}getAllBlocks(e){if(e){var t=this.getTopBlocks(true);e=[];for(let r=0;r<t.length;r++)e.push(...t[r].getDescendants(true))}else for(e=this.getTopBlocks(false),t=0;t<e.length;t++)e.push(...e[t].getChildren(false));return e.filter(function(r){return!r.isInsertionMarker()})}clear(){this.isClearing=true;try{const e=Bt();for(e||He(true);this.topBlocks.length;)this.topBlocks[0].dispose(false);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();e||He(false),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=false}}renameVariableById(e,t){this.variableMap.renameVariableById(e,t)}createVariable(e,t,r){return this.variableMap.createVariable(e,t,r)}getVariableUsesById(e){return this.variableMap.getVariableUsesById(e)}deleteVariableById(e){this.variableMap.deleteVariableById(e)}getVariable(e,t){return this.variableMap.getVariable(e,t)}getVariableById(e){return this.variableMap.getVariableById(e)}getVariablesOfType(e){return this.variableMap.getVariablesOfType(e)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(false).length}remainingCapacityOfType(e){return this.options.maxInstances?(this.options.maxInstances[e]!==void 0?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,false).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return true;let t=0;for(const r in e){if(e[r]>this.remainingCapacityOfType(r))return false;t+=e[r]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,r=e?this.undoStack_:this.redoStack_;const a=t.pop();if(a){for(var d=[a];t.length&&a.group&&a.group===t[t.length-1].group;)d.push(t.pop());for(t=0;t<d.length;t++)r.push(d[t]);d=bo(d,e),As(false);try{for(r=0;r<d.length;r++)d[r].run(e)}finally{As(true)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,Ci()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){Xs(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return(t=this.commentDB.get(e))!=null?t:null}allInputsFilled(e){const t=this.getTopBlocks(false);for(let r=0;r<t.length;r++)if(!t[r].allInputsFilled(e))return false;return true}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new b_(this)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}static getById(e){return O(e)}static getAll(){return w()}};Vn.SCAN_ANGLE=3;var NO=100,rv=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound_=null}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var r=new globalThis.Audio}catch{return}for(let d=0;d<e.length;d++){const C=e[d],M=C.match(/\.(\w+)$/);if(M&&r.canPlayType("audio/"+M[1])){var a=new globalThis.Audio(C);break}}a&&this.sounds.set(t,a)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(t!==void 0?t.then(e.pause).catch(function(){}):e.pause(),Ao||eb)break}}play(e,t){var r=this.sounds.get(e);r?(e=new Date,this.lastSound_!==null&&e.getTime()-this.lastSound_.getTime()<NO||(this.lastSound_=e,r=Ao||Vc?r:r.cloneNode(),r.volume=t===void 0?1:t,r.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}},ov=class{constructor(e){this.workspace=e,this.id="zoomControls",this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=this.onZoomOutWrapper=this.onZoomInWrapper=this.onZoomResetWrapper=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=false}createDom(){this.svgGroup=G(te.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[Ss.Capability.POSITIONABLE]}),this.initialized=true}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&W(this.svgGroup),this.onZoomResetWrapper&&g(this.onZoomResetWrapper),this.onZoomInWrapper&&g(this.onZoomInWrapper),this.onZoomOutWrapper&&g(this.onZoomOutWrapper)}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new Zt(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var r=jh(this.workspace,e),a=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(a+=this.LARGE_SPACING+this.HEIGHT),e=zh(r,new Ts(this.WIDTH,a),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),r=r.vertical,t=Xh(e,this.MARGIN_VERTICAL,r===Gn.TOP?ur.DOWN:ur.UP,t),r===Gn.TOP){var d=this.SMALL_SPACING+this.HEIGHT,C;(C=this.zoomInGroup)==null||C.setAttribute("transform","translate(0, "+d+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(d+this.LARGE_SPACING+this.HEIGHT)+")")}else{C=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let z;(z=this.zoomInGroup)==null||z.setAttribute("transform","translate(0, "+C+")"),C=C+this.SMALL_SPACING+this.HEIGHT,(d=this.zoomOutGroup)==null||d.setAttribute("transform","translate(0, "+C+")")}this.top=t.top,this.left=t.left;var M;(M=this.svgGroup)==null||M.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=G(te.G,{class:"blocklyZoom"},this.svgGroup);const t=G(te.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);G(te.RECT,{width:32,height:32},t),G(te.IMAGE,{width:Fs.width,height:Fs.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(qs,"xlink:href",this.workspace.options.pathToMedia+Fs.url),this.onZoomOutWrapper=T(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1))}createZoomInSvg(e){this.zoomInGroup=G(te.G,{class:"blocklyZoom"},this.svgGroup);const t=G(te.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);G(te.RECT,{width:32,height:32},t),G(te.IMAGE,{width:Fs.width,height:Fs.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(qs,"xlink:href",this.workspace.options.pathToMedia+Fs.url),this.onZoomInWrapper=T(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),f(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=G(te.G,{class:"blocklyZoom"},this.svgGroup);const t=G(te.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);G(te.RECT,{width:32,height:32},t),G(te.IMAGE,{width:Fs.width,height:Fs.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(qs,"xlink:href",this.workspace.options.pathToMedia+Fs.url),this.onZoomResetWrapper=T(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),f(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(ve(ar))(null,this.workspace.id,"zoom_controls");Pe(e)}};us(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var MO=20,Ji=class extends Vn{constructor(e,t,r){super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=true,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.workspaceDragSurface=this.blockDragSurface=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.isDragSurfaceActive=false,this.inverseScreenCTM=this.targetWorkspace=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=null,this.inverseScreenCTMDirty=true,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=false,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=null,this.metricsManager=new(js(Te.METRICS_MANAGER,e,true))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||Ji.setTopLevelWorkspaceMetrics_,this.componentManager=new Ss,this.connectionDBList=ea.init(this.connectionChecker),t&&(this.blockDragSurface=t),r&&(this.workspaceDragSurface=r),this.useWorkspaceDragSurface=!!this.workspaceDragSurface,this.audioManager=new rv(e.parentWorkspace),this.grid=this.options.gridPattern?new o_(this.options.gridPattern,e.gridOptions):null,this.markerManager=new Qa(this),i.module$build$src$core$variables&&Na&&this.registerToolboxCategoryCallback(nu,Na),hr&&qh&&this.registerToolboxCategoryCallback(f_,qh),i.module$build$src$core$procedures&&Yh&&(this.registerToolboxCategoryCallback(Eu,Yh),this.addChangeListener(vE)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new iv(this,this.options.theme||du),this.themeManager_.subscribeWorkspace(this);let a;this.renderer=$E(this.options.renderer||"geras",this.getTheme(),(a=this.options.rendererOverrides)!=null?a:void 0),this.cachedParentSvgSize=new Ts(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(e){this.markerManager.setCursorSvg(e)}setMarkerSvg(e){this.markerManager.setMarkerSvg(e)}getMarker(e){return this.markerManager?this.markerManager.getMarker(e):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=du),this.themeManager_.setTheme(e)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(false).filter(function(t){return!!t.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(true);const e=new(ve(Ka))(this.getTheme().name,this.id);Pe(e)}updateBlockStyles_(e){for(let t=0,r;r=e[t];t++){const a=r.getStyleName();if(a){const d=r;d.setStyle(a),d.mutator&&d.mutator.updateBlockStyle()}}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=false)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=true}isVisible(){return this.isVisible_}getSvgXY(e){let t=0,r=0,a=1;(ce(this.getCanvas(),e)||ce(this.getBubbleCanvas(),e))&&(a=this.scale);do{const d=_i(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(a=1),t+=d.x*a,r+=d.y*a,e=e.parentNode}while(e&&e!==this.getParentSvg());return new we(t,r)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new Ts(e.width,e.height)}getOriginOffsetInPixels(){return Tc(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getBlockCanvas(){return this.svgBlockCanvas_}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e){return this.svgGroup_=G(te.G,{class:"blocklyWorkspace"}),e&&(this.svgBackground_=G(te.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),e==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=G(te.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=G(te.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(T(this.svgGroup_,"pointerdown",this,this.onMouseDown_,false),document.body.addEventListener("wheel",function(){}),T(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(js(Te.TOOLBOX,this.options,true))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=js(Te.CURSOR,this.options))&&this.markerManager.setCursor(new e),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=false,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&W(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&W(e.parentNode)}this.resizeHandlerWrapper&&(g(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null)}addTrashcan(){this.trashcan=Ji.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.svgBlockCanvas_)}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new ov(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}addFlyout(e){const t=new Yi({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:true}});return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(js(Te.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,true))(t):new(js(Te.FLYOUTS_VERTICAL_TOOLBOX,this.options,true))(t),this.flyout.autoClose=false,this.flyout.getWorkspace().setVisible(true),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(Ss.Capability.POSITIONABLE,true),t=this.getMetricsManager().getUiMetrics(),r=[];for(let a=0,d;d=e[a];a++){d.position(t,r);const C=d.getBoundingRectangle();C&&r.push(C)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const e=Rh();we.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations_())}getCanvas(){return this.svgBlockCanvas_}setCachedParentSvgSize(e,t){const r=this.getParentSvg();e!=null&&(this.cachedParentSvgSize.width=e,r.setAttribute("data-cached-width",e.toString())),t!=null&&(this.cachedParentSvgSize.height=t,r.setAttribute("data-cached-height",t.toString()))}getBubbleCanvas(){return this.svgBubbleCanvas_}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if(e.tagName==="svg"){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(as()){var e=this.scale,t=-this.scrollY,r=-this.scrollX;if(!(e===this.oldScale&&1>Math.abs(t-this.oldTop)&&1>Math.abs(r-this.oldLeft))){var a=new(ve(Gr))(t,r,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=r,Pe(a)}}}translate(e,t){if(this.useWorkspaceDragSurface&&this.isDragSurfaceActive){var r;(r=this.workspaceDragSurface)==null||r.translateSurface(e,t)}else r="translate("+e+","+t+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",r),this.svgBubbleCanvas_.setAttribute("transform",r);this.blockDragSurface&&this.blockDragSurface.translateAndScaleGroup(e,t,this.scale),this.grid&&this.grid.moveTo(e,t),this.maybeFireViewportChangeEvent()}resetDragSurface(){if(this.useWorkspaceDragSurface){this.isDragSurfaceActive=false;var e=this.workspaceDragSurface.getSurfaceTranslation();this.workspaceDragSurface.clearAndHide(this.svgGroup_),e="translate("+e.x+","+e.y+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",e),this.svgBubbleCanvas_.setAttribute("transform",e)}}setupDragSurface(){if(this.useWorkspaceDragSurface&&!this.isDragSurfaceActive){this.isDragSurfaceActive=true;var e=this.svgBlockCanvas_.previousSibling,t,r=parseInt((t=this.getParentSvg().getAttribute("width"))!=null?t:"0"),a;t=parseInt((a=this.getParentSvg().getAttribute("height"))!=null?a:"0"),a=_i(this.getCanvas()),this.workspaceDragSurface.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),e,r,t,this.scale),this.workspaceDragSurface.translateSurface(a.x,a.y)}}getBlockDragSurface(){return this.blockDragSurface}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){if(this.isVisible_=e,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox_&&this.toolbox_.setVisible(e),e){e=this.getAllBlocks(false);for(let t=e.length-1;0<=t;t--)e[t].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else this.hideChaff(true)}render(){for(var e=this.getAllBlocks(false),t=e.length-1;0<=t;t--)e[t].render(false);if(this.currentGesture_)for(e=this.currentGesture_.getInsertionMarkers(),t=0;t<e.length;t++)e[t].render(false);this.markerManager.updateMarkers()}highlightBlock(e,t){if(t===void 0){for(let r=0,a;a=this.highlightedBlocks[r];r++)a.setHighlighted(false);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=t===void 0||t)?this.highlightedBlocks.indexOf(e)===-1&&this.highlightedBlocks.push(e):Xs(this.highlightedBlocks,e),e.setHighlighted(t))}paste(e){if(!this.rendered||!e.type&&!e.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const t=Bt();return t||He(true),e=e.type?this.pasteBlock_(null,e):e.tagName.toLowerCase()==="comment"?this.pasteWorkspaceComment_(e):this.pasteBlock_(e,null),He(t),e}pasteBlock_(e,t){Yt();let r;try{let a=0,d=0;if(e){r=Io(e,this);let C;a=parseInt((C=e.getAttribute("x"))!=null?C:"0"),this.RTL&&(a=-a);let M;d=parseInt((M=e.getAttribute("y"))!=null?M:"0")}else t&&(r=Dr(t,this),a=t.x||10,this.RTL&&(a=this.getWidth()-a),d=t.y||10);if(!isNaN(a)&&!isNaN(d)){let C;do{C=false;const M=this.getAllBlocks(false);for(let z=0,he;he=M[z];z++){const ke=he.getRelativeToSurfaceXY();if(1>=Math.abs(a-ke.x)&&1>=Math.abs(d-ke.y)){C=true;break}}if(!C){const z=r.getConnections_(false);for(let he=0,ke;ke=z[he];he++)if(ke.closest(i.config$$module$build$src$core$config.snapRadius,new we(a,d)).connection){C=true;break}}C&&(a=this.RTL?a-i.config$$module$build$src$core$config.snapRadius:a+i.config$$module$build$src$core$config.snapRadius,d+=2*i.config$$module$build$src$core$config.snapRadius)}while(C);r.moveTo(new we(a,d))}}finally{qt()}return as()&&!r.isShadow()&&Pe(new(ve(ys))(r)),r.select(),r}pasteWorkspaceComment_(e){Yt();let t;try{t=Ms.fromXmlRendered(e,this);let r,a=parseInt((r=e.getAttribute("x"))!=null?r:"0"),d,C=parseInt((d=e.getAttribute("y"))!=null?d:"0");isNaN(a)||isNaN(C)||(this.RTL&&(a=-a),t.moveBy(a+50,C+50))}finally{qt()}return as()&&_n.fireCreateEvent(t),t.select(),t}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox_&&e.toolbox_.getFlyout()&&e.toolbox_.refreshSelection()}renameVariableById(e,t){super.renameVariableById(e,t),this.refreshToolboxSelection()}deleteVariableById(e){super.deleteVariableById(e),this.refreshToolboxSelection()}createVariable(e,t,r){return e=super.createVariable(e,t,r),this.refreshToolboxSelection(),e}recordDragTargets(){const e=this.componentManager.getComponents(Ss.Capability.DRAG_TARGET,true);this.dragTargetAreas=[];for(let t=0,r;r=e[t];t++){const a=r.getClientRect();a&&this.dragTargetAreas.push({component:r,clientRect:a})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t=0,r;r=this.dragTargetAreas[t];t++)if(r.clientRect.contains(e.clientX,e.clientY))return r.component;return null}onMouseDown_(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){e=v(e,this.getParentSvg(),this.getInverseScreenCTM()),e.x/=this.scale,e.y/=this.scale,this.dragDeltaXY=we.difference(t,e)}moveDrag(e){return e=v(e,this.getParentSvg(),this.getInverseScreenCTM()),e.x/=this.scale,e.y/=this.scale,we.sum(this.dragDeltaXY,e)}isDragging(){return this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel_(e){if(pn.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,r=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||r){var a=S(e);if(od)var d=e.metaKey;t&&(e.ctrlKey||d||!r)?(a=-a.y/50,t=v(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,a)):(t=this.scrollX-a.x,r=this.scrollY-a.y,e.shiftKey&&!a.x&&(t=this.scrollX-a.y,r=this.scrollY),this.scroll(t,r)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new Zt(0,0,0,0);const t=e[0].getBoundingRectangle();for(let a=1;a<e.length;a++){var r=e[a];r.isInsertionMarker&&r.isInsertionMarker()||(r=r.getBoundingRectangle(),r.top<t.top&&(t.top=r.top),r.bottom>t.bottom&&(t.bottom=r.bottom),r.left<t.left&&(t.left=r.left),r.right>t.right&&(t.right=r.right))}return t}cleanUp(){this.setResizesEnabled(false),He(true);const e=this.getTopBlocks(true);let t=0;for(let r=0,a;a=e[r];r++){if(!a.isMovable())continue;const d=a.getRelativeToSurfaceXY();a.moveBy(-d.x,t-d.y),a.snapToGrid(),t=a.getRelativeToSurfaceXY().y+a.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}He(false),this.setResizesEnabled(true)}showContextMenu(e){if(!this.options.readOnly&&!this.isFlyout){var t=St.registry.getContextMenuOptions(St.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(t,e),Mc(e,t,this.RTL)}}updateToolbox(e){if(e=Oc(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(xh(e)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox_.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(x(this),this.setBrowserFocus())}setBrowserFocus(){document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:true})}catch{try{this.getParentSvg().parentElement.setActive()}catch{this.getParentSvg().parentElement.focus({preventScroll:true})}}}zoom(e,t,r){r=Math.pow(this.options.zoomOptions.scaleSpeed,r);const a=this.scale*r;if(this.scale!==a){a>this.options.zoomOptions.maxScale?r=this.options.zoomOptions.maxScale/this.scale:a<this.options.zoomOptions.minScale&&(r=this.options.zoomOptions.minScale/this.scale);var d=this.getCanvas().getCTM(),C=this.getParentSvg().createSVGPoint();C.x=e,C.y=t,C=C.matrixTransform(d.inverse()),e=C.x,t=C.y,d=d.translate(e*(1-r),t*(1-r)).scale(r),this.scrollX=d.e,this.scrollY=d.f,this.setScale(a)}}zoomCenter(e){var t=this.getMetrics();let r;this.flyout?(r=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(r=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(r,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var r=this.getBlocksBoundingBox(),a=2*MO,d=r.right-r.left+a;if(r=r.bottom-r.top+a,d){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),r+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),d+=this.flyout.getWidth()/this.scale)),t/=d,e/=r,Yt();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{qt()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){ae(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),ae(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}endCanvasTransition(){fe(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),fe(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,r=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,r=-r-e.scrollTop,this.scroll(t,r)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e){if(this.isMovable()){if(e=e?this.getBlockById(e):null){var t=e.getRelativeToSurfaceXY(),r=e.getHeightWidth(),a=this.scale;e=(t.x+(this.RTL?-1:1)*r.width/2)*a,t=(t.y+r.height/2)*a,r=this.getMetrics(),this.scroll(-(e-r.viewWidth/2),-(t-r.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(false),(e=this.getFlyout(false))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(e,t){this.hideChaff(true);const r=this.getMetrics();e=Math.min(e,-r.scrollLeft),t=Math.min(t,-r.scrollTop);const a=r.scrollTop+Math.max(0,r.scrollHeight-r.viewHeight);e=Math.max(e,-(r.scrollLeft+Math.max(0,r.scrollWidth-r.viewWidth))),t=Math.max(t,-a),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+r.scrollLeft),-(t+r.scrollTop),false),e+=r.absoluteLeft,t+=r.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e){return super.getAllBlocks(e)}getTopBlocks(e){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){Xs(this.topBoundedElements,e)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(false),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(true)}registerButtonCallback(e,t){if(typeof t!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return(t=this.flyoutButtonCallbacks.get(e))!=null?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if(typeof t!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){const t=e.type==="pointerdown",r=this.currentGesture_;return r?t&&r.hasStarted()?(console.warn("Tried to start the same gesture twice."),r.cancel(),null):r:t?this.currentGesture_=new pn(e,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e){Nr(),ln(),wt();const t=!!e;this.getComponentManager().getComponents(Ss.Capability.AUTOHIDEABLE,true).forEach(r=>r.autoHide(t))}static setTopLevelWorkspaceMetrics_(e){const t=this.getMetrics();typeof e.x=="number"&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),typeof e.y=="number"&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}},v_={};v_.load=BC,v_.save=xC;var av=class{constructor(){this.priority=Ab}save(e){const t=[];for(const r of e.getAllVariables())e={name:r.name,id:r.getId()},r.type&&(e.type=r.type),t.push(e);return t.length?t:null}load(e,t){for(const r of e)t.createVariable(r.name,r.type,r.id)}clear(e){e.getVariableMap().clear()}};Hh("variables",new av);var lv={};lv.VariableSerializer=av;var cv=class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=Lb}save(e){return e.getProcedureMap().getProcedures().map(t=>Jh(t))}load(e,t){const r=t.getProcedureMap();for(const a of e)r.add(Qh(this.procedureModelClass,this.parameterModelClass,a,t))}clear(e){e.getProcedureMap().clear()}},DO=new cv(bl,ta),Jr={};Jr.ProcedureSerializer=cv,Jr.loadParameter=ed,Jr.loadProcedure=Qh,Jr.observableProcedureSerializer=DO,Jr.saveParameter=Zh,Jr.saveProcedure=Jh;var xO={blocks:cl,exceptions:Xo,priorities:_u,procedures:Jr,registry:Fd,variables:lv,workspaces:v_},uv=class extends yl{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=true,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=true,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter_=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter_&&W(this.selectedGlowFilter_),this.replacementGlowFilter_&&W(this.replacementGlowFilter_)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=pi("c",[Ge(25,-e),Ge(71,-e),Ge(t,0)]);return{height:e,width:t,path:r}}makeHexagonal(){function e(r,a,d){var C=r/2;return C=C>t?t:C,d=d?-1:1,r=(a?-1:1)*r/2,An(-d*C,r)+An(d*C,r)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:true,width(r){return r/=2,r>t?t:r},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,false,false)},pathUp(r){return e(r,true,false)},pathRightDown(r){return e(r,false,true)},pathRightUp(r){return e(r,false,true)}}}makeRounded(){function e(a,d,C){const M=a>r?a-r:0;return a=(a>r?r:a)/2,hs("a","0 0,1",a,Ge((d?-1:1)*a,(d?-1:1)*a))+Me("v",(C?1:-1)*M)+hs("a","0 0,1",a,Ge((d?1:-1)*a,(d?-1:1)*a))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=2*t;return{type:this.SHAPES.ROUND,isDynamic:true,width(a){return a/=2,a>t?t:a},height(a){return a},connectionOffsetY(a){return a/2},connectionOffsetX(a){return-a},pathDown(a){return e(a,false,false)},pathUp(a){return e(a,true,false)},pathRightDown(a){return e(a,false,true)},pathRightUp(a){return e(a,false,true)}}}makeSquared(){function e(r,a,d){return r-=2*t,hs("a","0 0,1",t,Ge((a?-1:1)*t,(a?-1:1)*t))+Me("v",(d?1:-1)*r)+hs("a","0 0,1",t,Ge((a?1:-1)*t,(a?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:true,width(r){return t},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,false,false)},pathUp(r){return e(r,true,false)},pathRightDown(r){return e(r,false,true)},pathRightUp(r){return e(r,false,true)}}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case Ne.INPUT_VALUE:case Ne.OUTPUT_VALUE:if(e=e.getSourceBlock().getOutputShape(),e!==null)switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.indexOf("Boolean")!==-1?this.HEXAGONAL:t&&t.indexOf("Number")!==-1?this.ROUNDED:(t&&t.indexOf("String"),this.ROUNDED);case Ne.PREVIOUS_STATEMENT:case Ne.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(ke){return pi("c",[Ge(ke*d/2,0),Ge(ke*d*3/4,M/2),Ge(ke*d,M)])+Ba([Ge(ke*d,C)])+pi("c",[Ge(ke*d/4,M/2),Ge(ke*d/2,M),Ge(ke*d,M)])+Me("h",ke*a)+pi("c",[Ge(ke*d/2,0),Ge(ke*d*3/4,-(M/2)),Ge(ke*d,-M)])+Ba([Ge(ke*d,-C)])+pi("c",[Ge(ke*d/4,-(M/2)),Ge(ke*d/2,-M),Ge(ke*d,-M)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,a=t/3,d=a/3,C=r/2,M=C/2,z=e(1),he=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:z,pathRight:he}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=hs("a","0 0,0",e,Ge(-e,e)),r=hs("a","0 0,1",e,Ge(-e,e)),a=hs("a","0 0,0",e,Ge(e,e)),d=hs("a","0 0,1",e,Ge(e,e));return{width:e,height:e,pathTop:t,pathBottom:a,rightWidth:e,rightHeight:e,pathTopRight:r,pathBottomRight:d}}generateSecondaryColour_(e){return Co("#000",e,.15)||e}generateTertiaryColour_(e){return Co("#000",e,.25)||e}createDom(e,t,r){super.createDom(e,t,r),e=G(te.DEFS,{},e),t=G(te.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),G(te.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),r=G(te.FECOMPONENTTRANSFER,{result:"outBlur"},t),G(te.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),G(te.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),G(te.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter_=t,e=G(te.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),G(te.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=G(te.FECOMPONENTTRANSFER,{result:"outBlur"},e),G(te.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),G(te.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),G(te.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),G(te.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter_=e}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text,`,`${e} .blocklyNonEditableText>g>text,`,`${e} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .goog-menuitem,`,`${e}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},hv=class extends Rl{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;if(e.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),e.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&e.flipRTL(),xc()){let t,r;(t=this.block_)==null||(r=t.renderingDebugger)==null||r.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(0>=e.height))if(Y.isSpacer(e)&&(e.precedesStatement||e.followsStatement)){var t=this.constants_.INSIDE_CORNERS.rightHeight;t=e.height-(e.precedesStatement?t:0),this.outlinePath_+=(e.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<t?Me("V",e.yPos+t):"")+(e.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=Me("V",e.yPos+e.height)}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=Vt(e.xPos,this.info_.startY),this.outlinePath_+=Me("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=Me("V",e.baseline),this.outlinePath_+=Me("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;if(!e.connectedBlock&&!this.info_.isInsertionMarker){var r=e.width-2*e.connectionWidth;e=Ns(e.xPos+e.connectionWidth,e.centerline-e.height/2)+Me("h",r)+e.shape.pathRightDown(e.height)+Me("h",-r)+e.shape.pathUp(e.height)+"z",this.block_.pathObject.setOutlinePath(t,e)}}drawStatementInput_(e){var t=e.getLastInput();const r=t.xPos+t.notchOffset+t.shape.width,a=t.shape.pathRight+Me("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,d=e.height-2*this.constants_.INSIDE_CORNERS.height;t=this.constants_.INSIDE_CORNERS.pathBottom+Me("h",t.notchOffset-this.constants_.INSIDE_CORNERS.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=Me("H",r)+a+Me("v",d)+t+Me("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}};i.FieldImage$$module$build$src$core$field_image=class extends dt{constructor(e,t,r,a,d,C,M){if(super(dt.SKIP_SETUP),this.imageElement_=this.clickHandler_=null,this.flipRtl_=this.isDirty_=this.EDITABLE=false,this.altText_="",r=Number(Jt(r)),t=Number(Jt(t)),isNaN(r)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(0>=r||0>=t)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Ts(t,r+i.FieldImage$$module$build$src$core$field_image.Y_PADDING),this.imageHeight_=r,typeof d=="function"&&(this.clickHandler_=d),e!==dt.SKIP_SETUP&&(M?this.configure_(M):(this.flipRtl_=!!C,this.altText_=Jt(a)||""),this.setValue(Jt(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl_=e.flipRtl),e.alt&&(this.altText_=Jt(e.alt))}initView(){this.imageElement_=G(te.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(qs,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return typeof e!="string"?null:e}doValueUpdate_(e){this.value_=e,this.imageElement_&&this.imageElement_.setAttributeNS(qs,"xlink:href",String(this.value_))}getFlipRtl(){return this.flipRtl_}setAlt(e){e!==this.altText_&&(this.altText_=e||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))}showEditor_(){this.clickHandler_&&this.clickHandler_(this)}setOnClickHandler(e){this.clickHandler_=e}getText_(){return this.altText_}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}},i.FieldImage$$module$build$src$core$field_image.Y_PADDING=1,ki("field_image",i.FieldImage$$module$build$src$core$field_image),i.FieldImage$$module$build$src$core$field_image.prototype.DEFAULT_VALUE="",i.FieldImage$$module$build$src$core$field_image;var Cl=class extends dt{constructor(e,t,r){super(dt.SKIP_SETUP),this.spellcheck_=true,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=false,this.onKeyInputWrapper_=this.onKeyDownWrapper_=null,this.fullBlockClickTarget_=false,this.workspace_=null,this.SERIALIZABLE=true,this.CURSOR="text",e!==dt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.spellcheck!==void 0&&(this.spellcheck_=e.spellcheck)}initView(){const e=this.getSourceBlock();if(!e)throw new _s;if(this.getConstants().FULL_BLOCK_FIELDS){let t=0,r=0;for(let a=0,d;d=e.inputList[a];a++){for(let C=0;d.fieldRow[C];C++)t++;d.connection&&r++}this.fullBlockClickTarget_=1>=t&&e.outputConnection&&!r}else this.fullBlockClickTarget_=false;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()}doClassValidation_(e){return e==null?null:String(e)}doValueInvalid_(e){this.isBeingEdited_&&(this.isDirty_=true,this.isTextValid_=false,e=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&as()&&Pe(new(ve(vs))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=true,this.value_=e}applyColour(){if(this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS){var e=this.sourceBlock_;this.borderRect_?this.borderRect_.setAttribute("stroke",e.style.colourTertiary):e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)}}render_(){if(super.render_(),this.isBeingEdited_){this.resizeEditor_();const e=this.htmlInput_;this.isTextValid_?(fe(e,"blocklyInvalidInput"),zt(e,Ft.INVALID,false)):(ae(e,"blocklyInvalidInput"),zt(e,Ft.INVALID,true))}}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t){this.workspace_=this.sourceBlock_.workspace,e=t||false,!e&&this.workspace_.options.modalInputs&&(ad||Vc||Ao)?this.showPromptEditor_():this.showInlineEditor_(e)}showPromptEditor_(){La(je.CHANGE_VALUE_TITLE,this.getText(),e=>{e!==null&&this.setValue(this.getValueFromEditorText_(e))})}showInlineEditor_(e){const t=this.getSourceBlock();if(!t)throw new _s;Nh(this,t.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=true,e||(this.htmlInput_.focus({preventScroll:true}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new _s;He(true);const t=wo();var r=this.getClickTarget_();if(!r)throw Error("A click target has not been set.");ae(r,"editing"),r=document.createElement("input"),r.className="blocklyHtmlInput",r.setAttribute("spellcheck",this.spellcheck_);const a=this.workspace_.getScale();var d=this.getConstants().FIELD_TEXT_FONTSIZE*a+"pt";return t.style.fontSize=d,r.style.fontSize=d,d=Cl.BORDERRADIUS*a+"px",this.fullBlockClickTarget_&&(d=this.getScaledBBox(),d=(d.bottom-d.top)/2+"px",e=e.getParent()?e.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,r.style.border=1*a+"px solid "+e,t.style.borderRadius=d,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*a+"px")),r.style.borderRadius=d,t.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",this.value_),this.resizeEditor_(),this.bindInputEvents_(r),r}widgetDispose_(){this.isBeingEdited_=false,this.isTextValid_=true,this.forceRerender(),this.onFinishEditing_(this.value_),He(false),this.unbindInputEvents_();var e=wo().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,e=this.getClickTarget_(),!e)throw Error("A click target has not been set.");fe(e,"editing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper_=T(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=T(e,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(g(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(g(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(e){e.keyCode===xe.ENTER?(ln(),wt()):e.keyCode===xe.ESC?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value")),ln(),wt()):e.keyCode===xe.TAB&&(ln(),wt(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())}onHtmlInputChange_(e){this.setValue(this.getValueFromEditorText_(this.htmlInput_.value))}setEditorValue_(e){this.isDirty_=true,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e)}resizeEditor_(){var e=this.getSourceBlock();if(!e)throw new _s;const t=wo(),r=this.getScaledBBox();t.style.width=r.right-r.left+"px",t.style.height=r.bottom-r.top+"px",e=new we(e.RTL?r.right-t.offsetWidth:r.left,r.top),t.style.left=e.x+"px",t.style.top=e.y+"px"}isTabNavigable(){return true}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return String(e)}getValueFromEditorText_(e){return e}};Cl.BORDERRADIUS=4,i.FieldTextInput$$module$build$src$core$field_textinput=class extends Cl{constructor(e,t,r){super(e,t,r)}static fromJson(e){return new this(Jt(e.text),void 0,e)}},ki("field_input",i.FieldTextInput$$module$build$src$core$field_textinput),i.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",i.FieldTextInput$$module$build$src$core$field_textinput;var dv=class extends l_{constructor(e){super(e)}endsWithElemSpacer(){return false}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},_v=class extends Tl{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=false,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=true)}}},pv=class extends mn{constructor(e){super(e),this.width=this.height=0,this.type|=Y.getType("RIGHT_CONNECTION")}},gv=class extends __{constructor(e){super(e)}endsWithElemSpacer(){return false}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},fv=class extends sa{constructor(e,t){super(e,t),this.isInline=true,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new gv(this.constants_),this.bottomRow=new dv(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new pv(this.constants_):null,this.rightAlignedDummyInputs_=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return t?e.type===it.STATEMENT||t.type===it.STATEMENT?true:e.type===it.VALUE||e.type===it.DUMMY?!this.isInline||this.isMultiRow:false:false}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&Y.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&Y.isLeftRoundedCorner(e)&&t&&(Y.isPreviousConnection(t)||Y.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&Y.isLeftSquareCorner(e)&&t&&Y.isHat(t)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(Y.isTopRow(e)&&Y.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const r=Y.isInputRow(e)&&e.hasStatement,a=Y.isInputRow(t)&&t.hasStatement;return a||r?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),a&&r?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):Y.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):Y.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const r=this.width-this.startX;return Y.isInputRow(e)&&e.hasStatement||Y.isInputRow(t)&&t.hasStatement?Math.max(r,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):r}getElemCenterline_(e,t){if(e.hasStatement&&!Y.isSpacer(t)&&!Y.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(Y.isInlineInput(t)&&t instanceof Hn){const r=t.connectedBlock;if(r&&r.outputConnection&&r.nextConnection)return e.yPos+r.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if(e.type===it.DUMMY&&t.hasDummyInput&&t.align===i.Align$$module$build$src$core$input.LEFT&&e.align===i.Align$$module$build$src$core$input.RIGHT)this.rightAlignedDummyInputs_.set(t,e);else if(e.type===it.STATEMENT){t.elements.push(new _v(this.constants_,e)),t.hasStatement=true,t.align===null&&(t.align=e.align);return}super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs_.get(e)){let r;for(let a=0;a<e.elements.length;a++){const d=e.elements[a];if(Y.isSpacer(d)&&(r=d),Y.isField(d)&&d instanceof qr&&d.parentInput===this.rightAlignedDummyInputs_.get(e))break}if(r){r.width+=t,e.width+=t;return}}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let d=2;d<this.rows.length-1;d+=2){var r=this.rows[d-1];const C=this.rows[d];var a=this.rows[d+1];if(r=d===2?!!this.topRow.hasPreviousConnection:!!r.followsStatement,a=d+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!a.precedesStatement,Y.isInputRow(C)&&C.hasStatement){C.measure();let M,z;t=C.width-((z=(M=C.getLastInput())==null?void 0:M.width)!=null?z:0)+e}else if(r&&(d===2||a)&&Y.isInputRow(C)&&!C.hasStatement){a=C.xPos,r=null;for(let M=0;M<C.elements.length;M++){const z=C.elements[M];Y.isSpacer(z)&&(r=z),r&&(Y.isField(z)||Y.isInput(z))&&a<t&&!(Y.isField(z)&&z instanceof qr&&(z.field instanceof i.FieldLabel$$module$build$src$core$field_label||z.field instanceof i.FieldImage$$module$build$src$core$field_image))&&(r.width+=t-a),a+=z.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,r=0;r<this.rows.length;r++){const a=this.rows[r];a.yPos=t,t+=a.height}this.height=t,r=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(r),r=e.width(r),this.outputConnection.height=t,this.outputConnection.width=r,this.outputConnection.startX=r,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(r),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=r,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=r,this.width+=r+e,this.widthWithChildren+=r+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var r=this.rows[t];if(!Y.isInputRow(r))continue;e=r.elements[r.elements.length-2];let a=this.getNegativeSpacing_(r.elements[1]),d=this.getNegativeSpacing_(e);e=a+d;const C=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<C&&(e=this.width-C,a=e/2,d=e/2),r.elements.unshift(new fi(this.constants_,-a)),r.elements.push(new fi(this.constants_,-d))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)r=this.rows[t],Y.isTopOrBottomRow(r)&&(r.elements[1].width-=e),r.width-=e,r.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var r=this.outputConnection.shape.type;const a=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)switch(r){case a.SHAPES.ROUND:return r=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=this.height/2>r?r:this.height/2,t-r*(1-Math.sin(Math.acos((r-this.constants_.SMALL_PADDING)/r)));default:return 0}if(Y.isInlineInput(e)&&e instanceof Hn){const d=e.connectedBlock;return e=d?d.pathObject.outputShapeType:e.shape.type,e==null||d&&d.outputConnection&&(d.statementInputCount||d.nextConnection)||r===a.SHAPES.HEXAGONAL&&r!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][e]}return Y.isField(e)&&e instanceof qr?r===a.SHAPES.ROUND&&e.field instanceof i.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*a.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][0]:Y.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let a=2;a<this.rows.length-1;a+=2){const d=this.rows[a-1],C=this.rows[a],M=this.rows[a+1];var e=a===2,t=a+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!M.precedesStatement;if(e?this.topRow.hasPreviousConnection:d.followsStatement){var r=C.elements[1];if(r=C.elements.length===3&&r instanceof qr&&(r.field instanceof i.FieldLabel$$module$build$src$core$field_label||r.field instanceof i.FieldImage$$module$build$src$core$field_image),!e&&r)d.height-=this.constants_.SMALL_PADDING,M.height-=this.constants_.SMALL_PADDING,C.height-=this.constants_.MEDIUM_PADDING;else if(!e&&!t)d.height+=this.constants_.SMALL_PADDING;else if(t){for(e=false,t=0;t<C.elements.length;t++)if(r=C.elements[t],r instanceof Hn&&Y.isInlineInput(r)&&r.connectedBlock&&!r.connectedBlock.isShadow()&&40<=r.connectedBlock.getHeightWidth().height){e=true;break}e&&(d.height-=this.constants_.SMALL_PADDING,M.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},mv=class extends g_{constructor(e,t,r){super(e,t,r),this.markerCircle_=null}showWithInputOutput_(e){const t=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle_(e.x,e.y),this.setParent_(t),this.showCurrent_()}showWithOutput_(e){this.showWithInputOutput_(e)}showWithInput_(e){this.showWithInputOutput_(e)}showWithBlock_(e){e=e.getLocation();const t=e.getHeightWidth();this.positionRect_(0,0,t.width,t.height),this.setParent_(e),this.showCurrent_()}positionCircle_(e,t){let r;(r=this.markerCircle_)==null||r.setAttribute("cx",e.toString());let a;(a=this.markerCircle_)==null||a.setAttribute("cy",t.toString()),this.currentMarkerSvg=this.markerCircle_}hide(){super.hide(),this.markerCircle_&&(this.markerCircle_.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle_=G(te.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){const e=this.getBlinkProperties_();G(te.ANIMATE,e,this.markerCircle_)}return this.markerSvg_}applyColour_(e){super.applyColour_(e);let t;(t=this.markerCircle_)==null||t.setAttribute("fill",this.colour_);let r;if((r=this.markerCircle_)==null||r.setAttribute("stroke",this.colour_),this.isCursor()){e=this.colour_+";transparent;transparent;";let a;(a=this.markerCircle_)==null||a.firstElementChild.setAttribute("values",e)}}},Ev=class extends vu{constructor(e,t,r){super(e,t,r),this.svgPathSelected_=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=r}setPath(e){super.setPath(e),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.style.colourTertiary);for(const r of this.outlines.values())r.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(true),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath_(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath_(e);this.remainingOutlines.clear()}setOutlinePath(e,t){e=this.getOutlinePath_(e),e.setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath_(e){return this.outlines.has(e)||this.outlines.set(e,G(te.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath_(e){let t,r;(t=this.outlines.get(e))==null||(r=t.parentNode)==null||r.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},bv=class extends Il{constructor(e){super(e)}makeConstants_(){return new uv}makeRenderInfo_(e){return new fv(this,e)}makeDrawer_(e,t){return new hv(e,t)}makeMarkerDrawer(e,t){return new mv(e,this.getConstants(),t)}makePathObject(e,t){return new Ev(e,t,this.getConstants())}getConstants(){return this.constants_}shouldHighlightConnection(e){return e.type!==Ne.INPUT_VALUE&&e.type!==Ne.OUTPUT_VALUE}getConnectionPreviewMethod(e,t,r){return t.type===Ne.OUTPUT_VALUE?e.isConnected()?Ei.PREVIEW_TYPE.REPLACEMENT_FADE:Ei.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(e,t,r)}};Fa("zelos",bv);var Zi={};Zi.BottomRow=dv,Zi.ConstantProvider=uv,Zi.Drawer=hv,Zi.MarkerSvg=mv,Zi.PathObject=Ev,Zi.RenderInfo=fv,Zi.Renderer=bv,Zi.RightConnectionShape=pv,Zi.StatementInput=_v,Zi.TopRow=gv;var vv=class extends sa{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=false;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=true;break}for(t=0;t<this.rows.length;t++){const a=this.rows[t];var r=a.elements;if(a.elements=[],a.startsWithElemSpacer()&&a.elements.push(new fi(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let d=0;d<r.length-1;d++){a.elements.push(r[d]);const C=this.getInRowSpacing_(r[d],r[d+1]);a.elements.push(new fi(this.constants_,C))}a.elements.push(r[r.length-1]),a.endsWithElemSpacer()&&(r=this.getInRowSpacing_(r[r.length-1],null),e&&a.hasDummyInput&&(r+=this.constants_.TAB_WIDTH),a.elements.push(new fi(this.constants_,r)))}}}getInRowSpacing_(e,t){if(!e)return t&&Y.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&Y.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&Y.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Y.isInput(e)&&!t)return Y.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:Y.isIcon(e)?2*this.constants_.LARGE_PADDING+1:Y.isHat(e)?this.constants_.NO_PADDING:Y.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:Y.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:Y.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Y.isInput(e)&&!t){if(Y.isExternalInput(e))return this.constants_.NO_PADDING;if(Y.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Y.isStatementInput(e))return this.constants_.NO_PADDING}if(!Y.isInput(e)&&t&&Y.isInput(t)){if(Y.isField(e)&&e.isEditable){if(Y.isInlineInput(t)||Y.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(Y.isInlineInput(t)||Y.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(Y.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Y.isIcon(e)&&t&&!Y.isInput(t))return this.constants_.LARGE_PADDING;if(Y.isInlineInput(e)&&t&&Y.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Y.isLeftSquareCorner(e)&&t){if(Y.isHat(t))return this.constants_.NO_PADDING;if(Y.isPreviousConnection(t)||Y.isNextConnection(t))return t.notchOffset}return Y.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:Y.isField(e)&&t&&Y.isField(t)&&e.isEditable===t.isEditable||t&&Y.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return Y.isTopRow(e)&&Y.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Y.isTopRow(e)||Y.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(Y.isSpacer(t))return e.yPos+t.height/2;if(Y.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,Y.isNextConnection(t)?e+t.height/2:e-t.height/2;if(Y.isTopRow(e))return Y.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return r=Y.isField(t)&&e.hasStatement?r+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):r+e.height/2}finalize_(){let e=0,t=0;for(var r=0;r<this.rows.length;r++){const d=this.rows[r];d.yPos=t,d.xPos=this.startX,t+=d.height,e=Math.max(e,d.widthWithConnectedBlocks);var a=t-this.topRow.ascenderHeight;d===this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(a=this.constants_.MIN_BLOCK_HEIGHT-a,this.bottomRow.height+=a,t+=a),this.recordElemPositions_(d)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},Tv=class extends Il{constructor(e){super(e)}makeRenderInfo_(e){return new vv(this,e)}};Fa("thrasos",Tv);var T_={};T_.RenderInfo=vv,T_.Renderer=Tv;var Sv=class extends yl{constructor(){super()}},$v=class extends Rl{constructor(e,t){super(e,t)}},yv=class extends sa{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}},Rv=class extends Il{constructor(e){super(e)}makeConstants_(){return new Sv}makeRenderInfo_(e){return new yv(this,e)}makeDrawer_(e,t){return new $v(e,t)}};Fa("minimalist",Rv);var Ol={};Ol.ConstantProvider=Sv,Ol.Drawer=$v,Ol.RenderInfo=yv,Ol.Renderer=Rv;var Iv=class extends yl{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=false,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},Cv=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(e){this.steps_+=Vt(e.xPos,this.info_.startY);for(let t=0,r;r=e.elements[t];t++)Y.isLeftSquareCorner(r)?this.steps_+=this.highlightConstants_.START_POINT:Y.isLeftRoundedCorner(r)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):Y.isPreviousConnection(r)?this.steps_+=this.notchPaths_.pathLeft:Y.isHat(r)?this.steps_+=this.startPaths_.path(this.RTL_):Y.isSpacer(r)&&r.width!==0&&(this.steps_+=Me("H",r.xPos+r.width-this.highlightOffset_));this.steps_+=Me("H",e.xPos+e.width-this.highlightOffset_)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+Me("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset_))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const r=e.height-t.connectionHeight;this.steps_+=Ns(t.xPos+t.width-this.highlightOffset_,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+Me("v",r)}else this.steps_+=Ns(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const r=e.height-2*this.insideCornerPaths_.height;this.steps_+=Ns(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+Me("v",r)+this.insideCornerPaths_.pathBottom(this.RTL_)+An(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Ns(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+An(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset_;e instanceof d_&&e.followsStatement&&(this.steps_+=Me("H",t)),this.RTL_&&(this.steps_+=Me("H",t),e.height>this.highlightOffset_&&(this.steps_+=Me("V",e.yPos+e.height-this.highlightOffset_)))}drawBottomRow(e){if(this.RTL_)this.steps_+=Me("V",e.baseline-this.highlightOffset_);else{const t=this.info_.bottomRow.elements[0];Y.isLeftSquareCorner(t)?this.steps_+=Ns(e.xPos+this.highlightOffset_,e.baseline-this.highlightOffset_):Y.isLeftRoundedCorner(t)&&(this.steps_+=Ns(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=Ns(this.info_.startX,e):(this.steps_+=Ns(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=Me("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,Y.isLeftRoundedCorner(e.elements[0])?this.steps_+=Me("V",this.outsideCornerPaths_.height):this.steps_+=Me("V",e.capline+this.highlightOffset_))}drawInlineInput(e){const t=this.highlightOffset_,r=e.xPos+e.connectionWidth;var a=e.centerline-e.height/2;const d=e.width-e.connectionWidth,C=a+t;this.RTL_?(a=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=Ns(r-t,C)+Me("v",a)+this.puzzleTabPaths_.pathDown(this.RTL_)+Me("v",e)+Me("h",d)):this.inlineSteps_+=Ns(e.xPos+e.width+t,C)+Me("v",e.height)+Me("h",-d)+Ns(r,a+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},Ov=class extends Rl{constructor(e,t){super(e,t),this.highlighter_=new Cv(t)}draw(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();const e=this.block_.pathObject;if(e.setPath(this.outlinePath_+`
`+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),xc()){let t,r;(t=this.block_)==null||(r=t.renderingDebugger)==null||r.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=Me("H",e.xPos+e.width)+Me("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;r=this.info_.RTL?-1*r:r+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(r,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-r:r)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},wv=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=Vt(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e+t)-t,a=Vt(r,r)+hs("a","0 0,0",e,Ge(-r-t,e-r)),d=hs("a","0 0,0",e+t,Ge(e+t,e+t)),C=Vt(r,-r)+hs("a","0 0,0",e+t,Ge(e-r,r+t));return{width:e+t,height:e,pathTop(M){return M?a:""},pathBottom(M){return M?d:C}}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e-t)+t,a=Vt(r,r)+hs("a","0 0,1",e-t,Ge(e-r,-r+t)),d=Vt(t,e)+hs("a","0 0,1",e-t,Ge(e,-e+t)),C=-r,M=Vt(r,C)+hs("a","0 0,1",e-t,Ge(-r+t,-C-e));return{height:e,topLeft(z){return z?a:d},bottomLeft(){return M}}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,r=Vt(-2,-t+3.4)+An(-.45*e,-2.1),a=Me("v",2.5)+Vt(.97*-e,2.5)+pi("q",[Ge(.05*-e,10),Ge(.3*e,9.5)])+Vt(.67*e,-1.9)+Me("v",2.5),d=Me("v",-1.5)+Vt(-.92*e,-.5)+pi("q",[Ge(-.19*e,-5.5),Ge(0,-11)])+Vt(.92*e,1),C=Vt(-5,t-.7)+An(.46*e,-2.1);return{width:e,height:t,pathUp(M){return M?r:d},pathDown(M){return M?a:C}}}makeNotch(){return{pathLeft:Me("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:An(5.1,2.6)+Vt(-10.2,6.8)+An(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=Vt(25,-8.7)+pi("c",[Ge(29.7,-6.2),Ge(57.2,-.5),Ge(75,8.7)]),r=pi("c",[Ge(17.8,-9.2),Ge(45.3,-14.9),Ge(75,-8.7)])+Ns(100.5,e+.5);return{path(a){return a?t:r}}}},kv=class extends u_{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Av=class extends Tl{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},Lv=class extends sa{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===it.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e.type===it.VALUE?(t.elements.push(new kv(this.constants_,e)),t.hasInlineInput=true):e.type===it.STATEMENT?(t.elements.push(new Av(this.constants_,e)),t.hasStatement=true):e.type===it.VALUE?(t.elements.push(new bu(this.constants_,e)),t.hasExternalInput=true):e.type===it.DUMMY&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=true),this.isInline||t.align!==null||(t.align=e.align)}addElemSpacing_(){let e=false;for(let r=0,a;a=this.rows[r];r++)a.hasExternalInput&&(e=true);for(let r=0,a;a=this.rows[r];r++){var t=a.elements;if(a.elements=[],a.startsWithElemSpacer()&&a.elements.push(new fi(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let d=0;d<t.length-1;d++){a.elements.push(t[d]);const C=this.getInRowSpacing_(t[d],t[d+1]);a.elements.push(new fi(this.constants_,C))}a.elements.push(t[t.length-1]),a.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&a.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),a.elements.push(new fi(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&Y.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&Y.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&Y.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Y.isInput(e)&&(!t||Y.isStatementInput(t)))return Y.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:Y.isIcon(e)?2*this.constants_.LARGE_PADDING+1:Y.isHat(e)?this.constants_.NO_PADDING:Y.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:Y.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:Y.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Y.isInput(e)&&!t){if(Y.isExternalInput(e))return this.constants_.NO_PADDING;if(Y.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Y.isStatementInput(e))return this.constants_.NO_PADDING}if(!Y.isInput(e)&&t&&Y.isInput(t)){if(Y.isField(e)&&e.isEditable){if(Y.isInlineInput(t)||Y.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(Y.isInlineInput(t)||Y.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(Y.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Y.isIcon(e)&&t&&!Y.isInput(t))return this.constants_.LARGE_PADDING;if(Y.isInlineInput(e)&&t&&Y.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Y.isLeftSquareCorner(e)&&t){if(Y.isHat(t))return this.constants_.NO_PADDING;if(Y.isPreviousConnection(t))return t.notchOffset;if(Y.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(Y.isLeftRoundedCorner(e)&&t){if(Y.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(Y.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return Y.isField(e)&&t&&Y.isField(t)&&e.isEditable===t.isEditable||t&&Y.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return Y.isTopRow(e)&&Y.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Y.isTopRow(e)||Y.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(Y.isSpacer(t))return e.yPos+t.height/2;if(Y.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,Y.isNextConnection(t)?e+t.height/2:e-t.height/2;if(Y.isTopRow(e))return Y.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return Y.isField(t)||Y.isIcon(t)?(r+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(r+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):r=Y.isInlineInput(t)?r+t.height/2:r+e.height/2,r}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,r=null;for(let a=this.rows.length-1,d;d=this.rows[a];a--)t.set(d,e),Y.isInputRow(d)&&(d.hasStatement&&this.alignStatementRow_(d),r&&r.hasStatement&&d.width<r.width?t.set(d,r.width):e=d.width,r=d);e=0;for(let a=0,d;d=this.rows[a];a++)d.hasStatement?e=this.getDesiredRowWidth_(d):Y.isSpacer(d)?d.width=Math.max(e,t.get(d)):(r=d.width,e=Math.max(e,t.get(d))-r,0<e&&this.addAlignmentPadding_(d,e),e=d.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let a=0,d;d=this.rows[a];a++){d.yPos=t,d.xPos=this.startX,t+=d.height,e=Math.max(e,d.widthWithConnectedBlocks);var r=t-this.topRow.ascenderHeight;d===this.bottomRow&&r<this.constants_.MIN_BLOCK_HEIGHT&&(r=this.constants_.MIN_BLOCK_HEIGHT-r,this.bottomRow.height+=r,t+=r),this.recordElemPositions_(d)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},Nv=class extends vu{constructor(e,t,r){super(e,t,r),this.constants=r,this.colourDark="#000000",this.svgPathDark=G(te.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=G(te.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Co("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},Mv=class extends Il{constructor(e){super(e),this.highlightConstants_=null}init(e,t){super.init(e,t),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()}refreshDom(e,t){super.refreshDom(e,t),this.getHighlightConstants().init()}makeConstants_(){return new Iv}makeRenderInfo_(e){return new Lv(this,e)}makeDrawer_(e,t){return new Ov(e,t)}makePathObject(e,t){return new Nv(e,t,this.getConstants())}makeHighlightConstants_(){return new wv(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants_)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants_}};Fa("geras",Mv);var En={};En.ConstantProvider=Iv,En.Drawer=Ov,En.HighlightConstantProvider=wv,En.Highlighter=Cv,En.InlineInput=kv,En.PathObject=Nv,En.RenderInfo=Lv,En.Renderer=Mv,En.StatementInput=Av;var Dv=class{constructor(e){this.container=e,this.previousSibling=null,this.createDom()}createDom(){this.SVG||(this.SVG=G(te.SVG,{xmlns:No,"xmlns:html":Hi,"xmlns:xlink":qs,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"}),this.container.appendChild(this.SVG))}translateSurface(e,t){e=Math.round(e),t=Math.round(t),this.SVG.style.display="block",Ee(this.SVG,"translate3d("+e+"px, "+t+"px, 0)")}getSurfaceTranslation(){return _i(this.SVG)}clearAndHide(e){if(!e)throw Error("Couldn't clear and hide the drag surface: missing new surface.");const t=this.SVG.childNodes[0],r=this.SVG.childNodes[1];if(!t||!r||!t.classList.contains("blocklyBlockCanvas")&&r.classList.contains("blocklyBubbleCanvas"))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(this.previousSibling!==null?Q(t,this.previousSibling):e.insertBefore(t,e.firstChild),Q(r,t),this.SVG.style.display="none",this.SVG.childNodes.length)throw Error("Drag surface was not cleared.");Ee(this.SVG,""),this.previousSibling=null}setContentsAndShow(e,t,r,a,d,C){if(this.SVG.childNodes.length)throw Error("Already dragging a block.");this.previousSibling=r,e.setAttribute("transform","translate(0, 0) scale("+C+")"),t.setAttribute("transform","translate(0, 0) scale("+C+")"),this.SVG.setAttribute("width",String(a)),this.SVG.setAttribute("height",String(d)),this.SVG.appendChild(e),this.SVG.appendChild(t),this.SVG.style.display="block"}},xv=class{constructor(e){this.container=e,this.scale=1,this.surfaceXY=new we(0,0),this.childSurfaceXY=new we(0,0),this.svg=G(te.SVG,{xmlns:No,"xmlns:html":Hi,"xmlns:xlink":qs,version:"1.1",class:"blocklyBlockDragSurface"},this.container),this.dragGroup=G(te.G,{},this.svg)}createDom(){o("BlockDragSurfaceSvg createDom","June 2022","June 2023")}setBlocksAndShow(e){if(this.dragGroup.childNodes.length)throw Error("Already dragging a block.");this.dragGroup.appendChild(e),this.svg.style.display="block",this.surfaceXY=new we(0,0)}translateAndScaleGroup(e,t,r){this.scale=r,e=Math.round(e),t=Math.round(t),this.childSurfaceXY.x=e,this.childSurfaceXY.y=t,this.dragGroup.setAttribute("transform","translate("+e+","+t+") scale("+r+")")}translateSurfaceInternal_(){const e=Math.round(this.surfaceXY.x),t=Math.round(this.surfaceXY.y);this.svg.style.display="block",Ee(this.svg,"translate3d("+e+"px, "+t+"px, 0)")}translateBy(e,t){this.surfaceXY=new we(this.surfaceXY.x+e,this.surfaceXY.y+t),this.translateSurfaceInternal_()}translateSurface(e,t){this.surfaceXY=new we(e*this.scale,t*this.scale),this.translateSurfaceInternal_()}getSurfaceTranslation(){const e=_i(this.svg);return new we(e.x/this.scale,e.y/this.scale)}getGroup(){return this.dragGroup}getSvgRoot(){return this.svg}getCurrentBlock(){return this.dragGroup.firstChild}getWsTranslation(){return this.childSurfaceXY.clone()}clearAndHide(e){const t=this.getCurrentBlock();if(t&&(e?e.appendChild(t):this.dragGroup.removeChild(t)),this.svg.style.display="none",this.dragGroup.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY=new we(0,0)}},Tu={};Tu.bumpIntoBounds=Bc,Tu.bumpIntoBoundsHandler=OE,Tu.bumpTopObjectsIntoBounds=td;var S_=class{constructor(e,t,r,a,d){this.workspace=e,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,t=t===void 0?true:t,r=r===void 0?true:r;const C=t&&r;t&&(this.hScroll=new jt(e,true,C,a,d)),r&&(this.vScroll=new jt(e,false,C,a,d)),C&&(this.corner_=G(te.RECT,{height:jt.scrollbarThickness,width:jt.scrollbarThickness,class:"blocklyScrollbarBackground"}),Q(this.corner_,e.getBubbleCanvas()))}dispose(){W(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=false,r=false;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===e.viewWidth&&this.oldHostMetrics_.viewHeight===e.viewHeight&&this.oldHostMetrics_.absoluteTop===e.absoluteTop&&this.oldHostMetrics_.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===e.scrollWidth&&this.oldHostMetrics_.viewLeft===e.viewLeft&&this.oldHostMetrics_.scrollLeft===e.scrollLeft||(t=true),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===e.scrollHeight&&this.oldHostMetrics_.viewTop===e.viewTop&&this.oldHostMetrics_.scrollTop===e.scrollTop||(r=true)):r=t=true,t||r){try{Yt(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&r&&this.vScroll.resize(e)}finally{qt()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==e.viewWidth||this.oldHostMetrics_.absoluteLeft!==e.absoluteLeft){let a;(a=this.corner_)==null||a.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==e.viewHeight||this.oldHostMetrics_.absoluteTop!==e.absoluteTop){let a;(a=this.corner_)==null||a.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,r){this.hScroll&&this.hScroll.set(e,false),this.vScroll&&this.vScroll.set(t,false),(r||r===void 0)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,true)}setY(e){this.vScroll&&this.vScroll.set(e,true)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=false;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},Bv=false;i.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=L());var t=[];this.init(e),e=e.getTopBlocks(true);for(let r=0,a;a=e[r];r++){let d=this.blockToCode(a);Array.isArray(d)&&(d=d[0]),d&&(a.outputConnection&&(d=this.scrubNakedValue(d),this.STATEMENT_PREFIX&&!a.suppressPrefixSuffix&&(d=this.injectId(this.STATEMENT_PREFIX,a)+d),this.STATEMENT_SUFFIX&&!a.suppressPrefixSuffix&&(d+=this.injectId(this.STATEMENT_SUFFIX,a))),t.push(d))}return t=t.join(`
`),t=this.finish(t),t=t.replace(/^\s+\n/,""),t=t.replace(/\n\s+$/,`
`),t=t.replace(/[ \t]+\n/g,`
`)}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,`
`+t)}allNestedComments(e){const t=[];e=e.getDescendants(true);for(let r=0;r<e.length;r++){const a=e[r].getCommentText();a&&t.push(a)}return t.length&&t.push(""),t.join(`
`)}blockToCode(e,t){if(this.isInitialized===false&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(false)[0]);var r=this[e.type];if(typeof r!="function")throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+e.type+'".');if(r=r.call(e,e),Array.isArray(r)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,r[0],t),r[1]]}if(typeof r=="string")return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(r=this.injectId(this.STATEMENT_PREFIX,e)+r),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(r+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,r,t);if(r===null)return"";throw SyntaxError("Invalid code generated: "+r)}valueToCode(e,t,r){if(isNaN(r))throw TypeError("Expecting valid order from block: "+e.type);var a=e.getInputTargetBlock(t);if(!a||(t=this.blockToCode(a),t===""))return"";if(!Array.isArray(t))throw TypeError("Expecting tuple from value block: "+a.type);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+a.type);if(!e)return"";a=false;var d=Math.floor(r);const C=Math.floor(t);if(d<=C&&(d!==C||d!==0&&d!==99)){for(a=true,d=0;d<this.ORDER_OVERRIDES.length;d++)if(this.ORDER_OVERRIDES[d][0]===r&&this.ORDER_OVERRIDES[d][1]===t){a=false;break}}return a&&(e="("+e+")"),e}statementToCode(e,t){if(e=e.getInputTargetBlock(t),t=this.blockToCode(e),typeof t!="string")throw TypeError("Expecting code from statement block: "+(e&&e.type));return t&&(t=this.prefixLines(t,this.INDENT)),t}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const r=this.nameDB_.getDistinctName(e,i.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[e]=r,Array.isArray(t)&&(t=t.join(`
`)),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,r);let a;for(;a!==t;)a=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,r){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},Object.defineProperties(i.CodeGenerator$$module$build$src$core$generator.prototype,{variableDB_:{get(){return o("variableDB_","version 9","version 10","nameDB_"),this.nameDB_},set(e){o("variableDB_","version 9","version 10","nameDB_"),this.nameDB_=e}}}),i.CodeGenerator$$module$build$src$core$generator;var ia=class{constructor(e,t,r,a){this.workspace=e,this.targetWorkspace=t,this.isLabel_=a,this.onMouseUpWrapper_=null,this.height=this.width=0,this.svgText_=this.svgGroup_=null,this.text_=r.text,this.position_=new we(0,0),this.callbackKey_=r.callbackKey||r.callbackkey,this.cssClass_=r["web-class"]||null,this.info=r}createDom(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass_&&(e+=" "+this.cssClass_),this.svgGroup_=G(te.G,{class:e},this.workspace.getCanvas());let t;this.isLabel_||(t=G(te.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_)),e=G(te.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);const r=G(te.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);var a=Jt(this.text_);this.workspace.RTL&&(a+="\u200F"),r.textContent=a,this.isLabel_&&(this.svgText_=r,this.workspace.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));const d=Es(r,"fontSize"),C=Es(r,"fontWeight"),M=Es(r,"fontFamily");if(this.width=Rt(r,d,C,M),a=ct(a,d,C,M),this.height=a.height,!this.isLabel_){this.width+=2*ia.TEXT_MARGIN_X,this.height+=2*ia.TEXT_MARGIN_Y;let z;(z=t)==null||z.setAttribute("width",this.width.toString());let he;(he=t)==null||he.setAttribute("height",this.height.toString())}return e.setAttribute("width",this.width.toString()),e.setAttribute("height",this.height.toString()),r.setAttribute("x",(this.width/2).toString()),r.setAttribute("y",(this.height/2-a.height/2+a.baseline).toString()),this.updateTransform_(),this.onMouseUpWrapper_=T(this.svgGroup_,"pointerup",this,this.onMouseUp_),this.svgGroup_}show(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")}updateTransform_(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")}moveTo(e,t){this.position_.x=e,this.position_.y=t,this.updateTransform_()}isLabel(){return this.isLabel_}getPosition(){return this.position_}getButtonText(){return this.text_}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper_&&g(this.onMouseUpWrapper_),this.svgGroup_&&W(this.svgGroup_),this.svgText_&&this.workspace.getThemeManager().unsubscribe(this.svgText_)}onMouseUp_(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace.getButtonCallback(this.callbackKey_)?this.isLabel_||(e=this.targetWorkspace.getButtonCallback(this.callbackKey_))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)}};ia.TEXT_MARGIN_X=5,ia.TEXT_MARGIN_Y=2,us(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var $_=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,r=0;return e&&(t=e.getWidth(),r=e.getHeight()),new Ts(t,r)}getFlyoutMetrics(e){return e=this.getDimensionsPx_(this.workspace_.getFlyout(e)),{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0;const t=this.getToolboxMetrics(),r=this.getFlyoutMetrics(true),a=!!this.workspace_.getToolbox(),d=!!this.workspace_.getFlyout(true);var C=a?t.position:r.position,M=C===Je.LEFT;return C=C===Je.TOP,a&&M?e=t.width:d&&M&&(e=r.width),M=0,a&&C?M=t.height:d&&C&&(M=r.height),{top:M,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),r=this.getToolboxMetrics(),a=this.getFlyoutMetrics(true),d=this.workspace_.getToolbox()?r.position:a.position;return this.workspace_.getToolbox()?d===Je.TOP||d===Je.BOTTOM?t.height-=r.height:(d===Je.LEFT||d===Je.RIGHT)&&(t.width-=r.width):this.workspace_.getFlyout(true)&&(d===Je.TOP||d===Je.BOTTOM?t.height-=a.height:(d===Je.LEFT||d===Je.RIGHT)&&(t.width-=a.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),r=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(false);const a={};return r||(a.top=e.top,a.bottom=e.top+e.height),t||(a.left=e.left,a.right=e.left+e.width),a}getPaddedContent_(e,t){const r=t.top+t.height,a=t.left+t.width,d=e.width;e=e.height;const C=d/2,M=e/2;return{top:Math.min(t.top-M,r-e),bottom:Math.max(r+M,t.top+e),left:Math.min(t.left-C,a-d),right:Math.max(a+C,t.left+d)}}getScrollMetrics(e,t,r){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(false);var a=r||this.getContentMetrics();r=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,a),a=r.top!==void 0?r.top:t.top;const d=r.left!==void 0?r.left:t.left;return{top:a/e,left:d/e,width:((r.right!==void 0?r.right:t.right)-d)/e,height:((r.bottom!==void 0?r.bottom:t.bottom)-a)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(true),r=this.getSvgMetrics(),a=this.getAbsoluteMetrics(),d=this.getViewMetrics(),C=this.getContentMetrics(),M=this.getScrollMetrics(false,d,C);return{contentHeight:C.height,contentWidth:C.width,contentTop:C.top,contentLeft:C.left,scrollHeight:M.height,scrollWidth:M.width,scrollTop:M.top,scrollLeft:M.left,viewHeight:d.height,viewWidth:d.width,viewTop:d.top,viewLeft:d.left,absoluteTop:a.top,absoluteLeft:a.left,svgHeight:r.height,svgWidth:r.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};Ie(Te.METRICS_MANAGER,Dn,$_);var Pv=class extends $_{constructor(e,t){super(e),this.flyout_=t}getBoundingBox_(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch{e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox_();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,r){return t=r||this.getContentMetrics(),r=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*r)/e,width:(t.width+t.left+r)/e,top:0,left:0}}},na;(function(e){e.BLOCK="block",e.BUTTON="button"})(na||(na={}));var Su=class extends gu{constructor(e){super(),this.horizontalLayout=false,this.eventWrappers_=[],this.filterWrapper_=this.reflowWrapper_=null,this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.recycledBlocks_=[],this.autoClose=true,this.isVisible_=false,this.containerVisible_=true,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Ji(e),this.workspace_.setMetricsManager(new Pv(this.workspace_,this)),this.workspace_.internalIsFlyout=true,this.workspace_.setVisible(this.isVisible_),this.id=ui(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=G(e,{class:"blocklyFlyout",style:"display: none"}),this.svgBackground_=G(te.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new S_(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,T(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,T(this.svgBackground_,"pointerdown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:1,capabilities:[Ss.Capability.DELETE_AREA,Ss.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),g(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&(W(this.svgGroup_),this.svgGroup_=null),this.svgBackground_=null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}isVisible(){return this.isVisible_}setVisible(e){const t=e!==this.isVisible();this.isVisible_=e,t&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())}setContainerVisible(e){const t=e!==this.containerVisible_;this.containerVisible_=e,t&&this.updateDisplay_()}updateDisplay_(){let e;e=this.containerVisible_?this.isVisible():false,this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none");let t;(t=this.workspace_.scrollbar)==null||t.setContainerVisible(e)}positionAt_(e,t,r,a){let d;(d=this.svgGroup_)==null||d.setAttribute("width",e.toString());let C;(C=this.svgGroup_)==null||C.setAttribute("height",t.toString()),this.workspace_.setCachedParentSvgSize(e,t);let M;if(((M=this.svgGroup_)==null?void 0:M.tagName)==="svg")Ee(this.svgGroup_,"translate("+r+"px,"+a+"px)");else{let z;(z=this.svgGroup_)==null||z.setAttribute("transform","translate("+r+","+a+")")}(e=this.workspace_.scrollbar)&&(e.setOrigin(r,a),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(false);for(let e=0,t;t=this.listeners_[e];e++)g(t);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}}show(e){this.workspace_.setResizesEnabled(false),this.hide(),this.clearOldBlocks_(),typeof e=="string"&&(e=this.getDynamicCategoryContents_(e)),this.setVisible(true),e=wc(e),e=this.createFlyoutInfo_(e),this.layout_(e.contents,e.gaps),this.listeners_.push(T(this.svgBackground_,"pointerover",this,function(){const t=this.workspace_.getTopBlocks(false);for(let r=0,a;a=t[r];r++)a.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(true),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_),this.emptyRecycledBlocks_()}createFlyoutInfo_(e){const t=[],r=[];this.permanentlyDisabled_.length=0;const a=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(let C=0,M;M=e[C];C++){if("custom"in M){var d=this.getDynamicCategoryContents_(M.custom);d=wc(d),e.splice.apply(e,[C,1,...d]),M=e[C]}switch(M.kind.toUpperCase()){case"BLOCK":d=M;const z=this.createFlyoutBlock_(d);t.push({type:na.BLOCK,block:z}),this.addBlockGap_(d,r,a);break;case"SEP":this.addSeparatorGap_(M,r,a);break;case"LABEL":d=this.createButton_(M,true),t.push({type:na.BUTTON,button:d}),r.push(a);break;case"BUTTON":d=this.createButton_(M,false),t.push({type:na.BUTTON,button:d}),r.push(a)}}return{contents:t,gaps:r}}getDynamicCategoryContents_(e){if(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e),typeof e!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}createButton_(e,t){return new ia(this.workspace_,this.targetWorkspace,e,t)}createFlyoutBlock_(e){let t;return e.blockxml?(e=typeof e.blockxml=="string"?Bs(e.blockxml):e.blockxml,(t=this.getRecycledBlock_(e.getAttribute("type")))||(t=Io(e,this.workspace_))):(t=this.getRecycledBlock_(e.type),t||(e.enabled===void 0&&(e.enabled=e.disabled!=="true"&&e.disabled!==true),t=Dr(e,this.workspace_))),t.isEnabled()||this.permanentlyDisabled_.push(t),t}getRecycledBlock_(e){let t=-1;for(let r=0;r<this.recycledBlocks_.length;r++)if(this.recycledBlocks_[r].type===e){t=r;break}return t===-1?void 0:this.recycledBlocks_.splice(t,1)[0]}addBlockGap_(e,t,r){let a;e.gap?a=parseInt(e.gap.toString()):e.blockxml&&(e=typeof e.blockxml=="string"?Bs(e.blockxml):e.blockxml,a=parseInt(e.getAttribute("gap"))),t.push(!a||isNaN(a)?r:a)}addSeparatorGap_(e,t,r){e=parseInt(e.gap.toString()),!isNaN(e)&&0<t.length?t[t.length-1]=e:t.push(r)}clearOldBlocks_(){var e=this.workspace_.getTopBlocks(false);for(let r=0,a;a=e[r];r++)this.blockIsRecyclable_(a)?this.recycleBlock_(a):a.dispose(false,false);for(e=0;e<this.mats_.length;e++){const r=this.mats_[e];r&&(Rc(r),W(r))}this.mats_.length=0;for(let r=0,a;a=this.buttons_[r];r++)a.dispose();this.buttons_.length=0;let t;(t=this.workspace_.getPotentialVariableMap())==null||t.clear()}emptyRecycledBlocks_(){for(let e=0;e<this.recycledBlocks_.length;e++)this.recycledBlocks_[e].dispose();this.recycledBlocks_=[]}blockIsRecyclable_(e){return false}recycleBlock_(e){const t=e.getRelativeToSurfaceXY();e.moveBy(-t.x,-t.y),this.recycledBlocks_.push(e)}addBlockListeners_(e,t,r){this.listeners_.push(T(e,"pointerdown",null,this.blockMouseDown_(t))),this.listeners_.push(T(r,"pointerdown",null,this.blockMouseDown_(t))),this.listeners_.push(y(e,"pointerenter",t,t.addSelect)),this.listeners_.push(y(e,"pointerleave",t,t.removeSelect)),this.listeners_.push(y(r,"pointerenter",t,t.addSelect)),this.listeners_.push(y(r,"pointerleave",t,t.removeSelect))}blockMouseDown_(e){return t=>{const r=this.targetWorkspace.getGesture(t);r&&(r.setStartBlock(e),r.handleFlyoutStart(t,this))}}onMouseDown_(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()}createBlock(e){let t=null;Yt();var r=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(false);try{t=this.placeNewBlock_(e)}finally{qt()}if(this.targetWorkspace.hideChaff(),e=fs(this.targetWorkspace,r),as()){for(He(true),r=0;r<e.length;r++){const a=e[r];Pe(new(ve(Fr))(a))}Pe(new(ve(ys))(t))}return this.autoClose?this.hide():this.filterForCapacity_(),t}initFlyoutButton_(e,t,r){const a=e.createDom();e.moveTo(t,r),e.show(),this.listeners_.push(T(a,"pointerdown",this,this.onMouseDown_)),this.buttons_.push(e)}createRect_(e,t,r,a,d){return t=G(te.RECT,{"fill-opacity":0,x:t,y:r,height:a.height,width:a.width}),t.tooltip=e,yc(t),this.workspace_.getCanvas().insertBefore(t,e.getSvgRoot()),this.rectMap_.set(e,t),this.mats_[d]=t}moveRectToBlock_(e,t){const r=t.getHeightWidth();e.setAttribute("width",r.width.toString()),e.setAttribute("height",r.height.toString()),t=t.getRelativeToSurfaceXY(),e.setAttribute("y",t.y.toString()),e.setAttribute("x",(this.RTL?t.x-r.width:t.x).toString())}filterForCapacity_(){const e=this.workspace_.getTopBlocks(false);for(let t=0,r;r=e[t];t++)if(this.permanentlyDisabled_.indexOf(r)===-1){const a=this.targetWorkspace.isCapacityAvailable(J(r));for(;r;)r.setEnabled(a),r=r.getNextBlock()}}reflow(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():false}placeNewBlock_(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered.");const r=Ln(e);return t.setResizesEnabled(false),t=Dr(r,t),this.positionNewBlock_(e,t),t}positionNewBlock_(e,t){const r=this.targetWorkspace;var a=r.getOriginOffsetInPixels(),d=this.workspace_.getOriginOffsetInPixels();e=e.getRelativeToSurfaceXY(),e.scale(this.workspace_.scale),d=we.sum(d,e),a=we.difference(d,a),a.scale(1/r.scale),t.moveTo(new we(a.x,a.y))}};Su.FlyoutItemType=na;var y_=class extends Su{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),a=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.y=="number"&&(this.workspace_.scrollY=-(r.top+(r.height-a.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Je.LEFT?e.width:r.width-this.width_:this.toolboxPosition_===Je.LEFT?0:r.width:this.toolboxPosition_===Je.LEFT?0:r.width+t.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath_(e,t){const r=this.toolboxPosition_===Je.RIGHT;var a=e+this.CORNER_RADIUS;a=["M "+(r?a:0)+",0"],a.push("h",r?-e:e),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("v",Math.max(0,t)),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("h",r?e:-e),a.push("z"),this.svgBackground_.setAttribute("d",a.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setY(0)}wheel_(e){var t=S(e);if(t.y){const r=this.workspace_.getMetricsManager(),a=r.getScrollMetrics();t=r.getViewMetrics().top-a.top+t.y;let d;(d=this.workspace_.scrollbar)==null||d.setY(t),ln(),wt()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;var r=this.MARGIN;const a=this.RTL?r:r+this.tabWidth_;for(let z=0,he;he=e[z];z++)if(he.type==="block"){var d=he.block,C=d.getDescendants(false);for(let ft=0,Wt;Wt=C[ft];ft++)Wt.isInFlyout=true;d.render(),C=d.getSvgRoot();const ke=d.getHeightWidth();var M=d.outputConnection?a-this.tabWidth_:a;d.moveBy(M,r),M=this.createRect_(d,this.RTL?M-ke.width:M,r,ke,z),this.addBlockListeners_(C,d,M),r+=ke.height+t[z]}else he.type==="button"&&(d=he.button,this.initFlyoutButton_(d,a,r),r+=d.height+t[z])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===Je.LEFT?new Zt(-1e9,1e9,-1e9,t+e.width):new Zt(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;var t=this.workspace_.getTopBlocks(false);for(let a=0,d;d=t[a];a++){var r=d.getHeightWidth().width;d.outputConnection&&(r-=this.tabWidth_),e=Math.max(e,r)}for(let a=0,d;d=this.buttons_[a];a++)e=Math.max(e,d.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=jt.scrollbarThickness,this.width_!==e){for(let a=0,d;d=t[a];a++){if(this.RTL){r=d.getRelativeToSurfaceXY().x;let C=e/this.workspace_.scale-this.MARGIN;d.outputConnection||(C-=this.tabWidth_),d.moveBy(C-r,0)}this.rectMap_.has(d)&&this.moveRectToBlock_(this.rectMap_.get(d),d)}if(this.RTL)for(let a=0,d;d=this.buttons_[a];a++)t=d.getPosition().y,d.moveTo(e/this.workspace_.scale-d.width-this.MARGIN-this.tabWidth_,t);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==Je.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.recordDragTargets()}}};y_.registryName="verticalFlyout",Ie(Te.FLYOUTS_VERTICAL_TOOLBOX,Dn,y_);var Uv=class extends Su{constructor(e){super(e),this.horizontalLayout=true}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),a=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.x=="number"&&(this.workspace_.scrollX=-(r.left+(r.width-a.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();e=e.getToolboxMetrics();const a=this.toolboxPosition_===Je.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?a?e.height:r.height-this.height_:a?0:r.height:a?0:r.height+t.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath_(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath_(e,t){const r=this.toolboxPosition_===Je.TOP,a=["M 0,"+(r?0:this.CORNER_RADIUS)];r?(a.push("h",e+2*this.CORNER_RADIUS),a.push("v",t),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("h",-e),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),a.push("h",e),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("v",t),a.push("h",-e-2*this.CORNER_RADIUS)),a.push("z"),this.svgBackground_.setAttribute("d",a.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setX(this.RTL?1/0:0)}wheel_(e){var t=S(e);if(t=t.x||t.y){const r=this.workspace_.getMetricsManager(),a=r.getScrollMetrics();t=r.getViewMetrics().left-a.left+t;let d;(d=this.workspace_.scrollbar)==null||d.setX(t),ln(),wt()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;const r=this.MARGIN;let a=r+this.tabWidth_;this.RTL&&(e=e.reverse());for(let z=0,he;he=e[z];z++)if(he.type==="block"){var d=he.block,C=d.getDescendants(false);for(let ft=0,Wt;Wt=C[ft];ft++)Wt.isInFlyout=true;d.render(),C=d.getSvgRoot();const ke=d.getHeightWidth();var M=d.outputConnection?this.tabWidth_:0;M=this.RTL?a+ke.width:a-M,d.moveBy(M,r),M=this.createRect_(d,M,r,ke,z),a+=ke.width+t[z],this.addBlockListeners_(C,d,M)}else he.type==="button"&&(d=he.button,this.initFlyoutButton_(d,a,r),a+=d.width+t[z])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===Je.TOP?new Zt(-1e9,t+e.height,-1e9,1e9):new Zt(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;const t=this.workspace_.getTopBlocks(false);for(let a=0,d;d=t[a];a++)e=Math.max(e,d.getHeightWidth().height);const r=this.buttons_;for(let a=0,d;d=r[a];a++)e=Math.max(e,d.height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=jt.scrollbarThickness,this.height_!==e){for(let a=0,d;d=t[a];a++)this.rectMap_.has(d)&&this.moveRectToBlock_(this.rectMap_.get(d),d);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==Je.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.recordDragTargets()}}};Ie(Te.FLYOUTS_HORIZONTAL_TOOLBOX,Dn,Uv);var wl=class extends Ki{constructor(e,t,r,a,d){super(dt.SKIP_SETUP),this.defaultType_="",this.variableTypes=[],this.variable_=null,this.SERIALIZABLE=true,this.menuGenerator_=wl.dropdownCreate,this.defaultVariableName=typeof e=="string"?e:"",this.size_=new Ts(0,0),e!==dt.SKIP_SETUP&&(d?this.configure_(d):this.setTypes_(r,a),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes_(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new _s;this.variable_||(e=Fe(e.workspace,null,this.defaultVariableName,this.defaultType_),this.doValueUpdate_(e.getId()))}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new _s;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||e.type!=="variables_get")}fromXml(e){var t=this.getSourceBlock();if(!t)throw new _s;const r=e.getAttribute("id"),a=e.textContent,d=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=Fe(t.workspace,r,a,d),d!==null&&d!==t.type)throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.type+", and does not match variable field that references it: "+wi(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable_.getId(),e.textContent=this.variable_.name,this.variable_.type&&e.setAttribute("variabletype",this.variable_.type),e}saveState(e){var t=this.saveLegacyState(wl);return t!==null||(this.initModel(),t={id:this.variable_.getId()},e&&(t.name=this.variable_.name,t.type=this.variable_.type)),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new _s;this.loadLegacyState(wl,e)||(e=Fe(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable_?this.variable_.getId():null}getText(){return this.variable_?this.variable_.name:""}getVariable(){return this.variable_}getValidator(){return this.variable_?this.validator_:null}doClassValidation_(e){if(e===null)return null;var t=this.getSourceBlock();if(!t)throw new _s;return t=nt(t.workspace,e),t?(t=t.type,this.typeIsAllowed_(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new _s;this.variable_=nt(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed_(e){const t=this.getVariableTypes_();if(!t)return true;for(let r=0;r<t.length;r++)if(e===t[r])return true;return false}getVariableTypes_(){var e=this.variableTypes;if(e===null&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(e=e||[""],e.length===0)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e}setTypes_(e,t){if(t=t||"",e==null)e=null;else if(Array.isArray(e)){let r=false;for(let a=0;a<e.length;a++)e[a]===t&&(r=true);if(!r)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType_=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===Xd){Ar(this.sourceBlock_.workspace,this.variable_);return}if(e===Kd){this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId());return}}this.setValue(e)}referencesVariables(){return true}static fromJson(e){return new this(Jt(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var r=this.getVariableTypes_(),a=0;a<r.length;a++){const d=this.sourceBlock_.workspace.getVariablesOfType(r[a]);t=t.concat(d)}for(t.sort(Za.compareByName),r=[],a=0;a<t.length;a++)r[a]=[t[a].name,t[a].getId()];return r.push([je.RENAME_VARIABLE,Xd]),je.DELETE_VARIABLE&&r.push([je.DELETE_VARIABLE.replace("%1",e),Kd]),r}};ki("field_variable",wl);var R_=class extends Cl{constructor(e,t,r,a,d,C){super(dt.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,this.SERIALIZABLE=true,this.spellcheck_=false,e!==dt.SKIP_SETUP&&(C?this.configure_(C):this.setConstraints(t,r,a),this.setValue(e),d&&this.setValidator(d))}configure_(e){super.configure_(e),this.setMinInternal_(e.min),this.setMaxInternal_(e.max),this.setPrecisionInternal_(e.precision)}setConstraints(e,t,r){this.setMinInternal_(e),this.setMaxInternal_(t),this.setPrecisionInternal_(r),this.setValue(this.getValue())}setMin(e){this.setMinInternal_(e),this.setValue(this.getValue())}setMinInternal_(e){e==null?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal_(e),this.setValue(this.getValue())}setMaxInternal_(e){e==null?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal_(e),this.setValue(this.getValue())}setPrecisionInternal_(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.indexOf("e")!==-1&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const r=t.indexOf(".");this.decimalPlaces_=r===-1?e?0:null:t.length-r-1}getPrecision(){return this.precision_}doClassValidation_(e){return e===null||(e=String(e),e=e.replace(/O/ig,"0"),e=e.replace(/,/g,""),e=e.replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),this.decimalPlaces_!==null&&(e=Number(e.toFixed(this.decimalPlaces_))),e)}widgetCreate_(){const e=super.widgetCreate_();return-1/0<this.min_&&zt(e,Ft.VALUEMIN,this.min_),1/0>this.max_&&zt(e,Ft.VALUEMAX,this.max_),e}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};ki("field_number",R_),R_.prototype.DEFAULT_VALUE=0;var I_=class extends i.FieldTextInput$$module$build$src$core$field_textinput{constructor(e,t,r){super(dt.SKIP_SETUP),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=false,e!==dt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.maxLines&&this.setMaxLines(e.maxLines)}toXml(e){return e.textContent=this.getValue().replace(/\n/g,"&#10;"),e}fromXml(e){this.setValue(e.textContent.replace(/&#10;/g,`
`))}saveState(){const e=this.saveLegacyState(I_);return e!==null?e:this.getValue()}loadState(e){this.loadLegacyState(dt,e)||this.setValue(e)}initView(){this.createBorderRect_(),this.textGroup_=G(te.G,{class:"blocklyEditableText"},this.fieldGroup_)}getDisplayText_(){const e=this.getSourceBlock();if(!e)throw new _s;let t=this.getText();if(!t)return dt.NBSP;const r=t.split(`
`);t="";const a=this.isOverflowedY_?this.maxLines_:r.length;for(let d=0;d<a;d++){let C=r[d];C.length>this.maxDisplayLength?C=C.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&d===a-1&&(C=C.substring(0,C.length-3)+"..."),C=C.replace(/\s/g,dt.NBSP),t+=C,d!==a-1&&(t+=`
`)}return e.RTL&&(t+="\u200F"),t}doValueUpdate_(e){super.doValueUpdate_(e),this.isOverflowedY_=this.value_.split(`
`).length>this.maxLines_}render_(){var e=this.getSourceBlock();if(!e)throw new _s;for(var t;t=this.textGroup_.firstChild;)this.textGroup_.removeChild(t);t=this.getDisplayText_().split(`
`);let r=0;for(let a=0;a<t.length;a++){const d=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;G(te.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:r+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(t[a])),r+=d}this.isBeingEdited_&&(t=this.htmlInput_,this.isOverflowedY_?ae(t,"blocklyHtmlTextAreaInputOverflowedY"):fe(t,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(e.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),e=this.htmlInput_,this.isTextValid_?(fe(e,"blocklyInvalidInput"),zt(e,Ft.INVALID,false)):(ae(e,"blocklyInvalidInput"),zt(e,Ft.INVALID,true)))}updateSize_(){var e=this.textGroup_.childNodes;const t=this.getConstants().FIELD_TEXT_FONTSIZE,r=this.getConstants().FIELD_TEXT_FONTWEIGHT,a=this.getConstants().FIELD_TEXT_FONTFAMILY;let d=0,C=0;for(var M=0;M<e.length;M++){var z=Ct(e[M],t,r,a);z>d&&(d=z),C+=this.getConstants().FIELD_TEXT_HEIGHT+(0<M?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){for(e=this.value_.split(`
`),M=G(te.TEXT,{class:"blocklyText blocklyMultilineText"}),z=0;z<e.length;z++){e[z].length>this.maxDisplayLength&&(e[z]=e[z].substring(0,this.maxDisplayLength)),M.textContent=e[z];const he=Ct(M,t,r,a);he>d&&(d=he)}d+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(C+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,d+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",d),this.borderRect_.setAttribute("height",C)),this.size_.width=d,this.size_.height=C,this.positionBorderRect_()}showEditor_(e,t){super.showEditor_(e,t),this.forceRerender()}widgetCreate_(){const e=wo(),t=this.workspace_.getScale(),r=document.createElement("textarea");r.className="blocklyHtmlInput blocklyHtmlTextAreaInput",r.setAttribute("spellcheck",this.spellcheck_);var a=this.getConstants().FIELD_TEXT_FONTSIZE*t+"pt";e.style.fontSize=a,r.style.fontSize=a,r.style.borderRadius=i.FieldTextInput$$module$build$src$core$field_textinput.BORDERRADIUS*t+"px",a=this.getConstants().FIELD_BORDER_RECT_X_PADDING*t;const d=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*t/2;return r.style.padding=d+"px "+a+"px "+d+"px "+a+"px",a=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,r.style.lineHeight=a*t+"px",e.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",this.value_),r.setAttribute("data-old-value",""),rd?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(r),r}setMaxLines(e){typeof e=="number"&&0<e&&e!==this.maxLines_&&(this.maxLines_=e,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(e){e.keyCode!==xe.ENTER&&super.onHtmlInputKeyDown_(e)}static fromJson(e){return new this(Jt(e.text),void 0,e)}};us(`
.blocklyHtmlTextAreaInput {
  font-family: monospace;
  resize: none;
  overflow: hidden;
  height: 100%;
  text-align: left;
}

.blocklyHtmlTextAreaInputOverflowedY {
  overflow-y: scroll;
}
`),ki("field_multilinetext",I_);var Fv=class extends i.FieldLabel$$module$build$src$core$field_label{constructor(e,t,r){super(String(e??""),t,r),this.EDITABLE=false,this.SERIALIZABLE=true}static fromJson(e){return new this(Jt(e.text),void 0,e)}};ki("field_label_serializable",Fv);var bi=class extends dt{constructor(e,t,r){super(dt.SKIP_SETUP),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null,this.SERIALIZABLE=true,this.CURSOR="default",this.isDirty_=false,this.titles_=this.colours_=null,this.columns_=0,e!==dt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.colourOptions&&(this.colours_=e.colourOptions),e.colourTitles&&(this.titles_=e.colourTitles),e.columns&&(this.columns_=e.columns)}initView(){this.size_=new Ts(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof Li&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()):(this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1")}applyColour(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof Li&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())}doClassValidation_(e){return typeof e!="string"?null:Mr(e)}doValueUpdate_(e){this.value_=e,this.borderRect_?this.borderRect_.style.fill=e:this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_ instanceof Li&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",e),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))}getText(){let e=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(e)&&(e="#"+e[1]+e[3]+e[5]),e}setColours(e,t){return this.colours_=e,t&&(this.titles_=t),this}setColumns(e){return this.columns_=e,this}showEditor_(){this.dropdownCreate_(),Ot().appendChild(this.picker_),q(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:true})}onClick_(e){e=(e=e.target)&&e.getAttribute("data-colour"),e!==null&&(this.setValue(e),qe(this))}onKeyDown_(e){var t=false;e.keyCode===xe.UP?(this.moveHighlightBy_(0,-1),t=true):e.keyCode===xe.DOWN?(this.moveHighlightBy_(0,1),t=true):e.keyCode===xe.LEFT?(this.moveHighlightBy_(-1,0),t=true):e.keyCode===xe.RIGHT?(this.moveHighlightBy_(1,0),t=true):e.keyCode===xe.ENTER&&((t=this.getHighlighted_())&&(t=t&&t.getAttribute("data-colour"),t!==null&&this.setValue(t)),wt(),t=true),t&&e.stopPropagation()}moveHighlightBy_(e,t){if(this.highlightedIndex_){var r=this.colours_||bi.COLOURS,a=this.columns_||bi.COLUMNS,d=this.highlightedIndex_%a,C=Math.floor(this.highlightedIndex_/a);d+=e,C+=t,0>e?0>d&&0<C?(d=a-1,C--):0>d&&(d=0):0<e?d>a-1&&C<Math.floor(r.length/a)-1?(d=0,C++):d>a-1&&d--:0>t?0>C&&(C=0):0<t&&C>Math.floor(r.length/a)-1&&(C=Math.floor(r.length/a)-1),this.setHighlightedCell_(this.picker_.childNodes[C].childNodes[d],C*a+d)}}onMouseMove_(e){const t=(e=e.target)&&Number(e.getAttribute("data-index"));t!==null&&t!==this.highlightedIndex_&&this.setHighlightedCell_(e,t)}onMouseEnter_(){this.picker_.focus({preventScroll:true})}onMouseLeave_(){this.picker_.blur();const e=this.getHighlighted_();e&&fe(e,"blocklyColourHighlighted")}getHighlighted_(){if(!this.highlightedIndex_)return null;const e=this.columns_||bi.COLUMNS,t=this.picker_.childNodes[Math.floor(this.highlightedIndex_/e)];return t?t.childNodes[this.highlightedIndex_%e]:null}setHighlightedCell_(e,t){const r=this.getHighlighted_();r&&fe(r,"blocklyColourHighlighted"),ae(e,"blocklyColourHighlighted"),this.highlightedIndex_=t,zt(this.picker_,Ft.ACTIVEDESCENDANT,e.getAttribute("id"))}dropdownCreate_(){const e=this.columns_||bi.COLUMNS,t=this.colours_||bi.COLOURS,r=this.titles_||bi.TITLES,a=this.getValue(),d=document.createElement("table");d.className="blocklyColourTable",d.tabIndex=0,d.dir="ltr",cn(d,Zs.GRID),zt(d,Ft.EXPANDED,true),zt(d,Ft.ROWCOUNT,Math.floor(t.length/e)),zt(d,Ft.COLCOUNT,e);let C;for(let M=0;M<t.length;M++){M%e===0&&(C=document.createElement("tr"),cn(C,Zs.ROW),d.appendChild(C));const z=document.createElement("td");C.appendChild(z),z.setAttribute("data-colour",t[M]),z.title=r[M]||t[M],z.id=wr(),z.setAttribute("data-index",M),cn(z,Zs.GRIDCELL),zt(z,Ft.LABEL,t[M]),zt(z,Ft.SELECTED,t[M]===a),z.style.backgroundColor=t[M],t[M]===a&&(z.className="blocklyColourSelected",this.highlightedIndex_=M)}this.onClickWrapper_=T(d,"pointerdown",this,this.onClick_,true),this.onMouseMoveWrapper_=T(d,"pointermove",this,this.onMouseMove_,true),this.onMouseEnterWrapper_=T(d,"pointerenter",this,this.onMouseEnter_,true),this.onMouseLeaveWrapper_=T(d,"pointerleave",this,this.onMouseLeave_,true),this.onKeyDownWrapper_=T(d,"keydown",this,this.onKeyDown_),this.picker_=d}dropdownDispose_(){this.onClickWrapper_&&(g(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(g(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(g(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(g(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(g(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null}static fromJson(e){return new this(e.colour,void 0,e)}};bi.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),bi.TITLES=[],bi.COLUMNS=7,bi.prototype.DEFAULT_VALUE=bi.COLOURS[0],us(`
.blocklyColourTable {
  border-collapse: collapse;
  display: block;
  outline: none;
  padding: 1px;
}

.blocklyColourTable>tr>td {
  border: .5px solid #888;
  box-sizing: border-box;
  cursor: pointer;
  display: inline-block;
  height: 20px;
  padding: 0;
  width: 20px;
}

.blocklyColourTable>tr>td.blocklyColourHighlighted {
  border-color: #eee;
  box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);
  position: relative;
}

.blocklyColourSelected, .blocklyColourSelected:hover {
  border-color: #eee !important;
  outline: 1px solid #333;
  position: relative;
}
`),ki("field_colour",bi),i.FieldCheckbox$$module$build$src$core$field_checkbox=class extends dt{constructor(e,t,r){super(dt.SKIP_SETUP),this.SERIALIZABLE=true,this.CURSOR="default",this.checkChar_=i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR,e!==dt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar_=e.checkCharacter)}saveState(){const e=this.saveLegacyState(i.FieldCheckbox$$module$build$src$core$field_checkbox);return e!==null?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();ae(e,"blocklyCheckbox"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar_}setCheckCharacter(e){this.checkChar_=e||i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return e===true||e==="TRUE"?"TRUE":e===false||e==="FALSE"?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool_(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(e){return typeof e=="string"?e==="TRUE":!!e}static fromJson(e){return new this(e.checked,void 0,e)}},i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR="\u2713",ki("field_checkbox",i.FieldCheckbox$$module$build$src$core$field_checkbox),i.FieldCheckbox$$module$build$src$core$field_checkbox.prototype.DEFAULT_VALUE=false,i.FieldCheckbox$$module$build$src$core$field_checkbox;var lt=class extends Cl{constructor(e,t,r){super(dt.SKIP_SETUP),this.clockwise_=lt.CLOCKWISE,this.offset_=lt.OFFSET,this.wrap_=lt.WRAP,this.round_=lt.ROUND,this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.symbol_=this.line_=this.gauge_=this.editor_=null,this.SERIALIZABLE=true,e!==dt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){switch(super.configure_(e),e.mode){case $u.COMPASS:this.clockwise_=true,this.offset_=90;break;case $u.PROTRACTOR:this.clockwise_=false,this.offset_=0}e.clockwise&&(this.clockwise_=e.clockwise),e.offset&&(this.offset_=e.offset),e.wrap&&(this.wrap_=e.wrap),e.round&&(this.round_=e.round)}initView(){super.initView(),this.symbol_=G(te.TSPAN,{}),this.symbol_.appendChild(document.createTextNode("\xB0")),this.getTextElement().appendChild(this.symbol_)}render_(){super.render_(),this.updateGraph_()}showEditor_(e){super.showEditor_(e,ad||Vc||Ao),this.dropdownCreate_(),Ot().appendChild(this.editor_),this.sourceBlock_ instanceof Li&&N(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),q(this,this.dropdownDispose_.bind(this)),this.updateGraph_()}dropdownCreate_(){const e=G(te.SVG,{xmlns:No,"xmlns:html":Hi,"xmlns:xlink":qs,version:"1.1",height:2*lt.HALF+"px",width:2*lt.HALF+"px",style:"touch-action: none"}),t=G(te.CIRCLE,{cx:lt.HALF,cy:lt.HALF,r:lt.RADIUS,class:"blocklyAngleCircle"},e);this.gauge_=G(te.PATH,{class:"blocklyAngleGauge"},e),this.line_=G(te.LINE,{x1:lt.HALF,y1:lt.HALF,class:"blocklyAngleLine"},e);for(let r=0;360>r;r+=15)G(te.LINE,{x1:lt.HALF+lt.RADIUS,y1:lt.HALF,x2:lt.HALF+lt.RADIUS-(r%45===0?10:5),y2:lt.HALF,class:"blocklyAngleMarks",transform:"rotate("+r+","+lt.HALF+","+lt.HALF+")"},e);this.clickWrapper_=T(e,"click",this,this.hide_),this.clickSurfaceWrapper_=T(t,"pointerdown",this,this.onMouseMove_,true),this.moveSurfaceWrapper_=T(t,"pointermove",this,this.onMouseMove_,true),this.editor_=e}dropdownDispose_(){this.clickWrapper_&&(g(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(g(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(g(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null}hide_(){qe(this),ln()}onMouseMove_(e){var t=this.gauge_.ownerSVGElement.getBoundingClientRect();const r=e.clientX-t.left-lt.HALF;e=e.clientY-t.top-lt.HALF,t=Math.atan(-e/r),isNaN(t)||(t=Ui(t),0>r?t+=180:0<e&&(t+=360),t=this.clockwise_?this.offset_+360-t:360-(this.offset_-t),this.displayMouseOrKeyboardValue_(t))}displayMouseOrKeyboardValue_(e){this.round_&&(e=Math.round(e/this.round_)*this.round_),e=this.wrapValue_(e),e!==this.value_&&this.setEditorValue_(e)}updateGraph_(){if(this.gauge_){var e=Number(this.getText())+this.offset_,t=Ut(e%360);e=["M ",lt.HALF,",",lt.HALF];var r=lt.HALF,a=lt.HALF;if(!isNaN(t)){const d=Number(this.clockwise_),C=Ut(this.offset_),M=Math.cos(C)*lt.RADIUS,z=Math.sin(C)*-lt.RADIUS;d&&(t=2*C-t),r+=Math.cos(t)*lt.RADIUS,a-=Math.sin(t)*lt.RADIUS,t=Math.abs(Math.floor((t-C)/Math.PI)%2),d&&(t=1-t),e.push(" l ",M,",",z," A ",lt.RADIUS,",",lt.RADIUS," 0 ",t," ",d," ",r,",",a," z")}this.gauge_.setAttribute("d",e.join("")),this.line_.setAttribute("x2",r),this.line_.setAttribute("y2",a)}}onHtmlInputKeyDown_(e){super.onHtmlInputKeyDown_(e);var t=this.getSourceBlock();if(!t)throw new _s;let r;e.keyCode===xe.LEFT?r=t.RTL?1:-1:e.keyCode===xe.RIGHT?r=t.RTL?-1:1:e.keyCode===xe.DOWN?r=-1:e.keyCode===xe.UP&&(r=1),r&&(t=this.getValue(),this.displayMouseOrKeyboardValue_(t+r*this.round_),e.preventDefault(),e.stopPropagation())}doClassValidation_(e){return e=Number(e),isNaN(e)||!isFinite(e)?null:this.wrapValue_(e)}wrapValue_(e){return e%=360,0>e&&(e+=360),e>this.wrap_&&(e-=360),e}static fromJson(e){return new this(e.angle,void 0,e)}};lt.ROUND=15,lt.HALF=50,lt.CLOCKWISE=false,lt.OFFSET=0,lt.WRAP=360,lt.RADIUS=lt.HALF-1,us(`
.blocklyAngleCircle {
  stroke: #444;
  stroke-width: 1;
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyAngleMarks {
  stroke: #444;
  stroke-width: 1;
}

.blocklyAngleGauge {
  fill: #f88;
  fill-opacity: .8;
  pointer-events: none;
}

.blocklyAngleLine {
  stroke: #f00;
  stroke-width: 2;
  stroke-linecap: round;
  pointer-events: none;
}
`),ki("field_angle",lt),lt.prototype.DEFAULT_VALUE=0;var $u;(function(e){e.COMPASS="compass",e.PROTRACTOR="protractor"})($u||($u={}));var C_=class extends Ho{constructor(e){super(e),this.type=Ps,e&&(e.isShadow()&&(this.recordUndo=false),e=this.currentLocation_(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.recordUndo||(e.recordUndo=this.recordUndo),e}fromJson(e){if(o("Blockly.Events.BlockMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldParentId=e.oldParentId,this.oldInputName=e.oldInputName,e.oldCoordinate){var t=e.oldCoordinate.split(",");this.oldCoordinate=new we(Number(t[0]),Number(t[1]))}this.newParentId=e.newParentId,this.newInputName=e.newInputName,e.newCoordinate&&(t=e.newCoordinate.split(","),this.newCoordinate=new we(Number(t[0]),Number(t[1]))),e.recordUndo!==void 0&&(this.recordUndo=e.recordUndo)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new C_),t.oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(r=e.oldCoordinate.split(","),t.oldCoordinate=new we(Number(r[0]),Number(r[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(r=e.newCoordinate.split(","),t.newCoordinate=new we(Number(r[0]),Number(r[1]))),e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation_();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}currentLocation_(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const r=t.getParent();return r?(e.parentId=r.id,(t=r.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&we.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var r=t.getBlockById(this.blockId);if(r){var a=e?this.newParentId:this.oldParentId,d=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,a){var C=t.getBlockById(a);if(!C){console.warn("Can't connect to non-existent block: "+a);return}}if(r.getParent()&&r.unplug(),e)d=r.getRelativeToSurfaceXY(),r.moveBy(e.x-d.x,e.y-d.y);else{t=r.outputConnection,(!t||r.previousConnection&&r.previousConnection.isConnected())&&(t=r.previousConnection);let M;r=t.type,d?(r=C.getInput(d))&&(M=r.connection):r===Ne.PREVIOUS_STATEMENT&&(M=C.nextConnection),M?t.connect(M):console.warn("Can't connect to non-existent input: "+d)}}else console.warn("Can't move non-existent block: "+this.blockId)}};Ie(Te.EVENT,Ps,C_);var dr=class extends Wr{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=Bt(),this.recordUndo=Ls())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}fromJson(e){o("Blockly.Events.CommentBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.commentId=e.commentId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new dr),t.commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){var r=e.getEventWorkspace_();if(t){if(t=ht("xml"),!e.xml)throw Error("Ecountered a comment event without proper xml");t.appendChild(e.xml),Da(t,r)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(r=r.getCommentById(e.commentId))?r.dispose():console.warn("Can't uncreate non-existent comment: "+e.commentId)}}},O_=class extends dr{constructor(e,t,r){super(e),this.type=Ya,e&&(this.oldContents_=typeof t>"u"?"":t,this.newContents_=typeof r>"u"?"":r)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}fromJson(e){o("Blockly.Events.CommentChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldContents_=e.oldContents,this.newContents_=e.newContents}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new O_),t.oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var r=e?this.newContents_:this.oldContents_;if(!r)throw Error(e?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");t.setContent(r)}else console.warn("Can't change non-existent comment: "+this.commentId)}};Ie(Te.EVENT,Ya,O_);var w_=class extends dr{constructor(e){super(e),this.type=Hr,e&&(this.xml=e.toXmlWithXY())}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=wi(this.xml),e}fromJson(e){o("Blockly.Events.CommentCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.xml=Bs(e.xml)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new w_),t.xml=Bs(e.xml),t}run(e){dr.CommentCreateDeleteHelper(this,e)}};Ie(Te.EVENT,Hr,w_);var k_=class extends dr{constructor(e){super(e),this.type=Uo,e&&(this.xml=e.toXmlWithXY())}run(e){dr.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=wi(this.xml),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new k_),t.xml=Bs(e.xml),t}};Ie(Te.EVENT,Uo,k_);var A_=class extends dr{constructor(e){super(e),this.type=Bn,e&&(this.comment_=e,this.oldCoordinate_=e.getXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getXY()}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}fromJson(e){o("Blockly.Events.CommentMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e);let t=e.oldCoordinate.split(",");this.oldCoordinate_=new we(Number(t[0]),Number(t[1])),t=e.newCoordinate.split(","),this.newCoordinate_=new we(Number(t[0]),Number(t[1]))}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new A_),r=e.oldCoordinate.split(","),t.oldCoordinate_=new we(Number(r[0]),Number(r[1])),r=e.newCoordinate.split(","),t.newCoordinate_=new we(Number(r[0]),Number(r[1])),t}isNull(){return we.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(e=e?this.newCoordinate_:this.oldCoordinate_,!e)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var r=t.getXY();t.moveBy(e.x-r.x,e.y-r.y)}else console.warn("Can't move non-existent comment: "+this.commentId)}};Ie(Te.EVENT,Bn,A_);var Zr=class extends Wr{constructor(e,t){super(),this.model=t,this.isBlank=false,this.workspaceId=e.id}toJson(){const e=super.toJson();return e.procedureId=this.model.getId(),e}},L_=class extends Zr{constructor(e,t,r){super(e,t),this.oldTypes=r,this.type=Zc,this.newTypes=t.getReturnTypes()}run(e){const t=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!t)throw Error("Cannot change the type of a procedure that does not exist in the procedure map");e?t.setReturnTypes(this.newTypes):t.setReturnTypes(this.oldTypes)}toJson(){const e=super.toJson();return e.oldTypes=this.oldTypes,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure change return event because the target procedure does not exist");return new L_(t,r,e.oldTypes)}};Ie(Te.EVENT,Zc,L_);var N_=class extends Zr{constructor(e,t){super(e,t),this.type=Yc}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap(),a=r.get(this.model.getId());e?a||r.add(new bl(t,this.model.getName(),this.model.getId())):a&&r.delete(this.model.getId())}toJson(){const e=super.toJson();return e.model=Jh(this.model),e}static fromJson(e,t){return new N_(t,Qh(bl,ta,e.model,t))}};Ie(Te.EVENT,Yc,N_);var M_=class extends Zr{constructor(e,t){super(e,t),this.type=qa}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap(),a=r.get(this.model.getId());e?a&&r.delete(this.model.getId()):a||r.add(new bl(t,this.model.getName(),this.model.getId()))}toJson(){return super.toJson()}static fromJson(e,t){if(e=t.getProcedureMap().get(e.procedureId),!e)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");return new M_(t,e)}};Ie(Te.EVENT,qa,M_);var D_=class extends Zr{constructor(e,t){super(e,t),this.type=Jc,this.oldState=!t.getEnabled(),this.newState=t.getEnabled()}run(e){const t=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!t)throw Error("Cannot change the enabled state of a procedure that does not exist in the procedure map");e?t.setEnabled(this.newState):t.setEnabled(this.oldState)}toJson(){return super.toJson()}static fromJson(e,t){if(e=t.getProcedureMap().get(e.procedureId),!e)throw Error("Cannot deserialize procedure enable event because the target procedure does not exist");return new D_(t,e)}};Ie(Te.EVENT,Jc,D_);var x_=class extends Zr{constructor(e,t,r){super(e,t),this.oldName=r,this.type=qc,this.newName=t.getName()}run(e){const t=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!t)throw Error("Cannot change the type of a procedure that does not exist in the procedure map");e?t.setName(this.newName):t.setName(this.oldName)}toJson(){const e=super.toJson();return e.oldName=this.oldName,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure rename event because the target procedure does not exist");return new x_(t,r,e.oldName)}};Ie(Te.EVENT,qc,x_);var yu=class extends Zr{constructor(e,t,r){super(e,t),this.parameter=r}toJson(){const e=super.toJson();return e.parameterId=this.model.getId(),e}},B_=class extends yu{constructor(e,t,r,a){super(e,t,r),this.index=a,this.type=Qc}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap().get(this.model.getId());if(!r)throw Error("Cannot add a parameter to a procedure that does not exist in the procedure map");const a=r.getParameter(this.index);e?this.parameterMatches(a)||r.insertParameter(new ta(t,this.parameter.getName(),this.parameter.getId()),this.index):this.parameterMatches(a)&&r.deleteParameter(this.index)}parameterMatches(e){return e&&e.getId()===this.parameter.getId()}toJson(){const e=super.toJson();return e.parameter=Zh(this.parameter),e.index=this.index,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize parameter create event because the target procedure does not exist");return new B_(t,r,ed(ta,e.parameter,t),e.index)}};Ie(Te.EVENT,Qc,B_);var P_=class extends yu{constructor(e,t,r,a){super(e,t,r),this.index=a,this.type=eu}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap().get(this.model.getId());if(!r)throw Error("Cannot add a parameter to a procedure that does not exist in the procedure map");const a=r.getParameter(this.index);e?this.parameterMatches(a)&&r.deleteParameter(this.index):this.parameterMatches(a)||r.insertParameter(new ta(t,this.parameter.getName(),this.parameter.getId()),this.index)}parameterMatches(e){return e&&e.getId()===this.parameter.getId()}toJson(){const e=super.toJson();return e.index=this.index,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");const a=r.getParameter(e.index);return new P_(t,r,a,e.index)}};Ie(Te.EVENT,eu,P_);var U_=class extends yu{constructor(e,t,r,a){super(e,t,r),this.oldName=a,this.type=tu,this.newName=r.getName()}run(e){const t=wE(this.getEventWorkspace_(),this.model.getId(),this.parameter.getId());if(!t)throw Error("Cannot rename a parameter that does not exist in the procedure map");e?t.setName(this.newName):t.setName(this.oldName)}toJson(){const e=super.toJson();return e.oldName=this.oldName,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");const a=wE(t,e.procedureId,e.parameterId);if(!a)throw Error("Cannot deserialize parameter rename event because the target parameter does not exist");return new U_(t,r,a,e.oldName)}};Ie(Te.EVENT,tu,U_);var F_=class extends zi{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=Po,e&&(this.blockId=e.id,this.isStart=t,this.blocks=r)}toJson(){const e=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}fromJson(e){o("Blockly.Events.BlockDrag.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isStart=e.isStart,this.blockId=e.blockId,this.blocks=e.blocks}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new F_),t.isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};Ie(Te.EVENT,Po,F_);var Gv=class extends zi{constructor(e,t,r,a){super(e?e.workspace.id:void 0),this.type=Wa,this.blockId=e?e.id:null,this.element=typeof t>"u"?"":t,this.oldValue=typeof r>"u"?"":r,this.newValue=typeof a>"u"?"":a}toJson(){const e=super.toJson();return e.element=this.element,this.newValue!==void 0&&(e.newValue=this.newValue),this.blockId&&(e.blockId=this.blockId),e}fromJson(e){super.fromJson(e),this.element=e.element,this.newValue=e.newValue,this.blockId=e.blockId}};Ie(Te.EVENT,Wa,Gv);var Hv=class extends Wr{constructor(e){super(),this.isBlank=true,this.recordUndo=false,this.type=Fo,this.isBlank=!!e,e&&(this.workspaceId=e.id)}toJson(){const e=super.toJson();if(!this.workspaceId)throw Error("The workspace ID is undefined. Either pass a workspace to the constructor, or call fromJson");return e.workspaceId=this.workspaceId,e}fromJson(e){super.fromJson(e),this.workspaceId=e.workspaceId}};Ie(Te.EVENT,Fo,Hv),i.module$build$src$core$events$events={},i.module$build$src$core$events$events.Abstract=Wr,i.module$build$src$core$events$events.BLOCK_CHANGE=vs,i.module$build$src$core$events$events.BLOCK_CREATE=ys,i.module$build$src$core$events$events.BLOCK_DELETE=dn,i.module$build$src$core$events$events.BLOCK_DRAG=Po,i.module$build$src$core$events$events.BLOCK_MOVE=Ps,i.module$build$src$core$events$events.BUBBLE_OPEN=xn,i.module$build$src$core$events$events.BUMP_EVENTS=md,i.module$build$src$core$events$events.BlockBase=Ho,i.module$build$src$core$events$events.BlockChange=zr,i.module$build$src$core$events$events.BlockCreate=Gd,i.module$build$src$core$events$events.BlockDelete=Hd,i.module$build$src$core$events$events.BlockDrag=F_,i.module$build$src$core$events$events.BlockMove=C_,i.module$build$src$core$events$events.BubbleOpen=Dd,i.module$build$src$core$events$events.BubbleType=xd,i.module$build$src$core$events$events.CHANGE=vs,i.module$build$src$core$events$events.CLICK=ar,i.module$build$src$core$events$events.COMMENT_CHANGE=Ya,i.module$build$src$core$events$events.COMMENT_CREATE=Hr,i.module$build$src$core$events$events.COMMENT_DELETE=Uo,i.module$build$src$core$events$events.COMMENT_MOVE=Bn,i.module$build$src$core$events$events.CREATE=ys,i.module$build$src$core$events$events.Click=s_,i.module$build$src$core$events$events.ClickTarget=i_,i.module$build$src$core$events$events.CommentBase=dr,i.module$build$src$core$events$events.CommentChange=O_,i.module$build$src$core$events$events.CommentCreate=w_,i.module$build$src$core$events$events.CommentDelete=k_,i.module$build$src$core$events$events.CommentMove=A_,i.module$build$src$core$events$events.DELETE=dn,i.module$build$src$core$events$events.FINISHED_LOADING=Fo,i.module$build$src$core$events$events.FinishedLoading=Hv,i.module$build$src$core$events$events.MARKER_MOVE=za,i.module$build$src$core$events$events.MOVE=Ps,i.module$build$src$core$events$events.MarkerMove=p_,i.module$build$src$core$events$events.ProcedureBase=Zr,i.module$build$src$core$events$events.ProcedureChangeReturn=L_,i.module$build$src$core$events$events.ProcedureCreate=N_,i.module$build$src$core$events$events.ProcedureDelete=M_,i.module$build$src$core$events$events.ProcedureEnable=D_,i.module$build$src$core$events$events.ProcedureParameterBase=yu,i.module$build$src$core$events$events.ProcedureParameterCreate=B_,i.module$build$src$core$events$events.ProcedureParameterDelete=P_,i.module$build$src$core$events$events.ProcedureParameterRename=U_,i.module$build$src$core$events$events.ProcedureRename=x_,i.module$build$src$core$events$events.SELECTED=or,i.module$build$src$core$events$events.Selected=$d,i.module$build$src$core$events$events.THEME_CHANGE=Ka,i.module$build$src$core$events$events.TOOLBOX_ITEM_SELECT=Xa,i.module$build$src$core$events$events.TRASHCAN_OPEN=ja,i.module$build$src$core$events$events.ThemeChange=n_,i.module$build$src$core$events$events.ToolboxItemSelect=Qd,i.module$build$src$core$events$events.TrashcanOpen=Ud,i.module$build$src$core$events$events.UI=Wa,i.module$build$src$core$events$events.Ui=Gv,i.module$build$src$core$events$events.UiBase=zi,i.module$build$src$core$events$events.VAR_CREATE=Fr,i.module$build$src$core$events$events.VAR_DELETE=Bo,i.module$build$src$core$events$events.VAR_RENAME=Va,i.module$build$src$core$events$events.VIEWPORT_CHANGE=Gr,i.module$build$src$core$events$events.VarBase=Ja,i.module$build$src$core$events$events.VarCreate=Td,i.module$build$src$core$events$events.VarDelete=m_,i.module$build$src$core$events$events.VarRename=E_,i.module$build$src$core$events$events.ViewportChange=r_,i.module$build$src$core$events$events.clearPendingUndo=Ci,i.module$build$src$core$events$events.disable=Yt,i.module$build$src$core$events$events.disableOrphans=Nt,i.module$build$src$core$events$events.enable=qt,i.module$build$src$core$events$events.filter=bo,i.module$build$src$core$events$events.fire=Pe,i.module$build$src$core$events$events.fromJson=Oe,i.module$build$src$core$events$events.get=ve,i.module$build$src$core$events$events.getDescendantIds=To,i.module$build$src$core$events$events.getGroup=Bt,i.module$build$src$core$events$events.getRecordUndo=Ls,i.module$build$src$core$events$events.isEnabled=as,i.module$build$src$core$events$events.setGroup=He,i.module$build$src$core$events$events.setRecordUndo=As,zE();var Gs={};Gs.registerCleanup=LE,Gs.registerCollapse=ME,Gs.registerCollapseExpandBlock=GE,Gs.registerComment=UE,Gs.registerDefaultOptions=zE,Gs.registerDelete=VE,Gs.registerDeleteAll=BE,Gs.registerDisable=HE,Gs.registerDuplicate=PE,Gs.registerExpand=DE,Gs.registerHelp=WE,Gs.registerInline=FE,Gs.registerRedo=AE,Gs.registerUndo=kE;var Vv=class{constructor(e,t){this.dragTarget_=null,this.wouldDeleteBlock_=false,this.draggingBlock_=e,this.draggedConnectionManager_=new Ei(this.draggingBlock_),this.workspace_=t,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=KC(e)}dispose(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()}startDrag(e,t){Bt()||He(true),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),Xe(),this.workspace_.setResizesEnabled(false),Pa(),this.shouldDisconnect_(t)&&this.disconnectBlock_(t,e),this.draggingBlock_.setDragging(true),this.draggingBlock_.moveToDragSurface()}shouldDisconnect_(e){return!!(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(e,t){this.draggingBlock_.unplug(e),e=this.pixelsToWorkspaceUnits_(t),e=we.sum(this.startXY_,e),this.draggingBlock_.translate(e.x,e.y),tE(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()}fireDragStartEvent_(){const e=new(ve(Po))(this.draggingBlock_,true,this.draggingBlock_.getDescendants(false));Pe(e)}drag(e,t){t=this.pixelsToWorkspaceUnits_(t);var r=we.sum(this.startXY_,t);this.draggingBlock_.moveDuringDrag(r),this.dragIcons_(t),r=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(e),this.draggedConnectionManager_.update(t,this.dragTarget_),e=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock,e!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==r&&(r&&r.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)}endDrag(e,t){this.drag(e,t),this.dragIconData_=[],this.fireDragEndEvent_(),Re(),Pa(),e=null,this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)?t=this.startXY_:(t=this.getNewLocationAfterDrag_(t),e=t.delta,t=t.newLocation),this.draggingBlock_.moveOffDragSurface(t),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(false),e?this.updateBlockAfterMove_(e):Bc(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(true),this.draggingBlock_)),this.workspace_.setResizesEnabled(true),He(false)}getNewLocationAfterDrag_(e){e=this.pixelsToWorkspaceUnits_(e);const t=we.sum(this.startXY_,e);return{delta:e,newLocation:t}}maybeDeleteBlock_(){return this.wouldDeleteBlock_?(this.fireMoveEvent_(),this.draggingBlock_.dispose(false,true),Br.length=0,true):false}updateBlockAfterMove_(e){this.draggingBlock_.moveConnections(e.x,e.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()}fireDragEndEvent_(){const e=new(ve(Po))(this.draggingBlock_,false,this.draggingBlock_.getDescendants(false));Pe(e)}updateToolboxStyle_(e){const t=this.workspace_.getToolbox();if(t){const r=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";e&&typeof t.removeStyle=="function"?t.removeStyle(r):e||typeof t.addStyle!="function"||t.addStyle(r)}}fireMoveEvent_(){const e=new(ve(Ps))(this.draggingBlock_);e.oldCoordinate=this.startXY_,e.recordNew(),Pe(e)}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(e){return e=new we(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e}dragIcons_(e){for(let t=0;t<this.dragIconData_.length;t++){const r=this.dragIconData_[t];r.icon.setIconLocation(we.sum(r.location,e))}}getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]}};Ie(Te.BLOCK_DRAGGER,Dn,Vv);var BO="9.2.1",PO=i.Align$$module$build$src$core$input.LEFT,UO=i.Align$$module$build$src$core$input.CENTRE,FO=i.Align$$module$build$src$core$input.RIGHT,GO=Ne.INPUT_VALUE,HO=Ne.OUTPUT_VALUE,VO=Ne.NEXT_STATEMENT,WO=Ne.PREVIOUS_STATEMENT,zO=it.DUMMY,jO=Je.TOP,XO=Je.BOTTOM,KO=Je.LEFT,YO=Je.RIGHT;Vn.prototype.newBlock=function(e,t){return new Yo(this,e,t)},Ji.prototype.newBlock=function(e,t){return new Li(this,e,t)},Ji.newTrashcan=function(e){return new Hb(e)},Ms.prototype.showContextMenu=function(e){if(!this.workspace.options.readOnly){var t=[];this.isDeletable()&&this.isMovable()&&(t.push(aE(this)),t.push(oE(this))),Mc(e,t,this.RTL)}},i.Mutator$$module$build$src$core$mutator.prototype.newWorkspaceSvg=function(e){return new Ji(e)},Ni.prototype.populateProcedures=function(e){e=Kh(e),e=e[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],Ni.NameType.PROCEDURE)};var qO=Ne,se={};return se.ALIGN_CENTRE=UO,se.ALIGN_LEFT=PO,se.ALIGN_RIGHT=FO,se.ASTNode=_e,se.BasicCursor=ml,se.Block=Yo,se.BlockDragSurfaceSvg=xv,se.BlockDragger=Vv,se.BlockSvg=Li,se.Blocks=Ys,se.Bubble=Qe,se.BubbleDragger=Xb,se.COLLAPSED_FIELD_NAME=hl,se.COLLAPSED_INPUT_NAME=ul,se.COLLAPSE_CHARS=xb,se.CodeGenerator=i.CodeGenerator$$module$build$src$core$generator,se.CollapsibleToolboxCategory=Qo,se.Comment=Db,se.ComponentManager=Ss,se.Connection=Tt,se.ConnectionChecker=nv,se.ConnectionDB=ea,se.ConnectionType=Ne,se.ContextMenu=i.module$build$src$core$contextmenu,se.ContextMenuItems=Gs,se.ContextMenuRegistry=St,se.Css=Id,se.Cursor=Yd,se.DELETE_VARIABLE_ID=Kd,se.DRAG_STACK=Bb,se.DUMMY_INPUT=zO,se.DeleteArea=gu,se.DragTarget=Gb,se.DropDownDiv=ns,se.Events=i.module$build$src$core$events$events,se.Extensions=i.module$build$src$core$extensions,se.Field=dt,se.FieldAngle=lt,se.FieldCheckbox=i.FieldCheckbox$$module$build$src$core$field_checkbox,se.FieldColour=bi,se.FieldDropdown=Ki,se.FieldImage=i.FieldImage$$module$build$src$core$field_image,se.FieldLabel=i.FieldLabel$$module$build$src$core$field_label,se.FieldLabelSerializable=Fv,se.FieldMultilineInput=I_,se.FieldNumber=R_,se.FieldTextInput=i.FieldTextInput$$module$build$src$core$field_textinput,se.FieldVariable=wl,se.Flyout=Su,se.FlyoutButton=ia,se.FlyoutMetricsManager=Pv,se.Generator=i.CodeGenerator$$module$build$src$core$generator,se.Gesture=pn,se.Grid=o_,se.HorizontalFlyout=Uv,se.INPUT_VALUE=GO,se.Icon=hu,se.Input=Ko,se.InsertionMarkerManager=Ei,se.Marker=Pb,se.MarkerManager=Qa,se.Menu=Nd,se.MenuItem=Md,se.MetricsManager=$_,se.Msg=je,se.Mutator=i.Mutator$$module$build$src$core$mutator,se.NEXT_STATEMENT=VO,se.Names=Ni,se.OPPOSITE_TYPE=Xr,se.OUTPUT_VALUE=HO,se.Options=Yi,se.PREVIOUS_STATEMENT=WO,se.PROCEDURE_CATEGORY_NAME=Eu,se.Procedures=i.module$build$src$core$procedures,se.RENAME_VARIABLE_ID=Xd,se.RenderedConnection=Us,se.Scrollbar=jt,se.ScrollbarPair=S_,se.ShortcutItems=fn,se.ShortcutRegistry=It,se.TOOLBOX_AT_BOTTOM=XO,se.TOOLBOX_AT_LEFT=KO,se.TOOLBOX_AT_RIGHT=YO,se.TOOLBOX_AT_TOP=jO,se.TabNavigateCursor=Ub,se.Theme=jr,se.ThemeManager=iv,se.Themes=t_,se.Toolbox=jb,se.ToolboxCategory=qi,se.ToolboxItem=e_,se.ToolboxSeparator=El,se.Tooltip=rs,se.Touch=gi,se.TouchGesture=pn,se.Trashcan=Hb,se.VARIABLE_CATEGORY_NAME=nu,se.VARIABLE_DYNAMIC_CATEGORY_NAME=f_,se.VERSION=BO,se.VariableMap=b_,se.VariableModel=Za,se.Variables=i.module$build$src$core$variables,se.VariablesDynamic=hr,se.VerticalFlyout=y_,se.Warning=Fb,se.WidgetDiv=Xi,se.Workspace=Vn,se.WorkspaceAudio=rv,se.WorkspaceComment=_n,se.WorkspaceCommentSvg=Ms,se.WorkspaceDragSurfaceSvg=Dv,se.WorkspaceDragger=Kb,se.WorkspaceSvg=Ji,se.Xml=i.module$build$src$core$xml,se.ZoomControls=ov,se.bindEventWithChecks_=nO,se.bindEvent_=sO,se.blockAnimations=_l,se.blockRendering=$t,se.browserEvents=Mn,se.bumpObjects=Tu,se.clipboard=pl,se.common=i.module$build$src$core$common,se.config=i.config$$module$build$src$core$config,se.connectionTypes=qO,se.constants=Vd,se.copy=JC,se.defineBlocksWithJsonArray=P,se.dialog=Js,se.duplicate=QC,se.fieldRegistry=nl,se.geras=En,se.getMainWorkspace=L,se.getSelected=B,se.hideChaff=YC,se.hueToHex=tO,se.inject=UC,se.inputTypes=it,se.isNumber=eO,se.minimalist=Ol,se.paste=ZC,se.procedures=i.module$build$src$core$procedures,se.registry=Wi,se.resizeSvgContents=qC,se.serialization=xO,se.setLocale=vd,se.setParentContainer=X,se.svgResize=Z,se.thrasos=T_,se.uiPosition=Kr,se.unbindEvent_=iO,se.utils=gt,se.zelos=Zi,i.module$build$src$core$contextmenu,i.module$build$src$core$events$events,i.module$build$src$core$msg,i.module$build$src$core$common,Object.defineProperties(se,{alert:{set:function(e){bs.warn("Blockly.alert","December 2021","December 2022"),Js.setAlert(e)},get:function(){return bs.warn("Blockly.alert","December 2021","December 2022","Blockly.dialog.alert()"),Js.alert}},confirm:{set:function(e){bs.warn("Blockly.confirm","December 2021","December 2022"),Js.setConfirm(e)},get:function(){return bs.warn("Blockly.confirm","December 2021","December 2022","Blockly.dialog.confirm()"),Js.confirm}},mainWorkspace:{set:function(e){bs.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace"),i.module$build$src$core$common.setMainWorkspace(e)},get:function(){return bs.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace"),i.module$build$src$core$common.getMainWorkspace()}},prompt:{set:function(e){bs.warn("Blockly.prompt","December 2021","December 2022"),Js.setPrompt(e)},get:function(){return bs.warn("Blockly.prompt","December 2021","December 2022","Blockly.dialog.prompt()"),Js.prompt}},selected:{get:function(){return bs.warn("Blockly.selected","version 9","version 10","Blockly.getSelected"),i.module$build$src$core$common.getSelected()},set:function(e){bs.warn("Blockly.selected","version 9","version 10","Blockly.getSelected"),i.module$build$src$core$common.setSelected(e)}},HSV_SATURATION:{get:function(){return Ds.getHsvSaturation()},set:function(e){Ds.setHsvSaturation(e)}},HSV_VALUE:{get:function(){return Ds.getHsvValue()},set:function(e){Ds.setHsvValue(e)}}}),Object.defineProperties(i.module$build$src$core$contextmenu,{currentBlock:{get:function(){return bs.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.getCurrentBlock()"),i.module$build$src$core$contextmenu.getCurrentBlock()},set:function(e){bs.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.setCurrentBlock(block)"),i.module$build$src$core$contextmenu.setCurrentBlock(e)}}}),Object.defineProperties(i.module$build$src$core$events$events,{recordUndo:{get:function(){return bs.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.getRecordUndo()"),Ke.getRecordUndo()},set:function(e){bs.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.setRecordUndo()"),Ke.setRecordUndo(e)}}}),Object.defineProperties(rs,{visible:{get:function(){return bs.warn("Blockly.Tooltip.visible","September 2021","September 2022","Blockly.Tooltip.isVisible()"),rs.isVisible()}},DIV:{get:function(){return bs.warn("Blockly.Tooltip.DIV","September 2021","September 2022","Blockly.Tooltip.getDiv()"),rs.getDiv()}}}),Object.defineProperties(Xi,{DIV:{get:function(){return bs.warn("Blockly.WidgetDiv.DIV","September 2021","September 2022","Blockly.WidgetDiv.getDiv()"),Xi.getDiv()}}}),"Blockly"in globalThis||(globalThis.Blockly={Msg:i.module$build$src$core$msg}),se.__namespace__=i,se})}(pp)),pp.exports}var lS;function Ix(){return lS||(lS=1,function(s,n){(function(i,o){s.exports=o(rm())})(Ri,function(i){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(_p)),_p.exports}var cS;function JR(){return cS||(cS=1,function(s,n){(function(i,o){s.exports=o(Ix())})(Ri,function(i){return i})}(dp)),dp.exports}var gp={exports:{}},uS;function Cx(){return uS||(uS=1,function(s,n){(function(i,o){s.exports=o(rm())})(Ri,function(i){var o=i.__namespace__,l={};o.module$build$src$core$variables,o.module$build$src$core$utils$string,o.CodeGenerator$$module$build$src$core$generator,o.module$build$src$core$input_types.inputTypes,o.module$build$src$core$names.Names,o.NameType$$module$build$src$core$names,l.javascriptGenerator=new o.CodeGenerator$$module$build$src$core$generator("JavaScript"),l.javascriptGenerator.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(",")),l.javascriptGenerator.ORDER_ATOMIC=0,l.javascriptGenerator.ORDER_NEW=1.1,l.javascriptGenerator.ORDER_MEMBER=1.2,l.javascriptGenerator.ORDER_FUNCTION_CALL=2,l.javascriptGenerator.ORDER_INCREMENT=3,l.javascriptGenerator.ORDER_DECREMENT=3,l.javascriptGenerator.ORDER_BITWISE_NOT=4.1,l.javascriptGenerator.ORDER_UNARY_PLUS=4.2,l.javascriptGenerator.ORDER_UNARY_NEGATION=4.3,l.javascriptGenerator.ORDER_LOGICAL_NOT=4.4,l.javascriptGenerator.ORDER_TYPEOF=4.5,l.javascriptGenerator.ORDER_VOID=4.6,l.javascriptGenerator.ORDER_DELETE=4.7,l.javascriptGenerator.ORDER_AWAIT=4.8,l.javascriptGenerator.ORDER_EXPONENTIATION=5,l.javascriptGenerator.ORDER_MULTIPLICATION=5.1,l.javascriptGenerator.ORDER_DIVISION=5.2,l.javascriptGenerator.ORDER_MODULUS=5.3,l.javascriptGenerator.ORDER_SUBTRACTION=6.1,l.javascriptGenerator.ORDER_ADDITION=6.2,l.javascriptGenerator.ORDER_BITWISE_SHIFT=7,l.javascriptGenerator.ORDER_RELATIONAL=8,l.javascriptGenerator.ORDER_IN=8,l.javascriptGenerator.ORDER_INSTANCEOF=8,l.javascriptGenerator.ORDER_EQUALITY=9,l.javascriptGenerator.ORDER_BITWISE_AND=10,l.javascriptGenerator.ORDER_BITWISE_XOR=11,l.javascriptGenerator.ORDER_BITWISE_OR=12,l.javascriptGenerator.ORDER_LOGICAL_AND=13,l.javascriptGenerator.ORDER_LOGICAL_OR=14,l.javascriptGenerator.ORDER_CONDITIONAL=15,l.javascriptGenerator.ORDER_ASSIGNMENT=16,l.javascriptGenerator.ORDER_YIELD=17,l.javascriptGenerator.ORDER_COMMA=18,l.javascriptGenerator.ORDER_NONE=99,l.javascriptGenerator.ORDER_OVERRIDES=[[l.javascriptGenerator.ORDER_FUNCTION_CALL,l.javascriptGenerator.ORDER_MEMBER],[l.javascriptGenerator.ORDER_FUNCTION_CALL,l.javascriptGenerator.ORDER_FUNCTION_CALL],[l.javascriptGenerator.ORDER_MEMBER,l.javascriptGenerator.ORDER_MEMBER],[l.javascriptGenerator.ORDER_MEMBER,l.javascriptGenerator.ORDER_FUNCTION_CALL],[l.javascriptGenerator.ORDER_LOGICAL_NOT,l.javascriptGenerator.ORDER_LOGICAL_NOT],[l.javascriptGenerator.ORDER_MULTIPLICATION,l.javascriptGenerator.ORDER_MULTIPLICATION],[l.javascriptGenerator.ORDER_ADDITION,l.javascriptGenerator.ORDER_ADDITION],[l.javascriptGenerator.ORDER_LOGICAL_AND,l.javascriptGenerator.ORDER_LOGICAL_AND],[l.javascriptGenerator.ORDER_LOGICAL_OR,l.javascriptGenerator.ORDER_LOGICAL_OR]],l.javascriptGenerator.isInitialized=false,l.javascriptGenerator.init=function(c){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new o.module$build$src$core$names.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(c.getVariableMap()),this.nameDB_.populateVariables(c),this.nameDB_.populateProcedures(c);const _=[];var m=o.module$build$src$core$variables.allDeveloperVariables(c);for(let E=0;E<m.length;E++)_.push(this.nameDB_.getName(m[E],o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(c=o.module$build$src$core$variables.allUsedVarModels(c),m=0;m<c.length;m++)_.push(this.nameDB_.getName(c[m].getId(),o.NameType$$module$build$src$core$names.VARIABLE));_.length&&(this.definitions_.variables="var "+_.join(", ")+";"),this.isInitialized=true},l.javascriptGenerator.finish=function(c){const _=Object.values(this.definitions_);return c=Object.getPrototypeOf(this).finish.call(this,c),this.isInitialized=false,this.nameDB_.reset(),_.join(`

`)+`


`+c},l.javascriptGenerator.scrubNakedValue=function(c){return c+`;
`},l.javascriptGenerator.quote_=function(c){return c=c.replace(/\\/g,"\\\\").replace(/\n/g,`\\
`).replace(/'/g,"\\'"),"'"+c+"'"},l.javascriptGenerator.multiline_quote_=function(c){return c.split(/\n/g).map(this.quote_).join(` + '\\n' +
`)},l.javascriptGenerator.scrub_=function(c,_,m){let E="";if(!c.outputConnection||!c.outputConnection.targetConnection){var b=c.getCommentText();b&&(b=o.module$build$src$core$utils$string.wrap(b,this.COMMENT_WRAP-3),E+=this.prefixLines(b+`
`,"// "));for(let T=0;T<c.inputList.length;T++)c.inputList[T].type===o.module$build$src$core$input_types.inputTypes.VALUE&&(b=c.inputList[T].connection.targetBlock())&&(b=this.allNestedComments(b))&&(E+=this.prefixLines(b,"// "))}return c=c.nextConnection&&c.nextConnection.targetBlock(),m=m?"":this.blockToCode(c),E+_+m},l.javascriptGenerator.getAdjusted=function(c,_,m,E,b){m=m||0,b=b||this.ORDER_NONE,c.workspace.options.oneBasedIndex&&m--;const T=c.workspace.options.oneBasedIndex?"1":"0";let y,g=b;return 0<m?y=g=this.ORDER_ADDITION:0>m?y=g=this.ORDER_SUBTRACTION:E&&(y=g=this.ORDER_UNARY_NEGATION),c=this.valueToCode(c,_,g)||T,o.module$build$src$core$utils$string.isNumber(c)?(c=Number(c)+m,E&&(c=-c)):(0<m?c=c+" + "+m:0>m&&(c=c+" - "+-m),E&&(c=m?"-("+c+")":"-"+c),y=Math.floor(y),b=Math.floor(b),y&&b>=y&&(c="("+c+")")),c},o.NameType$$module$build$src$core$names,l.javascriptGenerator.variables_get=function(c){return[l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE),l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.variables_set=function(c){const _=l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0";return l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE)+" = "+_+`;
`},l.javascriptGenerator.variables_get_dynamic=l.javascriptGenerator.variables_get,l.javascriptGenerator.variables_set_dynamic=l.javascriptGenerator.variables_set,o.NameType$$module$build$src$core$names;var h=/^\s*'([^']|\\')*'\s*$/,f=function(c){return h.test(c)?[c,l.javascriptGenerator.ORDER_ATOMIC]:["String("+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},u=function(c,_,m){return _==="FIRST"?"0":_==="FROM_END"?c+".length - 1 - "+m:_==="LAST"?c+".length - 1":m};l.javascriptGenerator.text=function(c){return[l.javascriptGenerator.quote_(c.getFieldValue("TEXT")),l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.text_multiline=function(c){c=l.javascriptGenerator.multiline_quote_(c.getFieldValue("TEXT"));const _=c.indexOf("+")!==-1?l.javascriptGenerator.ORDER_ADDITION:l.javascriptGenerator.ORDER_ATOMIC;return[c,_]},l.javascriptGenerator.text_join=function(c){switch(c.itemCount_){case 0:return["''",l.javascriptGenerator.ORDER_ATOMIC];case 1:return c=l.javascriptGenerator.valueToCode(c,"ADD0",l.javascriptGenerator.ORDER_NONE)||"''",f(c);case 2:var _=l.javascriptGenerator.valueToCode(c,"ADD0",l.javascriptGenerator.ORDER_NONE)||"''";return c=l.javascriptGenerator.valueToCode(c,"ADD1",l.javascriptGenerator.ORDER_NONE)||"''",[f(_)[0]+" + "+f(c)[0],l.javascriptGenerator.ORDER_ADDITION];default:_=Array(c.itemCount_);for(let m=0;m<c.itemCount_;m++)_[m]=l.javascriptGenerator.valueToCode(c,"ADD"+m,l.javascriptGenerator.ORDER_NONE)||"''";return["["+_.join(",")+"].join('')",l.javascriptGenerator.ORDER_FUNCTION_CALL]}},l.javascriptGenerator.text_append=function(c){const _=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE);return c=l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''",_+" += "+f(c)[0]+`;
`},l.javascriptGenerator.text_length=function(c){return[(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"''")+".length",l.javascriptGenerator.ORDER_MEMBER]},l.javascriptGenerator.text_isEmpty=function(c){return["!"+(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"''")+".length",l.javascriptGenerator.ORDER_LOGICAL_NOT]},l.javascriptGenerator.text_indexOf=function(c){var _=c.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf";const m=l.javascriptGenerator.valueToCode(c,"FIND",l.javascriptGenerator.ORDER_NONE)||"''";return _=(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"''")+"."+_+"("+m+")",c.workspace.options.oneBasedIndex?[_+" + 1",l.javascriptGenerator.ORDER_ADDITION]:[_,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_charAt=function(c){const _=c.getFieldValue("WHERE")||"FROM_START",m=l.javascriptGenerator.valueToCode(c,"VALUE",_==="RANDOM"?l.javascriptGenerator.ORDER_NONE:l.javascriptGenerator.ORDER_MEMBER)||"''";switch(_){case"FIRST":return[m+".charAt(0)",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"LAST":return[m+".slice(-1)",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"FROM_START":return c=l.javascriptGenerator.getAdjusted(c,"AT"),[m+".charAt("+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"FROM_END":return c=l.javascriptGenerator.getAdjusted(c,"AT",1,true),[m+".slice("+c+").charAt(0)",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"RANDOM":return[l.javascriptGenerator.provideFunction_("textRandomLetter",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(text) {
  var x = Math.floor(Math.random() * text.length);
  return text[x];
}
`)+"("+m+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},l.javascriptGenerator.text_getSubstring=function(c){var _=c.getFieldValue("WHERE1"),m=c.getFieldValue("WHERE2"),E=_!=="FROM_END"&&_!=="LAST"&&m!=="FROM_END"&&m!=="LAST",b=l.javascriptGenerator.valueToCode(c,"STRING",E?l.javascriptGenerator.ORDER_MEMBER:l.javascriptGenerator.ORDER_NONE)||"''";if(_==="FIRST"&&m==="LAST")return[b,l.javascriptGenerator.ORDER_NONE];if(b.match(/^'?\w+'?$/)||E){switch(_){case"FROM_START":_=l.javascriptGenerator.getAdjusted(c,"AT1");break;case"FROM_END":_=l.javascriptGenerator.getAdjusted(c,"AT1",1,false,l.javascriptGenerator.ORDER_SUBTRACTION),_=b+".length - "+_;break;case"FIRST":_="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(m){case"FROM_START":m=l.javascriptGenerator.getAdjusted(c,"AT2",1);break;case"FROM_END":m=l.javascriptGenerator.getAdjusted(c,"AT2",0,false,l.javascriptGenerator.ORDER_SUBTRACTION),m=b+".length - "+m;break;case"LAST":m=b+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}b=b+".slice("+_+", "+m+")"}else{E=l.javascriptGenerator.getAdjusted(c,"AT1"),c=l.javascriptGenerator.getAdjusted(c,"AT2");const T={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};b=l.javascriptGenerator.provideFunction_("subsequence"+T[_]+T[m],`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(sequence${_==="FROM_END"||_==="FROM_START"?", at1":""}${m==="FROM_END"||m==="FROM_START"?", at2":""}) {
  var start = ${u("sequence",_,"at1")};
  var end = ${u("sequence",m,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+b+(_==="FROM_END"||_==="FROM_START"?", "+E:"")+(m==="FROM_END"||m==="FROM_START"?", "+c:"")+")"}return[b,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_changeCase=function(c){const _={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[c.getFieldValue("CASE")];return c=l.javascriptGenerator.valueToCode(c,"TEXT",_?l.javascriptGenerator.ORDER_MEMBER:l.javascriptGenerator.ORDER_NONE)||"''",[_?c+_:l.javascriptGenerator.provideFunction_("textToTitleCase",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(str) {
  return str.replace(/\\S+/g,
      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});
}
`)+"("+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_trim=function(c){const _={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[c.getFieldValue("MODE")];return[(l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_MEMBER)||"''")+_,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_print=function(c){return"window.alert("+(l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''")+`);
`},l.javascriptGenerator.text_prompt_ext=function(c){let _="window.prompt("+(c.getField("TEXT")?l.javascriptGenerator.quote_(c.getFieldValue("TEXT")):l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''")+")";return c.getFieldValue("TYPE")==="NUMBER"&&(_="Number("+_+")"),[_,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_prompt=l.javascriptGenerator.text_prompt_ext,l.javascriptGenerator.text_count=function(c){const _=l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''";return c=l.javascriptGenerator.valueToCode(c,"SUB",l.javascriptGenerator.ORDER_NONE)||"''",[l.javascriptGenerator.provideFunction_("textCount",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {
  if (needle.length === 0) {
    return haystack.length + 1;
  } else {
    return haystack.split(needle).length - 1;
  }
}
`)+"("+_+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_replace=function(c){const _=l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''",m=l.javascriptGenerator.valueToCode(c,"FROM",l.javascriptGenerator.ORDER_NONE)||"''";return c=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_NONE)||"''",[l.javascriptGenerator.provideFunction_("textReplace",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {
  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')
                 .replace(/\\x08/g, '\\\\x08');
  return haystack.replace(new RegExp(needle, 'g'), replacement);
}
`)+"("+_+", "+m+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_reverse=function(c){return[(l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_MEMBER)||"''")+".split('').reverse().join('')",l.javascriptGenerator.ORDER_FUNCTION_CALL]},o.NameType$$module$build$src$core$names,l.javascriptGenerator.procedures_defreturn=function(c){const _=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("NAME"),o.NameType$$module$build$src$core$names.PROCEDURE);var m="";l.javascriptGenerator.STATEMENT_PREFIX&&(m+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,c)),l.javascriptGenerator.STATEMENT_SUFFIX&&(m+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c)),m&&(m=l.javascriptGenerator.prefixLines(m,l.javascriptGenerator.INDENT));let E="";l.javascriptGenerator.INFINITE_LOOP_TRAP&&(E=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.INFINITE_LOOP_TRAP,c),l.javascriptGenerator.INDENT));const b=l.javascriptGenerator.statementToCode(c,"STACK");let T=l.javascriptGenerator.valueToCode(c,"RETURN",l.javascriptGenerator.ORDER_NONE)||"",y="";b&&T&&(y=m),T&&(T=l.javascriptGenerator.INDENT+"return "+T+`;
`);const g=[],$=c.getVars();for(let R=0;R<$.length;R++)g[R]=l.javascriptGenerator.nameDB_.getName($[R],o.NameType$$module$build$src$core$names.VARIABLE);return m="function "+_+"("+g.join(", ")+`) {
`+m+E+b+y+T+"}",m=l.javascriptGenerator.scrub_(c,m),l.javascriptGenerator.definitions_["%"+_]=m,null},l.javascriptGenerator.procedures_defnoreturn=l.javascriptGenerator.procedures_defreturn,l.javascriptGenerator.procedures_callreturn=function(c){const _=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("NAME"),o.NameType$$module$build$src$core$names.PROCEDURE),m=[],E=c.getVars();for(let b=0;b<E.length;b++)m[b]=l.javascriptGenerator.valueToCode(c,"ARG"+b,l.javascriptGenerator.ORDER_NONE)||"null";return[_+"("+m.join(", ")+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.procedures_callnoreturn=function(c){return l.javascriptGenerator.procedures_callreturn(c)[0]+`;
`},l.javascriptGenerator.procedures_ifreturn=function(c){let _="if ("+(l.javascriptGenerator.valueToCode(c,"CONDITION",l.javascriptGenerator.ORDER_NONE)||"false")+`) {
`;return l.javascriptGenerator.STATEMENT_SUFFIX&&(_+=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c),l.javascriptGenerator.INDENT)),c.hasReturnValue_?(c=l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_NONE)||"null",_+=l.javascriptGenerator.INDENT+"return "+c+`;
`):_+=l.javascriptGenerator.INDENT+`return;
`,_+`}
`},o.NameType$$module$build$src$core$names,l.javascriptGenerator.math_number=function(c){return c=Number(c.getFieldValue("NUM")),[c,0<=c?l.javascriptGenerator.ORDER_ATOMIC:l.javascriptGenerator.ORDER_UNARY_NEGATION]},l.javascriptGenerator.math_arithmetic=function(c){var _={ADD:[" + ",l.javascriptGenerator.ORDER_ADDITION],MINUS:[" - ",l.javascriptGenerator.ORDER_SUBTRACTION],MULTIPLY:[" * ",l.javascriptGenerator.ORDER_MULTIPLICATION],DIVIDE:[" / ",l.javascriptGenerator.ORDER_DIVISION],POWER:[null,l.javascriptGenerator.ORDER_NONE]}[c.getFieldValue("OP")];const m=_[0];_=_[1];const E=l.javascriptGenerator.valueToCode(c,"A",_)||"0";return c=l.javascriptGenerator.valueToCode(c,"B",_)||"0",m?[E+m+c,_]:["Math.pow("+E+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_single=function(c){const _=c.getFieldValue("OP");let m;if(_==="NEG")return c=l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_UNARY_NEGATION)||"0",c[0]==="-"&&(c=" "+c),["-"+c,l.javascriptGenerator.ORDER_UNARY_NEGATION];switch(c=_==="SIN"||_==="COS"||_==="TAN"?l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_DIVISION)||"0":l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_NONE)||"0",_){case"ABS":m="Math.abs("+c+")";break;case"ROOT":m="Math.sqrt("+c+")";break;case"LN":m="Math.log("+c+")";break;case"EXP":m="Math.exp("+c+")";break;case"POW10":m="Math.pow(10,"+c+")";break;case"ROUND":m="Math.round("+c+")";break;case"ROUNDUP":m="Math.ceil("+c+")";break;case"ROUNDDOWN":m="Math.floor("+c+")";break;case"SIN":m="Math.sin("+c+" / 180 * Math.PI)";break;case"COS":m="Math.cos("+c+" / 180 * Math.PI)";break;case"TAN":m="Math.tan("+c+" / 180 * Math.PI)"}if(m)return[m,l.javascriptGenerator.ORDER_FUNCTION_CALL];switch(_){case"LOG10":m="Math.log("+c+") / Math.log(10)";break;case"ASIN":m="Math.asin("+c+") / Math.PI * 180";break;case"ACOS":m="Math.acos("+c+") / Math.PI * 180";break;case"ATAN":m="Math.atan("+c+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+_)}return[m,l.javascriptGenerator.ORDER_DIVISION]},l.javascriptGenerator.math_constant=function(c){return{PI:["Math.PI",l.javascriptGenerator.ORDER_MEMBER],E:["Math.E",l.javascriptGenerator.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",l.javascriptGenerator.ORDER_DIVISION],SQRT2:["Math.SQRT2",l.javascriptGenerator.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",l.javascriptGenerator.ORDER_MEMBER],INFINITY:["Infinity",l.javascriptGenerator.ORDER_ATOMIC]}[c.getFieldValue("CONSTANT")]},l.javascriptGenerator.math_number_property=function(c){var _={EVEN:[" % 2 === 0",l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],ODD:[" % 2 === 1",l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],WHOLE:[" % 1 === 0",l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],POSITIVE:[" > 0",l.javascriptGenerator.ORDER_RELATIONAL,l.javascriptGenerator.ORDER_RELATIONAL],NEGATIVE:[" < 0",l.javascriptGenerator.ORDER_RELATIONAL,l.javascriptGenerator.ORDER_RELATIONAL],DIVISIBLE_BY:[null,l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],PRIME:[null,l.javascriptGenerator.ORDER_NONE,l.javascriptGenerator.ORDER_FUNCTION_CALL]};const m=c.getFieldValue("PROPERTY"),[E,b,T]=_[m];return _=l.javascriptGenerator.valueToCode(c,"NUMBER_TO_CHECK",b)||"0",m==="PRIME"?c=l.javascriptGenerator.provideFunction_("mathIsPrime",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(n) {
  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  if (n == 2 || n == 3) {
    return true;
  }
  // False if n is NaN, negative, is 1, or not whole.
  // And false if n is divisible by 2 or 3.
  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {
    return false;
  }
  // Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {
    if (n % (x - 1) === 0 || n % (x + 1) === 0) {
      return false;
    }
  }
  return true;
}
`)+"("+_+")":m==="DIVISIBLE_BY"?(c=l.javascriptGenerator.valueToCode(c,"DIVISOR",l.javascriptGenerator.ORDER_MODULUS)||"0",c=_+" % "+c+" === 0"):c=_+E,[c,T]},l.javascriptGenerator.math_change=function(c){const _=l.javascriptGenerator.valueToCode(c,"DELTA",l.javascriptGenerator.ORDER_ADDITION)||"0";return c=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE),c+" = (typeof "+c+" === 'number' ? "+c+" : 0) + "+_+`;
`},l.javascriptGenerator.math_round=l.javascriptGenerator.math_single,l.javascriptGenerator.math_trig=l.javascriptGenerator.math_single,l.javascriptGenerator.math_on_list=function(c){var _=c.getFieldValue("OP");switch(_){case"SUM":c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_MEMBER)||"[]",c+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c="Math.min.apply(null, "+c+")";break;case"MAX":c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c="Math.max.apply(null, "+c+")";break;case"AVERAGE":_=l.javascriptGenerator.provideFunction_("mathMean",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=_+"("+c+")";break;case"MEDIAN":_=l.javascriptGenerator.provideFunction_("mathMedian",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  var localList = myList.filter(function (x) {return typeof x === 'number';});
  if (!localList.length) return null;
  localList.sort(function(a, b) {return b - a;});
  if (localList.length % 2 === 0) {
    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;
  } else {
    return localList[(localList.length - 1) / 2];
  }
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=_+"("+c+")";break;case"MODE":_=l.javascriptGenerator.provideFunction_("mathModes",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(values) {
  var modes = [];
  var counts = [];
  var maxCount = 0;
  for (var i = 0; i < values.length; i++) {
    var value = values[i];
    var found = false;
    var thisCount;
    for (var j = 0; j < counts.length; j++) {
      if (counts[j][0] === value) {
        thisCount = ++counts[j][1];
        found = true;
        break;
      }
    }
    if (!found) {
      counts.push([value, 1]);
      thisCount = 1;
    }
    maxCount = Math.max(thisCount, maxCount);
  }
  for (var j = 0; j < counts.length; j++) {
    if (counts[j][1] === maxCount) {
        modes.push(counts[j][0]);
    }
  }
  return modes;
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=_+"("+c+")";break;case"STD_DEV":_=l.javascriptGenerator.provideFunction_("mathStandardDeviation",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(numbers) {
  var n = numbers.length;
  if (!n) return null;
  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;
  var variance = 0;
  for (var j = 0; j < n; j++) {
    variance += Math.pow(numbers[j] - mean, 2);
  }
  variance = variance / n;
  return Math.sqrt(variance);
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=_+"("+c+")";break;case"RANDOM":_=l.javascriptGenerator.provideFunction_("mathRandomList",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(list) {
  var x = Math.floor(Math.random() * list.length);
  return list[x];
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=_+"("+c+")";break;default:throw Error("Unknown operator: "+_)}return[c,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_modulo=function(c){const _=l.javascriptGenerator.valueToCode(c,"DIVIDEND",l.javascriptGenerator.ORDER_MODULUS)||"0";return c=l.javascriptGenerator.valueToCode(c,"DIVISOR",l.javascriptGenerator.ORDER_MODULUS)||"0",[_+" % "+c,l.javascriptGenerator.ORDER_MODULUS]},l.javascriptGenerator.math_constrain=function(c){const _=l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_NONE)||"0",m=l.javascriptGenerator.valueToCode(c,"LOW",l.javascriptGenerator.ORDER_NONE)||"0";return c=l.javascriptGenerator.valueToCode(c,"HIGH",l.javascriptGenerator.ORDER_NONE)||"Infinity",["Math.min(Math.max("+_+", "+m+"), "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_random_int=function(c){const _=l.javascriptGenerator.valueToCode(c,"FROM",l.javascriptGenerator.ORDER_NONE)||"0";return c=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_NONE)||"0",[l.javascriptGenerator.provideFunction_("mathRandomInt",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(a, b) {
  if (a > b) {
    // Swap a and b to ensure a is smaller.
    var c = a;
    a = b;
    b = c;
  }
  return Math.floor(Math.random() * (b - a + 1) + a);
}
`)+"("+_+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_random_float=function(c){return["Math.random()",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_atan2=function(c){const _=l.javascriptGenerator.valueToCode(c,"X",l.javascriptGenerator.ORDER_NONE)||"0";return["Math.atan2("+(l.javascriptGenerator.valueToCode(c,"Y",l.javascriptGenerator.ORDER_NONE)||"0")+", "+_+") / Math.PI * 180",l.javascriptGenerator.ORDER_DIVISION]},o.module$build$src$core$utils$string,o.NameType$$module$build$src$core$names,l.javascriptGenerator.controls_repeat_ext=function(c){let _;_=c.getField("TIMES")?String(Number(c.getFieldValue("TIMES"))):l.javascriptGenerator.valueToCode(c,"TIMES",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0";let m=l.javascriptGenerator.statementToCode(c,"DO");m=l.javascriptGenerator.addLoopTrap(m,c),c="";const E=l.javascriptGenerator.nameDB_.getDistinctName("count",o.NameType$$module$build$src$core$names.VARIABLE);let b=_;return _.match(/^\w+$/)||o.module$build$src$core$utils$string.isNumber(_)||(b=l.javascriptGenerator.nameDB_.getDistinctName("repeat_end",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+b+" = "+_+`;
`),c+("for (var "+E+" = 0; "+E+" < "+b+"; "+E+`++) {
`+m+`}
`)},l.javascriptGenerator.controls_repeat=l.javascriptGenerator.controls_repeat_ext,l.javascriptGenerator.controls_whileUntil=function(c){const _=c.getFieldValue("MODE")==="UNTIL";let m=l.javascriptGenerator.valueToCode(c,"BOOL",_?l.javascriptGenerator.ORDER_LOGICAL_NOT:l.javascriptGenerator.ORDER_NONE)||"false",E=l.javascriptGenerator.statementToCode(c,"DO");return E=l.javascriptGenerator.addLoopTrap(E,c),_&&(m="!"+m),"while ("+m+`) {
`+E+`}
`},l.javascriptGenerator.controls_for=function(c){var _=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE),m=l.javascriptGenerator.valueToCode(c,"FROM",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0",E=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0";const b=l.javascriptGenerator.valueToCode(c,"BY",l.javascriptGenerator.ORDER_ASSIGNMENT)||"1";let T=l.javascriptGenerator.statementToCode(c,"DO");if(T=l.javascriptGenerator.addLoopTrap(T,c),o.module$build$src$core$utils$string.isNumber(m)&&o.module$build$src$core$utils$string.isNumber(E)&&o.module$build$src$core$utils$string.isNumber(b)){var y=Number(m)<=Number(E);c="for ("+_+" = "+m+"; "+_+(y?" <= ":" >= ")+E+"; "+_,_=Math.abs(Number(b)),c=_===1?c+(y?"++":"--"):c+((y?" += ":" -= ")+_),c+=`) {
`+T+`}
`}else c="",y=m,m.match(/^\w+$/)||o.module$build$src$core$utils$string.isNumber(m)||(y=l.javascriptGenerator.nameDB_.getDistinctName(_+"_start",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+y+" = "+m+`;
`),m=E,E.match(/^\w+$/)||o.module$build$src$core$utils$string.isNumber(E)||(m=l.javascriptGenerator.nameDB_.getDistinctName(_+"_end",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+m+" = "+E+`;
`),E=l.javascriptGenerator.nameDB_.getDistinctName(_+"_inc",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+E+" = ",c=o.module$build$src$core$utils$string.isNumber(b)?c+(Math.abs(b)+`;
`):c+("Math.abs("+b+`);
`),c+="if ("+y+" > "+m+`) {
`,c+=l.javascriptGenerator.INDENT+E+" = -"+E+`;
`,c=c+`}
for (`+(_+" = "+y+"; "+E+" >= 0 ? "+_+" <= "+m+" : "+_+" >= "+m+"; "+_+" += "+E+`) {
`+T+`}
`);return c},l.javascriptGenerator.controls_forEach=function(c){const _=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE);var m=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_ASSIGNMENT)||"[]";let E=l.javascriptGenerator.statementToCode(c,"DO");E=l.javascriptGenerator.addLoopTrap(E,c),c="";let b=m;return m.match(/^\w+$/)||(b=l.javascriptGenerator.nameDB_.getDistinctName(_+"_list",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+b+" = "+m+`;
`),m=l.javascriptGenerator.nameDB_.getDistinctName(_+"_index",o.NameType$$module$build$src$core$names.VARIABLE),E=l.javascriptGenerator.INDENT+_+" = "+b+"["+m+`];
`+E,c+("for (var "+m+" in "+b+`) {
`+E+`}
`)},l.javascriptGenerator.controls_flow_statements=function(c){let _="";if(l.javascriptGenerator.STATEMENT_PREFIX&&(_+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,c)),l.javascriptGenerator.STATEMENT_SUFFIX&&(_+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c)),l.javascriptGenerator.STATEMENT_PREFIX){const m=c.getSurroundLoop();m&&!m.suppressPrefixSuffix&&(_+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,m))}switch(c.getFieldValue("FLOW")){case"BREAK":return _+`break;
`;case"CONTINUE":return _+`continue;
`}throw Error("Unknown flow statement.")},l.javascriptGenerator.controls_if=function(c){var _=0;let m="";l.javascriptGenerator.STATEMENT_PREFIX&&(m+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,c));do{const E=l.javascriptGenerator.valueToCode(c,"IF"+_,l.javascriptGenerator.ORDER_NONE)||"false";let b=l.javascriptGenerator.statementToCode(c,"DO"+_);l.javascriptGenerator.STATEMENT_SUFFIX&&(b=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c),l.javascriptGenerator.INDENT)+b),m+=(0<_?" else ":"")+"if ("+E+`) {
`+b+"}",_++}while(c.getInput("IF"+_));return(c.getInput("ELSE")||l.javascriptGenerator.STATEMENT_SUFFIX)&&(_=l.javascriptGenerator.statementToCode(c,"ELSE"),l.javascriptGenerator.STATEMENT_SUFFIX&&(_=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c),l.javascriptGenerator.INDENT)+_),m+=` else {
`+_+"}"),m+`
`},l.javascriptGenerator.controls_ifelse=l.javascriptGenerator.controls_if,l.javascriptGenerator.logic_compare=function(c){const _={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[c.getFieldValue("OP")],m=_==="=="||_==="!="?l.javascriptGenerator.ORDER_EQUALITY:l.javascriptGenerator.ORDER_RELATIONAL,E=l.javascriptGenerator.valueToCode(c,"A",m)||"0";return c=l.javascriptGenerator.valueToCode(c,"B",m)||"0",[E+" "+_+" "+c,m]},l.javascriptGenerator.logic_operation=function(c){const _=c.getFieldValue("OP")==="AND"?"&&":"||",m=_==="&&"?l.javascriptGenerator.ORDER_LOGICAL_AND:l.javascriptGenerator.ORDER_LOGICAL_OR;let E=l.javascriptGenerator.valueToCode(c,"A",m);if(c=l.javascriptGenerator.valueToCode(c,"B",m),E||c){const b=_==="&&"?"true":"false";E||(E=b),c||(c=b)}else c=E="false";return[E+" "+_+" "+c,m]},l.javascriptGenerator.logic_negate=function(c){const _=l.javascriptGenerator.ORDER_LOGICAL_NOT;return["!"+(l.javascriptGenerator.valueToCode(c,"BOOL",_)||"true"),_]},l.javascriptGenerator.logic_boolean=function(c){return[c.getFieldValue("BOOL")==="TRUE"?"true":"false",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.logic_null=function(c){return["null",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.logic_ternary=function(c){const _=l.javascriptGenerator.valueToCode(c,"IF",l.javascriptGenerator.ORDER_CONDITIONAL)||"false",m=l.javascriptGenerator.valueToCode(c,"THEN",l.javascriptGenerator.ORDER_CONDITIONAL)||"null";return c=l.javascriptGenerator.valueToCode(c,"ELSE",l.javascriptGenerator.ORDER_CONDITIONAL)||"null",[_+" ? "+m+" : "+c,l.javascriptGenerator.ORDER_CONDITIONAL]},o.NameType$$module$build$src$core$names,l.javascriptGenerator.lists_create_empty=function(c){return["[]",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.lists_create_with=function(c){const _=Array(c.itemCount_);for(let m=0;m<c.itemCount_;m++)_[m]=l.javascriptGenerator.valueToCode(c,"ADD"+m,l.javascriptGenerator.ORDER_NONE)||"null";return["["+_.join(", ")+"]",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.lists_repeat=function(c){const _=l.javascriptGenerator.provideFunction_("listsRepeat",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(value, n) {
  var array = [];
  for (var i = 0; i < n; i++) {
    array[i] = value;
  }
  return array;
}
`),m=l.javascriptGenerator.valueToCode(c,"ITEM",l.javascriptGenerator.ORDER_NONE)||"null";return c=l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_NONE)||"0",[_+"("+m+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_length=function(c){return[(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"[]")+".length",l.javascriptGenerator.ORDER_MEMBER]},l.javascriptGenerator.lists_isEmpty=function(c){return["!"+(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"[]")+".length",l.javascriptGenerator.ORDER_LOGICAL_NOT]},l.javascriptGenerator.lists_indexOf=function(c){var _=c.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf";const m=l.javascriptGenerator.valueToCode(c,"FIND",l.javascriptGenerator.ORDER_NONE)||"''";return _=(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"[]")+"."+_+"("+m+")",c.workspace.options.oneBasedIndex?[_+" + 1",l.javascriptGenerator.ORDER_ADDITION]:[_,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_getIndex=function(c){const _=c.getFieldValue("MODE")||"GET",m=c.getFieldValue("WHERE")||"FROM_START";var E=l.javascriptGenerator.valueToCode(c,"VALUE",m==="RANDOM"?l.javascriptGenerator.ORDER_NONE:l.javascriptGenerator.ORDER_MEMBER)||"[]";switch(m){case"FIRST":if(_==="GET")return[E+"[0]",l.javascriptGenerator.ORDER_MEMBER];if(_==="GET_REMOVE")return[E+".shift()",l.javascriptGenerator.ORDER_MEMBER];if(_==="REMOVE")return E+`.shift();
`;break;case"LAST":if(_==="GET")return[E+".slice(-1)[0]",l.javascriptGenerator.ORDER_MEMBER];if(_==="GET_REMOVE")return[E+".pop()",l.javascriptGenerator.ORDER_MEMBER];if(_==="REMOVE")return E+`.pop();
`;break;case"FROM_START":if(c=l.javascriptGenerator.getAdjusted(c,"AT"),_==="GET")return[E+"["+c+"]",l.javascriptGenerator.ORDER_MEMBER];if(_==="GET_REMOVE")return[E+".splice("+c+", 1)[0]",l.javascriptGenerator.ORDER_FUNCTION_CALL];if(_==="REMOVE")return E+".splice("+c+`, 1);
`;break;case"FROM_END":if(c=l.javascriptGenerator.getAdjusted(c,"AT",1,true),_==="GET")return[E+".slice("+c+")[0]",l.javascriptGenerator.ORDER_FUNCTION_CALL];if(_==="GET_REMOVE")return[E+".splice("+c+", 1)[0]",l.javascriptGenerator.ORDER_FUNCTION_CALL];if(_==="REMOVE")return E+".splice("+c+", 1);";break;case"RANDOM":if(E=l.javascriptGenerator.provideFunction_("listsGetRandomItem",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {
  var x = Math.floor(Math.random() * list.length);
  if (remove) {
    return list.splice(x, 1)[0];
  } else {
    return list[x];
  }
}
`)+"("+E+", "+(_!=="GET")+")",_==="GET"||_==="GET_REMOVE")return[E,l.javascriptGenerator.ORDER_FUNCTION_CALL];if(_==="REMOVE")return E+`;
`}throw Error("Unhandled combination (lists_getIndex).")},l.javascriptGenerator.lists_setIndex=function(c){function _(){if(m.match(/^\w+$/))return"";const y=l.javascriptGenerator.nameDB_.getDistinctName("tmpList",o.NameType$$module$build$src$core$names.VARIABLE),g="var "+y+" = "+m+`;
`;return m=y,g}let m=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_MEMBER)||"[]";const E=c.getFieldValue("MODE")||"GET";var b=c.getFieldValue("WHERE")||"FROM_START";const T=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_ASSIGNMENT)||"null";switch(b){case"FIRST":if(E==="SET")return m+"[0] = "+T+`;
`;if(E==="INSERT")return m+".unshift("+T+`);
`;break;case"LAST":if(E==="SET")return _()+(m+"["+m+".length - 1] = "+T+`;
`);if(E==="INSERT")return m+".push("+T+`);
`;break;case"FROM_START":if(c=l.javascriptGenerator.getAdjusted(c,"AT"),E==="SET")return m+"["+c+"] = "+T+`;
`;if(E==="INSERT")return m+".splice("+c+", 0, "+T+`);
`;break;case"FROM_END":if(c=l.javascriptGenerator.getAdjusted(c,"AT",1,false,l.javascriptGenerator.ORDER_SUBTRACTION),b=_(),E==="SET")return b+(m+"["+m+".length - "+c+"] = "+T+`;
`);if(E==="INSERT")return b+(m+".splice("+m+".length - "+c+", 0, "+T+`);
`);break;case"RANDOM":if(c=_(),b=l.javascriptGenerator.nameDB_.getDistinctName("tmpX",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+b+" = Math.floor(Math.random() * "+m+`.length);
`,E==="SET")return c+(m+"["+b+"] = "+T+`;
`);if(E==="INSERT")return c+(m+".splice("+b+", 0, "+T+`);
`)}throw Error("Unhandled combination (lists_setIndex).")};var p=function(c,_,m){return _==="FIRST"?"0":_==="FROM_END"?c+".length - 1 - "+m:_==="LAST"?c+".length - 1":m};return l.javascriptGenerator.lists_getSublist=function(c){var _=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_MEMBER)||"[]",m=c.getFieldValue("WHERE1"),E=c.getFieldValue("WHERE2");if(m==="FIRST"&&E==="LAST")_+=".slice(0)";else if(_.match(/^\w+$/)||m!=="FROM_END"&&E==="FROM_START"){switch(m){case"FROM_START":m=l.javascriptGenerator.getAdjusted(c,"AT1");break;case"FROM_END":m=l.javascriptGenerator.getAdjusted(c,"AT1",1,false,l.javascriptGenerator.ORDER_SUBTRACTION),m=_+".length - "+m;break;case"FIRST":m="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(E){case"FROM_START":E=l.javascriptGenerator.getAdjusted(c,"AT2",1);break;case"FROM_END":E=l.javascriptGenerator.getAdjusted(c,"AT2",0,false,l.javascriptGenerator.ORDER_SUBTRACTION),E=_+".length - "+E;break;case"LAST":E=_+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}_=_+".slice("+m+", "+E+")"}else{const b=l.javascriptGenerator.getAdjusted(c,"AT1");c=l.javascriptGenerator.getAdjusted(c,"AT2");const T={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};_=l.javascriptGenerator.provideFunction_("subsequence"+T[m]+T[E],`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(sequence${m==="FROM_END"||m==="FROM_START"?", at1":""}${E==="FROM_END"||E==="FROM_START"?", at2":""}) {
  var start = ${p("sequence",m,"at1")};
  var end = ${p("sequence",E,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+_+(m==="FROM_END"||m==="FROM_START"?", "+b:"")+(E==="FROM_END"||E==="FROM_START"?", "+c:"")+")"}return[_,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_sort=function(c){const _=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_FUNCTION_CALL)||"[]",m=c.getFieldValue("DIRECTION")==="1"?1:-1;c=c.getFieldValue("TYPE");const E=l.javascriptGenerator.provideFunction_("listsGetSortCompare",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {
  var compareFuncs = {
    'NUMERIC': function(a, b) {
        return Number(a) - Number(b); },
    'TEXT': function(a, b) {
        return a.toString() > b.toString() ? 1 : -1; },
    'IGNORE_CASE': function(a, b) {
        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },
  };
  var compare = compareFuncs[type];
  return function(a, b) { return compare(a, b) * direction; };
}
      `);return[_+".slice().sort("+E+'("'+c+'", '+m+"))",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_split=function(c){let _=l.javascriptGenerator.valueToCode(c,"INPUT",l.javascriptGenerator.ORDER_MEMBER);const m=l.javascriptGenerator.valueToCode(c,"DELIM",l.javascriptGenerator.ORDER_NONE)||"''";if(c=c.getFieldValue("MODE"),c==="SPLIT")_||(_="''"),c="split";else if(c==="JOIN")_||(_="[]"),c="join";else throw Error("Unknown mode: "+c);return[_+"."+c+"("+m+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_reverse=function(c){return[(l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.colour_picker=function(c){return[l.javascriptGenerator.quote_(c.getFieldValue("COLOUR")),l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.colour_random=function(c){return[l.javascriptGenerator.provideFunction_("colourRandom",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}() {
  var num = Math.floor(Math.random() * Math.pow(2, 24));
  return '#' + ('00000' + num.toString(16)).substr(-6);
}
`)+"()",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.colour_rgb=function(c){const _=l.javascriptGenerator.valueToCode(c,"RED",l.javascriptGenerator.ORDER_NONE)||0,m=l.javascriptGenerator.valueToCode(c,"GREEN",l.javascriptGenerator.ORDER_NONE)||0;return c=l.javascriptGenerator.valueToCode(c,"BLUE",l.javascriptGenerator.ORDER_NONE)||0,[l.javascriptGenerator.provideFunction_("colourRgb",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {
  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;
  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;
  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+_+", "+m+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.colour_blend=function(c){const _=l.javascriptGenerator.valueToCode(c,"COLOUR1",l.javascriptGenerator.ORDER_NONE)||"'#000000'",m=l.javascriptGenerator.valueToCode(c,"COLOUR2",l.javascriptGenerator.ORDER_NONE)||"'#000000'";return c=l.javascriptGenerator.valueToCode(c,"RATIO",l.javascriptGenerator.ORDER_NONE)||.5,[l.javascriptGenerator.provideFunction_("colourBlend",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {
  ratio = Math.max(Math.min(Number(ratio), 1), 0);
  var r1 = parseInt(c1.substring(1, 3), 16);
  var g1 = parseInt(c1.substring(3, 5), 16);
  var b1 = parseInt(c1.substring(5, 7), 16);
  var r2 = parseInt(c2.substring(1, 3), 16);
  var g2 = parseInt(c2.substring(3, 5), 16);
  var b2 = parseInt(c2.substring(5, 7), 16);
  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);
  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);
  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);
  r = ('0' + (r || 0).toString(16)).slice(-2);
  g = ('0' + (g || 0).toString(16)).slice(-2);
  b = ('0' + (b || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+_+", "+m+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.__namespace__=o,l})}(gp)),gp.exports}var hS;function ZR(){return hS||(hS=1,function(s,n){(function(i,o){s.exports=o(JR(),Cx())})(Ri,function(i,o){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return o})}(hp)),hp.exports}var ue=ZR(),Ox=Object.defineProperty,bt=(s,n)=>Ox(s,"name",{value:n,configurable:true});function wx(){}bt(wx,"noop");function eh(s){return s==null}bt(eh,"isNullable");function kx(s){return s&&typeof s=="object"&&!Array.isArray(s)}bt(kx,"isPlainObject");function QR(s,n){return Object.fromEntries(Object.entries(s).map(([i,o])=>[i,n(o,i)]))}bt(QR,"valueMap");function yf(s,n){return s in globalThis&&n instanceof globalThis[s]||Object.prototype.toString.call(n).slice(8,-1)===s}bt(yf,"is");function Rf(s){return!s||typeof s!="object"?s:Array.isArray(s)?s.map(Rf):yf("Date",s)?new Date(s.valueOf()):yf("RegExp",s)?new RegExp(s.source,s.flags):QR(s,Rf)}bt(Rf,"clone");function If(s,n,i){return s===n||!i&&eh(s)&&eh(n)?true:typeof s!=typeof n||typeof s!="object"||!s||!n?false:Array.isArray(s)?!Array.isArray(n)||s.length!==n.length?false:s.every((o,l)=>If(o,n[l])):Array.isArray(n)?false:Object.keys({...s,...n}).every(o=>If(s[o],n[o],i))}bt(If,"deepEqual");function Ax(s,n,i){if(!n)return{...s};const o={};for(const l of n)(i||l in s)&&(o[l]=s[l]);return o}bt(Ax,"pick");function Lx(s,n){if(!n)return{...s};const i={...s};for(const o of n)Reflect.deleteProperty(i,o);return i}bt(Lx,"omit");function Nx(s,n,i){return Object.defineProperty(s,n,{writable:true,value:i})}bt(Nx,"defineProperty");function Mx(s,n){return n.every(i=>s.includes(i))}bt(Mx,"contain");function Dx(s,n){return s.filter(i=>n.includes(i))}bt(Dx,"intersection");function xx(s,n){return s.filter(i=>!n.includes(i))}bt(xx,"difference");function Bx(s,n){return Array.from(new Set([...s,...n]))}bt(Bx,"union");function om(s){return[...new Set(s)]}bt(om,"deduplicate");function Px(s,n){const i=s.indexOf(n);return i>=0?(s.splice(i,1),true):false}bt(Px,"remove");function Ux(s){return Array.isArray(s)?s:eh(s)?[]:[s]}bt(Ux,"makeArray");function Fx(s){if(typeof Buffer<"u")return Buffer.from(s).toString("base64");let n="";const i=new Uint8Array(s);for(let o=0;o<i.byteLength;o++)n+=String.fromCharCode(i[o]);return btoa(n)}bt(Fx,"arrayBufferToBase64");function Gx(s){if(typeof Buffer<"u")return Buffer.from(s,"base64").buffer;const n=atob(s.replace(/\s/g,"")),i=new Uint8Array(n.length);for(let o=0;o<n.length;o++)i[o]=n.charCodeAt(o);return i}bt(Gx,"base64ToArrayBuffer");function Hx(s){return s.charAt(0).toUpperCase()+s.slice(1)}bt(Hx,"capitalize");function am(s){return s.charAt(0).toLowerCase()+s.slice(1)}bt(am,"uncapitalize");function Vx(s){return s.replace(/[_-][a-z]/g,n=>n.slice(1).toUpperCase())}bt(Vx,"camelCase");function Wx(s){return am(s).replace(/_/g,"-").replace(/.[A-Z]+/g,n=>n[0]+"-"+n.slice(1).toLowerCase())}bt(Wx,"paramCase");function zx(s){return am(s).replace(/-/g,"_").replace(/.[A-Z]+/g,n=>n[0]+"_"+n.slice(1).toLowerCase())}bt(zx,"snakeCase");function e0(s){return s.replace(/\/$/,"")}bt(e0,"trimSlash");function jx(s){return s.startsWith("/")||(s="/"+s),e0(s)}bt(jx,"sanitize");var dS;(s=>{s.millisecond=1,s.second=1e3,s.minute=s.second*60,s.hour=s.minute*60,s.day=s.hour*24,s.week=s.day*7;let n=new Date().getTimezoneOffset();function i(b){n=b}s.setTimezoneOffset=i,bt(i,"setTimezoneOffset");function o(){return n}s.getTimezoneOffset=o,bt(o,"getTimezoneOffset");function l(b=new Date,T){return typeof b=="number"&&(b=new Date(b)),T===void 0&&(T=n),Math.floor((b.valueOf()/s.minute-T)/1440)}s.getDateNumber=l,bt(l,"getDateNumber");function h(b,T){const y=new Date(b*s.day);return T===void 0&&(T=n),new Date(+y+T*s.minute)}s.fromDateNumber=h,bt(h,"fromDateNumber");const f=/\d+(?:\.\d+)?/.source,u=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(b=>`(${f}${b})?`).join("")}$`);function p(b){const T=u.exec(b);return T?(parseFloat(T[1])*s.week||0)+(parseFloat(T[2])*s.day||0)+(parseFloat(T[3])*s.hour||0)+(parseFloat(T[4])*s.minute||0)+(parseFloat(T[5])*s.second||0):0}s.parseTime=p,bt(p,"parseTime");function c(b){const T=p(b);return T?b=Date.now()+T:/^\d{1,2}(:\d{1,2}){1,2}$/.test(b)?b=`${new Date().toLocaleDateString()}-${b}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(b)&&(b=`${new Date().getFullYear()}-${b}`),b?new Date(b):new Date}s.parseDate=c,bt(c,"parseDate");function _(b){const T=Math.abs(b);return T>=s.day-s.hour/2?Math.round(b/s.day)+"d":T>=s.hour-s.minute/2?Math.round(b/s.hour)+"h":T>=s.minute-s.second/2?Math.round(b/s.minute)+"m":T>=s.second?Math.round(b/s.second)+"s":b+"ms"}s.format=_,bt(_,"format");function m(b,T=2){return b.toString().padStart(T,"0")}s.toDigits=m,bt(m,"toDigits");function E(b,T=new Date){return b.replace("yyyy",T.getFullYear().toString()).replace("yy",T.getFullYear().toString().slice(2)).replace("MM",m(T.getMonth()+1)).replace("dd",m(T.getDate())).replace("hh",m(T.getHours())).replace("mm",m(T.getMinutes())).replace("ss",m(T.getSeconds())).replace("SSS",m(T.getMilliseconds(),3))}s.template=E,bt(E,"template")})(dS||(dS={}));const Xx=`ctx.database.extend("blockly_key_value",{
    key: "string",
    value: "string",
},{
  primary: "key"
})
`,Kx=`const logger = ctx.logger("{{name}}")
`,Yx=`const plugin_id = "{{plugin_id}}"
`,qx={key_value_initialize:Xx,logger_initialize:Kx,plugin_id:Yx};function Jx(s,n="",i=[],o=""){return[...Object.entries(s)].map(([l,h])=>`import { ${h.join(", ")} } from "${l}"
`).join("")+Rx.replace(/\{\{name}}/g,n.replace(/"/g,'\\"').replace(/\\/g,"\\\\")).replace(/\{\{using}}/g,JSON.stringify(i)).replace(/\{\{apply}}/g,o.split(`
`).map(l=>"  "+l).join(`
`))}function Zx(s,n,i){let o={};const l=i.getAllBlocks(false);l.filter(f=>f.imports).map(f=>f.imports).forEach(f=>{[...Object.entries(f)].forEach(([u,p])=>{o[u]||(o[u]=[]),o[u]=om([...o[u],...p])})});const h=[];return l.filter(f=>f.template).map(f=>f.template).forEach(f=>{f.forEach(u=>{h.includes(u)||h.push(u)})}),Jx(o,s,[],h.map(f=>qx[f]+`
`).map(f=>f.replace("{{name}}",s).replace("{{plugin_id}}",n)).join("")+ue.javascriptGenerator.workspaceToCode(i))}var xu={exports:{}},fp,_S;function hh(){if(_S)return fp;_S=1;const s="2.0.0",n=256,i=Number.MAX_SAFE_INTEGER||9007199254740991;return fp={MAX_LENGTH:n,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_INTEGER:i,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:s,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},fp}var mp,pS;function dh(){return pS||(pS=1,mp=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{}),mp}var gS;function _c(){return gS||(gS=1,function(s,n){const{MAX_SAFE_COMPONENT_LENGTH:i}=hh(),o=dh();n=s.exports={};const l=n.re=[],h=n.src=[],f=n.t={};let u=0;const p=(c,_,m)=>{const E=u++;o(c,E,_),f[c]=E,h[E]=_,l[E]=new RegExp(_,m?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","[0-9]+"),p("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),p("MAINVERSION",`(${h[f.NUMERICIDENTIFIER]})\\.(${h[f.NUMERICIDENTIFIER]})\\.(${h[f.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${h[f.NUMERICIDENTIFIERLOOSE]})\\.(${h[f.NUMERICIDENTIFIERLOOSE]})\\.(${h[f.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${h[f.NUMERICIDENTIFIER]}|${h[f.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${h[f.NUMERICIDENTIFIERLOOSE]}|${h[f.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${h[f.PRERELEASEIDENTIFIER]}(?:\\.${h[f.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${h[f.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${h[f.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER","[0-9A-Za-z-]+"),p("BUILD",`(?:\\+(${h[f.BUILDIDENTIFIER]}(?:\\.${h[f.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${h[f.MAINVERSION]}${h[f.PRERELEASE]}?${h[f.BUILD]}?`),p("FULL",`^${h[f.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${h[f.MAINVERSIONLOOSE]}${h[f.PRERELEASELOOSE]}?${h[f.BUILD]}?`),p("LOOSE",`^${h[f.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${h[f.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${h[f.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${h[f.XRANGEIDENTIFIER]})(?:\\.(${h[f.XRANGEIDENTIFIER]})(?:\\.(${h[f.XRANGEIDENTIFIER]})(?:${h[f.PRERELEASE]})?${h[f.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${h[f.XRANGEIDENTIFIERLOOSE]})(?:\\.(${h[f.XRANGEIDENTIFIERLOOSE]})(?:\\.(${h[f.XRANGEIDENTIFIERLOOSE]})(?:${h[f.PRERELEASELOOSE]})?${h[f.BUILD]}?)?)?`),p("XRANGE",`^${h[f.GTLT]}\\s*${h[f.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${h[f.GTLT]}\\s*${h[f.XRANGEPLAINLOOSE]}$`),p("COERCE",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?(?:$|[^\\d])`),p("COERCERTL",h[f.COERCE],true),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${h[f.LONETILDE]}\\s+`,true),n.tildeTrimReplace="$1~",p("TILDE",`^${h[f.LONETILDE]}${h[f.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${h[f.LONETILDE]}${h[f.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${h[f.LONECARET]}\\s+`,true),n.caretTrimReplace="$1^",p("CARET",`^${h[f.LONECARET]}${h[f.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${h[f.LONECARET]}${h[f.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${h[f.GTLT]}\\s*(${h[f.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${h[f.GTLT]}\\s*(${h[f.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${h[f.GTLT]}\\s*(${h[f.LOOSEPLAIN]}|${h[f.XRANGEPLAIN]})`,true),n.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${h[f.XRANGEPLAIN]})\\s+-\\s+(${h[f.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${h[f.XRANGEPLAINLOOSE]})\\s+-\\s+(${h[f.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(xu,xu.exports)),xu.exports}var Ep,fS;function lm(){if(fS)return Ep;fS=1;const s=Object.freeze({loose:true}),n=Object.freeze({});return Ep=o=>o?typeof o!="object"?s:o:n,Ep}var bp,mS;function t0(){if(mS)return bp;mS=1;const s=/^[0-9]+$/,n=(o,l)=>{const h=s.test(o),f=s.test(l);return h&&f&&(o=+o,l=+l),o===l?0:h&&!f?-1:f&&!h?1:o<l?-1:1};return bp={compareIdentifiers:n,rcompareIdentifiers:(o,l)=>n(l,o)},bp}const Qx={},eB=Object.freeze(Object.defineProperty({__proto__:null,default:Qx},Symbol.toStringTag,{value:"Module"})),tB=nM(eB);var vp,ES;function zs(){if(ES)return vp;ES=1;const s=dh(),{MAX_LENGTH:n,MAX_SAFE_INTEGER:i}=hh(),{re:o,t:l}=_c(),h=lm(),{compareIdentifiers:f}=t0();class u{constructor(c,_){if(_=h(_),c instanceof u){if(c.loose===!!_.loose&&c.includePrerelease===!!_.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid Version: ${tB.inspect(c)}`);if(c.length>n)throw new TypeError(`version is longer than ${n} characters`);s("SemVer",c,_),this.options=_,this.loose=!!_.loose,this.includePrerelease=!!_.includePrerelease;const m=c.trim().match(_.loose?o[l.LOOSE]:o[l.FULL]);if(!m)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+m[1],this.minor=+m[2],this.patch=+m[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");m[4]?this.prerelease=m[4].split(".").map(E=>{if(/^[0-9]+$/.test(E)){const b=+E;if(b>=0&&b<i)return b}return E}):this.prerelease=[],this.build=m[5]?m[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(s("SemVer.compare",this.version,this.options,c),!(c instanceof u)){if(typeof c=="string"&&c===this.version)return 0;c=new u(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof u||(c=new u(c,this.options)),f(this.major,c.major)||f(this.minor,c.minor)||f(this.patch,c.patch)}comparePre(c){if(c instanceof u||(c=new u(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let _=0;do{const m=this.prerelease[_],E=c.prerelease[_];if(s("prerelease compare",_,m,E),m===void 0&&E===void 0)return 0;if(E===void 0)return 1;if(m===void 0)return-1;if(m===E)continue;return f(m,E)}while(++_)}compareBuild(c){c instanceof u||(c=new u(c,this.options));let _=0;do{const m=this.build[_],E=c.build[_];if(s("prerelease compare",_,m,E),m===void 0&&E===void 0)return 0;if(E===void 0)return 1;if(m===void 0)return-1;if(m===E)continue;return f(m,E)}while(++_)}inc(c,_,m){switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",_,m);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",_,m);break;case"prepatch":this.prerelease.length=0,this.inc("patch",_,m),this.inc("pre",_,m);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",_,m),this.inc("pre",_,m);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const E=Number(m)?1:0;if(!_&&m===false)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[E];else{let b=this.prerelease.length;for(;--b>=0;)typeof this.prerelease[b]=="number"&&(this.prerelease[b]++,b=-2);if(b===-1){if(_===this.prerelease.join(".")&&m===false)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(E)}}if(_){let b=[_,E];m===false&&(b=[_]),f(this.prerelease[0],_)===0?isNaN(this.prerelease[1])&&(this.prerelease=b):this.prerelease=b}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.format(),this.raw=this.version,this}}return vp=u,vp}var Tp,bS;function Ca(){if(bS)return Tp;bS=1;const s=zs();return Tp=(i,o,l=false)=>{if(i instanceof s)return i;try{return new s(i,o)}catch(h){if(!l)return null;throw h}},Tp}var Sp,vS;function sB(){if(vS)return Sp;vS=1;const s=Ca();return Sp=(i,o)=>{const l=s(i,o);return l?l.version:null},Sp}var $p,TS;function iB(){if(TS)return $p;TS=1;const s=Ca();return $p=(i,o)=>{const l=s(i.trim().replace(/^[=v]+/,""),o);return l?l.version:null},$p}var yp,SS;function nB(){if(SS)return yp;SS=1;const s=zs();return yp=(i,o,l,h,f)=>{typeof l=="string"&&(f=h,h=l,l=void 0);try{return new s(i instanceof s?i.version:i,l).inc(o,h,f).version}catch{return null}},yp}var Rp,$S;function rB(){if($S)return Rp;$S=1;const s=Ca();return Rp=(i,o)=>{const l=s(i,null,true),h=s(o,null,true),f=l.compare(h);if(f===0)return null;const u=f>0,p=u?l:h,c=u?h:l,_=!!p.prerelease.length,m=_?"pre":"";return l.major!==h.major?m+"major":l.minor!==h.minor?m+"minor":l.patch!==h.patch?m+"patch":_?"prerelease":c.patch?"patch":c.minor?"minor":"major"},Rp}var Ip,yS;function oB(){if(yS)return Ip;yS=1;const s=zs();return Ip=(i,o)=>new s(i,o).major,Ip}var Cp,RS;function aB(){if(RS)return Cp;RS=1;const s=zs();return Cp=(i,o)=>new s(i,o).minor,Cp}var Op,IS;function lB(){if(IS)return Op;IS=1;const s=zs();return Op=(i,o)=>new s(i,o).patch,Op}var wp,CS;function cB(){if(CS)return wp;CS=1;const s=Ca();return wp=(i,o)=>{const l=s(i,o);return l&&l.prerelease.length?l.prerelease:null},wp}var kp,OS;function sn(){if(OS)return kp;OS=1;const s=zs();return kp=(i,o,l)=>new s(i,l).compare(new s(o,l)),kp}var Ap,wS;function uB(){if(wS)return Ap;wS=1;const s=sn();return Ap=(i,o,l)=>s(o,i,l),Ap}var Lp,kS;function hB(){if(kS)return Lp;kS=1;const s=sn();return Lp=(i,o)=>s(i,o,true),Lp}var Np,AS;function cm(){if(AS)return Np;AS=1;const s=zs();return Np=(i,o,l)=>{const h=new s(i,l),f=new s(o,l);return h.compare(f)||h.compareBuild(f)},Np}var Mp,LS;function dB(){if(LS)return Mp;LS=1;const s=cm();return Mp=(i,o)=>i.sort((l,h)=>s(l,h,o)),Mp}var Dp,NS;function _B(){if(NS)return Dp;NS=1;const s=cm();return Dp=(i,o)=>i.sort((l,h)=>s(h,l,o)),Dp}var xp,MS;function _h(){if(MS)return xp;MS=1;const s=sn();return xp=(i,o,l)=>s(i,o,l)>0,xp}var Bp,DS;function um(){if(DS)return Bp;DS=1;const s=sn();return Bp=(i,o,l)=>s(i,o,l)<0,Bp}var Pp,xS;function s0(){if(xS)return Pp;xS=1;const s=sn();return Pp=(i,o,l)=>s(i,o,l)===0,Pp}var Up,BS;function i0(){if(BS)return Up;BS=1;const s=sn();return Up=(i,o,l)=>s(i,o,l)!==0,Up}var Fp,PS;function hm(){if(PS)return Fp;PS=1;const s=sn();return Fp=(i,o,l)=>s(i,o,l)>=0,Fp}var Gp,US;function dm(){if(US)return Gp;US=1;const s=sn();return Gp=(i,o,l)=>s(i,o,l)<=0,Gp}var Hp,FS;function n0(){if(FS)return Hp;FS=1;const s=s0(),n=i0(),i=_h(),o=hm(),l=um(),h=dm();return Hp=(u,p,c,_)=>{switch(p){case"===":return typeof u=="object"&&(u=u.version),typeof c=="object"&&(c=c.version),u===c;case"!==":return typeof u=="object"&&(u=u.version),typeof c=="object"&&(c=c.version),u!==c;case"":case"=":case"==":return s(u,c,_);case"!=":return n(u,c,_);case">":return i(u,c,_);case">=":return o(u,c,_);case"<":return l(u,c,_);case"<=":return h(u,c,_);default:throw new TypeError(`Invalid operator: ${p}`)}},Hp}var Vp,GS;function pB(){if(GS)return Vp;GS=1;const s=zs(),n=Ca(),{re:i,t:o}=_c();return Vp=(h,f)=>{if(h instanceof s)return h;if(typeof h=="number"&&(h=String(h)),typeof h!="string")return null;f=f||{};let u=null;if(!f.rtl)u=h.match(i[o.COERCE]);else{let p;for(;(p=i[o.COERCERTL].exec(h))&&(!u||u.index+u[0].length!==h.length);)(!u||p.index+p[0].length!==u.index+u[0].length)&&(u=p),i[o.COERCERTL].lastIndex=p.index+p[1].length+p[2].length;i[o.COERCERTL].lastIndex=-1}return u===null?null:n(`${u[2]}.${u[3]||"0"}.${u[4]||"0"}`,f)},Vp}var Wp,HS;function gB(){return HS||(HS=1,Wp=function(s){s.prototype[Symbol.iterator]=function*(){for(let n=this.head;n;n=n.next)yield n.value}}),Wp}var zp,VS;function fB(){if(VS)return zp;VS=1,zp=s,s.Node=l,s.create=s;function s(h){var f=this;if(f instanceof s||(f=new s),f.tail=null,f.head=null,f.length=0,h&&typeof h.forEach=="function")h.forEach(function(c){f.push(c)});else if(arguments.length>0)for(var u=0,p=arguments.length;u<p;u++)f.push(arguments[u]);return f}s.prototype.removeNode=function(h){if(h.list!==this)throw new Error("removing node which does not belong to this list");var f=h.next,u=h.prev;return f&&(f.prev=u),u&&(u.next=f),h===this.head&&(this.head=f),h===this.tail&&(this.tail=u),h.list.length--,h.next=null,h.prev=null,h.list=null,f},s.prototype.unshiftNode=function(h){if(h!==this.head){h.list&&h.list.removeNode(h);var f=this.head;h.list=this,h.next=f,f&&(f.prev=h),this.head=h,this.tail||(this.tail=h),this.length++}},s.prototype.pushNode=function(h){if(h!==this.tail){h.list&&h.list.removeNode(h);var f=this.tail;h.list=this,h.prev=f,f&&(f.next=h),this.tail=h,this.head||(this.head=h),this.length++}},s.prototype.push=function(){for(var h=0,f=arguments.length;h<f;h++)i(this,arguments[h]);return this.length},s.prototype.unshift=function(){for(var h=0,f=arguments.length;h<f;h++)o(this,arguments[h]);return this.length},s.prototype.pop=function(){if(this.tail){var h=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,h}},s.prototype.shift=function(){if(this.head){var h=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,h}},s.prototype.forEach=function(h,f){f=f||this;for(var u=this.head,p=0;u!==null;p++)h.call(f,u.value,p,this),u=u.next},s.prototype.forEachReverse=function(h,f){f=f||this;for(var u=this.tail,p=this.length-1;u!==null;p--)h.call(f,u.value,p,this),u=u.prev},s.prototype.get=function(h){for(var f=0,u=this.head;u!==null&&f<h;f++)u=u.next;if(f===h&&u!==null)return u.value},s.prototype.getReverse=function(h){for(var f=0,u=this.tail;u!==null&&f<h;f++)u=u.prev;if(f===h&&u!==null)return u.value},s.prototype.map=function(h,f){f=f||this;for(var u=new s,p=this.head;p!==null;)u.push(h.call(f,p.value,this)),p=p.next;return u},s.prototype.mapReverse=function(h,f){f=f||this;for(var u=new s,p=this.tail;p!==null;)u.push(h.call(f,p.value,this)),p=p.prev;return u},s.prototype.reduce=function(h,f){var u,p=this.head;if(arguments.length>1)u=f;else if(this.head)p=this.head.next,u=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var c=0;p!==null;c++)u=h(u,p.value,c),p=p.next;return u},s.prototype.reduceReverse=function(h,f){var u,p=this.tail;if(arguments.length>1)u=f;else if(this.tail)p=this.tail.prev,u=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var c=this.length-1;p!==null;c--)u=h(u,p.value,c),p=p.prev;return u},s.prototype.toArray=function(){for(var h=new Array(this.length),f=0,u=this.head;u!==null;f++)h[f]=u.value,u=u.next;return h},s.prototype.toArrayReverse=function(){for(var h=new Array(this.length),f=0,u=this.tail;u!==null;f++)h[f]=u.value,u=u.prev;return h},s.prototype.slice=function(h,f){f=f||this.length,f<0&&(f+=this.length),h=h||0,h<0&&(h+=this.length);var u=new s;if(f<h||f<0)return u;h<0&&(h=0),f>this.length&&(f=this.length);for(var p=0,c=this.head;c!==null&&p<h;p++)c=c.next;for(;c!==null&&p<f;p++,c=c.next)u.push(c.value);return u},s.prototype.sliceReverse=function(h,f){f=f||this.length,f<0&&(f+=this.length),h=h||0,h<0&&(h+=this.length);var u=new s;if(f<h||f<0)return u;h<0&&(h=0),f>this.length&&(f=this.length);for(var p=this.length,c=this.tail;c!==null&&p>f;p--)c=c.prev;for(;c!==null&&p>h;p--,c=c.prev)u.push(c.value);return u},s.prototype.splice=function(h,f,...u){h>this.length&&(h=this.length-1),h<0&&(h=this.length+h);for(var p=0,c=this.head;c!==null&&p<h;p++)c=c.next;for(var _=[],p=0;c&&p<f;p++)_.push(c.value),c=this.removeNode(c);c===null&&(c=this.tail),c!==this.head&&c!==this.tail&&(c=c.prev);for(var p=0;p<u.length;p++)c=n(this,c,u[p]);return _},s.prototype.reverse=function(){for(var h=this.head,f=this.tail,u=h;u!==null;u=u.prev){var p=u.prev;u.prev=u.next,u.next=p}return this.head=f,this.tail=h,this};function n(h,f,u){var p=f===h.head?new l(u,null,f,h):new l(u,f,f.next,h);return p.next===null&&(h.tail=p),p.prev===null&&(h.head=p),h.length++,p}function i(h,f){h.tail=new l(f,h.tail,null,h),h.head||(h.head=h.tail),h.length++}function o(h,f){h.head=new l(f,null,h.head,h),h.tail||(h.tail=h.head),h.length++}function l(h,f,u,p){if(!(this instanceof l))return new l(h,f,u,p);this.list=p,this.value=h,f?(f.next=this,this.prev=f):this.prev=null,u?(u.prev=this,this.next=u):this.next=null}try{gB()(s)}catch{}return zp}var jp,WS;function mB(){if(WS)return jp;WS=1;const s=fB(),n=Symbol("max"),i=Symbol("length"),o=Symbol("lengthCalculator"),l=Symbol("allowStale"),h=Symbol("maxAge"),f=Symbol("dispose"),u=Symbol("noDisposeOnSet"),p=Symbol("lruList"),c=Symbol("cache"),_=Symbol("updateAgeOnGet"),m=()=>1;class E{constructor(S){if(typeof S=="number"&&(S={max:S}),S||(S={}),S.max&&(typeof S.max!="number"||S.max<0))throw new TypeError("max must be a non-negative number");this[n]=S.max||1/0;const O=S.length||m;if(this[o]=typeof O!="function"?m:O,this[l]=S.stale||false,S.maxAge&&typeof S.maxAge!="number")throw new TypeError("maxAge must be a number");this[h]=S.maxAge||0,this[f]=S.dispose,this[u]=S.noDisposeOnSet||false,this[_]=S.updateAgeOnGet||false,this.reset()}set max(S){if(typeof S!="number"||S<0)throw new TypeError("max must be a non-negative number");this[n]=S||1/0,y(this)}get max(){return this[n]}set allowStale(S){this[l]=!!S}get allowStale(){return this[l]}set maxAge(S){if(typeof S!="number")throw new TypeError("maxAge must be a non-negative number");this[h]=S,y(this)}get maxAge(){return this[h]}set lengthCalculator(S){typeof S!="function"&&(S=m),S!==this[o]&&(this[o]=S,this[i]=0,this[p].forEach(O=>{O.length=this[o](O.value,O.key),this[i]+=O.length})),y(this)}get lengthCalculator(){return this[o]}get length(){return this[i]}get itemCount(){return this[p].length}rforEach(S,O){O=O||this;for(let w=this[p].tail;w!==null;){const A=w.prev;R(this,S,w,O),w=A}}forEach(S,O){O=O||this;for(let w=this[p].head;w!==null;){const A=w.next;R(this,S,w,O),w=A}}keys(){return this[p].toArray().map(S=>S.key)}values(){return this[p].toArray().map(S=>S.value)}reset(){this[f]&&this[p]&&this[p].length&&this[p].forEach(S=>this[f](S.key,S.value)),this[c]=new Map,this[p]=new s,this[i]=0}dump(){return this[p].map(S=>T(this,S)?false:{k:S.key,v:S.value,e:S.now+(S.maxAge||0)}).toArray().filter(S=>S)}dumpLru(){return this[p]}set(S,O,w){if(w=w||this[h],w&&typeof w!="number")throw new TypeError("maxAge must be a number");const A=w?Date.now():0,I=this[o](O,S);if(this[c].has(S)){if(I>this[n])return g(this,this[c].get(S)),false;const B=this[c].get(S).value;return this[f]&&(this[u]||this[f](S,B.value)),B.now=A,B.maxAge=w,B.value=O,this[i]+=I-B.length,B.length=I,this.get(S),y(this),true}const L=new $(S,O,I,A,w);return L.length>this[n]?(this[f]&&this[f](S,O),false):(this[i]+=L.length,this[p].unshift(L),this[c].set(S,this[p].head),y(this),true)}has(S){if(!this[c].has(S))return false;const O=this[c].get(S).value;return!T(this,O)}get(S){return b(this,S,true)}peek(S){return b(this,S,false)}pop(){const S=this[p].tail;return S?(g(this,S),S.value):null}del(S){g(this,this[c].get(S))}load(S){this.reset();const O=Date.now();for(let w=S.length-1;w>=0;w--){const A=S[w],I=A.e||0;if(I===0)this.set(A.k,A.v);else{const L=I-O;L>0&&this.set(A.k,A.v,L)}}}prune(){this[c].forEach((S,O)=>b(this,O,false))}}const b=(v,S,O)=>{const w=v[c].get(S);if(w){const A=w.value;if(T(v,A)){if(g(v,w),!v[l])return}else O&&(v[_]&&(w.value.now=Date.now()),v[p].unshiftNode(w));return A.value}},T=(v,S)=>{if(!S||!S.maxAge&&!v[h])return false;const O=Date.now()-S.now;return S.maxAge?O>S.maxAge:v[h]&&O>v[h]},y=v=>{if(v[i]>v[n])for(let S=v[p].tail;v[i]>v[n]&&S!==null;){const O=S.prev;g(v,S),S=O}},g=(v,S)=>{if(S){const O=S.value;v[f]&&v[f](O.key,O.value),v[i]-=O.length,v[c].delete(O.key),v[p].removeNode(S)}};class ${constructor(S,O,w,A,I){this.key=S,this.value=O,this.length=w,this.now=A,this.maxAge=I||0}}const R=(v,S,O,w)=>{let A=O.value;T(v,A)&&(g(v,O),v[l]||(A=void 0)),A&&S.call(w,A.value,A.key,v)};return jp=E,jp}var Xp,zS;function nn(){if(zS)return Xp;zS=1;class s{constructor(X,Z){if(Z=o(Z),X instanceof s)return X.loose===!!Z.loose&&X.includePrerelease===!!Z.includePrerelease?X:new s(X.raw,Z);if(X instanceof l)return this.raw=X.value,this.set=[[X]],this.format(),this;if(this.options=Z,this.loose=!!Z.loose,this.includePrerelease=!!Z.includePrerelease,this.raw=X,this.set=X.split("||").map(J=>this.parseRange(J.trim())).filter(J=>J.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${X}`);if(this.set.length>1){const J=this.set[0];if(this.set=this.set.filter(D=>!T(D[0])),this.set.length===0)this.set=[J];else if(this.set.length>1){for(const D of this.set)if(D.length===1&&y(D[0])){this.set=[D];break}}}this.format()}format(){return this.range=this.set.map(X=>X.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(X){X=X.trim();const J=((this.options.includePrerelease&&E)|(this.options.loose&&b))+":"+X,D=i.get(J);if(D)return D;const P=this.options.loose,V=P?u[p.HYPHENRANGELOOSE]:u[p.HYPHENRANGE];X=X.replace(V,B(this.options.includePrerelease)),h("hyphen replace",X),X=X.replace(u[p.COMPARATORTRIM],c),h("comparator trim",X),X=X.replace(u[p.TILDETRIM],_),X=X.replace(u[p.CARETTRIM],m),X=X.split(/\s+/).join(" ");let j=X.split(" ").map(de=>$(de,this.options)).join(" ").split(/\s+/).map(de=>x(de,this.options));P&&(j=j.filter(de=>(h("loose invalid filter",de,this.options),!!de.match(u[p.COMPARATORLOOSE])))),h("range list",j);const re=new Map,G=j.map(de=>new l(de,this.options));for(const de of G){if(T(de))return[de];re.set(de.value,de)}re.size>1&&re.has("")&&re.delete("");const ae=[...re.values()];return i.set(J,ae),ae}intersects(X,Z){if(!(X instanceof s))throw new TypeError("a Range is required");return this.set.some(J=>g(J,Z)&&X.set.some(D=>g(D,Z)&&J.every(P=>D.every(V=>P.intersects(V,Z)))))}test(X){if(!X)return false;if(typeof X=="string")try{X=new f(X,this.options)}catch{return false}for(let Z=0;Z<this.set.length;Z++)if(H(this.set[Z],X,this.options))return true;return false}}Xp=s;const n=mB(),i=new n({max:1e3}),o=lm(),l=ph(),h=dh(),f=zs(),{re:u,t:p,comparatorTrimReplace:c,tildeTrimReplace:_,caretTrimReplace:m}=_c(),{FLAG_INCLUDE_PRERELEASE:E,FLAG_LOOSE:b}=hh(),T=F=>F.value==="<0.0.0-0",y=F=>F.value==="",g=(F,X)=>{let Z=true;const J=F.slice();let D=J.pop();for(;Z&&J.length;)Z=J.every(P=>D.intersects(P,X)),D=J.pop();return Z},$=(F,X)=>(h("comp",F,X),F=O(F,X),h("caret",F),F=v(F,X),h("tildes",F),F=A(F,X),h("xrange",F),F=L(F,X),h("stars",F),F),R=F=>!F||F.toLowerCase()==="x"||F==="*",v=(F,X)=>F.trim().split(/\s+/).map(Z=>S(Z,X)).join(" "),S=(F,X)=>{const Z=X.loose?u[p.TILDELOOSE]:u[p.TILDE];return F.replace(Z,(J,D,P,V,j)=>{h("tilde",F,J,D,P,V,j);let re;return R(D)?re="":R(P)?re=`>=${D}.0.0 <${+D+1}.0.0-0`:R(V)?re=`>=${D}.${P}.0 <${D}.${+P+1}.0-0`:j?(h("replaceTilde pr",j),re=`>=${D}.${P}.${V}-${j} <${D}.${+P+1}.0-0`):re=`>=${D}.${P}.${V} <${D}.${+P+1}.0-0`,h("tilde return",re),re})},O=(F,X)=>F.trim().split(/\s+/).map(Z=>w(Z,X)).join(" "),w=(F,X)=>{h("caret",F,X);const Z=X.loose?u[p.CARETLOOSE]:u[p.CARET],J=X.includePrerelease?"-0":"";return F.replace(Z,(D,P,V,j,re)=>{h("caret",F,D,P,V,j,re);let G;return R(P)?G="":R(V)?G=`>=${P}.0.0${J} <${+P+1}.0.0-0`:R(j)?P==="0"?G=`>=${P}.${V}.0${J} <${P}.${+V+1}.0-0`:G=`>=${P}.${V}.0${J} <${+P+1}.0.0-0`:re?(h("replaceCaret pr",re),P==="0"?V==="0"?G=`>=${P}.${V}.${j}-${re} <${P}.${V}.${+j+1}-0`:G=`>=${P}.${V}.${j}-${re} <${P}.${+V+1}.0-0`:G=`>=${P}.${V}.${j}-${re} <${+P+1}.0.0-0`):(h("no pr"),P==="0"?V==="0"?G=`>=${P}.${V}.${j}${J} <${P}.${V}.${+j+1}-0`:G=`>=${P}.${V}.${j}${J} <${P}.${+V+1}.0-0`:G=`>=${P}.${V}.${j} <${+P+1}.0.0-0`),h("caret return",G),G})},A=(F,X)=>(h("replaceXRanges",F,X),F.split(/\s+/).map(Z=>I(Z,X)).join(" ")),I=(F,X)=>{F=F.trim();const Z=X.loose?u[p.XRANGELOOSE]:u[p.XRANGE];return F.replace(Z,(J,D,P,V,j,re)=>{h("xRange",F,J,D,P,V,j,re);const G=R(P),ae=G||R(V),de=ae||R(j),fe=de;return D==="="&&fe&&(D=""),re=X.includePrerelease?"-0":"",G?D===">"||D==="<"?J="<0.0.0-0":J="*":D&&fe?(ae&&(V=0),j=0,D===">"?(D=">=",ae?(P=+P+1,V=0,j=0):(V=+V+1,j=0)):D==="<="&&(D="<",ae?P=+P+1:V=+V+1),D==="<"&&(re="-0"),J=`${D+P}.${V}.${j}${re}`):ae?J=`>=${P}.0.0${re} <${+P+1}.0.0-0`:de&&(J=`>=${P}.${V}.0${re} <${P}.${+V+1}.0-0`),h("xRange return",J),J})},L=(F,X)=>(h("replaceStars",F,X),F.trim().replace(u[p.STAR],"")),x=(F,X)=>(h("replaceGTE0",F,X),F.trim().replace(u[X.includePrerelease?p.GTE0PRE:p.GTE0],"")),B=F=>(X,Z,J,D,P,V,j,re,G,ae,de,fe,ee)=>(R(J)?Z="":R(D)?Z=`>=${J}.0.0${F?"-0":""}`:R(P)?Z=`>=${J}.${D}.0${F?"-0":""}`:V?Z=`>=${Z}`:Z=`>=${Z}${F?"-0":""}`,R(G)?re="":R(ae)?re=`<${+G+1}.0.0-0`:R(de)?re=`<${G}.${+ae+1}.0-0`:fe?re=`<=${G}.${ae}.${de}-${fe}`:F?re=`<${G}.${ae}.${+de+1}-0`:re=`<=${re}`,`${Z} ${re}`.trim()),H=(F,X,Z)=>{for(let J=0;J<F.length;J++)if(!F[J].test(X))return false;if(X.prerelease.length&&!Z.includePrerelease){for(let J=0;J<F.length;J++)if(h(F[J].semver),F[J].semver!==l.ANY&&F[J].semver.prerelease.length>0){const D=F[J].semver;if(D.major===X.major&&D.minor===X.minor&&D.patch===X.patch)return true}return false}return true};return Xp}var Kp,jS;function ph(){if(jS)return Kp;jS=1;const s=Symbol("SemVer ANY");class n{static get ANY(){return s}constructor(_,m){if(m=i(m),_ instanceof n){if(_.loose===!!m.loose)return _;_=_.value}f("comparator",_,m),this.options=m,this.loose=!!m.loose,this.parse(_),this.semver===s?this.value="":this.value=this.operator+this.semver.version,f("comp",this)}parse(_){const m=this.options.loose?o[l.COMPARATORLOOSE]:o[l.COMPARATOR],E=_.match(m);if(!E)throw new TypeError(`Invalid comparator: ${_}`);this.operator=E[1]!==void 0?E[1]:"",this.operator==="="&&(this.operator=""),E[2]?this.semver=new u(E[2],this.options.loose):this.semver=s}toString(){return this.value}test(_){if(f("Comparator.test",_,this.options.loose),this.semver===s||_===s)return true;if(typeof _=="string")try{_=new u(_,this.options)}catch{return false}return h(_,this.operator,this.semver,this.options)}intersects(_,m){if(!(_ instanceof n))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?true:new p(_.value,m).test(this.value):_.operator===""?_.value===""?true:new p(this.value,m).test(_.semver):(m=i(m),m.includePrerelease&&(this.value==="<0.0.0-0"||_.value==="<0.0.0-0")||!m.includePrerelease&&(this.value.startsWith("<0.0.0")||_.value.startsWith("<0.0.0"))?false:!!(this.operator.startsWith(">")&&_.operator.startsWith(">")||this.operator.startsWith("<")&&_.operator.startsWith("<")||this.semver.version===_.semver.version&&this.operator.includes("=")&&_.operator.includes("=")||h(this.semver,"<",_.semver,m)&&this.operator.startsWith(">")&&_.operator.startsWith("<")||h(this.semver,">",_.semver,m)&&this.operator.startsWith("<")&&_.operator.startsWith(">")))}}Kp=n;const i=lm(),{re:o,t:l}=_c(),h=n0(),f=dh(),u=zs(),p=nn();return Kp}var Yp,XS;function gh(){if(XS)return Yp;XS=1;const s=nn();return Yp=(i,o,l)=>{try{o=new s(o,l)}catch{return false}return o.test(i)},Yp}var qp,KS;function EB(){if(KS)return qp;KS=1;const s=nn();return qp=(i,o)=>new s(i,o).set.map(l=>l.map(h=>h.value).join(" ").trim().split(" ")),qp}var Jp,YS;function bB(){if(YS)return Jp;YS=1;const s=zs(),n=nn();return Jp=(o,l,h)=>{let f=null,u=null,p=null;try{p=new n(l,h)}catch{return null}return o.forEach(c=>{p.test(c)&&(!f||u.compare(c)===-1)&&(f=c,u=new s(f,h))}),f},Jp}var Zp,qS;function vB(){if(qS)return Zp;qS=1;const s=zs(),n=nn();return Zp=(o,l,h)=>{let f=null,u=null,p=null;try{p=new n(l,h)}catch{return null}return o.forEach(c=>{p.test(c)&&(!f||u.compare(c)===1)&&(f=c,u=new s(f,h))}),f},Zp}var Qp,JS;function TB(){if(JS)return Qp;JS=1;const s=zs(),n=nn(),i=_h();return Qp=(l,h)=>{l=new n(l,h);let f=new s("0.0.0");if(l.test(f)||(f=new s("0.0.0-0"),l.test(f)))return f;f=null;for(let u=0;u<l.set.length;++u){const p=l.set[u];let c=null;p.forEach(_=>{const m=new s(_.semver.version);switch(_.operator){case">":m.prerelease.length===0?m.patch++:m.prerelease.push(0),m.raw=m.format();case"":case">=":(!c||i(m,c))&&(c=m);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${_.operator}`)}}),c&&(!f||i(f,c))&&(f=c)}return f&&l.test(f)?f:null},Qp}var eg,ZS;function SB(){if(ZS)return eg;ZS=1;const s=nn();return eg=(i,o)=>{try{return new s(i,o).range||"*"}catch{return null}},eg}var tg,QS;function _m(){if(QS)return tg;QS=1;const s=zs(),n=ph(),{ANY:i}=n,o=nn(),l=gh(),h=_h(),f=um(),u=dm(),p=hm();return tg=(_,m,E,b)=>{_=new s(_,b),m=new o(m,b);let T,y,g,$,R;switch(E){case">":T=h,y=u,g=f,$=">",R=">=";break;case"<":T=f,y=p,g=h,$="<",R="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(l(_,m,b))return false;for(let v=0;v<m.set.length;++v){const S=m.set[v];let O=null,w=null;if(S.forEach(A=>{A.semver===i&&(A=new n(">=0.0.0")),O=O||A,w=w||A,T(A.semver,O.semver,b)?O=A:g(A.semver,w.semver,b)&&(w=A)}),O.operator===$||O.operator===R||(!w.operator||w.operator===$)&&y(_,w.semver))return false;if(w.operator===R&&g(_,w.semver))return false}return true},tg}var sg,e$;function $B(){if(e$)return sg;e$=1;const s=_m();return sg=(i,o,l)=>s(i,o,">",l),sg}var ig,t$;function yB(){if(t$)return ig;t$=1;const s=_m();return ig=(i,o,l)=>s(i,o,"<",l),ig}var ng,s$;function RB(){if(s$)return ng;s$=1;const s=nn();return ng=(i,o,l)=>(i=new s(i,l),o=new s(o,l),i.intersects(o,l)),ng}var rg,i$;function IB(){if(i$)return rg;i$=1;const s=gh(),n=sn();return rg=(i,o,l)=>{const h=[];let f=null,u=null;const p=i.sort((E,b)=>n(E,b,l));for(const E of p)s(E,o,l)?(u=E,f||(f=E)):(u&&h.push([f,u]),u=null,f=null);f&&h.push([f,null]);const c=[];for(const[E,b]of h)E===b?c.push(E):!b&&E===p[0]?c.push("*"):b?E===p[0]?c.push(`<=${b}`):c.push(`${E} - ${b}`):c.push(`>=${E}`);const _=c.join(" || "),m=typeof o.raw=="string"?o.raw:String(o);return _.length<m.length?_:o},rg}var og,n$;function CB(){if(n$)return og;n$=1;const s=nn(),n=ph(),{ANY:i}=n,o=gh(),l=sn(),h=(m,E,b={})=>{if(m===E)return true;m=new s(m,b),E=new s(E,b);let T=false;e:for(const y of m.set){for(const g of E.set){const $=p(y,g,b);if(T=T||$!==null,$)continue e}if(T)return false}return true},f=[new n(">=0.0.0-0")],u=[new n(">=0.0.0")],p=(m,E,b)=>{if(m===E)return true;if(m.length===1&&m[0].semver===i){if(E.length===1&&E[0].semver===i)return true;b.includePrerelease?m=f:m=u}if(E.length===1&&E[0].semver===i){if(b.includePrerelease)return true;E=u}const T=new Set;let y,g;for(const I of m)I.operator===">"||I.operator===">="?y=c(y,I,b):I.operator==="<"||I.operator==="<="?g=_(g,I,b):T.add(I.semver);if(T.size>1)return null;let $;if(y&&g){if($=l(y.semver,g.semver,b),$>0)return null;if($===0&&(y.operator!==">="||g.operator!=="<="))return null}for(const I of T){if(y&&!o(I,String(y),b)||g&&!o(I,String(g),b))return null;for(const L of E)if(!o(I,String(L),b))return false;return true}let R,v,S,O,w=g&&!b.includePrerelease&&g.semver.prerelease.length?g.semver:false,A=y&&!b.includePrerelease&&y.semver.prerelease.length?y.semver:false;w&&w.prerelease.length===1&&g.operator==="<"&&w.prerelease[0]===0&&(w=false);for(const I of E){if(O=O||I.operator===">"||I.operator===">=",S=S||I.operator==="<"||I.operator==="<=",y){if(A&&I.semver.prerelease&&I.semver.prerelease.length&&I.semver.major===A.major&&I.semver.minor===A.minor&&I.semver.patch===A.patch&&(A=false),I.operator===">"||I.operator===">="){if(R=c(y,I,b),R===I&&R!==y)return false}else if(y.operator===">="&&!o(y.semver,String(I),b))return false}if(g){if(w&&I.semver.prerelease&&I.semver.prerelease.length&&I.semver.major===w.major&&I.semver.minor===w.minor&&I.semver.patch===w.patch&&(w=false),I.operator==="<"||I.operator==="<="){if(v=_(g,I,b),v===I&&v!==g)return false}else if(g.operator==="<="&&!o(g.semver,String(I),b))return false}if(!I.operator&&(g||y)&&$!==0)return false}return!(y&&S&&!g&&$!==0||g&&O&&!y&&$!==0||A||w)},c=(m,E,b)=>{if(!m)return E;const T=l(m.semver,E.semver,b);return T>0?m:T<0||E.operator===">"&&m.operator===">="?E:m},_=(m,E,b)=>{if(!m)return E;const T=l(m.semver,E.semver,b);return T<0?m:T>0||E.operator==="<"&&m.operator==="<="?E:m};return og=h,og}var ag,r$;function OB(){if(r$)return ag;r$=1;const s=_c(),n=hh(),i=zs(),o=t0(),l=Ca(),h=sB(),f=iB(),u=nB(),p=rB(),c=oB(),_=aB(),m=lB(),E=cB(),b=sn(),T=uB(),y=hB(),g=cm(),$=dB(),R=_B(),v=_h(),S=um(),O=s0(),w=i0(),A=hm(),I=dm(),L=n0(),x=pB(),B=ph(),H=nn(),F=gh(),X=EB(),Z=bB(),J=vB(),D=TB(),P=SB(),V=_m(),j=$B(),re=yB(),G=RB(),ae=IB(),de=CB();return ag={parse:l,valid:h,clean:f,inc:u,diff:p,major:c,minor:_,patch:m,prerelease:E,compare:b,rcompare:T,compareLoose:y,compareBuild:g,sort:$,rsort:R,gt:v,lt:S,eq:O,neq:w,gte:A,lte:I,cmp:L,coerce:x,Comparator:B,Range:H,satisfies:F,toComparators:X,maxSatisfying:Z,minSatisfying:J,minVersion:D,validRange:P,outside:V,gtr:j,ltr:re,intersects:G,simplifyRange:ae,subset:de,SemVer:i,re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:n.SEMVER_SPEC_VERSION,RELEASE_TYPES:n.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers},ag}var lg=OB();const wB=async()=>(await Rn("create-blockly-block")).toString(),r0=async(s,n)=>{s!=null&&await Rn("save-blockly-block",s,{body:n.save()})};async function kB(s,n,i,o,l){if(s==null)return;l.info("\u6B63\u5728\u5F00\u59CB\u7F16\u8BD1.......");let h;try{h=Zx(n,i,o.getWorkspaceSvg())}catch(f){l.error("\u7F16\u8BD1\u65F6\u53D1\u751F\u9519\u8BEF: "+f.toString()),console.error(f);return}return l.info("\u6B63\u5728\u4E0A\u4F20......"),await Rn("save-blockly-block",s,{code:h}),l.success("\u4E0A\u4F20\u6210\u529F"),h}async function AB(s){s!=null&&await Rn("set-blockly-block-state",s,true)}async function LB(s){s!=null&&await Rn("set-blockly-block-state",s,false)}async function NB(s,n){s!=null&&await Rn("rename-blockly-block",s,n)}async function MB(s){s!=null&&await Rn("delete-blockly-block",s)}async function DB(s,n,i,o){if(s!=null)return $x(n,i,o.save())}async function xB(s,n){if(s.length==0)return;const i=yx(s);if(console.info(i),!i)return;if(i.version!=qR){Ml.alert(`\u65E0\u6CD5\u8BFB\u53D6\u8BE5\u63D2\u4EF6: \u8BE5\u63D2\u4EF6\u7684API Major\u7248\u672C(${i.version})\u4E0D\u517C\u5BB9\u5F53\u524D\u7248\u672C`);return}if(i.plugin_version&&lg.cmp(i.plugin_version,">",$f)&&await Ml.confirm(`\u8BE5\u63D2\u4EF6\u662F\u7531\u66F4\u9AD8\u7248\u672C(${i.plugin_version})\u7684Blockly\u63D2\u4EF6\u5BFC\u51FA\u7684\uFF0C\u53EF\u80FD\u65E0\u6CD5\u6B63\u5E38\u5BFC\u5165\u6216\u6267\u884C\u5F02\u5E38\u3002\u5EFA\u8BAE\u5347\u7EA7\u60A8\u7684Blockly\u7248\u672C\u5230\u6700\u65B0\u7248\u672C`,"\u63D0\u793A",{confirmButtonText:"\u7EE7\u7EED",cancelButtonText:"\u53D6\u6D88",type:"warning"})=="cancel"||i.plugin_version&&lg.major(i.plugin_version)!=lg.major($f)&&await Ml.confirm(`\u8BE5\u63D2\u4EF6\u662F\u7531\u4E0D\u540C\u4E3B\u7248\u672C(${i.plugin_version})\u7684Blockly\u63D2\u4EF6\u5BFC\u51FA\u7684\uFF0C\u53EF\u80FD\u65E0\u6CD5\u6B63\u5E38\u5BFC\u5165\u6216\u6267\u884C\u5F02\u5E38\u3002`,"\u63D0\u793A",{confirmButtonText:"\u7EE7\u7EED",cancelButtonText:"\u53D6\u6D88",type:"warning"})=="cancel"||!n&&(i!=null&&i.uuid)&&Yn.blockly.filter(l=>l.uuid==i.uuid).length>0&&await Ml.confirm("\u68C0\u6D4B\u5230\u8BE5\u63D2\u4EF6\u5DF2\u5B58\u5728\uFF0C\u662F\u5426\u8986\u76D6\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"})=="cancel")return;const o=await Rn("create-blockly-block",n?void 0:i.uuid);return await Rn("save-blockly-block",o,{body:i.body,name:i.name}),o.toString()}const BB={class:"create",style:{display:"flex","flex-direction":"row-reverse","padding-right":"10px","padding-top":"10px",height:"48px"}},PB=le("div",{style:{"flex-grow":"1"}},null,-1),UB=le("div",{style:{"font-size":"18px","font-weight":"bold","margin-left":"19px"}}," \u63D2\u4EF6\u5217\u8868 ",-1),FB={class:"list",style:{height:"60%"}},GB={style:{height:"40%",padding:"10px"}},HB={key:0},VB=le("h3",null,"\u64CD\u4F5C",-1),WB=le("br",null,null,-1),zB=le("br",null,null,-1),jB=le("br",null,null,-1),XB=et({__name:"index",props:["blocks","workspace","dialog","current","panel","logger"],emits:["update:dialog","update:current"],setup(s,{emit:n}){const i=s,{panel:o,blocks:l}=i,h=me({get:()=>i.current,set:E=>n("update:current",E)}),f=me({get:()=>i.dialog,set:E=>n("update:dialog",E)}),u=async()=>{if(await r0(h.value,i.workspace),h.value==null)return;const E=Yn.blockly.find(T=>T.id==h.value),b=await kB(h.value,E.name,E.uuid,i.workspace,i.logger.logger);b&&(o.code=b)};async function p(){const E=prompt("\u8F93\u5165\u91CD\u547D\u540D\u7684\u63D2\u4EF6\u540D\u8BCD","\u672A\u547D\u540DKoishi\u63D2\u4EF6");E!=null&&await NB(h.value,E)}async function c(){h.value!=null&&await Ml.confirm("\u786E\u5B9A\u5220\u9664\u5F53\u524D\u63D2\u4EF6?")==="confirm"&&await MB(h.value)}async function _(){if(h.value==null)return;const E=Yn.blockly.find(T=>T.id==h.value),b=await DB(h.value,E.name,E.uuid,i.workspace);b&&(f.value.export=b)}async function m(){n("update:current",await wB())}return(E,b)=>{const T=Ze("el-popover"),y=Ze("el-scrollbar"),g=Ze("k-button");return ie(),Se(xt,null,[le("div",BB,[De(T,{placement:"bottom",trigger:"hover",content:"\u65B0\u5EFA\u63D2\u4EF6"},{reference:We(()=>[le("i",{onClick:m,style:{cursor:"pointer","padding-right":"20px"}},[De(DM)])]),_:1}),De(T,{placement:"bottom",trigger:"hover",content:"\u5BFC\u5165\u4EE3\u7801"},{reference:We(()=>[le("i",{onClick:b[0]||(b[0]=$=>f.value.import=true),style:{cursor:"pointer","padding-right":"20px"}},[De(wM)])]),_:1}),PB,UB]),le("div",FB,[De(y,null,{default:We(()=>[De($w,{data:Object.fromEntries(ge(Yn).blockly.map($=>[$.id,$])),modelValue:h.value,"onUpdate:modelValue":b[1]||(b[1]=$=>h.value=$)},null,8,["data","modelValue"])]),_:1})]),le("div",GB,[h.value?(ie(),Se("div",HB,[VB,De(g,{onClick:b[2]||(b[2]=$=>u())},{default:We(()=>[Dt("\u7F16\u8BD1\u63D2\u4EF6")]),_:1}),WB,De(g,{onClick:b[3]||(b[3]=()=>ge(AB)(h.value))},{default:We(()=>[Dt("\u542F\u7528\u63D2\u4EF6")]),_:1}),De(g,{onClick:b[4]||(b[4]=()=>ge(LB)(h.value))},{default:We(()=>[Dt("\u7981\u7528\u63D2\u4EF6")]),_:1}),zB,De(g,{onClick:b[5]||(b[5]=$=>p())},{default:We(()=>[Dt("\u91CD\u547D\u540D\u63D2\u4EF6")]),_:1}),De(g,{onClick:b[6]||(b[6]=$=>c())},{default:We(()=>[Dt("\u5220\u9664\u63D2\u4EF6")]),_:1}),jB,De(g,{onClick:b[7]||(b[7]=$=>_())},{default:We(()=>[Dt("\u5BFC\u51FA\u63D2\u4EF6")]),_:1})])):ot("",true)])],64)}}});var cg={exports:{}},ug={exports:{}},hg={exports:{}},o$;function KB(){return o$||(o$=1,function(s,n){(function(i,o){s.exports=o()})(Ri,function(){var i=i||{Msg:Object.create(null)};return i.Msg.ADD_COMMENT="Add Comment",i.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",i.Msg.CHANGE_VALUE_TITLE="Change value:",i.Msg.CLEAN_UP="Clean up Blocks",i.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",i.Msg.COLLAPSE_ALL="Collapse Blocks",i.Msg.COLLAPSE_BLOCK="Collapse Block",i.Msg.COLOUR_BLEND_COLOUR1="colour 1",i.Msg.COLOUR_BLEND_COLOUR2="colour 2",i.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",i.Msg.COLOUR_BLEND_RATIO="ratio",i.Msg.COLOUR_BLEND_TITLE="blend",i.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",i.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",i.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",i.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",i.Msg.COLOUR_RANDOM_TITLE="random colour",i.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",i.Msg.COLOUR_RGB_BLUE="blue",i.Msg.COLOUR_RGB_GREEN="green",i.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",i.Msg.COLOUR_RGB_RED="red",i.Msg.COLOUR_RGB_TITLE="colour with",i.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",i.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",i.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",i.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",i.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",i.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",i.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",i.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",i.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",i.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",i.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",i.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",i.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",i.Msg.CONTROLS_IF_MSG_ELSE="else",i.Msg.CONTROLS_IF_MSG_ELSEIF="else if",i.Msg.CONTROLS_IF_MSG_IF="if",i.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",i.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",i.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",i.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",i.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",i.Msg.CONTROLS_REPEAT_INPUT_DO="do",i.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",i.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",i.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",i.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",i.Msg.DELETE_BLOCK="Delete Block",i.Msg.DELETE_VARIABLE="Delete the '%1' variable",i.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",i.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",i.Msg.DIALOG_CANCEL="Cancel",i.Msg.DIALOG_OK="OK",i.Msg.DISABLE_BLOCK="Disable Block",i.Msg.DUPLICATE_BLOCK="Duplicate",i.Msg.DUPLICATE_COMMENT="Duplicate Comment",i.Msg.ENABLE_BLOCK="Enable Block",i.Msg.EXPAND_ALL="Expand Blocks",i.Msg.EXPAND_BLOCK="Expand Block",i.Msg.EXTERNAL_INPUTS="External Inputs",i.Msg.HELP="Help",i.Msg.INLINE_INPUTS="Inline Inputs",i.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",i.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",i.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",i.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",i.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",i.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",i.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",i.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",i.Msg.LISTS_GET_INDEX_FIRST="first",i.Msg.LISTS_GET_INDEX_FROM_END="# from end",i.Msg.LISTS_GET_INDEX_FROM_START="#",i.Msg.LISTS_GET_INDEX_GET="get",i.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",i.Msg.LISTS_GET_INDEX_LAST="last",i.Msg.LISTS_GET_INDEX_RANDOM="random",i.Msg.LISTS_GET_INDEX_REMOVE="remove",i.Msg.LISTS_GET_INDEX_TAIL="",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",i.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",i.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",i.Msg.LISTS_GET_SUBLIST_END_LAST="to last",i.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",i.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",i.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",i.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",i.Msg.LISTS_GET_SUBLIST_TAIL="",i.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",i.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",i.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",i.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",i.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",i.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",i.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",i.Msg.LISTS_INLIST="in list",i.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",i.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",i.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",i.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",i.Msg.LISTS_LENGTH_TITLE="length of %1",i.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",i.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",i.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",i.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",i.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",i.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",i.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",i.Msg.LISTS_SET_INDEX_INPUT_TO="as",i.Msg.LISTS_SET_INDEX_INSERT="insert at",i.Msg.LISTS_SET_INDEX_SET="set",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",i.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",i.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",i.Msg.LISTS_SORT_ORDER_DESCENDING="descending",i.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",i.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",i.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",i.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",i.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",i.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",i.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",i.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",i.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",i.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",i.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",i.Msg.LOGIC_BOOLEAN_FALSE="false",i.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",i.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",i.Msg.LOGIC_BOOLEAN_TRUE="true",i.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",i.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",i.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",i.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",i.Msg.LOGIC_NEGATE_TITLE="not %1",i.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",i.Msg.LOGIC_NULL="null",i.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",i.Msg.LOGIC_NULL_TOOLTIP="Returns null.",i.Msg.LOGIC_OPERATION_AND="and",i.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",i.Msg.LOGIC_OPERATION_OR="or",i.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",i.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",i.Msg.LOGIC_TERNARY_CONDITION="test",i.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",i.Msg.LOGIC_TERNARY_IF_FALSE="if false",i.Msg.LOGIC_TERNARY_IF_TRUE="if true",i.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",i.Msg.MATH_ADDITION_SYMBOL="+",i.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",i.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",i.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",i.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",i.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",i.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",i.Msg.MATH_CHANGE_TITLE="change %1 by %2",i.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",i.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",i.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03C0 (3.141\u2026), e (2.718\u2026), \u03C6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xBD) (0.707\u2026), or \u221E (infinity).",i.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",i.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",i.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",i.Msg.MATH_DIVISION_SYMBOL="\xF7",i.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",i.Msg.MATH_IS_EVEN="is even",i.Msg.MATH_IS_NEGATIVE="is negative",i.Msg.MATH_IS_ODD="is odd",i.Msg.MATH_IS_POSITIVE="is positive",i.Msg.MATH_IS_PRIME="is prime",i.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",i.Msg.MATH_IS_WHOLE="is whole",i.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",i.Msg.MATH_MODULO_TITLE="remainder of %1 \xF7 %2",i.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",i.Msg.MATH_MULTIPLICATION_SYMBOL="\xD7",i.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",i.Msg.MATH_NUMBER_TOOLTIP="A number.",i.Msg.MATH_ONLIST_HELPURL="",i.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",i.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",i.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",i.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",i.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",i.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",i.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",i.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",i.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",i.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",i.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",i.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",i.Msg.MATH_POWER_SYMBOL="^",i.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",i.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",i.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",i.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",i.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",i.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",i.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",i.Msg.MATH_ROUND_OPERATOR_ROUND="round",i.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",i.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",i.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",i.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",i.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",i.Msg.MATH_SINGLE_OP_ROOT="square root",i.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",i.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",i.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",i.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",i.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",i.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",i.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",i.Msg.MATH_SUBTRACTION_SYMBOL="-",i.Msg.MATH_TRIG_ACOS="acos",i.Msg.MATH_TRIG_ASIN="asin",i.Msg.MATH_TRIG_ATAN="atan",i.Msg.MATH_TRIG_COS="cos",i.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",i.Msg.MATH_TRIG_SIN="sin",i.Msg.MATH_TRIG_TAN="tan",i.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",i.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",i.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",i.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",i.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",i.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",i.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",i.Msg.NEW_NUMBER_VARIABLE="Create number variable...",i.Msg.NEW_STRING_VARIABLE="Create string variable...",i.Msg.NEW_VARIABLE="Create variable...",i.Msg.NEW_VARIABLE_TITLE="New variable name:",i.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",i.Msg.ORDINAL_NUMBER_SUFFIX="",i.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",i.Msg.PROCEDURES_BEFORE_PARAMS="with:",i.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",i.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",i.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",i.Msg.PROCEDURES_CREATE_DO="Create '%1'",i.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",i.Msg.PROCEDURES_DEFNORETURN_DO="",i.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",i.Msg.PROCEDURES_DEFNORETURN_TITLE="to",i.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",i.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_DEFRETURN_RETURN="return",i.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",i.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",i.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",i.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",i.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",i.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",i.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",i.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",i.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",i.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",i.Msg.REDO="Redo",i.Msg.REMOVE_COMMENT="Remove Comment",i.Msg.RENAME_VARIABLE="Rename variable...",i.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",i.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_APPEND_TITLE="to %1 append text %2",i.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",i.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",i.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",i.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",i.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",i.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",i.Msg.TEXT_CHARAT_FIRST="get first letter",i.Msg.TEXT_CHARAT_FROM_END="get letter # from end",i.Msg.TEXT_CHARAT_FROM_START="get letter #",i.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",i.Msg.TEXT_CHARAT_LAST="get last letter",i.Msg.TEXT_CHARAT_RANDOM="get random letter",i.Msg.TEXT_CHARAT_TAIL="",i.Msg.TEXT_CHARAT_TITLE="in text %1 %2",i.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",i.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",i.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",i.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",i.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",i.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",i.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",i.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",i.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",i.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",i.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",i.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",i.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",i.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",i.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",i.Msg.TEXT_GET_SUBSTRING_TAIL="",i.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",i.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",i.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",i.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",i.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",i.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",i.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",i.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",i.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",i.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",i.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",i.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",i.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_LENGTH_TITLE="length of %1",i.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",i.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",i.Msg.TEXT_PRINT_TITLE="print %1",i.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",i.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",i.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",i.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",i.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",i.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",i.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",i.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",i.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",i.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",i.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",i.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",i.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",i.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",i.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",i.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",i.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",i.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",i.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",i.Msg.TODAY="Today",i.Msg.UNDO="Undo",i.Msg.UNNAMED_KEY="unnamed",i.Msg.VARIABLES_DEFAULT_NAME="item",i.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",i.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",i.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",i.Msg.VARIABLES_SET="set %1 to %2",i.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",i.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",i.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",i.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",i.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",i.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",i.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",i.Msg.CONTROLS_FOREACH_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_FOR_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=i.Msg.CONTROLS_IF_MSG_ELSEIF,i.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=i.Msg.CONTROLS_IF_MSG_ELSE,i.Msg.CONTROLS_IF_IF_TITLE_IF=i.Msg.CONTROLS_IF_MSG_IF,i.Msg.CONTROLS_IF_MSG_THEN=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.LISTS_CREATE_WITH_ITEM_TITLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.LISTS_GET_INDEX_HELPURL=i.Msg.LISTS_INDEX_OF_HELPURL,i.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.MATH_CHANGE_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.PROCEDURES_DEFRETURN_COMMENT=i.Msg.PROCEDURES_DEFNORETURN_COMMENT,i.Msg.PROCEDURES_DEFRETURN_DO=i.Msg.PROCEDURES_DEFNORETURN_DO,i.Msg.PROCEDURES_DEFRETURN_PROCEDURE=i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,i.Msg.PROCEDURES_DEFRETURN_TITLE=i.Msg.PROCEDURES_DEFNORETURN_TITLE,i.Msg.TEXT_APPEND_VARIABLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.MATH_HUE="230",i.Msg.LOOPS_HUE="120",i.Msg.LISTS_HUE="260",i.Msg.LOGIC_HUE="210",i.Msg.VARIABLES_HUE="330",i.Msg.TEXTS_HUE="160",i.Msg.PROCEDURES_HUE="290",i.Msg.COLOUR_HUE="20",i.Msg.VARIABLES_DYNAMIC_HUE="310",i.Msg})}(hg)),hg.exports}var dg={exports:{}},_g={exports:{}},a$;function YB(){return a$||(a$=1,function(s,n){(function(i,o){s.exports=o(rm())})(Ri,function(i){var o=i.__namespace__,l={};o.module$build$src$core$contextmenu,o.module$build$src$core$extensions,o.module$build$src$core$variables,o.module$build$src$core$utils$xml;var h=o.module$build$src$core$msg.Msg,f=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,u=o.module$build$src$core$common.defineBlocks;l.blocks=f([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]);var p={customContextMenu:function(N){if(this.isInFlyout)(this.type==="variables_get_dynamic"||this.type==="variables_get_reporter_dynamic")&&(U={text:h.RENAME_VARIABLE,enabled:true,callback:c(this)},oe=this.getField("VAR").getText(),oe={text:h.DELETE_VARIABLE.replace("%1",oe),enabled:true,callback:_(this)},N.unshift(U),N.unshift(oe));else{var U=this.getFieldValue("VAR"),q=this.workspace.getVariableById(U).type;if(this.type==="variables_get_dynamic"){U="variables_set_dynamic";var ne=h.VARIABLES_GET_CREATE_SET}else U="variables_get_dynamic",ne=h.VARIABLES_SET_CREATE_GET;var oe={enabled:0<this.workspace.remainingCapacity()};const ut=this.getField("VAR").getText();oe.text=ne.replace("%1",ut),ne=o.module$build$src$core$utils$xml.createElement("field"),ne.setAttribute("name","VAR"),ne.setAttribute("variabletype",q),ne.appendChild(o.module$build$src$core$utils$xml.createTextNode(ut)),q=o.module$build$src$core$utils$xml.createElement("block"),q.setAttribute("type",U),q.appendChild(ne),oe.callback=o.module$build$src$core$contextmenu.callbackFactory(this,q),N.push(oe)}},onchange:function(N){N=this.getFieldValue("VAR"),N=o.module$build$src$core$variables.getVariable(this.workspace,N),this.type==="variables_get_dynamic"?this.outputConnection.setCheck(N.type):this.getInput("VALUE").connection.setCheck(N.type)}},c=function(N){return function(){const U=N.workspace,q=N.getField("VAR").getVariable();o.module$build$src$core$variables.renameVariable(U,q)}},_=function(N){return function(){const U=N.workspace,q=N.getField("VAR").getVariable();U.deleteVariableById(q.getId()),U.refreshToolboxSelection()}};o.module$build$src$core$extensions.registerMixin("contextMenu_variableDynamicSetterGetter",p),u(l.blocks);var m={};o.module$build$src$core$contextmenu,o.module$build$src$core$extensions,o.module$build$src$core$variables,o.module$build$src$core$utils$xml;var E=o.module$build$src$core$msg.Msg,b=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,T=o.module$build$src$core$common.defineBlocks;m.blocks=b([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]);var y={customContextMenu:function(N){if(this.isInFlyout)(this.type==="variables_get"||this.type==="variables_get_reporter")&&(U={text:E.RENAME_VARIABLE,enabled:true,callback:g(this)},ne=this.getField("VAR").getText(),ne={text:E.DELETE_VARIABLE.replace("%1",ne),enabled:true,callback:$(this)},N.unshift(U),N.unshift(ne));else{if(this.type==="variables_get")var U="variables_set",q=E.VARIABLES_GET_CREATE_SET;else U="variables_get",q=E.VARIABLES_SET_CREATE_GET;var ne={enabled:0<this.workspace.remainingCapacity()},oe=this.getField("VAR").getText();ne.text=q.replace("%1",oe),q=o.module$build$src$core$utils$xml.createElement("field"),q.setAttribute("name","VAR"),q.appendChild(o.module$build$src$core$utils$xml.createTextNode(oe)),oe=o.module$build$src$core$utils$xml.createElement("block"),oe.setAttribute("type",U),oe.appendChild(q),ne.callback=o.module$build$src$core$contextmenu.callbackFactory(this,oe),N.push(ne)}}},g=function(N){return function(){const U=N.workspace,q=N.getField("VAR").getVariable();o.module$build$src$core$variables.renameVariable(U,q)}},$=function(N){return function(){const U=N.workspace,q=N.getField("VAR").getVariable();U.deleteVariableById(q.getId()),U.refreshToolboxSelection()}};o.module$build$src$core$extensions.registerMixin("contextMenu_variableSetterGetter",y),T(m.blocks);var R={};o.module$build$src$core$extensions;var v=o.module$build$src$core$msg.Msg;o.module$build$src$core$utils$xml,o.Align$$module$build$src$core$input,o.module$build$src$core$connection_type.ConnectionType;var S=o.module$build$src$core$field_dropdown.FieldDropdown;o.FieldImage$$module$build$src$core$field_image,o.FieldTextInput$$module$build$src$core$field_textinput,o.Mutator$$module$build$src$core$mutator;var O=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,w=o.module$build$src$core$common.defineBlocks;R.blocks=O([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"\xB6"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:false},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:false},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:true,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:true,mutator:"text_charAt_mutator"}]),R.blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[v.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[v.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[v.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[v.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[v.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[v.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(v.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(v.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),v.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(v.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(true),this.setOutput(true,"String"),this.updateAt_(1,true),this.updateAt_(2,true),this.setTooltip(v.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");var U=this.getInput("AT1").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at1",U),U=this.getInput("AT2").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE,N.setAttribute("at2",U),N},domToMutation:function(N){const U=N.getAttribute("at1")==="true";N=N.getAttribute("at2")==="true",this.updateAt_(1,U),this.updateAt_(2,N)},updateAt_:function(N,U){this.removeInput("AT"+N),this.removeInput("ORDINAL"+N,true),U?(this.appendValueInput("AT"+N).setCheck("Number"),v.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+N).appendField(v.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+N),N===2&&v.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",true),this.appendDummyInput("TAIL").appendField(v.TEXT_GET_SUBSTRING_TAIL));const q=new S(this["WHERE_OPTIONS_"+N],function(ne){const oe=ne==="FROM_START"||ne==="FROM_END";if(oe!==U){const ut=this.getSourceBlock();return ut.updateAt_(N,oe),ut.setFieldValue(ne,"WHERE"+N),null}});this.getInput("AT"+N).appendField(q,"WHERE"+N),N===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},R.blocks.text_changeCase={init:function(){const N=[[v.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[v.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[v.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(v.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new S(N),"CASE"),this.setOutput(true,"String"),this.setTooltip(v.TEXT_CHANGECASE_TOOLTIP)}},R.blocks.text_trim={init:function(){const N=[[v.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[v.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[v.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(v.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new S(N),"MODE"),this.setOutput(true,"String"),this.setTooltip(v.TEXT_TRIM_TOOLTIP)}},R.blocks.text_print={init:function(){this.jsonInit({message0:v.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:v.TEXT_PRINT_TOOLTIP,helpUrl:v.TEXT_PRINT_HELPURL})}};var A={updateType_:function(N){this.outputConnection.setCheck(N==="NUMBER"?"Number":"String")},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("type",this.getFieldValue("TYPE")),N},domToMutation:function(N){this.updateType_(N.getAttribute("type"))}};R.blocks.text_prompt_ext=Object.assign({},A,{init:function(){var N=[[v.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[v.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(v.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");const U=this;N=new S(N,function(q){U.updateType_(q)}),this.appendValueInput("TEXT").appendField(N,"TYPE"),this.setOutput(true,"String"),this.setTooltip(function(){return U.getFieldValue("TYPE")==="TEXT"?v.TEXT_PROMPT_TOOLTIP_TEXT:v.TEXT_PROMPT_TOOLTIP_NUMBER})}}),R.blocks.text_prompt=Object.assign({},A,{init:function(){this.mixin(I);var N=[[v.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[v.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];const U=this;this.setHelpUrl(v.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),N=new S(N,function(q){U.updateType_(q)}),this.appendDummyInput().appendField(N,"TYPE").appendField(this.newQuote_(true)).appendField(new o.FieldTextInput$$module$build$src$core$field_textinput(""),"TEXT").appendField(this.newQuote_(false)),this.setOutput(true,"String"),this.setTooltip(function(){return U.getFieldValue("TYPE")==="TEXT"?v.TEXT_PROMPT_TOOLTIP_TEXT:v.TEXT_PROMPT_TOOLTIP_NUMBER})}}),R.blocks.text_count={init:function(){this.jsonInit({message0:v.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:true,style:"text_blocks",tooltip:v.TEXT_COUNT_TOOLTIP,helpUrl:v.TEXT_COUNT_HELPURL})}},R.blocks.text_replace={init:function(){this.jsonInit({message0:v.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:true,style:"text_blocks",tooltip:v.TEXT_REPLACE_TOOLTIP,helpUrl:v.TEXT_REPLACE_HELPURL})}},R.blocks.text_reverse={init:function(){this.jsonInit({message0:v.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:true,style:"text_blocks",tooltip:v.TEXT_REVERSE_TOOLTIP,helpUrl:v.TEXT_REVERSE_HELPURL})}};var I={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(N){for(let U=0,q;q=this.inputList[U];U++)for(let ne=0,oe;oe=q.fieldRow[ne];ne++)if(N===oe.name){q.insertFieldAt(ne,this.newQuote_(true)),q.insertFieldAt(ne+2,this.newQuote_(false));return}console.warn('field named "'+N+'" not found in '+this.toDevString())},newQuote_:function(N){return N=this.RTL?!N:N,new o.FieldImage$$module$build$src$core$field_image(N?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,N?"\u201C":"\u201D")}},L=function(){this.mixin(I),this.quoteField_("TEXT")},x={mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("items",this.itemCount_),N},domToMutation:function(N){this.itemCount_=parseInt(N.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(N){this.itemCount_=N.itemCount,this.updateShape_()},decompose:function(N){const U=N.newBlock("text_create_join_container");U.initSvg();let q=U.getInput("STACK").connection;for(let ne=0;ne<this.itemCount_;ne++){const oe=N.newBlock("text_create_join_item");oe.initSvg(),q.connect(oe.previousConnection),q=oe.nextConnection}return U},compose:function(N){var U=N.getInputTargetBlock("STACK");for(N=[];U;)U.isInsertionMarker()||N.push(U.valueConnection_),U=U.getNextBlock();for(U=0;U<this.itemCount_;U++){const q=this.getInput("ADD"+U).connection.targetConnection;q&&N.indexOf(q)===-1&&q.disconnect()}for(this.itemCount_=N.length,this.updateShape_(),U=0;U<this.itemCount_;U++)o.Mutator$$module$build$src$core$mutator.reconnect(N[U],this,"ADD"+U)},saveConnections:function(N){N=N.getInputTargetBlock("STACK");let U=0;for(;N;){if(N.isInsertionMarker()){N=N.getNextBlock();continue}const q=this.getInput("ADD"+U);N.valueConnection_=q&&q.connection.targetConnection,N=N.getNextBlock(),U++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(true)).appendField(this.newQuote_(false));for(var N=0;N<this.itemCount_;N++)if(!this.getInput("ADD"+N)){const U=this.appendValueInput("ADD"+N).setAlign(o.Align$$module$build$src$core$input.RIGHT);N===0&&U.appendField(v.TEXT_JOIN_TITLE_CREATEWITH)}for(N=this.itemCount_;this.getInput("ADD"+N);N++)this.removeInput("ADD"+N)}},B=function(){this.mixin(I),this.itemCount_=2,this.updateShape_(),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["text_create_join_item"],this))};o.module$build$src$core$extensions.register("text_append_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var H=function(){const N=this;this.setTooltip(function(){return v.TEXT_INDEXOF_TOOLTIP.replace("%1",N.workspace.options.oneBasedIndex?"0":"-1")})},F={mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("at",!!this.isAt_),N},domToMutation:function(N){N=N.getAttribute("at")!=="false",this.updateAt_(N)},updateAt_:function(N){this.removeInput("AT",true),this.removeInput("ORDINAL",true),N&&(this.appendValueInput("AT").setCheck("Number"),v.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(v.ORDINAL_NUMBER_SUFFIX)),v.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",true),this.appendDummyInput("TAIL").appendField(v.TEXT_CHARAT_TAIL)),this.isAt_=N}},X=function(){this.getField("WHERE").setValidator(function(U){U=U==="FROM_START"||U==="FROM_END",U!==this.isAt_&&this.getSourceBlock().updateAt_(U)}),this.updateAt_(true);const N=this;this.setTooltip(function(){var U=N.getFieldValue("WHERE");let q=v.TEXT_CHARAT_TOOLTIP;return(U==="FROM_START"||U==="FROM_END")&&(U=U==="FROM_START"?v.LISTS_INDEX_FROM_START_TOOLTIP:v.LISTS_INDEX_FROM_END_TOOLTIP)&&(q+="  "+U.replace("%1",N.workspace.options.oneBasedIndex?"#1":"#0")),q})};o.module$build$src$core$extensions.register("text_indexOf_tooltip",H),o.module$build$src$core$extensions.register("text_quotes",L),o.module$build$src$core$extensions.registerMutator("text_join_mutator",x,B),o.module$build$src$core$extensions.registerMutator("text_charAt_mutator",F,X),w(R.blocks);var Z={};o.module$build$src$core$contextmenu,o.module$build$src$core$events$events,o.module$build$src$core$procedures,o.module$build$src$core$variables,o.module$build$src$core$xml,o.module$build$src$core$utils$xml,o.Align$$module$build$src$core$input,o.config$$module$build$src$core$config,o.FieldCheckbox$$module$build$src$core$field_checkbox,o.FieldLabel$$module$build$src$core$field_label,o.FieldTextInput$$module$build$src$core$field_textinput;var J=o.module$build$src$core$msg.Msg;o.Mutator$$module$build$src$core$mutator,o.module$build$src$core$names.Names;var D=o.module$build$src$core$common.defineBlocks;Z.blocks={};var P={setStatements_:function(N){this.hasStatements_!==N&&(N?(this.appendStatementInput("STACK").appendField(J.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",true),this.hasStatements_=N)},updateParams_:function(){let N="";this.arguments_.length&&(N=J.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),o.module$build$src$core$events$events.disable();try{this.setFieldValue(N,"PARAMS")}finally{o.module$build$src$core$events$events.enable()}},mutationToDom:function(N){const U=o.module$build$src$core$utils$xml.createElement("mutation");N&&U.setAttribute("name",this.getFieldValue("NAME"));for(let q=0;q<this.argumentVarModels_.length;q++){const ne=o.module$build$src$core$utils$xml.createElement("arg"),oe=this.argumentVarModels_[q];ne.setAttribute("name",oe.name),ne.setAttribute("varid",oe.getId()),N&&this.paramIds_&&ne.setAttribute("paramId",this.paramIds_[q]),U.appendChild(ne)}return this.hasStatements_||U.setAttribute("statements","false"),U},domToMutation:function(N){this.arguments_=[],this.argumentVarModels_=[];for(let q=0,ne;ne=N.childNodes[q];q++)if(ne.nodeName.toLowerCase()==="arg"){const oe=ne.getAttribute("name");var U=ne.getAttribute("varid")||ne.getAttribute("varId");this.arguments_.push(oe),U=o.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,U,oe,""),U!==null?this.argumentVarModels_.push(U):console.log(`Failed to create a variable named "${oe}", ignoring.`)}this.updateParams_(),o.module$build$src$core$procedures.mutateCallers(this),this.setStatements_(N.getAttribute("statements")!=="false")},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const N=Object.create(null);if(this.argumentVarModels_.length){N.params=[];for(let U=0;U<this.argumentVarModels_.length;U++)N.params.push({name:this.argumentVarModels_[U].name,id:this.argumentVarModels_[U].getId()})}return this.hasStatements_||(N.hasStatements=false),N},loadExtraState:function(N){if(this.arguments_=[],this.argumentVarModels_=[],N.params)for(let q=0;q<N.params.length;q++){var U=N.params[q];U=o.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,U.id,U.name,""),this.arguments_.push(U.name),this.argumentVarModels_.push(U)}this.updateParams_(),o.module$build$src$core$procedures.mutateCallers(this),this.setStatements_(N.hasStatements!==false)},decompose:function(N){const U=o.module$build$src$core$utils$xml.createElement("block");U.setAttribute("type","procedures_mutatorcontainer");var q=o.module$build$src$core$utils$xml.createElement("statement");q.setAttribute("name","STACK"),U.appendChild(q);for(let oe=0;oe<this.arguments_.length;oe++){const ut=o.module$build$src$core$utils$xml.createElement("block");ut.setAttribute("type","procedures_mutatorarg");var ne=o.module$build$src$core$utils$xml.createElement("field");ne.setAttribute("name","NAME");const wn=o.module$build$src$core$utils$xml.createTextNode(this.arguments_[oe]);ne.appendChild(wn),ut.appendChild(ne),ne=o.module$build$src$core$utils$xml.createElement("next"),ut.appendChild(ne),q.appendChild(ut),q=ne}return N=o.module$build$src$core$xml.domToBlock(U,N),this.type==="procedures_defreturn"?N.setFieldValue(this.hasStatements_,"STATEMENTS"):N.removeInput("STATEMENT_INPUT"),o.module$build$src$core$procedures.mutateCallers(this),N},compose:function(N){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let U=N.getInputTargetBlock("STACK");for(;U&&!U.isInsertionMarker();){var q=U.getFieldValue("NAME");this.arguments_.push(q),q=this.workspace.getVariable(q,""),this.argumentVarModels_.push(q),this.paramIds_.push(U.id),U=U.nextConnection&&U.nextConnection.targetBlock()}this.updateParams_(),o.module$build$src$core$procedures.mutateCallers(this),N=N.getFieldValue("STATEMENTS"),N!==null&&(N=N==="TRUE",this.hasStatements_!==N)&&(N?(this.setStatements_(true),o.Mutator$$module$build$src$core$mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(N=this.getInput("STACK").connection,(this.statementConnection_=N.targetConnection)&&(N=N.targetBlock(),N.unplug(),N.bumpNeighbours()),this.setStatements_(false)))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(N,U){var q=this.workspace.getVariableById(N);if(q.type===""){q=q.name,U=this.workspace.getVariableById(U);var ne=false;for(let oe=0;oe<this.argumentVarModels_.length;oe++)this.argumentVarModels_[oe].getId()===N&&(this.arguments_[oe]=U.name,this.argumentVarModels_[oe]=U,ne=true);ne&&(this.displayRenamedVar_(q,U.name),o.module$build$src$core$procedures.mutateCallers(this))}},updateVarName:function(N){const U=N.name;let q=false,ne;for(let oe=0;oe<this.argumentVarModels_.length;oe++)this.argumentVarModels_[oe].getId()===N.getId()&&(ne=this.arguments_[oe],this.arguments_[oe]=U,q=true);q&&(this.displayRenamedVar_(ne,U),o.module$build$src$core$procedures.mutateCallers(this))},displayRenamedVar_:function(N,U){if(this.updateParams_(),this.mutator&&this.mutator.isVisible()){const q=this.mutator.workspace_.getAllBlocks(false);for(let ne=0,oe;oe=q[ne];ne++)oe.type==="procedures_mutatorarg"&&o.module$build$src$core$names.Names.equals(N,oe.getFieldValue("NAME"))&&oe.setFieldValue(U,"NAME")}},customContextMenu:function(N){if(!this.isInFlyout){var U={enabled:true},q=this.getFieldValue("NAME");U.text=J.PROCEDURES_CREATE_DO.replace("%1",q);var ne=o.module$build$src$core$utils$xml.createElement("mutation");for(ne.setAttribute("name",q),q=0;q<this.arguments_.length;q++){var oe=o.module$build$src$core$utils$xml.createElement("arg");oe.setAttribute("name",this.arguments_[q]),ne.appendChild(oe)}if(q=o.module$build$src$core$utils$xml.createElement("block"),q.setAttribute("type",this.callType_),q.appendChild(ne),U.callback=o.module$build$src$core$contextmenu.callbackFactory(this,q),N.push(U),!this.isCollapsed())for(U=0;U<this.argumentVarModels_.length;U++)ne={enabled:true},q=this.argumentVarModels_[U],ne.text=J.VARIABLES_SET_CREATE_GET.replace("%1",q.name),q=o.module$build$src$core$variables.generateVariableFieldDom(q),oe=o.module$build$src$core$utils$xml.createElement("block"),oe.setAttribute("type","variables_get"),oe.appendChild(q),ne.callback=o.module$build$src$core$contextmenu.callbackFactory(this,oe),N.push(ne)}}};Z.blocks.procedures_defnoreturn=Object.assign({},P,{init:function(){var N=o.module$build$src$core$procedures.findLegalName("",this);N=new o.FieldTextInput$$module$build$src$core$field_textinput(N,o.module$build$src$core$procedures.rename),N.setSpellcheck(false),this.appendDummyInput().appendField(J.PROCEDURES_DEFNORETURN_TITLE).appendField(N,"NAME").appendField("","PARAMS"),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&J.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(J.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(J.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(J.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(true),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,false]},callType_:"procedures_callnoreturn"}),Z.blocks.procedures_defreturn=Object.assign({},P,{init:function(){var N=o.module$build$src$core$procedures.findLegalName("",this);N=new o.FieldTextInput$$module$build$src$core$field_textinput(N,o.module$build$src$core$procedures.rename),N.setSpellcheck(false),this.appendDummyInput().appendField(J.PROCEDURES_DEFRETURN_TITLE).appendField(N,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(o.Align$$module$build$src$core$input.RIGHT).appendField(J.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&J.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(J.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(J.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(J.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(true),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,true]},callType_:"procedures_callreturn"}),Z.blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(J.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(J.PROCEDURES_ALLOW_STATEMENTS).appendField(new o.FieldCheckbox$$module$build$src$core$field_checkbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(J.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=false}},Z.blocks.procedures_mutatorarg={init:function(){const N=new o.FieldTextInput$$module$build$src$core$field_textinput(o.module$build$src$core$procedures.DEFAULT_ARG,this.validator_);N.oldShowEditorFn_=N.showEditor_,N.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(J.PROCEDURES_MUTATORARG_TITLE).appendField(N,"NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setStyle("procedure_blocks"),this.setTooltip(J.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=false,N.onFinishEditing_=this.deleteIntermediateVars_,N.createdVariables_=[],N.onFinishEditing_("x")},validator_:function(N){var U=this.getSourceBlock();const q=o.Mutator$$module$build$src$core$mutator.findParentWs(U.workspace);if(N=N.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),!N)return null;const ne=(U.workspace.targetWorkspace||U.workspace).getAllBlocks(false),oe=N.toLowerCase();for(let ut=0;ut<ne.length;ut++){if(ne[ut].id===this.getSourceBlock().id)continue;const wn=ne[ut].getFieldValue("NAME");if(wn&&wn.toLowerCase()===oe)return null}return U.isInFlyout||((U=q.getVariable(N,""))&&U.name!==N&&q.renameVariableById(U.getId(),N),U||(U=q.createVariable(N,""))&&this.createdVariables_&&this.createdVariables_.push(U)),N},deleteIntermediateVars_:function(N){const U=o.Mutator$$module$build$src$core$mutator.findParentWs(this.getSourceBlock().workspace);if(U)for(let q=0;q<this.createdVariables_.length;q++){const ne=this.createdVariables_[q];ne.name!==N&&U.deleteVariableById(ne.getId())}}};var V={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(N,U){o.module$build$src$core$names.Names.equals(N,this.getProcedureCall())&&(this.setFieldValue(U,"NAME"),this.setTooltip((this.outputConnection?J.PROCEDURES_CALLRETURN_TOOLTIP:J.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",U)))},setProcedureParameters_:function(N,U){var q=o.module$build$src$core$procedures.getDefinition(this.getProcedureCall(),this.workspace),ne=q&&q.mutator&&q.mutator.isVisible();if(ne?this.setCollapsed(false):(this.quarkConnections_={},this.quarkIds_=null),N.join(`
`)===this.arguments_.join(`
`))this.quarkIds_=U;else{if(U.length!==N.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),q=this.rendered,this.rendered=false;for(let ut=0;ut<this.arguments_.length;ut++){var oe=this.getInput("ARG"+ut);oe&&(oe=oe.connection.targetConnection,this.quarkConnections_[this.quarkIds_[ut]]=oe,ne&&oe&&U.indexOf(this.quarkIds_[ut])===-1&&(oe.disconnect(),oe.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(N),this.argumentVarModels_=[],N=0;N<this.arguments_.length;N++)ne=o.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[N],""),this.argumentVarModels_.push(ne);if(this.updateShape_(),this.quarkIds_=U)for(U=0;U<this.arguments_.length;U++)N=this.quarkIds_[U],N in this.quarkConnections_&&(o.Mutator$$module$build$src$core$mutator.reconnect(this.quarkConnections_[N],this,"ARG"+U)||delete this.quarkConnections_[N]);(this.rendered=q)&&this.render()}},updateShape_:function(){for(var N=0;N<this.arguments_.length;N++){var U=this.getField("ARGNAME"+N);if(U){o.module$build$src$core$events$events.disable();try{U.setValue(this.arguments_[N])}finally{o.module$build$src$core$events$events.enable()}}else U=new o.FieldLabel$$module$build$src$core$field_label(this.arguments_[N]),this.appendValueInput("ARG"+N).setAlign(o.Align$$module$build$src$core$input.RIGHT).appendField(U,"ARGNAME"+N).init()}for(N=this.arguments_.length;this.getInput("ARG"+N);N++)this.removeInput("ARG"+N);(N=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(N.appendField(J.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),N.init()):this.getField("WITH")&&N.removeField("WITH"))},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");N.setAttribute("name",this.getProcedureCall());for(let U=0;U<this.arguments_.length;U++){const q=o.module$build$src$core$utils$xml.createElement("arg");q.setAttribute("name",this.arguments_[U]),N.appendChild(q)}return N},domToMutation:function(N){var U=N.getAttribute("name");this.renameProcedure(this.getProcedureCall(),U),U=[];const q=[];for(let ne=0,oe;oe=N.childNodes[ne];ne++)oe.nodeName.toLowerCase()==="arg"&&(U.push(oe.getAttribute("name")),q.push(oe.getAttribute("paramId")));this.setProcedureParameters_(U,q)},saveExtraState:function(){const N=Object.create(null);return N.name=this.getProcedureCall(),this.arguments_.length&&(N.params=this.arguments_),N},loadExtraState:function(N){if(this.renameProcedure(this.getProcedureCall(),N.name),N=N.params){const U=[];U.length=N.length,U.fill(null),this.setProcedureParameters_(N,U)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(N){if(this.workspace&&!this.workspace.isFlyout&&N.recordUndo)if(N.type===o.module$build$src$core$events$events.BLOCK_CREATE&&N.ids.indexOf(this.id)!==-1){var U=this.getProcedureCall();if(U=o.module$build$src$core$procedures.getDefinition(U,this.workspace),!U||U.type===this.defType_&&JSON.stringify(U.getVars())===JSON.stringify(this.arguments_)||(U=null),!U){o.module$build$src$core$events$events.setGroup(N.group),N=o.module$build$src$core$utils$xml.createElement("xml"),U=o.module$build$src$core$utils$xml.createElement("block"),U.setAttribute("type",this.defType_);var q=this.getRelativeToSurfaceXY(),ne=q.y+2*o.config$$module$build$src$core$config.snapRadius;U.setAttribute("x",q.x+o.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)),U.setAttribute("y",ne),q=this.mutationToDom(),U.appendChild(q),q=o.module$build$src$core$utils$xml.createElement("field"),q.setAttribute("name","NAME"),ne=this.getProcedureCall();const oe=o.module$build$src$core$procedures.findLegalName(ne,this);ne!==oe&&this.renameProcedure(ne,oe),q.appendChild(o.module$build$src$core$utils$xml.createTextNode(ne)),U.appendChild(q),N.appendChild(U),o.module$build$src$core$xml.domToWorkspace(N,this.workspace),o.module$build$src$core$events$events.setGroup(false)}}else N.type===o.module$build$src$core$events$events.BLOCK_DELETE?(U=this.getProcedureCall(),o.module$build$src$core$procedures.getDefinition(U,this.workspace)||(o.module$build$src$core$events$events.setGroup(N.group),this.dispose(true),o.module$build$src$core$events$events.setGroup(false))):N.type===o.module$build$src$core$events$events.CHANGE&&N.element==="disabled"&&(U=this.getProcedureCall(),(U=o.module$build$src$core$procedures.getDefinition(U,this.workspace))&&U.id===N.blockId&&((U=o.module$build$src$core$events$events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),o.module$build$src$core$events$events.setGroup(N.group),N.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(false)):this.setEnabled(this.previousEnabledState_),o.module$build$src$core$events$events.setGroup(U)))},customContextMenu:function(N){if(this.workspace.isMovable()){var U={enabled:true};U.text=J.PROCEDURES_HIGHLIGHT_DEF;var q=this.getProcedureCall(),ne=this.workspace;U.callback=function(){const oe=o.module$build$src$core$procedures.getDefinition(q,ne);oe&&(ne.centerOnBlock(oe.id),oe.select())},N.push(U)}}};Z.blocks.procedures_callnoreturn=Object.assign({},V,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setStyle("procedure_blocks"),this.setHelpUrl(J.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=true},defType_:"procedures_defnoreturn"}),Z.blocks.procedures_callreturn=Object.assign({},V,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(true),this.setStyle("procedure_blocks"),this.setHelpUrl(J.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=true},defType_:"procedures_defreturn"}),Z.blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(J.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(J.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(true),this.setPreviousStatement(true),this.setNextStatement(true),this.setStyle("procedure_blocks"),this.setTooltip(J.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(J.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=true},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("value",Number(this.hasReturnValue_)),N},domToMutation:function(N){this.hasReturnValue_=N.getAttribute("value")==="1",this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(J.PROCEDURES_DEFRETURN_RETURN))},onchange:function(N){if(!(this.workspace.isDragging&&this.workspace.isDragging()||N.type!==o.module$build$src$core$events$events.BLOCK_MOVE)){var U=false,q=this;do{if(this.FUNCTION_TYPES.indexOf(q.type)!==-1){U=true;break}q=q.getSurroundParent()}while(q);U?(q.type==="procedures_defnoreturn"&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(J.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=false):q.type!=="procedures_defreturn"||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(J.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=true),this.setWarningText(null)):this.setWarningText(J.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||(q=o.module$build$src$core$events$events.getGroup(),o.module$build$src$core$events$events.setGroup(N.group),this.setEnabled(U),o.module$build$src$core$events$events.setGroup(q))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},D(Z.blocks);var j={};o.module$build$src$core$extensions,o.module$build$src$core$field_dropdown,o.module$build$src$core$utils$xml;var re=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,G=o.module$build$src$core$common.defineBlocks;j.blocks=re([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03C0","PI"],["e","E"],["\u03C6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xBD)","SQRT1_2"],["\u221E","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:true,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);var ae={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};o.module$build$src$core$extensions.register("math_op_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("OP",ae));var de={mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation"),U=this.getFieldValue("PROPERTY")==="DIVISIBLE_BY";return N.setAttribute("divisor_input",U),N},domToMutation:function(N){N=N.getAttribute("divisor_input")==="true",this.updateShape_(N)},updateShape_:function(N){const U=this.getInput("DIVISOR");N?U||this.appendValueInput("DIVISOR").setCheck("Number"):U&&this.removeInput("DIVISOR")}},fe=function(){this.getField("PROPERTY").setValidator(function(N){N=N==="DIVISIBLE_BY",this.getSourceBlock().updateShape_(N)})};o.module$build$src$core$extensions.registerMutator("math_is_divisibleby_mutator",de,fe),o.module$build$src$core$extensions.register("math_change_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var ee={updateType_:function(N){N==="MODE"?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("op",this.getFieldValue("OP")),N},domToMutation:function(N){this.updateType_(N.getAttribute("op"))}},W=function(){this.getField("OP").setValidator(function(N){this.updateType_(N)}.bind(this))};o.module$build$src$core$extensions.registerMutator("math_modes_of_list_mutator",ee,W),G(j.blocks);var Q={};o.module$build$src$core$contextmenu,o.module$build$src$core$events$events,o.module$build$src$core$extensions,o.module$build$src$core$variables,o.module$build$src$core$utils$xml;var ce=o.module$build$src$core$msg.Msg,Ee=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,Xe=o.module$build$src$core$common.defineBlocks;Q.blocks=Ee([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:true,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:true,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);var Re={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};o.module$build$src$core$extensions.register("controls_whileUntil_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("MODE",Re));var _t={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};o.module$build$src$core$extensions.register("controls_flow_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("FLOW",_t));var Ct={customContextMenu:function(N){if(!this.isInFlyout){var U=this.getField("VAR").getVariable(),q=U.name;if(!this.isCollapsed()&&q!==null){const ne={enabled:true};ne.text=ce.VARIABLES_SET_CREATE_GET.replace("%1",q),U=o.module$build$src$core$variables.generateVariableFieldDom(U),q=o.module$build$src$core$utils$xml.createElement("block"),q.setAttribute("type","variables_get"),q.appendChild(U),ne.callback=o.module$build$src$core$contextmenu.callbackFactory(this,q),N.push(ne)}}}};o.module$build$src$core$extensions.registerMixin("contextMenu_newGetVariableBlock",Ct),o.module$build$src$core$extensions.register("controls_for_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),o.module$build$src$core$extensions.register("controls_forEach_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),Q.loopTypes=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]);var Rt={getSurroundLoop:function(){let N=this;do{if(Q.loopTypes.has(N.type))return N;N=N.getSurroundParent()}while(N);return null},onchange:function(N){if(this.workspace.isDragging&&!this.workspace.isDragging()&&N.type===o.module$build$src$core$events$events.BLOCK_MOVE){var U=this.getSurroundLoop(this);if(this.setWarningText(U?null:ce.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){const q=o.module$build$src$core$events$events.getGroup();o.module$build$src$core$events$events.setGroup(N.group),this.setEnabled(U),o.module$build$src$core$events$events.setGroup(q)}}}};o.module$build$src$core$extensions.registerMixin("controls_flow_in_loop_check",Rt),Xe(Q.blocks);var ct={};o.module$build$src$core$events$events,o.module$build$src$core$extensions,o.module$build$src$core$utils$xml;var Ut=o.module$build$src$core$msg.Msg;o.Mutator$$module$build$src$core$mutator;var Ui=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,ai=o.module$build$src$core$common.defineBlocks;ct.blocks=Ui([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:true,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:true,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200F<","LT"],["\u200F\u2264","LTE"],["\u200F>","GT"],["\u200F\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:true,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:true,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:false,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:false,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:false,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);var li={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};o.module$build$src$core$extensions.register("logic_op_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("OP",li));var ci={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const N=o.module$build$src$core$utils$xml.createElement("mutation");return this.elseifCount_&&N.setAttribute("elseif",this.elseifCount_),this.elseCount_&&N.setAttribute("else",1),N},domToMutation:function(N){this.elseifCount_=parseInt(N.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(N.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const N=Object.create(null);return this.elseifCount_&&(N.elseIfCount=this.elseifCount_),this.elseCount_&&(N.hasElse=true),N},loadExtraState:function(N){this.elseifCount_=N.elseIfCount||0,this.elseCount_=N.hasElse?1:0,this.updateShape_()},decompose:function(N){const U=N.newBlock("controls_if_if");U.initSvg();let q=U.nextConnection;for(let ne=1;ne<=this.elseifCount_;ne++){const oe=N.newBlock("controls_if_elseif");oe.initSvg(),q.connect(oe.previousConnection),q=oe.nextConnection}return this.elseCount_&&(N=N.newBlock("controls_if_else"),N.initSvg(),q.connect(N.previousConnection)),U},compose:function(N){N=N.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const U=[null],q=[null];let ne=null;for(;N;){if(!N.isInsertionMarker())switch(N.type){case"controls_if_elseif":this.elseifCount_++,U.push(N.valueConnection_),q.push(N.statementConnection_);break;case"controls_if_else":this.elseCount_++,ne=N.statementConnection_;break;default:throw TypeError("Unknown block type: "+N.type)}N=N.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(U,q,ne)},saveConnections:function(N){N=N.nextConnection.targetBlock();let U=1;for(;N;){if(!N.isInsertionMarker())switch(N.type){case"controls_if_elseif":var q=this.getInput("IF"+U);const ne=this.getInput("DO"+U);N.valueConnection_=q&&q.connection.targetConnection,N.statementConnection_=ne&&ne.connection.targetConnection,U++;break;case"controls_if_else":q=this.getInput("ELSE"),N.statementConnection_=q&&q.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+N.type)}N=N.getNextBlock()}},rebuildShape_:function(){const N=[null],U=[null];let q=null;this.getInput("ELSE")&&(q=this.getInput("ELSE").connection.targetConnection);for(let ne=1;this.getInput("IF"+ne);ne++){const oe=this.getInput("IF"+ne),ut=this.getInput("DO"+ne);N.push(oe.connection.targetConnection),U.push(ut.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(N,U,q)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var N=1;this.getInput("IF"+N);N++)this.removeInput("IF"+N),this.removeInput("DO"+N);for(N=1;N<=this.elseifCount_;N++)this.appendValueInput("IF"+N).setCheck("Boolean").appendField(Ut.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+N).appendField(Ut.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(Ut.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(N,U,q){for(let ne=1;ne<=this.elseifCount_;ne++)o.Mutator$$module$build$src$core$mutator.reconnect(N[ne],this,"IF"+ne),o.Mutator$$module$build$src$core$mutator.reconnect(U[ne],this,"DO"+ne);o.Mutator$$module$build$src$core$mutator.reconnect(q,this,"ELSE")}};o.module$build$src$core$extensions.registerMutator("controls_if_mutator",ci,null,["controls_if_elseif","controls_if_else"]);var ks=function(){this.setTooltip(function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&this.elseCount_)return Ut.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return Ut.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return Ut.CONTROLS_IF_TOOLTIP_4}else return Ut.CONTROLS_IF_TOOLTIP_1;return""}.bind(this))};o.module$build$src$core$extensions.register("controls_if_tooltip",ks);var Es={onchange:function(N){this.prevBlocks_||(this.prevBlocks_=[null,null]);var U=this.getInputTargetBlock("A");const q=this.getInputTargetBlock("B");U&&q&&!this.workspace.connectionChecker.doTypeChecks(U.outputConnection,q.outputConnection)&&(o.module$build$src$core$events$events.setGroup(N.group),N=this.prevBlocks_[0],N!==U&&(U.unplug(),!N||N.isDisposed()||N.isShadow()||this.getInput("A").connection.connect(N.outputConnection)),U=this.prevBlocks_[1],U!==q&&(q.unplug(),!U||U.isDisposed()||U.isShadow()||this.getInput("B").connection.connect(U.outputConnection)),this.bumpNeighbours(),o.module$build$src$core$events$events.setGroup(false)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},$e=function(){this.mixin(Es)};o.module$build$src$core$extensions.register("logic_compare",$e);var rt={prevParentConnection_:null,onchange:function(N){const U=this.getInputTargetBlock("THEN"),q=this.getInputTargetBlock("ELSE"),ne=this.outputConnection.targetConnection;if((U||q)&&ne)for(let oe=0;2>oe;oe++){const ut=oe===1?U:q;ut&&!ut.workspace.connectionChecker.doTypeChecks(ut.outputConnection,ne)&&(o.module$build$src$core$events$events.setGroup(N.group),ne===this.prevParentConnection_?(this.unplug(),ne.getSourceBlock().bumpNeighbours()):(ut.unplug(),ut.bumpNeighbours()),o.module$build$src$core$events$events.setGroup(false))}this.prevParentConnection_=ne}};o.module$build$src$core$extensions.registerMixin("logic_ternary",rt),ai(ct.blocks);var pt={};o.module$build$src$core$utils$xml,o.module$build$src$core$xml,o.Align$$module$build$src$core$input,o.module$build$src$core$connection_type.ConnectionType;var ts=o.module$build$src$core$field_dropdown.FieldDropdown,ye=o.module$build$src$core$msg.Msg;o.Mutator$$module$build$src$core$mutator;var Zn=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,Qn=o.module$build$src$core$common.defineBlocks;pt.blocks=Zn([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:true,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),pt.blocks.lists_create_with={init:function(){this.setHelpUrl(ye.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(true,"Array"),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["lists_create_with_item"],this)),this.setTooltip(ye.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("items",this.itemCount_),N},domToMutation:function(N){this.itemCount_=parseInt(N.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(N){this.itemCount_=N.itemCount,this.updateShape_()},decompose:function(N){const U=N.newBlock("lists_create_with_container");U.initSvg();let q=U.getInput("STACK").connection;for(let ne=0;ne<this.itemCount_;ne++){const oe=N.newBlock("lists_create_with_item");oe.initSvg(),q.connect(oe.previousConnection),q=oe.nextConnection}return U},compose:function(N){var U=N.getInputTargetBlock("STACK");for(N=[];U;)U.isInsertionMarker()||N.push(U.valueConnection_),U=U.getNextBlock();for(U=0;U<this.itemCount_;U++){const q=this.getInput("ADD"+U).connection.targetConnection;q&&N.indexOf(q)===-1&&q.disconnect()}for(this.itemCount_=N.length,this.updateShape_(),U=0;U<this.itemCount_;U++)o.Mutator$$module$build$src$core$mutator.reconnect(N[U],this,"ADD"+U)},saveConnections:function(N){N=N.getInputTargetBlock("STACK");let U=0;for(;N;){if(N.isInsertionMarker()){N=N.getNextBlock();continue}const q=this.getInput("ADD"+U);N.valueConnection_=q&&q.connection.targetConnection,N=N.getNextBlock(),U++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(ye.LISTS_CREATE_EMPTY_TITLE);for(var N=0;N<this.itemCount_;N++)if(!this.getInput("ADD"+N)){const U=this.appendValueInput("ADD"+N).setAlign(o.Align$$module$build$src$core$input.RIGHT);N===0&&U.appendField(ye.LISTS_CREATE_WITH_INPUT_WITH)}for(N=this.itemCount_;this.getInput("ADD"+N);N++)this.removeInput("ADD"+N)}},pt.blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(ye.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(ye.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=false}},pt.blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(ye.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(ye.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=false}},pt.blocks.lists_indexOf={init:function(){const N=[[ye.LISTS_INDEX_OF_FIRST,"FIRST"],[ye.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(ye.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(true,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(ye.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new ts(N),"END"),this.setInputsInline(true);const U=this;this.setTooltip(function(){return ye.LISTS_INDEX_OF_TOOLTIP.replace("%1",U.workspace.options.oneBasedIndex?"0":"-1")})}},pt.blocks.lists_getIndex={init:function(){var N=[[ye.LISTS_GET_INDEX_GET,"GET"],[ye.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[ye.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[ye.LISTS_GET_INDEX_FROM_START,"FROM_START"],[ye.LISTS_GET_INDEX_FROM_END,"FROM_END"],[ye.LISTS_GET_INDEX_FIRST,"FIRST"],[ye.LISTS_GET_INDEX_LAST,"LAST"],[ye.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(ye.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),N=new ts(N,function(q){q=q==="REMOVE",this.getSourceBlock().updateStatement_(q)}),this.appendValueInput("VALUE").setCheck("Array").appendField(ye.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(N,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),ye.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(ye.LISTS_GET_INDEX_TAIL),this.setInputsInline(true),this.setOutput(true),this.updateAt_(true);const U=this;this.setTooltip(function(){const q=U.getFieldValue("MODE"),ne=U.getFieldValue("WHERE");let oe="";switch(q+" "+ne){case"GET FROM_START":case"GET FROM_END":oe=ye.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":oe=ye.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":oe=ye.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":oe=ye.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":oe=ye.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":oe=ye.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":oe=ye.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":oe=ye.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":oe=ye.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":oe=ye.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":oe=ye.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":oe=ye.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return(ne==="FROM_START"||ne==="FROM_END")&&(oe+="  "+(ne==="FROM_START"?ye.LISTS_INDEX_FROM_START_TOOLTIP:ye.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",U.workspace.options.oneBasedIndex?"#1":"#0")),oe})},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");N.setAttribute("statement",!this.outputConnection);const U=this.getInput("AT").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at",U),N},domToMutation:function(N){const U=N.getAttribute("statement")==="true";this.updateStatement_(U),N=N.getAttribute("at")!=="false",this.updateAt_(N)},saveExtraState:function(){return this.outputConnection?null:{isStatement:true}},loadExtraState:function(N){N.isStatement?this.updateStatement_(true):typeof N=="string"&&this.domToMutation(o.module$build$src$core$xml.textToDom(N))},updateStatement_:function(N){N!==!this.outputConnection&&(this.unplug(true,true),N?(this.setOutput(false),this.setPreviousStatement(true),this.setNextStatement(true)):(this.setPreviousStatement(false),this.setNextStatement(false),this.setOutput(true)))},updateAt_:function(N){this.removeInput("AT"),this.removeInput("ORDINAL",true),N?(this.appendValueInput("AT").setCheck("Number"),ye.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(ye.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const U=new ts(this.WHERE_OPTIONS,function(q){const ne=q==="FROM_START"||q==="FROM_END";if(ne!==N){const oe=this.getSourceBlock();return oe.updateAt_(ne),oe.setFieldValue(q,"WHERE"),null}});this.getInput("AT").appendField(U,"WHERE"),ye.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},pt.blocks.lists_setIndex={init:function(){const N=[[ye.LISTS_SET_INDEX_SET,"SET"],[ye.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[ye.LISTS_GET_INDEX_FROM_START,"FROM_START"],[ye.LISTS_GET_INDEX_FROM_END,"FROM_END"],[ye.LISTS_GET_INDEX_FIRST,"FIRST"],[ye.LISTS_GET_INDEX_LAST,"LAST"],[ye.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(ye.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(ye.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new ts(N),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(ye.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(true),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(ye.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(true);const U=this;this.setTooltip(function(){const q=U.getFieldValue("MODE"),ne=U.getFieldValue("WHERE");let oe="";switch(q+" "+ne){case"SET FROM_START":case"SET FROM_END":oe=ye.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":oe=ye.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":oe=ye.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":oe=ye.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":oe=ye.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":oe=ye.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":oe=ye.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":oe=ye.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return(ne==="FROM_START"||ne==="FROM_END")&&(oe+="  "+ye.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",U.workspace.options.oneBasedIndex?"#1":"#0")),oe})},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation"),U=this.getInput("AT").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at",U),N},domToMutation:function(N){N=N.getAttribute("at")!=="false",this.updateAt_(N)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(N){this.removeInput("AT"),this.removeInput("ORDINAL",true),N?(this.appendValueInput("AT").setCheck("Number"),ye.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(ye.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const U=new ts(this.WHERE_OPTIONS,function(q){const ne=q==="FROM_START"||q==="FROM_END";if(ne!==N){const oe=this.getSourceBlock();return oe.updateAt_(ne),oe.setFieldValue(q,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(U,"WHERE")}},pt.blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[ye.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[ye.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[ye.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[ye.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[ye.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[ye.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(ye.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(ye.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),ye.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(ye.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(true),this.setOutput(true,"Array"),this.updateAt_(1,true),this.updateAt_(2,true),this.setTooltip(ye.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");var U=this.getInput("AT1").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at1",U),U=this.getInput("AT2").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE,N.setAttribute("at2",U),N},domToMutation:function(N){const U=N.getAttribute("at1")==="true";N=N.getAttribute("at2")==="true",this.updateAt_(1,U),this.updateAt_(2,N)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(N,U){this.removeInput("AT"+N),this.removeInput("ORDINAL"+N,true),U?(this.appendValueInput("AT"+N).setCheck("Number"),ye.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+N).appendField(ye.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+N);const q=new ts(this["WHERE_OPTIONS_"+N],function(ne){const oe=ne==="FROM_START"||ne==="FROM_END";if(oe!==U){const ut=this.getSourceBlock();return ut.updateAt_(N,oe),ut.setFieldValue(ne,"WHERE"+N),null}});this.getInput("AT"+N).appendField(q,"WHERE"+N),N===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),ye.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},pt.blocks.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},pt.blocks.lists_split={init:function(){const N=this,U=new ts([[ye.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[ye.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(q){N.updateType_(q)});this.setHelpUrl(ye.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(U,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(ye.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(true),this.setOutput(true,"Array"),this.setTooltip(function(){const q=N.getFieldValue("MODE");if(q==="SPLIT")return ye.LISTS_SPLIT_TOOLTIP_SPLIT;if(q==="JOIN")return ye.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+q)})},updateType_:function(N){if(this.getFieldValue("MODE")!==N){const U=this.getInput("INPUT").connection;U.setShadowDom(null);const q=U.targetBlock();q&&(U.disconnect(),q.isShadow()?q.dispose():this.bumpNeighbours())}N==="SPLIT"?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("mode",this.getFieldValue("MODE")),N},domToMutation:function(N){this.updateType_(N.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},Qn(pt.blocks);var Fi={},er=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,Ot=o.module$build$src$core$common.defineBlocks;Fi.blocks=er([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),Ot(Fi.blocks);var ss={};return ss.colour=Fi,ss.lists=pt,ss.logic=ct,ss.loops=Q,ss.math=j,ss.procedures=Z,ss.texts=R,ss.variables=m,ss.variablesDynamic=l,ss.blocks=Object.assign({},Fi.blocks,pt.blocks,ct.blocks,Q.blocks,j.blocks,Z.blocks,m.blocks,l.blocks),ss.__namespace__=o,ss})}(_g)),_g.exports}var l$;function qB(){return l$||(l$=1,function(s,n){(function(i,o){s.exports=o(YB())})(Ri,function(i){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(dg)),dg.exports}var c$;function JB(){return c$||(c$=1,function(s,n){(function(i,o){s.exports=o(JR(),KB(),qB(),ZR())})(Ri,function(i,o,l,h){return i.setLocale(o),i})}(ug)),ug.exports}var u$;function ZB(){return u$||(u$=1,function(s,n){(function(i,o){s.exports=o(JB())})(Ri,function(i){/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(cg)),cg.exports}var k=ZB();const QB={class:"dialog-footer"},eP=et({__name:"author",props:["modelValue"],emits:["update:modelValue","callback"],setup(s,{emit:n}){const i=s,o=be({name:"",email:""}),l=be(false);function h(){if(!(!o.value.name||!o.value.email)){if(!o.value.name.match(/^[A-Za-z0-9_-]+$/)){alert("\u4F5C\u8005\u540D\u79F0\u53EA\u80FD\u5305\u542B\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u548C\u4E2D\u5212\u7EBF");return}if(!o.value.email.match(/^[A-Za-z0-9_-]+@[A-Za-z0-9_\-.]+$/)){alert("\u4F5C\u8005\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E");return}n("update:modelValue",false),n("callback",o.value.name+"<"+o.value.email+">"),o.value.name=void 0,o.value.email=void 0}}return Mt(i,f=>{l.value=!!i.modelValue;const p=/^([A-Za-z0-9_-]+)<([A-Za-z0-9_-]+@[A-Za-z0-9_\-.]+)>$/.exec(i.modelValue);p&&(o.value.name=p[1],o.value.email=p[2])}),Mt(l,f=>{n("update:modelValue",f||void 0)}),(f,u)=>{const p=Ze("el-input"),c=Ze("el-button"),_=Ze("el-dialog");return ie(),Ye(_,{modelValue:l.value,"onUpdate:modelValue":u[4]||(u[4]=m=>l.value=m),title:"\u8BBE\u7F6E\u4F5C\u8005"},{footer:We(()=>[le("span",QB,[De(c,{onClick:u[2]||(u[2]=m=>n("update:modelValue"))},{default:We(()=>[Dt("\u5173\u95ED")]),_:1}),De(c,{type:"primary",onClick:u[3]||(u[3]=m=>h())},{default:We(()=>[Dt(" \u786E\u5B9A ")]),_:1})])]),default:We(()=>[De(p,{modelValue:o.value.name,"onUpdate:modelValue":u[0]||(u[0]=m=>o.value.name=m),placeholder:"\u4F5C\u8005\u540D\u79F0(\u8BF7\u4F7F\u7528\u82F1\u6587\u540D\u79F0)"},null,8,["modelValue"]),De(p,{modelValue:o.value.email,"onUpdate:modelValue":u[1]||(u[1]=m=>o.value.email=m),placeholder:"\u4F5C\u8005\u90AE\u7BB1"},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),Oa=s=>(Pf("data-v-ee2650a1"),s=s(),Uf(),s),tP={style:{display:"flex","flex-flow":"column",contain:"size",overflow:"hidden",height:"100%"}},sP={style:{width:"100%",padding:"5px","padding-left":"20px",height:"25px","border-bottom":"1px solid var(--bg1)"}},iP={style:{padding:"20px"}},nP=Oa(()=>le("h2",null,"\u63D2\u4EF6\u57FA\u672C\u4FE1\u606F",-1)),rP=Oa(()=>le("br",null,null,-1)),oP=Oa(()=>le("h2",null,"\u6570\u636E\u5E93",-1)),aP=Oa(()=>le("h2",null,"\u6307\u4EE4",-1)),lP=Oa(()=>le("h2",null,"\u5B58\u50A8\u7A7A\u95F4",-1)),cP=Oa(()=>le("h2",null,"\u5176\u4ED6\u4FE1\u606F",-1)),uP=et({__name:"meta",props:["current","workspace"],emits:["update:workspace","metaChange"],setup(s,{emit:n}){const i=s,o=be([]),l=me(()=>Yn.blockly.find(E=>{var b;return E.id.toString()===((b=i.current)==null?void 0:b.toString())})),h=be({author:void 0,description:"",commands:{},tables:{}});function f(){o.value=[],this.getAllBlocks(false).forEach(E=>{E.type==="command"&&o.value.push(E)})}try{k.serialization.registry.unregister("plugin-meta"),k.serialization.registry.register("plugin-meta",{save(E){return E.meta=nf(h.value),h.value},load(E,b){E&&(h.value.author=E.author,h.value.description=E.description??void 0,b.metaListener=f.bind(b),b.addChangeListener(b.metaListener),b.metaListener(),h.value.commands=E.commands??{},h.value.tables=E.tables??{},b.meta=nf(h.value))},clear(E){h.value.description="",h.value.author=void 0,E.removeChangeListener(E.metaListener),E.meta={}},priority:10})}catch(E){console.error(E)}function u(E){h.value.author=E,n("metaChange")}Mt(h.value,()=>{n("metaChange")});const p=be(void 0);function c(){const E=prompt("\u8BF7\u8F93\u5165\u6570\u636E\u8868\u540D");E&&(h.value.tables[E]={columns:{}})}const _=me(()=>o.value.map(E=>E.getFieldValue("name"))),m=me(()=>om([..._.value,...Object.keys(h.value.commands)]));return(E,b)=>{const T=Ze("k-button"),y=Ze("el-input"),g=Ze("el-button"),$=Ze("el-table-column"),R=Ze("el-table"),v=Ze("el-input-number"),S=Ze("el-scrollbar");return ie(),Se(xt,null,[De(eP,{modelValue:p.value,"onUpdate:modelValue":b[0]||(b[0]=O=>p.value=O),onCallback:u},null,8,["modelValue"]),le("div",tP,[le("div",sP,[le("button",{class:"menu-button",onClick:b[1]||(b[1]=O=>n("update:workspace","blockly"))},"\u9000\u51FA\u5143\u6570\u636E\u7F16\u8F91")]),De(S,{style:{flex:"auto"}},{default:We(()=>{var O;return[le("div",iP,[nP,le("p",null,"\u63D2\u4EF6ID:"+Pt(i.current),1),le("p",null,"\u63D2\u4EF6UUID: "+Pt((O=l.value)==null?void 0:O.uuid),1),le("p",null,[Dt("\u63D2\u4EF6\u4F5C\u8005: "+Pt(h.value.author??"\u672A\u7F72\u540D"),1),De(T,{onClick:b[2]||(b[2]=w=>p.value=h.value.author??true)},{default:We(()=>[Dt("\u4FEE\u6539")]),_:1})]),Dt(" \u63D2\u4EF6\u63CF\u8FF0: "),rP,De(y,{type:"textarea",modelValue:h.value.description,"onUpdate:modelValue":b[3]||(b[3]=w=>h.value.description=w)},null,8,["modelValue"]),oP,De(g,{onClick:c},{default:We(()=>[Dt("\u65B0\u5EFA\u6570\u636E\u8868")]),_:1}),De(R,{modelValue:h.value.tables,"onUpdate:modelValue":b[4]||(b[4]=w=>h.value.tables=w)},{default:We(()=>[De($,{prop:"table",label:"\u6570\u636E\u8868\u540D",width:"180"}),De($,{prop:"columns",label:"\u5B57\u6BB5",width:"180"}),De($,{prop:"operation",label:"\u64CD\u4F5C"})]),_:1},8,["modelValue"]),aP,le("div",null,[(ie(true),Se(xt,null,ni(m.value,(w,A)=>(ie(),Se("div",null,[le("h3",{class:tt(_.value.includes(w)?"":"disabled-title")},[Dt(Pt(w)+" ",1),h.value.commands[w]?(ie(),Ye(g,{key:0,onClick:I=>delete h.value.commands[w]},{default:We(()=>[Dt("\u5220\u9664")]),_:2},1032,["onClick"])):ot("",true)],2),h.value.commands[w]?(ie(),Se(xt,{key:1},[De(y,{type:"textarea",modelValue:h.value.commands[w].description,"onUpdate:modelValue":I=>h.value.commands[w].description=I},null,8,["modelValue","onUpdate:modelValue"]),Dt(" \u6700\u4F4E\u6743\u9650\u7B49\u7EA7"),De(v,{modelValue:h.value.commands[w].authority,"onUpdate:modelValue":I=>h.value.commands[w].authority=I},null,8,["modelValue","onUpdate:modelValue"])],64)):(ie(),Ye(T,{key:0,onClick:I=>h.value.commands[w]={authority:0}},{default:We(()=>[Dt("\u8BBE\u7F6E\u6307\u4EE4\u4FE1\u606F")]),_:2},1032,["onClick"]))]))),256))]),lP,Dt(" \u6682\u672A\u652F\u6301 "),cP,Dt(" SHA256\u6821\u9A8C\u503C: "),De(y,{"model-value":"96cae35ce8a9b0244178bf28e4966c2ce1b8385723a96a6b838858cdd6ca0a1e"})])]}),_:1})])],64)}}});const hP=Jn(uP,[["__scopeId","data-v-ee2650a1"]]);var pg={exports:{}},h$;function dP(){return h$||(h$=1,function(s,n){(function(i,o){s.exports=o()})(Ri,function(){var i=i||{Msg:Object.create(null)};return i.Msg.ADD_COMMENT="\u6DFB\u52A0\u6CE8\u91CA",i.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="\u4E0D\u80FD\u5220\u9664\u53D8\u91CF\u201C%1\u201D\uFF0C\u56E0\u4E3A\u5B83\u662F\u51FD\u6570\u201C%2\u201D\u5B9A\u4E49\u7684\u4E00\u90E8\u5206",i.Msg.CHANGE_VALUE_TITLE="\u66F4\u6539\u503C\uFF1A",i.Msg.CLEAN_UP="\u6574\u7406\u5757",i.Msg.COLLAPSED_WARNINGS_WARNING="\u5DF2\u6536\u8D77\u7684\u4FE1\u606F\u5757\u5185\u5305\u542B\u8B66\u544A\u3002",i.Msg.COLLAPSE_ALL="\u6298\u53E0\u5757",i.Msg.COLLAPSE_BLOCK="\u6298\u53E0\u5757",i.Msg.COLOUR_BLEND_COLOUR1="\u989C\u82721",i.Msg.COLOUR_BLEND_COLOUR2="\u989C\u82722",i.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",i.Msg.COLOUR_BLEND_RATIO="\u6BD4\u4F8B",i.Msg.COLOUR_BLEND_TITLE="\u6DF7\u5408",i.Msg.COLOUR_BLEND_TOOLTIP="\u628A\u4E24\u79CD\u989C\u8272\u4EE5\u4E00\u4E2A\u7ED9\u5B9A\u7684\u6BD4\u4F8B(0.0-1.0)\u8FDB\u884C\u6DF7\u5408\u3002",i.Msg.COLOUR_PICKER_HELPURL="https://zh.wikipedia.org/wiki/\u989C\u8272",i.Msg.COLOUR_PICKER_TOOLTIP="\u4ECE\u8C03\u8272\u677F\u4E2D\u9009\u62E9\u4E00\u79CD\u989C\u8272\u3002",i.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",i.Msg.COLOUR_RANDOM_TITLE="\u968F\u673A\u989C\u8272",i.Msg.COLOUR_RANDOM_TOOLTIP="\u968F\u673A\u9009\u62E9\u4E00\u79CD\u989C\u8272\u3002",i.Msg.COLOUR_RGB_BLUE="\u84DD\u8272",i.Msg.COLOUR_RGB_GREEN="\u7EFF\u8272",i.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",i.Msg.COLOUR_RGB_RED="\u7EA2\u8272",i.Msg.COLOUR_RGB_TITLE="\u989C\u8272",i.Msg.COLOUR_RGB_TOOLTIP="\u901A\u8FC7\u6307\u5B9A\u7EA2\u8272\u3001\u7EFF\u8272\u548C\u84DD\u8272\u7684\u91CF\u521B\u5EFA\u4E00\u79CD\u989C\u8272\u3002\u6240\u6709\u7684\u503C\u5FC5\u987B\u57280\u548C100\u4E4B\u95F4\u3002",i.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="\u8DF3\u51FA\u5FAA\u73AF",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="\u7EE7\u7EED\u4E0B\u4E00\u8F6E\u5FAA\u73AF",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="\u8DF3\u51FA\u5305\u542B\u5B83\u7684\u5FAA\u73AF\u3002",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="\u8DF3\u8FC7\u672C\u8F6E\u5FAA\u73AF\u7684\u5269\u4F59\u90E8\u5206\uFF0C\u5E76\u7EE7\u8FDB\u884C\u7EED\u4E0B\u4E00\u8F6E\u5FAA\u73AF\u3002",i.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="\u8B66\u544A\uFF1A\u8FD9\u4E2A\u5757\u53EA\u80FD\u5728\u5FAA\u73AF\u5185\u4F7F\u7528\u3002",i.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",i.Msg.CONTROLS_FOREACH_TITLE="\u904D\u5386\u5217\u8868 %2 \u91CC\u7684\u6BCF\u4E00\u9879 %1",i.Msg.CONTROLS_FOREACH_TOOLTIP="\u904D\u5386\u5217\u8868\u4E2D\u7684\u6BCF\u4E00\u9879\uFF0C\u5C06\u53D8\u91CF\u201C%1\u201D\u8BBE\u4E3A\u6240\u9009\u9879\uFF0C\u5E76\u6267\u884C\u4E00\u4E9B\u8BED\u53E5\u3002",i.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",i.Msg.CONTROLS_FOR_TITLE="\u53D8\u91CF %1 \u4ECE %2 \u6570\u5230 %3 \u6BCF\u6B21\u589E\u52A0 %4",i.Msg.CONTROLS_FOR_TOOLTIP="\u7528\u53D8\u91CF%1\u8BB0\u5F55\u4ECE\u5F00\u59CB\u6570\u503C\u5230\u7EC8\u6B62\u6570\u503C\u4E4B\u95F4\u7684\u6570\u503C\uFF0C\u6570\u503C\u6309\u6307\u5B9A\u95F4\u9694\u589E\u52A0\uFF0C\u5E76\u6267\u884C\u6307\u5B9A\u7684\u5757\u3002",i.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="\u5728\u8FD9\u4E2Aif\u8BED\u53E5\u5757\u4E2D\u589E\u52A0\u4E00\u4E2A\u6761\u4EF6\u3002",i.Msg.CONTROLS_IF_ELSE_TOOLTIP="\u5728\u8FD9\u4E2Aif\u8BED\u53E5\u5757\u4E2D\u6DFB\u52A0\u4E00\u4E2A\u6700\u7EC8\u7684\uFF0C\u5305\u62EC\u6240\u6709\u5176\u4F59\u60C5\u51B5\u7684\u6761\u4EF6\u3002",i.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",i.Msg.CONTROLS_IF_IF_TOOLTIP="\u589E\u52A0\u3001\u5220\u9664\u6216\u91CD\u65B0\u6392\u5217\u5404\u8282\u6765\u91CD\u65B0\u914D\u7F6E\u8FD9\u4E2Aif\u8BED\u53E5\u5757\u3002",i.Msg.CONTROLS_IF_MSG_ELSE="\u5426\u5219",i.Msg.CONTROLS_IF_MSG_ELSEIF="\u5426\u5219\u5982\u679C",i.Msg.CONTROLS_IF_MSG_IF="\u5982\u679C",i.Msg.CONTROLS_IF_TOOLTIP_1="\u5982\u679C\u503C\u4E3A\u771F\uFF0C\u6267\u884C\u4E00\u4E9B\u8BED\u53E5\u3002",i.Msg.CONTROLS_IF_TOOLTIP_2="\u5982\u679C\u503C\u4E3A\u771F\uFF0C\u5219\u6267\u884C\u7B2C\u4E00\u5757\u8BED\u53E5\u3002\u5426\u5219\uFF0C\u5219\u6267\u884C\u7B2C\u4E8C\u5757\u8BED\u53E5\u3002",i.Msg.CONTROLS_IF_TOOLTIP_3="\u5982\u679C\u7B2C\u4E00\u4E2A\u503C\u4E3A\u771F\uFF0C\u5219\u6267\u884C\u7B2C\u4E00\u5757\u7684\u8BED\u53E5\u3002\u5426\u5219\uFF0C\u5982\u679C\u7B2C\u4E8C\u4E2A\u503C\u4E3A\u771F\uFF0C\u5219\u6267\u884C\u7B2C\u4E8C\u5757\u7684\u8BED\u53E5\u3002",i.Msg.CONTROLS_IF_TOOLTIP_4="\u5982\u679C\u7B2C\u4E00\u4E2A\u503C\u4E3A\u771F\uFF0C\u5219\u6267\u884C\u7B2C\u4E00\u5757\u5BF9\u8BED\u53E5\u3002\u5426\u5219\uFF0C\u5982\u679C\u7B2C\u4E8C\u4E2A\u503C\u4E3A\u771F\uFF0C\u5219\u6267\u884C\u8BED\u53E5\u7684\u7B2C\u4E8C\u5757\u3002\u5982\u679C\u6CA1\u6709\u503C\u4E3A\u771F\uFF0C\u5219\u6267\u884C\u6700\u540E\u4E00\u5757\u7684\u8BED\u53E5\u3002",i.Msg.CONTROLS_REPEAT_HELPURL="https://zh.wikipedia.org/wiki/For\u5FAA\u73AF",i.Msg.CONTROLS_REPEAT_INPUT_DO="\u6267\u884C",i.Msg.CONTROLS_REPEAT_TITLE="\u91CD\u590D %1 \u6B21",i.Msg.CONTROLS_REPEAT_TOOLTIP="\u591A\u6B21\u6267\u884C\u4E00\u4E9B\u8BED\u53E5\u3002",i.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="\u91CD\u590D\u76F4\u5230\u6761\u4EF6\u6EE1\u8DB3",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="\u5F53\u6761\u4EF6\u6EE1\u8DB3\u65F6\u91CD\u590D",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="\u53EA\u8981\u503C\u4E3A\u5047\uFF0C\u5C31\u4E00\u76F4\u5FAA\u73AF\u6267\u884C\u4E00\u4E9B\u8BED\u53E5\u3002",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="\u53EA\u8981\u503C\u4E3A\u771F\uFF0C\u5C31\u4E00\u76F4\u5FAA\u73AF\u6267\u884C\u4E00\u4E9B\u8BED\u53E5\u3002",i.Msg.DELETE_ALL_BLOCKS="\u5220\u9664\u6240\u6709 %1 \u4E2A\u5757\u5417\uFF1F",i.Msg.DELETE_BLOCK="\u5220\u9664\u5757",i.Msg.DELETE_VARIABLE="\u5220\u9664\u53D8\u91CF\u201C%1\u201D",i.Msg.DELETE_VARIABLE_CONFIRMATION="\u8981\u5220\u9664\u5BF9\u53D8\u91CF\u201C%2\u201D\u7684%1\u4E2A\u5F15\u7528\u5417\uFF1F",i.Msg.DELETE_X_BLOCKS="\u5220\u9664 %1 \u4E2A\u5757",i.Msg.DIALOG_CANCEL="\u53D6\u6D88",i.Msg.DIALOG_OK="\u786E\u8BA4",i.Msg.DISABLE_BLOCK="\u7981\u7528\u5757",i.Msg.DUPLICATE_BLOCK="\u590D\u5236",i.Msg.DUPLICATE_COMMENT="\u590D\u5236\u6CE8\u91CA",i.Msg.ENABLE_BLOCK="\u542F\u7528\u5757",i.Msg.EXPAND_ALL="\u5C55\u5F00\u5757",i.Msg.EXPAND_BLOCK="\u5C55\u5F00\u5757",i.Msg.EXTERNAL_INPUTS="\u5916\u90E8\u8F93\u5165",i.Msg.HELP="\u5E2E\u52A9",i.Msg.INLINE_INPUTS="\u5355\u884C\u8F93\u5165",i.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",i.Msg.LISTS_CREATE_EMPTY_TITLE="\u521B\u5EFA\u7A7A\u5217\u8868",i.Msg.LISTS_CREATE_EMPTY_TOOLTIP="\u8FD4\u56DE\u4E00\u4E2A\u5217\u8868\uFF0C\u957F\u5EA6\u4E3A 0\uFF0C\u4E0D\u5305\u542B\u4EFB\u4F55\u6570\u636E\u8BB0\u5F55",i.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="\u5217\u8868",i.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="\u589E\u52A0\u3001\u5220\u9664\u6216\u91CD\u65B0\u6392\u5217\u5404\u90E8\u5206\u4EE5\u6B64\u91CD\u65B0\u914D\u7F6E\u8FD9\u4E2A\u5217\u8868\u5757\u3002",i.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_CREATE_WITH_INPUT_WITH="\u521B\u5EFA\u5217\u8868\uFF0C\u5185\u5BB9\uFF1A",i.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="\u5C06\u4E00\u4E2A\u9879\u6DFB\u52A0\u5230\u5217\u8868\u4E2D\u3002",i.Msg.LISTS_CREATE_WITH_TOOLTIP="\u5EFA\u7ACB\u4E00\u4E2A\u5177\u6709\u4EFB\u610F\u6570\u91CF\u9879\u76EE\u7684\u5217\u8868\u3002",i.Msg.LISTS_GET_INDEX_FIRST="\u7B2C\u4E00\u9879",i.Msg.LISTS_GET_INDEX_FROM_END="\u5012\u6570\u7B2C#\u9879",i.Msg.LISTS_GET_INDEX_FROM_START="#",i.Msg.LISTS_GET_INDEX_GET="\u53D6\u5F97",i.Msg.LISTS_GET_INDEX_GET_REMOVE="\u53D6\u5F97\u5E76\u79FB\u9664",i.Msg.LISTS_GET_INDEX_LAST="\u6700\u540E\u4E00\u9879",i.Msg.LISTS_GET_INDEX_RANDOM="\u968F\u673A\u7684\u4E00\u9879",i.Msg.LISTS_GET_INDEX_REMOVE="\u79FB\u9664",i.Msg.LISTS_GET_INDEX_TAIL="",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u7B2C\u4E00\u9879\u3002",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="\u8FD4\u56DE\u5728\u5217\u8868\u4E2D\u7684\u6307\u5B9A\u4F4D\u7F6E\u7684\u9879\u3002",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u6700\u540E\u4E00\u9879\u3002",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u968F\u673A\u4E00\u9879\u3002",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="\u79FB\u9664\u5E76\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u7B2C\u4E00\u9879\u3002",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="\u79FB\u9664\u5E76\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u6307\u5B9A\u4F4D\u7F6E\u7684\u9879\u3002",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="\u79FB\u9664\u5E76\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u6700\u540E\u4E00\u9879\u3002",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="\u79FB\u9664\u5E76\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u968F\u673A\u4E00\u9879\u3002",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="\u79FB\u9664\u5217\u8868\u4E2D\u7684\u7B2C\u4E00\u9879",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="\u79FB\u9664\u5728\u5217\u8868\u4E2D\u7684\u6307\u5B9A\u4F4D\u7F6E\u7684\u9879\u3002",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="\u79FB\u9664\u5217\u8868\u4E2D\u7684\u6700\u540E\u4E00\u9879",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="\u5220\u9664\u5217\u8868\u4E2D\u7684\u968F\u673A\u4E00\u9879\u3002",i.Msg.LISTS_GET_SUBLIST_END_FROM_END="\u5230\u5012\u6570\u7B2C#\u9879",i.Msg.LISTS_GET_SUBLIST_END_FROM_START="\u5230\u7B2C#\u9879",i.Msg.LISTS_GET_SUBLIST_END_LAST="\u5230\u6700\u540E\u4E00\u9879",i.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",i.Msg.LISTS_GET_SUBLIST_START_FIRST="\u83B7\u53D6\u5B50\u5217\u8868\uFF0C\u4ECE\u7B2C\u4E00\u9879",i.Msg.LISTS_GET_SUBLIST_START_FROM_END="\u83B7\u53D6\u5B50\u5217\u8868\uFF0C\u4ECE\u5012\u6570\u7B2C#\u9879",i.Msg.LISTS_GET_SUBLIST_START_FROM_START="\u83B7\u53D6\u5B50\u5217\u8868\uFF0C\u4ECE\u7B2C#\u9879",i.Msg.LISTS_GET_SUBLIST_TAIL="",i.Msg.LISTS_GET_SUBLIST_TOOLTIP="\u590D\u5236\u5217\u8868\u4E2D\u6307\u5B9A\u7684\u90E8\u5206\u3002",i.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1\u662F\u6700\u540E\u4E00\u9879\u3002",i.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1\u662F\u7B2C\u4E00\u9879\u3002",i.Msg.LISTS_INDEX_OF_FIRST="\u5BFB\u627E\u7B2C\u4E00\u6B21\u51FA\u73B0\u7684\u9879",i.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",i.Msg.LISTS_INDEX_OF_LAST="\u5BFB\u627E\u6700\u540E\u4E00\u6B21\u51FA\u73B0\u7684\u9879",i.Msg.LISTS_INDEX_OF_TOOLTIP="\u8FD4\u56DE\u5728\u5217\u8868\u4E2D\u7684\u7B2C\u4E00/\u6700\u540E\u4E00\u4E2A\u5339\u914D\u9879\u7684\u7D22\u5F15\u503C\u3002\u5982\u679C\u627E\u4E0D\u5230\u9879\u76EE\u5219\u8FD4\u56DE%1\u3002",i.Msg.LISTS_INLIST="\u5728\u5217\u8868\u4E2D",i.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",i.Msg.LISTS_ISEMPTY_TITLE="%1\u662F\u7A7A\u7684",i.Msg.LISTS_ISEMPTY_TOOLTIP="\u5982\u679C\u6539\u5217\u8868\u4E3A\u7A7A\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",i.Msg.LISTS_LENGTH_TITLE="%1\u7684\u957F\u5EA6",i.Msg.LISTS_LENGTH_TOOLTIP="\u8FD4\u56DE\u5217\u8868\u7684\u957F\u5EA6\u3002",i.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_REPEAT_TITLE="\u5EFA\u7ACB\u5217\u8868\u4F7F\u7528\u9879 %1 \u91CD\u590D %2 \u6B21",i.Msg.LISTS_REPEAT_TOOLTIP="\u5EFA\u7ACB\u5305\u542B\u6307\u5B9A\u91CD\u590D\u6B21\u6570\u7684\u503C\u7684\u5217\u8868\u3002",i.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",i.Msg.LISTS_REVERSE_MESSAGE0="\u5012\u8F6C%1",i.Msg.LISTS_REVERSE_TOOLTIP="\u5012\u8F6C\u4E00\u4E2A\u5217\u8868\uFF0C\u8FD4\u56DE\u526F\u672C\u3002",i.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",i.Msg.LISTS_SET_INDEX_INPUT_TO="\u503C\u4E3A",i.Msg.LISTS_SET_INDEX_INSERT="\u63D2\u5165\u5728",i.Msg.LISTS_SET_INDEX_SET="\u8BBE\u7F6E",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="\u5728\u5217\u8868\u7684\u8D77\u59CB\u5904\u6DFB\u52A0\u8BE5\u9879\u3002",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="\u5728\u5217\u8868\u4E2D\u6307\u5B9A\u4F4D\u7F6E\u63D2\u5165\u9879\u3002",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="\u5728\u5217\u8868\u7684\u672B\u5C3E\u5904\u6DFB\u52A0\u8BE5\u9879\u3002",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="\u5728\u5217\u8868\u7684\u968F\u673A\u4F4D\u7F6E\u63D2\u5165\u8BE5\u9879\u3002",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="\u8BBE\u7F6E\u5217\u8868\u4E2D\u7684\u7B2C\u4E00\u9879\u3002",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="\u8BBE\u7F6E\u5728\u5217\u8868\u4E2D\u6307\u5B9A\u4F4D\u7F6E\u7684\u9879\u3002",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="\u8BBE\u7F6E\u5217\u8868\u4E2D\u7684\u6700\u540E\u4E00\u9879\u3002",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="\u8BBE\u7F6E\u5217\u8868\u4E2D\u7684\u968F\u673A\u4E00\u9879\u3002",i.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",i.Msg.LISTS_SORT_ORDER_ASCENDING="\u5347\u5E8F",i.Msg.LISTS_SORT_ORDER_DESCENDING="\u964D\u5E8F",i.Msg.LISTS_SORT_TITLE="\u6392\u5E8F%1 %2 %3",i.Msg.LISTS_SORT_TOOLTIP="\u6392\u5E8F\u4E00\u4E2A\u5217\u8868\uFF0C\u8FD4\u56DE\u526F\u672C\u3002",i.Msg.LISTS_SORT_TYPE_IGNORECASE="\u6309\u5B57\u6BCD\uFF08\u5FFD\u7565\u5927\u5C0F\u5199\uFF09",i.Msg.LISTS_SORT_TYPE_NUMERIC="\u6309\u6570\u5B57",i.Msg.LISTS_SORT_TYPE_TEXT="\u6309\u5B57\u6BCD",i.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",i.Msg.LISTS_SPLIT_LIST_FROM_TEXT="\u4ECE\u6587\u672C\u5236\u4F5C\u5217\u8868",i.Msg.LISTS_SPLIT_TEXT_FROM_LIST="\u5C06\u5217\u8868\u5408\u5E76\u4E3A\u6587\u672C",i.Msg.LISTS_SPLIT_TOOLTIP_JOIN="\u52A0\u5165\u6587\u672C\u5217\u8868\u81F3\u4E00\u4E2A\u6587\u672C\uFF0C\u7531\u5206\u9694\u7B26\u5206\u9694\u3002",i.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="\u5C06\u6587\u672C\u6309\u6307\u5B9A\u7684\u5206\u9694\u7B26\u62C6\u5206\u4E3A\u6587\u672C\u7EC4\u6210\u7684\u5217\u8868\u3002",i.Msg.LISTS_SPLIT_WITH_DELIMITER="\u5206\u9694\u7B26\uFF1A",i.Msg.LOGIC_BOOLEAN_FALSE="\u5047",i.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",i.Msg.LOGIC_BOOLEAN_TOOLTIP="\u8FD4\u56DE\u771F\u6216\u5047\u3002",i.Msg.LOGIC_BOOLEAN_TRUE="\u771F",i.Msg.LOGIC_COMPARE_HELPURL="https://zh.wikipedia.org/wiki/\u4E0D\u7B49",i.Msg.LOGIC_COMPARE_TOOLTIP_EQ="\u5982\u679C\u4E24\u4E2A\u8F93\u5165\u7ED3\u679C\u76F8\u7B49\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.LOGIC_COMPARE_TOOLTIP_GT="\u5982\u679C\u7B2C\u4E00\u4E2A\u8F93\u5165\u7ED3\u679C\u6BD4\u7B2C\u4E8C\u4E2A\u5927\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.LOGIC_COMPARE_TOOLTIP_GTE="\u5982\u679C\u7B2C\u4E00\u4E2A\u8F93\u5165\u7ED3\u679C\u5927\u4E8E\u6216\u7B49\u4E8E\u7B2C\u4E8C\u4E2A\u8F93\u5165\u7ED3\u679C\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.LOGIC_COMPARE_TOOLTIP_LT="\u5982\u679C\u7B2C\u4E00\u4E2A\u8F93\u5165\u7ED3\u679C\u6BD4\u7B2C\u4E8C\u4E2A\u5C0F\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.LOGIC_COMPARE_TOOLTIP_LTE="\u5982\u679C\u7B2C\u4E00\u4E2A\u8F93\u5165\u7ED3\u679C\u5C0F\u4E8E\u6216\u7B49\u4E8E\u7B2C\u4E8C\u4E2A\u8F93\u5165\u7ED3\u679C\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="\u5982\u679C\u4E24\u4E2A\u8F93\u5165\u7ED3\u679C\u4E0D\u76F8\u7B49\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",i.Msg.LOGIC_NEGATE_TITLE="\u975E%1",i.Msg.LOGIC_NEGATE_TOOLTIP="\u5982\u679C\u8F93\u5165\u7ED3\u679C\u4E3A\u5047\uFF0C\u5219\u8FD4\u56DE\u771F\uFF1B\u5982\u679C\u8F93\u5165\u7ED3\u679C\u4E3A\u771F\uFF0C\u5219\u8FD4\u56DE\u5047\u3002",i.Msg.LOGIC_NULL="\u7A7A",i.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",i.Msg.LOGIC_NULL_TOOLTIP="\u8FD4\u56DE\u7A7A\u503C\u3002",i.Msg.LOGIC_OPERATION_AND="\u5E76\u4E14",i.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",i.Msg.LOGIC_OPERATION_OR="\u6216",i.Msg.LOGIC_OPERATION_TOOLTIP_AND="\u5982\u679C\u4E24\u4E2A\u8F93\u5165\u7ED3\u679C\u90FD\u4E3A\u771F\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.LOGIC_OPERATION_TOOLTIP_OR="\u5982\u679C\u81F3\u5C11\u6709\u4E00\u4E2A\u8F93\u5165\u7ED3\u679C\u4E3A\u771F\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.LOGIC_TERNARY_CONDITION="\u65AD\u8A00",i.Msg.LOGIC_TERNARY_HELPURL="https://zh.wikipedia.org/wiki/\u6761\u4EF6\u8FD0\u7B97\u7B26",i.Msg.LOGIC_TERNARY_IF_FALSE="\u5982\u679C\u4E3A\u5047",i.Msg.LOGIC_TERNARY_IF_TRUE="\u5982\u679C\u4E3A\u771F",i.Msg.LOGIC_TERNARY_TOOLTIP="\u68C0\u67E5\u201C\u65AD\u8A00\u201D\u91CC\u7684\u6761\u4EF6\u8BED\u53E5\u3002\u5982\u679C\u6761\u4EF6\u4E3A\u771F\uFF0C\u5219\u8FD4\u56DE\u201C\u5982\u679C\u4E3A\u771F\u201D\u7684\u503C\uFF0C\u5426\u5219\uFF0C\u5219\u8FD4\u56DE\u201C\u5982\u679C\u4E3A\u5047\u201D\u7684\u503C\u3002",i.Msg.MATH_ADDITION_SYMBOL="+",i.Msg.MATH_ARITHMETIC_HELPURL="https://zh.wikipedia.org/wiki/\u7B97\u672F",i.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="\u8FD4\u56DE\u4E24\u4E2A\u6570\u503C\u7684\u548C\u3002",i.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="\u8FD4\u56DE\u4E24\u4E2A\u6570\u503C\u7684\u5546\u3002",i.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="\u8FD4\u56DE\u4E24\u4E2A\u6570\u503C\u7684\u5DEE\u3002",i.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="\u8FD4\u56DE\u4E24\u4E2A\u6570\u503C\u7684\u4E58\u79EF\u3002",i.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="\u8FD4\u56DE\u4EE5\u7B2C\u4E00\u4E2A\u6570\u503C\u4E3A\u5E95\u6570\uFF0C\u4EE5\u7B2C\u4E8C\u4E2A\u6570\u503C\u4E3A\u5E42\u7684\u7ED3\u679C\u3002",i.Msg.MATH_ATAN2_HELPURL="https://zh.wikipedia.org/wiki/\u53CD\u6B63\u52072",i.Msg.MATH_ATAN2_TITLE="\u70B9(x:%1,y:%2)\u7684\u65B9\u4F4D\u89D2",i.Msg.MATH_ATAN2_TOOLTIP="\u8FD4\u56DE\u70B9\uFF08X\uFF0CY\uFF09\u7684\u53CD\u6B63\u5207\u503C\uFF0C\u8303\u56F4\u4E3A-180\u5230180\u5EA6\u3002",i.Msg.MATH_CHANGE_HELPURL="https://zh.wikipedia.org/wiki/\u52A0\u6CD5",i.Msg.MATH_CHANGE_TITLE="\u5C06 %1 \u589E\u52A0 %2",i.Msg.MATH_CHANGE_TOOLTIP="\u4E3A\u53D8\u91CF\u201C%1\u201D\u589E\u52A0\u4E00\u4E2A\u6570\u503C\u3002",i.Msg.MATH_CONSTANT_HELPURL="https://zh.wikipedia.org/wiki/\u6570\u5B66\u5E38\u6570",i.Msg.MATH_CONSTANT_TOOLTIP="\u8FD4\u56DE\u4E00\u4E2A\u5E38\u89C1\u5E38\u91CF\uFF1A\u03C0 (3.141\u2026)\u3001e (2.718\u2026)\u3001\u03C6 (1.618\u2026)\u3001\u6839\u53F72 (1.414\u2026)\u3001\u6839\u53F7\u4E8C\u5206\u4E4B\u4E00 (0.707\u2026)\u6216\u221E (\u65E0\u7A77\u5927)\u3002",i.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",i.Msg.MATH_CONSTRAIN_TITLE="\u5C06 %1 \u9650\u5236\u5728 \u6700\u4F4E %2 \u5230\u6700\u9AD8 %3 \u4E4B\u95F4",i.Msg.MATH_CONSTRAIN_TOOLTIP="\u5C06\u4E00\u4E2A\u6570\u503C\u9650\u5236\u5728\u4E24\u4E2A\u6307\u5B9A\u7684\u6570\u503C\u8303\u56F4\uFF08\u542B\u8FB9\u754C\uFF09\u4E4B\u95F4\u3002",i.Msg.MATH_DIVISION_SYMBOL="\xF7",i.Msg.MATH_IS_DIVISIBLE_BY="\u53EF\u88AB\u6574\u9664",i.Msg.MATH_IS_EVEN="\u662F\u5076\u6570",i.Msg.MATH_IS_NEGATIVE="\u662F\u8D1F\u6570",i.Msg.MATH_IS_ODD="\u662F\u5947\u6570",i.Msg.MATH_IS_POSITIVE="\u662F\u6B63\u6570",i.Msg.MATH_IS_PRIME="\u662F\u8D28\u6570",i.Msg.MATH_IS_TOOLTIP="\u68C0\u67E5\u4E00\u4E2A\u6570\u503C\u662F\u5426\u662F\u5076\u6570\u3001\u5947\u6570\u3001\u8D28\u6570\u3001\u81EA\u7136\u6570\u3001\u6B63\u6570\u3001\u8D1F\u6570\u6216\u8005\u662F\u5426\u80FD\u88AB\u67D0\u6570\u6574\u9664\u3002\u8FD4\u56DE\u771F\u6216\u5047\u3002",i.Msg.MATH_IS_WHOLE="\u662F\u6574\u6570",i.Msg.MATH_MODULO_HELPURL="https://zh.wikipedia.org/wiki/\u6A21\u9664",i.Msg.MATH_MODULO_TITLE="\u53D6 %1 \xF7 %2 \u7684\u4F59\u6570",i.Msg.MATH_MODULO_TOOLTIP="\u8FD4\u56DE\u8FD9\u4E24\u4E2A\u6570\u5B57\u76F8\u9664\u540E\u7684\u4F59\u6570\u3002",i.Msg.MATH_MULTIPLICATION_SYMBOL="\xD7",i.Msg.MATH_NUMBER_HELPURL="https://zh.wikipedia.org/wiki/\u6570",i.Msg.MATH_NUMBER_TOOLTIP="\u4E00\u4E2A\u6570\u503C\u3002",i.Msg.MATH_ONLIST_HELPURL="",i.Msg.MATH_ONLIST_OPERATOR_AVERAGE="\u5217\u8868\u5E73\u5747\u503C",i.Msg.MATH_ONLIST_OPERATOR_MAX="\u5217\u8868\u6700\u5927\u503C",i.Msg.MATH_ONLIST_OPERATOR_MEDIAN="\u5217\u8868\u4E2D\u4F4D\u6570",i.Msg.MATH_ONLIST_OPERATOR_MIN="\u5217\u8868\u6700\u5C0F\u503C",i.Msg.MATH_ONLIST_OPERATOR_MODE="\u5217\u8868\u4E2D\u7684\u4F17\u6570",i.Msg.MATH_ONLIST_OPERATOR_RANDOM="\u5217\u8868\u4E2D\u7684\u968F\u673A\u4E00\u9879",i.Msg.MATH_ONLIST_OPERATOR_STD_DEV="\u5217\u8868\u7684\u6807\u51C6\u5DEE",i.Msg.MATH_ONLIST_OPERATOR_SUM="\u5217\u8868\u4E2D\u6570\u503C\u7684\u548C",i.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u6570\u503C\u7684\u5E73\u5747\u503C\u3002",i.Msg.MATH_ONLIST_TOOLTIP_MAX="\u8FD4\u56DE\u5217\u8868\u4E2D\u6700\u5927\u503C\u3002",i.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="\u8FD4\u56DE\u5217\u8868\u4E2D\u6570\u503C\u7684\u4E2D\u4F4D\u6570\u3002",i.Msg.MATH_ONLIST_TOOLTIP_MIN="\u8FD4\u56DE\u5217\u8868\u4E2D\u6700\u5C0F\u503C\u3002",i.Msg.MATH_ONLIST_TOOLTIP_MODE="\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u51FA\u73B0\u6B21\u6570\u6700\u591A\u7684\u9879\u7684\u5217\u8868\u3002",i.Msg.MATH_ONLIST_TOOLTIP_RANDOM="\u4ECE\u5217\u8868\u4E2D\u8FD4\u56DE\u4E00\u4E2A\u968F\u673A\u7684\u5143\u7D20\u3002",i.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="\u8FD4\u56DE\u5217\u8868\u7684\u6807\u51C6\u5DEE\u3002",i.Msg.MATH_ONLIST_TOOLTIP_SUM="\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u6240\u6709\u6570\u503C\u7684\u548C\u3002",i.Msg.MATH_POWER_SYMBOL="^",i.Msg.MATH_RANDOM_FLOAT_HELPURL="https://zh.wikipedia.org/wiki/\u968F\u673A\u6570\u751F\u6210\u5668",i.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="\u968F\u673A\u5C0F\u6570",i.Msg.MATH_RANDOM_FLOAT_TOOLTIP="\u8FD4\u56DE\u4E00\u4E2A\u4ECE0.0\uFF08\u542B\uFF09\u52301.0\uFF08\u4E0D\u542B\uFF09\u4E4B\u95F4\u7684\u968F\u673A\u6570\u3002",i.Msg.MATH_RANDOM_INT_HELPURL="https://zh.wikipedia.org/wiki/\u968F\u673A\u6570\u751F\u6210\u5668",i.Msg.MATH_RANDOM_INT_TITLE="\u4ECE %1 \u5230 %2 \u8303\u56F4\u5185\u7684\u968F\u673A\u6574\u6570",i.Msg.MATH_RANDOM_INT_TOOLTIP="\u8FD4\u56DE\u4E00\u4E2A\u9650\u5236\u5728\u4E24\u4E2A\u6307\u5B9A\u6570\u503C\u7684\u8303\u56F4\uFF08\u542B\u8FB9\u754C\uFF09\u4E4B\u95F4\u7684\u968F\u673A\u6574\u6570\u3002",i.Msg.MATH_ROUND_HELPURL="https://zh.wikipedia.org/wiki/\u6570\u503C\u4FEE\u7EA6",i.Msg.MATH_ROUND_OPERATOR_ROUND="\u56DB\u820D\u4E94\u5165",i.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="\u5411\u4E0B\u820D\u5165",i.Msg.MATH_ROUND_OPERATOR_ROUNDUP="\u5411\u4E0A\u820D\u5165",i.Msg.MATH_ROUND_TOOLTIP="\u6570\u5B57\u5411\u4E0A\u6216\u5411\u4E0B\u820D\u5165\u3002",i.Msg.MATH_SINGLE_HELPURL="https://zh.wikipedia.org/wiki/\u5E73\u65B9\u6839",i.Msg.MATH_SINGLE_OP_ABSOLUTE="\u7EDD\u5BF9\u503C",i.Msg.MATH_SINGLE_OP_ROOT="\u5E73\u65B9\u6839",i.Msg.MATH_SINGLE_TOOLTIP_ABS="\u8FD4\u56DE\u4E00\u4E2A\u6570\u503C\u7684\u7EDD\u5BF9\u503C\u3002",i.Msg.MATH_SINGLE_TOOLTIP_EXP="\u8FD4\u56DEe\u7684n\u6B21\u5E42\u3002",i.Msg.MATH_SINGLE_TOOLTIP_LN="\u8FD4\u56DE\u4E00\u4E2A\u6570\u503C\u7684\u81EA\u7136\u5BF9\u6570\u3002",i.Msg.MATH_SINGLE_TOOLTIP_LOG10="\u8FD4\u56DE\u4E00\u4E2A\u6570\u503C\u7684\u4EE510\u4E3A\u5E95\u7684\u5BF9\u6570\u3002",i.Msg.MATH_SINGLE_TOOLTIP_NEG="\u8FD4\u56DE\u4E00\u4E2A\u6570\u503C\u7684\u76F8\u53CD\u6570\u3002",i.Msg.MATH_SINGLE_TOOLTIP_POW10="\u8FD4\u56DE10\u7684n\u6B21\u5E42\u3002",i.Msg.MATH_SINGLE_TOOLTIP_ROOT="\u8FD4\u56DE\u4E00\u4E2A\u6570\u7684\u5E73\u65B9\u6839\u3002",i.Msg.MATH_SUBTRACTION_SYMBOL="-",i.Msg.MATH_TRIG_ACOS="acos",i.Msg.MATH_TRIG_ASIN="asin",i.Msg.MATH_TRIG_ATAN="atan",i.Msg.MATH_TRIG_COS="cos",i.Msg.MATH_TRIG_HELPURL="https://zh.wikipedia.org/wiki/\u4E09\u89D2\u51FD\u6570",i.Msg.MATH_TRIG_SIN="sin",i.Msg.MATH_TRIG_TAN="tan",i.Msg.MATH_TRIG_TOOLTIP_ACOS="\u8FD4\u56DE\u4E00\u4E2A\u6570\u503C\u7684\u53CD\u4F59\u5F26\u503C\u3002",i.Msg.MATH_TRIG_TOOLTIP_ASIN="\u8FD4\u56DE\u4E00\u4E2A\u6570\u503C\u7684\u53CD\u6B63\u5F26\u503C\u3002",i.Msg.MATH_TRIG_TOOLTIP_ATAN="\u8FD4\u56DE\u4E00\u4E2A\u6570\u503C\u7684\u53CD\u6B63\u5207\u503C\u3002",i.Msg.MATH_TRIG_TOOLTIP_COS="\u8FD4\u56DE\u6307\u5B9A\u89D2\u5EA6\u7684\u4F59\u5F26\u503C\uFF08\u975E\u5F27\u5EA6\uFF09\u3002",i.Msg.MATH_TRIG_TOOLTIP_SIN="\u8FD4\u56DE\u6307\u5B9A\u89D2\u5EA6\u7684\u6B63\u5F26\u503C\uFF08\u975E\u5F27\u5EA6\uFF09\u3002",i.Msg.MATH_TRIG_TOOLTIP_TAN="\u8FD4\u56DE\u6307\u5B9A\u89D2\u5EA6\u7684\u6B63\u5207\u503C\uFF08\u975E\u5F27\u5EA6\uFF09\u3002",i.Msg.NEW_COLOUR_VARIABLE="\u521B\u5EFA\u989C\u8272\u53D8\u91CF...",i.Msg.NEW_NUMBER_VARIABLE="\u521B\u5EFA\u6570\u5B57\u53D8\u91CF...",i.Msg.NEW_STRING_VARIABLE="\u521B\u5EFA\u5B57\u7B26\u4E32\u53D8\u91CF...",i.Msg.NEW_VARIABLE="\u521B\u5EFA\u53D8\u91CF...",i.Msg.NEW_VARIABLE_TITLE="\u65B0\u53D8\u91CF\u7684\u540D\u79F0\uFF1A",i.Msg.NEW_VARIABLE_TYPE_TITLE="\u65B0\u53D8\u91CF\u7684\u7C7B\u578B\uFF1A",i.Msg.ORDINAL_NUMBER_SUFFIX="",i.Msg.PROCEDURES_ALLOW_STATEMENTS="\u5141\u8BB8\u58F0\u660E",i.Msg.PROCEDURES_BEFORE_PARAMS="\u4E0E\uFF1A",i.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://zh.wikipedia.org/wiki/\u5B50\u7A0B\u5E8F",i.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="\u8FD0\u884C\u7528\u6237\u5B9A\u4E49\u7684\u51FD\u6570\u201C%1\u201D\u3002",i.Msg.PROCEDURES_CALLRETURN_HELPURL="https://zh.wikipedia.org/wiki/\u5B50\u7A0B\u5E8F",i.Msg.PROCEDURES_CALLRETURN_TOOLTIP="\u8FD0\u884C\u7528\u6237\u5B9A\u4E49\u7684\u51FD\u6570\u201C%1\u201D\uFF0C\u5E76\u4F7F\u7528\u5B83\u7684\u8F93\u51FA\u503C\u3002",i.Msg.PROCEDURES_CALL_BEFORE_PARAMS="\u4E0E\uFF1A",i.Msg.PROCEDURES_CREATE_DO="\u521B\u5EFA\u201C%1\u201D",i.Msg.PROCEDURES_DEFNORETURN_COMMENT="\u63CF\u8FF0\u8BE5\u529F\u80FD...",i.Msg.PROCEDURES_DEFNORETURN_DO="",i.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://zh.wikipedia.org/wiki/\u5B50\u7A0B\u5E8F",i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="\u505A\u70B9\u4EC0\u4E48",i.Msg.PROCEDURES_DEFNORETURN_TITLE="\u81F3",i.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="\u521B\u5EFA\u4E00\u4E2A\u4E0D\u5E26\u8F93\u51FA\u503C\u7684\u51FD\u6570\u3002",i.Msg.PROCEDURES_DEFRETURN_HELPURL="https://zh.wikipedia.org/wiki/\u5B50\u7A0B\u5E8F",i.Msg.PROCEDURES_DEFRETURN_RETURN="\u8FD4\u56DE",i.Msg.PROCEDURES_DEFRETURN_TOOLTIP="\u521B\u5EFA\u4E00\u4E2A\u6709\u8F93\u51FA\u503C\u7684\u51FD\u6570\u3002",i.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="\u8B66\u544A\uFF1A\u6B64\u51FD\u6570\u5177\u6709\u91CD\u590D\u53C2\u6570\u3002",i.Msg.PROCEDURES_HIGHLIGHT_DEF="\u7A81\u51FA\u663E\u793A\u51FD\u6570\u5B9A\u4E49",i.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",i.Msg.PROCEDURES_IFRETURN_TOOLTIP="\u5982\u679C\u503C\u4E3A\u771F\uFF0C\u5219\u8FD4\u56DE\u7B2C\u4E8C\u4E2A\u503C\u3002",i.Msg.PROCEDURES_IFRETURN_WARNING="\u8B66\u544A\uFF1A\u8FD9\u4E2A\u5757\u53EA\u80FD\u5728\u51FD\u6570\u5185\u90E8\u4F7F\u7528\u3002",i.Msg.PROCEDURES_MUTATORARG_TITLE="\u8F93\u5165\u540D\u79F0\uFF1A",i.Msg.PROCEDURES_MUTATORARG_TOOLTIP="\u6DFB\u52A0\u51FD\u6570\u8F93\u5165\u3002",i.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="\u8F93\u5165",i.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="\u6DFB\u52A0\u3001\u79FB\u9664\u6216\u91CD\u65B0\u6392\u6B64\u51FD\u6570\u7684\u8F93\u5165\u3002",i.Msg.REDO="\u91CD\u505A",i.Msg.REMOVE_COMMENT="\u5220\u9664\u6CE8\u91CA",i.Msg.RENAME_VARIABLE="\u91CD\u547D\u540D\u53D8\u91CF...",i.Msg.RENAME_VARIABLE_TITLE="\u5C06\u6240\u6709\u201C%1\u201D\u53D8\u91CF\u91CD\u547D\u540D\u4E3A:",i.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_APPEND_TITLE="\u5728%1\u4E4B\u540E\u52A0\u4E0A\u6587\u672C%2",i.Msg.TEXT_APPEND_TOOLTIP="\u5C06\u4E00\u4E9B\u6587\u672C\u8FFD\u52A0\u5230\u53D8\u91CF\u201C%1\u201D\u91CC\u3002",i.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",i.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="\u8F6C\u4E3A\u5C0F\u5199",i.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="\u8F6C\u4E3A\u9996\u5B57\u6BCD\u5927\u5199",i.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="\u8F6C\u4E3A\u5927\u5199",i.Msg.TEXT_CHANGECASE_TOOLTIP="\u7528\u4E0D\u540C\u7684\u5927\u5C0F\u5199\u6A21\u5F0F\u590D\u5236\u5E76\u8FD4\u56DE\u8FD9\u6BB5\u6587\u5B57\u3002",i.Msg.TEXT_CHARAT_FIRST="\u83B7\u53D6\u7B2C\u4E00\u4E2A\u5B57\u7B26",i.Msg.TEXT_CHARAT_FROM_END="\u83B7\u53D6\u5012\u6570\u7B2C#\u4E2A\u5B57\u7B26",i.Msg.TEXT_CHARAT_FROM_START="\u83B7\u53D6\u7B2C#\u4E2A\u5B57\u7B26",i.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",i.Msg.TEXT_CHARAT_LAST="\u83B7\u53D6\u6700\u540E\u4E00\u4E2A\u5B57\u7B26",i.Msg.TEXT_CHARAT_RANDOM="\u83B7\u53D6\u968F\u673A\u4E00\u4E2A\u5B57\u7B26",i.Msg.TEXT_CHARAT_TAIL="",i.Msg.TEXT_CHARAT_TITLE="\u5728\u6587\u672C%1 \u91CC %2",i.Msg.TEXT_CHARAT_TOOLTIP="\u8FD4\u56DE\u4F4D\u4E8E\u6307\u5B9A\u4F4D\u7F6E\u7684\u5B57\u7B26\u3002",i.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",i.Msg.TEXT_COUNT_MESSAGE0="\u8BA1\u7B97%1\u5728%2\u91CC\u51FA\u73B0\u7684\u6B21\u6570",i.Msg.TEXT_COUNT_TOOLTIP="\u8BA1\u7B97\u5728\u4E00\u6BB5\u6587\u672C\u4E2D\uFF0C\u67D0\u4E2A\u90E8\u5206\u6587\u672C\u91CD\u590D\u51FA\u73B0\u4E86\u591A\u5C11\u6B21\u3002",i.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="\u5C06\u4E00\u4E2A\u9879\u6DFB\u52A0\u5230\u6587\u672C\u4E2D\u3002",i.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="\u62FC\u63A5",i.Msg.TEXT_CREATE_JOIN_TOOLTIP="\u6DFB\u52A0\u3001\u79FB\u9664\u6216\u91CD\u65B0\u6392\u5217\u5404\u8282\u6765\u91CD\u65B0\u914D\u7F6E\u8FD9\u4E2A\u6587\u672C\u5757\u3002",i.Msg.TEXT_GET_SUBSTRING_END_FROM_END="\u5230\u5012\u6570\u7B2C#\u4E2A\u5B57\u7B26",i.Msg.TEXT_GET_SUBSTRING_END_FROM_START="\u5230\u7B2C#\u4E2A\u5B57\u7B26",i.Msg.TEXT_GET_SUBSTRING_END_LAST="\u5230\u6700\u540E\u4E00\u4E2A\u5B57\u7B26",i.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",i.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="\u4ECE\u6587\u672C",i.Msg.TEXT_GET_SUBSTRING_START_FIRST="\u83B7\u53D6\u5B50\u4E32\uFF0C\u4ECE\u7B2C\u4E00\u4E2A\u5B57\u7B26",i.Msg.TEXT_GET_SUBSTRING_START_FROM_END="\u83B7\u53D6\u5B50\u4E32\uFF0C\u4ECE\u5012\u6570\u7B2C#\u4E2A\u5B57\u7B26",i.Msg.TEXT_GET_SUBSTRING_START_FROM_START="\u83B7\u53D6\u5B50\u4E32\uFF0C\u4ECE\u7B2C#\u4E2A\u5B57\u7B26",i.Msg.TEXT_GET_SUBSTRING_TAIL="",i.Msg.TEXT_GET_SUBSTRING_TOOLTIP="\u8FD4\u56DE\u6587\u672C\u4E2D\u6307\u5B9A\u7684\u4E00\u90E8\u5206\u3002",i.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",i.Msg.TEXT_INDEXOF_OPERATOR_FIRST="\u5BFB\u627E\u7B2C\u4E00\u6B21\u51FA\u73B0\u7684\u6587\u672C",i.Msg.TEXT_INDEXOF_OPERATOR_LAST="\u5BFB\u627E\u6700\u540E\u4E00\u6B21\u51FA\u73B0\u7684\u6587\u672C",i.Msg.TEXT_INDEXOF_TITLE="\u5728\u6587\u672C %1 \u91CC %2  %3",i.Msg.TEXT_INDEXOF_TOOLTIP="\u8FD4\u56DE\u7B2C\u4E00\u4E2A\u6587\u672C\u6BB5\u5728\u7B2C\u4E8C\u4E2A\u6587\u672C\u6BB5\u4E2D\u7684\u7B2C\u4E00/\u6700\u540E\u4E00\u4E2A\u5339\u914D\u9879\u7684\u8D77\u59CB\u4F4D\u7F6E\u3002\u5982\u679C\u672A\u627E\u5230\uFF0C\u5219\u8FD4\u56DE%1\u3002",i.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",i.Msg.TEXT_ISEMPTY_TITLE="%1\u662F\u7A7A\u7684",i.Msg.TEXT_ISEMPTY_TOOLTIP="\u5982\u679C\u7ED9\u5B9A\u7684\u6587\u672C\u4E3A\u7A7A\uFF0C\u5219\u8FD4\u56DE\u771F\u3002",i.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",i.Msg.TEXT_JOIN_TITLE_CREATEWITH="\u521B\u5EFA\u6587\u672C\uFF0C\u5185\u5BB9\uFF1A",i.Msg.TEXT_JOIN_TOOLTIP="\u901A\u8FC7\u4E32\u8D77\u4EFB\u610F\u6570\u91CF\u7684\u9879\u4EE5\u5EFA\u7ACB\u4E00\u6BB5\u6587\u672C\u3002",i.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_LENGTH_TITLE="%1\u7684\u957F\u5EA6",i.Msg.TEXT_LENGTH_TOOLTIP="\u8FD4\u56DE\u7ED9\u5B9A\u6587\u672C\u7684\u5B57\u6BCD\u6570\uFF08\u5305\u62EC\u7A7A\u683C\uFF09\u3002",i.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",i.Msg.TEXT_PRINT_TITLE="\u8F93\u51FA%1",i.Msg.TEXT_PRINT_TOOLTIP="\u8F93\u51FA\u6307\u5B9A\u7684\u6587\u5B57\u3001\u6570\u5B57\u6216\u5176\u4ED6\u503C\u3002",i.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",i.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="\u8981\u6C42\u7528\u6237\u8F93\u5165\u6570\u5B57\u3002",i.Msg.TEXT_PROMPT_TOOLTIP_TEXT="\u8981\u6C42\u7528\u6237\u8F93\u5165\u4E00\u4E9B\u6587\u672C\u3002",i.Msg.TEXT_PROMPT_TYPE_NUMBER="\u8981\u6C42\u8F93\u5165\u6570\u5B57\uFF0C\u5E76\u663E\u793A\u63D0\u793A\u6D88\u606F",i.Msg.TEXT_PROMPT_TYPE_TEXT="\u8981\u6C42\u8F93\u5165\u6587\u672C\uFF0C\u5E76\u663E\u793A\u63D0\u793A\u6D88\u606F",i.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",i.Msg.TEXT_REPLACE_MESSAGE0="\u628A%3\u4E2D\u7684%1\u66FF\u6362\u4E3A%2",i.Msg.TEXT_REPLACE_TOOLTIP="\u5728\u4E00\u6BB5\u6587\u672C\u4E2D\uFF0C\u5C06\u51FA\u73B0\u8FC7\u7684\u67D0\u90E8\u5206\u6587\u672C\u90FD\u66FF\u6362\u6389\u3002",i.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",i.Msg.TEXT_REVERSE_MESSAGE0="\u5012\u8F6C\u6587\u672C%1",i.Msg.TEXT_REVERSE_TOOLTIP="\u5C06\u6587\u672C\u4E2D\u5404\u4E2A\u5B57\u7B26\u7684\u987A\u5E8F\u5012\u8F6C\u3002",i.Msg.TEXT_TEXT_HELPURL="https://zh.wikipedia.org/wiki/\u5B57\u7B26\u4E32",i.Msg.TEXT_TEXT_TOOLTIP="\u4E00\u4E2A\u5B57\u3001\u8BCD\u8BED\u6216\u4E00\u884C\u6587\u672C\u3002",i.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",i.Msg.TEXT_TRIM_OPERATOR_BOTH="\u6D88\u9664\u5176\u4E24\u4FA7\u7684\u7A7A\u767D",i.Msg.TEXT_TRIM_OPERATOR_LEFT="\u6D88\u9664\u5176\u5DE6\u4FA7\u7684\u7A7A\u767D",i.Msg.TEXT_TRIM_OPERATOR_RIGHT="\u6D88\u9664\u5176\u53F3\u4FA7\u7684\u7A7A\u767D",i.Msg.TEXT_TRIM_TOOLTIP="\u4ECE\u67D0\u4E00\u7AEF\u6216\u540C\u65F6\u4ECE\u4E24\u7AEF\u5220\u9664\u591A\u4F59\u7684\u7A7A\u767D\uFF0C\u5E76\u8FD4\u56DE\u8FD9\u6BB5\u6587\u5B57\u7684\u4E00\u4E2A\u526F\u672C\u3002",i.Msg.TODAY="\u4ECA\u5929",i.Msg.UNDO="\u64A4\u9500",i.Msg.UNNAMED_KEY="\u672A\u547D\u540D",i.Msg.VARIABLES_DEFAULT_NAME="\u9879\u76EE",i.Msg.VARIABLES_GET_CREATE_SET="\u521B\u5EFA\u201C\u8BBE\u5B9A%1\u201D",i.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",i.Msg.VARIABLES_GET_TOOLTIP="\u8FD4\u56DE\u6B64\u53D8\u91CF\u7684\u503C\u3002",i.Msg.VARIABLES_SET="\u8D4B\u503C %1 \u4E3A %2",i.Msg.VARIABLES_SET_CREATE_GET="\u521B\u5EFA\u201C\u83B7\u5F97%1\u201D",i.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",i.Msg.VARIABLES_SET_TOOLTIP="\u8BBE\u7F6E\u6B64\u53D8\u91CF\uFF0C\u4EE5\u4F7F\u5B83\u548C\u8F93\u5165\u503C\u76F8\u7B49\u3002",i.Msg.VARIABLE_ALREADY_EXISTS="\u540D\u5B57\u53EB\u201C%1\u201D\u7684\u53D8\u91CF\u5DF2\u7ECF\u5B58\u5728\u4E86\u3002",i.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="\u540D\u5B57\u53EB\u201C%1\u201D\u7684\u53D8\u91CF\u5DF2\u7ECF\u6709\u4E86\u53E6\u4E00\u4E2A\u7C7B\u578B\uFF1A\u201C%2\u201D\u3002",i.Msg.WORKSPACE_ARIA_LABEL="Blockly\u5DE5\u4F5C\u533A",i.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="\u8BF4\u70B9\u4EC0\u4E48...",i.Msg.CONTROLS_FOREACH_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_FOR_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=i.Msg.CONTROLS_IF_MSG_ELSEIF,i.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=i.Msg.CONTROLS_IF_MSG_ELSE,i.Msg.CONTROLS_IF_IF_TITLE_IF=i.Msg.CONTROLS_IF_MSG_IF,i.Msg.CONTROLS_IF_MSG_THEN=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.LISTS_CREATE_WITH_ITEM_TITLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.LISTS_GET_INDEX_HELPURL=i.Msg.LISTS_INDEX_OF_HELPURL,i.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.MATH_CHANGE_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.PROCEDURES_DEFRETURN_COMMENT=i.Msg.PROCEDURES_DEFNORETURN_COMMENT,i.Msg.PROCEDURES_DEFRETURN_DO=i.Msg.PROCEDURES_DEFNORETURN_DO,i.Msg.PROCEDURES_DEFRETURN_PROCEDURE=i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,i.Msg.PROCEDURES_DEFRETURN_TITLE=i.Msg.PROCEDURES_DEFNORETURN_TITLE,i.Msg.TEXT_APPEND_VARIABLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.MATH_HUE="230",i.Msg.LOOPS_HUE="120",i.Msg.LISTS_HUE="260",i.Msg.LOGIC_HUE="210",i.Msg.VARIABLES_HUE="330",i.Msg.TEXTS_HUE="160",i.Msg.PROCEDURES_HUE="290",i.Msg.COLOUR_HUE="20",i.Msg.VARIABLES_DYNAMIC_HUE="310",i.Msg})}(pg)),pg.exports}var o0=dP();const _P=Jf(o0),pP=mw({__proto__:null,default:_P},[o0]),gP=`
  .blocklyFieldParameter>rect {
    fill: rgb(222, 143, 108);
    fill-opacity: 1.0;
    stroke-width: 2;
    stroke: rgb(231, 175, 150);
  }
  .blocklyFieldParameter>text {
    stroke-width: 1;
    fill: #000;
  }
  .blocklyFieldParameter:hover>rect {
    stroke-width: 2;
    stroke: rgb(231,175,150);
    fill: rgb(231,175,150);
    fill-opacity: 1.0;
  }
  /*
   * [lyn, 10/08/13] Control flydown with the getter/setter blocks.
   */
  .blocklyFieldParameterFlydown {
    fill: rgb(231,175,150);
    fill-opacity: 0.8;
  }
  /*
   * [lyn, 10/08/13] Control parameter fields with flydown procedure
   * caller block.
   */
  .blocklyFieldProcedure>rect {
    fill: rgb(215,203,218);
    fill-opacity: 1.0;
    stroke-width: 0;
    stroke: #000;
  }
  .blocklyFieldProcedure>text {
    fill: #000;
  }
  .blocklyFieldProcedure:hover>rect {
    stroke-width: 2;
    stroke: #fff;
    fill: rgb(215,203,218);
    fill-opacity: 1.0;
  }
  /*
   * [lyn, 10/08/13] Control flydown with the procedure caller block.
   */
  .blocklyFieldProcedureFlydown {
    fill: rgb(215,203,218);
    fill-opacity: 0.8;
  }
`;function fP(){k.Css.register(gP)}/**
 * @license
 * Copyright 2021 Mark Friedman
 * SPDX-License-Identifier: Apache-2.0
 */k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT="initialize global";k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME="name";k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO="to";k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_COLLAPSED_TEXT="global";k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP="Creates a global variable and gives it the value of the attached blocks.";k.Msg.LANG_VARIABLES_GLOBAL_PREFIX="global";k.Msg.LANG_VARIABLES_GET_TITLE_GET="get";k.Msg.LANG_VARIABLES_GET_COLLAPSED_TEXT="get";k.Msg.LANG_VARIABLES_GET_TOOLTIP="Returns the value of this variable.";k.Msg.LANG_VARIABLES_SET_TITLE_SET="set";k.Msg.LANG_VARIABLES_SET_TITLE_TO="to";k.Msg.LANG_VARIABLES_SET_COLLAPSED_TEXT="set";k.Msg.LANG_VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.";k.Msg.LANG_VARIABLES_VARIABLE=" variable";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT="initialize local";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME="name";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO="to";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO="in";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_COLLAPSED_TEXT="local";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP="Allows you to create variables that are only accessible in the do part of this block.";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TRANSLATED_NAME="initialize local in do";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN="in";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_COLLAPSED_TEXT="local";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP="Allows you to create variables that are only accessible in the return part of this block.";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TRANSLATED_NAME="initialize local in return";k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES="local names";k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP="";k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME="name";k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE="x";k.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE="to";k.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE="procedure";k.Msg.LANG_PROCEDURES_DEFNORETURN_DO="do";k.Msg.LANG_PROCEDURES_DEFNORETURN_COLLAPSED_PREFIX="to ";k.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP="A procedure that does not return a value.";k.Msg.LANG_PROCEDURES_DOTHENRETURN_THEN_RETURN="result";k.Msg.LANG_PROCEDURES_DOTHENRETURN_DO="do";k.Msg.LANG_PROCEDURES_DOTHENRETURN_RETURN="result";k.Msg.LANG_PROCEDURES_DOTHENRETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";k.Msg.LANG_PROCEDURES_DOTHENRETURN_COLLAPSED_TEXT="do/result";k.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE="to";k.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE="procedure";k.Msg.LANG_PROCEDURES_DEFRETURN_RETURN="result";k.Msg.LANG_PROCEDURES_DEFRETURN_COLLAPSED_PREFIX="to ";k.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP="A procedure returning a result value.";k.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING=`Warning:
This procedure has
duplicate inputs.`;k.Msg.LANG_PROCEDURES_CALLNORETURN_CALL="call ";k.Msg.LANG_PROCEDURES_CALLNORETURN_PROCEDURE="procedure";k.Msg.LANG_PROCEDURES_CALLNORETURN_COLLAPSED_PREFIX="call ";k.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP="Call a procedure with no return value.";k.Msg.LANG_PROCEDURES_CALLNORETURN_TRANSLATED_NAME="call no return";k.Msg.LANG_PROCEDURES_CALLRETURN_COLLAPSED_PREFIX="call ";k.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP="Call a procedure with a return value.";k.Msg.LANG_PROCEDURES_CALLRETURN_TRANSLATED_NAME="call return";k.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE="inputs";k.Msg.LANG_PROCEDURES_MUTATORARG_TITLE="input:";k.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF="Highlight Procedure";k.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP="";k.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP="";k.Msg.LANG_CONTROLS_FOR_INPUT_WITH="count with";k.Msg.LANG_CONTROLS_FOR_INPUT_VAR="x";k.Msg.LANG_CONTROLS_FOR_INPUT_FROM="from";k.Msg.LANG_CONTROLS_FOR_INPUT_TO="to";k.Msg.LANG_CONTROLS_FOR_INPUT_DO="do";k.Msg.LANG_CONTROLS_FOR_TOOLTIP=`Count from a start number to an end number.
For each count, set the current count number to
variable '%1', and then do some statements.`;k.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM="for each";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR="number";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_START="from";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_END="to";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP="by";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO="do";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_TEXT="for number in range";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_PREFIX="for";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_SUFFIX=" in range";k.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP="Runs the blocks in the 'do' section for each numeric value in the range from start to end, stepping the value each time.  Use the given variable name to refer to the current value.";k.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM="for each";k.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR="item";k.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST="in list";k.Msg.LANG_CONTROLS_FOREACH_INPUT_DO="do";k.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_TEXT="for item in list";k.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_PREFIX="for ";k.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_SUFFIX=" in list";k.Msg.LANG_CONTROLS_FOREACH_TOOLTIP="Runs the blocks in the 'do'  section for each item in the list.  Use the given variable name to refer to the current list item.";k.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT="for each %1 with %2 in dictionary %3";k.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_DO="do";k.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_KEY="key";k.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_VALUE="value";k.Msg.LANG_CONTROLS_FOREACH_DICT_TITLE="for each in dictionary";k.Msg.LANG_CONTROLS_FOREACH_DICT_TOOLTIP="Runs the blocks in the 'do' section for each key-value entry in the dictionary. Use the given variable names to refer to the key/value of the current dictionary item.";k.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN="Select a valid item in the drop down.";k.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION="This block cannot be in a definition";k.Msg.HORIZONTAL_PARAMETERS="Arrange Parameters Horizontally";k.Msg.VERTICAL_PARAMETERS="Arrange Parameters Vertically";k.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO="do";k.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN="result";k.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";k.Msg.LANG_CONTROLS_DO_THEN_RETURN_COLLAPSED_TEXT="do/result";k.Msg.LANG_CONTROLS_DO_THEN_RETURN_TITLE="do result";const d$=function(s,n){return!s.sourceBlock_.rendered||!n.sourceBlock_.rendered?(n.check_&&!n.check_.includes("InstantInTime")&&n.sourceBlock_.badBlock(),true):!n.check_||n.check_.includes("InstantInTime")},mP={number:{input:["Number"],output:["Number","String","Key"]},text:{input:["String"],output:["Number","String","Key"]},boolean:{input:["Boolean"],output:["Boolean","String"]},list:{input:["Array"],output:["Array","String"]},component:{input:["COMPONENT"],output:["COMPONENT","Key"]},InstantInTime:{input:["InstantInTime",d$],output:["InstantInTime",d$]},any:{input:null,output:null},dictionary:{input:["Dictionary"],output:["Dictionary","String","Array"]},pair:{input:["Pair"],output:["Pair","String","Array"]},key:{input:["Key"],output:["String","Key"]}},Wu="input",zu=function(s,n){const i=mP[s][n];if(i===void 0)throw new Error("Unknown Yail type: "+s+" -- YailTypeToBlocklyType");return i},fh=function(s){return s.children!==void 0?s.children:Array.prototype.filter.call(s.childNodes,function(n){return n.nodeType==k.utils.dom.NodeType.ELEMENT_NODE})},pc=function(s){if(!s.getSvgRoot()||s.readOnly){s.hasWarning&&(s.hasWarning=false),s.hasError&&(s.hasError=false);return}s.errors||(s.errors=[]),s.warnings||(s.warnings=[]);const n=s.errors,i=s.warnings;for(let o=0;o<n.length;o++)if(n[o].func&&n[o].func.call(this,s,n[o])){s.hasError||(s.hasError=true),s.hasWarning&&(s.hasWarning=false);return}s.hasError&&(s.hasError=false);for(let o=0;o<i.length;o++)if(i[o].func&&i[o].func.call(this,s,i[o])){s.hasWarning||(s.hasWarning=true);return}s.warning&&s.setWarningText(null),s.hasWarning&&(s.hasWarning=false)},gc=function(s){if(s.getRootBlock().type==="global_declaration"){const i=k.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION;return s.setWarningText(i),true}else return false},fc=function(s,n){if(s.workspace.isDragging())return false;for(let i=0;i<n.dropDowns.length;i++){const o=s.getField(n.dropDowns[i]),l=o.menuGenerator_(),h=o.getText(),f=o.getValue();let u=false;o.updateMutation&&o.updateMutation();for(let p=0;p<l.length;p++)if(l[p][1]===f&&f!==" "){u=true,l[p][0]!==h&&o.setValue(l[p][0]);break}if(!u){const p=k.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN;return s.setWarningText(p),true}}return false},EP=Object.freeze(Object.defineProperty({__proto__:null,checkDropDownContainsValidValue:fc,checkErrors:pc,checkIsInDefinition:gc},Symbol.toStringTag,{value:"Module"})),bP=false,Ql="global",a0="input",l0="local",vP="item",TP="counter",Kn=" ",Cf=function(s){return function(n){return""+n}},SP=function(s){return k.Msg.LANG_VARIABLES_GLOBAL_PREFIX+Kn+s},c0=function(s){return s.indexOf(k.Msg.LANG_VARIABLES_GLOBAL_PREFIX+Kn)===0?[k.Msg.LANG_VARIABLES_GLOBAL_PREFIX,s.substring(k.Msg.LANG_VARIABLES_GLOBAL_PREFIX.length+Kn.length)]:s.indexOf(Ql+Kn)===0?[Ql,s.substring(6+Kn.length)]:["",s]},$P=function(s){return function(n){return""+n}};/**
 * @license
 * @fileoverview Drop-down chooser of variables in the current lexical scope
 *     for App Inventor.
 * @author fturbak@wellesley.com (Lyn Turbak)
 */class mt extends k.FieldDropdown{constructor(n){super(mt.dropdownCreate,mt.dropdownChange),n?this.doValueUpdate_(n):this.doValueUpdate_(k.Variables.generateUniqueName())}setValue(n){if(n&&n!==" "){const i=n.split(" ");i.length==2&&i[0]!=="global"&&(n="global "+i[1])}super.setValue(n)}}mt.prototype.doClassValidation_=function(s){return s};mt.prototype.getBlock=function(){return this.block_};mt.prototype.setBlock=function(s){this.block_=s};mt.getGlobalNames=function(s){if(k.common.getMainWorkspace()&&k.common.getMainWorkspace().getWarningHandler&&k.common.getMainWorkspace().getWarningHandler().cacheGlobalNames)return k.common.getMainWorkspace().getWarningHandler().cachedGlobalNames;const n=[];if(k.common.getMainWorkspace()){let i=[];i=k.common.getMainWorkspace().getTopBlocks();for(let o=0;o<i.length;o++){const l=i[o];l.getGlobalNames&&l!=s&&n.push(...l.getGlobalNames())}}return n};mt.prototype.getNamesInScope=function(){return mt.getNamesInScope(this.block_)};mt.getNamesInScope=function(s){let n=mt.getGlobalNames();n=Ce.sortAndRemoveDuplicates(n),n=n.map(function(o){return[SP(o),"global "+o]});const i=mt.getLexicalNamesInScope(s);return n.concat(i)};mt.getLexicalNamesInScope=function(s){let n=[];const i={};let o,l;function h(f,u,p){let c;i[f]||(i[f]=p),c=Cf(i[f])(f),u.push(c)}if(l=s,l&&(o=l.getParent(),o))for(;o;)o.withLexicalVarsAndPrefix&&o.withLexicalVarsAndPrefix(l,(f,u)=>{h(f,n,u)}),l=o,o=o.getParent();return n=Ce.sortAndRemoveDuplicates(n),n.map(function(f){return[f,f]})};mt.dropdownCreate=function(){const s=this.getNamesInScope();return s.length==0?[[" "," "]]:s};mt.prototype.doValueUpdate_=function(s){Object.getPrototypeOf(k.FieldDropdown).prototype.doValueUpdate_.call(this,s);function n(o){return o.startsWith("global ")?o.replace("global ",k.Msg.LANG_VARIABLES_GLOBAL_PREFIX+" "):o}const i=this.getOptions(true,[[n(s),s]]);for(let o=0,l;l=i[o];o++)if(l[1]==this.value_){this.selectedOption_=l;break}this.forceRerender()};mt.prototype.getOptions=function(s,n){Array.isArray(s)&&(n=s);const i=n||[];return this.isOptionListDynamic()?((!this.generatedOptions_||!s)&&(this.generatedOptions_=this.menuGenerator_.call(this).concat(i),yP(this.generatedOptions_)),this.generatedOptions_.concat(i)):this.menuGenerator_};const yP=function(s){if(!Array.isArray(s))throw TypeError("FieldDropdown options must be an array.");if(!s.length)throw TypeError("FieldDropdown options must not be an empty array.");let n=false;for(let i=0;i<s.length;++i){const o=s[i];Array.isArray(o)?typeof o[1]!="string"?(n=true,console.error("Invalid option["+i+"]: Each FieldDropdown option id must be a string. Found "+o[1]+" in: ",o)):o[0]&&typeof o[0]!="string"&&typeof o[0].src!="string"&&(n=true,console.error("Invalid option["+i+"]: Each FieldDropdown option must have a string label or image description. Found"+o[0]+" in: ",o)):(n=true,console.error("Invalid option["+i+"]: Each FieldDropdown option must be an array. Found: ",o))}if(n)throw TypeError("Found invalid FieldDropdown options.")};mt.dropdownChange=function(s){if(s){this.doValueUpdate_(s);const n=this.sourceBlock_.workspace.getTopWorkspace();n.getWarningHandler&&n.getWarningHandler().checkErrors(this.sourceBlock_)}};mt.nameNotIn=function(s,n){const i=mt.prefixSuffix(s),o=i[0],l=i[1];let h=false,f=false;const u=[];for(let p=0;p<n.length;p++){const c=mt.prefixSuffix(n[p]),_=c[0],m=c[1];_===o&&(m===l&&(f=true),m===""?h=true:u.push(m))}if(f)if(h){const p=u.map(function(m,E,b){return parseInt(m,10)});p.sort(function(m,E){return m-E});let c=2,_=0;for(;_<p.length;){if(c<p[_])return o+c;c==p[_]&&c++,_++}return o+c}else return o;else return s};mt.prefixSuffix=function(s){const n=s.match(/^(.*?)(\d+)$/);return n?[n[1],n[2]]:[s,""]};mt.fromJson=function(s){const n=k.utils.replaceMessageReferences(s.name);return new mt(n)};k.fieldRegistry.register("field_lexical_variable",mt);const Ce={};Ce.renameGlobal=function(s){const n=this.value_;s=Ce.makeLegalIdentifier(s),this.sourceBlock_.getField("NAME").doValueUpdate_(s);const i=mt.getGlobalNames(this.sourceBlock_);if(s=mt.nameNotIn(s,i),this.sourceBlock_.rendered&&k.common.getMainWorkspace()){const o=k.common.getMainWorkspace().getAllBlocks();for(let l=0;l<o.length;l++){const h=o[l],f=h.renameLexicalVar;f&&f.call(h,Ql+Kn+n,Ql+Kn+s,k.Msg.LANG_VARIABLES_GLOBAL_PREFIX+Kn+n,k.Msg.LANG_VARIABLES_GLOBAL_PREFIX+Kn+s)}}return s};Ce.renameParam=function(s){const n=this.htmlInput_,i=this.getValue()||n&&n.defaultValue||this.getText();return s=Ce.makeLegalIdentifier(s),Ce.renameParamFromTo(this.sourceBlock_,i,s,false)};Ce.renameParamFromTo=function(s,n,i,o){return s.mustNotRenameCapturables?Ce.renameParamWithoutRenamingCapturables(s,n,i,[]):o?(Ce.renameParamRenamingCapturables(s,n,i),i):Ce.renameParamWithoutRenamingCapturables(s,n,i,[])};Ce.renameParamRenamingCapturables=function(s,n,i){if(i!==n){const o=s.declaredNames?s.declaredNames():[];if(o.indexOf(n)==-1)throw Error("LexicalVariable.renamingCapturables: oldName "+n+" is not in declarations {"+o.join(",")+"}");const l=[];mt.getNamesInScope(s).map(function(f){f[0]==f[1]?l.push(f[0]):l.push(f[0],f[1])});const h=o.concat(l);if(h.indexOf(i)!=-1)throw Error("LexicalVariable.renameParamRenamingCapturables: newName "+i+" is in existing declarations {"+h.join(",")+"}");if(s.renameBound){const f=k.Substitution.simpleSubstitution(n,i),u=new k.Substitution;s.renameBound(f,u)}else throw Error("LexicalVariable.renameParamRenamingCapturables: block "+s.type+" is not a declaration block.")}};Ce.renameFree=function(s,n){s&&(s.renameFree?s.renameFree(n):s.getChildren().map(function(i){Ce.renameFree(i,n)}))};Ce.freeVariables=function(s){let n=[];if(!s)n=new k.NameSet;else if(s.freeVariables)n=s.freeVariables();else{const i=s.getChildren().map(function(o){return Ce.freeVariables(o)});n=k.NameSet.unionAll(i)}return n};Ce.renameParamWithoutRenamingCapturables=function(s,n,i,o){if(n===i)return n;s.declaredNames&&s.declaredNames();let l="";const h=Ce.renameParamWithoutRenamingCapturablesInfo(s,n,l),f=h[0],u=h[1];let p=[];if(s.declaredNames){p=s.declaredNames();const _=p.indexOf(n);if(_!=-1&&p.splice(_,1),o.indexOf(i)!=-1){const m=p.indexOf(i);m!=-1&&p.splice(m,1)}}const c=Ce.sortAndRemoveDuplicates(u.concat(p));if(i=mt.nameNotIn(i,c),i!==n&&!(p.indexOf(n)!=-1))for(let m=0;m<f.length;m++){const E=f[m],b=E.renameLexicalVar;b&&b.call(E,Cf()(n),Cf()(i))}return i};Ce.renameParamWithoutRenamingCapturablesInfo=function(s,n,i){let o=[];s.blocksInScope&&(o=s.blocksInScope());const l=o.map(function(u){return Ce.referenceResult(u,n,i,[])});let h=[],f=[];for(let u=0;u<l.length;u++)h=h.concat(l[u][0]),f=f.concat(l[u][1]);return f=Ce.sortAndRemoveDuplicates(f),[h,f]};Ce.checkIdentifier=function(s){const n=s.trim().replace(/[\s\xa0]+/g,"_"),i="^[^-0-9!&%^/>=<`'\"#:;,\\\\*+.()|{}[\\] ]",o=`[^-!&%^/>=<'"#:;,\\\\*+.()|{}[\\] ]*$`,l=new RegExp(i+o);return{isLegal:n.search(l)==0,transformed:n}};Ce.makeLegalIdentifier=function(s){const n=Ce.checkIdentifier(s);return n.isLegal?n.transformed:n.transformed===""?"_":"name"};Ce.referenceResult=function(s,n,i,o){if(!s)return[[],[]];const l=s.referenceResults?s.referenceResults(n,i,o):s.getChildren().map(function(u){return Ce.referenceResult(u,n,i,o)});let h=[],f=[];for(let u=0;u<l.length;u++)h=h.concat(l[u][0]),f=f.concat(l[u][1]);return[h,f]};Ce.sortAndRemoveDuplicates=function(s){const n=s.sort(),i=[];if(s.length>=1){let o=n[0];i.push(o);for(let l=1;l<n.length;l++)n[l]!==o&&(o=n[l],i.push(o))}return i};Ce.getNextTargetBlock=function(s){return s&&s.nextConnection&&s.nextConnection.targetBlock()?s.nextConnection.targetBlock():null};Ce.stringListsEqual=function(s,n){const i=s.length,o=n.length;if(i!==o)return false;for(let l=0;l<i;l++)if(s[l]!==n[l])return false;return true};/**
 * @license
 * @fileoverview Visual blocks editor for App Inventor
 * Methods to handle serialization of the blocks workspace.
 *
 * @author sharon@google.com (Sharon Perl)
 */const RP=["",""],th=function(s){let n=this.block.workspace.getTopWorkspace();if(!this.block.isEditable()){n=k.Drawer.flyout_.workspace_;return}const i=n.getProcedureDatabase().getProcedure(s);if(!i)return;const o=i.getFieldValue("NAME");if(o==""||o!=this.getValue())for(let l=0;this.block.getInput("ARG"+l)!=null;l++)this.block.removeInput("ARG"+l);this.doValueUpdate_(o),i&&this.block.setProcedureParameters(i.arguments_,i.paramIds_,true)},u0=function(s,n){const o=(n||k.common.getMainWorkspace()).getTopBlocks(),l=[RP];for(let h=0;h<o.length;h++){const f=o[h].getFieldValue("NAME");o[h].type=="procedures_defnoreturn"&&!s?l.push([f,f]):o[h].type=="procedures_defreturn"&&s&&l.push([f,f])}return l.length>1&&l.splice(0,1),l},IP=function(s){const n=s.workspace.getTopBlocks(false),i=[];for(let o=0;o<n.length;o++)(n[o].type==="procedures_defnoreturn"||n[o].type==="procedures_defreturn")&&n[o]!==s&&i.push(n[o]);return i},CP=function(s,n){if(n&&n===k.common.getMainWorkspace()){const i=n.getAllBlocks();for(let o=0;o<i.length;o++){const l=i[o];(l.type=="procedures_callreturn"||l.type=="procedures_callnoreturn")&&l.getFieldValue("PROCNAME")==s&&l.removeProcedureValue()}}},OP=function(s){const n=this.oldName_||this.getValue(),i=s;s=Ce.makeLegalIdentifier(s);const l=IP(this.sourceBlock_).map(function(f){return f.getFieldValue("NAME")});s=mt.nameNotIn(s,l),s!==i&&this.doValueUpdate_(s);const h=this.sourceBlock_.workspace.getAllBlocks();for(let f=0;f<h.length;f++){const u=h[f].renameProcedure;u&&u.call(h[f],n,s)}return this.oldName_=s,s};/**
 * @license
 * Copyright © 2016-2017 Massachusetts Institute of Technology. All rights
 *     reserved.
 */const Ii=function(s){this.workspace_=s,this.procedures_={},this.returnProcedures_={},this.voidProcedures_={},this.length=0,this.returnProcedures=0,this.voidProcedures=0};Ii.defaultValue=["","none"];Ii.prototype.getNames=function(s){return u0(s,this.workspace_).map(function(n){return n[0]})};Ii.prototype.getMenuItems=function(s){return u0(s,this.workspace_)};Ii.prototype.getDeclarationBlocks=function(s){return k.utils.object.values(s?this.returnProcedures_:this.voidProcedures_)};Ii.prototype.getDeclarationsBlocksExcept=function(s){const n=[];return k.utils.values(this.procedures_).forEach(function(i){i!==s&&n.push(i)}),n};Ii.prototype.getAllDeclarationNames=function(){return k.utils.values(this.procedures_).map(function(s){return s.getFieldValue("NAME")})};Ii.prototype.addProcedure=function(s,n){if(n.type!="procedures_defnoreturn"&&n.type!="procedures_defreturn")return console.warn("Attempt to addProcedure with block type "+n.type),false;const i=n.id;return i in this.procedures_?false:(this.procedures_[i]=n,this.length++,n.type=="procedures_defnoreturn"?(this.voidProcedures_[i]=n,this.voidProcedures++):(this.returnProcedures_[i]=n,this.returnProcedures++),true)};Ii.prototype.removeProcedure=function(s){return s in this.procedures_&&(this.procedures_[s].type=="procedures_defnoreturn"?(delete this.voidProcedures_[s],this.voidProcedures--):(delete this.returnProcedures_[s],this.returnProcedures--),delete this.procedures_[s],this.length--),true};Ii.prototype.renameProcedure=function(s,n,i){};Ii.prototype.getProcedure=function(s){const n=this.procedures_[s];return n||this.getProcedureByName(s)};Ii.prototype.getProcedureByName=function(s){for(const n in this.procedures_)if(this.procedures_[n].getFieldValue("NAME")===s)return this.procedures_[n]};Ii.prototype.clear=function(){this.procedures_={},this.returnProcedures_={},this.voidProcedures_={},this.length=0,this.returnProcedures=0,this.voidProcedures=0};k.WorkspaceSvg.prototype.flydown_=null;k.WorkspaceSvg.prototype.getFlydown=function(){return this.flydown_};k.WorkspaceSvg.prototype.getProcedureDatabase=function(){return this.procedureDb_||(this.procedureDb_=new Ii(this)),this.procedureDb_};k.WorkspaceSvg.prototype.getTopWorkspace=function(){let s=this;for(;s.targetWorkspace;)s=s.targetWorkspace;return s};k.WorkspaceSvg.prototype.getWarningHandler=function(){return EP};/**
 * @license
 * @fileoverview Field in which mouseover displays flyout-like menu of blocks
 * and mouse click edits the field name.
 * Flydowns are used in App Inventor for displaying get/set blocks for
 *     parameter names and callers for procedure declarations.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */const to=class extends k.FieldTextInput{constructor(n,i,o,l){super(n,l),this.EDITABLE=i,this.displayLocation=o||to.DISPLAY_RIGHT}showEditor_(){this.EDITABLE&&(to.showPid_&&(clearTimeout(to.showPid_),to.showPid_=0,k.common.getMainWorkspace().hideChaff()),super.showEditor_())}init(n){super.init(n),k.utils.dom.removeClass(this.fieldGroup_,"blocklyEditableText"),k.utils.dom.removeClass(this.fieldGroup_,"blocklyNoNEditableText"),k.utils.dom.addClass(this.fieldGroup_,this.fieldCSSClassName),this.mouseOverWrapper_=k.browserEvents.bind(this.fieldGroup_,"mouseover",this,this.onMouseOver_),this.mouseOutWrapper_=k.browserEvents.bind(this.fieldGroup_,"mouseout",this,this.onMouseOut_)}};let at=to;Qr(at,"timeout",500),Qr(at,"showPid_",0),Qr(at,"openFieldFlydown_",null),Qr(at,"DISPLAY_BELOW","BELOW"),Qr(at,"DISPLAY_RIGHT","RIGHT"),Qr(at,"DISPLAY_LOCATION",to.DISPLAY_BELOW);at.prototype.fieldCSSClassName="blocklyFieldFlydownField";at.prototype.flyoutCSSClassName="blocklyFieldFlydownFlydown";at.prototype.onMouseOver_=function(s){!this.sourceBlock_.isInFlyout&&at.showPid_==0&&(at.showPid_=window.setTimeout(this.showFlydownMaker_(),at.timeout)),s.stopPropagation()};at.prototype.onMouseOut_=function(s){window.clearTimeout(at.showPid_),at.showPid_=0,s.stopPropagation()};at.prototype.showFlydownMaker_=function(){const s=this;return function(){if(at.showPid_!==0&&!s.getSourceBlock().workspace.isDragging()&&!this.htmlInput_)try{s.showFlydown_()}catch(n){console.error("Failed to show flydown",n)}at.showPid_=0}};at.prototype.showFlydown_=function(){k.common.getMainWorkspace().hideChaff();const s=k.common.getMainWorkspace().getFlydown();k.common.getMainWorkspace().getParentSvg().appendChild(s.svgGroup_);const n=s.targetWorkspace.scale;s.workspace_.setScale(n),s.setCSSClass(this.flyoutCSSClassName);const i=this.flydownBlocksXML_(),o=k.Xml.textToDom(i),l=fh(o),h=k.common.getMainWorkspace().getSvgXY(this.borderRect_),f=this.borderRect_.getBBox();this.displayLocation===at.DISPLAY_BELOW?h.y+=f.height*n:h.x+=f.width*n,s.field_=this,s.showAt(l,h.x,h.y),at.openFieldFlydown_=this};at.hide=function(){window.clearTimeout(at.showPid_);const s=k.common.getMainWorkspace().getFlydown();s&&s.hide()};function wP(s,n){const i=s.doClassValidation_(n);if(i===null)return null;i!==void 0&&(n=i);const o=s.getValidator();if(o){const l=o.call(s,n);if(l===null)return null;l!==void 0&&(n=l)}return n}at.prototype.onHtmlInputChange_=function(s){const n=this.htmlInput_,i=n.value;if(i!==n.oldValue_){n.oldValue_=i;let o=true;this.sourceBlock_&&(o=wP(this,n.value)),o===null?k.utils.dom.addClass(n,"blocklyInvalidInput"):(k.utils.dom.removeClass(n,"blocklyInvalidInput"),this.doValueUpdate_(o))}else k.utils.userAgent.WEBKIT&&this.sourceBlock_.render();this.textContent_.nodeValue=i,this.forceRerender(),this.resizeEditor_(),k.svgResize(this.sourceBlock_.workspace)};at.prototype.dispose=function(){at.openFieldFlydown_==this&&at.hide(),k.FieldTextInput.prototype.dispose.call(this)};at.fromJson=function(s){const n=k.utils.replaceMessageReferences(s.name);return new at(n,s.is_editable)};k.fieldRegistry.register("field_flydown",at);/**
 * @license
 * @fileoverview Flydown is an abstract class for a flyout-like dropdown
 *     containing blocks. Unlike a regular flyout, for simplicity it does not
 *     support scrolling. Any non-abstract subclass must provide a
 *     flydownBlocksXML_ () method that returns an XML element whose children
 *     are blocks that should appear in the flyout.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */class oi extends k.VerticalFlyout{constructor(n){super(n),this.dragAngleRange_=360}}oi.prototype.previousCSSClassName_="";oi.prototype.VERTICAL_SEPARATION_FACTOR=1;oi.prototype.createDom=function(s){return this.previousCSSClassName_=s,this.svgGroup_=k.utils.dom.createSvgElement("g",{class:s},null),this.svgBackground_=k.utils.dom.createSvgElement("path",{},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.svgGroup_};oi.prototype.setCSSClass=function(s){s!==this.previousCSSClassName_&&(k.utils.dom.removeClass(this.svgGroup_,this.previousCSSClassName_),k.utils.dom.addClass(this.svgGroup_,s),this.previousCSSClassName_=s)};oi.prototype.init=function(s){k.Flyout.prototype.init.call(this,s,false),this.workspace_.setTheme(s.getTheme()),s.getComponentManager().addCapability(this.id,k.ComponentManager.Capability.AUTOHIDEABLE)};oi.prototype.position=function(){};oi.prototype.showAt=function(s,n,i){k.Events.disable();try{this.show(s)}finally{k.Events.enable()}const o=this.CORNER_RADIUS*this.workspace_.scale,l=this.width_-2*o,h=this.height_-2*o,f=["M 0,"+o];f.push("a",o,o,0,0,1,o,-o),f.push("h",l),f.push("a",o,o,0,0,1,o,o),f.push("v",h),f.push("a",o,o,0,0,1,-o,o),f.push("h",-l),f.push("a",o,o,0,0,1,-o,-o),f.push("z"),this.svgBackground_.setAttribute("d",f.join(" ")),this.svgGroup_.setAttribute("transform","translate("+n+", "+i+")")};oi.prototype.reflow=function(){this.workspace_.scale=this.targetWorkspace.scale;const s=this.workspace_.scale;let n=0,i=0;const o=this.CORNER_RADIUS*s,l=this.workspace_.getTopBlocks(false);for(let u=0,p;p=l[u];u++){const c=p.getHeightWidth();n=Math.max(n,c.width*s),i+=c.height*s}n+=2*o+this.tabWidth_*s;const h=this.workspace_.getRenderer().getConstants(),f=h.ADD_START_HATS?h.START_HAT_HEIGHT:0;if(i+=3*o+o*this.VERTICAL_SEPARATION_FACTOR*l.length+f*s/2,this.width_!=n){for(let u=0,p;p=l[u];u++){const c=p.getHeightWidth(),_=p.getRelativeToSurfaceXY();if(this.RTL){const m=n-o-s*(this.tabWidth_-_.x);p.moveBy(m,0),_.x+=m}p.flyoutRect_&&(p.flyoutRect_.setAttribute("width",c.width),p.flyoutRect_.setAttribute("height",c.height),p.flyoutRect_.setAttribute("x",this.RTL?_.x-c.width:_.x),p.flyoutRect_.setAttribute("y",_.y))}this.width_=n,this.height_=i}};oi.prototype.onMouseMove_=function(s){};oi.prototype.placeNewBlock_=function(s){const n=this.targetWorkspace,i=s.getSvgRoot();if(!i)throw Error("originBlock is not rendered.");let o=this.workspace_.scale;const l=this.workspace_.getSvgXY(i),h=l.x;l.x+=h/n.scale-h;const f=l.y;o=n.scale,l.y+=f/o-f;const u=k.Xml.blockToDom(s),p=k.Xml.domToBlock(u,n),c=p.getSvgRoot();if(!c)throw Error("block is not rendered.");const _=n.getSvgXY(c);return _.x+=n.scrollX/n.scale-n.scrollX,_.y+=n.scrollY/n.scale-n.scrollY,n.toolbox_&&!n.scrollbar&&(_.x+=n.toolbox_.getWidth()/n.scale,_.y+=n.toolbox_.getHeight()/n.scale),p.moveBy(l.x-_.x,l.y-_.y),p};oi.prototype.shouldHide=true;oi.prototype.hide=function(){this.shouldHide&&(k.Flyout.prototype.hide.call(this),at.openFieldFlydown_=null),this.shouldHide=true};oi.prototype.autoHide=function(){this.hide()};/**
 * @license
 * @fileoverview Clickable field with flydown menu of global getter and setter
 *     blocks.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */class po extends at{constructor(n,i){super(n,true,i,Ce.renameGlobal)}}po.prototype.fieldCSSClassName="blocklyFieldParameter";po.prototype.flyoutCSSClassName="blocklyFieldParameterFlydown";po.prototype.flydownBlocksXML_=function(){const s=k.Msg.LANG_VARIABLES_GLOBAL_PREFIX+" "+this.getText();return'<xml><block type="lexical_variable_get"><title name="VAR">'+s+'</title></block><block type="lexical_variable_set"><title name="VAR">'+s+"</title></block></xml>"};po.fromJson=function(s){const n=k.utils.replaceMessageReferences(s.name);return new po(n)};k.fieldRegistry.register("field_global_flydown",po);class ga extends k.FieldDropdown{constructor(...n){super(...n)}}ga.prototype.doClassValidation_=function(s){let n=false;const i=this.getOptions(true);for(let o=0,l;l=i[o];o++)if(l[1]===s){n=true;break}return n||this.generatedOptions_.push([s,s]),s};ga.fromJson=function(s){return new ga(s.options,void 0,s)};k.fieldRegistry.register("field_nocheck_dropdown",ga);class os extends at{constructor(n,i,o,l){const h=function(f){if(!os.changeHandlerEnabled)return f;const u=Ce.renameParam.call(this,f);return l&&l.call(this,u),u};super(n,i,o,h)}}os.prototype.fieldCSSClassName="blocklyFieldParameter";os.prototype.flyoutCSSClassName="blocklyFieldParameterFlydown";os.changeHandlerEnabled=true;os.withChangeHanderDisabled=function(s){const n=os.changeHandlerEnabled;os.changeHandlerEnabled=false;try{s()}finally{os.changeHandlerEnabled=n}};os.prototype.flydownBlocksXML_=function(){const s=this.getText();return'<xml><block type="lexical_variable_get"><field name="VAR">'+s+'</field></block><block type="lexical_variable_set"><field name="VAR">'+s+"</field></block></xml>"};os.addHorizontalVerticalOption=function(s,n){let i=0;if(s.getParameters&&(i=s.getParameters().length),s.isCollapsed()||i<=0)return;const o={enabled:true,text:s.horizontalParameters?k.Msg.VERTICAL_PARAMETERS:k.Msg.HORIZONTAL_PARAMETERS,callback:function(){s.setParameterOrientation(!s.horizontalParameters)}};let l=0;for(let h;(h=n[l])&&h.text!=k.Msg.COLLAPSE_BLOCK;l++);n.splice(l,0,o);for(let h=0,f;f=n[h];h++)if(f.text==k.Msg.INLINE_INPUTS){n.splice(h,1);break}};os.fromJson=function(s){const n=k.utils.replaceMessageReferences(s.name);return new os(n,s.is_editable)};k.fieldRegistry.register("field_parameter_flydown",os);/**
 * @license
 * @fileoverview Specialization of Blockly's FieldTextInput to handle logic of
 *     procedure renaming.
 * @author ewpatton@mit.edu (Evan W. Patton)
 */class ec extends k.FieldTextInput{constructor(n){super(n,OP)}setValue(n){const i=this.getValue();if(this.oldName_=i,this.doValueUpdate_(n),super.setValue(n),n=this.getValue(),typeof n=="string"&&this.sourceBlock_){const o=this.sourceBlock_.workspace.getProcedureDatabase();o&&(o.getProcedure(this.sourceBlock_.id)?o.renameProcedure(this.sourceBlock_.id,i,n):o.addProcedure(n,this.sourceBlock_))}this.oldName_=void 0}}ec.fromJson=function(s){const n=k.utils.replaceMessageReferences(s.name);return new ec(n)};k.fieldRegistry.register("field_procedurename",ec);/**
 * @license
 * @fileoverview Variables blocks for Blockly, modified for MIT App Inventor.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */delete k.Blocks.global_declaration;k.Blocks.global_declaration={category:"Variables",helpUrl:k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_HELPURL,init:function(){this.setStyle("variable_blocks"),this.appendValueInput("VALUE").appendField(k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT).appendField(new po(k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME,at.DISPLAY_BELOW),"NAME").appendField(k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO),this.setTooltip(k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP)},getVars:function(){const s=this.getField("NAME");return s?[s.getText()]:[]},getGlobalNames:function(){return this.getVars()},renameVar:function(s,n){k.Names.equals(s,this.getFieldValue("NAME"))&&this.setFieldValue(n,"NAME")}};k.Blocks.lexical_variable_get={category:"Variables",helpUrl:k.Msg.LANG_VARIABLES_GET_HELPURL,init:function(){this.setStyle("variable_blocks"),this.fieldVar_=new mt(" "),this.fieldVar_.setBlock(this),this.appendDummyInput().appendField(k.Msg.LANG_VARIABLES_GET_TITLE_GET).appendField(this.fieldVar_,"VAR"),this.setOutput(true,null),this.setTooltip(k.Msg.LANG_VARIABLES_GET_TOOLTIP),this.errors=[{func:gc},{func:fc,dropDowns:["VAR"]}],this.setOnChange(function(s){pc(this)})},referenceResults:function(s,n,i){const o=this.getChildren().map(function(m){return Ce.referenceResult(m,s,n,i)});let l=[],h=[];for(let m=0;m<o.length;m++)l=l.concat(o[m][0]),h=h.concat(o[m][1]);const f=this.getField("VAR").getText(),u=c0(f),p=u[0],c=u[1],_=i.indexOf(c)==-1;return p!==k.Msg.LANG_VARIABLES_GLOBAL_PREFIX&&(c===s&&_?(l.push(this),h=h.concat(i)):_&&!bP&&h.push(c)),[[l,h]]},getVars:function(){return[this.getFieldValue("VAR")]},renameLexicalVar:function(s,n,i,o){i===void 0?s===this.getFieldValue("VAR")&&this.setFieldValue(n,"VAR"):i&&i===this.fieldVar_.getText()&&(this.fieldVar_.getOptions(false),this.fieldVar_.setValue(n),s===n&&this.setFieldValue(n,"VAR"),this.fieldVar_.forceRerender())},renameFree:function(s){const n=k.unprefixName(this.getFieldValue("VAR"));if(n[0]!==k.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const o=n[1],l=s.apply(o);l!==o&&this.renameLexicalVar(o,l)}},freeVariables:function(){const s=k.unprefixName(this.getFieldValue("VAR"));if(s[0]!==k.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const i=s[1];return new k.NameSet([i])}else return new k.NameSet}};k.Blocks.lexical_variable_set={category:"Variables",helpUrl:k.Msg.LANG_VARIABLES_SET_HELPURL,init:function(){this.setStyle("variable_blocks"),this.fieldVar_=new mt(" "),this.fieldVar_.setBlock(this),this.appendValueInput("VALUE").appendField(k.Msg.LANG_VARIABLES_SET_TITLE_SET).appendField(this.fieldVar_,"VAR").appendField(k.Msg.LANG_VARIABLES_SET_TITLE_TO),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(k.Msg.LANG_VARIABLES_SET_TOOLTIP),this.errors=[{func:gc},{func:fc,dropDowns:["VAR"]}],this.setOnChange(function(s){pc(this)})},referenceResults:k.Blocks.lexical_variable_get.referenceResults,getVars:function(){return[this.getFieldValue("VAR")]},renameLexicalVar:k.Blocks.lexical_variable_get.renameLexicalVar,renameFree:function(s){const n=k.unprefixName(this.getFieldValue("VAR"));if(n[0]!==k.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const o=n[1],l=s.apply(o);l!==o&&this.renameLexicalVar(o,l)}this.getChildren().map(function(o){Ce.renameFree(o,s)})},freeVariables:function(){const s=this.getChildren().map(function(l){return Ce.freeVariables(l)}),n=k.NameSet.unionAll(s),i=k.unprefixName(this.getFieldValue("VAR"));if(i[0]!==k.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const l=i[1];n.insert(l)}return n}};k.Blocks.local_declaration_statement={category:"Variables",helpUrl:k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_HELPURL,bodyInputName:"STACK",init:function(){this.setStyle("variable_blocks"),this.initLocals(),this.appendStatementInput("STACK").appendField(k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP),this.lexicalVarPrefix=l0},referenceResults:function(s,n,i){const o=[];for(let c=0;this.getInput("DECL"+c);c++){let _=this.getFieldValue("VAR"+c);o.push(_)}const l=i.concat(o),h=[];for(let c=0;this.getInput("DECL"+c);c++){const _=this.getInputTargetBlock("DECL"+c);_&&h.push(_)}const f=h.map(function(c){return Ce.referenceResult(c,s,n,i)}),u=Ce.referenceResult(this.getInputTargetBlock("STACK"),s,n,l),p=Ce.referenceResult(Ce.getNextTargetBlock(this),s,n,i);return f.concat([u,p])},withLexicalVarsAndPrefix:function(s,n){if(this.getInputTargetBlock(this.bodyInputName)==s){const i=this.declaredNames();for(let o=0;o<i.length;o++)n(i[o],this.lexicalVarPrefix)}},initLocals:function(){this.setStyle("variable_blocks"),this.localNames_=[k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME],this.appendValueInput("DECL0").appendField(k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT).appendField(this.parameterFlydown(0),"VAR0").appendField(k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO).setAlign(k.ALIGN_RIGHT),this.setMutator(new k.Mutator(["local_mutatorarg"]))},onchange:function(){this.localNames_=this.declaredNames()},mutationToDom:function(){const s=document.createElement("mutation");for(let n=0;n<this.localNames_.length;n++){const i=document.createElement("localname");i.setAttribute("name",this.localNames_[n]),s.appendChild(i)}return s},domToMutation:function(s){const n=fh(s);if(n.length>0){this.localNames_=[];for(let i=0,o;o=n[i];i++)o.nodeName.toLowerCase()=="localname"&&this.localNames_.push(o.getAttribute("name"))}this.updateDeclarationInputs_(this.localNames_)},updateDeclarationInputs_:function(s,n){const i=this.inputList[this.inputList.length-1],o=this.inputList.length-1,l=this.rendered;this.rendered=false;const h=this;os.withChangeHanderDisabled(function(){for(let f=0;f<o;f++)h.removeInput("DECL"+f)}),this.inputList=[],this.localNames_=s;for(let f=0;f<s.length;f++){const u=this.appendValueInput("DECL"+f);u.appendField(k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT).appendField(this.parameterFlydown(f),"VAR"+f).appendField(k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO).setAlign(k.ALIGN_RIGHT),n&&n[f]&&u.connection.connect(n[f])}this.inputList=this.inputList.concat(i),this.rendered=l,this.rendered&&(this.initSvg(),this.render())},parameterFlydown:function(s){const n=this.localNames_[s],i=this,o=function(l){const h=i.localNames_;if(h[s]=l,i.mutator&&i.mutator.rootBlock_){const f=i.mutator.rootBlock_;let u=0,p=f.getInputTargetBlock("STACK");for(;p&&u<s;)p=p.nextConnection&&p.nextConnection.targetBlock(),u++;p&&u==s&&k.Field.prototype.setValue.call(p.getField("NAME"),l)}};return new os(n,true,at.DISPLAY_RIGHT,o)},decompose:function(s){const n=s.newBlock("local_mutatorcontainer");n.initSvg(),n.setDefBlock(this);let i=n.getInput("STACK").connection;for(let o=0;o<this.localNames_.length;o++){const l=this.getFieldValue("VAR"+o),h=s.newBlock("local_mutatorarg");h.initSvg(),h.setFieldValue(l,"NAME"),h.oldLocation=o,i.connect(h.previousConnection),i=h.nextConnection}return n},compose:function(s){const n=[],i=[];let o=s.getInputTargetBlock("STACK");for(;o;)n.push(o.getFieldValue("NAME")),i.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();Ce.stringListsEqual(this.localNames_,n)||this.updateDeclarationInputs_(n,i)},dispose:function(...s){k.BlockSvg.prototype.dispose.apply(this,s)},saveConnections:function(s){let n=s.getInputTargetBlock("STACK"),i=0;for(;n;){const l=this.getInput("DECL"+i);n.valueConnection_=l&&l.connection.targetConnection,i++,n=n.nextConnection&&n.nextConnection.targetBlock()}const o=this.getInput(this.bodyInputName);o&&(s.bodyConnection_=o.connection.targetConnection)},getVars:function(){const s=[];for(let n=0,i;i=this.getField("VAR"+n);n++)s.push(i.getValue());return s},declaredNames:function(){return this.getVars()},declaredVariables:function(){return this.getVars()},initializerConnections:function(){const s=[];for(let n=0,i;i=this.getInput("DECL"+n);n++)s.push(i.connection&&i.connection.targetConnection);return s},blocksInScope:function(){const s=this.getInputTargetBlock(this.bodyInputName);return s&&[s]||[]},renameVar:function(s,n){this.renameVars(k.Substitution.simpleSubstitution(s,n))},renameVars:function(s){const n=this.declaredNames(),i=s.map(n);if(!Ce.stringListsEqual(i,n)){const o=this.initializerConnections();if(this.updateDeclarationInputs_(i,o),this.mutator.isVisible()){const l=this.mutator.workspace_.getAllBlocks();for(let h=0,f;f=l[h];h++)if(f.type=="procedures_mutatorarg"){const u=f.getFieldValue("NAME"),p=s.apply(u);p!==u&&f.setFieldValue(p,"NAME")}}}},renameBound:function(s,n){const i=k.Xml.domToText(this.mutationToDom()),o=this.declaredNames();for(let u=0;u<o.length;u++)Ce.renameFree(this.getInputTargetBlock("DECL"+u),n);const l=s.restrictDomain(o);this.renameVars(l);const h=n.remove(o).extend(l);Ce.renameFree(this.getInputTargetBlock(this.bodyInputName),h);const f=k.Xml.domToText(this.mutationToDom());if(k.Events.isEnabled()&&k.Events.fire(new k.Events.BlockChange(this,"mutation",null,i,f)),this.nextConnection){const u=this.nextConnection.targetBlock();Ce.renameFree(u,n)}},renameFree:function(s){const n=this.declaredNames(),i=new k.NameSet(n),o=Ce.freeVariables(this.getInputTargetBlock(this.bodyInputName));o.subtract(i);const l=o.renamed(s),h=l.intersection(i);if(h.isEmpty())this.renameBound(new k.Substitution,s);else{const f=i.union(l).toList(),u={},p=h.toList();for(let c=0,_;_=p[c];c++){const m=mt.nameNotIn(_,f);u[_]=m,f.push(m)}this.renameBound(new k.Substitution(u),s)}},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock(this.bodyInputName)),n=this.declaredNames();s.subtract(new k.NameSet(n));const i=n.length;for(let o=0;o<i;o++)s.union(Ce.freeVariables(this.getInputTargetBlock("DECL"+o)));if(this.nextConnection){const o=this.nextConnection.targetBlock();s.unite(Ce.freeVariables(o))}return s}};k.Blocks.local_declaration_expression={category:"Variables",helpUrl:k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_HELPURL,initLocals:k.Blocks.local_declaration_statement.initLocals,bodyInputName:"RETURN",init:function(){this.setStyle("variables_blocks"),this.initLocals(),this.appendValueInput("RETURN").appendField(k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN),this.setOutput(true,null),this.setTooltip(k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP)},referenceResults:function(s,n,i){const o=[];for(let p=0;this.getInput("DECL"+p);p++){let c=this.getFieldValue("VAR"+p);o.push(c)}const l=i.concat(o),h=[];for(let p=0;this.getInput("DECL"+p);p++){const c=this.getInputTargetBlock("DECL"+p);c&&h.push(c)}const f=h.map(function(p){return Ce.referenceResult(p,s,n,i)}),u=Ce.referenceResult(this.getInputTargetBlock("RETURN"),s,n,l);return f.concat([u])},withLexicalVarsAndPrefix:k.Blocks.local_declaration_statement.withLexicalVarsAndPrefix,onchange:k.Blocks.local_declaration_statement.onchange,mutationToDom:k.Blocks.local_declaration_statement.mutationToDom,domToMutation:k.Blocks.local_declaration_statement.domToMutation,updateDeclarationInputs_:k.Blocks.local_declaration_statement.updateDeclarationInputs_,parameterFlydown:k.Blocks.local_declaration_statement.parameterFlydown,blocksInScope:k.Blocks.local_declaration_statement.blocksInScope,decompose:k.Blocks.local_declaration_statement.decompose,compose:k.Blocks.local_declaration_statement.compose,dispose:k.Blocks.local_declaration_statement.dispose,saveConnections:k.Blocks.local_declaration_statement.saveConnections,getVars:k.Blocks.local_declaration_statement.getVars,declaredNames:k.Blocks.local_declaration_statement.declaredNames,declaredVariables:k.Blocks.local_declaration_statement.declaredVariables,renameVar:k.Blocks.local_declaration_statement.renameVar,renameVars:k.Blocks.local_declaration_statement.renameVars,renameBound:k.Blocks.local_declaration_statement.renameBound,renameFree:k.Blocks.local_declaration_statement.renameFree,freeVariables:k.Blocks.local_declaration_statement.freeVariables};k.Blocks.local_mutatorcontainer={init:function(){this.setStyle("variable_blocks"),this.appendDummyInput().appendField(k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES),this.appendStatementInput("STACK"),this.setTooltip(k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP),this.contextMenu=false,this.mustNotRenameCapturables=true},setDefBlock:function(s){this.defBlock_=s},getDefBlock:function(){return this.defBlock_},declaredNames:function(){const s=[];let n=this.getInputTargetBlock("STACK");for(;n;)s.push(n.getFieldValue("NAME")),n=n.nextConnection&&n.nextConnection.targetBlock();return s}};k.Blocks.local_mutatorarg={init:function(){this.setStyle("variable_blocks"),this.appendDummyInput().appendField(k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME).appendField(new k.FieldTextInput(k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE,Ce.renameParam),"NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(""),this.contextMenu=false,this.lexicalVarPrefix=l0,this.mustNotRenameCapturables=true},getContainerBlock:function(){let s=this.getParent();for(;s&&s.type!=="local_mutatorcontainer";)s=s.getParent();return this.cachedContainerBlock_=s&&s.type==="local_mutatorcontainer"&&s||null,this.cachedContainerBlock_},getDefBlock:function(){const s=this.getContainerBlock();return s&&s.getDefBlock()||null},blocksInScope:function(){const s=this.getDefBlock();return s&&s.blocksInScope()||[]},declaredNames:function(){const s=this.getContainerBlock();return s&&s.declaredNames()||[]},onchange:function(){const s=this.getFieldValue("NAME");if(s){const n=this.cachedContainerBlock_,i=this.getContainerBlock();if(!n&&i){const o=this.declaredNames(),l=o.indexOf(s);if(l!=-1&&o.indexOf(s,l+1)!=-1){const f=mt.nameNotIn(s,o);this.setFieldValue(f,"NAME")}}}}};k.Blocks.controls_forRange={category:"Control",helpUrl:k.Msg.LANG_CONTROLS_FORRANGE_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendValueInput("START").setCheck(zu("number",Wu)).appendField(k.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM).appendField(new os(k.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR,true,at.DISPLAY_BELOW),"VAR").appendField(k.Msg.LANG_CONTROLS_FORRANGE_INPUT_START).setAlign(k.ALIGN_RIGHT),this.appendValueInput("END").setCheck(zu("number",Wu)).appendField(k.Msg.LANG_CONTROLS_FORRANGE_INPUT_END).setAlign(k.ALIGN_RIGHT),this.appendValueInput("STEP").setCheck(zu("number",Wu)).appendField(k.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP).setAlign(k.ALIGN_RIGHT),this.appendStatementInput("DO").appendField(k.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO).setAlign(k.ALIGN_RIGHT),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(k.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP),this.lexicalVarPrefix=TP},referenceResults:function(s,n,i){let o=this.getFieldValue("VAR");const l=i.concat([o]),h=Ce.referenceResult(this.getInputTargetBlock("START"),s,n,i),f=Ce.referenceResult(this.getInputTargetBlock("END"),s,n,i),u=Ce.referenceResult(this.getInputTargetBlock("STEP"),s,n,i),p=Ce.referenceResult(this.getInputTargetBlock("DO"),s,n,l),c=Ce.referenceResult(Ce.getNextTargetBlock(this),s,n,i);return[h,f,u,p,c]},withLexicalVarsAndPrefix:function(s,n){if(this.getInputTargetBlock("DO")==s){const i=this.getFieldValue("VAR");n(i,this.lexicalVarPrefix)}},getVars:function(){return[this.getFieldValue("VAR")]},blocksInScope:function(){const s=this.getInputTargetBlock("DO");return s?[s]:[]},declaredNames:function(){return[this.getFieldValue("VAR")]},renameVar:function(s,n){k.Names.equals(s,this.getFieldValue("VAR"))&&this.setFieldValue(n,"VAR")},renameBound:function(s,n){Ce.renameFree(this.getInputTargetBlock("START"),n),Ce.renameFree(this.getInputTargetBlock("END"),n),Ce.renameFree(this.getInputTargetBlock("STEP"),n);const i=this.getFieldValue("VAR"),o=s.apply(i);if(o!==i){this.renameVar(i,o);const l=k.Substitution.simpleSubstitution(i,o),h=n.extend(l);Ce.renameFree(this.getInputTargetBlock("DO"),h)}else{const l=n.remove([i]);Ce.renameFree(this.getInputTargetBlock("DO"),l)}if(this.nextConnection){const l=this.nextConnection.targetBlock();Ce.renameFree(l,n)}},renameFree:function(s){const n=this.getFieldValue("VAR"),i=Ce.freeVariables(this.getInputTargetBlock("DO"));i.deleteName(n);const o=i.renamed(s);if(o.isMember(n)){const l=mt.nameNotIn(n,o.toList()),h=k.Substitution.simpleSubstitution(n,l);this.renameBound(h,s)}else this.renameBound(new k.Substitution,s)},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock("DO"));if(s.deleteName(this.getFieldValue("VAR")),s.unite(Ce.freeVariables(this.getInputTargetBlock("START"))),s.unite(Ce.freeVariables(this.getInputTargetBlock("END"))),s.unite(Ce.freeVariables(this.getInputTargetBlock("STEP"))),this.nextConnection){const n=this.nextConnection.targetBlock();s.unite(Ce.freeVariables(n))}return s}};delete k.Blocks.controls_for;k.Blocks.controls_for=k.Blocks.controls_forRange;k.Blocks.controls_forEach={category:"Control",helpUrl:k.Msg.LANG_CONTROLS_FOREACH_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendValueInput("LIST").setCheck(zu("list",Wu)).appendField(k.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM).appendField(new os(k.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR,true,at.DISPLAY_BELOW),"VAR").appendField(k.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST).setAlign(k.ALIGN_RIGHT),this.appendStatementInput("DO").appendField(k.Msg.LANG_CONTROLS_FOREACH_INPUT_DO),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(k.Msg.LANG_CONTROLS_FOREACH_TOOLTIP),this.lexicalVarPrefix=vP},referenceResults:function(s,n,i){let o=this.getFieldValue("VAR");const l=i.concat([o]),h=Ce.referenceResult(this.getInputTargetBlock("LIST"),s,n,i),f=Ce.referenceResult(this.getInputTargetBlock("DO"),s,n,l),u=Ce.referenceResult(Ce.getNextTargetBlock(this),s,n,i);return[h,f,u]},withLexicalVarsAndPrefix:k.Blocks.controls_forRange.withLexicalVarsAndPrefix,getVars:function(){return[this.getFieldValue("VAR")]},blocksInScope:function(){const s=this.getInputTargetBlock("DO");return s?[s]:[]},declaredNames:function(){return[this.getFieldValue("VAR")]},renameVar:function(s,n){k.Names.equals(s,this.getFieldValue("VAR"))&&this.setFieldValue(n,"VAR")},renameBound:function(s,n){Ce.renameFree(this.getInputTargetBlock("LIST"),n);const i=this.getFieldValue("VAR"),o=s.apply(i);if(o!==i){this.renameVar(i,o);const l=k.Substitution.simpleSubstitution(i,o),h=n.extend(l);Ce.renameFree(this.getInputTargetBlock("DO"),h)}else{const l=n.remove([i]);Ce.renameFree(this.getInputTargetBlock("DO"),l)}if(this.nextConnection){const l=this.nextConnection.targetBlock();Ce.renameFree(l,n)}},renameFree:function(s){const n=this.getFieldValue("VAR"),i=Ce.freeVariables(this.getInputTargetBlock("DO"));i.deleteName(n);const o=i.renamed(s);if(o.isMember(n)){const l=mt.nameNotIn(n,o.toList()),h=k.Substitution.simpleSubstitution(n,l);this.renameBound(h,s)}else this.renameBound(new k.Substitution,s)},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock("DO"));if(s.deleteName(this.getFieldValue("VAR")),s.unite(Ce.freeVariables(this.getInputTargetBlock("LIST"))),this.nextConnection){const n=this.nextConnection.targetBlock();s.unite(Ce.freeVariables(n))}return s}};k.Blocks.controls_do_then_return={category:"Control",helpUrl:k.Msg.LANG_CONTROLS_DO_THEN_RETURN_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendStatementInput("STM").appendField(k.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO),this.appendValueInput("VALUE").appendField(k.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN).setAlign(k.ALIGN_RIGHT),this.setOutput(true,null),this.setTooltip(k.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP)}};/**
 * @license
 * @fileoverview Procedure blocks for Blockly, modified for MIT App Inventor.
 * @author mckinney@mit.edu (Andrew F. McKinney)
 */k.Blocks.procedures_defnoreturn={category:"Procedures",helpUrl:k.Msg.LANG_PROCEDURES_DEFNORETURN_HELPURL,bodyInputName:"STACK",init:function(){this.setStyle("procedure_blocks");const s=k.Procedures.findLegalName(k.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE,this);this.createHeader(s),this.horizontalParameters=true,this.appendStatementInput("STACK").appendField(k.Msg.LANG_PROCEDURES_DEFNORETURN_DO),this.setMutator(new k.Mutator(["procedures_mutatorarg"])),this.setTooltip(k.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP),this.arguments_=[],this.warnings=[{name:"checkEmptySockets",sockets:["STACK"]}],this.lexicalVarPrefix=a0},createHeader:function(s){return this.appendDummyInput("HEADER").appendField(k.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE).appendField(new ec(s),"NAME")},withLexicalVarsAndPrefix:function(s,n){const i=this.declaredNames();for(let o=0;o<i.length;o++)n(i[o],this.lexicalVarPrefix)},onchange:function(){this.arguments_=this.declaredNames()},updateParams_:function(s){s&&(this.arguments_=s);let n=false;const i={};for(let c=0;c<this.arguments_.length;c++){if(i["arg_"+this.arguments_[c].toLowerCase()]){n=true;break}i["arg_"+this.arguments_[c].toLowerCase()]=true}n?this.setWarningText(k.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING):this.setWarningText(null);const o=this.getFieldValue("NAME"),l=this.inputList[this.inputList.length-1],h=this.rendered;this.rendered=false;const f=this;os.withChangeHanderDisabled(function(){f.removeInput("HEADER")});const u=this.inputList.length-1;if(u>0&&this.getInput("VAR0"))for(let _=0;_<u;_++)try{os.withChangeHanderDisabled(function(){f.removeInput("VAR"+_)})}catch(m){console.log(m)}this.inputList=[];const p=this.createHeader(o);if(this.horizontalParameters)for(let c=0;c<this.arguments_.length;c++)p.appendField(" ").appendField(this.parameterFlydown(c),"VAR"+c);else for(let c=0;c<this.arguments_.length;c++)this.appendDummyInput("VAR"+c).appendField(this.parameterFlydown(c),"VAR"+c).setAlign(k.ALIGN_RIGHT);this.inputList=this.inputList.concat(l),this.rendered=h;for(let c=0;c<this.inputList.length;c++)this.inputList[c].init();this.rendered&&this.render(),this.workspace.loadCompleted&&k.Procedures.mutateCallers(this)},parameterFlydown:function(s){const n=this.arguments_[s],i=this,o=function(l){const h=i.arguments_;if(h[s]=l,k.Procedures.mutateCallers(i),i.mutator&&i.mutator.rootBlock_){const f=i.mutator.rootBlock_;let u=0,p=f.getInputTargetBlock("STACK");for(;p&&u<s;)p=p.nextConnection&&p.nextConnection.targetBlock(),u++;p&&u==s&&p.getField("NAME").setValue(l)}};return new os(n,true,this.horizontalParameters?at.DISPLAY_BELOW:at.DISPLAY_RIGHT,o)},setParameterOrientation:function(s){this.getParameters().length!=0&&s!==this.horizontalParameters&&(this.horizontalParameters=s,this.updateParams_(),k.Events.isEnabled()&&k.Events.fire(new k.Events.Ui(this,"parameter_orientation",(!this.horizontalParameters).toString(),this.horizontalParameters.toString())))},mutationToDom:function(){const s=document.createElement("mutation");this.horizontalParameters||s.setAttribute("vertical_parameters","true");for(let n=0;n<this.arguments_.length;n++){const i=document.createElement("arg");i.setAttribute("name",this.arguments_[n]),s.appendChild(i)}return s},domToMutation:function(s){const n=[],i=fh(s);for(let o=0,l;l=i[o];o++)l.nodeName.toLowerCase()=="arg"&&n.push(l.getAttribute("name"));this.horizontalParameters=s.getAttribute("vertical_parameters")!=="true",this.updateParams_(n)},decompose:function(s){const n=s.newBlock("procedures_mutatorcontainer");n.initSvg(),n.setProcBlock(this),this.paramIds_=[];let i=n.getInput("STACK").connection;for(let o=0;o<this.arguments_.length;o++){const l=s.newBlock("procedures_mutatorarg");this.paramIds_.push(l.id),l.initSvg(),l.setFieldValue(this.arguments_[o],"NAME"),l.oldLocation=o,i.connect(l.previousConnection),i=l.nextConnection}return k.Procedures.mutateCallers(this),n},compose:function(s){const n=[];this.paramIds_=[];let i=s.getInputTargetBlock("STACK");for(;i;)n.push(i.getFieldValue("NAME")),this.paramIds_.push(i.id),i=i.nextConnection&&i.nextConnection.targetBlock();Ce.stringListsEqual(n,this.arguments_)||(this.updateParams_(n),k.Procedures.mutateCallers(this))},dispose:function(...s){const n=this.getFieldValue("NAME"),i=this.editable_,o=this.workspace;i&&CP(n,o),k.BlockSvg.prototype.dispose.apply(this,s);const l=o.getProcedureDatabase();i&&l&&l.removeProcedure(this.id)},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,this.bodyInputName==="RETURN"]},getVars:function(){const s=[];for(let n=0,i;i=this.getFieldValue("VAR"+n);n++)s.push(i);return s},declaredNames:function(){return this.getVars()},declaredVariables:function(){return this.getVars()},renameVar:function(s,n){this.renameVars(k.Substitution.simpleSubstitution(s,n))},renameVars:function(s){const n=this.getParameters(),i=s.map(n);if(!Ce.stringListsEqual(n,i)&&(this.updateParams_(i),this.mutator.isVisible())){const o=this.mutator.workspace_.getAllBlocks();for(let l=0,h;h=o[l];l++)if(h.type=="procedures_mutatorarg"){const f=h.getFieldValue("NAME"),u=s.apply(f);u!==f&&h.setFieldValue(u,"NAME")}}},renameBound:function(s,n){const i=s.restrictDomain(this.declaredNames());this.renameVars(i);const o=n.extend(i);Ce.renameFree(this.getInputTargetBlock(this.bodyInputName),o)},renameFree:function(s){this.freeVariables()},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock(this.bodyInputName));if(s.subtract(new k.NameSet(this.declaredNames())),s.isEmpty())return s;throw Error("Violation of invariant: procedure declaration has nonempty free variables: "+s.toString())},blocksInScope:function(){const s=this.getInputTargetBlock(this.bodyInputName);return s&&[s]||[]},customContextMenu:function(s){os.addHorizontalVerticalOption(this,s)},getParameters:function(){return this.arguments_}};k.Blocks.procedures_defreturn={category:"Procedures",helpUrl:k.Msg.PROCEDURES_DEFRETURN_HELPURL,bodyInputName:"RETURN",init:function(){this.setStyle("procedure_blocks");const s=k.Procedures.findLegalName(k.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE,this);this.createHeader(s),this.horizontalParameters=true,this.appendValueInput("RETURN").setAlign(k.ALIGN_RIGHT).appendField(k.Msg.LANG_PROCEDURES_DEFRETURN_RETURN),this.setMutator(new k.Mutator(["procedures_mutatorarg"])),this.setTooltip(k.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP),this.arguments_=[],this.warnings=[{name:"checkEmptySockets",sockets:["RETURN"]}]},createHeader:function(s){return this.appendDummyInput("HEADER").appendField(k.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE).appendField(new ec(s),"NAME")},withLexicalVarsAndPrefix:k.Blocks.procedures_defnoreturn.withLexicalVarsAndPrefix,onchange:k.Blocks.procedures_defnoreturn.onchange,updateParams_:k.Blocks.procedures_defnoreturn.updateParams_,parameterFlydown:k.Blocks.procedures_defnoreturn.parameterFlydown,setParameterOrientation:k.Blocks.procedures_defnoreturn.setParameterOrientation,mutationToDom:k.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:k.Blocks.procedures_defnoreturn.domToMutation,decompose:k.Blocks.procedures_defnoreturn.decompose,compose:k.Blocks.procedures_defnoreturn.compose,dispose:k.Blocks.procedures_defnoreturn.dispose,getProcedureDef:k.Blocks.procedures_defnoreturn.getProcedureDef,getVars:k.Blocks.procedures_defnoreturn.getVars,declaredNames:k.Blocks.procedures_defnoreturn.declaredNames,declaredVariables:k.Blocks.procedures_defnoreturn.declaredVariables,renameVar:k.Blocks.procedures_defnoreturn.renameVar,renameVars:k.Blocks.procedures_defnoreturn.renameVars,renameBound:k.Blocks.procedures_defnoreturn.renameBound,renameFree:k.Blocks.procedures_defnoreturn.renameFree,freeVariables:k.Blocks.procedures_defnoreturn.freeVariables,blocksInScope:k.Blocks.procedures_defnoreturn.blocksInScope,customContextMenu:k.Blocks.procedures_defnoreturn.customContextMenu,getParameters:k.Blocks.procedures_defnoreturn.getParameters};k.Blocks.procedures_mutatorcontainer={init:function(){this.setStyle("procedure_blocks"),this.appendDummyInput().appendField(k.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.setTooltip(k.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=false,this.mustNotRenameCapturables=true},setProcBlock:function(s){this.procBlock_=s},getProcBlock:function(){return this.procBlock_},declaredNames:function(){const s=[];let n=this.getInputTargetBlock("STACK");for(;n;)s.push(n.getFieldValue("NAME")),n=n.nextConnection&&n.nextConnection.targetBlock();return s}};k.Blocks.procedures_mutatorarg={init:function(){this.setStyle("procedure_blocks");const s=new k.FieldTextInput("x",Ce.renameParam);s.onHtmlInputChange_=function(n){const i=this.getValue();at.prototype.onHtmlInputChange_.call(this,n);const o=this.getValue();o&&i!==o&&k.Events.isEnabled()&&k.Events.fire(new k.Events.BlockChange(this.sourceBlock_,"field",this.name,i,o))},this.appendDummyInput().appendField(k.Msg.LANG_PROCEDURES_MUTATORARG_TITLE).appendField(s,"NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(k.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=false,this.lexicalVarPrefix=a0,this.mustNotRenameCapturables=true},getContainerBlock:function(){let s=this.getParent();for(;s&&s.type!=="procedures_mutatorcontainer";)s=s.getParent();return this.cachedContainerBlock_=s&&s.type==="procedures_mutatorcontainer"&&s||null,this.cachedContainerBlock_},getProcBlock:function(){const s=this.getContainerBlock();return s&&s.getProcBlock()||null},declaredNames:function(){const s=this.getContainerBlock();return s&&s.declaredNames()||[]},blocksInScope:function(){const s=this.getProcBlock();return s&&s.blocksInScope()||[]},onchange:function(){const s=this.getFieldValue("NAME");if(s){const n=this.cachedContainerBlock_,i=this.getContainerBlock();if(!n&&i){const o=this.declaredNames(),l=o.indexOf(s);if(l!=-1&&o.indexOf(s,l+1)!=-1){const f=mt.nameNotIn(s,o);this.setFieldValue(f,"NAME")}}}}};k.Blocks.procedures_mutatorarg.validator=function(s){return s=s.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),s||null};k.Blocks.procedures_callnoreturn={category:"Procedures",helpUrl:k.Msg.LANG_PROCEDURES_CALLNORETURN_HELPURL,init:function(){this.setStyle("procedure_blocks");const s=this.workspace.getTopWorkspace().getProcedureDatabase();this.procNamesFxn=function(){const n=s.getMenuItems(false);return n.length>0?n:["",""]},this.procDropDown=new ga(this.procNamesFxn,th),this.procDropDown.block=this,this.appendDummyInput().appendField(k.Msg.LANG_PROCEDURES_CALLNORETURN_CALL).appendField(this.procDropDown,"PROCNAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(k.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP),this.arguments_=[],this.quarkConnections_=null,this.quarkArguments_=null,this.errors=[{func:gc},{func:fc,dropDowns:["PROCNAME"]}],this.setOnChange(function(n){pc(this)}),th.call(this.getField("PROCNAME"),this.getField("PROCNAME").getValue())},getProcedureCall:function(){return this.getFieldValue("PROCNAME")},renameProcedure:function(s,n){(!s||k.Names.equals(s,this.getFieldValue("PROCNAME")))&&(this.getField("PROCNAME").getOptions(),this.setFieldValue(n,"PROCNAME"))},setProcedureParameters:function(s,n,i){let o,l,h;if(n||(this.quarkConnections_={},this.quarkArguments_=null,n=[].concat(s)),n.length!=s.length)throw Error("Error: paramNames and paramIds must be the same length.");const f={};for(let p=0;p<s.length;p++)f[n[p]]=s[p];typeof i>"u"&&(i=null),(!this.quarkArguments_||i)&&(this.quarkConnections_={},Ce.stringListsEqual(s,this.arguments_)||i?this.quarkArguments_=n:this.quarkArguments_=[]);const u=this.rendered;for(this.rendered=false,h=0;this.getInput("ARG"+h);h++)o=this.getInput("ARG"+h),o&&(l=o.connection.targetConnection,this.quarkConnections_[this.quarkArguments_[h]]=l,this.removeInput("ARG"+h));for(this.arguments_=[].concat(s),this.quarkArguments_=n,h=0;h<this.arguments_.length;h++)if(o=this.appendValueInput("ARG"+h).setAlign(k.ALIGN_RIGHT).appendField(this.arguments_[h]),this.quarkArguments_){const p=this.quarkArguments_[h];p in this.quarkConnections_?(l=this.quarkConnections_[p],!l||l.targetConnection||l.sourceBlock_.workspace!=this.workspace?delete this.quarkConnections_[p]:o.connection.connect(l)):f[p]&&(l=this.quarkConnections_[f[p]],l&&o.connection.connect(l))}if(this.rendered=u,!!this.workspace.rendered){for(h=0;h<this.arguments_.length;h++)this.getInput("ARG"+h).init();this.rendered&&this.render()}},mutationToDom:function(){const s=document.createElement("mutation");s.setAttribute("name",this.getFieldValue("PROCNAME"));for(let n=0;this.getInput("ARG"+n);n++){const i=document.createElement("arg");i.setAttribute("name",this.getInput("ARG"+n).fieldRow[0].getText()),s.appendChild(i)}return s},domToMutation:function(s){const n=s.getAttribute("name");this.setFieldValue(n,"PROCNAME"),this.arguments_=[];const i=fh(s);for(let o=0,l;l=i[o];o++)l.nodeName.toLowerCase()=="arg"&&this.arguments_.push(l.getAttribute("name"));this.setProcedureParameters(this.arguments_,null,true)},renameVar:function(s,n){for(let i=0;i<this.arguments_.length;i++)k.Names.equals(s,this.arguments_[i])&&(this.arguments_[i]=n,this.getInput("ARG"+i).fieldRow[0].setValue(n))},procCustomContextMenu:function(s){const n={enabled:true};n.text=k.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF;const i=this.getFieldValue("PROCNAME"),o=this.workspace;n.callback=function(){const l=k.Procedures.getDefinition(i,o);l&&(l.select(),o.centerOnBlock(l.id),o.getParentSvg().parentElement.focus())},s.push(n)},removeProcedureValue:function(){for(let s=0;this.getInput("ARG"+s)!==null;s++)this.removeInput("ARG"+s);this.setFieldValue("none","PROCNAME")}};k.Blocks.procedures_callreturn={category:"Procedures",helpUrl:k.Msg.LANG_PROCEDURES_CALLRETURN_HELPURL,init:function(){this.setStyle("procedure_blocks");const s=this.workspace.getTopWorkspace().getProcedureDatabase();this.procNamesFxn=function(){const n=s.getMenuItems(true);return n.length>0?n:["",""]},this.procDropDown=new ga(this.procNamesFxn,th),this.procDropDown.block=this,this.appendDummyInput().appendField(k.Msg.LANG_PROCEDURES_CALLRETURN_CALL).appendField(this.procDropDown,"PROCNAME"),this.setOutput(true,null),this.setTooltip(k.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP),this.arguments_=[],this.quarkConnections_=null,this.quarkArguments_=null,this.errors=[{func:gc},{func:fc,dropDowns:["PROCNAME"]}],this.setOnChange(function(n){pc(this)}),th.call(this.getField("PROCNAME"),this.getField("PROCNAME").getValue())},getProcedureCall:k.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:k.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters:k.Blocks.procedures_callnoreturn.setProcedureParameters,mutationToDom:k.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:k.Blocks.procedures_callnoreturn.domToMutation,renameVar:k.Blocks.procedures_callnoreturn.renameVar,procCustomContextMenu:k.Blocks.procedures_callnoreturn.procCustomContextMenu,removeProcedureValue:k.Blocks.procedures_callnoreturn.removeProcedureValue};ue.javascriptGenerator.controls_for=function(s){const n=ue.javascriptGenerator.nameDB_.getName(s.getFieldValue("VAR"),k.VARIABLE_CATEGORY_NAME),i=ue.javascriptGenerator.valueToCode(s,"START",ue.javascriptGenerator.ORDER_ASSIGNMENT)||"0",o=ue.javascriptGenerator.valueToCode(s,"END",ue.javascriptGenerator.ORDER_ASSIGNMENT)||"0",l=ue.javascriptGenerator.valueToCode(s,"STEP",ue.javascriptGenerator.ORDER_ASSIGNMENT)||"1";let h=ue.javascriptGenerator.statementToCode(s,"DO");h=ue.javascriptGenerator.addLoopTrap(h,s);let f;if(k.utils.string.isNumber(i)&&k.utils.string.isNumber(o)&&k.utils.string.isNumber(l)){const u=Number(i)<=Number(o);f="for (let "+n+" = "+i+"; "+n+(u?" <= ":" >= ")+o+"; "+n;const p=Math.abs(Number(l));p==1?f+=u?"++":"--":f+=(u?" += ":" -= ")+p,f+=`) {
`+h+`}
`}else{f="";let u=i;!i.match(/^\w+$/)&&!k.utils.string.isNumber(i)&&(u=ue.javascriptGenerator.nameDB_.getDistinctName(n+"_start",k.VARIABLE_CATEGORY_NAME),f+="let "+u+" = "+i+`;
`);let p=o;!o.match(/^\w+$/)&&!k.utils.string.isNumber(o)&&(p=ue.javascriptGenerator.nameDB_.getDistinctName(n+"_end",k.VARIABLE_CATEGORY_NAME),f+="let "+p+" = "+o+`;
`);const c=ue.javascriptGenerator.nameDB_.getDistinctName(n+"_inc",k.VARIABLE_CATEGORY_NAME);f+="let "+c+" = ",k.utils.string.isNumber(l)?f+=Math.abs(l)+`;
`:f+="Math.abs("+l+`);
`,f+="if ("+u+" > "+p+`) {
`,f+=ue.javascriptGenerator.INDENT+c+" = -"+c+`;
`,f+=`}
`,f+="for ("+n+" = "+u+"; "+c+" >= 0 ? "+n+" <= "+p+" : "+n+" >= "+p+"; "+n+" += "+c+`) {
`+h+`}
`}return f};ue.javascriptGenerator.controls_forRange=ue.javascriptGenerator.controls_for;ue.javascriptGenerator.controls_forEach=function(s){const n=ue.javascriptGenerator.nameDB_.getName(s.getFieldValue("VAR"),k.VARIABLE_CATEGORY_NAME),i=ue.javascriptGenerator.valueToCode(s,"LIST",ue.javascriptGenerator.ORDER_ASSIGNMENT)||"[]";let o=ue.javascriptGenerator.statementToCode(s,"DO");o=ue.javascriptGenerator.addLoopTrap(o,s);let l="",h=i;i.match(/^\w+$/)||(h=ue.javascriptGenerator.nameDB_.getDistinctName(n+"_list",k.VARIABLE_CATEGORY_NAME),l+="const "+h+" = "+i+`;
`);const f=ue.javascriptGenerator.nameDB_.getDistinctName(n+"_index",k.VARIABLE_CATEGORY_NAME);return o=ue.javascriptGenerator.INDENT+"const "+n+" = "+h+"["+f+`];
`+o,l+="for (let "+f+" in "+h+`) {
`+o+`}
`,l};ue.javascriptGenerator.procedures_callreturn=function(s){const n=ue.javascriptGenerator.nameDB_.getName(s.getFieldValue("PROCNAME"),k.PROCEDURE_CATEGORY_NAME),i=[],o=s.arguments_;for(let h=0;h<o.length;h++)i[h]=ue.javascriptGenerator.valueToCode(s,"ARG"+h,ue.javascriptGenerator.ORDER_NONE)||"null";return[n+"("+i.join(", ")+")",ue.javascriptGenerator.ORDER_FUNCTION_CALL]};ue.javascriptGenerator.lexical_variable_get=function(s){return[h0(s.getFieldValue("VAR")),ue.javascriptGenerator.ORDER_ATOMIC]};function h0(s){const n=c0(s),i=n[0],o=n[1];return i===k.Msg.LANG_VARIABLES_GLOBAL_PREFIX||i===Ql?o:$P()(o)}function d0(s,n){const i=ue.javascriptGenerator.valueToCode(s,"VALUE",ue.javascriptGenerator.ORDER_ASSIGNMENT)||"0";return h0(s.getFieldValue(n))+" = "+i+`;
`}ue.javascriptGenerator.lexical_variable_set=function(s){return d0(s,"VAR")};ue.javascriptGenerator.global_declaration=function(s){return"var "+d0(s,"NAME")};ue.javascriptGenerator.local_declaration_statement=function(){let s=`{
  let `;for(let n=0;this.getFieldValue("VAR"+n);n++)s+=""+this.getFieldValue("VAR"+n),s+=" = "+(ue.javascriptGenerator.valueToCode(this,"DECL"+n,ue.javascriptGenerator.ORDER_NONE)||"0"),s+=", ";return s=s.slice(0,-2),s+=`;
`,s+=ue.javascriptGenerator.statementToCode(this,"STACK",ue.javascriptGenerator.ORDER_NONE),s+=`}
`,s};ue.javascriptGenerator.local_declaration_expression=function(){return"NOT IMPLEMENTED YET"};/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */fP();function kP(s){const n=new oi(new k.Options({scrollbars:false,rtl:s.RTL,renderer:s.options.renderer,rendererOverrides:s.options.rendererOverrides}));s.flydown_=n,k.utils.dom.insertAfter(n.createDom("g"),s.svgBubbleCanvas_),n.init(s),n.autoClose=true}const AP=`<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">
  <category name="\u7A0B\u5E8F">
    <category name="\u903B\u8F91" colour="#5b80a5">
      <block type="controls_if"/>
      <block type="logic_compare">
        <field name="OP">EQ</field>
      </block>
      <block type="logic_operation">
        <field name="OP">AND</field>
      </block>
      <block type="logic_negate"/>
      <block type="logic_boolean">
        <field name="BOOL">TRUE</field>
      </block>
      <block type="logic_null"/>
      <block type="logic_ternary"/>
      <block type="sleep">
        <value name="milliseconds">
          <shadow type="math_number">
            <field name="NUM">1000</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="\u5FAA\u73AF" colour="#5ba55b">
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <block type="controls_whileUntil">
        <field name="MODE">WHILE</field>
      </block>
      <block type="controls_for">
        <field name="VAR" id="s~#wpBU?bO8qfKP2Fg54">i</field>
        <value name="FROM">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
        <value name="BY">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="controls_forEach">
        <field name="VAR" id="rciFyVTbkL=@%u!{2zW#">j</field>
      </block>
      <block type="controls_flow_statements">
        <field name="FLOW">BREAK</field>
      </block>
    </category>
    <category name="\u6570\u5B66" colour="#5b67a5">
      <block type="math_number">
        <field name="NUM">0</field>
      </block>
      <block type="to_number"/>
      <block type="math_arithmetic">
        <field name="OP">ADD</field>
        <value name="A">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="B">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="math_single">
        <field name="OP">ROOT</field>
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">9</field>
          </shadow>
        </value>
      </block>
      <block type="math_trig">
        <field name="OP">SIN</field>
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">45</field>
          </shadow>
        </value>
      </block>
      <block type="math_constant">
        <field name="CONSTANT">PI</field>
      </block>
      <block type="math_number_property">
        <mutation divisor_input="false"/>
        <field name="PROPERTY">EVEN</field>
        <value name="NUMBER_TO_CHECK">
          <shadow type="math_number">
            <field name="NUM">0</field>
          </shadow>
        </value>
      </block>
      <block type="math_round">
        <field name="OP">ROUND</field>
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">3.1</field>
          </shadow>
        </value>
      </block>
      <block type="math_on_list">
        <mutation op="SUM"/>
        <field name="OP">SUM</field>
      </block>
      <block type="math_modulo">
        <value name="DIVIDEND">
          <shadow type="math_number">
            <field name="NUM">64</field>
          </shadow>
        </value>
        <value name="DIVISOR">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <block type="math_constrain">
        <value name="VALUE">
          <shadow type="math_number">
            <field name="NUM">50</field>
          </shadow>
        </value>
        <value name="LOW">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="HIGH">
          <shadow type="math_number">
            <field name="NUM">100</field>
          </shadow>
        </value>
      </block>
      <block type="math_random_int">
        <value name="FROM">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="math_number">
            <field name="NUM">100</field>
          </shadow>
        </value>
      </block>
      <block type="math_random_float"/>
    </category>
    <category name="\u6587\u672C" colour="#5ba58c">
      <block type="text">
        <field name="TEXT"/>
      </block>
      <block type="text_join">
        <mutation items="2"/>
      </block>
      <block type="text_append">
        <field name="VAR" id="ho\`IB%Dj!ZWh5[SE\`Ag^">item</field>
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT"/>
          </shadow>
        </value>
      </block>
      <block type="text_length">
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_isEmpty">
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT"/>
          </shadow>
        </value>
      </block>
      <block type="text_indexOf">
        <field name="END">FIRST</field>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" id="oW~/D1yIDK![r#WDIF==">text</field>
          </block>
        </value>
        <value name="FIND">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_charAt">
        <mutation at="true"/>
        <field name="WHERE">FROM_START</field>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" id="oW~/D1yIDK![r#WDIF==">text</field>
          </block>
        </value>
      </block>
      <block type="text_getSubstring">
        <mutation at1="true" at2="true"/>
        <field name="WHERE1">FROM_START</field>
        <field name="WHERE2">FROM_START</field>
        <value name="STRING">
          <block type="variables_get">
            <field name="VAR" id="oW~/D1yIDK![r#WDIF==">text</field>
          </block>
        </value>
      </block>
      <block type="text_changeCase">
        <field name="CASE">UPPERCASE</field>
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_trim">
        <field name="MODE">BOTH</field>
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="regular"/>
      <block type="template_string"/>
    </category>
    <category name="\u5217\u8868" colour="#745ba5">
      <block type="lists_create_with">
        <mutation items="0"/>
      </block>
      <block type="lists_create_with">
        <mutation items="3"/>
      </block>
      <block type="lists_repeat">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="lists_length"/>
      <block type="lists_isEmpty"/>
      <block type="lists_indexOf">
        <field name="END">FIRST</field>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>
          </block>
        </value>
      </block>
      <block type="lists_getIndex">
        <mutation statement="false" at="true"/>
        <field name="MODE">GET</field>
        <field name="WHERE">FROM_START</field>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>
          </block>
        </value>
      </block>
      <block type="lists_setIndex">
        <mutation at="true"/>
        <field name="MODE">SET</field>
        <field name="WHERE">FROM_START</field>
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>
          </block>
        </value>
      </block>
      <block type="lists_getSublist">
        <mutation at1="true" at2="true"/>
        <field name="WHERE1">FROM_START</field>
        <field name="WHERE2">FROM_START</field>
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>
          </block>
        </value>
      </block>
      <block type="lists_split">
        <mutation mode="SPLIT"/>
        <field name="MODE">SPLIT</field>
        <value name="DELIM">
          <shadow type="text">
            <field name="TEXT">,</field>
          </shadow>
        </value>
      </block>
      <block type="lists_sort">
        <field name="TYPE">NUMERIC</field>
        <field name="DIRECTION">1</field>
      </block>
    </category>
    <category name="\u53D8\u91CF" colour="#a55b80">
      <block type="global_declaration"/>
      <block type="lexical_variable_get"/>
      <block type="lexical_variable_set"/>
      <block type="local_declaration_statement"/>
    </category>
  </category>
  <sep/>
  <category name="\u673A\u5668\u4EBA">
    <category name="\u4E8B\u4EF6" colour="#5b80a5">
      <block type="middleware">
        <field name="NAME" id="j{f?,R~uQ{$}[B@0sUIA">item</field>
      </block>
      <block type="command"/>
      <block type="plugin_apply"/>
      <block type="on_message_event"/>
      <block type="on_guild_member_event"/>
      <block type="on_guild_event"/>
    </category>
    <category name="\u4F1A\u8BDD" colour="#5b80a5">
      <block type="get_argument"/>
      <block type="session_message"/>
      <block type="session_message_id"/>
      <block type="session_user_id"/>
      <block type="session_guild_id"/>
      <block type="session_channel_id"/>
      <block type="session_bot"/>
      <block type="session_elements"/>
      <block type="break_middleware"/>
    </category>
    <category name="\u6D88\u606F" colour="#5b80a5">
      <block type="send_session_message"/>
      <block type="return_message"/>
    </category>
    <category name="\u6D88\u606F\u5143\u7D20" colour="#5b80a5">
      <block type="segment_at">
        <value name="user">
          <shadow type="session_user_id"/>
        </value>
      </block>
      <block type="segment_image">
        <value name="image">
          <shadow type="text">
            <field name="TEXT">https://koishi.chat/logo.png</field>
          </shadow>
        </value>
      </block>
      <block type="segment_audio">
        <value name="audio">
          <shadow type="text">
            <field name="TEXT">https://example.org/example.mp3</field>
          </shadow>
        </value>
      </block>
      <block type="segment_video">
      <value name="video">
        <shadow type="text">
          <field name="TEXT">https://example.org/example.mp4</field>
        </shadow>
      </value>
    </block>
      <block type="parse_segment_list">
        <value name="segments">
          <shadow type="session_elements"/>
        </value>
      </block>
      <block type="current_segment"/>
    </category>
    <category name="\u6570\u636E" colour="#5b80a5">
      <block type="http_get">
        <value name="url">
          <shadow type="text">
            <field name="TEXT">https://koishi.chat/</field>
          </shadow>
        </value>
      </block>
      <block type="json_path_parse"/>
      <block type="key_value_write">
        <value name="scope_id">
          <shadow type="plugin_id"/>
        </value>
        <value name="key">
          <shadow type="text">
            <field name="TEXT">\u952E\u503C\u5BF9\u952E</field>
          </shadow>
        </value>

        <value name="value">
          <shadow type="text">
            <field name="TEXT">\u5199\u5165\u503C</field>
          </shadow>
        </value>
      </block>
      <block type="key_value_read">
        <value name="scope_id">
          <shadow type="plugin_id"/>
        </value>
        <value name="key">
          <shadow type="text">
            <field name="TEXT">\u952E\u503C\u5BF9\u952E</field>
          </shadow>
        </value>
        <value name="key">
          <shadow type="text">
            <field name="TEXT">\u952E\u503C\u5BF9\u952E</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="\u673A\u5668\u4EBA\u64CD\u4F5C" colour="#5b80a5">
      <block type="delete_message">
        <value name="bot">
          <shadow type="session_bot"/>
        </value>
        <value name="channel_id">
          <shadow type="session_channel_id"/>
        </value>
        <value name="message_id">
          <shadow type="session_message_id"/>
        </value>
      </block>
      <block type="mute_user">
        <value name="bot">
          <shadow type="session_bot"/>
        </value>
        <value name="guild_id">
          <shadow type="session_guild_id"/>
        </value>
        <value name="user_id">
          <shadow type="session_user_id"/>
        </value>
        <value name="time">
          <shadow type="math_number">
            <field name="NUM">60000</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="\u8C03\u8BD5" colour="#5b80a5">
      <block type="logging">
        <value name = "log">
          <shadow type="text">
            <field name="TEXT">Hello,world</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="\u73AF\u5883" colour="#5b80a5">
      <block type="time_stamp"/>
      <block type="time_format">
        <value name = "date">
          <shadow type="time_stamp"></shadow>
        </value>
      </block>
      <block type="plugin_id"/>
    </category>
  </category>
  <category name="\u8FDB\u9636">
    <category name="\u7C7B\u578B\u7CFB\u7EDF">
      <block type="type_getter"/>
      <block type="type_definition"/>
      <block type="type_any"/>
      <block type="type_never"/>
      <block type="type_string"/>
      <block type="type_number"/>
      <block type="type_boolean"/>
      <block type="type_array"/>
      <block type="type_union"/>
      <block type="type_object"/>
    </category>
  </category>
  <category name="\u7B2C\u4E09\u65B9">
    <category name="\u672A\u5206\u7C7B" custom="VENDOR_UNCATEGORIZED"/>
  </category>
</xml>
`,LP={type:"http_get",message0:"\u53D1\u9001\u7B80\u5355HTTP GET\u8BF7\u6C42 %1 \u7F51\u5740 %2 \u8FD4\u56DE\u7C7B\u578B %3",args0:[{type:"input_dummy"},{type:"input_value",name:"url"},{type:"field_dropdown",name:"response_type",options:[["\u9ED8\u8BA4\u7C7B\u578B",""],["JSON\u5BF9\u8C61\u7C7B\u578B","json"],["\u6587\u672C\u7C7B\u578B","text"]]}],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function NP(s){let n=ue.javascriptGenerator.valueToCode(s,"url",ue.javascriptGenerator.ORDER_ATOMIC),i=s.getFieldValue("response_type");return[`await ctx.http.get(${n},{responseType:"${i}"})`,ue.javascriptGenerator.ORDER_NONE]}const MP={type:"json_path_parse",message0:"\u89E3\u6790JSON\u5BF9\u8C61 %1 JSONPath %2",args0:[{type:"input_value",name:"value"},{type:"field_input",name:"path",text:"$"}],inputsInline:false,imports:{"jsonpath-plus":["JSONPath as parseJson"]},output:null,colour:230,tooltip:"",helpUrl:""};function DP(s){let n=ue.javascriptGenerator.valueToCode(s,"value",ue.javascriptGenerator.ORDER_ATOMIC);return[`await parseJson({path: "${s.getFieldValue("path")}", json: ${n}})`,ue.javascriptGenerator.ORDER_NONE]}const xP={type:"key_value_write",message0:"\u5199\u5165\u952E\u503C\u5BF9 \u4F5C\u7528\u57DFID %1 \u952E %2 \u503C %3",args0:[{type:"input_value",name:"scope_id"},{type:"input_value",name:"key"},{type:"input_value",name:"value",align:"RIGHT"}],template:["key_value_initialize"],inputsInline:false,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function BP(s){let n=ue.javascriptGenerator.valueToCode(s,"key",ue.javascriptGenerator.ORDER_ATOMIC),i=ue.javascriptGenerator.valueToCode(s,"value",ue.javascriptGenerator.ORDER_ATOMIC),o=ue.javascriptGenerator.valueToCode(s,"scope_id",ue.javascriptGenerator.ORDER_ATOMIC);return o.length&&(o+='+"."+'),`await ctx.database.upsert('blockly_key_value',[{key:${o}${n},value:${i}}],['key'])
`}const PP={type:"key_value_read",message0:"\u8BFB\u53D6\u952E\u503C\u5BF9 \u4F5C\u7528\u57DFID %1 \u952E %2",args0:[{type:"input_value",name:"scope_id"},{type:"input_value",name:"key"}],template:["key_value_initialize"],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function UP(s){let n=ue.javascriptGenerator.valueToCode(s,"key",ue.javascriptGenerator.ORDER_ATOMIC),i=ue.javascriptGenerator.valueToCode(s,"scope_id",ue.javascriptGenerator.ORDER_ATOMIC);return i.length&&(i+='+"."+'),[`(await ctx.database.get('blockly_key_value',{key:${i}${n}}))[0]?.value`,ue.javascriptGenerator.ORDER_NONE]}const FP=[LP,MP,xP,PP],GP={http_get:NP,json_path_parse:DP,key_value_write:BP,key_value_read:UP},HP={type:"parameter_list",message0:"\u53C2\u6570\u5217\u8868 %1",args0:[{type:"input_statement",name:"parameter_list",check:"Parameter"}],colour:230,tooltip:"",helpUrl:""},VP={type:"any_parameter",message0:"\u4EFB\u4F55\u7C7B\u578B\u53C2\u6570 %1 %2 \u53C2\u6570\u5FC5\u9009 %3",args0:[{type:"field_input",name:"name",text:"\u53C2\u6570\u540D\u79F0"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},WP={type:"string_parameter",message0:"\u5B57\u7B26\u4E32\u7C7B\u578B\u53C2\u6570 %1 %2 \u53C2\u6570\u5FC5\u9009 %3",args0:[{type:"field_input",name:"name",text:"\u53C2\u6570\u540D\u79F0"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},zP={type:"number_parameter",message0:"\u6570\u5B57\u7C7B\u578B\u53C2\u6570 %1 %2 \u53C2\u6570\u5FC5\u9009 %3",args0:[{type:"field_input",name:"name",text:"\u53C2\u6570\u540D\u79F0"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},jP={type:"int_parameter",message0:"\u6574\u6570\u7C7B\u578B\u53C2\u6570 %1 %2 \u53C2\u6570\u5FC5\u9009 %3",args0:[{type:"field_input",name:"name",text:"\u53C2\u6570\u540D\u79F0"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},XP={type:"boolean_parameter",message0:"\u5E03\u5C14\u7C7B\u578B\u53C2\u6570 %1 %2 \u53C2\u6570\u5FC5\u9009 %3",args0:[{type:"field_input",name:"name",text:"\u53C2\u6570\u540D\u79F0"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},KP={type:"posint_parameter",message0:"\u6B63\u6574\u6570\u7C7B\u578B\u53C2\u6570 %1 %2 \u53C2\u6570\u5FC5\u9009 %3",args0:[{type:"field_input",name:"name",text:"\u53C2\u6570\u540D\u79F0"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},YP={type:"text_parameter",message0:"\u957F\u6587\u672C\u7C7B\u578B\u53C2\u6570 %1 %2 \u53C2\u6570\u5FC5\u9009 %3",args0:[{type:"field_input",name:"name",text:"\u53C2\u6570\u540D\u79F0"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},qP=[HP,VP,WP,zP,jP,XP,KP,YP],JP={type:"get_argument",message0:"\u7B2C %1 \u4E2A\u53C2\u6570",args0:[{type:"field_number",name:"id",value:0}],output:"String",extensions:["argument_consumer"],colour:230,tooltip:"",helpUrl:""};function ZP(s){return[`args[${s.getFieldValue("id")}]`,ue.javascriptGenerator.ORDER_NONE]}const QP={type:"break_middleware",message0:"\u7EC8\u6B62\u540E\u7EED\u903B\u8F91\u6267\u884C",previousStatement:null,extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function e2(){return`return null;
`}const t2={type:"session_message",message0:"\u53D1\u9001\u6D88\u606F\u7684\u5185\u5BB9",extensions:["session_consumer"],output:"String",colour:230,tooltip:"",helpUrl:""};function s2(){return["session.content",ue.javascriptGenerator.ORDER_NONE]}const i2={type:"session_user_id",message0:"\u53D1\u9001\u6D88\u606F\u7528\u6237\u7684\u5E73\u53F0\u7528\u6237ID",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function n2(){return["session.userId",ue.javascriptGenerator.ORDER_NONE]}const r2={type:"session_bot",message0:"\u6536\u5230\u6D88\u606F\u7684\u673A\u5668\u4EBA\u5BF9\u8C61",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function o2(){return["session.bot",ue.javascriptGenerator.ORDER_NONE]}const a2={type:"session_guild_id",message0:"\u6D88\u606F\u6765\u81EA\u7684\u7FA4\u7EC4\u7F16\u53F7",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function l2(){return["session.channelId",ue.javascriptGenerator.ORDER_NONE]}const c2={type:"session_channel_id",message0:"\u6D88\u606F\u6765\u81EA\u7684\u9891\u9053\u7F16\u53F7(\u7FA4\u53F7)",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function u2(){return["session.guildId",ue.javascriptGenerator.ORDER_NONE]}const h2={type:"session_message_id",message0:"\u6D88\u606F\u7F16\u53F7",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function d2(){return["session.messageId",ue.javascriptGenerator.ORDER_NONE]}const _2={type:"session_elements",message0:"\u5F53\u524D\u6D88\u606F\u7684\u6D88\u606F\u5143\u7D20\u5217\u8868",output:"Array",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function p2(){return["session.elements",ue.javascriptGenerator.ORDER_NONE]}const g2=[JP,QP,t2,i2,c2,a2,h2,r2,_2],f2={get_argument:ZP,break_middleware:e2,session_message:s2,session_user_id:n2,session_channel_id:l2,session_guild_id:u2,session_message_id:d2,session_bot:o2,session_elements:p2},m2={type:"delete_message",message0:"\u64A4\u56DE\u6D88\u606F %1 \u673A\u5668\u4EBA\u5BF9\u8C61 %2 \u6D88\u606FID %3 \u9891\u9053ID %4",args0:[{type:"input_dummy"},{type:"input_value",name:"bot"},{type:"input_value",name:"message_id"},{type:"input_value",name:"channel_id"}],inputsInline:false,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function E2(s){let n=ue.javascriptGenerator.valueToCode(s,"bot",ue.javascriptGenerator.ORDER_ATOMIC),i=ue.javascriptGenerator.valueToCode(s,"message_id",ue.javascriptGenerator.ORDER_ATOMIC),o=ue.javascriptGenerator.valueToCode(s,"channel_id",ue.javascriptGenerator.ORDER_ATOMIC);return`await ${n}.deleteMessage(${o},${i});
`}const b2={type:"mute_user",message0:"\u7981\u8A00\u7528\u6237 %1 \u673A\u5668\u4EBA\u5BF9\u8C61 %2 \u7528\u6237ID %3 \u7FA4\u7EC4ID %4 \u7981\u8A00\u65F6\u95F4(\u6BEB\u79D2) %5",args0:[{type:"input_dummy"},{type:"input_value",name:"bot"},{type:"input_value",name:"user_id"},{type:"input_value",name:"guild_id"},{type:"input_value",name:"time"}],inputsInline:false,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function v2(s){let n=ue.javascriptGenerator.valueToCode(s,"bot",ue.javascriptGenerator.ORDER_ATOMIC),i=ue.javascriptGenerator.valueToCode(s,"user_id",ue.javascriptGenerator.ORDER_ATOMIC),o=ue.javascriptGenerator.valueToCode(s,"guild_id",ue.javascriptGenerator.ORDER_ATOMIC),l=ue.javascriptGenerator.valueToCode(s,"time",ue.javascriptGenerator.ORDER_ATOMIC);return`await ${n}.muteGuildMember(${o},${i},${l});
`}const T2=[m2,b2],S2={delete_message:E2,mute_user:v2},$2={type:"logging",message0:"\u8F93\u51FA\u4E00\u4E2A %1 \u7EA7\u522B\u7684\u65E5\u5FD7 %2",args0:[{type:"field_dropdown",name:"level",options:[["\u8C03\u8BD5","debug"],["\u63D0\u793A","info"],["\u8B66\u544A","warn"],["\u6210\u529F","success"],["\u9519\u8BEF","error"]]},{type:"input_value",name:"log"}],template:["logger_initialize"],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},y2=function(s){var n=s.getFieldValue("level"),i=ue.javascriptGenerator.valueToCode(s,"log",ue.javascriptGenerator.ORDER_ATOMIC);return`logger.${n}(${i});
`},R2=[$2],I2={logging:y2},C2={type:"middleware",message0:"\u5F53\u63A5\u53D7\u5230\u804A\u5929\u6D88\u606F %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"callback"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""};function O2(s){return`ctx.middleware(async (session,next)=>{
${ue.javascriptGenerator.statementToCode(s,"callback")}  return next();
})`}const w2={type:"on_message_event",message0:"\u5F53\u6D88\u606F %1 %2 \u8FD0\u884C %3",args0:[{type:"field_dropdown",name:"event_name",options:[["\u88AB\u5220\u9664(\u64A4\u56DE)","message-deleted"],["\u6D88\u606F\u88AB\u4FEE\u6539","message-updated"],["\u88AB\u673A\u5668\u4EBA\u53D1\u9001","send"]]},{type:"input_dummy"},{type:"input_statement",name:"listener"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""},k2={type:"on_guild_member_event",message0:"\u5F53\u7FA4\u7EC4\u6210\u5458 %1 %2 \u8FD0\u884C %3",args0:[{type:"field_dropdown",name:"event_name",options:[["\u52A0\u5165","guild-member-added"],["\u9000\u51FA/\u8E22\u51FA","guild-member-deleted"],["\u7533\u8BF7\u52A0\u5165","guild-member-request"]]},{type:"input_dummy"},{type:"input_statement",name:"listener"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""},A2={type:"on_guild_event",message0:"\u5F53\u4F60\u7684\u673A\u5668\u4EBA %1 \u7FA4\u7EC4 %2 \u8FD0\u884C %3",args0:[{type:"field_dropdown",name:"event_name",options:[["\u52A0\u5165","guild-added"],["\u9000\u51FA/\u88AB\u8E22\u51FA","guild-deleted"],["\u88AB\u9080\u8BF7\u5230\u4E00\u4E2A","guild-request"]]},{type:"input_dummy"},{type:"input_statement",name:"listener"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""};function gg(s){var n=s.getFieldValue("event_name"),i=ue.javascriptGenerator.statementToCode(s,"listener");return`ctx.on('${n}',async (session)=>{
${i}
})`}const L2={type:"plugin_apply",message0:"\u5F53\u542F\u7528\u63D2\u4EF6\u65F6 %1 \u6267\u884C %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"apply"}],inputsInline:false,colour:230,tooltip:"",helpUrl:""};function N2(s){return ue.javascriptGenerator.statementToCode(s,"apply")}const M2={type:"command",message0:"\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u6307\u4EE4 %1 %2 \u8C03\u7528\u51FD\u6570 %3",args0:[{type:"field_input",name:"name",text:"\u6307\u4EE4\u540D\u79F0"},{type:"input_dummy"},{type:"input_statement",name:"action"}],mutator:"parameter_list",extensions:["session_provider","argument_provider"],colour:230,tooltip:"",helpUrl:""};function D2(s){var p;let n=s.getFieldValue("name"),i=s.parameters??[],o=ue.javascriptGenerator.statementToCode(s,"action");console.info(s.workspace.meta);let l=((p=s.workspace.meta.commands)==null?void 0:p[n])??{},h=l.description?`,\`${l.description.replace(`
`,"\\n")}\``:"";l.description&&delete l.description;let f=l&&Object.keys(l).length>0?`,${JSON.stringify(l)}`:"";return`ctx.command('${(n+" "+i.map(c=>{const{required:_,name:m,type:E}=c;return(_?"<":"[")+m+(E!="any_parameter"?":"+E.split("_")[0]:"")+(_?">":"]")}).join(" ")).trim()}'${h}${f}).action(async ({session},...args)=>{
${o}
});
`}const x2=[C2,w2,k2,A2,L2,M2],B2={middleware:O2,command:D2,plugin_apply:N2,on_message_event:gg,on_guild_member_event:gg,on_guild_event:gg},P2={type:"time_stamp",message0:"%1 \u65F6\u95F4\u6233",args0:[{type:"field_dropdown",name:"type",options:[["13\u4F4D","13"],["11\u4F4D","11"]]}],output:null,colour:230,tooltip:"",helpUrl:""};function U2(s){return[`Math.round(new Date() ${s.getFieldValue("type")==="11"?" / 1000":""})`,ue.javascriptGenerator.ORDER_NONE]}const F2={type:"time_format",message0:"\u65E5\u671F\u65F6\u95F4\u683C\u5F0F %1 13\u4F4D\u65F6\u95F4\u6233 %2",args0:[{type:"field_input",name:"fmt",text:"yyyy-MM-dd hh:mm:ss"},{type:"input_value",name:"date"}],output:null,imports:{koishi:["Time"]},colour:230,tooltip:"",helpUrl:""};function G2(s){var n=ue.javascriptGenerator.valueToCode(s,"date",ue.javascriptGenerator.ORDER_ATOMIC),i=s.getFieldValue("fmt");return[`Time.template('${i}',new Date(${n}))`,ue.javascriptGenerator.ORDER_NONE]}const H2={type:"plugin_id",message0:"\u5F53\u524D\u63D2\u4EF6ID",output:null,colour:230,tooltip:"",template:["plugin_id"],helpUrl:""};function V2(s){return["plugin_id",ue.javascriptGenerator.ORDER_NONE]}const W2=[P2,F2,H2],z2={time_stamp:U2,time_format:G2,plugin_id:V2},j2="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIiBmaWxsPSJ3aGl0ZSI+CiAgICA8cGF0aCBkPSJNMTg0IDE2MEMxOTMuNSAxNjAgMjAyLjEgMTY1LjYgMjA1LjkgMTc0LjNMMjY5LjkgMzE4LjNDMjc1LjMgMzMwLjQgMjY5LjkgMzQ0LjUgMjU3LjcgMzQ5LjlDMjQ1LjYgMzU1LjMgMjMxLjUgMzQ5LjkgMjI2LjEgMzM3LjdMMjIxLjcgMzI4SDE0Ni4zTDE0MS45IDMzNy43QzEzNi41IDM0OS45IDEyMi40IDM1NS4zIDExMC4zIDM0OS45Qzk4LjE0IDM0NC41IDkyLjY5IDMzMC40IDk4LjA3IDMxOC4zTDE2Mi4xIDE3NC4zQzE2NS45IDE2NS42IDE3NC41IDE2MCAxODQgMTYwSDE4NHpNMTY3LjYgMjgwSDIwMC40TDE4NCAyNDMuMUwxNjcuNiAyODB6TTMwNCAxODRDMzA0IDE3MC43IDMxNC43IDE2MCAzMjggMTYwSDM4MEM0MTMuMSAxNjAgNDQwIDE4Ni45IDQ0MCAyMjBDNDQwIDIyOS4yIDQzNy45IDIzNy45IDQzNC4yIDI0NS43QzQ0Ny41IDI1Ni43IDQ1NiAyNzMuNCA0NTYgMjkyQzQ1NiAzMjUuMSA0MjkuMSAzNTIgMzk2IDM1MkgzMjhDMzE0LjcgMzUyIDMwNCAzNDEuMyAzMDQgMzI4VjE4NHpNMzUyIDIwOFYyMzJIMzgwQzM4Ni42IDIzMiAzOTIgMjI2LjYgMzkyIDIyMEMzOTIgMjEzLjQgMzg2LjYgMjA4IDM4MCAyMDhIMzUyek0zNTIgMzA0SDM5NkM0MDIuNiAzMDQgNDA4IDI5OC42IDQwOCAyOTJDNDA4IDI4NS40IDQwMi42IDI4MCAzOTYgMjgwSDM1MlYzMDR6TTAgMTI4QzAgOTIuNjUgMjguNjUgNjQgNjQgNjRINTc2QzYxMS4zIDY0IDY0MCA5Mi42NSA2NDAgMTI4VjM4NEM2NDAgNDE5LjMgNjExLjMgNDQ4IDU3NiA0NDhINjRDMjguNjUgNDQ4IDAgNDE5LjMgMCAzODRWMTI4ek02NCAzODRINTc2VjEyOEg2NFYzODR6Ii8+Cjwvc3ZnPg==",X2={type:"regular",message0:"\u6B63\u5219\u8868\u8FBE\u5F0F %1 %2",args0:[{type:"field_input",name:"regular",text:"/.*/g"},{type:"input_value",name:"str"}],output:null,colour:160,tooltip:"",helpUrl:""};function K2(s){let n=s.getFieldValue("regular"),i=ue.javascriptGenerator.valueToCode(s,"str",ue.javascriptGenerator.ORDER_ATOMIC),o=n==null?void 0:n.match("/(.*)/([gmiyusd]*)");return[`(${i}).match(new RegExp("${o[1]}", "${o[2]}"))`,ue.javascriptGenerator.ORDER_ATOMIC]}const Y2={type:"template_string",message0:"%1 \u6A21\u677F\u5B57\u7B26\u4E32",args0:[{type:"field_image",name:"edit_template",src:j2,alt:"\u7F16\u8F91\u6A21\u677F",width:25,height:25}],output:null,colour:160,init(){this.loadSlotsWithTemplate=function(){this.inputList.filter(s=>s.name.startsWith("input_")).forEach(s=>this.removeInput(s.name)),this.text_template&&this.text_template.variables.forEach(s=>{this.appendValueInput(`input_${s}`).appendField(s)})},this.getField("edit_template").setOnClickHandler(async s=>{const n=s.getSourceBlock().workspace;this.text_template=await n.topLevel.openDialog("text-template",this.text_template??{variables:[]}),console.info(this.text_template),this.loadSlotsWithTemplate()}),this.saveExtraState=function(){return{template:this.text_template}},this.loadExtraState=function(s){this.text_template=s.template,this.loadSlotsWithTemplate()}}};function q2(s){if(!s.text_template)return['""',ue.javascriptGenerator.ORDER_ATOMIC];const n=s.text_template.variables,i=n.map(l=>ue.javascriptGenerator.valueToCode(s,`input_${l}`,ue.javascriptGenerator.ORDER_ATOMIC));return[`\`${s.text_template.template.replace(/\$\{([^}]+)\}/g,(l,h)=>`\${${i[n.indexOf(h)]}}`).replaceAll(`
`,"\\n").replaceAll("`","\\`")}\``,ue.javascriptGenerator.ORDER_ATOMIC]}const J2=[Y2,X2],Z2={regular:K2,template_string:q2},Q2={type:"sleep",message0:"\u7B49\u5F85 %1 \u6BEB\u79D2",args0:[{type:"input_value",name:"milliseconds",check:["Number"]}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function eU(s){return`await new Promise(resolve => ctx.setTimeout(resolve, ${ue.javascriptGenerator.valueToCode(s,"milliseconds",ue.javascriptGenerator.ORDER_ATOMIC)}));
`}const tU=[Q2],sU={sleep:eU},iU={type:"send_session_message",message0:"\u53D1\u9001\u6D88\u606F\u7ED9\u4E8B\u4EF6\u53D1\u9001\u8005 %1",args0:[{type:"input_value",name:"content",check:["Boolean","String"]}],previousStatement:null,nextStatement:null,extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function nU(s){return`await session.send(${ue.javascriptGenerator.valueToCode(s,"content",ue.javascriptGenerator.ORDER_ATOMIC)});
`}const rU={type:"return_message",message0:"\u7EC8\u6B62\u540E\u7EED\u903B\u8F91\u5E76\u53D1\u9001\u6D88\u606F %1",args0:[{type:"input_value",name:"content",check:["Boolean","String"]}],previousStatement:null,extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function oU(s){return`return ${ue.javascriptGenerator.valueToCode(s,"content",ue.javascriptGenerator.ORDER_ATOMIC)};
`}const aU=[iU,rU],lU={send_session_message:nU,return_message:oU},cU={type:"segment_at",message0:"@ %1",args0:[{type:"input_value",name:"user",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function uU(s){return[`h('at',{ id: ${ue.javascriptGenerator.valueToCode(s,"user",ue.javascriptGenerator.ORDER_ATOMIC)} })`,ue.javascriptGenerator.ORDER_NONE]}const hU={type:"segment_image",message0:"\u56FE\u7247 %1",args0:[{type:"input_value",name:"image",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function dU(s){return[`h('image',{ url: ${ue.javascriptGenerator.valueToCode(s,"image",ue.javascriptGenerator.ORDER_ATOMIC)} })`,ue.javascriptGenerator.ORDER_NONE]}const _U={type:"segment_audio",message0:"\u8BED\u97F3 %1",args0:[{type:"input_value",name:"audio",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function pU(s){return[`h('audio',{ url: ${ue.javascriptGenerator.valueToCode(s,"audio",ue.javascriptGenerator.ORDER_ATOMIC)} })`,ue.javascriptGenerator.ORDER_NONE]}const gU={type:"segment_video",message0:"\u89C6\u9891 %1",args0:[{type:"input_value",name:"video",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function fU(s){return[`h('video',{ url: ${ue.javascriptGenerator.valueToCode(s,"video",ue.javascriptGenerator.ORDER_ATOMIC)} })`,ue.javascriptGenerator.ORDER_NONE]}const mU={type:"parse_segment_list",message0:"\u89E3\u6790\u6D88\u606F\u5143\u7D20\u5217\u8868 %1 \u5BF9\u6BCF\u4E2A\u5143\u7D20\u6309\u987A\u5E8F\u6267\u884C:",args0:[{type:"input_value",name:"segments"}],colour:230,tooltip:"",helpUrl:"",inputsInline:false,mutator:"segment_parser",previousStatement:null,nextStatement:null};function EU(s){let n=ue.javascriptGenerator.valueToCode(s,"segments",ue.javascriptGenerator.ORDER_ATOMIC),i=s.inputList.filter(h=>h.name.startsWith("branch_type_")).map(h=>h.name.substring(12)),o=Object.fromEntries(i.map(h=>[h,s.getFieldValue(`branch_type_${h}_selector`)])),l=Object.fromEntries(i.map(h=>[h,ue.javascriptGenerator.statementToCode(s,`branch_action_${h}`,ue.javascriptGenerator.ORDER_ATOMIC)]));return`for(let current_segment of ${n}){
  switch(segment.type){
    ${Object.entries(o).map(([h,f])=>`case '${f}':
      ${l[h]}
        break;`).join(`
`)}
  }
}`}const bU={type:"current_segment",message0:"\u5F53\u524D\u6307\u5411\u7684\u6D88\u606F\u5143\u7D20",output:null,colour:230,tooltip:""};function vU(s){return["current_segment",ue.javascriptGenerator.ORDER_NONE]}const TU=[cU,hU,_U,gU,mU,bU],SU={segment_at:uU,segment_image:dU,segment_audio:pU,segment_video:fU,parse_segment_list:EU,current_segment:vU},$U={type:"to_number",message0:"\u8F6C\u6362\u4E3A\u6570\u5B57 %1",args0:[{type:"input_value",name:"value"}],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function yU(s){return[`Number(${ue.javascriptGenerator.valueToCode(s,"value",ue.javascriptGenerator.ORDER_ATOMIC)})`,ue.javascriptGenerator.ORDER_ATOMIC]}const RU=[$U],IU={to_number:yU};class mh extends k.FieldDropdown{constructor(n){super(k.Field.SKIP_SETUP),this.targets=n,this.trace=Symbol("Dropdown Tracing"),this.menuGenerator_=mh.generateBindingMenu,n.forEach(i=>{this.traceReactive(i)}),n.addWatcher((i,o,l)=>{l==="add"?this.traceReactive(o):this.detachReactive(o)})}static generateBindingMenu(){return Array.from(this.targets).map(n=>[n.value,n.identifier])}traceReactive(n){n[this.trace]||(n[this.trace]=n.addWatcher(i=>{this.value_==n.identifier&&(this.value_=n.identifier,this.doValueUpdate_(n.identifier),this.forceRerender())}))}detachReactive(n){n[this.trace]&&(n.removeWatcher(n[this.trace]),this.value_==n.identifier&&(this.value_=void 0,this.forceRerender()),delete n[this.trace])}dispose(){this.targets.forEach(n=>{this.detachReactive(n)}),super.dispose()}getDisplayText_(){var n;return((n=this.menuGenerator_().find(i=>i[1]==this.value_))==null?void 0:n[0])??""}doClassValidation_(n){return n}getOptions(n){return this.menuGenerator_().length==0?[]:super.getOptions(n)}}class CU{constructor(n,i){this.value=n,this.identifier=i,this.watcher=new Set}set(n){this.value=n,this.watcher.forEach(i=>i(n))}addWatcher(n){return this.watcher.add(n),n}removeWatcher(n){this.watcher.delete(n)}}class OU extends Set{constructor(){super(),this.watcher=new Set}add(n){return this.watcher.forEach(i=>i(this,n,"add")),super.add(n)}delete(n){return this.watcher.forEach(i=>i(this,n,"remove")),super.delete(n)}addWatcher(n){this.watcher.add(n)}removeWatcher(n){this.watcher.delete(n)}}const wU={type:"type_root",message0:"\u7C7B\u578B %1",args0:[{type:"input_value",name:"type",check:"Type"}],colour:"#ce4bc9",tooltip:"",helpUrl:""},kU={type:"type_definition",message0:"\u5B9A\u4E49\u7C7B\u578B %1 %2",args0:[{type:"field_input",name:"name",text:"\u7C7B\u578B\u540D\u79F0"},{type:"input_value",name:"type",check:"Type"}],colour:"#ce4bc9",tooltip:"",helpUrl:"",init(){if(!this.workspace.typings)return;this.type_value=new CU(this.getFieldValue("name"),this.id),this.workspace.typings.add(this.type_value),this.onchange=()=>{this.type_value.set(this.getFieldValue("name"))};const s=this.dispose;this.dispose=n=>{this.workspace.typings.delete(this.type_value),s.bind(this)(n)}}},AU={type:"type_any",message0:"\u4EFB\u610F\u7C7B\u578B",output:"Type",colour:"#ce4bc9",tooltip:""},LU={type:"type_never",message0:"\u6C38\u8FDC\u4E0D\u4F1A\u51FA\u73B0\u7684\u7C7B\u578B",output:"Type",colour:"#ce4bc9",tooltip:""},NU={type:"type_string",message0:"\u5B57\u7B26\u4E32",output:"Type",colour:"#ce4bc9",tooltip:""},MU={type:"type_number",message0:"\u6570\u5B57",output:"Type",colour:"#ce4bc9",tooltip:""},DU={type:"type_boolean",message0:"\u5E03\u5C14\u503C",output:"Type",colour:"#ce4bc9",tooltip:""},xU={type:"type_array",message0:"\u7531%1\u7EC4\u6210\u7684\u6570\u7EC4",args0:[{type:"input_value",name:"type",check:"Type"}],output:"Type",colour:"#ce4bc9"},BU={type:"type_union_root",message0:"\u8054\u5408\u7C7B\u578B %1",args0:[{type:"input_statement",name:"types",check:"Type"}]},PU={type:"type_union_entity",message0:"\u9879\u76EE",previousStatement:"Type",nextStatement:"Type",colour:160},UU={type:"type_union",output:"Type",message0:"\u8054\u5408\u7C7B\u578B",args0:[],init(){this.updateShape_()},mutator:"union_mutator",colour:"#ce4bc9"},FU={type:"type_object_root",message0:"\u5BF9\u8C61 %1",args0:[{type:"input_statement",name:"properties",check:"Type"}],colour:"#ce4bc9",tooltip:"",helpUrl:""},GU={type:"type_object_entity",message0:"\u5C5E\u6027 %1",args0:[{type:"field_input",name:"name",text:"\u5C5E\u6027\u540D\u79F0"}],previousStatement:"Type",nextStatement:"Type",colour:160},HU={type:"type_object",message0:"\u5BF9\u8C61",output:"Type",colour:"#ce4bc9",tooltip:"",helpUrl:"",mutator:"object_mutator"},VU={type:"type_getter",message0:"\u7C7B\u578B",output:"Type",colour:"#ce4bc9",tooltip:"",helpUrl:"",init(){let s;this.workspace.typings&&(s=new mh(this.workspace.typings),this.inputList[0].appendField(s,"type"))}},WU=[wU,AU,LU,NU,MU,DU,xU,BU,PU,UU,kU,FU,GU,HU,VU],zU=[...tU,...J2,...x2,...g2,...aU,...TU,...FP,...T2,...R2,...W2,...qP,...RU,...WU],jU=Object.assign({},sU,Z2,B2,f2,lU,SU,GP,S2,I2,z2,IU);function XU(){fa("parameter_list"),k.Extensions.registerMutator("parameter_list",{decompose:function(s){let n=s.newBlock("parameter_list");n.initSvg(),Array.isArray(this.parameters)||(this.parameters=[]);var i=n.getInput("parameter_list").connection;return this.parameters.forEach(o=>{let l=s.newBlock(o.type);l.setFieldValue(o.name,"name"),l.setFieldValue(o.required?"TRUE":"FALSE","required"),l.initSvg(),i.connect(l.previousConnection),i=l.nextConnection}),n},compose:function(s){const n=s.getChildren();if(console.info(n),!n.length||n.length<=0){this.parameters=[];return}const i=[];let o=n[0];for(;o;){console.info(o,o.type);const l=o.getFieldValue("name"),h=o.getFieldValue("required").toLowerCase()==="true",f=o.type;i.push({name:l,required:h,type:f}),o=o.getNextBlock()}this.parameters=i},saveExtraState:function(){return{parameters:this.parameters}},loadExtraState:function(s){this.parameters=s.parameters}},void 0,["any_parameter","string_parameter","number_parameter","boolean_parameter","int_parameter"])}const KU=["session","argument","segment_item"];function YU(){KU.forEach(s=>{qU(s),JU(s)})}function qU(s){fa(s+"_consumer"),k.Extensions.register(s+"_consumer",function(){this.scope||(this.scope={}),this.scope.consumes||(this.scope.consumes=[]),this.scope.consumes.includes(s)||this.scope.consumes.push(s)})}function JU(s){fa(s+"_provider"),k.Extensions.register(s+"_provider",function(){this.scope||(this.scope={}),this.scope.provides||(this.scope.provides=[]),this.scope.provides.includes(s)||this.scope.provides.push(s)})}function ZU(){fa("union_mutator"),k.Extensions.registerMutator("union_mutator",{updateShape_:function(){this.inputList.filter(s=>s.name.startsWith("TYPE_")).filter(s=>parseInt(s.name.split("_")[1])<this.itemCount_).forEach(s=>this.removeInput(s.name));for(let s=0;s<this.itemCount_;s++)if(!this.getInput("TYPE_"+s)){const n=this.appendValueInput("TYPE_"+s);n.align=k.ALIGN_RIGHT,s==0?n.appendField("\u7C7B\u578B"):n.appendField("\u6216")}},decompose:function(s){const n=s.newBlock("type_union_root");n.initSvg();let i=n.getInput("types").connection;for(let o=0;o<this.itemCount_;o++){const l=s.newBlock("type_union_entity");l.initSvg(),i.connect(l.previousConnection),i=l.nextConnection}return n},compose:function(s){this.itemCount_=0;let n=s.getInputTargetBlock("types");for(;n;)this.itemCount_++,n=n.nextConnection&&n.nextConnection.targetBlock();this.updateShape_()},saveExtraState:function(s){return{itemCount:this.itemCount_}},loadExtraState:function(s){this.itemCount_=s.itemCount,this.updateShape_()}},void 0,["type_union_entity"]),fa("object_mutator"),k.Extensions.registerMutator("object_mutator",{updateShape_:function(){var s;(s=this.properties_)==null||s.forEach((n,i)=>{if(!this.getInput("PROPERTY_"+n)){const o=this.appendValueInput("PROPERTY_"+n);o.align=k.ALIGN_RIGHT,o.appendField(n)}}),this.inputList.filter(n=>n.name.startsWith("PROPERTY_")).filter(n=>!this.properties_.includes(n.name.split("_")[1])).forEach(n=>this.removeInput(n.name))},decompose:function(s){var o;const n=s.newBlock("type_object_root");n.initSvg();let i=n.getInput("properties").connection;return(o=this.properties_)==null||o.forEach(l=>{const h=s.newBlock("type_object_entity");h.initSvg(),h.setFieldValue(l,"name"),i.connect(h.previousConnection),i=h.nextConnection}),n},compose:function(s){const n=[];let i=s.getInputTargetBlock("properties");for(;i;)n.push(i.getFieldValue("name")),i=i.nextConnection&&i.nextConnection.targetBlock();this.properties_=n,this.updateShape_()},saveExtraState:function(s){return{properties:this.properties_}},loadExtraState:function(s){this.properties_=s.properties,this.updateShape_()}},void 0,["type_object_entity"])}function QU(){fa("segment_parser"),k.Extensions.registerMutator("segment_parser",{decompose:function(s){let n=s.newBlock("parse_segment_root");n.initSvg();let i=n.getInput("types").connection;return this.inputList.filter(l=>l.name.startsWith("branch_type_")).forEach(l=>{const h=this.getFieldValue(l.name+"_selector");let f=s.newBlock("segment_type");f.setFieldValue(h,"type"),f.initSvg(),i.connect(f.previousConnection),i=f.nextConnection}),n},compose:function(s){this.inputList.filter(l=>l.name.startsWith("branch_type_")||l.name.startsWith("branch_action_")).forEach(l=>this.removeInput(l.name));const n=s.getChildren();if(!n.length||n.length<=0)return;let i=n[0],o=0;for(;i;)this.addBlockInput(i.getFieldValue("type"),o),i=i.getNextBlock(),o++},saveExtraState:function(){const s=this.inputList.filter(n=>n.name.startsWith("branch_type_")).map(n=>this.getFieldValue(n.name+"_selector"));return console.info(s),s},loadExtraState:function(s){s==null||s.forEach((n,i)=>this.addBlockInput(n,i)),console.info(s)},addBlockInput(s,n){if(this.inputList.some(l=>l.name=="branch_type_"+n))return;const i=this.appendDummyInput("branch_type_"+n);i.appendField("\u5982\u679C\u6D88\u606F\u5143\u7D20\u662F"),i.appendField(new k.FieldDropdown([["at\u6D88\u606F","at"],["\u5F15\u7528\u56DE\u590D","quote"],["\u56FE\u7247","image"]]),"branch_type_"+n+"_selector"),this.setFieldValue(s,"branch_type_"+n+"_selector"),this.appendStatementInput("branch_action_"+n).appendField("\u5219\u8FD0\u884C")}},void 0,["segment_type"]),k.defineBlocksWithJsonArray([{type:"segment_type",message0:"\u6D88\u606F\u6BB5\u7C7B\u578B %1",args0:[{type:"field_dropdown",name:"type",options:[["at\u6D88\u606F","at"],["\u5F15\u7528\u56DE\u590D","quote"],["\u56FE\u7247","image"]]}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"parse_segment_root",message0:"\u8981\u89E3\u6790\u7684\u6D88\u606F\u6BB5\u7C7B\u578B %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"types"}],colour:230,tooltip:"",helpUrl:""}])}function fa(s){k.Extensions.isRegistered(s)&&k.Extensions.unregister(s)}function eF(){XU(),YU(),ZU(),QU()}function tF(s){if(!(s.type==="move"||s.type==="create"))return;const n=s;if(!n.workspaceId||!n.blockId)return;const i=n.getEventWorkspace_();if(!i)return;let o=i.getBlockById(n.blockId);k.Events.disableOrphans(s),Of(o)}function Of(s){if(!s)return;const n=[].concat(s.getChildren(false));if(n&&n.forEach(h=>{Of(h)}),!s||!s.scope||!s.scope.consumes)return;const i=new Map((Array.isArray(s.scope.consumes)?s.scope.consumes:[s.scope.consumes]).map(h=>[h,true]));s.setWarningText(null);let o=s;for(;o=o.getParent();){if(!o.scope||!o.scope.provides)continue;(Array.isArray(o.scope.provides)?o.scope.provides:[o.scope.provides]).forEach(f=>{i.delete(f)})}i.size&&(s.setEnabled(false),s.setWarningText("The consumer should be placed in the variable scope of the provider:"+Array.from(i.keys()).join(",")));const l=s.getNextBlock();l&&Of(l)}function sF(s){(s.type==="create"||s.type==="move"||s.type==="delete"||s.type==="change")&&this.autoSave()}k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT="\u521D\u59CB\u5316\u5168\u5C40\u53D8\u91CF";k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME="\u53D8\u91CF\u540D\u79F0";k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO="\u4E3A";k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_COLLAPSED_TEXT="\u5168\u5C40\u53D8\u91CF";k.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP="\u521B\u5EFA\u4E00\u4E2A\u5168\u5C40\u53D8\u91CF\u5E76\u8D4B\u503C";k.Msg.LANG_VARIABLES_GLOBAL_PREFIX="[\u5168\u5C40\u53D8\u91CF]";k.Msg.LANG_VARIABLES_GET_TITLE_GET="\u8BFB\u53D6\u53D8\u91CF";k.Msg.LANG_VARIABLES_GET_COLLAPSED_TEXT="\u8BBE\u7F6E\u53D8\u91CF";k.Msg.LANG_VARIABLES_GET_TOOLTIP="\u8FD4\u56DE\u53D8\u91CF\u7684\u503C";k.Msg.LANG_VARIABLES_SET_TITLE_SET="\u8BBE\u7F6E\u53D8\u91CF";k.Msg.LANG_VARIABLES_SET_TITLE_TO="\u4E3A";k.Msg.LANG_VARIABLES_SET_COLLAPSED_TEXT="\u8BBE\u7F6E";k.Msg.LANG_VARIABLES_SET_TOOLTIP="\u8BBE\u7F6E\u53D8\u91CF";k.Msg.LANG_VARIABLES_VARIABLE=" \u53D8\u91CF";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT="\u521D\u59CB\u5316\u5C40\u90E8\u53D8\u91CF";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME="\u5C40\u90E8\u53D8\u91CF1";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO="\u4E3A";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO="\u4F5C\u7528\u57DF";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_COLLAPSED_TEXT="\u5C40\u90E8\u53D8\u91CF";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP="Allows you to create variables that are only accessible in the do part of this block.";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TRANSLATED_NAME="initialize local in do";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN="in";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_COLLAPSED_TEXT="local";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP="Allows you to create variables that are only accessible in the return part of this block.";k.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TRANSLATED_NAME="initialize local in return";k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES="local names";k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP="";k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME="name";k.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE="x";k.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE="to";k.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE="procedure";k.Msg.LANG_PROCEDURES_DEFNORETURN_DO="do";k.Msg.LANG_PROCEDURES_DEFNORETURN_COLLAPSED_PREFIX="to ";k.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP="A procedure that does not return a value.";k.Msg.LANG_PROCEDURES_DOTHENRETURN_THEN_RETURN="result";k.Msg.LANG_PROCEDURES_DOTHENRETURN_DO="do";k.Msg.LANG_PROCEDURES_DOTHENRETURN_RETURN="result";k.Msg.LANG_PROCEDURES_DOTHENRETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";k.Msg.LANG_PROCEDURES_DOTHENRETURN_COLLAPSED_TEXT="do/result";k.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE="to";k.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE="procedure";k.Msg.LANG_PROCEDURES_DEFRETURN_RETURN="result";k.Msg.LANG_PROCEDURES_DEFRETURN_COLLAPSED_PREFIX="to ";k.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP="A procedure returning a result value.";k.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING=`Warning:
This procedure has
duplicate inputs.`;k.Msg.LANG_PROCEDURES_CALLNORETURN_CALL="call ";k.Msg.LANG_PROCEDURES_CALLNORETURN_PROCEDURE="procedure";k.Msg.LANG_PROCEDURES_CALLNORETURN_COLLAPSED_PREFIX="call ";k.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP="Call a procedure with no return value.";k.Msg.LANG_PROCEDURES_CALLNORETURN_TRANSLATED_NAME="call no return";k.Msg.LANG_PROCEDURES_CALLRETURN_COLLAPSED_PREFIX="call ";k.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP="Call a procedure with a return value.";k.Msg.LANG_PROCEDURES_CALLRETURN_TRANSLATED_NAME="call return";k.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE="inputs";k.Msg.LANG_PROCEDURES_MUTATORARG_TITLE="input:";k.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF="Highlight Procedure";k.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP="";k.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP="";k.Msg.LANG_CONTROLS_FOR_INPUT_WITH="count with";k.Msg.LANG_CONTROLS_FOR_INPUT_VAR="x";k.Msg.LANG_CONTROLS_FOR_INPUT_FROM="from";k.Msg.LANG_CONTROLS_FOR_INPUT_TO="to";k.Msg.LANG_CONTROLS_FOR_INPUT_DO="do";k.Msg.LANG_CONTROLS_FOR_TOOLTIP=`Count from a start number to an end number.
For each count, set the current count number to
variable '%1', and then do some statements.`;k.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM="for each";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR="number";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_START="from";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_END="to";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP="by";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO="do";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_TEXT="for number in range";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_PREFIX="for";k.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_SUFFIX=" in range";k.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP="Runs the blocks in the 'do' section for each numeric value in the range from start to end, stepping the value each time.  Use the given variable name to refer to the current value.";k.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM="for each";k.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR="item";k.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST="in list";k.Msg.LANG_CONTROLS_FOREACH_INPUT_DO="do";k.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_TEXT="for item in list";k.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_PREFIX="for ";k.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_SUFFIX=" in list";k.Msg.LANG_CONTROLS_FOREACH_TOOLTIP="Runs the blocks in the 'do'  section for each item in the list.  Use the given variable name to refer to the current list item.";k.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT="for each %1 with %2 in dictionary %3";k.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_DO="do";k.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_KEY="key";k.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_VALUE="value";k.Msg.LANG_CONTROLS_FOREACH_DICT_TITLE="for each in dictionary";k.Msg.LANG_CONTROLS_FOREACH_DICT_TOOLTIP="Runs the blocks in the 'do' section for each key-value entry in the dictionary. Use the given variable names to refer to the key/value of the current dictionary item.";k.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN="Select a valid item in the drop down.";k.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION="This block cannot be in a definition";k.Msg.HORIZONTAL_PARAMETERS="Arrange Parameters Horizontally";k.Msg.VERTICAL_PARAMETERS="Arrange Parameters Vertically";k.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO="do";k.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN="result";k.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";k.Msg["LANG_CONTROLS_DO_THEN_ RETURN_COLLAPSED_TEXT"]="do/result";k.Msg.LANG_CONTROLS_DO_THEN_RETURN_TITLE="do result";function iF(s){k.Blocks[s.type]={init:function(){var n;this.jsonInit(s),this.imports=s.imports,this.template=s.template,(n=s.args0)==null||n.forEach(i=>{if(i.type==="input_value"){if(!i.input_type)return;const o=this.getInput(i.name);o&&(o.input_type=i.input_type)}}),s.init&&s.init.apply(this)}}}function nF(s){s.forEach(iF)}function rF(){if(!Yn.blockly_vendors)return[];const s=Object.values(Yn.blockly_vendors);return s.forEach(n=>{k.defineBlocksWithJsonArray(n.blocks.map(i=>i.definition))}),console.info(s.map(n=>n.blocks).flat(10).map(n=>n.definition).map(n=>n.type).map(n=>({kind:"block",type:n}))),s.map(n=>n.blocks).flat(10).map(n=>n.definition).map(n=>n.type).map(n=>({kind:"block",type:n}))}const oF=et({__name:"variable",props:["modelValue"],emits:["update:modelValue","tag-click","tag-removed"],setup(s,{emit:n}){const i=s,o=me({get:()=>i.modelValue??[],set:E=>n("update:modelValue",E)}),l=be(""),h=o,f=be(false),u=be(),p=E=>{h.value.splice(h.value.indexOf(E),1),n("tag-removed")},c=()=>{f.value=true,ps(()=>{u.value.input.focus()})},_=()=>{l.value&&h.value.push(l.value),f.value=false,l.value=""};function m(E){n("tag-click",E)}return(E,b)=>{const T=Ze("el-tag"),y=Ze("el-button");return ie(),Se(xt,null,[(ie(true),Se(xt,null,ni(ge(h),g=>(ie(),Ye(T,{key:g,color:"orange",closable:"","disable-transitions":false,onClose:$=>p(g),onClick:$=>m(g),style:{cursor:"pointer"}},{default:We(()=>[Dt(Pt(g),1)]),_:2},1032,["onClose","onClick"]))),128)),f.value?(ie(),Ye(ge(uR),{key:0,ref_key:"InputRef",ref:u,modelValue:l.value,"onUpdate:modelValue":b[0]||(b[0]=g=>l.value=g),class:"ml-1 w-20",size:"small",onKeyup:la(_,["enter"]),onBlur:_},null,8,["modelValue","onKeyup"])):(ie(),Ye(y,{key:1,class:"button-new-tag ml-1",size:"small",onClick:c},{default:We(()=>[Dt(" + New Tag ")]),_:1}))],64)}}}),aF=et({__name:"text-template",props:["current","modelValue"],emits:["update:current","update:modelValue"],setup(s,{emit:n}){const i=s,o=me({get:()=>i.current=="text-template",set:E=>n("update:current",E?"text-template":void 0)}),l=me({get:()=>i.modelValue,set:E=>n("update:modelValue",E)}),h=be(null);function f(E,b=0){if(E.nodeType==Node.TEXT_NODE)return[E.textContent];if(E.nodeType==Node.ELEMENT_NODE){const T=E;if(T.className.includes("sp-tag"))return["${"+T.innerText+"}"];if(T.tagName=="DIV"){if(b++>=5)return;let y=[];return T.childNodes.forEach(g=>{y.push(f(g,b))}),[`
`,y.join("")]}}return[]}function u(){const E=h.value.innerHTML.replaceAll(/<!(-)+([^>]*)(-)+>/g,""),b=document.createElement("div");b.innerHTML=E;let T=[];b.childNodes.forEach(y=>{T.push(...f(y))}),l.value.template=T.join(""),c()}xs(()=>{const E=Mt(h,b=>{b!=null&&(E(),h.value.addEventListener("input",()=>{u()}))})}),Mt(o,E=>{E&&ps(()=>{console.info(l),h.value.innerHTML=(l.value.template??"").replaceAll(/\$\{([^}]+)}/g,"<span class='sp-tag' contenteditable='false'>$1</span>").split(`
`).map(b=>b.trim()).filter(b=>b.length>0).map(b=>"<div>"+b+"</div>").join("")})});let p=null;function c(){h.value&&h.value.contains(window.getSelection().focusNode)&&(p=window.getSelection().getRangeAt(0))}function _(E){const b=document.createElement("span");b.className="sp-tag",b.contentEditable="false",b.innerText=E,p.insertNode(b),u()}function m(){const E=l.value.variables;if(!h)return;h.value.querySelectorAll(".sp-tag").forEach(T=>{T.tagName=="SPAN"&&(console.info(T.innerHTML),E.includes(T.innerHTML)||T.remove())}),u()}return console.info(_),(E,b)=>{const T=Ze("el-scrollbar"),y=Ze("el-col"),g=Ze("el-row"),$=Ze("el-dialog");return ie(),Ye($,{modelValue:o.value,"onUpdate:modelValue":b[1]||(b[1]=R=>o.value=R),title:"\u7F16\u8F91\u5B57\u7B26\u4E32\u6A21\u677F"},{default:We(()=>[De(g,null,{default:We(()=>[De(y,{span:16},{default:We(()=>[De(T,{height:"200px",style:{border:"1px lightgray solid","border-radius":"5px"},class:"editor-context"},{default:We(()=>[le("div",{contenteditable:"true",style:{"min-height":"200px"},class:"editor-content",ref_key:"inputModel",ref:h,onClick:c},null,512)]),_:1})]),_:1}),De(y,{span:8},{default:We(()=>[De(oF,{modelValue:l.value.variables,"onUpdate:modelValue":b[0]||(b[0]=R=>l.value.variables=R),onTagClick:_,onTagRemoved:m},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});class _${constructor(n){this.block=n,this.cached_consuming=new Map,this.providing=[],this.consuming=[],this.consume_reload_callbacks=new Map}using(n,i){return this.consume_reload_callbacks.set(n,i),setTimeout(()=>this.addConsume(n),0),()=>{this.consume_reload_callbacks.delete(n),this.removeConsume(n)}}removeFromParent(n){n.block_state.removeChildren(this.block)}removeChildren(n){let i=[];n.block_state.cached_consuming.forEach((o,l)=>{o.forEach(h=>{this.removeCachedConsumeInternal(l,h)&&i.push(l)})}),i.forEach(o=>{var l;(l=this.block.getParent())==null||l.block_state.removeCachedConsume(o,n.id)})}removeCachedConsume(n,i){var o;this.removeCachedConsumeInternal(n,i)&&((o=this.block.getParent())==null||o.block_state.removeCachedConsume(n,i))}removeCachedConsumeInternal(n,i){var l;if(this.providing.includes(n)&&((l=this.block.workspace.getBlockById(i))==null||l.block_state.notifyConsumeReload(n)),!this.cached_consuming.has(n))return false;const o=this.cached_consuming.get(n);return o.delete(i),o.size<=0?(this.cached_consuming.delete(n),true):false}addConsume(n){this.consuming.includes(n)||(this.consuming.push(n),this.addCachedConsume(n,this.block.id))}removeConsume(n){this.consuming.includes(n)&&(this.consuming.splice(this.consuming.indexOf(n),1),this.removeCachedConsume(n,this.block.id))}addCachedConsume(n,i){var o,l;this.providing.includes(n)&&((o=this.block.workspace.getBlockById(i))==null||o.block_state.notifyConsumeReload(n)),this.cached_consuming.has(n)||this.cached_consuming.set(n,new Set),this.cached_consuming.get(n).add(i),(l=this.block.getParent())==null||l.block_state.addCachedConsume(n,i)}notifyConsumeReload(n){this.consume_reload_callbacks.has(n)&&this.consume_reload_callbacks.get(n)()}recoverCachedConsume(){this.cached_consuming.forEach((n,i)=>{n.forEach(o=>{var l;(l=this.block.getParent())==null||l.block_state.addCachedConsume(i,o)})})}}function lF(s){s.addChangeListener(n=>{if(n.type=="finished_loading"){s.getAllBlocks(false).forEach(h=>{h.block_state||(h.block_state=new _$(h))});return}if(!(n.type==="move"||n.type==="create"))return;const i=n,o=i.getEventWorkspace_().getBlockById(i.blockId);if(!o||(o.block_state||(o.block_state=new _$(o)),i.type!="move"))return;let l=i;l.oldParentId&&o.block_state.removeFromParent(o.workspace.getBlockById(l.oldParentId)),l.newParentId&&o.block_state.recoverCachedConsume()})}function wf(s,n){if(!n)return s.newBlock("type_any");switch(n.getTypeName()){case"string":return s.newBlock("type_string");case"number":return s.newBlock("type_number");case"boolean":return s.newBlock("type_boolean");case"array":const i=s.newBlock("type_array"),o=wf(s,n.getPrototype());return o.initSvg(),i.getInput("type").connection.connect(o.outputConnection),i;case"union":const l=s.newBlock("type_union"),h=n.getPrototype();l.itemCount_=h.length,l.initSvg(),l.updateShape_();for(let f=0;f<h.length;f++){const u=wf(s,h[f]);u.initSvg(),l.getInput("TYPE_"+f).connection.connect(u.outputConnection)}return l;default:return s.newBlock("type_any")}}const{dom:Bu,Svg:Pu,Coordinate:cF}=k.utils;function _0(s){s.setMovable(false),s.setEditable(false),s.setDeletable(false),s.getChildren(false).forEach(_0)}function p0(s){s.render(),s.getChildren(false).forEach(p0)}class uF extends k.Icon{constructor(){super(...arguments),this.workspaceWidth=0,this.workspaceHeight=0}drawIcon_(n){Bu.createSvgElement(Pu.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},n);const i=Bu.createSvgElement(Pu.G,{transform:"scale(0.024,0.024)translate(45,60)"},n);Bu.createSvgElement(Pu.PATH,{class:"blocklyIconSymbol",d:"M118.6 80c-11.5 0-21.4 7.9-24 19.1L57 260.3c20.5-6.2 48.3-12.3 78.7-12.3c32.3 0 61.8 6.9 82.8 13.5c10.6 3.3 19.3 6.7 25.4 9.2c3.1 1.3 5.5 2.4 7.3 3.2c.9 .4 1.6 .7 2.1 1l.6 .3 .2 .1 .1 0 0 0 0 0s0 0-6.3 12.7h0l6.3-12.7c5.8 2.9 10.4 7.3 13.5 12.7h40.6c3.1-5.3 7.7-9.8 13.5-12.7l6.3 12.7h0c-6.3-12.7-6.3-12.7-6.3-12.7l0 0 0 0 .1 0 .2-.1 .6-.3c.5-.2 1.2-.6 2.1-1c1.8-.8 4.2-1.9 7.3-3.2c6.1-2.6 14.8-5.9 25.4-9.2c21-6.6 50.4-13.5 82.8-13.5c30.4 0 58.2 6.1 78.7 12.3L481.4 99.1c-2.6-11.2-12.6-19.1-24-19.1c-3.1 0-6.2 .6-9.2 1.8L416.9 94.3c-12.3 4.9-26.3-1.1-31.2-13.4s1.1-26.3 13.4-31.2l31.3-12.5c8.6-3.4 17.7-5.2 27-5.2c33.8 0 63.1 23.3 70.8 56.2l43.9 188c1.7 7.3 2.9 14.7 3.5 22.1c.3 1.9 .5 3.8 .5 5.7v6.7V352v16c0 61.9-50.1 112-112 112H419.7c-59.4 0-108.5-46.4-111.8-105.8L306.6 352H269.4l-1.2 22.2C264.9 433.6 215.8 480 156.3 480H112C50.1 480 0 429.9 0 368V352 310.7 304c0-1.9 .2-3.8 .5-5.7c.6-7.4 1.8-14.8 3.5-22.1l43.9-188C55.5 55.3 84.8 32 118.6 32c9.2 0 18.4 1.8 27 5.2l31.3 12.5c12.3 4.9 18.3 18.9 13.4 31.2s-18.9 18.3-31.2 13.4L127.8 81.8c-2.9-1.2-6-1.8-9.2-1.8zM64 325.4V368c0 26.5 21.5 48 48 48h44.3c25.5 0 46.5-19.9 47.9-45.3l2.5-45.6c-2.3-.8-4.9-1.7-7.5-2.5c-17.2-5.4-39.9-10.5-63.6-10.5c-23.7 0-46.2 5.1-63.2 10.5c-3.1 1-5.9 1.9-8.5 2.9zM512 368V325.4c-2.6-.9-5.5-1.9-8.5-2.9c-17-5.4-39.5-10.5-63.2-10.5c-23.7 0-46.4 5.1-63.6 10.5c-2.7 .8-5.2 1.7-7.5 2.5l2.5 45.6c1.4 25.4 22.5 45.3 47.9 45.3H464c26.5 0 48-21.5 48-48z"},i)}createDisplay(){this.svgDialog=Bu.createSvgElement(Pu.SVG,{x:k.Bubble.BORDER_WIDTH,y:k.Bubble.BORDER_WIDTH});const n=this.getBlock(),i=new k.Options({disable:true,media:n.workspace.options.pathToMedia,rtl:n.RTL,horizontalLayout:false,renderer:n.workspace.options.renderer,rendererOverrides:n.workspace.options.rendererOverrides});this.display_workspace_=new k.WorkspaceSvg(i);const o=this.display_workspace_.createDom("blocklyMutatorBackground");return this.svgDialog.appendChild(o),this.svgDialog}setVisible(n){if(console.info("BP0"),n!=this.isVisible())if(n){const i=this.getBlock();console.info(this.iconXY_),this.bubble_=new k.Bubble(i.workspace,this.createDisplay(),i.pathObject.svgPath,this.iconXY_,null,null);const o=this.display_workspace_;this.bubble_.setSvgId(i.id),this.bubble_.registerMoveEvent(this.onBubbleMove.bind(this)),o.options.languageTree,o.getFlyout(),this.resizeBubble(),this.applyColour();const l=this.display_workspace_.newBlock("type_root");if(l.initSvg(),l.moveTo(new cF(10,10)),this.display_workspace_.addTopBlock(l),this.getBlock().getOutputType){const h=wf(this.display_workspace_,this.getBlock().getOutputType());h&&(h.initSvg(),l.getInput("type").connection.connect(h.outputConnection),h.render())}else{const h=this.display_workspace_.newBlock("type_any");h.initSvg(),l.getInput("type").connection.connect(h.outputConnection),h.render()}p0(l),_0(l),this.display_workspace_.scrollCenter(),this.resizeBubble()}else this.display_workspace_.getTopBlocks(false).forEach(i=>{this.display_workspace_.removeTopBlock(i)}),this.svgDialog=null,this.display_workspace_.dispose(),this.display_workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceWidth=0,this.workspaceHeight=0}resizeBubble(){if(!this.display_workspace_)return;const n=2*k.Bubble.BORDER_WIDTH,i=this.display_workspace_.getCanvas(),o=i.getBBox();let l=o.width+o.x,h=o.height+n*3;const f=this.display_workspace_.getFlyout();if(f){const p=f.getWorkspace().getMetricsManager().getScrollMetrics();h=Math.max(h,p.height+20),l+=f.getWidth()}const u=this.getBlock().RTL;u&&(l=-o.x),l+=n*3,(Math.abs(this.workspaceWidth-l)>n||Math.abs(this.workspaceHeight-h)>n)&&(this.workspaceWidth=l,this.workspaceHeight=h,this.bubble_.setBubbleSize(l+n,h+n),this.svgDialog.setAttribute("width",`${l}`),this.svgDialog.setAttribute("height",`${h}`),this.display_workspace_.setCachedParentSvgSize(l,h)),u&&i.setAttribute("transform",`translate(${this.workspaceWidth}, 0)`),this.display_workspace_.resize()}onBubbleMove(){var n;(n=this.display_workspace_)==null||n.recordDragTargets()}}class hF{constructor(n){this.block=n}}function dF(s){s.typings=new OU,Object.keys(k.Blocks).forEach(n=>{const i=k.Blocks[n].init;n.startsWith("type_")||(k.Blocks[n].init=function(){if(i.call(this),this.type_manager=new hF(this),!this.outputConnection)return;const o=new uF(this),l=this.getIcons.bind(this);this.getIcons=()=>[...l(),o]})})}const p$=Symbol("injected");function Ll(s,n){if(s[p$])return s;const i=s.init;s[p$]=true,s.init=function(...o){i.apply(this,o),n.input&&Object.entries(n.input).forEach(([l,h])=>{const f=this.getInput(l);f&&(f.input_type=h)}),n.output&&(this.getOutputType=n.output.bind(this))}}function _F(){Ll(k.Blocks.text,{output:()=>new fg}),Ll(k.Blocks.send_session_message,{input:{content:new kf([new fg,new g$("Segment")])}}),Ll(k.Blocks.segment_at,{input:{user:new kf([new fg])},output:()=>new g$("Segment")}),Ll(k.Blocks.lists_create_with,{output:function(){return new gF(mF(this.inputList.map(s=>s.name).filter(s=>s).map(s=>{var n;return(n=this.getInput(s).connection)==null?void 0:n.targetBlock()}).filter(s=>s).map(s=>{var n;return((n=s.getOutputType)==null?void 0:n.call(s))??new fF})))}}),Ll(k.Blocks.math_number,{output:()=>new pF})}class Eh{constructor(...n){this.prototype=void 0,n.length&&(this.prototype=n[0])}getPrototype(){return this.prototype}}class g0 extends Eh{canWriteTo(n){var i;return this.equalsTo(n)||((i=n.canWriteBy)==null?void 0:i.call(n,this))}equalsTo(n){return n.getTypeName()==this.getTypeName()}}class fg extends g0{getTypeName(){return"string"}}class pF extends g0{getTypeName(){return"number"}}class f0 extends Eh{}class gF extends f0{getTypeName(){return"array"}canWriteTo(n){var i;return this.equalsTo(n)||((i=n.canWriteBy)==null?void 0:i.call(n,this))}equalsTo(n){return n.getTypeName()==this.getTypeName()&&this.getPrototype().equalsTo(n.getPrototype())}}class kf extends f0{getTypeName(){return"union"}canWriteTo(n){for(const i of this.prototype)if(!i.canWriteTo(n))return false;return true}equalsTo(n){if(n.getTypeName()!=this.getTypeName())return false;const i=n.getPrototype();if(i.length!=this.prototype.length)return false;for(const o of this.prototype){let l=i.findIndex(h=>h.equalsTo(o));if(l==-1)return false;i.splice(l,1)}return true}canWriteBy(n){return this.prototype.some(i=>n.canWriteTo(i))}}class g$ extends Eh{getTypeName(){return"class"}canWriteTo(n){var i;return this.equalsTo(n)||((i=n.canWriteBy)==null?void 0:i.call(n,this))}equalsTo(n){return n.getTypeName()==this.getTypeName()&&this.prototype==n.getPrototype()}}class fF extends Eh{getTypeName(){return"any"}canWriteTo(n){return true}canWriteBy(n){return true}equalsTo(n){return n.getTypeName()==this.getTypeName()}}function mF(s){return!Array.isArray(s)||s.length<=1?s[0]:new kf(s)}class EF extends k.ConnectionChecker{constructor(n){super(),this.workspace=n}doTypeChecks(n,i){var u,p;if(!(n.type==1||i.type==1))return super.doTypeChecks(n,i);const o=n.type==1?n:i,h=(p=(u=(n.type==1?i:n).getSourceBlock()).getOutputType)==null?void 0:p.call(u),f=o.getParentInput().input_type;return!h||!f?super.doTypeChecks(n,i):super.doTypeChecks(n,i)&&h.canWriteTo(f)}}const bF={style:{height:"100%",flex:"auto","margin-bottom":"35px"}},vF={style:{width:"100%",padding:"5px",height:"25px","border-bottom":"1px solid var(--bg1)",display:"flex","flex-direction":"row-reverse"}},TF=et({__name:"blockly",props:{modelValue:Object,workspace:String},emits:["update:modelValue","update:workspace"],setup(s,{expose:n,emit:i}){const o=s,l=be(null);let h=be(null),f=be(null);tn(o,"modelValue"),k.setLocale(pP),nF(zU),eF(),_F(),Object.entries(jU).forEach(([c,_])=>{ue.javascriptGenerator[c]=_});let u=null,p={autoSave:()=>{}};return k.VerticalFlyout.prototype.getFlyoutScale=()=>1,xs(()=>{ps(()=>{u=k.inject(l.value,{toolbox:AP,media:"/static/blockly/",grid:{spacing:20,length:1,colour:"#888",snap:false},zoom:{controls:true,wheel:true,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2},plugins:{connectionChecker:EF}}),window.addEventListener("resize",()=>{k.svgResize(u)}),u.registerToolboxCategoryCallback("VENDOR_UNCATEGORIZED",rF),u.addChangeListener(tF),u.addChangeListener(sF.bind(p)),lF(u),dF(u),k.fieldRegistry.register("binding",mh),kP(u),u.topLevel={openDialog(c,_){return h.value=c,f.value=_,new Promise(m=>{const E=Mt(h,()=>{E(),m(nf(f.value))})})}}})}),n({save(){return k.svgResize(u),k.serialization.workspaces.save(u)},load(c){return k.svgResize(u),k.serialization.workspaces.load(c,u)},setAutoSaveListener(c){p.autoSave=c},updateSize(){k.svgResize(u)},getWorkspaceSvg(){return u}}),(c,_)=>(ie(),Se("div",bF,[De(aF,{modelValue:ge(f),"onUpdate:modelValue":_[0]||(_[0]=m=>ha(f)?f.value=m:f=m),current:ge(h),"onUpdate:current":_[1]||(_[1]=m=>ha(h)?h.value=m:h=m)},null,8,["modelValue","current"]),le("div",vF,[le("button",{class:"menu-button",onClick:_[2]||(_[2]=m=>c.$emit("update:workspace","meta"))},"\u7F16\u8F91\u63D2\u4EF6\u5143\u6570\u636E")]),le("div",{style:{height:"100%",flex:"auto"},ref_key:"blockly_workspace",ref:l},null,512)]))}});const SF=Jn(TF,[["__scopeId","data-v-58804736"]]);var mg={exports:{}},f$;function $F(){return f$||(f$=1,function(s,n){(function(i,o){s.exports=o()})(self,function(){return(()=>{var i={4567:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.AccessibilityManager=void 0;const c=p(9042),_=p(6114),m=p(9924),E=p(3656),b=p(844),T=p(5596),y=p(9631);class g extends b.Disposable{constructor(R,v){super(),this._terminal=R,this._renderService=v,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityTreeRoot=document.createElement("div"),this._accessibilityTreeRoot.classList.add("xterm-accessibility"),this._accessibilityTreeRoot.tabIndex=0,this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let S=0;S<this._terminal.rows;S++)this._rowElements[S]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[S]);if(this._topBoundaryFocusListener=S=>this._handleBoundaryFocus(S,0),this._bottomBoundaryFocusListener=S=>this._handleBoundaryFocus(S,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityTreeRoot.appendChild(this._rowContainer),this._renderRowsDebouncer=new m.TimeBasedDebouncer(this._renderRows.bind(this)),this._refreshRows(),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityTreeRoot.appendChild(this._liveRegion),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityTreeRoot),this.register(this._renderRowsDebouncer),this.register(this._terminal.onResize(S=>this._handleResize(S.rows))),this.register(this._terminal.onRender(S=>this._refreshRows(S.start,S.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(S=>this._handleChar(S))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(S=>this._handleTab(S))),this.register(this._terminal.onKey(S=>this._handleKey(S.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new T.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,E.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this.register((0,b.toDisposable)(()=>{(0,y.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0}))}_handleBoundaryFocus(R,v){const S=R.target,O=this._rowElements[v===0?1:this._rowElements.length-2];if(S.getAttribute("aria-posinset")===(v===0?"1":`${this._terminal.buffer.lines.length}`)||R.relatedTarget!==O)return;let w,A;if(v===0?(w=S,A=this._rowElements.pop(),this._rowContainer.removeChild(A)):(w=this._rowElements.shift(),A=S,this._rowContainer.removeChild(w)),w.removeEventListener("focus",this._topBoundaryFocusListener),A.removeEventListener("focus",this._bottomBoundaryFocusListener),v===0){const I=this._createAccessibilityTreeNode();this._rowElements.unshift(I),this._rowContainer.insertAdjacentElement("afterbegin",I)}else{const I=this._createAccessibilityTreeNode();this._rowElements.push(I),this._rowContainer.appendChild(I)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(v===0?-1:1),this._rowElements[v===0?1:this._rowElements.length-2].focus(),R.preventDefault(),R.stopImmediatePropagation()}_handleResize(R){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let v=this._rowContainer.children.length;v<this._terminal.rows;v++)this._rowElements[v]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[v]);for(;this._rowElements.length>R;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const R=document.createElement("div");return R.setAttribute("role","listitem"),R.tabIndex=-1,this._refreshRowDimensions(R),R}_handleTab(R){for(let v=0;v<R;v++)this._handleChar(" ")}_handleChar(R){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==R&&(this._charsToAnnounce+=R):this._charsToAnnounce+=R,R===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=c.tooMuchOutput)),_.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityTreeRoot.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,_.isMac&&(0,y.removeElementFromParent)(this._liveRegion)}_handleKey(R){this._clearLiveRegion(),/\p{Control}/u.test(R)||this._charsToConsume.push(R)}_refreshRows(R,v){this._renderRowsDebouncer.refresh(R,v,this._terminal.rows)}_renderRows(R,v){const S=this._terminal.buffer,O=S.lines.length.toString();for(let w=R;w<=v;w++){const A=S.translateBufferLineToString(S.ydisp+w,true),I=(S.ydisp+w+1).toString(),L=this._rowElements[w];L&&(A.length===0?L.innerText="\xA0":L.textContent=A,L.setAttribute("aria-posinset",I),L.setAttribute("aria-setsize",O))}this._announceCharacters()}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityTreeRoot.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let R=0;R<this._terminal.rows;R++)this._refreshRowDimensions(this._rowElements[R])}}_refreshRowDimensions(R){R.style.height=`${this._renderService.dimensions.css.cell.height}px`}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}}u.AccessibilityManager=g},3614:(f,u)=>{function p(E){return E.replace(/\r?\n/g,"\r")}function c(E,b){return b?"\x1B[200~"+E+"\x1B[201~":E}function _(E,b,T){E=c(E=p(E),T.decPrivateModes.bracketedPasteMode),T.triggerDataEvent(E,true),b.value=""}function m(E,b,T){const y=T.getBoundingClientRect(),g=E.clientX-y.left-10,$=E.clientY-y.top-10;b.style.width="20px",b.style.height="20px",b.style.left=`${g}px`,b.style.top=`${$}px`,b.style.zIndex="1000",b.focus()}Object.defineProperty(u,"__esModule",{value:true}),u.rightClickHandler=u.moveTextAreaUnderMouseCursor=u.paste=u.handlePasteEvent=u.copyHandler=u.bracketTextForPaste=u.prepareTextForTerminal=void 0,u.prepareTextForTerminal=p,u.bracketTextForPaste=c,u.copyHandler=function(E,b){E.clipboardData&&E.clipboardData.setData("text/plain",b.selectionText),E.preventDefault()},u.handlePasteEvent=function(E,b,T){E.stopPropagation(),E.clipboardData&&_(E.clipboardData.getData("text/plain"),b,T)},u.paste=_,u.moveTextAreaUnderMouseCursor=m,u.rightClickHandler=function(E,b,T,y,g){m(E,b,T),g&&y.rightClickSelect(E),b.value=y.selectionText,b.select()}},7239:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ColorContrastCache=void 0;const c=p(1505);u.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(_,m,E){this._css.set(_,m,E)}getCss(_,m){return this._css.get(_,m)}setColor(_,m,E){this._color.set(_,m,E)}getColor(_,m){return this._color.get(_,m)}clear(){this._color.clear(),this._css.clear()}}},9631:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.removeElementFromParent=void 0,u.removeElementFromParent=function(...p){var c;for(const _ of p)(c=_==null?void 0:_.parentElement)===null||c===void 0||c.removeChild(_)}},3656:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.addDisposableDomListener=void 0,u.addDisposableDomListener=function(p,c,_,m){p.addEventListener(c,_,m);let E=false;return{dispose:()=>{E||(E=true,p.removeEventListener(c,_,m))}}}},6465:function(f,u,p){var c=this&&this.__decorate||function(g,$,R,v){var S,O=arguments.length,w=O<3?$:v===null?v=Object.getOwnPropertyDescriptor($,R):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,$,R,v);else for(var A=g.length-1;A>=0;A--)(S=g[A])&&(w=(O<3?S(w):O>3?S($,R,w):S($,R))||w);return O>3&&w&&Object.defineProperty($,R,w),w},_=this&&this.__param||function(g,$){return function(R,v){$(R,v,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.Linkifier2=void 0;const m=p(2585),E=p(8460),b=p(844),T=p(3656);let y=class extends b.Disposable{constructor(g){super(),this._bufferService=g,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=true,this._activeLine=-1,this._onShowLinkUnderline=this.register(new E.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new E.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,b.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,b.toDisposable)(()=>{this._lastMouseEvent=void 0}))}get currentLink(){return this._currentLink}registerLinkProvider(g){return this._linkProviders.push(g),{dispose:()=>{const $=this._linkProviders.indexOf(g);$!==-1&&this._linkProviders.splice($,1)}}}attachToDom(g,$,R){this._element=g,this._mouseService=$,this._renderService=R,this.register((0,T.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=true,this._clearCurrentLink()})),this.register((0,T.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,T.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,T.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(g){if(this._lastMouseEvent=g,!this._element||!this._mouseService)return;const $=this._positionFromMouseEvent(g,this._element,this._mouseService);if(!$)return;this._isMouseOut=false;const R=g.composedPath();for(let v=0;v<R.length;v++){const S=R[v];if(S.classList.contains("xterm"))break;if(S.classList.contains("xterm-hover"))return}this._lastBufferCell&&$.x===this._lastBufferCell.x&&$.y===this._lastBufferCell.y||(this._handleHover($),this._lastBufferCell=$)}_handleHover(g){if(this._activeLine!==g.y)return this._clearCurrentLink(),void this._askForLink(g,false);this._currentLink&&this._linkAtPosition(this._currentLink.link,g)||(this._clearCurrentLink(),this._askForLink(g,true))}_askForLink(g,$){var R,v;this._activeProviderReplies&&$||((R=this._activeProviderReplies)===null||R===void 0||R.forEach(O=>{O==null||O.forEach(w=>{w.link.dispose&&w.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=g.y);let S=false;for(const[O,w]of this._linkProviders.entries())$?!((v=this._activeProviderReplies)===null||v===void 0)&&v.get(O)&&(S=this._checkLinkProviderResult(O,g,S)):w.provideLinks(g.y,A=>{var I,L;if(this._isMouseOut)return;const x=A==null?void 0:A.map(B=>({link:B}));(I=this._activeProviderReplies)===null||I===void 0||I.set(O,x),S=this._checkLinkProviderResult(O,g,S),((L=this._activeProviderReplies)===null||L===void 0?void 0:L.size)===this._linkProviders.length&&this._removeIntersectingLinks(g.y,this._activeProviderReplies)})}_removeIntersectingLinks(g,$){const R=new Set;for(let v=0;v<$.size;v++){const S=$.get(v);if(S)for(let O=0;O<S.length;O++){const w=S[O],A=w.link.range.start.y<g?0:w.link.range.start.x,I=w.link.range.end.y>g?this._bufferService.cols:w.link.range.end.x;for(let L=A;L<=I;L++){if(R.has(L)){S.splice(O--,1);break}R.add(L)}}}}_checkLinkProviderResult(g,$,R){var v;if(!this._activeProviderReplies)return R;const S=this._activeProviderReplies.get(g);let O=false;for(let w=0;w<g;w++)this._activeProviderReplies.has(w)&&!this._activeProviderReplies.get(w)||(O=true);if(!O&&S){const w=S.find(A=>this._linkAtPosition(A.link,$));w&&(R=true,this._handleNewLink(w))}if(this._activeProviderReplies.size===this._linkProviders.length&&!R)for(let w=0;w<this._activeProviderReplies.size;w++){const A=(v=this._activeProviderReplies.get(w))===null||v===void 0?void 0:v.find(I=>this._linkAtPosition(I.link,$));if(A){R=true,this._handleNewLink(A);break}}return R}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(g){if(!this._element||!this._mouseService||!this._currentLink)return;const $=this._positionFromMouseEvent(g,this._element,this._mouseService);$&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,$)&&this._currentLink.link.activate(g,this._currentLink.link.text)}_clearCurrentLink(g,$){this._element&&this._currentLink&&this._lastMouseEvent&&(!g||!$||this._currentLink.link.range.start.y>=g&&this._currentLink.link.range.end.y<=$)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,b.disposeArray)(this._linkCacheDisposables))}_handleNewLink(g){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const $=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);$&&this._linkAtPosition(g.link,$)&&(this._currentLink=g,this._currentLink.state={decorations:{underline:g.link.decorations===void 0||g.link.decorations.underline,pointerCursor:g.link.decorations===void 0||g.link.decorations.pointerCursor},isHovered:true},this._linkHover(this._element,g.link,this._lastMouseEvent),g.link.decorations={},Object.defineProperties(g.link.decorations,{pointerCursor:{get:()=>{var R,v;return(v=(R=this._currentLink)===null||R===void 0?void 0:R.state)===null||v===void 0?void 0:v.decorations.pointerCursor},set:R=>{var v,S;!((v=this._currentLink)===null||v===void 0)&&v.state&&this._currentLink.state.decorations.pointerCursor!==R&&(this._currentLink.state.decorations.pointerCursor=R,this._currentLink.state.isHovered&&((S=this._element)===null||S===void 0||S.classList.toggle("xterm-cursor-pointer",R)))}},underline:{get:()=>{var R,v;return(v=(R=this._currentLink)===null||R===void 0?void 0:R.state)===null||v===void 0?void 0:v.decorations.underline},set:R=>{var v,S,O;!((v=this._currentLink)===null||v===void 0)&&v.state&&((O=(S=this._currentLink)===null||S===void 0?void 0:S.state)===null||O===void 0?void 0:O.decorations.underline)!==R&&(this._currentLink.state.decorations.underline=R,this._currentLink.state.isHovered&&this._fireUnderlineEvent(g.link,R))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(R=>{const v=R.start===0?0:R.start+1+this._bufferService.buffer.ydisp,S=this._currentLink?this._lastMouseEvent:void 0;if(this._clearCurrentLink(v,R.end+1+this._bufferService.buffer.ydisp),S&&this._element){const O=this._positionFromMouseEvent(S,this._element,this._mouseService);O&&this._askForLink(O,false)}})))}_linkHover(g,$,R){var v;!((v=this._currentLink)===null||v===void 0)&&v.state&&(this._currentLink.state.isHovered=true,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent($,true),this._currentLink.state.decorations.pointerCursor&&g.classList.add("xterm-cursor-pointer")),$.hover&&$.hover(R,$.text)}_fireUnderlineEvent(g,$){const R=g.range,v=this._bufferService.buffer.ydisp,S=this._createLinkUnderlineEvent(R.start.x-1,R.start.y-v-1,R.end.x,R.end.y-v-1,void 0);($?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(S)}_linkLeave(g,$,R){var v;!((v=this._currentLink)===null||v===void 0)&&v.state&&(this._currentLink.state.isHovered=false,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent($,false),this._currentLink.state.decorations.pointerCursor&&g.classList.remove("xterm-cursor-pointer")),$.leave&&$.leave(R,$.text)}_linkAtPosition(g,$){const R=g.range.start.y*this._bufferService.cols+g.range.start.x,v=g.range.end.y*this._bufferService.cols+g.range.end.x,S=$.y*this._bufferService.cols+$.x;return R<=S&&S<=v}_positionFromMouseEvent(g,$,R){const v=R.getCoords(g,$,this._bufferService.cols,this._bufferService.rows);if(v)return{x:v[0],y:v[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(g,$,R,v,S){return{x1:g,y1:$,x2:R,y2:v,cols:this._bufferService.cols,fg:S}}};y=c([_(0,m.IBufferService)],y),u.Linkifier2=y},9042:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.tooMuchOutput=u.promptLabel=void 0,u.promptLabel="Terminal input",u.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(f,u,p){var c=this&&this.__decorate||function(y,g,$,R){var v,S=arguments.length,O=S<3?g:R===null?R=Object.getOwnPropertyDescriptor(g,$):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,g,$,R);else for(var w=y.length-1;w>=0;w--)(v=y[w])&&(O=(S<3?v(O):S>3?v(g,$,O):v(g,$))||O);return S>3&&O&&Object.defineProperty(g,$,O),O},_=this&&this.__param||function(y,g){return function($,R){g($,R,y)}};Object.defineProperty(u,"__esModule",{value:true}),u.OscLinkProvider=void 0;const m=p(511),E=p(2585);let b=class{constructor(y,g,$){this._bufferService=y,this._optionsService=g,this._oscLinkService=$}provideLinks(y,g){var $;const R=this._bufferService.buffer.lines.get(y-1);if(!R)return void g(void 0);const v=[],S=this._optionsService.rawOptions.linkHandler,O=new m.CellData,w=R.getTrimmedLength();let A=-1,I=-1,L=false;for(let x=0;x<w;x++)if(I!==-1||R.hasContent(x)){if(R.loadCell(x,O),O.hasExtendedAttrs()&&O.extended.urlId){if(I===-1){I=x,A=O.extended.urlId;continue}L=O.extended.urlId!==A}else I!==-1&&(L=true);if(L||I!==-1&&x===w-1){const B=($=this._oscLinkService.getLinkData(A))===null||$===void 0?void 0:$.uri;if(B){const H={start:{x:I+1,y},end:{x:x+(L||x!==w-1?0:1),y}};let F=false;if(!(S!=null&&S.allowNonHttpProtocols))try{const X=new URL(B);["http:","https:"].includes(X.protocol)||(F=true)}catch{F=true}F||v.push({text:B,range:H,activate:(X,Z)=>S?S.activate(X,Z,H):T(0,Z),hover:(X,Z)=>{var J;return(J=S==null?void 0:S.hover)===null||J===void 0?void 0:J.call(S,X,Z,H)},leave:(X,Z)=>{var J;return(J=S==null?void 0:S.leave)===null||J===void 0?void 0:J.call(S,X,Z,H)}})}L=false,O.hasExtendedAttrs()&&O.extended.urlId?(I=x,A=O.extended.urlId):(I=-1,A=-1)}}g(v)}};function T(y,g){if(confirm(`Do you want to navigate to ${g}?

WARNING: This link could potentially be dangerous`)){const $=window.open();if($){try{$.opener=null}catch{}$.location.href=g}else console.warn("Opening link blocked as opener could not be cleared")}}b=c([_(0,E.IBufferService),_(1,E.IOptionsService),_(2,E.IOscLinkService)],b),u.OscLinkProvider=b},6193:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.RenderDebouncer=void 0,u.RenderDebouncer=class{constructor(p,c){this._parentWindow=p,this._renderCallback=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(p){return this._refreshCallbacks.push(p),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(p,c,_){this._rowCount=_,p=p!==void 0?p:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,p):p,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const p=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(p,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const p of this._refreshCallbacks)p(0);this._refreshCallbacks=[]}}},5596:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ScreenDprMonitor=void 0;const c=p(844);class _ extends c.Disposable{constructor(E){super(),this._parentWindow=E,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,c.toDisposable)(()=>{this.clearListener()}))}setListener(E){this._listener&&this.clearListener(),this._listener=E,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var E;this._outerListener&&((E=this._resolutionMediaMatchList)===null||E===void 0||E.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}u.ScreenDprMonitor=_},3236:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Terminal=void 0;const c=p(2950),_=p(1680),m=p(3614),E=p(2584),b=p(5435),T=p(9312),y=p(6114),g=p(3656),$=p(9042),R=p(4567),v=p(1296),S=p(7399),O=p(8460),w=p(8437),A=p(3230),I=p(4725),L=p(428),x=p(8934),B=p(6465),H=p(5114),F=p(8969),X=p(8055),Z=p(4269),J=p(5941),D=p(3107),P=p(5744),V=p(9074),j=p(2585),re=p(3730),G=p(844),ae=p(6731),de=typeof window<"u"?window.document:null;class fe extends F.CoreTerminal{constructor(W={}){super(W),this.browser=y,this._keyDownHandled=false,this._keyDownSeen=false,this._keyPressHandled=false,this._unprocessedDeadKey=false,this._onCursorMove=this.register(new O.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new O.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new O.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new O.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new O.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new O.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new O.EventEmitter),this._onBlur=this.register(new O.EventEmitter),this._onA11yCharEmitter=this.register(new O.EventEmitter),this._onA11yTabEmitter=this.register(new O.EventEmitter),this._onWillOpen=this.register(new O.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(B.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(re.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(V.DecorationService),this._instantiationService.setService(j.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((Q,ce)=>this.refresh(Q,ce))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(Q=>this._reportWindowsOptions(Q))),this.register(this._inputHandler.onColor(Q=>this._handleColorEvent(Q))),this.register((0,O.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,O.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,O.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,O.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(Q=>this._afterResize(Q.cols,Q.rows))),this.register((0,G.toDisposable)(()=>{var Q,ce;this._customKeyEventHandler=void 0,(ce=(Q=this.element)===null||Q===void 0?void 0:Q.parentNode)===null||ce===void 0||ce.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(W){if(this._themeService)for(const Q of W){let ce,Ee="";switch(Q.index){case 256:ce="foreground",Ee="10";break;case 257:ce="background",Ee="11";break;case 258:ce="cursor",Ee="12";break;default:ce="ansi",Ee="4;"+Q.index}switch(Q.type){case 0:const Xe=X.color.toColorRGB(ce==="ansi"?this._themeService.colors.ansi[Q.index]:this._themeService.colors[ce]);this.coreService.triggerDataEvent(`${E.C0.ESC}]${Ee};${(0,J.toRgbString)(Xe)}${E.C1_ESCAPED.ST}`);break;case 1:if(ce==="ansi")this._themeService.modifyColors(Re=>Re.ansi[Q.index]=X.rgba.toColor(...Q.color));else{const Re=ce;this._themeService.modifyColors(_t=>_t[Re]=X.rgba.toColor(...Q.color))}break;case 2:this._themeService.restoreColor(Q.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:true})}_handleScreenReaderModeOptionChange(W){var Q;W?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new R.AccessibilityManager(this,this._renderService)):((Q=this._accessibilityManager)===null||Q===void 0||Q.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(W){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(E.C0.ESC+"[I"),this.updateCursorStyle(W),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var W;return(W=this.textarea)===null||W===void 0?void 0:W.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(E.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const W=this.buffer.ybase+this.buffer.y,Q=this.buffer.lines.get(W);if(!Q)return;const ce=Math.min(this.buffer.x,this.cols-1),Ee=this._renderService.dimensions.css.cell.height,Xe=Q.getWidth(ce),Re=this._renderService.dimensions.css.cell.width*Xe,_t=this.buffer.y*this._renderService.dimensions.css.cell.height,Ct=ce*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Ct+"px",this.textarea.style.top=_t+"px",this.textarea.style.width=Re+"px",this.textarea.style.height=Ee+"px",this.textarea.style.lineHeight=Ee+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,g.addDisposableDomListener)(this.element,"copy",Q=>{this.hasSelection()&&(0,m.copyHandler)(Q,this._selectionService)}));const W=Q=>(0,m.handlePasteEvent)(Q,this.textarea,this.coreService);this.register((0,g.addDisposableDomListener)(this.textarea,"paste",W)),this.register((0,g.addDisposableDomListener)(this.element,"paste",W)),y.isFirefox?this.register((0,g.addDisposableDomListener)(this.element,"mousedown",Q=>{Q.button===2&&(0,m.rightClickHandler)(Q,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,g.addDisposableDomListener)(this.element,"contextmenu",Q=>{(0,m.rightClickHandler)(Q,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),y.isLinux&&this.register((0,g.addDisposableDomListener)(this.element,"auxclick",Q=>{Q.button===1&&(0,m.moveTextAreaUnderMouseCursor)(Q,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,g.addDisposableDomListener)(this.textarea,"keyup",W=>this._keyUp(W),true)),this.register((0,g.addDisposableDomListener)(this.textarea,"keydown",W=>this._keyDown(W),true)),this.register((0,g.addDisposableDomListener)(this.textarea,"keypress",W=>this._keyPress(W),true)),this.register((0,g.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,g.addDisposableDomListener)(this.textarea,"compositionupdate",W=>this._compositionHelper.compositionupdate(W))),this.register((0,g.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,g.addDisposableDomListener)(this.textarea,"input",W=>this._inputEvent(W),true)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(W){var Q;if(!W)throw new Error("Terminal requires a parent element.");W.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=W.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),W.appendChild(this.element);const ce=de.createDocumentFragment();this._viewportElement=de.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),ce.appendChild(this._viewportElement),this._viewportScrollArea=de.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=de.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=de.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),ce.appendChild(this.screenElement),this.textarea=de.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",$.promptLabel),y.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(H.CoreBrowserService,this.textarea,(Q=this._document.defaultView)!==null&&Q!==void 0?Q:window),this._instantiationService.setService(I.ICoreBrowserService,this._coreBrowserService),this.register((0,g.addDisposableDomListener)(this.textarea,"focus",Ee=>this._handleTextAreaFocus(Ee))),this.register((0,g.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(L.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(I.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(ae.ThemeService),this._instantiationService.setService(I.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(Z.CharacterJoinerService),this._instantiationService.setService(I.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(A.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(I.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(Ee=>this._onRender.fire(Ee))),this.onResize(Ee=>this._renderService.resize(Ee.cols,Ee.rows)),this._compositionView=de.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(c.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(ce);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(x.MouseService),this._instantiationService.setService(I.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(_.Viewport,Ee=>this.scrollLines(Ee,true,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(T.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(I.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(Ee=>this.scrollLines(Ee.amount,Ee.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(Ee=>this._renderService.handleSelectionChanged(Ee.start,Ee.end,Ee.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(Ee=>{this.textarea.value=Ee,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(Ee=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,g.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(D.BufferDecorationRenderer,this.screenElement)),this.register((0,g.addDisposableDomListener)(this.element,"mousedown",Ee=>this._selectionService.handleMouseDown(Ee))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new R.AccessibilityManager(this,this._renderService)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",Ee=>this._handleScreenReaderModeOptionChange(Ee))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(P.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",Ee=>{!this._overviewRulerRenderer&&Ee&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(P.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(v.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const W=this,Q=this.element;function ce(Re){const _t=W._mouseService.getMouseReportCoords(Re,W.screenElement);if(!_t)return false;let Ct,Rt;switch(Re.overrideType||Re.type){case"mousemove":Rt=32,Re.buttons===void 0?(Ct=3,Re.button!==void 0&&(Ct=Re.button<3?Re.button:3)):Ct=1&Re.buttons?0:4&Re.buttons?1:2&Re.buttons?2:3;break;case"mouseup":Rt=0,Ct=Re.button<3?Re.button:3;break;case"mousedown":Rt=1,Ct=Re.button<3?Re.button:3;break;case"wheel":if(W.viewport.getLinesScrolled(Re)===0)return false;Rt=Re.deltaY<0?0:1,Ct=4;break;default:return false}return!(Rt===void 0||Ct===void 0||Ct>4)&&W.coreMouseService.triggerMouseEvent({col:_t.col,row:_t.row,x:_t.x,y:_t.y,button:Ct,action:Rt,ctrl:Re.ctrlKey,alt:Re.altKey,shift:Re.shiftKey})}const Ee={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Xe={mouseup:Re=>(ce(Re),Re.buttons||(this._document.removeEventListener("mouseup",Ee.mouseup),Ee.mousedrag&&this._document.removeEventListener("mousemove",Ee.mousedrag)),this.cancel(Re)),wheel:Re=>(ce(Re),this.cancel(Re,true)),mousedrag:Re=>{Re.buttons&&ce(Re)},mousemove:Re=>{Re.buttons||ce(Re)}};this.register(this.coreMouseService.onProtocolChange(Re=>{Re?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(Re)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&Re?Ee.mousemove||(Q.addEventListener("mousemove",Xe.mousemove),Ee.mousemove=Xe.mousemove):(Q.removeEventListener("mousemove",Ee.mousemove),Ee.mousemove=null),16&Re?Ee.wheel||(Q.addEventListener("wheel",Xe.wheel,{passive:false}),Ee.wheel=Xe.wheel):(Q.removeEventListener("wheel",Ee.wheel),Ee.wheel=null),2&Re?Ee.mouseup||(Ee.mouseup=Xe.mouseup):(this._document.removeEventListener("mouseup",Ee.mouseup),Ee.mouseup=null),4&Re?Ee.mousedrag||(Ee.mousedrag=Xe.mousedrag):(this._document.removeEventListener("mousemove",Ee.mousedrag),Ee.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,g.addDisposableDomListener)(Q,"mousedown",Re=>{if(Re.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(Re))return ce(Re),Ee.mouseup&&this._document.addEventListener("mouseup",Ee.mouseup),Ee.mousedrag&&this._document.addEventListener("mousemove",Ee.mousedrag),this.cancel(Re)})),this.register((0,g.addDisposableDomListener)(Q,"wheel",Re=>{if(!Ee.wheel){if(!this.buffer.hasScrollback){const _t=this.viewport.getLinesScrolled(Re);if(_t===0)return;const Ct=E.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(Re.deltaY<0?"A":"B");let Rt="";for(let ct=0;ct<Math.abs(_t);ct++)Rt+=Ct;return this.coreService.triggerDataEvent(Rt,true),this.cancel(Re,true)}return this.viewport.handleWheel(Re)?this.cancel(Re):void 0}},{passive:false})),this.register((0,g.addDisposableDomListener)(Q,"touchstart",Re=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(Re),this.cancel(Re)},{passive:true})),this.register((0,g.addDisposableDomListener)(Q,"touchmove",Re=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(Re)?void 0:this.cancel(Re)},{passive:false}))}refresh(W,Q){var ce;(ce=this._renderService)===null||ce===void 0||ce.refreshRows(W,Q)}updateCursorStyle(W){var Q;!((Q=this._selectionService)===null||Q===void 0)&&Q.shouldColumnSelect(W)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=true,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(W,Q,ce=0){super.scrollLines(W,Q,ce),this.refresh(0,this.rows-1)}paste(W){(0,m.paste)(W,this.textarea,this.coreService)}attachCustomKeyEventHandler(W){this._customKeyEventHandler=W}registerLinkProvider(W){return this.linkifier2.registerLinkProvider(W)}registerCharacterJoiner(W){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const Q=this._characterJoinerService.register(W);return this.refresh(0,this.rows-1),Q}deregisterCharacterJoiner(W){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(W)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(W){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+W)}registerDecoration(W){return this._decorationService.registerDecoration(W)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(W,Q,ce){this._selectionService.setSelection(W,Q,ce)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var W;(W=this._selectionService)===null||W===void 0||W.clearSelection()}selectAll(){var W;(W=this._selectionService)===null||W===void 0||W.selectAll()}selectLines(W,Q){var ce;(ce=this._selectionService)===null||ce===void 0||ce.selectLines(W,Q)}_keyDown(W){if(this._keyDownHandled=false,this._keyDownSeen=true,this._customKeyEventHandler&&this._customKeyEventHandler(W)===false)return false;const Q=this.browser.isMac&&this.options.macOptionIsMeta&&W.altKey;if(!Q&&!this._compositionHelper.keydown(W))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),false;Q||W.key!=="Dead"&&W.key!=="AltGraph"||(this._unprocessedDeadKey=true);const ce=(0,S.evaluateKeyboardEvent)(W,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(W),ce.type===3||ce.type===2){const Ee=this.rows-1;return this.scrollLines(ce.type===2?-Ee:Ee),this.cancel(W,true)}return ce.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,W)||(ce.cancel&&this.cancel(W,true),!ce.key||!!(W.key&&!W.ctrlKey&&!W.altKey&&!W.metaKey&&W.key.length===1&&W.key.charCodeAt(0)>=65&&W.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=false,true):(ce.key!==E.C0.ETX&&ce.key!==E.C0.CR||(this.textarea.value=""),this._onKey.fire({key:ce.key,domEvent:W}),this._showCursor(),this.coreService.triggerDataEvent(ce.key,true),!this.optionsService.rawOptions.screenReaderMode||W.altKey||W.ctrlKey?this.cancel(W,true):void(this._keyDownHandled=true))))}_isThirdLevelShift(W,Q){const ce=W.isMac&&!this.options.macOptionIsMeta&&Q.altKey&&!Q.ctrlKey&&!Q.metaKey||W.isWindows&&Q.altKey&&Q.ctrlKey&&!Q.metaKey||W.isWindows&&Q.getModifierState("AltGraph");return Q.type==="keypress"?ce:ce&&(!Q.keyCode||Q.keyCode>47)}_keyUp(W){this._keyDownSeen=false,this._customKeyEventHandler&&this._customKeyEventHandler(W)===false||(function(Q){return Q.keyCode===16||Q.keyCode===17||Q.keyCode===18}(W)||this.focus(),this.updateCursorStyle(W),this._keyPressHandled=false)}_keyPress(W){let Q;if(this._keyPressHandled=false,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(W)===false)return false;if(this.cancel(W),W.charCode)Q=W.charCode;else if(W.which===null||W.which===void 0)Q=W.keyCode;else{if(W.which===0||W.charCode===0)return false;Q=W.which}return!(!Q||(W.altKey||W.ctrlKey||W.metaKey)&&!this._isThirdLevelShift(this.browser,W)||(Q=String.fromCharCode(Q),this._onKey.fire({key:Q,domEvent:W}),this._showCursor(),this.coreService.triggerDataEvent(Q,true),this._keyPressHandled=true,this._unprocessedDeadKey=false,0))}_inputEvent(W){if(W.data&&W.inputType==="insertText"&&(!W.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return false;this._unprocessedDeadKey=false;const Q=W.data;return this.coreService.triggerDataEvent(Q,true),this.cancel(W),true}return false}resize(W,Q){W!==this.cols||Q!==this.rows?super.resize(W,Q):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(W,Q){var ce,Ee;(ce=this._charSizeService)===null||ce===void 0||ce.measure(),(Ee=this.viewport)===null||Ee===void 0||Ee.syncScrollArea(true)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let W=1;W<this.rows;W++)this.buffer.lines.push(this.buffer.getBlankLine(w.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var W,Q;this.options.rows=this.rows,this.options.cols=this.cols;const ce=this._customKeyEventHandler;this._setup(),super.reset(),(W=this._selectionService)===null||W===void 0||W.reset(),this._decorationService.reset(),this._customKeyEventHandler=ce,this.refresh(0,this.rows-1),(Q=this.viewport)===null||Q===void 0||Q.syncScrollArea()}clearTextureAtlas(){var W;(W=this._renderService)===null||W===void 0||W.clearTextureAtlas()}_reportFocus(){var W;!((W=this.element)===null||W===void 0)&&W.classList.contains("focus")?this.coreService.triggerDataEvent(E.C0.ESC+"[I"):this.coreService.triggerDataEvent(E.C0.ESC+"[O")}_reportWindowsOptions(W){if(this._renderService)switch(W){case b.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const Q=this._renderService.dimensions.css.canvas.width.toFixed(0),ce=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${E.C0.ESC}[4;${ce};${Q}t`);break;case b.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const Ee=this._renderService.dimensions.css.cell.width.toFixed(0),Xe=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${E.C0.ESC}[6;${Xe};${Ee}t`)}}cancel(W,Q){if(this.options.cancelEvents||Q)return W.preventDefault(),W.stopPropagation(),false}}u.Terminal=fe},9924:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.TimeBasedDebouncer=void 0,u.TimeBasedDebouncer=class{constructor(p,c=1e3){this._renderCallback=p,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=false}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(p,c,_){this._rowCount=_,p=p!==void 0?p:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,p):p,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;const m=Date.now();if(m-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=m,this._innerRefresh();else if(!this._additionalRefreshRequested){const E=m-this._lastRefreshMs,b=this._debounceThresholdMS-E;this._additionalRefreshRequested=true,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=false,this._refreshTimeoutID=void 0},b)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const p=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(p,c)}}},1680:function(f,u,p){var c=this&&this.__decorate||function(g,$,R,v){var S,O=arguments.length,w=O<3?$:v===null?v=Object.getOwnPropertyDescriptor($,R):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,$,R,v);else for(var A=g.length-1;A>=0;A--)(S=g[A])&&(w=(O<3?S(w):O>3?S($,R,w):S($,R))||w);return O>3&&w&&Object.defineProperty($,R,w),w},_=this&&this.__param||function(g,$){return function(R,v){$(R,v,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.Viewport=void 0;const m=p(844),E=p(3656),b=p(4725),T=p(2585);let y=class extends m.Disposable{constructor(g,$,R,v,S,O,w,A,I){super(),this._scrollLines=g,this._viewportElement=$,this._scrollArea=R,this._bufferService=v,this._optionsService=S,this._charSizeService=O,this._renderService=w,this._coreBrowserService=A,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=false,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,E.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(L=>this._activeBuffer=L.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(L=>this._renderDimensions=L)),this._handleThemeChange(I.colors),this.register(I.onChangeColors(L=>this._handleThemeChange(L))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(g){this._viewportElement.style.backgroundColor=g.background.css}_refresh(g){if(g)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const $=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==$&&(this._lastRecordedBufferHeight=$,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const g=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==g&&(this._ignoreNextScrollEvent=true,this._viewportElement.scrollTop=g),this._refreshAnimationFrame=null}syncScrollArea(g=false){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(g);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(g)}_handleScroll(g){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=false,void this._scrollLines(0);const $=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines($)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const g=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(g*(this._smoothScrollState.target-this._smoothScrollState.origin)),g<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(g,$){const R=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!($<0&&this._viewportElement.scrollTop!==0||$>0&&R<this._lastRecordedBufferHeight)||(g.cancelable&&g.preventDefault(),false)}handleWheel(g){const $=this._getPixelsScrolled(g);return $!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+$:this._smoothScrollState.target+=$,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=$,this._bubbleScroll(g,$))}_getPixelsScrolled(g){if(g.deltaY===0||g.shiftKey)return 0;let $=this._applyScrollModifier(g.deltaY,g);return g.deltaMode===WheelEvent.DOM_DELTA_LINE?$*=this._currentRowHeight:g.deltaMode===WheelEvent.DOM_DELTA_PAGE&&($*=this._currentRowHeight*this._bufferService.rows),$}getLinesScrolled(g){if(g.deltaY===0||g.shiftKey)return 0;let $=this._applyScrollModifier(g.deltaY,g);return g.deltaMode===WheelEvent.DOM_DELTA_PIXEL?($/=this._currentRowHeight+0,this._wheelPartialScroll+=$,$=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):g.deltaMode===WheelEvent.DOM_DELTA_PAGE&&($*=this._bufferService.rows),$}_applyScrollModifier(g,$){const R=this._optionsService.rawOptions.fastScrollModifier;return R==="alt"&&$.altKey||R==="ctrl"&&$.ctrlKey||R==="shift"&&$.shiftKey?g*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:g*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(g){this._lastTouchY=g.touches[0].pageY}handleTouchMove(g){const $=this._lastTouchY-g.touches[0].pageY;return this._lastTouchY=g.touches[0].pageY,$!==0&&(this._viewportElement.scrollTop+=$,this._bubbleScroll(g,$))}};y=c([_(3,T.IBufferService),_(4,T.IOptionsService),_(5,b.ICharSizeService),_(6,b.IRenderService),_(7,b.ICoreBrowserService),_(8,b.IThemeService)],y),u.Viewport=y},3107:function(f,u,p){var c=this&&this.__decorate||function(g,$,R,v){var S,O=arguments.length,w=O<3?$:v===null?v=Object.getOwnPropertyDescriptor($,R):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,$,R,v);else for(var A=g.length-1;A>=0;A--)(S=g[A])&&(w=(O<3?S(w):O>3?S($,R,w):S($,R))||w);return O>3&&w&&Object.defineProperty($,R,w),w},_=this&&this.__param||function(g,$){return function(R,v){$(R,v,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.BufferDecorationRenderer=void 0;const m=p(3656),E=p(4725),b=p(844),T=p(2585);let y=class extends b.Disposable{constructor(g,$,R,v){super(),this._screenElement=g,this._bufferService=$,this._decorationService=R,this._renderService=v,this._decorationElements=new Map,this._altBufferIsActive=false,this._dimensionsChanged=false,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=true,this._queueRefresh()})),this.register((0,m.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(S=>this._removeDecoration(S))),this.register((0,b.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const g of this._decorationService.decorations)this._renderDecoration(g);this._dimensionsChanged=false}_renderDecoration(g){this._refreshStyle(g),this._dimensionsChanged&&this._refreshXPosition(g)}_createElement(g){var $;const R=document.createElement("div");R.classList.add("xterm-decoration"),R.style.width=`${Math.round((g.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,R.style.height=(g.options.height||1)*this._renderService.dimensions.css.cell.height+"px",R.style.top=(g.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",R.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const v=($=g.options.x)!==null&&$!==void 0?$:0;return v&&v>this._bufferService.cols&&(R.style.display="none"),this._refreshXPosition(g,R),R}_refreshStyle(g){const $=g.marker.line-this._bufferService.buffers.active.ydisp;if($<0||$>=this._bufferService.rows)g.element&&(g.element.style.display="none",g.onRenderEmitter.fire(g.element));else{let R=this._decorationElements.get(g);R||(R=this._createElement(g),g.element=R,this._decorationElements.set(g,R),this._container.appendChild(R)),R.style.top=$*this._renderService.dimensions.css.cell.height+"px",R.style.display=this._altBufferIsActive?"none":"block",g.onRenderEmitter.fire(R)}}_refreshXPosition(g,$=g.element){var R;if(!$)return;const v=(R=g.options.x)!==null&&R!==void 0?R:0;(g.options.anchor||"left")==="right"?$.style.right=v?v*this._renderService.dimensions.css.cell.width+"px":"":$.style.left=v?v*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(g){var $;($=this._decorationElements.get(g))===null||$===void 0||$.remove(),this._decorationElements.delete(g),g.dispose()}};y=c([_(1,T.IBufferService),_(2,T.IDecorationService),_(3,E.IRenderService)],y),u.BufferDecorationRenderer=y},5871:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ColorZoneStore=void 0,u.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(p){if(p.options.overviewRulerOptions){for(const c of this._zones)if(c.color===p.options.overviewRulerOptions.color&&c.position===p.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,p.marker.line))return;if(this._lineAdjacentToZone(c,p.marker.line,p.options.overviewRulerOptions.position))return void this._addLineToZone(c,p.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=p.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=p.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=p.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=p.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:p.options.overviewRulerOptions.color,position:p.options.overviewRulerOptions.position,startBufferLine:p.marker.line,endBufferLine:p.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(p){this._linePadding=p}_lineIntersectsZone(p,c){return c>=p.startBufferLine&&c<=p.endBufferLine}_lineAdjacentToZone(p,c,_){return c>=p.startBufferLine-this._linePadding[_||"full"]&&c<=p.endBufferLine+this._linePadding[_||"full"]}_addLineToZone(p,c){p.startBufferLine=Math.min(p.startBufferLine,c),p.endBufferLine=Math.max(p.endBufferLine,c)}}},5744:function(f,u,p){var c=this&&this.__decorate||function(S,O,w,A){var I,L=arguments.length,x=L<3?O:A===null?A=Object.getOwnPropertyDescriptor(O,w):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,O,w,A);else for(var B=S.length-1;B>=0;B--)(I=S[B])&&(x=(L<3?I(x):L>3?I(O,w,x):I(O,w))||x);return L>3&&x&&Object.defineProperty(O,w,x),x},_=this&&this.__param||function(S,O){return function(w,A){O(w,A,S)}};Object.defineProperty(u,"__esModule",{value:true}),u.OverviewRulerRenderer=void 0;const m=p(5871),E=p(3656),b=p(4725),T=p(844),y=p(2585),g={full:0,left:0,center:0,right:0},$={full:0,left:0,center:0,right:0},R={full:0,left:0,center:0,right:0};let v=class extends T.Disposable{constructor(S,O,w,A,I,L,x){var B;super(),this._viewportElement=S,this._screenElement=O,this._bufferService=w,this._decorationService=A,this._renderService=I,this._optionsService=L,this._coreBrowseService=x,this._colorZoneStore=new m.ColorZoneStore,this._shouldUpdateDimensions=true,this._shouldUpdateAnchor=true,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(B=this._viewportElement.parentElement)===null||B===void 0||B.insertBefore(this._canvas,this._viewportElement);const H=this._canvas.getContext("2d");if(!H)throw new Error("Ctx cannot be null");this._ctx=H,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,T.toDisposable)(()=>{var F;(F=this._canvas)===null||F===void 0||F.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,true))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,true)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(true),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(true))),this.register((0,E.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(true))),this._queueRefresh(true)}_refreshDrawConstants(){const S=Math.floor(this._canvas.width/3),O=Math.ceil(this._canvas.width/3);$.full=this._canvas.width,$.left=S,$.center=O,$.right=S,this._refreshDrawHeightConstants(),R.full=0,R.left=0,R.center=$.left,R.right=$.left+$.center}_refreshDrawHeightConstants(){g.full=Math.round(2*this._coreBrowseService.dpr);const S=this._canvas.height/this._bufferService.buffer.lines.length,O=Math.round(Math.max(Math.min(S,12),6)*this._coreBrowseService.dpr);g.left=O,g.center=O,g.right=O}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const O of this._decorationService.decorations)this._colorZoneStore.addDecoration(O);this._ctx.lineWidth=1;const S=this._colorZoneStore.zones;for(const O of S)O.position!=="full"&&this._renderColorZone(O);for(const O of S)O.position==="full"&&this._renderColorZone(O);this._shouldUpdateDimensions=false,this._shouldUpdateAnchor=false}_renderColorZone(S){this._ctx.fillStyle=S.color,this._ctx.fillRect(R[S.position||"full"],Math.round((this._canvas.height-1)*(S.startBufferLine/this._bufferService.buffers.active.lines.length)-g[S.position||"full"]/2),$[S.position||"full"],Math.round((this._canvas.height-1)*((S.endBufferLine-S.startBufferLine)/this._bufferService.buffers.active.lines.length)+g[S.position||"full"]))}_queueRefresh(S,O){this._shouldUpdateDimensions=S||this._shouldUpdateDimensions,this._shouldUpdateAnchor=O||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};v=c([_(2,y.IBufferService),_(3,y.IDecorationService),_(4,b.IRenderService),_(5,y.IOptionsService),_(6,b.ICoreBrowserService)],v),u.OverviewRulerRenderer=v},2950:function(f,u,p){var c=this&&this.__decorate||function(y,g,$,R){var v,S=arguments.length,O=S<3?g:R===null?R=Object.getOwnPropertyDescriptor(g,$):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,g,$,R);else for(var w=y.length-1;w>=0;w--)(v=y[w])&&(O=(S<3?v(O):S>3?v(g,$,O):v(g,$))||O);return S>3&&O&&Object.defineProperty(g,$,O),O},_=this&&this.__param||function(y,g){return function($,R){g($,R,y)}};Object.defineProperty(u,"__esModule",{value:true}),u.CompositionHelper=void 0;const m=p(4725),E=p(2585),b=p(2584);let T=class{constructor(y,g,$,R,v,S){this._textarea=y,this._compositionView=g,this._bufferService=$,this._optionsService=R,this._coreService=v,this._renderService=S,this._isComposing=false,this._isSendingComposition=false,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=true,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(y){this._compositionView.textContent=y.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(true)}keydown(y){if(this._isComposing||this._isSendingComposition){if(y.keyCode===229||y.keyCode===16||y.keyCode===17||y.keyCode===18)return false;this._finalizeComposition(false)}return y.keyCode!==229||(this._handleAnyTextareaChanges(),false)}_finalizeComposition(y){if(this._compositionView.classList.remove("active"),this._isComposing=false,y){const g={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=true,setTimeout(()=>{if(this._isSendingComposition){let $;this._isSendingComposition=false,g.start+=this._dataAlreadySent.length,$=this._isComposing?this._textarea.value.substring(g.start,g.end):this._textarea.value.substring(g.start),$.length>0&&this._coreService.triggerDataEvent($,true)}},0)}else{this._isSendingComposition=false;const g=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(g,true)}}_handleAnyTextareaChanges(){const y=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const g=this._textarea.value,$=g.replace(y,"");this._dataAlreadySent=$,g.length>y.length?this._coreService.triggerDataEvent($,true):g.length<y.length?this._coreService.triggerDataEvent(`${b.C0.DEL}`,true):g.length===y.length&&g!==y&&this._coreService.triggerDataEvent(g,true)}},0)}updateCompositionElements(y){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const g=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),$=this._renderService.dimensions.css.cell.height,R=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,v=g*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=v+"px",this._compositionView.style.top=R+"px",this._compositionView.style.height=$+"px",this._compositionView.style.lineHeight=$+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const S=this._compositionView.getBoundingClientRect();this._textarea.style.left=v+"px",this._textarea.style.top=R+"px",this._textarea.style.width=Math.max(S.width,1)+"px",this._textarea.style.height=Math.max(S.height,1)+"px",this._textarea.style.lineHeight=S.height+"px"}y||setTimeout(()=>this.updateCompositionElements(true),0)}}};T=c([_(2,E.IBufferService),_(3,E.IOptionsService),_(4,E.ICoreService),_(5,m.IRenderService)],T),u.CompositionHelper=T},9806:(f,u)=>{function p(c,_,m){const E=m.getBoundingClientRect(),b=c.getComputedStyle(m),T=parseInt(b.getPropertyValue("padding-left")),y=parseInt(b.getPropertyValue("padding-top"));return[_.clientX-E.left-T,_.clientY-E.top-y]}Object.defineProperty(u,"__esModule",{value:true}),u.getCoords=u.getCoordsRelativeToElement=void 0,u.getCoordsRelativeToElement=p,u.getCoords=function(c,_,m,E,b,T,y,g,$){if(!T)return;const R=p(c,_,m);return R?(R[0]=Math.ceil((R[0]+($?y/2:0))/y),R[1]=Math.ceil(R[1]/g),R[0]=Math.min(Math.max(R[0],1),E+($?1:0)),R[1]=Math.min(Math.max(R[1],1),b),R):void 0}},9504:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.moveToCellSequence=void 0;const c=p(2584);function _(g,$,R,v){const S=g-m(g,R),O=$-m($,R),w=Math.abs(S-O)-function(A,I,L){let x=0;const B=A-m(A,L),H=I-m(I,L);for(let F=0;F<Math.abs(B-H);F++){const X=E(A,I)==="A"?-1:1,Z=L.buffer.lines.get(B+X*F);Z!=null&&Z.isWrapped&&x++}return x}(g,$,R);return y(w,T(E(g,$),v))}function m(g,$){let R=0,v=$.buffer.lines.get(g),S=v==null?void 0:v.isWrapped;for(;S&&g>=0&&g<$.rows;)R++,v=$.buffer.lines.get(--g),S=v==null?void 0:v.isWrapped;return R}function E(g,$){return g>$?"A":"B"}function b(g,$,R,v,S,O){let w=g,A=$,I="";for(;w!==R||A!==v;)w+=S?1:-1,S&&w>O.cols-1?(I+=O.buffer.translateBufferLineToString(A,false,g,w),w=0,g=0,A++):!S&&w<0&&(I+=O.buffer.translateBufferLineToString(A,false,0,g+1),w=O.cols-1,g=w,A--);return I+O.buffer.translateBufferLineToString(A,false,g,w)}function T(g,$){const R=$?"O":"[";return c.C0.ESC+R+g}function y(g,$){g=Math.floor(g);let R="";for(let v=0;v<g;v++)R+=$;return R}u.moveToCellSequence=function(g,$,R,v){const S=R.buffer.x,O=R.buffer.y;if(!R.buffer.hasScrollback)return function(I,L,x,B,H,F){return _(L,B,H,F).length===0?"":y(b(I,L,I,L-m(L,H),false,H).length,T("D",F))}(S,O,0,$,R,v)+_(O,$,R,v)+function(I,L,x,B,H,F){let X;X=_(L,B,H,F).length>0?B-m(B,H):L;const Z=B,J=function(D,P,V,j,re,G){let ae;return ae=_(V,j,re,G).length>0?j-m(j,re):P,D<V&&ae<=j||D>=V&&ae<j?"C":"D"}(I,L,x,B,H,F);return y(b(I,X,x,Z,J==="C",H).length,T(J,F))}(S,O,g,$,R,v);let w;if(O===$)return w=S>g?"D":"C",y(Math.abs(S-g),T(w,v));w=O>$?"D":"C";const A=Math.abs(O-$);return y(function(I,L){return L.cols-I}(O>$?g:S,R)+(A-1)*R.cols+1+((O>$?S:g)-1),T(w,v))}},1296:function(f,u,p){var c=this&&this.__decorate||function(I,L,x,B){var H,F=arguments.length,X=F<3?L:B===null?B=Object.getOwnPropertyDescriptor(L,x):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(I,L,x,B);else for(var Z=I.length-1;Z>=0;Z--)(H=I[Z])&&(X=(F<3?H(X):F>3?H(L,x,X):H(L,x))||X);return F>3&&X&&Object.defineProperty(L,x,X),X},_=this&&this.__param||function(I,L){return function(x,B){L(x,B,I)}};Object.defineProperty(u,"__esModule",{value:true}),u.DomRenderer=void 0;const m=p(9631),E=p(3787),b=p(2223),T=p(6171),y=p(4725),g=p(8055),$=p(8460),R=p(844),v=p(2585),S="xterm-dom-renderer-owner-",O="xterm-focus";let w=1,A=class extends R.Disposable{constructor(I,L,x,B,H,F,X,Z,J,D){super(),this._element=I,this._screenElement=L,this._viewportElement=x,this._linkifier2=B,this._charSizeService=F,this._optionsService=X,this._bufferService=Z,this._coreBrowserService=J,this._terminalClass=w++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new $.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,T.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(D.onChangeColors(P=>this._injectCss(P))),this._injectCss(D.colors),this._rowFactory=H.createInstance(E.DomRendererRowFactory,document),this._element.classList.add(S+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(P=>this._handleLinkHover(P))),this.register(this._linkifier2.onHideLinkUnderline(P=>this._handleLinkLeave(P))),this.register((0,R.toDisposable)(()=>{this._element.classList.remove(S+this._terminalClass),(0,m.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement)}))}_updateDimensions(){const I=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*I,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*I),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/I),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/I),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const x of this._rowElements)x.style.width=`${this.dimensions.css.canvas.width}px`,x.style.height=`${this.dimensions.css.cell.height}px`,x.style.lineHeight=`${this.dimensions.css.cell.height}px`,x.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const L=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=L,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(I){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let L=`${this._terminalSelector} .xterm-rows { color: ${I.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;L+=`${this._terminalSelector} span:not(.${E.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${E.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${E.ITALIC_CLASS} { font-style: italic;}`,L+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",L+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${I.cursor.css};  color: ${I.cursorAccent.css}; } 50% {  background-color: ${I.cursorAccent.css};  color: ${I.cursor.css}; }}`,L+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${E.CURSOR_CLASS}.${E.CURSOR_STYLE_BLOCK_CLASS} { outline: 1px solid ${I.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${E.CURSOR_CLASS}.${E.CURSOR_BLINK_CLASS}:not(.${E.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${E.CURSOR_CLASS}.${E.CURSOR_BLINK_CLASS}.${E.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${E.CURSOR_CLASS}.${E.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${I.cursor.css}; color: ${I.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${E.CURSOR_CLASS}.${E.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${I.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${E.CURSOR_CLASS}.${E.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${I.cursor.css} inset;}`,L+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${I.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${I.selectionInactiveBackgroundOpaque.css};}`;for(const[x,B]of I.ansi.entries())L+=`${this._terminalSelector} .xterm-fg-${x} { color: ${B.css}; }${this._terminalSelector} .xterm-bg-${x} { background-color: ${B.css}; }`;L+=`${this._terminalSelector} .xterm-fg-${b.INVERTED_DEFAULT_COLOR} { color: ${g.color.opaque(I.background).css}; }${this._terminalSelector} .xterm-bg-${b.INVERTED_DEFAULT_COLOR} { background-color: ${I.foreground.css}; }`,this._themeStyleElement.textContent=L}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(I,L){for(let x=this._rowElements.length;x<=L;x++){const B=document.createElement("div");this._rowContainer.appendChild(B),this._rowElements.push(B)}for(;this._rowElements.length>L;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(I,L){this._refreshRowElements(I,L),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(O)}handleFocus(){this._rowContainer.classList.add(O)}handleSelectionChanged(I,L,x){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(I,L,x),this.renderRows(0,this._bufferService.rows-1),!I||!L)return;const B=I[1]-this._bufferService.buffer.ydisp,H=L[1]-this._bufferService.buffer.ydisp,F=Math.max(B,0),X=Math.min(H,this._bufferService.rows-1);if(F>=this._bufferService.rows||X<0)return;const Z=document.createDocumentFragment();if(x){const J=I[0]>L[0];Z.appendChild(this._createSelectionElement(F,J?L[0]:I[0],J?I[0]:L[0],X-F+1))}else{const J=B===F?I[0]:0,D=F===H?L[0]:this._bufferService.cols;Z.appendChild(this._createSelectionElement(F,J,D));const P=X-F-1;if(Z.appendChild(this._createSelectionElement(F+1,0,this._bufferService.cols,P)),F!==X){const V=H===X?L[0]:this._bufferService.cols;Z.appendChild(this._createSelectionElement(X,0,V))}}this._selectionContainer.appendChild(Z)}_createSelectionElement(I,L,x,B=1){const H=document.createElement("div");return H.style.height=B*this.dimensions.css.cell.height+"px",H.style.top=I*this.dimensions.css.cell.height+"px",H.style.left=L*this.dimensions.css.cell.width+"px",H.style.width=this.dimensions.css.cell.width*(x-L)+"px",H}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions()}clear(){for(const I of this._rowElements)I.replaceChildren()}renderRows(I,L){const x=this._bufferService.buffer.ybase+this._bufferService.buffer.y,B=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),H=this._optionsService.rawOptions.cursorBlink;for(let F=I;F<=L;F++){const X=this._rowElements[F],Z=F+this._bufferService.buffer.ydisp,J=this._bufferService.buffer.lines.get(Z),D=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[F]&&this._cellToRowElements[F].length===this._bufferService.cols||(this._cellToRowElements[F]=new Int16Array(this._bufferService.cols)),X.replaceChildren(this._rowFactory.createRow(J,Z,Z===x,D,B,H,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[F]))}}get _terminalSelector(){return`.${S}${this._terminalClass}`}_handleLinkHover(I){this._setCellUnderline(I.x1,I.x2,I.y1,I.y2,I.cols,true)}_handleLinkLeave(I){this._setCellUnderline(I.x1,I.x2,I.y1,I.y2,I.cols,false)}_setCellUnderline(I,L,x,B,H,F){if(I=this._cellToRowElements[x][I],L=this._cellToRowElements[B][L],I!==-1&&L!==-1)for(;I!==L||x!==B;){const X=this._rowElements[x];if(!X)return;const Z=X.children[I];Z&&(Z.style.textDecoration=F?"underline":"none"),++I>=H&&(I=0,x++)}}};A=c([_(4,v.IInstantiationService),_(5,y.ICharSizeService),_(6,v.IOptionsService),_(7,v.IBufferService),_(8,y.ICoreBrowserService),_(9,y.IThemeService)],A),u.DomRenderer=A},3787:function(f,u,p){var c=this&&this.__decorate||function(w,A,I,L){var x,B=arguments.length,H=B<3?A:L===null?L=Object.getOwnPropertyDescriptor(A,I):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(w,A,I,L);else for(var F=w.length-1;F>=0;F--)(x=w[F])&&(H=(B<3?x(H):B>3?x(A,I,H):x(A,I))||H);return B>3&&H&&Object.defineProperty(A,I,H),H},_=this&&this.__param||function(w,A){return function(I,L){A(I,L,w)}};Object.defineProperty(u,"__esModule",{value:true}),u.DomRendererRowFactory=u.CURSOR_STYLE_UNDERLINE_CLASS=u.CURSOR_STYLE_BAR_CLASS=u.CURSOR_STYLE_BLOCK_CLASS=u.CURSOR_BLINK_CLASS=u.CURSOR_CLASS=u.STRIKETHROUGH_CLASS=u.UNDERLINE_CLASS=u.ITALIC_CLASS=u.DIM_CLASS=u.BOLD_CLASS=void 0;const m=p(2223),E=p(643),b=p(511),T=p(2585),y=p(8055),g=p(4725),$=p(4269),R=p(6171),v=p(3734);u.BOLD_CLASS="xterm-bold",u.DIM_CLASS="xterm-dim",u.ITALIC_CLASS="xterm-italic",u.UNDERLINE_CLASS="xterm-underline",u.STRIKETHROUGH_CLASS="xterm-strikethrough",u.CURSOR_CLASS="xterm-cursor",u.CURSOR_BLINK_CLASS="xterm-cursor-blink",u.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",u.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",u.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let S=class{constructor(w,A,I,L,x,B,H){this._document=w,this._characterJoinerService=A,this._optionsService=I,this._coreBrowserService=L,this._coreService=x,this._decorationService=B,this._themeService=H,this._workCell=new b.CellData,this._columnSelectMode=false}handleSelectionChanged(w,A,I){this._selectionStart=w,this._selectionEnd=A,this._columnSelectMode=I}createRow(w,A,I,L,x,B,H,F,X){const Z=this._document.createDocumentFragment(),J=this._characterJoinerService.getJoinedCharacters(A);let D=0;for(let re=Math.min(w.length,F)-1;re>=0;re--)if(w.loadCell(re,this._workCell).getCode()!==E.NULL_CELL_CODE||I&&re===x){D=re+1;break}const P=this._themeService.colors;let V=-1,j=0;for(;j<D;j++){w.loadCell(j,this._workCell);let re=this._workCell.getWidth();if(re===0){X[j]=V;continue}let G=false,ae=j,de=this._workCell;if(J.length>0&&j===J[0][0]){G=true;const ct=J.shift();de=new $.JoinedCellData(this._workCell,w.translateToString(true,ct[0],ct[1]),ct[1]-ct[0]),ae=ct[1]-1,re=de.getWidth()}const fe=this._document.createElement("span");if(re>1&&(fe.style.width=H*re+"px"),G&&(fe.style.display="inline",x>=j&&x<=ae&&(x=j)),!this._coreService.isCursorHidden&&I&&j===x)switch(fe.classList.add(u.CURSOR_CLASS),B&&fe.classList.add(u.CURSOR_BLINK_CLASS),L){case"bar":fe.classList.add(u.CURSOR_STYLE_BAR_CLASS);break;case"underline":fe.classList.add(u.CURSOR_STYLE_UNDERLINE_CLASS);break;default:fe.classList.add(u.CURSOR_STYLE_BLOCK_CLASS)}if(de.isBold()&&fe.classList.add(u.BOLD_CLASS),de.isItalic()&&fe.classList.add(u.ITALIC_CLASS),de.isDim()&&fe.classList.add(u.DIM_CLASS),de.isInvisible()?fe.textContent=E.WHITESPACE_CELL_CHAR:fe.textContent=de.getChars()||E.WHITESPACE_CELL_CHAR,de.isUnderline()&&(fe.classList.add(`${u.UNDERLINE_CLASS}-${de.extended.underlineStyle}`),fe.textContent===" "&&(fe.textContent="\xA0"),!de.isUnderlineColorDefault()))if(de.isUnderlineColorRGB())fe.style.textDecorationColor=`rgb(${v.AttributeData.toColorRGB(de.getUnderlineColor()).join(",")})`;else{let ct=de.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&de.isBold()&&ct<8&&(ct+=8),fe.style.textDecorationColor=P.ansi[ct].css}de.isStrikethrough()&&fe.classList.add(u.STRIKETHROUGH_CLASS);let ee=de.getFgColor(),W=de.getFgColorMode(),Q=de.getBgColor(),ce=de.getBgColorMode();const Ee=!!de.isInverse();if(Ee){const ct=ee;ee=Q,Q=ct;const Ut=W;W=ce,ce=Ut}let Xe,Re,_t=false;this._decorationService.forEachDecorationAtCell(j,A,void 0,ct=>{ct.options.layer!=="top"&&_t||(ct.backgroundColorRGB&&(ce=50331648,Q=ct.backgroundColorRGB.rgba>>8&16777215,Xe=ct.backgroundColorRGB),ct.foregroundColorRGB&&(W=50331648,ee=ct.foregroundColorRGB.rgba>>8&16777215,Re=ct.foregroundColorRGB),_t=ct.options.layer==="top")});const Ct=this._isCellInSelection(j,A);let Rt;switch(_t||P.selectionForeground&&Ct&&(W=50331648,ee=P.selectionForeground.rgba>>8&16777215,Re=P.selectionForeground),Ct&&(Xe=this._coreBrowserService.isFocused?P.selectionBackgroundOpaque:P.selectionInactiveBackgroundOpaque,_t=true),_t&&fe.classList.add("xterm-decoration-top"),ce){case 16777216:case 33554432:Rt=P.ansi[Q],fe.classList.add(`xterm-bg-${Q}`);break;case 50331648:Rt=y.rgba.toColor(Q>>16,Q>>8&255,255&Q),this._addStyle(fe,`background-color:#${O((Q>>>0).toString(16),"0",6)}`);break;default:Ee?(Rt=P.foreground,fe.classList.add(`xterm-bg-${m.INVERTED_DEFAULT_COLOR}`)):Rt=P.background}switch(Xe||de.isDim()&&(Xe=y.color.multiplyOpacity(Rt,.5)),W){case 16777216:case 33554432:de.isBold()&&ee<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ee+=8),this._applyMinimumContrast(fe,Rt,P.ansi[ee],de,Xe,void 0)||fe.classList.add(`xterm-fg-${ee}`);break;case 50331648:const ct=y.rgba.toColor(ee>>16&255,ee>>8&255,255&ee);this._applyMinimumContrast(fe,Rt,ct,de,Xe,Re)||this._addStyle(fe,`color:#${O(ee.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(fe,Rt,P.foreground,de,Xe,void 0)||Ee&&fe.classList.add(`xterm-fg-${m.INVERTED_DEFAULT_COLOR}`)}Z.appendChild(fe),X[j]=++V,j=ae}return j<F-1&&X.subarray(j).fill(++V),Z}_applyMinimumContrast(w,A,I,L,x,B){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,R.excludeFromContrastRatioDemands)(L.getCode()))return false;let H;return x||B||(H=this._themeService.colors.contrastCache.getColor(A.rgba,I.rgba)),H===void 0&&(H=y.color.ensureContrastRatio(x||A,B||I,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((x||A).rgba,(B||I).rgba,H??null)),!!H&&(this._addStyle(w,`color:${H.css}`),true)}_addStyle(w,A){w.setAttribute("style",`${w.getAttribute("style")||""}${A};`)}_isCellInSelection(w,A){const I=this._selectionStart,L=this._selectionEnd;return!(!I||!L)&&(this._columnSelectMode?I[0]<=L[0]?w>=I[0]&&A>=I[1]&&w<L[0]&&A<=L[1]:w<I[0]&&A>=I[1]&&w>=L[0]&&A<=L[1]:A>I[1]&&A<L[1]||I[1]===L[1]&&A===I[1]&&w>=I[0]&&w<L[0]||I[1]<L[1]&&A===L[1]&&w<L[0]||I[1]<L[1]&&A===I[1]&&w>=I[0])}};function O(w,A,I){for(;w.length<I;)w=A+w;return w}S=c([_(1,g.ICharacterJoinerService),_(2,T.IOptionsService),_(3,g.ICoreBrowserService),_(4,T.ICoreService),_(5,T.IDecorationService),_(6,g.IThemeService)],S),u.DomRendererRowFactory=S},2223:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.TEXT_BASELINE=u.DIM_OPACITY=u.INVERTED_DEFAULT_COLOR=void 0;const c=p(6114);u.INVERTED_DEFAULT_COLOR=257,u.DIM_OPACITY=.5,u.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(f,u)=>{function p(c){return 57508<=c&&c<=57558}Object.defineProperty(u,"__esModule",{value:true}),u.createRenderDimensions=u.excludeFromContrastRatioDemands=u.isRestrictedPowerlineGlyph=u.isPowerlineGlyph=u.throwIfFalsy=void 0,u.throwIfFalsy=function(c){if(!c)throw new Error("value must not be falsy");return c},u.isPowerlineGlyph=p,u.isRestrictedPowerlineGlyph=function(c){return 57520<=c&&c<=57527},u.excludeFromContrastRatioDemands=function(c){return p(c)||function(_){return 9472<=_&&_<=9631}(c)},u.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.SelectionModel=void 0,u.SelectionModel=class{constructor(p){this._bufferService=p,this.isSelectAllActive=false,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=false,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const p=this.selectionStart[0]+this.selectionStartLength;return p>this._bufferService.cols?p%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(p/this._bufferService.cols)-1]:[p%this._bufferService.cols,this.selectionStart[1]+Math.floor(p/this._bufferService.cols)]:[p,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const p=this.selectionStart[0]+this.selectionStartLength;return p>this._bufferService.cols?[p%this._bufferService.cols,this.selectionStart[1]+Math.floor(p/this._bufferService.cols)]:[Math.max(p,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const p=this.selectionStart,c=this.selectionEnd;return!(!p||!c)&&(p[1]>c[1]||p[1]===c[1]&&p[0]>c[0])}handleTrim(p){return this.selectionStart&&(this.selectionStart[1]-=p),this.selectionEnd&&(this.selectionEnd[1]-=p),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),true):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),false)}}},428:function(f,u,p){var c=this&&this.__decorate||function(g,$,R,v){var S,O=arguments.length,w=O<3?$:v===null?v=Object.getOwnPropertyDescriptor($,R):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,$,R,v);else for(var A=g.length-1;A>=0;A--)(S=g[A])&&(w=(O<3?S(w):O>3?S($,R,w):S($,R))||w);return O>3&&w&&Object.defineProperty($,R,w),w},_=this&&this.__param||function(g,$){return function(R,v){$(R,v,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.CharSizeService=void 0;const m=p(2585),E=p(8460),b=p(844);let T=class extends b.Disposable{constructor(g,$,R){super(),this._optionsService=R,this.width=0,this.height=0,this._onCharSizeChange=this.register(new E.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new y(g,$,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const g=this._measureStrategy.measure();g.width===this.width&&g.height===this.height||(this.width=g.width,this.height=g.height,this._onCharSizeChange.fire())}};T=c([_(2,m.IOptionsService)],T),u.CharSizeService=T;class y{constructor($,R,v){this._document=$,this._parentElement=R,this._optionsService=v,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const $=this._measureElement.getBoundingClientRect();return $.width!==0&&$.height!==0&&(this._result.width=$.width,this._result.height=Math.ceil($.height)),this._result}}},4269:function(f,u,p){var c=this&&this.__decorate||function($,R,v,S){var O,w=arguments.length,A=w<3?R:S===null?S=Object.getOwnPropertyDescriptor(R,v):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate($,R,v,S);else for(var I=$.length-1;I>=0;I--)(O=$[I])&&(A=(w<3?O(A):w>3?O(R,v,A):O(R,v))||A);return w>3&&A&&Object.defineProperty(R,v,A),A},_=this&&this.__param||function($,R){return function(v,S){R(v,S,$)}};Object.defineProperty(u,"__esModule",{value:true}),u.CharacterJoinerService=u.JoinedCellData=void 0;const m=p(3734),E=p(643),b=p(511),T=p(2585);class y extends m.AttributeData{constructor(R,v,S){super(),this.content=0,this.combinedData="",this.fg=R.fg,this.bg=R.bg,this.combinedData=v,this._width=S}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(R){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}u.JoinedCellData=y;let g=class m0{constructor(R){this._bufferService=R,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new b.CellData}register(R){const v={id:this._nextCharacterJoinerId++,handler:R};return this._characterJoiners.push(v),v.id}deregister(R){for(let v=0;v<this._characterJoiners.length;v++)if(this._characterJoiners[v].id===R)return this._characterJoiners.splice(v,1),true;return false}getJoinedCharacters(R){if(this._characterJoiners.length===0)return[];const v=this._bufferService.buffer.lines.get(R);if(!v||v.length===0)return[];const S=[],O=v.translateToString(true);let w=0,A=0,I=0,L=v.getFg(0),x=v.getBg(0);for(let B=0;B<v.getTrimmedLength();B++)if(v.loadCell(B,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==L||this._workCell.bg!==x){if(B-w>1){const H=this._getJoinedRanges(O,I,A,v,w);for(let F=0;F<H.length;F++)S.push(H[F])}w=B,I=A,L=this._workCell.fg,x=this._workCell.bg}A+=this._workCell.getChars().length||E.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-w>1){const B=this._getJoinedRanges(O,I,A,v,w);for(let H=0;H<B.length;H++)S.push(B[H])}return S}_getJoinedRanges(R,v,S,O,w){const A=R.substring(v,S);let I=[];try{I=this._characterJoiners[0].handler(A)}catch(L){console.error(L)}for(let L=1;L<this._characterJoiners.length;L++)try{const x=this._characterJoiners[L].handler(A);for(let B=0;B<x.length;B++)m0._mergeRanges(I,x[B])}catch(x){console.error(x)}return this._stringRangesToCellRanges(I,O,w),I}_stringRangesToCellRanges(R,v,S){let O=0,w=false,A=0,I=R[O];if(I){for(let L=S;L<this._bufferService.cols;L++){const x=v.getWidth(L),B=v.getString(L).length||E.WHITESPACE_CELL_CHAR.length;if(x!==0){if(!w&&I[0]<=A&&(I[0]=L,w=true),I[1]<=A){if(I[1]=L,I=R[++O],!I)break;I[0]<=A?(I[0]=L,w=true):w=false}A+=B}}I&&(I[1]=this._bufferService.cols)}}static _mergeRanges(R,v){let S=false;for(let O=0;O<R.length;O++){const w=R[O];if(S){if(v[1]<=w[0])return R[O-1][1]=v[1],R;if(v[1]<=w[1])return R[O-1][1]=Math.max(v[1],w[1]),R.splice(O,1),R;R.splice(O,1),O--}else{if(v[1]<=w[0])return R.splice(O,0,v),R;if(v[1]<=w[1])return w[0]=Math.min(v[0],w[0]),R;v[0]<w[1]&&(w[0]=Math.min(v[0],w[0]),S=true)}}return S?R[R.length-1][1]=v[1]:R.push(v),R}};g=c([_(0,T.IBufferService)],g),u.CharacterJoinerService=g},5114:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CoreBrowserService=void 0,u.CoreBrowserService=class{constructor(p,c){this._textarea=p,this.window=c,this._isFocused=false,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=true),this._textarea.addEventListener("blur",()=>this._isFocused=false)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(f,u,p){var c=this&&this.__decorate||function(T,y,g,$){var R,v=arguments.length,S=v<3?y:$===null?$=Object.getOwnPropertyDescriptor(y,g):$;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(T,y,g,$);else for(var O=T.length-1;O>=0;O--)(R=T[O])&&(S=(v<3?R(S):v>3?R(y,g,S):R(y,g))||S);return v>3&&S&&Object.defineProperty(y,g,S),S},_=this&&this.__param||function(T,y){return function(g,$){y(g,$,T)}};Object.defineProperty(u,"__esModule",{value:true}),u.MouseService=void 0;const m=p(4725),E=p(9806);let b=class{constructor(T,y){this._renderService=T,this._charSizeService=y}getCoords(T,y,g,$,R){return(0,E.getCoords)(window,T,y,g,$,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,R)}getMouseReportCoords(T,y){const g=(0,E.getCoordsRelativeToElement)(window,T,y);if(!(!this._charSizeService.hasValidSize||g[0]<0||g[1]<0||g[0]>=this._renderService.dimensions.css.canvas.width||g[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(g[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(g[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(g[0]),y:Math.floor(g[1])}}};b=c([_(0,m.IRenderService),_(1,m.ICharSizeService)],b),u.MouseService=b},3230:function(f,u,p){var c=this&&this.__decorate||function(S,O,w,A){var I,L=arguments.length,x=L<3?O:A===null?A=Object.getOwnPropertyDescriptor(O,w):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,O,w,A);else for(var B=S.length-1;B>=0;B--)(I=S[B])&&(x=(L<3?I(x):L>3?I(O,w,x):I(O,w))||x);return L>3&&x&&Object.defineProperty(O,w,x),x},_=this&&this.__param||function(S,O){return function(w,A){O(w,A,S)}};Object.defineProperty(u,"__esModule",{value:true}),u.RenderService=void 0;const m=p(6193),E=p(8460),b=p(844),T=p(5596),y=p(3656),g=p(2585),$=p(4725),R=p(7226);let v=class extends b.Disposable{constructor(S,O,w,A,I,L,x,B){if(super(),this._rowCount=S,this._charSizeService=A,this._pausedResizeTask=new R.DebouncedIdleTask,this._isPaused=false,this._needsFullRefresh=false,this._isNextRenderRedrawOnly=true,this._needsSelectionRefresh=false,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:false},this._onDimensionsChange=this.register(new E.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new E.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new E.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new E.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var H;return(H=this._renderer)===null||H===void 0?void 0:H.dispose()}}),this._renderDebouncer=new m.RenderDebouncer(x.window,(H,F)=>this._renderRows(H,F)),this.register(this._renderDebouncer),this._screenDprMonitor=new T.ScreenDprMonitor(x.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(L.onResize(()=>this._fullRefresh())),this.register(L.buffers.onBufferActivate(()=>{var H;return(H=this._renderer)===null||H===void 0?void 0:H.clear()})),this.register(w.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(I.onDecorationRegistered(()=>this._fullRefresh())),this.register(I.onDecorationRemoved(()=>this._fullRefresh())),this.register(w.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(L.cols,L.rows),this._fullRefresh()})),this.register(w.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(L.buffer.y,L.buffer.y,true))),this.register((0,y.addDisposableDomListener)(x.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(B.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in x.window){const H=new x.window.IntersectionObserver(F=>this._handleIntersectionChange(F[F.length-1]),{threshold:0});H.observe(O),this.register({dispose:()=>H.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(S){this._isPaused=S.isIntersecting===void 0?S.intersectionRatio===0:!S.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=false)}refreshRows(S,O,w=false){this._isPaused?this._needsFullRefresh=true:(w||(this._isNextRenderRedrawOnly=false),this._renderDebouncer.refresh(S,O,this._rowCount))}_renderRows(S,O){this._renderer&&(this._renderer.renderRows(S,O),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=false),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:S,end:O}),this._onRender.fire({start:S,end:O}),this._isNextRenderRedrawOnly=true)}resize(S,O){this._rowCount=O,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(S){var O;(O=this._renderer)===null||O===void 0||O.dispose(),this._renderer=S,this._renderer.onRequestRedraw(w=>this.refreshRows(w.start,w.end,true)),this._needsSelectionRefresh=true,this._fullRefresh()}addRefreshCallback(S){return this._renderDebouncer.addRefreshCallback(S)}_fullRefresh(){this._isPaused?this._needsFullRefresh=true:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var S,O;this._renderer&&((O=(S=this._renderer).clearTextureAtlas)===null||O===void 0||O.call(S),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(S,O){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(S,O)):this._renderer.handleResize(S,O),this._fullRefresh())}handleCharSizeChanged(){var S;(S=this._renderer)===null||S===void 0||S.handleCharSizeChanged()}handleBlur(){var S;(S=this._renderer)===null||S===void 0||S.handleBlur()}handleFocus(){var S;(S=this._renderer)===null||S===void 0||S.handleFocus()}handleSelectionChanged(S,O,w){var A;this._selectionState.start=S,this._selectionState.end=O,this._selectionState.columnSelectMode=w,(A=this._renderer)===null||A===void 0||A.handleSelectionChanged(S,O,w)}handleCursorMove(){var S;(S=this._renderer)===null||S===void 0||S.handleCursorMove()}clear(){var S;(S=this._renderer)===null||S===void 0||S.clear()}};v=c([_(2,g.IOptionsService),_(3,$.ICharSizeService),_(4,g.IDecorationService),_(5,g.IBufferService),_(6,$.ICoreBrowserService),_(7,$.IThemeService)],v),u.RenderService=v},9312:function(f,u,p){var c=this&&this.__decorate||function(I,L,x,B){var H,F=arguments.length,X=F<3?L:B===null?B=Object.getOwnPropertyDescriptor(L,x):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(I,L,x,B);else for(var Z=I.length-1;Z>=0;Z--)(H=I[Z])&&(X=(F<3?H(X):F>3?H(L,x,X):H(L,x))||X);return F>3&&X&&Object.defineProperty(L,x,X),X},_=this&&this.__param||function(I,L){return function(x,B){L(x,B,I)}};Object.defineProperty(u,"__esModule",{value:true}),u.SelectionService=void 0;const m=p(6114),E=p(456),b=p(511),T=p(8460),y=p(4725),g=p(2585),$=p(9806),R=p(9504),v=p(844),S=p(4841),O=String.fromCharCode(160),w=new RegExp(O,"g");let A=class extends v.Disposable{constructor(I,L,x,B,H,F,X,Z,J){super(),this._element=I,this._screenElement=L,this._linkifier=x,this._bufferService=B,this._coreService=H,this._mouseService=F,this._optionsService=X,this._renderService=Z,this._coreBrowserService=J,this._dragScrollAmount=0,this._enabled=true,this._workCell=new b.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=false,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new T.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new T.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new T.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new T.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=D=>this._handleMouseMove(D),this._mouseUpListener=D=>this._handleMouseUp(D),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(D=>this._handleTrim(D)),this.register(this._bufferService.buffers.onBufferActivate(D=>this._handleBufferActivate(D))),this.enable(),this._model=new E.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,v.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=false}enable(){this._enabled=true}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const I=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;return!(!I||!L||I[0]===L[0]&&I[1]===L[1])}get selectionText(){const I=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;if(!I||!L)return"";const x=this._bufferService.buffer,B=[];if(this._activeSelectionMode===3){if(I[0]===L[0])return"";const H=I[0]<L[0]?I[0]:L[0],F=I[0]<L[0]?L[0]:I[0];for(let X=I[1];X<=L[1];X++){const Z=x.translateBufferLineToString(X,true,H,F);B.push(Z)}}else{const H=I[1]===L[1]?L[0]:void 0;B.push(x.translateBufferLineToString(I[1],true,I[0],H));for(let F=I[1]+1;F<=L[1]-1;F++){const X=x.lines.get(F),Z=x.translateBufferLineToString(F,true);X!=null&&X.isWrapped?B[B.length-1]+=Z:B.push(Z)}if(I[1]!==L[1]){const F=x.lines.get(L[1]),X=x.translateBufferLineToString(L[1],true,0,L[0]);F&&F.isWrapped?B[B.length-1]+=X:B.push(X)}}return B.map(H=>H.replace(w," ")).join(m.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(I){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),m.isLinux&&I&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(I){const L=this._getMouseBufferCoords(I),x=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!!(x&&B&&L)&&this._areCoordsInSelection(L,x,B)}isCellInSelection(I,L){const x=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!(!x||!B)&&this._areCoordsInSelection([I,L],x,B)}_areCoordsInSelection(I,L,x){return I[1]>L[1]&&I[1]<x[1]||L[1]===x[1]&&I[1]===L[1]&&I[0]>=L[0]&&I[0]<x[0]||L[1]<x[1]&&I[1]===x[1]&&I[0]<x[0]||L[1]<x[1]&&I[1]===L[1]&&I[0]>=L[0]}_selectWordAtCursor(I,L){var x,B;const H=(B=(x=this._linkifier.currentLink)===null||x===void 0?void 0:x.link)===null||B===void 0?void 0:B.range;if(H)return this._model.selectionStart=[H.start.x-1,H.start.y-1],this._model.selectionStartLength=(0,S.getRangeLength)(H,this._bufferService.cols),this._model.selectionEnd=void 0,true;const F=this._getMouseBufferCoords(I);return!!F&&(this._selectWordAt(F,L),this._model.selectionEnd=void 0,true)}selectAll(){this._model.isSelectAllActive=true,this.refresh(),this._onSelectionChange.fire()}selectLines(I,L){this._model.clearSelection(),I=Math.max(I,0),L=Math.min(L,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,I],this._model.selectionEnd=[this._bufferService.cols,L],this.refresh(),this._onSelectionChange.fire()}_handleTrim(I){this._model.handleTrim(I)&&this.refresh()}_getMouseBufferCoords(I){const L=this._mouseService.getCoords(I,this._screenElement,this._bufferService.cols,this._bufferService.rows,true);if(L)return L[0]--,L[1]--,L[1]+=this._bufferService.buffer.ydisp,L}_getMouseEventScrollAmount(I){let L=(0,$.getCoordsRelativeToElement)(this._coreBrowserService.window,I,this._screenElement)[1];const x=this._renderService.dimensions.css.canvas.height;return L>=0&&L<=x?0:(L>x&&(L-=x),L=Math.min(Math.max(L,-50),50),L/=50,L/Math.abs(L)+Math.round(14*L))}shouldForceSelection(I){return m.isMac?I.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:I.shiftKey}handleMouseDown(I){if(this._mouseDownTimeStamp=I.timeStamp,(I.button!==2||!this.hasSelection)&&I.button===0){if(!this._enabled){if(!this.shouldForceSelection(I))return;I.stopPropagation()}I.preventDefault(),this._dragScrollAmount=0,this._enabled&&I.shiftKey?this._handleIncrementalClick(I):I.detail===1?this._handleSingleClick(I):I.detail===2?this._handleDoubleClick(I):I.detail===3&&this._handleTripleClick(I),this._addMouseDownListeners(),this.refresh(true)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(I){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(I))}_handleSingleClick(I){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=false,this._activeSelectionMode=this.shouldColumnSelect(I)?3:0,this._model.selectionStart=this._getMouseBufferCoords(I),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const L=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);L&&L.length!==this._model.selectionStart[0]&&L.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(I){this._selectWordAtCursor(I,true)&&(this._activeSelectionMode=1)}_handleTripleClick(I){const L=this._getMouseBufferCoords(I);L&&(this._activeSelectionMode=2,this._selectLineAt(L[1]))}shouldColumnSelect(I){return I.altKey&&!(m.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(I){if(I.stopImmediatePropagation(),!this._model.selectionStart)return;const L=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(I),!this._model.selectionEnd)return void this.refresh(true);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(I),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const x=this._bufferService.buffer;if(this._model.selectionEnd[1]<x.lines.length){const B=x.lines.get(this._model.selectionEnd[1]);B&&B.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}L&&L[0]===this._model.selectionEnd[0]&&L[1]===this._model.selectionEnd[1]||this.refresh(true)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:false});const I=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(I.ydisp+this._bufferService.rows,I.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=I.ydisp),this.refresh()}}_handleMouseUp(I){const L=I.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&L<500&&I.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const x=this._mouseService.getCoords(I,this._element,this._bufferService.cols,this._bufferService.rows,false);if(x&&x[0]!==void 0&&x[1]!==void 0){const B=(0,R.moveToCellSequence)(x[0]-1,x[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(B,true)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const I=this._model.finalSelectionStart,L=this._model.finalSelectionEnd,x=!(!I||!L||I[0]===L[0]&&I[1]===L[1]);x?I&&L&&(this._oldSelectionStart&&this._oldSelectionEnd&&I[0]===this._oldSelectionStart[0]&&I[1]===this._oldSelectionStart[1]&&L[0]===this._oldSelectionEnd[0]&&L[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(I,L,x)):this._oldHasSelection&&this._fireOnSelectionChange(I,L,x)}_fireOnSelectionChange(I,L,x){this._oldSelectionStart=I,this._oldSelectionEnd=L,this._oldHasSelection=x,this._onSelectionChange.fire()}_handleBufferActivate(I){this.clearSelection(),this._trimListener.dispose(),this._trimListener=I.activeBuffer.lines.onTrim(L=>this._handleTrim(L))}_convertViewportColToCharacterIndex(I,L){let x=L;for(let B=0;L>=B;B++){const H=I.loadCell(B,this._workCell).getChars().length;this._workCell.getWidth()===0?x--:H>1&&L!==B&&(x+=H-1)}return x}setSelection(I,L,x){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[I,L],this._model.selectionStartLength=x,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(I){this._isClickInSelection(I)||(this._selectWordAtCursor(I,false)&&this.refresh(true),this._fireEventIfSelectionChanged())}_getWordAt(I,L,x=true,B=true){if(I[0]>=this._bufferService.cols)return;const H=this._bufferService.buffer,F=H.lines.get(I[1]);if(!F)return;const X=H.translateBufferLineToString(I[1],false);let Z=this._convertViewportColToCharacterIndex(F,I[0]),J=Z;const D=I[0]-Z;let P=0,V=0,j=0,re=0;if(X.charAt(Z)===" "){for(;Z>0&&X.charAt(Z-1)===" ";)Z--;for(;J<X.length&&X.charAt(J+1)===" ";)J++}else{let de=I[0],fe=I[0];F.getWidth(de)===0&&(P++,de--),F.getWidth(fe)===2&&(V++,fe++);const ee=F.getString(fe).length;for(ee>1&&(re+=ee-1,J+=ee-1);de>0&&Z>0&&!this._isCharWordSeparator(F.loadCell(de-1,this._workCell));){F.loadCell(de-1,this._workCell);const W=this._workCell.getChars().length;this._workCell.getWidth()===0?(P++,de--):W>1&&(j+=W-1,Z-=W-1),Z--,de--}for(;fe<F.length&&J+1<X.length&&!this._isCharWordSeparator(F.loadCell(fe+1,this._workCell));){F.loadCell(fe+1,this._workCell);const W=this._workCell.getChars().length;this._workCell.getWidth()===2?(V++,fe++):W>1&&(re+=W-1,J+=W-1),J++,fe++}}J++;let G=Z+D-P+j,ae=Math.min(this._bufferService.cols,J-Z+P+V-j-re);if(L||X.slice(Z,J).trim()!==""){if(x&&G===0&&F.getCodePoint(0)!==32){const de=H.lines.get(I[1]-1);if(de&&F.isWrapped&&de.getCodePoint(this._bufferService.cols-1)!==32){const fe=this._getWordAt([this._bufferService.cols-1,I[1]-1],false,true,false);if(fe){const ee=this._bufferService.cols-fe.start;G-=ee,ae+=ee}}}if(B&&G+ae===this._bufferService.cols&&F.getCodePoint(this._bufferService.cols-1)!==32){const de=H.lines.get(I[1]+1);if(de!=null&&de.isWrapped&&de.getCodePoint(0)!==32){const fe=this._getWordAt([0,I[1]+1],false,false,true);fe&&(ae+=fe.length)}}return{start:G,length:ae}}}_selectWordAt(I,L){const x=this._getWordAt(I,L);if(x){for(;x.start<0;)x.start+=this._bufferService.cols,I[1]--;this._model.selectionStart=[x.start,I[1]],this._model.selectionStartLength=x.length}}_selectToWordAt(I){const L=this._getWordAt(I,true);if(L){let x=I[1];for(;L.start<0;)L.start+=this._bufferService.cols,x--;if(!this._model.areSelectionValuesReversed())for(;L.start+L.length>this._bufferService.cols;)L.length-=this._bufferService.cols,x++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?L.start:L.start+L.length,x]}}_isCharWordSeparator(I){return I.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(I.getChars())>=0}_selectLineAt(I){const L=this._bufferService.buffer.getWrappedRangeForLine(I),x={start:{x:0,y:L.first},end:{x:this._bufferService.cols-1,y:L.last}};this._model.selectionStart=[0,L.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,S.getRangeLength)(x,this._bufferService.cols)}};A=c([_(3,g.IBufferService),_(4,g.ICoreService),_(5,y.IMouseService),_(6,g.IOptionsService),_(7,y.IRenderService),_(8,y.ICoreBrowserService)],A),u.SelectionService=A},4725:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.IThemeService=u.ICharacterJoinerService=u.ISelectionService=u.IRenderService=u.IMouseService=u.ICoreBrowserService=u.ICharSizeService=void 0;const c=p(8343);u.ICharSizeService=(0,c.createDecorator)("CharSizeService"),u.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),u.IMouseService=(0,c.createDecorator)("MouseService"),u.IRenderService=(0,c.createDecorator)("RenderService"),u.ISelectionService=(0,c.createDecorator)("SelectionService"),u.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),u.IThemeService=(0,c.createDecorator)("ThemeService")},6731:function(f,u,p){var c=this&&this.__decorate||function(A,I,L,x){var B,H=arguments.length,F=H<3?I:x===null?x=Object.getOwnPropertyDescriptor(I,L):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(A,I,L,x);else for(var X=A.length-1;X>=0;X--)(B=A[X])&&(F=(H<3?B(F):H>3?B(I,L,F):B(I,L))||F);return H>3&&F&&Object.defineProperty(I,L,F),F},_=this&&this.__param||function(A,I){return function(L,x){I(L,x,A)}};Object.defineProperty(u,"__esModule",{value:true}),u.ThemeService=u.DEFAULT_ANSI_COLORS=void 0;const m=p(7239),E=p(8055),b=p(8460),T=p(844),y=p(2585),g=E.css.toColor("#ffffff"),$=E.css.toColor("#000000"),R=E.css.toColor("#ffffff"),v=E.css.toColor("#000000"),S={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};u.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const A=[E.css.toColor("#2e3436"),E.css.toColor("#cc0000"),E.css.toColor("#4e9a06"),E.css.toColor("#c4a000"),E.css.toColor("#3465a4"),E.css.toColor("#75507b"),E.css.toColor("#06989a"),E.css.toColor("#d3d7cf"),E.css.toColor("#555753"),E.css.toColor("#ef2929"),E.css.toColor("#8ae234"),E.css.toColor("#fce94f"),E.css.toColor("#729fcf"),E.css.toColor("#ad7fa8"),E.css.toColor("#34e2e2"),E.css.toColor("#eeeeec")],I=[0,95,135,175,215,255];for(let L=0;L<216;L++){const x=I[L/36%6|0],B=I[L/6%6|0],H=I[L%6];A.push({css:E.channels.toCss(x,B,H),rgba:E.channels.toRgba(x,B,H)})}for(let L=0;L<24;L++){const x=8+10*L;A.push({css:E.channels.toCss(x,x,x),rgba:E.channels.toRgba(x,x,x)})}return A})());let O=class extends T.Disposable{constructor(A){super(),this._optionsService=A,this._onChangeColors=this.register(new b.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new m.ColorContrastCache,this._colors={foreground:g,background:$,cursor:R,cursorAccent:v,selectionForeground:void 0,selectionBackgroundTransparent:S,selectionBackgroundOpaque:E.color.blend($,S),selectionInactiveBackgroundTransparent:S,selectionInactiveBackgroundOpaque:E.color.blend($,S),ansi:u.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(A={}){const I=this._colors;if(I.foreground=w(A.foreground,g),I.background=w(A.background,$),I.cursor=w(A.cursor,R),I.cursorAccent=w(A.cursorAccent,v),I.selectionBackgroundTransparent=w(A.selectionBackground,S),I.selectionBackgroundOpaque=E.color.blend(I.background,I.selectionBackgroundTransparent),I.selectionInactiveBackgroundTransparent=w(A.selectionInactiveBackground,I.selectionBackgroundTransparent),I.selectionInactiveBackgroundOpaque=E.color.blend(I.background,I.selectionInactiveBackgroundTransparent),I.selectionForeground=A.selectionForeground?w(A.selectionForeground,E.NULL_COLOR):void 0,I.selectionForeground===E.NULL_COLOR&&(I.selectionForeground=void 0),E.color.isOpaque(I.selectionBackgroundTransparent)&&(I.selectionBackgroundTransparent=E.color.opacity(I.selectionBackgroundTransparent,.3)),E.color.isOpaque(I.selectionInactiveBackgroundTransparent)&&(I.selectionInactiveBackgroundTransparent=E.color.opacity(I.selectionInactiveBackgroundTransparent,.3)),I.ansi=u.DEFAULT_ANSI_COLORS.slice(),I.ansi[0]=w(A.black,u.DEFAULT_ANSI_COLORS[0]),I.ansi[1]=w(A.red,u.DEFAULT_ANSI_COLORS[1]),I.ansi[2]=w(A.green,u.DEFAULT_ANSI_COLORS[2]),I.ansi[3]=w(A.yellow,u.DEFAULT_ANSI_COLORS[3]),I.ansi[4]=w(A.blue,u.DEFAULT_ANSI_COLORS[4]),I.ansi[5]=w(A.magenta,u.DEFAULT_ANSI_COLORS[5]),I.ansi[6]=w(A.cyan,u.DEFAULT_ANSI_COLORS[6]),I.ansi[7]=w(A.white,u.DEFAULT_ANSI_COLORS[7]),I.ansi[8]=w(A.brightBlack,u.DEFAULT_ANSI_COLORS[8]),I.ansi[9]=w(A.brightRed,u.DEFAULT_ANSI_COLORS[9]),I.ansi[10]=w(A.brightGreen,u.DEFAULT_ANSI_COLORS[10]),I.ansi[11]=w(A.brightYellow,u.DEFAULT_ANSI_COLORS[11]),I.ansi[12]=w(A.brightBlue,u.DEFAULT_ANSI_COLORS[12]),I.ansi[13]=w(A.brightMagenta,u.DEFAULT_ANSI_COLORS[13]),I.ansi[14]=w(A.brightCyan,u.DEFAULT_ANSI_COLORS[14]),I.ansi[15]=w(A.brightWhite,u.DEFAULT_ANSI_COLORS[15]),A.extendedAnsi){const L=Math.min(I.ansi.length-16,A.extendedAnsi.length);for(let x=0;x<L;x++)I.ansi[x+16]=w(A.extendedAnsi[x],u.DEFAULT_ANSI_COLORS[x+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(A){this._restoreColor(A),this._onChangeColors.fire(this.colors)}_restoreColor(A){if(A!==void 0)switch(A){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[A]=this._restoreColors.ansi[A]}else for(let I=0;I<this._restoreColors.ansi.length;++I)this._colors.ansi[I]=this._restoreColors.ansi[I]}modifyColors(A){A(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function w(A,I){if(A!==void 0)try{return E.css.toColor(A)}catch{}return I}O=c([_(0,y.IOptionsService)],O),u.ThemeService=O},6349:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CircularList=void 0;const c=p(8460),_=p(844);class m extends _.Disposable{constructor(b){super(),this._maxLength=b,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(b){if(this._maxLength===b)return;const T=new Array(b);for(let y=0;y<Math.min(b,this.length);y++)T[y]=this._array[this._getCyclicIndex(y)];this._array=T,this._maxLength=b,this._startIndex=0}get length(){return this._length}set length(b){if(b>this._length)for(let T=this._length;T<b;T++)this._array[T]=void 0;this._length=b}get(b){return this._array[this._getCyclicIndex(b)]}set(b,T){this._array[this._getCyclicIndex(b)]=T}push(b){this._array[this._getCyclicIndex(this._length)]=b,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(b,T,...y){if(T){for(let g=b;g<this._length-T;g++)this._array[this._getCyclicIndex(g)]=this._array[this._getCyclicIndex(g+T)];this._length-=T,this.onDeleteEmitter.fire({index:b,amount:T})}for(let g=this._length-1;g>=b;g--)this._array[this._getCyclicIndex(g+y.length)]=this._array[this._getCyclicIndex(g)];for(let g=0;g<y.length;g++)this._array[this._getCyclicIndex(b+g)]=y[g];if(y.length&&this.onInsertEmitter.fire({index:b,amount:y.length}),this._length+y.length>this._maxLength){const g=this._length+y.length-this._maxLength;this._startIndex+=g,this._length=this._maxLength,this.onTrimEmitter.fire(g)}else this._length+=y.length}trimStart(b){b>this._length&&(b=this._length),this._startIndex+=b,this._length-=b,this.onTrimEmitter.fire(b)}shiftElements(b,T,y){if(!(T<=0)){if(b<0||b>=this._length)throw new Error("start argument out of range");if(b+y<0)throw new Error("Cannot shift elements in list beyond index 0");if(y>0){for(let $=T-1;$>=0;$--)this.set(b+$+y,this.get(b+$));const g=b+T+y-this._length;if(g>0)for(this._length+=g;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let g=0;g<T;g++)this.set(b+g+y,this.get(b+g))}}_getCyclicIndex(b){return(this._startIndex+b)%this._maxLength}}u.CircularList=m},1439:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.clone=void 0,u.clone=function p(c,_=5){if(typeof c!="object")return c;const m=Array.isArray(c)?[]:{};for(const E in c)m[E]=_<=1?c[E]:c[E]&&p(c[E],_-1);return m}},8055:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.contrastRatio=u.toPaddedHex=u.rgba=u.rgb=u.css=u.color=u.channels=u.NULL_COLOR=void 0;const c=p(6114);let _=0,m=0,E=0,b=0;var T,y,g;function $(v){const S=v.toString(16);return S.length<2?"0"+S:S}function R(v,S){return v<S?(S+.05)/(v+.05):(v+.05)/(S+.05)}u.NULL_COLOR={css:"#00000000",rgba:0},function(v){v.toCss=function(S,O,w,A){return A!==void 0?`#${$(S)}${$(O)}${$(w)}${$(A)}`:`#${$(S)}${$(O)}${$(w)}`},v.toRgba=function(S,O,w,A=255){return(S<<24|O<<16|w<<8|A)>>>0}}(T=u.channels||(u.channels={})),function(v){function S(O,w){return b=Math.round(255*w),[_,m,E]=g.toChannels(O.rgba),{css:T.toCss(_,m,E,b),rgba:T.toRgba(_,m,E,b)}}v.blend=function(O,w){if(b=(255&w.rgba)/255,b===1)return{css:w.css,rgba:w.rgba};const A=w.rgba>>24&255,I=w.rgba>>16&255,L=w.rgba>>8&255,x=O.rgba>>24&255,B=O.rgba>>16&255,H=O.rgba>>8&255;return _=x+Math.round((A-x)*b),m=B+Math.round((I-B)*b),E=H+Math.round((L-H)*b),{css:T.toCss(_,m,E),rgba:T.toRgba(_,m,E)}},v.isOpaque=function(O){return(255&O.rgba)==255},v.ensureContrastRatio=function(O,w,A){const I=g.ensureContrastRatio(O.rgba,w.rgba,A);if(I)return g.toColor(I>>24&255,I>>16&255,I>>8&255)},v.opaque=function(O){const w=(255|O.rgba)>>>0;return[_,m,E]=g.toChannels(w),{css:T.toCss(_,m,E),rgba:w}},v.opacity=S,v.multiplyOpacity=function(O,w){return b=255&O.rgba,S(O,b*w/255)},v.toColorRGB=function(O){return[O.rgba>>24&255,O.rgba>>16&255,O.rgba>>8&255]}}(u.color||(u.color={})),function(v){let S,O;if(!c.isNode){const w=document.createElement("canvas");w.width=1,w.height=1;const A=w.getContext("2d",{willReadFrequently:true});A&&(S=A,S.globalCompositeOperation="copy",O=S.createLinearGradient(0,0,1,1))}v.toColor=function(w){if(w.match(/#[\da-f]{3,8}/i))switch(w.length){case 4:return _=parseInt(w.slice(1,2).repeat(2),16),m=parseInt(w.slice(2,3).repeat(2),16),E=parseInt(w.slice(3,4).repeat(2),16),g.toColor(_,m,E);case 5:return _=parseInt(w.slice(1,2).repeat(2),16),m=parseInt(w.slice(2,3).repeat(2),16),E=parseInt(w.slice(3,4).repeat(2),16),b=parseInt(w.slice(4,5).repeat(2),16),g.toColor(_,m,E,b);case 7:return{css:w,rgba:(parseInt(w.slice(1),16)<<8|255)>>>0};case 9:return{css:w,rgba:parseInt(w.slice(1),16)>>>0}}const A=w.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(A)return _=parseInt(A[1]),m=parseInt(A[2]),E=parseInt(A[3]),b=Math.round(255*(A[5]===void 0?1:parseFloat(A[5]))),g.toColor(_,m,E,b);if(!S||!O)throw new Error("css.toColor: Unsupported css format");if(S.fillStyle=O,S.fillStyle=w,typeof S.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(S.fillRect(0,0,1,1),[_,m,E,b]=S.getImageData(0,0,1,1).data,b!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:T.toRgba(_,m,E,b),css:w}}}(u.css||(u.css={})),function(v){function S(O,w,A){const I=O/255,L=w/255,x=A/255;return .2126*(I<=.03928?I/12.92:Math.pow((I+.055)/1.055,2.4))+.7152*(L<=.03928?L/12.92:Math.pow((L+.055)/1.055,2.4))+.0722*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))}v.relativeLuminance=function(O){return S(O>>16&255,O>>8&255,255&O)},v.relativeLuminance2=S}(y=u.rgb||(u.rgb={})),function(v){function S(w,A,I){const L=w>>24&255,x=w>>16&255,B=w>>8&255;let H=A>>24&255,F=A>>16&255,X=A>>8&255,Z=R(y.relativeLuminance2(H,F,X),y.relativeLuminance2(L,x,B));for(;Z<I&&(H>0||F>0||X>0);)H-=Math.max(0,Math.ceil(.1*H)),F-=Math.max(0,Math.ceil(.1*F)),X-=Math.max(0,Math.ceil(.1*X)),Z=R(y.relativeLuminance2(H,F,X),y.relativeLuminance2(L,x,B));return(H<<24|F<<16|X<<8|255)>>>0}function O(w,A,I){const L=w>>24&255,x=w>>16&255,B=w>>8&255;let H=A>>24&255,F=A>>16&255,X=A>>8&255,Z=R(y.relativeLuminance2(H,F,X),y.relativeLuminance2(L,x,B));for(;Z<I&&(H<255||F<255||X<255);)H=Math.min(255,H+Math.ceil(.1*(255-H))),F=Math.min(255,F+Math.ceil(.1*(255-F))),X=Math.min(255,X+Math.ceil(.1*(255-X))),Z=R(y.relativeLuminance2(H,F,X),y.relativeLuminance2(L,x,B));return(H<<24|F<<16|X<<8|255)>>>0}v.ensureContrastRatio=function(w,A,I){const L=y.relativeLuminance(w>>8),x=y.relativeLuminance(A>>8);if(R(L,x)<I){if(x<L){const F=S(w,A,I),X=R(L,y.relativeLuminance(F>>8));if(X<I){const Z=O(w,A,I);return X>R(L,y.relativeLuminance(Z>>8))?F:Z}return F}const B=O(w,A,I),H=R(L,y.relativeLuminance(B>>8));if(H<I){const F=S(w,A,I);return H>R(L,y.relativeLuminance(F>>8))?B:F}return B}},v.reduceLuminance=S,v.increaseLuminance=O,v.toChannels=function(w){return[w>>24&255,w>>16&255,w>>8&255,255&w]},v.toColor=function(w,A,I,L){return{css:T.toCss(w,A,I,L),rgba:T.toRgba(w,A,I,L)}}}(g=u.rgba||(u.rgba={})),u.toPaddedHex=$,u.contrastRatio=R},8969:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CoreTerminal=void 0;const c=p(844),_=p(2585),m=p(4348),E=p(7866),b=p(744),T=p(7302),y=p(6975),g=p(8460),$=p(1753),R=p(1480),v=p(7994),S=p(9282),O=p(5435),w=p(5981),A=p(2660);let I=false;class L extends c.Disposable{constructor(B){super(),this._onBinary=this.register(new g.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new g.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new g.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new g.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new g.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new g.EventEmitter),this._instantiationService=new m.InstantiationService,this.optionsService=this.register(new T.OptionsService(B)),this._instantiationService.setService(_.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(b.BufferService)),this._instantiationService.setService(_.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(E.LogService)),this._instantiationService.setService(_.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(y.CoreService)),this._instantiationService.setService(_.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance($.CoreMouseService)),this._instantiationService.setService(_.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(R.UnicodeService)),this._instantiationService.setService(_.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(v.CharsetService),this._instantiationService.setService(_.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(A.OscLinkService),this._instantiationService.setService(_.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new O.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,g.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,g.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,g.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,g.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",H=>this._handleWindowsModeOptionChange(H))),this.register(this._bufferService.onScroll(H=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(H=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new w.WriteBuffer((H,F)=>this._inputHandler.parse(H,F))),this.register((0,g.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,c.toDisposable)(()=>{var H;(H=this._windowsMode)===null||H===void 0||H.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new g.EventEmitter),this._onScroll.event(B=>{var H;(H=this._onScrollApi)===null||H===void 0||H.fire(B.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(B){for(const H in B)this.optionsService.options[H]=B[H]}write(B,H){this._writeBuffer.write(B,H)}writeSync(B,H){this._logService.logLevel<=_.LogLevelEnum.WARN&&!I&&(this._logService.warn("writeSync is unreliable and will be removed soon."),I=true),this._writeBuffer.writeSync(B,H)}resize(B,H){isNaN(B)||isNaN(H)||(B=Math.max(B,b.MINIMUM_COLS),H=Math.max(H,b.MINIMUM_ROWS),this._bufferService.resize(B,H))}scroll(B,H=false){this._bufferService.scroll(B,H)}scrollLines(B,H,F){this._bufferService.scrollLines(B,H,F)}scrollPages(B){this._bufferService.scrollPages(B)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(B){this._bufferService.scrollToLine(B)}registerEscHandler(B,H){return this._inputHandler.registerEscHandler(B,H)}registerDcsHandler(B,H){return this._inputHandler.registerDcsHandler(B,H)}registerCsiHandler(B,H){return this._inputHandler.registerCsiHandler(B,H)}registerOscHandler(B,H){return this._inputHandler.registerOscHandler(B,H)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(B){var H;B?this._enableWindowsMode():((H=this._windowsMode)===null||H===void 0||H.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){const B=[];B.push(this.onLineFeed(S.updateWindowsModeWrappedState.bind(null,this._bufferService))),B.push(this.registerCsiHandler({final:"H"},()=>((0,S.updateWindowsModeWrappedState)(this._bufferService),false))),this._windowsMode={dispose:()=>{for(const H of B)H.dispose()}}}}}u.CoreTerminal=L},8460:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.forwardEvent=u.EventEmitter=void 0,u.EventEmitter=class{constructor(){this._listeners=[],this._disposed=false}get event(){return this._event||(this._event=p=>(this._listeners.push(p),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===p)return void this._listeners.splice(c,1)}}})),this._event}fire(p,c){const _=[];for(let m=0;m<this._listeners.length;m++)_.push(this._listeners[m]);for(let m=0;m<_.length;m++)_[m].call(void 0,p,c)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=true}},u.forwardEvent=function(p,c){return p(_=>c.fire(_))}},5435:function(f,u,p){var c=this&&this.__decorate||function(J,D,P,V){var j,re=arguments.length,G=re<3?D:V===null?V=Object.getOwnPropertyDescriptor(D,P):V;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")G=Reflect.decorate(J,D,P,V);else for(var ae=J.length-1;ae>=0;ae--)(j=J[ae])&&(G=(re<3?j(G):re>3?j(D,P,G):j(D,P))||G);return re>3&&G&&Object.defineProperty(D,P,G),G},_=this&&this.__param||function(J,D){return function(P,V){D(P,V,J)}};Object.defineProperty(u,"__esModule",{value:true}),u.InputHandler=u.WindowsOptionsReportType=void 0;const m=p(2584),E=p(7116),b=p(2015),T=p(844),y=p(482),g=p(8437),$=p(8460),R=p(643),v=p(511),S=p(3734),O=p(2585),w=p(6242),A=p(6351),I=p(5941),L={"(":0,")":1,"*":2,"+":3,"-":1,".":2},x=131072;function B(J,D){if(J>24)return D.setWinLines||false;switch(J){case 1:return!!D.restoreWin;case 2:return!!D.minimizeWin;case 3:return!!D.setWinPosition;case 4:return!!D.setWinSizePixels;case 5:return!!D.raiseWin;case 6:return!!D.lowerWin;case 7:return!!D.refreshWin;case 8:return!!D.setWinSizeChars;case 9:return!!D.maximizeWin;case 10:return!!D.fullscreenWin;case 11:return!!D.getWinState;case 13:return!!D.getWinPosition;case 14:return!!D.getWinSizePixels;case 15:return!!D.getScreenSizePixels;case 16:return!!D.getCellSizePixels;case 18:return!!D.getWinSizeChars;case 19:return!!D.getScreenSizeChars;case 20:return!!D.getIconTitle;case 21:return!!D.getWinTitle;case 22:return!!D.pushTitle;case 23:return!!D.popTitle;case 24:return!!D.setWinLines}return false}var H;(function(J){J[J.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",J[J.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(H=u.WindowsOptionsReportType||(u.WindowsOptionsReportType={}));let F=0;class X extends T.Disposable{constructor(D,P,V,j,re,G,ae,de,fe=new b.EscapeSequenceParser){super(),this._bufferService=D,this._charsetService=P,this._coreService=V,this._logService=j,this._optionsService=re,this._oscLinkService=G,this._coreMouseService=ae,this._unicodeService=de,this._parser=fe,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new y.StringToUtf32,this._utf8Decoder=new y.Utf8ToUtf32,this._workCell=new v.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=g.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=g.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new $.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new $.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new $.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new $.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new $.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new $.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new $.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new $.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new $.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new $.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new $.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new $.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new $.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:false,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new Z(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(ee=>this._activeBuffer=ee.activeBuffer)),this._parser.setCsiHandlerFallback((ee,W)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(ee),params:W.toArray()})}),this._parser.setEscHandlerFallback(ee=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(ee)})}),this._parser.setExecuteHandlerFallback(ee=>{this._logService.debug("Unknown EXECUTE code: ",{code:ee})}),this._parser.setOscHandlerFallback((ee,W,Q)=>{this._logService.debug("Unknown OSC code: ",{identifier:ee,action:W,data:Q})}),this._parser.setDcsHandlerFallback((ee,W,Q)=>{W==="HOOK"&&(Q=Q.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(ee),action:W,payload:Q})}),this._parser.setPrintHandler((ee,W,Q)=>this.print(ee,W,Q)),this._parser.registerCsiHandler({final:"@"},ee=>this.insertChars(ee)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},ee=>this.scrollLeft(ee)),this._parser.registerCsiHandler({final:"A"},ee=>this.cursorUp(ee)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},ee=>this.scrollRight(ee)),this._parser.registerCsiHandler({final:"B"},ee=>this.cursorDown(ee)),this._parser.registerCsiHandler({final:"C"},ee=>this.cursorForward(ee)),this._parser.registerCsiHandler({final:"D"},ee=>this.cursorBackward(ee)),this._parser.registerCsiHandler({final:"E"},ee=>this.cursorNextLine(ee)),this._parser.registerCsiHandler({final:"F"},ee=>this.cursorPrecedingLine(ee)),this._parser.registerCsiHandler({final:"G"},ee=>this.cursorCharAbsolute(ee)),this._parser.registerCsiHandler({final:"H"},ee=>this.cursorPosition(ee)),this._parser.registerCsiHandler({final:"I"},ee=>this.cursorForwardTab(ee)),this._parser.registerCsiHandler({final:"J"},ee=>this.eraseInDisplay(ee,false)),this._parser.registerCsiHandler({prefix:"?",final:"J"},ee=>this.eraseInDisplay(ee,true)),this._parser.registerCsiHandler({final:"K"},ee=>this.eraseInLine(ee,false)),this._parser.registerCsiHandler({prefix:"?",final:"K"},ee=>this.eraseInLine(ee,true)),this._parser.registerCsiHandler({final:"L"},ee=>this.insertLines(ee)),this._parser.registerCsiHandler({final:"M"},ee=>this.deleteLines(ee)),this._parser.registerCsiHandler({final:"P"},ee=>this.deleteChars(ee)),this._parser.registerCsiHandler({final:"S"},ee=>this.scrollUp(ee)),this._parser.registerCsiHandler({final:"T"},ee=>this.scrollDown(ee)),this._parser.registerCsiHandler({final:"X"},ee=>this.eraseChars(ee)),this._parser.registerCsiHandler({final:"Z"},ee=>this.cursorBackwardTab(ee)),this._parser.registerCsiHandler({final:"`"},ee=>this.charPosAbsolute(ee)),this._parser.registerCsiHandler({final:"a"},ee=>this.hPositionRelative(ee)),this._parser.registerCsiHandler({final:"b"},ee=>this.repeatPrecedingCharacter(ee)),this._parser.registerCsiHandler({final:"c"},ee=>this.sendDeviceAttributesPrimary(ee)),this._parser.registerCsiHandler({prefix:">",final:"c"},ee=>this.sendDeviceAttributesSecondary(ee)),this._parser.registerCsiHandler({final:"d"},ee=>this.linePosAbsolute(ee)),this._parser.registerCsiHandler({final:"e"},ee=>this.vPositionRelative(ee)),this._parser.registerCsiHandler({final:"f"},ee=>this.hVPosition(ee)),this._parser.registerCsiHandler({final:"g"},ee=>this.tabClear(ee)),this._parser.registerCsiHandler({final:"h"},ee=>this.setMode(ee)),this._parser.registerCsiHandler({prefix:"?",final:"h"},ee=>this.setModePrivate(ee)),this._parser.registerCsiHandler({final:"l"},ee=>this.resetMode(ee)),this._parser.registerCsiHandler({prefix:"?",final:"l"},ee=>this.resetModePrivate(ee)),this._parser.registerCsiHandler({final:"m"},ee=>this.charAttributes(ee)),this._parser.registerCsiHandler({final:"n"},ee=>this.deviceStatus(ee)),this._parser.registerCsiHandler({prefix:"?",final:"n"},ee=>this.deviceStatusPrivate(ee)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},ee=>this.softReset(ee)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},ee=>this.setCursorStyle(ee)),this._parser.registerCsiHandler({final:"r"},ee=>this.setScrollRegion(ee)),this._parser.registerCsiHandler({final:"s"},ee=>this.saveCursor(ee)),this._parser.registerCsiHandler({final:"t"},ee=>this.windowOptions(ee)),this._parser.registerCsiHandler({final:"u"},ee=>this.restoreCursor(ee)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},ee=>this.insertColumns(ee)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},ee=>this.deleteColumns(ee)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},ee=>this.selectProtected(ee)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},ee=>this.requestMode(ee,true)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},ee=>this.requestMode(ee,false)),this._parser.setExecuteHandler(m.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(m.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(m.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(m.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(m.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(m.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(m.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(m.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(m.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(m.C1.IND,()=>this.index()),this._parser.setExecuteHandler(m.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(m.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new w.OscHandler(ee=>(this.setTitle(ee),this.setIconName(ee),true))),this._parser.registerOscHandler(1,new w.OscHandler(ee=>this.setIconName(ee))),this._parser.registerOscHandler(2,new w.OscHandler(ee=>this.setTitle(ee))),this._parser.registerOscHandler(4,new w.OscHandler(ee=>this.setOrReportIndexedColor(ee))),this._parser.registerOscHandler(8,new w.OscHandler(ee=>this.setHyperlink(ee))),this._parser.registerOscHandler(10,new w.OscHandler(ee=>this.setOrReportFgColor(ee))),this._parser.registerOscHandler(11,new w.OscHandler(ee=>this.setOrReportBgColor(ee))),this._parser.registerOscHandler(12,new w.OscHandler(ee=>this.setOrReportCursorColor(ee))),this._parser.registerOscHandler(104,new w.OscHandler(ee=>this.restoreIndexedColor(ee))),this._parser.registerOscHandler(110,new w.OscHandler(ee=>this.restoreFgColor(ee))),this._parser.registerOscHandler(111,new w.OscHandler(ee=>this.restoreBgColor(ee))),this._parser.registerOscHandler(112,new w.OscHandler(ee=>this.restoreCursorColor(ee))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const ee in E.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:ee},()=>this.selectCharset("("+ee)),this._parser.registerEscHandler({intermediates:")",final:ee},()=>this.selectCharset(")"+ee)),this._parser.registerEscHandler({intermediates:"*",final:ee},()=>this.selectCharset("*"+ee)),this._parser.registerEscHandler({intermediates:"+",final:ee},()=>this.selectCharset("+"+ee)),this._parser.registerEscHandler({intermediates:"-",final:ee},()=>this.selectCharset("-"+ee)),this._parser.registerEscHandler({intermediates:".",final:ee},()=>this.selectCharset("."+ee)),this._parser.registerEscHandler({intermediates:"/",final:ee},()=>this.selectCharset("/"+ee));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(ee=>(this._logService.error("Parsing error: ",ee),ee)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new A.DcsHandler((ee,W)=>this.requestStatusString(ee,W)))}getAttrData(){return this._curAttrData}_preserveStack(D,P,V,j){this._parseStack.paused=true,this._parseStack.cursorStartX=D,this._parseStack.cursorStartY=P,this._parseStack.decodedLength=V,this._parseStack.position=j}_logSlowResolvingAsync(D){this._logService.logLevel<=O.LogLevelEnum.WARN&&Promise.race([D,new Promise((P,V)=>setTimeout(()=>V("#SLOW_TIMEOUT"),5e3))]).catch(P=>{if(P!=="#SLOW_TIMEOUT")throw P;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(D,P){let V,j=this._activeBuffer.x,re=this._activeBuffer.y,G=0;const ae=this._parseStack.paused;if(ae){if(V=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,P))return this._logSlowResolvingAsync(V),V;j=this._parseStack.cursorStartX,re=this._parseStack.cursorStartY,this._parseStack.paused=false,D.length>x&&(G=this._parseStack.position+x)}if(this._logService.logLevel<=O.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof D=="string"?` "${D}"`:` "${Array.prototype.map.call(D,de=>String.fromCharCode(de)).join("")}"`),typeof D=="string"?D.split("").map(de=>de.charCodeAt(0)):D),this._parseBuffer.length<D.length&&this._parseBuffer.length<x&&(this._parseBuffer=new Uint32Array(Math.min(D.length,x))),ae||this._dirtyRowTracker.clearRange(),D.length>x)for(let de=G;de<D.length;de+=x){const fe=de+x<D.length?de+x:D.length,ee=typeof D=="string"?this._stringDecoder.decode(D.substring(de,fe),this._parseBuffer):this._utf8Decoder.decode(D.subarray(de,fe),this._parseBuffer);if(V=this._parser.parse(this._parseBuffer,ee))return this._preserveStack(j,re,ee,de),this._logSlowResolvingAsync(V),V}else if(!ae){const de=typeof D=="string"?this._stringDecoder.decode(D,this._parseBuffer):this._utf8Decoder.decode(D,this._parseBuffer);if(V=this._parser.parse(this._parseBuffer,de))return this._preserveStack(j,re,de,0),this._logSlowResolvingAsync(V),V}this._activeBuffer.x===j&&this._activeBuffer.y===re||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(D,P,V){let j,re;const G=this._charsetService.charset,ae=this._optionsService.rawOptions.screenReaderMode,de=this._bufferService.cols,fe=this._coreService.decPrivateModes.wraparound,ee=this._coreService.modes.insertMode,W=this._curAttrData;let Q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&V-P>0&&Q.getWidth(this._activeBuffer.x-1)===2&&Q.setCellFromCodePoint(this._activeBuffer.x-1,0,1,W.fg,W.bg,W.extended);for(let ce=P;ce<V;++ce){if(j=D[ce],re=this._unicodeService.wcwidth(j),j<127&&G){const Ee=G[String.fromCharCode(j)];Ee&&(j=Ee.charCodeAt(0))}if(ae&&this._onA11yChar.fire((0,y.stringFromCodePoint)(j)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),re||!this._activeBuffer.x){if(this._activeBuffer.x+re-1>=de){if(fe){for(;this._activeBuffer.x<de;)Q.setCellFromCodePoint(this._activeBuffer.x++,0,1,W.fg,W.bg,W.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),true)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=true),Q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=de-1,re===2)continue}if(ee&&(Q.insertCells(this._activeBuffer.x,re,this._activeBuffer.getNullCell(W),W),Q.getWidth(de-1)===2&&Q.setCellFromCodePoint(de-1,R.NULL_CELL_CODE,R.NULL_CELL_WIDTH,W.fg,W.bg,W.extended)),Q.setCellFromCodePoint(this._activeBuffer.x++,j,re,W.fg,W.bg,W.extended),re>0)for(;--re;)Q.setCellFromCodePoint(this._activeBuffer.x++,0,0,W.fg,W.bg,W.extended)}else Q.getWidth(this._activeBuffer.x-1)?Q.addCodepointToCell(this._activeBuffer.x-1,j):Q.addCodepointToCell(this._activeBuffer.x-2,j)}V-P>0&&(Q.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<de&&V-P>0&&Q.getWidth(this._activeBuffer.x)===0&&!Q.hasContent(this._activeBuffer.x)&&Q.setCellFromCodePoint(this._activeBuffer.x,0,1,W.fg,W.bg,W.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(D,P){return D.final!=="t"||D.prefix||D.intermediates?this._parser.registerCsiHandler(D,P):this._parser.registerCsiHandler(D,V=>!B(V.params[0],this._optionsService.rawOptions.windowOptions)||P(V))}registerDcsHandler(D,P){return this._parser.registerDcsHandler(D,new A.DcsHandler(P))}registerEscHandler(D,P){return this._parser.registerEscHandler(D,P)}registerOscHandler(D,P){return this._parser.registerOscHandler(D,new w.OscHandler(P))}bell(){return this._onRequestBell.fire(),true}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),true}carriageReturn(){return this._activeBuffer.x=0,true}backspace(){var D;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,true;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((D=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||D===void 0)&&D.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=false,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);P.hasWidth(this._activeBuffer.x)&&!P.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),true}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return true;const D=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-D),true}shiftOut(){return this._charsetService.setgLevel(1),true}shiftIn(){return this._charsetService.setgLevel(0),true}_restrictCursor(D=this._bufferService.cols-1){this._activeBuffer.x=Math.min(D,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(D,P){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=D,this._activeBuffer.y=this._activeBuffer.scrollTop+P):(this._activeBuffer.x=D,this._activeBuffer.y=P),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(D,P){this._restrictCursor(),this._setCursor(this._activeBuffer.x+D,this._activeBuffer.y+P)}cursorUp(D){const P=this._activeBuffer.y-this._activeBuffer.scrollTop;return P>=0?this._moveCursor(0,-Math.min(P,D.params[0]||1)):this._moveCursor(0,-(D.params[0]||1)),true}cursorDown(D){const P=this._activeBuffer.scrollBottom-this._activeBuffer.y;return P>=0?this._moveCursor(0,Math.min(P,D.params[0]||1)):this._moveCursor(0,D.params[0]||1),true}cursorForward(D){return this._moveCursor(D.params[0]||1,0),true}cursorBackward(D){return this._moveCursor(-(D.params[0]||1),0),true}cursorNextLine(D){return this.cursorDown(D),this._activeBuffer.x=0,true}cursorPrecedingLine(D){return this.cursorUp(D),this._activeBuffer.x=0,true}cursorCharAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),true}cursorPosition(D){return this._setCursor(D.length>=2?(D.params[1]||1)-1:0,(D.params[0]||1)-1),true}charPosAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),true}hPositionRelative(D){return this._moveCursor(D.params[0]||1,0),true}linePosAbsolute(D){return this._setCursor(this._activeBuffer.x,(D.params[0]||1)-1),true}vPositionRelative(D){return this._moveCursor(0,D.params[0]||1),true}hVPosition(D){return this.cursorPosition(D),true}tabClear(D){const P=D.params[0];return P===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:P===3&&(this._activeBuffer.tabs={}),true}cursorForwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return true;let P=D.params[0]||1;for(;P--;)this._activeBuffer.x=this._activeBuffer.nextStop();return true}cursorBackwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return true;let P=D.params[0]||1;for(;P--;)this._activeBuffer.x=this._activeBuffer.prevStop();return true}selectProtected(D){const P=D.params[0];return P===1&&(this._curAttrData.bg|=536870912),P!==2&&P!==0||(this._curAttrData.bg&=-536870913),true}_eraseInBufferLine(D,P,V,j=false,re=false){const G=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);G.replaceCells(P,V,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),re),j&&(G.isWrapped=false)}_resetBufferLine(D,P=false){const V=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);V.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),P),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+D),V.isWrapped=false}eraseInDisplay(D,P=false){let V;switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:for(V=this._activeBuffer.y,this._dirtyRowTracker.markDirty(V),this._eraseInBufferLine(V++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,P);V<this._bufferService.rows;V++)this._resetBufferLine(V,P);this._dirtyRowTracker.markDirty(V);break;case 1:for(V=this._activeBuffer.y,this._dirtyRowTracker.markDirty(V),this._eraseInBufferLine(V,0,this._activeBuffer.x+1,true,P),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(V+1).isWrapped=false);V--;)this._resetBufferLine(V,P);this._dirtyRowTracker.markDirty(0);break;case 2:for(V=this._bufferService.rows,this._dirtyRowTracker.markDirty(V-1);V--;)this._resetBufferLine(V,P);this._dirtyRowTracker.markDirty(0);break;case 3:const j=this._activeBuffer.lines.length-this._bufferService.rows;j>0&&(this._activeBuffer.lines.trimStart(j),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-j,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-j,0),this._onScroll.fire(0))}return true}eraseInLine(D,P=false){switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,P);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,false,P);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,true,P)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),true}insertLines(D){this._restrictCursor();let P=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const V=this._activeBuffer.ybase+this._activeBuffer.y,j=this._bufferService.rows-1-this._activeBuffer.scrollBottom,re=this._bufferService.rows-1+this._activeBuffer.ybase-j+1;for(;P--;)this._activeBuffer.lines.splice(re-1,1),this._activeBuffer.lines.splice(V,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,true}deleteLines(D){this._restrictCursor();let P=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const V=this._activeBuffer.ybase+this._activeBuffer.y;let j;for(j=this._bufferService.rows-1-this._activeBuffer.scrollBottom,j=this._bufferService.rows-1+this._activeBuffer.ybase-j;P--;)this._activeBuffer.lines.splice(V,1),this._activeBuffer.lines.splice(j,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,true}insertChars(D){this._restrictCursor();const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return P&&(P.insertCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),true}deleteChars(D){this._restrictCursor();const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return P&&(P.deleteCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),true}scrollUp(D){let P=D.params[0]||1;for(;P--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}scrollDown(D){let P=D.params[0]||1;for(;P--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(g.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}scrollLeft(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const P=D.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);j.deleteCells(0,P,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),j.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}scrollRight(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const P=D.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);j.insertCells(0,P,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),j.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}insertColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const P=D.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);j.insertCells(this._activeBuffer.x,P,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),j.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}deleteColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const P=D.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);j.deleteCells(this._activeBuffer.x,P,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),j.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}eraseChars(D){this._restrictCursor();const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return P&&(P.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(D.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),true}repeatPrecedingCharacter(D){if(!this._parser.precedingCodepoint)return true;const P=D.params[0]||1,V=new Uint32Array(P);for(let j=0;j<P;++j)V[j]=this._parser.precedingCodepoint;return this.print(V,0,V.length),true}sendDeviceAttributesPrimary(D){return D.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(m.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(m.C0.ESC+"[?6c")),true}sendDeviceAttributesSecondary(D){return D.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(m.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(m.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(D.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(m.C0.ESC+"[>83;40003;0c")),true}_is(D){return(this._optionsService.rawOptions.termName+"").indexOf(D)===0}setMode(D){for(let P=0;P<D.length;P++)switch(D.params[P]){case 4:this._coreService.modes.insertMode=true;break;case 20:this._optionsService.options.convertEol=true}return true}setModePrivate(D){for(let P=0;P<D.length;P++)switch(D.params[P]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=true;break;case 2:this._charsetService.setgCharset(0,E.DEFAULT_CHARSET),this._charsetService.setgCharset(1,E.DEFAULT_CHARSET),this._charsetService.setgCharset(2,E.DEFAULT_CHARSET),this._charsetService.setgCharset(3,E.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=true,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=true;break;case 12:this._optionsService.options.cursorBlink=true;break;case 45:this._coreService.decPrivateModes.reverseWraparound=true;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=true,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=true,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=false;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=true,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=true}return true}resetMode(D){for(let P=0;P<D.length;P++)switch(D.params[P]){case 4:this._coreService.modes.insertMode=false;break;case 20:this._optionsService.options.convertEol=false}return true}resetModePrivate(D){for(let P=0;P<D.length;P++)switch(D.params[P]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=false;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=false,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=false;break;case 12:this._optionsService.options.cursorBlink=false;break;case 45:this._coreService.decPrivateModes.reverseWraparound=false;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=false,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=false;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=true;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),D.params[P]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=true,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=false}return true}requestMode(D,P){const V=this._coreService.decPrivateModes,{activeProtocol:j,activeEncoding:re}=this._coreMouseService,G=this._coreService,{buffers:ae,cols:de}=this._bufferService,{active:fe,alt:ee}=ae,W=this._optionsService.rawOptions,Q=Re=>Re?1:2,ce=D.params[0];return Ee=ce,Xe=P?ce===2?3:ce===4?Q(G.modes.insertMode):ce===12?4:ce===20?Q(W.convertEol):0:ce===1?Q(V.applicationCursorKeys):ce===3?W.windowOptions.setWinLines?de===80?2:de===132?1:0:0:ce===6?Q(V.origin):ce===7?Q(V.wraparound):ce===8?3:ce===9?Q(j==="X10"):ce===12?Q(W.cursorBlink):ce===25?Q(!G.isCursorHidden):ce===45?Q(V.reverseWraparound):ce===66?Q(V.applicationKeypad):ce===1e3?Q(j==="VT200"):ce===1002?Q(j==="DRAG"):ce===1003?Q(j==="ANY"):ce===1004?Q(V.sendFocus):ce===1005?4:ce===1006?Q(re==="SGR"):ce===1015?4:ce===1016?Q(re==="SGR_PIXELS"):ce===1048?1:ce===47||ce===1047||ce===1049?Q(fe===ee):ce===2004?Q(V.bracketedPasteMode):0,G.triggerDataEvent(`${m.C0.ESC}[${P?"":"?"}${Ee};${Xe}$y`),true;var Ee,Xe}_updateAttrColor(D,P,V,j,re){return P===2?(D|=50331648,D&=-16777216,D|=S.AttributeData.fromColorRGB([V,j,re])):P===5&&(D&=-50331904,D|=33554432|255&V),D}_extractColor(D,P,V){const j=[0,0,-1,0,0,0];let re=0,G=0;do{if(j[G+re]=D.params[P+G],D.hasSubParams(P+G)){const ae=D.getSubParams(P+G);let de=0;do j[1]===5&&(re=1),j[G+de+1+re]=ae[de];while(++de<ae.length&&de+G+1+re<j.length);break}if(j[1]===5&&G+re>=2||j[1]===2&&G+re>=5)break;j[1]&&(re=1)}while(++G+P<D.length&&G+re<j.length);for(let ae=2;ae<j.length;++ae)j[ae]===-1&&(j[ae]=0);switch(j[0]){case 38:V.fg=this._updateAttrColor(V.fg,j[1],j[3],j[4],j[5]);break;case 48:V.bg=this._updateAttrColor(V.bg,j[1],j[3],j[4],j[5]);break;case 58:V.extended=V.extended.clone(),V.extended.underlineColor=this._updateAttrColor(V.extended.underlineColor,j[1],j[3],j[4],j[5])}return G}_processUnderline(D,P){P.extended=P.extended.clone(),(!~D||D>5)&&(D=1),P.extended.underlineStyle=D,P.fg|=268435456,D===0&&(P.fg&=-268435457),P.updateExtended()}_processSGR0(D){D.fg=g.DEFAULT_ATTR_DATA.fg,D.bg=g.DEFAULT_ATTR_DATA.bg,D.extended=D.extended.clone(),D.extended.underlineStyle=0,D.extended.underlineColor&=-67108864,D.updateExtended()}charAttributes(D){if(D.length===1&&D.params[0]===0)return this._processSGR0(this._curAttrData),true;const P=D.length;let V;const j=this._curAttrData;for(let re=0;re<P;re++)V=D.params[re],V>=30&&V<=37?(j.fg&=-50331904,j.fg|=16777216|V-30):V>=40&&V<=47?(j.bg&=-50331904,j.bg|=16777216|V-40):V>=90&&V<=97?(j.fg&=-50331904,j.fg|=16777224|V-90):V>=100&&V<=107?(j.bg&=-50331904,j.bg|=16777224|V-100):V===0?this._processSGR0(j):V===1?j.fg|=134217728:V===3?j.bg|=67108864:V===4?(j.fg|=268435456,this._processUnderline(D.hasSubParams(re)?D.getSubParams(re)[0]:1,j)):V===5?j.fg|=536870912:V===7?j.fg|=67108864:V===8?j.fg|=1073741824:V===9?j.fg|=2147483648:V===2?j.bg|=134217728:V===21?this._processUnderline(2,j):V===22?(j.fg&=-134217729,j.bg&=-134217729):V===23?j.bg&=-67108865:V===24?(j.fg&=-268435457,this._processUnderline(0,j)):V===25?j.fg&=-536870913:V===27?j.fg&=-67108865:V===28?j.fg&=-1073741825:V===29?j.fg&=2147483647:V===39?(j.fg&=-67108864,j.fg|=16777215&g.DEFAULT_ATTR_DATA.fg):V===49?(j.bg&=-67108864,j.bg|=16777215&g.DEFAULT_ATTR_DATA.bg):V===38||V===48||V===58?re+=this._extractColor(D,re,j):V===59?(j.extended=j.extended.clone(),j.extended.underlineColor=-1,j.updateExtended()):V===100?(j.fg&=-67108864,j.fg|=16777215&g.DEFAULT_ATTR_DATA.fg,j.bg&=-67108864,j.bg|=16777215&g.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",V);return true}deviceStatus(D){switch(D.params[0]){case 5:this._coreService.triggerDataEvent(`${m.C0.ESC}[0n`);break;case 6:const P=this._activeBuffer.y+1,V=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${m.C0.ESC}[${P};${V}R`)}return true}deviceStatusPrivate(D){if(D.params[0]===6){const P=this._activeBuffer.y+1,V=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${m.C0.ESC}[?${P};${V}R`)}return true}softReset(D){return this._coreService.isCursorHidden=false,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=g.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=false,true}setCursorStyle(D){const P=D.params[0]||1;switch(P){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const V=P%2==1;return this._optionsService.options.cursorBlink=V,true}setScrollRegion(D){const P=D.params[0]||1;let V;return(D.length<2||(V=D.params[1])>this._bufferService.rows||V===0)&&(V=this._bufferService.rows),V>P&&(this._activeBuffer.scrollTop=P-1,this._activeBuffer.scrollBottom=V-1,this._setCursor(0,0)),true}windowOptions(D){if(!B(D.params[0],this._optionsService.rawOptions.windowOptions))return true;const P=D.length>1?D.params[1]:0;switch(D.params[0]){case 14:P!==2&&this._onRequestWindowsOptionsReport.fire(H.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(H.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${m.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:P!==0&&P!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),P!==0&&P!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:P!==0&&P!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),P!==0&&P!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return true}saveCursor(D){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,true}restoreCursor(D){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),true}setTitle(D){return this._windowTitle=D,this._onTitleChange.fire(D),true}setIconName(D){return this._iconName=D,true}setOrReportIndexedColor(D){const P=[],V=D.split(";");for(;V.length>1;){const j=V.shift(),re=V.shift();if(/^\d+$/.exec(j)){const G=parseInt(j);if(0<=G&&G<256)if(re==="?")P.push({type:0,index:G});else{const ae=(0,I.parseColor)(re);ae&&P.push({type:1,index:G,color:ae})}}}return P.length&&this._onColor.fire(P),true}setHyperlink(D){const P=D.split(";");return!(P.length<2)&&(P[1]?this._createHyperlink(P[0],P[1]):!P[0]&&this._finishHyperlink())}_createHyperlink(D,P){this._getCurrentLinkId()&&this._finishHyperlink();const V=D.split(":");let j;const re=V.findIndex(G=>G.startsWith("id="));return re!==-1&&(j=V[re].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:j,uri:P}),this._curAttrData.updateExtended(),true}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),true}_setOrReportSpecialColor(D,P){const V=D.split(";");for(let j=0;j<V.length&&!(P>=this._specialColors.length);++j,++P)if(V[j]==="?")this._onColor.fire([{type:0,index:this._specialColors[P]}]);else{const re=(0,I.parseColor)(V[j]);re&&this._onColor.fire([{type:1,index:this._specialColors[P],color:re}])}return true}setOrReportFgColor(D){return this._setOrReportSpecialColor(D,0)}setOrReportBgColor(D){return this._setOrReportSpecialColor(D,1)}setOrReportCursorColor(D){return this._setOrReportSpecialColor(D,2)}restoreIndexedColor(D){if(!D)return this._onColor.fire([{type:2}]),true;const P=[],V=D.split(";");for(let j=0;j<V.length;++j)if(/^\d+$/.exec(V[j])){const re=parseInt(V[j]);0<=re&&re<256&&P.push({type:2,index:re})}return P.length&&this._onColor.fire(P),true}restoreFgColor(D){return this._onColor.fire([{type:2,index:256}]),true}restoreBgColor(D){return this._onColor.fire([{type:2,index:257}]),true}restoreCursorColor(D){return this._onColor.fire([{type:2,index:258}]),true}nextLine(){return this._activeBuffer.x=0,this.index(),true}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=true,this._onRequestSyncScrollBar.fire(),true}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=false,this._onRequestSyncScrollBar.fire(),true}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,E.DEFAULT_CHARSET),true}selectCharset(D){return D.length!==2?(this.selectDefaultCharset(),true):(D[0]==="/"||this._charsetService.setgCharset(L[D[0]],E.CHARSETS[D[1]]||E.DEFAULT_CHARSET),true)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),true}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=true,true}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const D=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,D,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return true}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),true}reset(){this._curAttrData=g.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=g.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(D){return this._charsetService.setgLevel(D),true}screenAlignmentPattern(){const D=new v.CellData;D.content=4194304|"E".charCodeAt(0),D.fg=this._curAttrData.fg,D.bg=this._curAttrData.bg,this._setCursor(0,0);for(let P=0;P<this._bufferService.rows;++P){const V=this._activeBuffer.ybase+this._activeBuffer.y+P,j=this._activeBuffer.lines.get(V);j&&(j.fill(D),j.isWrapped=false)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),true}requestStatusString(D,P){const V=this._bufferService.buffer,j=this._optionsService.rawOptions;return(re=>(this._coreService.triggerDataEvent(`${m.C0.ESC}${re}${m.C0.ESC}\\`),true))(D==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:D==='"p'?'P1$r61;1"p':D==="r"?`P1$r${V.scrollTop+1};${V.scrollBottom+1}r`:D==="m"?"P1$r0m":D===" q"?`P1$r${{block:2,underline:4,bar:6}[j.cursorStyle]-(j.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(D,P){this._dirtyRowTracker.markRangeDirty(D,P)}}u.InputHandler=X;let Z=class{constructor(J){this._bufferService=J,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(J){J<this.start?this.start=J:J>this.end&&(this.end=J)}markRangeDirty(J,D){J>D&&(F=J,J=D,D=F),J<this.start&&(this.start=J),D>this.end&&(this.end=D)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};Z=c([_(0,O.IBufferService)],Z)},844:(f,u)=>{function p(c){for(const _ of c)_.dispose();c.length=0}Object.defineProperty(u,"__esModule",{value:true}),u.getDisposeArrayDisposable=u.disposeArray=u.toDisposable=u.Disposable=void 0,u.Disposable=class{constructor(){this._disposables=[],this._isDisposed=false}dispose(){this._isDisposed=true;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const _=this._disposables.indexOf(c);_!==-1&&this._disposables.splice(_,1)}},u.toDisposable=function(c){return{dispose:c}},u.disposeArray=p,u.getDisposeArrayDisposable=function(c){return{dispose:()=>p(c)}}},1505:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.FourKeyMap=u.TwoKeyMap=void 0;class p{constructor(){this._data={}}set(_,m,E){this._data[_]||(this._data[_]={}),this._data[_][m]=E}get(_,m){return this._data[_]?this._data[_][m]:void 0}clear(){this._data={}}}u.TwoKeyMap=p,u.FourKeyMap=class{constructor(){this._data=new p}set(c,_,m,E,b){this._data.get(c,_)||this._data.set(c,_,new p),this._data.get(c,_).set(m,E,b)}get(c,_,m,E){var b;return(b=this._data.get(c,_))===null||b===void 0?void 0:b.get(m,E)}clear(){this._data.clear()}}},6114:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.isChromeOS=u.isLinux=u.isWindows=u.isIphone=u.isIpad=u.isMac=u.getSafariVersion=u.isSafari=u.isLegacyEdge=u.isFirefox=u.isNode=void 0,u.isNode=typeof navigator>"u";const p=u.isNode?"node":navigator.userAgent,c=u.isNode?"node":navigator.platform;u.isFirefox=p.includes("Firefox"),u.isLegacyEdge=p.includes("Edge"),u.isSafari=/^((?!chrome|android).)*safari/i.test(p),u.getSafariVersion=function(){if(!u.isSafari)return 0;const _=p.match(/Version\/(\d+)/);return _===null||_.length<2?0:parseInt(_[1])},u.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),u.isIpad=c==="iPad",u.isIphone=c==="iPhone",u.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),u.isLinux=c.indexOf("Linux")>=0,u.isChromeOS=/\bCrOS\b/.test(p)},6106:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.SortedList=void 0;let p=0;u.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(p=this._search(this._getKey(c),0,this._array.length-1),this._array.splice(p,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return false;const _=this._getKey(c);if(_===void 0||(p=this._search(_,0,this._array.length-1),p===-1)||this._getKey(this._array[p])!==_)return false;do if(this._array[p]===c)return this._array.splice(p,1),true;while(++p<this._array.length&&this._getKey(this._array[p])===_);return false}*getKeyIterator(c){if(this._array.length!==0&&(p=this._search(c,0,this._array.length-1),!(p<0||p>=this._array.length)&&this._getKey(this._array[p])===c))do yield this._array[p];while(++p<this._array.length&&this._getKey(this._array[p])===c)}forEachByKey(c,_){if(this._array.length!==0&&(p=this._search(c,0,this._array.length-1),!(p<0||p>=this._array.length)&&this._getKey(this._array[p])===c))do _(this._array[p]);while(++p<this._array.length&&this._getKey(this._array[p])===c)}values(){return this._array.values()}_search(c,_,m){if(m<_)return _;let E=Math.floor((_+m)/2);const b=this._getKey(this._array[E]);if(b>c)return this._search(c,_,E-1);if(b<c)return this._search(c,E+1,m);for(;E>0&&this._getKey(this._array[E-1])===c;)E--;return E}}},7226:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DebouncedIdleTask=u.IdleTaskQueue=u.PriorityTaskQueue=void 0;const c=p(6114);class _{constructor(){this._tasks=[],this._i=0}enqueue(b){this._tasks.push(b),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(b){this._idleCallback=void 0;let T=0,y=0,g=b.timeRemaining(),$=0;for(;this._i<this._tasks.length;){if(T=Date.now(),this._tasks[this._i]()||this._i++,T=Math.max(1,Date.now()-T),y=Math.max(T,y),$=b.timeRemaining(),1.5*y>$)return g-T<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(g-T))}ms`),void this._start();g=$}this.clear()}}class m extends _{_requestCallback(b){return setTimeout(()=>b(this._createDeadline(16)))}_cancelCallback(b){clearTimeout(b)}_createDeadline(b){const T=Date.now()+b;return{timeRemaining:()=>Math.max(0,T-Date.now())}}}u.PriorityTaskQueue=m,u.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends _{_requestCallback(E){return requestIdleCallback(E)}_cancelCallback(E){cancelIdleCallback(E)}}:m,u.DebouncedIdleTask=class{constructor(){this._queue=new u.IdleTaskQueue}set(E){this._queue.clear(),this._queue.enqueue(E)}flush(){this._queue.flush()}}},9282:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.updateWindowsModeWrappedState=void 0;const c=p(643);u.updateWindowsModeWrappedState=function(_){const m=_.buffer.lines.get(_.buffer.ybase+_.buffer.y-1),E=m==null?void 0:m.get(_.cols-1),b=_.buffer.lines.get(_.buffer.ybase+_.buffer.y);b&&E&&(b.isWrapped=E[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&E[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ExtendedAttrs=u.AttributeData=void 0;class p{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(m){return[m>>>16&255,m>>>8&255,255&m]}static fromColorRGB(m){return(255&m[0])<<16|(255&m[1])<<8|255&m[2]}clone(){const m=new p;return m.fg=this.fg,m.bg=this.bg,m.extended=this.extended.clone(),m}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}u.AttributeData=p;class c{constructor(m=0,E=0){this._ext=0,this._urlId=0,this._ext=m,this._urlId=E}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(m){this._ext=m}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(m){this._ext&=-469762049,this._ext|=m<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(m){this._ext&=-67108864,this._ext|=67108863&m}get urlId(){return this._urlId}set urlId(m){this._urlId=m}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}u.ExtendedAttrs=c},9092:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferStringIterator=u.Buffer=u.MAX_BUFFER_SIZE=void 0;const c=p(6349),_=p(8437),m=p(511),E=p(643),b=p(4634),T=p(4863),y=p(7116),g=p(3734),$=p(7226);u.MAX_BUFFER_SIZE=4294967295,u.Buffer=class{constructor(v,S,O){this._hasScrollback=v,this._optionsService=S,this._bufferService=O,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=_.DEFAULT_ATTR_DATA.clone(),this.savedCharset=y.DEFAULT_CHARSET,this.markers=[],this._nullCell=m.CellData.fromCharData([0,E.NULL_CELL_CHAR,E.NULL_CELL_WIDTH,E.NULL_CELL_CODE]),this._whitespaceCell=m.CellData.fromCharData([0,E.WHITESPACE_CELL_CHAR,E.WHITESPACE_CELL_WIDTH,E.WHITESPACE_CELL_CODE]),this._isClearing=false,this._memoryCleanupQueue=new $.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(v){return v?(this._nullCell.fg=v.fg,this._nullCell.bg=v.bg,this._nullCell.extended=v.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new g.ExtendedAttrs),this._nullCell}getWhitespaceCell(v){return v?(this._whitespaceCell.fg=v.fg,this._whitespaceCell.bg=v.bg,this._whitespaceCell.extended=v.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new g.ExtendedAttrs),this._whitespaceCell}getBlankLine(v,S){return new _.BufferLine(this._bufferService.cols,this.getNullCell(v),S)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const v=this.ybase+this.y-this.ydisp;return v>=0&&v<this._rows}_getCorrectBufferLength(v){if(!this._hasScrollback)return v;const S=v+this._optionsService.rawOptions.scrollback;return S>u.MAX_BUFFER_SIZE?u.MAX_BUFFER_SIZE:S}fillViewportRows(v){if(this.lines.length===0){v===void 0&&(v=_.DEFAULT_ATTR_DATA);let S=this._rows;for(;S--;)this.lines.push(this.getBlankLine(v))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(v,S){const O=this.getNullCell(_.DEFAULT_ATTR_DATA);let w=0;const A=this._getCorrectBufferLength(S);if(A>this.lines.maxLength&&(this.lines.maxLength=A),this.lines.length>0){if(this._cols<v)for(let L=0;L<this.lines.length;L++)w+=+this.lines.get(L).resize(v,O);let I=0;if(this._rows<S)for(let L=this._rows;L<S;L++)this.lines.length<S+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new _.BufferLine(v,O)):this.ybase>0&&this.lines.length<=this.ybase+this.y+I+1?(this.ybase--,I++,this.ydisp>0&&this.ydisp--):this.lines.push(new _.BufferLine(v,O)));else for(let L=this._rows;L>S;L--)this.lines.length>S+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(A<this.lines.maxLength){const L=this.lines.length-A;L>0&&(this.lines.trimStart(L),this.ybase=Math.max(this.ybase-L,0),this.ydisp=Math.max(this.ydisp-L,0),this.savedY=Math.max(this.savedY-L,0)),this.lines.maxLength=A}this.x=Math.min(this.x,v-1),this.y=Math.min(this.y,S-1),I&&(this.y+=I),this.savedX=Math.min(this.savedX,v-1),this.scrollTop=0}if(this.scrollBottom=S-1,this._isReflowEnabled&&(this._reflow(v,S),this._cols>v))for(let I=0;I<this.lines.length;I++)w+=+this.lines.get(I).resize(v,O);this._cols=v,this._rows=S,this._memoryCleanupQueue.clear(),w>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let v=true;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,v=false);let S=0;for(;this._memoryCleanupPosition<this.lines.length;)if(S+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),S>100)return true;return v}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(v,S){this._cols!==v&&(v>this._cols?this._reflowLarger(v,S):this._reflowSmaller(v,S))}_reflowLarger(v,S){const O=(0,b.reflowLargerGetLinesToRemove)(this.lines,this._cols,v,this.ybase+this.y,this.getNullCell(_.DEFAULT_ATTR_DATA));if(O.length>0){const w=(0,b.reflowLargerCreateNewLayout)(this.lines,O);(0,b.reflowLargerApplyNewLayout)(this.lines,w.layout),this._reflowLargerAdjustViewport(v,S,w.countRemoved)}}_reflowLargerAdjustViewport(v,S,O){const w=this.getNullCell(_.DEFAULT_ATTR_DATA);let A=O;for(;A-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<S&&this.lines.push(new _.BufferLine(v,w))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-O,0)}_reflowSmaller(v,S){const O=this.getNullCell(_.DEFAULT_ATTR_DATA),w=[];let A=0;for(let I=this.lines.length-1;I>=0;I--){let L=this.lines.get(I);if(!L||!L.isWrapped&&L.getTrimmedLength()<=v)continue;const x=[L];for(;L.isWrapped&&I>0;)L=this.lines.get(--I),x.unshift(L);const B=this.ybase+this.y;if(B>=I&&B<I+x.length)continue;const H=x[x.length-1].getTrimmedLength(),F=(0,b.reflowSmallerGetNewLineLengths)(x,this._cols,v),X=F.length-x.length;let Z;Z=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+X):Math.max(0,this.lines.length-this.lines.maxLength+X);const J=[];for(let G=0;G<X;G++){const ae=this.getBlankLine(_.DEFAULT_ATTR_DATA,true);J.push(ae)}J.length>0&&(w.push({start:I+x.length+A,newLines:J}),A+=J.length),x.push(...J);let D=F.length-1,P=F[D];P===0&&(D--,P=F[D]);let V=x.length-X-1,j=H;for(;V>=0;){const G=Math.min(j,P);if(x[D]===void 0)break;if(x[D].copyCellsFrom(x[V],j-G,P-G,G,true),P-=G,P===0&&(D--,P=F[D]),j-=G,j===0){V--;const ae=Math.max(V,0);j=(0,b.getWrappedLineTrimmedLength)(x,ae,this._cols)}}for(let G=0;G<x.length;G++)F[G]<v&&x[G].setCell(F[G],O);let re=X-Z;for(;re-- >0;)this.ybase===0?this.y<S-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+A)-S&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+X,this.ybase+S-1)}if(w.length>0){const I=[],L=[];for(let D=0;D<this.lines.length;D++)L.push(this.lines.get(D));const x=this.lines.length;let B=x-1,H=0,F=w[H];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+A);let X=0;for(let D=Math.min(this.lines.maxLength-1,x+A-1);D>=0;D--)if(F&&F.start>B+X){for(let P=F.newLines.length-1;P>=0;P--)this.lines.set(D--,F.newLines[P]);D++,I.push({index:B+1,amount:F.newLines.length}),X+=F.newLines.length,F=w[++H]}else this.lines.set(D,L[B--]);let Z=0;for(let D=I.length-1;D>=0;D--)I[D].index+=Z,this.lines.onInsertEmitter.fire(I[D]),Z+=I[D].amount;const J=Math.max(0,x+A-this.lines.maxLength);J>0&&this.lines.onTrimEmitter.fire(J)}}stringIndexToBufferIndex(v,S,O=false){for(;S;){const w=this.lines.get(v);if(!w)return[-1,-1];const A=O?w.getTrimmedLength():w.length;for(let I=0;I<A;++I)if(w.get(I)[E.CHAR_DATA_WIDTH_INDEX]&&(S-=w.get(I)[E.CHAR_DATA_CHAR_INDEX].length||1),S<0)return[v,I];v++}return[v,0]}translateBufferLineToString(v,S,O=0,w){const A=this.lines.get(v);return A?A.translateToString(S,O,w):""}getWrappedRangeForLine(v){let S=v,O=v;for(;S>0&&this.lines.get(S).isWrapped;)S--;for(;O+1<this.lines.length&&this.lines.get(O+1).isWrapped;)O++;return{first:S,last:O}}setupTabStops(v){for(v!=null?this.tabs[v]||(v=this.prevStop(v)):(this.tabs={},v=0);v<this._cols;v+=this._optionsService.rawOptions.tabStopWidth)this.tabs[v]=true}prevStop(v){for(v==null&&(v=this.x);!this.tabs[--v]&&v>0;);return v>=this._cols?this._cols-1:v<0?0:v}nextStop(v){for(v==null&&(v=this.x);!this.tabs[++v]&&v<this._cols;);return v>=this._cols?this._cols-1:v<0?0:v}clearMarkers(v){this._isClearing=true;for(let S=0;S<this.markers.length;S++)this.markers[S].line===v&&(this.markers[S].dispose(),this.markers.splice(S--,1));this._isClearing=false}clearAllMarkers(){this._isClearing=true;for(let v=0;v<this.markers.length;v++)this.markers[v].dispose(),this.markers.splice(v--,1);this._isClearing=false}addMarker(v){const S=new T.Marker(v);return this.markers.push(S),S.register(this.lines.onTrim(O=>{S.line-=O,S.line<0&&S.dispose()})),S.register(this.lines.onInsert(O=>{S.line>=O.index&&(S.line+=O.amount)})),S.register(this.lines.onDelete(O=>{S.line>=O.index&&S.line<O.index+O.amount&&S.dispose(),S.line>O.index&&(S.line-=O.amount)})),S.register(S.onDispose(()=>this._removeMarker(S))),S}_removeMarker(v){this._isClearing||this.markers.splice(this.markers.indexOf(v),1)}iterator(v,S,O,w,A){return new R(this,v,S,O,w,A)}};class R{constructor(S,O,w=0,A=S.lines.length,I=0,L=0){this._buffer=S,this._trimRight=O,this._startIndex=w,this._endIndex=A,this._startOverscan=I,this._endOverscan=L,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}hasNext(){return this._current<this._endIndex}next(){const S=this._buffer.getWrappedRangeForLine(this._current);S.first<this._startIndex-this._startOverscan&&(S.first=this._startIndex-this._startOverscan),S.last>this._endIndex+this._endOverscan&&(S.last=this._endIndex+this._endOverscan),S.first=Math.max(S.first,0),S.last=Math.min(S.last,this._buffer.lines.length);let O="";for(let w=S.first;w<=S.last;++w)O+=this._buffer.translateBufferLineToString(w,this._trimRight);return this._current=S.last+1,{range:S,content:O}}}u.BufferStringIterator=R},8437:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferLine=u.DEFAULT_ATTR_DATA=void 0;const c=p(482),_=p(643),m=p(511),E=p(3734);u.DEFAULT_ATTR_DATA=Object.freeze(new E.AttributeData);let b=0;class T{constructor(g,$,R=false){this.isWrapped=R,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*g);const v=$||m.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]);for(let S=0;S<g;++S)this.setCell(S,v);this.length=g}get(g){const $=this._data[3*g+0],R=2097151&$;return[this._data[3*g+1],2097152&$?this._combined[g]:R?(0,c.stringFromCodePoint)(R):"",$>>22,2097152&$?this._combined[g].charCodeAt(this._combined[g].length-1):R]}set(g,$){this._data[3*g+1]=$[_.CHAR_DATA_ATTR_INDEX],$[_.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[g]=$[1],this._data[3*g+0]=2097152|g|$[_.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*g+0]=$[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|$[_.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(g){return this._data[3*g+0]>>22}hasWidth(g){return 12582912&this._data[3*g+0]}getFg(g){return this._data[3*g+1]}getBg(g){return this._data[3*g+2]}hasContent(g){return 4194303&this._data[3*g+0]}getCodePoint(g){const $=this._data[3*g+0];return 2097152&$?this._combined[g].charCodeAt(this._combined[g].length-1):2097151&$}isCombined(g){return 2097152&this._data[3*g+0]}getString(g){const $=this._data[3*g+0];return 2097152&$?this._combined[g]:2097151&$?(0,c.stringFromCodePoint)(2097151&$):""}isProtected(g){return 536870912&this._data[3*g+2]}loadCell(g,$){return b=3*g,$.content=this._data[b+0],$.fg=this._data[b+1],$.bg=this._data[b+2],2097152&$.content&&($.combinedData=this._combined[g]),268435456&$.bg&&($.extended=this._extendedAttrs[g]),$}setCell(g,$){2097152&$.content&&(this._combined[g]=$.combinedData),268435456&$.bg&&(this._extendedAttrs[g]=$.extended),this._data[3*g+0]=$.content,this._data[3*g+1]=$.fg,this._data[3*g+2]=$.bg}setCellFromCodePoint(g,$,R,v,S,O){268435456&S&&(this._extendedAttrs[g]=O),this._data[3*g+0]=$|R<<22,this._data[3*g+1]=v,this._data[3*g+2]=S}addCodepointToCell(g,$){let R=this._data[3*g+0];2097152&R?this._combined[g]+=(0,c.stringFromCodePoint)($):(2097151&R?(this._combined[g]=(0,c.stringFromCodePoint)(2097151&R)+(0,c.stringFromCodePoint)($),R&=-2097152,R|=2097152):R=$|4194304,this._data[3*g+0]=R)}insertCells(g,$,R,v){if((g%=this.length)&&this.getWidth(g-1)===2&&this.setCellFromCodePoint(g-1,0,1,(v==null?void 0:v.fg)||0,(v==null?void 0:v.bg)||0,(v==null?void 0:v.extended)||new E.ExtendedAttrs),$<this.length-g){const S=new m.CellData;for(let O=this.length-g-$-1;O>=0;--O)this.setCell(g+$+O,this.loadCell(g+O,S));for(let O=0;O<$;++O)this.setCell(g+O,R)}else for(let S=g;S<this.length;++S)this.setCell(S,R);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(v==null?void 0:v.fg)||0,(v==null?void 0:v.bg)||0,(v==null?void 0:v.extended)||new E.ExtendedAttrs)}deleteCells(g,$,R,v){if(g%=this.length,$<this.length-g){const S=new m.CellData;for(let O=0;O<this.length-g-$;++O)this.setCell(g+O,this.loadCell(g+$+O,S));for(let O=this.length-$;O<this.length;++O)this.setCell(O,R)}else for(let S=g;S<this.length;++S)this.setCell(S,R);g&&this.getWidth(g-1)===2&&this.setCellFromCodePoint(g-1,0,1,(v==null?void 0:v.fg)||0,(v==null?void 0:v.bg)||0,(v==null?void 0:v.extended)||new E.ExtendedAttrs),this.getWidth(g)!==0||this.hasContent(g)||this.setCellFromCodePoint(g,0,1,(v==null?void 0:v.fg)||0,(v==null?void 0:v.bg)||0,(v==null?void 0:v.extended)||new E.ExtendedAttrs)}replaceCells(g,$,R,v,S=false){if(S)for(g&&this.getWidth(g-1)===2&&!this.isProtected(g-1)&&this.setCellFromCodePoint(g-1,0,1,(v==null?void 0:v.fg)||0,(v==null?void 0:v.bg)||0,(v==null?void 0:v.extended)||new E.ExtendedAttrs),$<this.length&&this.getWidth($-1)===2&&!this.isProtected($)&&this.setCellFromCodePoint($,0,1,(v==null?void 0:v.fg)||0,(v==null?void 0:v.bg)||0,(v==null?void 0:v.extended)||new E.ExtendedAttrs);g<$&&g<this.length;)this.isProtected(g)||this.setCell(g,R),g++;else for(g&&this.getWidth(g-1)===2&&this.setCellFromCodePoint(g-1,0,1,(v==null?void 0:v.fg)||0,(v==null?void 0:v.bg)||0,(v==null?void 0:v.extended)||new E.ExtendedAttrs),$<this.length&&this.getWidth($-1)===2&&this.setCellFromCodePoint($,0,1,(v==null?void 0:v.fg)||0,(v==null?void 0:v.bg)||0,(v==null?void 0:v.extended)||new E.ExtendedAttrs);g<$&&g<this.length;)this.setCell(g++,R)}resize(g,$){if(g===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const R=3*g;if(g>this.length){if(this._data.buffer.byteLength>=4*R)this._data=new Uint32Array(this._data.buffer,0,R);else{const v=new Uint32Array(R);v.set(this._data),this._data=v}for(let v=this.length;v<g;++v)this.setCell(v,$)}else{this._data=this._data.subarray(0,R);const v=Object.keys(this._combined);for(let O=0;O<v.length;O++){const w=parseInt(v[O],10);w>=g&&delete this._combined[w]}const S=Object.keys(this._extendedAttrs);for(let O=0;O<S.length;O++){const w=parseInt(S[O],10);w>=g&&delete this._extendedAttrs[w]}}return this.length=g,4*R*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const g=new Uint32Array(this._data.length);return g.set(this._data),this._data=g,1}return 0}fill(g,$=false){if($)for(let R=0;R<this.length;++R)this.isProtected(R)||this.setCell(R,g);else{this._combined={},this._extendedAttrs={};for(let R=0;R<this.length;++R)this.setCell(R,g)}}copyFrom(g){this.length!==g.length?this._data=new Uint32Array(g._data):this._data.set(g._data),this.length=g.length,this._combined={};for(const $ in g._combined)this._combined[$]=g._combined[$];this._extendedAttrs={};for(const $ in g._extendedAttrs)this._extendedAttrs[$]=g._extendedAttrs[$];this.isWrapped=g.isWrapped}clone(){const g=new T(0);g._data=new Uint32Array(this._data),g.length=this.length;for(const $ in this._combined)g._combined[$]=this._combined[$];for(const $ in this._extendedAttrs)g._extendedAttrs[$]=this._extendedAttrs[$];return g.isWrapped=this.isWrapped,g}getTrimmedLength(){for(let g=this.length-1;g>=0;--g)if(4194303&this._data[3*g+0])return g+(this._data[3*g+0]>>22);return 0}copyCellsFrom(g,$,R,v,S){const O=g._data;if(S)for(let A=v-1;A>=0;A--){for(let I=0;I<3;I++)this._data[3*(R+A)+I]=O[3*($+A)+I];268435456&O[3*($+A)+2]&&(this._extendedAttrs[R+A]=g._extendedAttrs[$+A])}else for(let A=0;A<v;A++){for(let I=0;I<3;I++)this._data[3*(R+A)+I]=O[3*($+A)+I];268435456&O[3*($+A)+2]&&(this._extendedAttrs[R+A]=g._extendedAttrs[$+A])}const w=Object.keys(g._combined);for(let A=0;A<w.length;A++){const I=parseInt(w[A],10);I>=$&&(this._combined[I-$+R]=g._combined[I])}}translateToString(g=false,$=0,R=this.length){g&&(R=Math.min(R,this.getTrimmedLength()));let v="";for(;$<R;){const S=this._data[3*$+0],O=2097151&S;v+=2097152&S?this._combined[$]:O?(0,c.stringFromCodePoint)(O):_.WHITESPACE_CELL_CHAR,$+=S>>22||1}return v}}u.BufferLine=T},4841:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.getRangeLength=void 0,u.getRangeLength=function(p,c){if(p.start.y>p.end.y)throw new Error(`Buffer range end (${p.end.x}, ${p.end.y}) cannot be before start (${p.start.x}, ${p.start.y})`);return c*(p.end.y-p.start.y)+(p.end.x-p.start.x+1)}},4634:(f,u)=>{function p(c,_,m){if(_===c.length-1)return c[_].getTrimmedLength();const E=!c[_].hasContent(m-1)&&c[_].getWidth(m-1)===1,b=c[_+1].getWidth(0)===2;return E&&b?m-1:m}Object.defineProperty(u,"__esModule",{value:true}),u.getWrappedLineTrimmedLength=u.reflowSmallerGetNewLineLengths=u.reflowLargerApplyNewLayout=u.reflowLargerCreateNewLayout=u.reflowLargerGetLinesToRemove=void 0,u.reflowLargerGetLinesToRemove=function(c,_,m,E,b){const T=[];for(let y=0;y<c.length-1;y++){let g=y,$=c.get(++g);if(!$.isWrapped)continue;const R=[c.get(y)];for(;g<c.length&&$.isWrapped;)R.push($),$=c.get(++g);if(E>=y&&E<g){y+=R.length-1;continue}let v=0,S=p(R,v,_),O=1,w=0;for(;O<R.length;){const I=p(R,O,_),L=I-w,x=m-S,B=Math.min(L,x);R[v].copyCellsFrom(R[O],w,S,B,false),S+=B,S===m&&(v++,S=0),w+=B,w===I&&(O++,w=0),S===0&&v!==0&&R[v-1].getWidth(m-1)===2&&(R[v].copyCellsFrom(R[v-1],m-1,S++,1,false),R[v-1].setCell(m-1,b))}R[v].replaceCells(S,m,b);let A=0;for(let I=R.length-1;I>0&&(I>v||R[I].getTrimmedLength()===0);I--)A++;A>0&&(T.push(y+R.length-A),T.push(A)),y+=R.length-1}return T},u.reflowLargerCreateNewLayout=function(c,_){const m=[];let E=0,b=_[E],T=0;for(let y=0;y<c.length;y++)if(b===y){const g=_[++E];c.onDeleteEmitter.fire({index:y-T,amount:g}),y+=g-1,T+=g,b=_[++E]}else m.push(y);return{layout:m,countRemoved:T}},u.reflowLargerApplyNewLayout=function(c,_){const m=[];for(let E=0;E<_.length;E++)m.push(c.get(_[E]));for(let E=0;E<m.length;E++)c.set(E,m[E]);c.length=_.length},u.reflowSmallerGetNewLineLengths=function(c,_,m){const E=[],b=c.map(($,R)=>p(c,R,_)).reduce(($,R)=>$+R);let T=0,y=0,g=0;for(;g<b;){if(b-g<m){E.push(b-g);break}T+=m;const $=p(c,y,_);T>$&&(T-=$,y++);const R=c[y].getWidth(T-1)===2;R&&T--;const v=R?m-1:m;E.push(v),g+=v}return E},u.getWrappedLineTrimmedLength=p},5295:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferSet=void 0;const c=p(9092),_=p(8460),m=p(844);class E extends m.Disposable{constructor(T,y){super(),this._optionsService=T,this._bufferService=y,this._onBufferActivate=this.register(new _.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new c.Buffer(true,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new c.Buffer(false,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(T){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(T),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(T,y){this._normal.resize(T,y),this._alt.resize(T,y),this.setupTabStops(T)}setupTabStops(T){this._normal.setupTabStops(T),this._alt.setupTabStops(T)}}u.BufferSet=E},511:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CellData=void 0;const c=p(482),_=p(643),m=p(3734);class E extends m.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new m.ExtendedAttrs,this.combinedData=""}static fromCharData(T){const y=new E;return y.setFromCharData(T),y}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(T){this.fg=T[_.CHAR_DATA_ATTR_INDEX],this.bg=0;let y=false;if(T[_.CHAR_DATA_CHAR_INDEX].length>2)y=true;else if(T[_.CHAR_DATA_CHAR_INDEX].length===2){const g=T[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=g&&g<=56319){const $=T[_.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=$&&$<=57343?this.content=1024*(g-55296)+$-56320+65536|T[_.CHAR_DATA_WIDTH_INDEX]<<22:y=true}else y=true}else this.content=T[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|T[_.CHAR_DATA_WIDTH_INDEX]<<22;y&&(this.combinedData=T[_.CHAR_DATA_CHAR_INDEX],this.content=2097152|T[_.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}u.CellData=E},643:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.WHITESPACE_CELL_CODE=u.WHITESPACE_CELL_WIDTH=u.WHITESPACE_CELL_CHAR=u.NULL_CELL_CODE=u.NULL_CELL_WIDTH=u.NULL_CELL_CHAR=u.CHAR_DATA_CODE_INDEX=u.CHAR_DATA_WIDTH_INDEX=u.CHAR_DATA_CHAR_INDEX=u.CHAR_DATA_ATTR_INDEX=u.DEFAULT_EXT=u.DEFAULT_ATTR=u.DEFAULT_COLOR=void 0,u.DEFAULT_COLOR=0,u.DEFAULT_ATTR=256|u.DEFAULT_COLOR<<9,u.DEFAULT_EXT=0,u.CHAR_DATA_ATTR_INDEX=0,u.CHAR_DATA_CHAR_INDEX=1,u.CHAR_DATA_WIDTH_INDEX=2,u.CHAR_DATA_CODE_INDEX=3,u.NULL_CELL_CHAR="",u.NULL_CELL_WIDTH=1,u.NULL_CELL_CODE=0,u.WHITESPACE_CELL_CHAR=" ",u.WHITESPACE_CELL_WIDTH=1,u.WHITESPACE_CELL_CODE=32},4863:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Marker=void 0;const c=p(8460),_=p(844);class m{constructor(b){this.line=b,this.isDisposed=false,this._disposables=[],this._id=m._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=true,this.line=-1,this._onDispose.fire(),(0,_.disposeArray)(this._disposables),this._disposables.length=0)}register(b){return this._disposables.push(b),b}}u.Marker=m,m._nextId=1},7116:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DEFAULT_CHARSET=u.CHARSETS=void 0,u.CHARSETS={},u.DEFAULT_CHARSET=u.CHARSETS.B,u.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},u.CHARSETS.A={"#":"\xA3"},u.CHARSETS.B=void 0,u.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},u.CHARSETS.C=u.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},u.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},u.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},u.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},u.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},u.CHARSETS.E=u.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},u.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},u.CHARSETS.H=u.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},u.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(f,u)=>{var p,c;Object.defineProperty(u,"__esModule",{value:true}),u.C1_ESCAPED=u.C1=u.C0=void 0,function(_){_.NUL="\0",_.SOH="",_.STX="",_.ETX="",_.EOT="",_.ENQ="",_.ACK="",_.BEL="\x07",_.BS="\b",_.HT="	",_.LF=`
`,_.VT="\v",_.FF="\f",_.CR="\r",_.SO="",_.SI="",_.DLE="",_.DC1="",_.DC2="",_.DC3="",_.DC4="",_.NAK="",_.SYN="",_.ETB="",_.CAN="",_.EM="",_.SUB="",_.ESC="\x1B",_.FS="",_.GS="",_.RS="",_.US="",_.SP=" ",_.DEL="\x7F"}(p=u.C0||(u.C0={})),(c=u.C1||(u.C1={})).PAD="\x80",c.HOP="\x81",c.BPH="\x82",c.NBH="\x83",c.IND="\x84",c.NEL="\x85",c.SSA="\x86",c.ESA="\x87",c.HTS="\x88",c.HTJ="\x89",c.VTS="\x8A",c.PLD="\x8B",c.PLU="\x8C",c.RI="\x8D",c.SS2="\x8E",c.SS3="\x8F",c.DCS="\x90",c.PU1="\x91",c.PU2="\x92",c.STS="\x93",c.CCH="\x94",c.MW="\x95",c.SPA="\x96",c.EPA="\x97",c.SOS="\x98",c.SGCI="\x99",c.SCI="\x9A",c.CSI="\x9B",c.ST="\x9C",c.OSC="\x9D",c.PM="\x9E",c.APC="\x9F",(u.C1_ESCAPED||(u.C1_ESCAPED={})).ST=`${p.ESC}\\`},7399:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.evaluateKeyboardEvent=void 0;const c=p(2584),_={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};u.evaluateKeyboardEvent=function(m,E,b,T){const y={type:0,cancel:false,key:void 0},g=(m.shiftKey?1:0)|(m.altKey?2:0)|(m.ctrlKey?4:0)|(m.metaKey?8:0);switch(m.keyCode){case 0:m.key==="UIKeyInputUpArrow"?y.key=E?c.C0.ESC+"OA":c.C0.ESC+"[A":m.key==="UIKeyInputLeftArrow"?y.key=E?c.C0.ESC+"OD":c.C0.ESC+"[D":m.key==="UIKeyInputRightArrow"?y.key=E?c.C0.ESC+"OC":c.C0.ESC+"[C":m.key==="UIKeyInputDownArrow"&&(y.key=E?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:if(m.altKey){y.key=c.C0.ESC+c.C0.DEL;break}y.key=c.C0.DEL;break;case 9:if(m.shiftKey){y.key=c.C0.ESC+"[Z";break}y.key=c.C0.HT,y.cancel=true;break;case 13:y.key=m.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,y.cancel=true;break;case 27:y.key=c.C0.ESC,m.altKey&&(y.key=c.C0.ESC+c.C0.ESC),y.cancel=true;break;case 37:if(m.metaKey)break;g?(y.key=c.C0.ESC+"[1;"+(g+1)+"D",y.key===c.C0.ESC+"[1;3D"&&(y.key=c.C0.ESC+(b?"b":"[1;5D"))):y.key=E?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(m.metaKey)break;g?(y.key=c.C0.ESC+"[1;"+(g+1)+"C",y.key===c.C0.ESC+"[1;3C"&&(y.key=c.C0.ESC+(b?"f":"[1;5C"))):y.key=E?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(m.metaKey)break;g?(y.key=c.C0.ESC+"[1;"+(g+1)+"A",b||y.key!==c.C0.ESC+"[1;3A"||(y.key=c.C0.ESC+"[1;5A")):y.key=E?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(m.metaKey)break;g?(y.key=c.C0.ESC+"[1;"+(g+1)+"B",b||y.key!==c.C0.ESC+"[1;3B"||(y.key=c.C0.ESC+"[1;5B")):y.key=E?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:m.shiftKey||m.ctrlKey||(y.key=c.C0.ESC+"[2~");break;case 46:y.key=g?c.C0.ESC+"[3;"+(g+1)+"~":c.C0.ESC+"[3~";break;case 36:y.key=g?c.C0.ESC+"[1;"+(g+1)+"H":E?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:y.key=g?c.C0.ESC+"[1;"+(g+1)+"F":E?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:m.shiftKey?y.type=2:m.ctrlKey?y.key=c.C0.ESC+"[5;"+(g+1)+"~":y.key=c.C0.ESC+"[5~";break;case 34:m.shiftKey?y.type=3:m.ctrlKey?y.key=c.C0.ESC+"[6;"+(g+1)+"~":y.key=c.C0.ESC+"[6~";break;case 112:y.key=g?c.C0.ESC+"[1;"+(g+1)+"P":c.C0.ESC+"OP";break;case 113:y.key=g?c.C0.ESC+"[1;"+(g+1)+"Q":c.C0.ESC+"OQ";break;case 114:y.key=g?c.C0.ESC+"[1;"+(g+1)+"R":c.C0.ESC+"OR";break;case 115:y.key=g?c.C0.ESC+"[1;"+(g+1)+"S":c.C0.ESC+"OS";break;case 116:y.key=g?c.C0.ESC+"[15;"+(g+1)+"~":c.C0.ESC+"[15~";break;case 117:y.key=g?c.C0.ESC+"[17;"+(g+1)+"~":c.C0.ESC+"[17~";break;case 118:y.key=g?c.C0.ESC+"[18;"+(g+1)+"~":c.C0.ESC+"[18~";break;case 119:y.key=g?c.C0.ESC+"[19;"+(g+1)+"~":c.C0.ESC+"[19~";break;case 120:y.key=g?c.C0.ESC+"[20;"+(g+1)+"~":c.C0.ESC+"[20~";break;case 121:y.key=g?c.C0.ESC+"[21;"+(g+1)+"~":c.C0.ESC+"[21~";break;case 122:y.key=g?c.C0.ESC+"[23;"+(g+1)+"~":c.C0.ESC+"[23~";break;case 123:y.key=g?c.C0.ESC+"[24;"+(g+1)+"~":c.C0.ESC+"[24~";break;default:if(!m.ctrlKey||m.shiftKey||m.altKey||m.metaKey)if(b&&!T||!m.altKey||m.metaKey)!b||m.altKey||m.ctrlKey||m.shiftKey||!m.metaKey?m.key&&!m.ctrlKey&&!m.altKey&&!m.metaKey&&m.keyCode>=48&&m.key.length===1?y.key=m.key:m.key&&m.ctrlKey&&(m.key==="_"&&(y.key=c.C0.US),m.key==="@"&&(y.key=c.C0.NUL)):m.keyCode===65&&(y.type=1);else{const $=_[m.keyCode],R=$==null?void 0:$[m.shiftKey?1:0];if(R)y.key=c.C0.ESC+R;else if(m.keyCode>=65&&m.keyCode<=90){const v=m.ctrlKey?m.keyCode-64:m.keyCode+32;let S=String.fromCharCode(v);m.shiftKey&&(S=S.toUpperCase()),y.key=c.C0.ESC+S}else if(m.keyCode===32)y.key=c.C0.ESC+(m.ctrlKey?c.C0.NUL:" ");else if(m.key==="Dead"&&m.code.startsWith("Key")){let v=m.code.slice(3,4);m.shiftKey||(v=v.toLowerCase()),y.key=c.C0.ESC+v,y.cancel=true}}else m.keyCode>=65&&m.keyCode<=90?y.key=String.fromCharCode(m.keyCode-64):m.keyCode===32?y.key=c.C0.NUL:m.keyCode>=51&&m.keyCode<=55?y.key=String.fromCharCode(m.keyCode-51+27):m.keyCode===56?y.key=c.C0.DEL:m.keyCode===219?y.key=c.C0.ESC:m.keyCode===220?y.key=c.C0.FS:m.keyCode===221&&(y.key=c.C0.GS)}return y}},482:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Utf8ToUtf32=u.StringToUtf32=u.utf32ToString=u.stringFromCodePoint=void 0,u.stringFromCodePoint=function(p){return p>65535?(p-=65536,String.fromCharCode(55296+(p>>10))+String.fromCharCode(p%1024+56320)):String.fromCharCode(p)},u.utf32ToString=function(p,c=0,_=p.length){let m="";for(let E=c;E<_;++E){let b=p[E];b>65535?(b-=65536,m+=String.fromCharCode(55296+(b>>10))+String.fromCharCode(b%1024+56320)):m+=String.fromCharCode(b)}return m},u.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(p,c){const _=p.length;if(!_)return 0;let m=0,E=0;if(this._interim){const b=p.charCodeAt(E++);56320<=b&&b<=57343?c[m++]=1024*(this._interim-55296)+b-56320+65536:(c[m++]=this._interim,c[m++]=b),this._interim=0}for(let b=E;b<_;++b){const T=p.charCodeAt(b);if(55296<=T&&T<=56319){if(++b>=_)return this._interim=T,m;const y=p.charCodeAt(b);56320<=y&&y<=57343?c[m++]=1024*(T-55296)+y-56320+65536:(c[m++]=T,c[m++]=y)}else T!==65279&&(c[m++]=T)}return m}},u.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(p,c){const _=p.length;if(!_)return 0;let m,E,b,T,y=0,g=0,$=0;if(this.interim[0]){let S=false,O=this.interim[0];O&=(224&O)==192?31:(240&O)==224?15:7;let w,A=0;for(;(w=63&this.interim[++A])&&A<4;)O<<=6,O|=w;const I=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,L=I-A;for(;$<L;){if($>=_)return 0;if(w=p[$++],(192&w)!=128){$--,S=true;break}this.interim[A++]=w,O<<=6,O|=63&w}S||(I===2?O<128?$--:c[y++]=O:I===3?O<2048||O>=55296&&O<=57343||O===65279||(c[y++]=O):O<65536||O>1114111||(c[y++]=O)),this.interim.fill(0)}const R=_-4;let v=$;for(;v<_;){for(;!(!(v<R)||128&(m=p[v])||128&(E=p[v+1])||128&(b=p[v+2])||128&(T=p[v+3]));)c[y++]=m,c[y++]=E,c[y++]=b,c[y++]=T,v+=4;if(m=p[v++],m<128)c[y++]=m;else if((224&m)==192){if(v>=_)return this.interim[0]=m,y;if(E=p[v++],(192&E)!=128){v--;continue}if(g=(31&m)<<6|63&E,g<128){v--;continue}c[y++]=g}else if((240&m)==224){if(v>=_)return this.interim[0]=m,y;if(E=p[v++],(192&E)!=128){v--;continue}if(v>=_)return this.interim[0]=m,this.interim[1]=E,y;if(b=p[v++],(192&b)!=128){v--;continue}if(g=(15&m)<<12|(63&E)<<6|63&b,g<2048||g>=55296&&g<=57343||g===65279)continue;c[y++]=g}else if((248&m)==240){if(v>=_)return this.interim[0]=m,y;if(E=p[v++],(192&E)!=128){v--;continue}if(v>=_)return this.interim[0]=m,this.interim[1]=E,y;if(b=p[v++],(192&b)!=128){v--;continue}if(v>=_)return this.interim[0]=m,this.interim[1]=E,this.interim[2]=b,y;if(T=p[v++],(192&T)!=128){v--;continue}if(g=(7&m)<<18|(63&E)<<12|(63&b)<<6|63&T,g<65536||g>1114111)continue;c[y++]=g}}return y}}},225:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.UnicodeV6=void 0;const p=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],c=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let _;u.UnicodeV6=class{constructor(){if(this.version="6",!_){_=new Uint8Array(65536),_.fill(1),_[0]=0,_.fill(0,1,32),_.fill(0,127,160),_.fill(2,4352,4448),_[9001]=2,_[9002]=2,_.fill(2,11904,42192),_[12351]=1,_.fill(2,44032,55204),_.fill(2,63744,64256),_.fill(2,65040,65050),_.fill(2,65072,65136),_.fill(2,65280,65377),_.fill(2,65504,65511);for(let m=0;m<p.length;++m)_.fill(0,p[m][0],p[m][1]+1)}}wcwidth(m){return m<32?0:m<127?1:m<65536?_[m]:function(E,b){let T,y=0,g=b.length-1;if(E<b[0][0]||E>b[g][1])return false;for(;g>=y;)if(T=y+g>>1,E>b[T][1])y=T+1;else{if(!(E<b[T][0]))return true;g=T-1}return false}(m,c)?0:m>=131072&&m<=196605||m>=196608&&m<=262141?2:1}}},5981:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.WriteBuffer=void 0;const c=p(8460),_=p(844);class m extends _.Disposable{constructor(b){super(),this._action=b,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=false,this._syncCalls=0,this._didUserInput=false,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=true}writeSync(b,T){if(T!==void 0&&this._syncCalls>T)return void(this._syncCalls=0);if(this._pendingData+=b.length,this._writeBuffer.push(b),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let y;for(this._isSyncWriting=true;y=this._writeBuffer.shift();){this._action(y);const g=this._callbacks.shift();g&&g()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=false,this._syncCalls=0}write(b,T){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=false,this._pendingData+=b.length,this._writeBuffer.push(b),this._callbacks.push(T),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=b.length,this._writeBuffer.push(b),this._callbacks.push(T)}_innerWrite(b=0,T=true){const y=b||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const g=this._writeBuffer[this._bufferOffset],$=this._action(g,T);if($){const v=S=>Date.now()-y>=12?setTimeout(()=>this._innerWrite(0,S)):this._innerWrite(y,S);return void $.catch(S=>(queueMicrotask(()=>{throw S}),Promise.resolve(false))).then(v)}const R=this._callbacks[this._bufferOffset];if(R&&R(),this._bufferOffset++,this._pendingData-=g.length,Date.now()-y>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}u.WriteBuffer=m},5941:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.toRgbString=u.parseColor=void 0;const p=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function _(m,E){const b=m.toString(16),T=b.length<2?"0"+b:b;switch(E){case 4:return b[0];case 8:return T;case 12:return(T+T).slice(0,3);default:return T+T}}u.parseColor=function(m){if(!m)return;let E=m.toLowerCase();if(E.indexOf("rgb:")===0){E=E.slice(4);const b=p.exec(E);if(b){const T=b[1]?15:b[4]?255:b[7]?4095:65535;return[Math.round(parseInt(b[1]||b[4]||b[7]||b[10],16)/T*255),Math.round(parseInt(b[2]||b[5]||b[8]||b[11],16)/T*255),Math.round(parseInt(b[3]||b[6]||b[9]||b[12],16)/T*255)]}}else if(E.indexOf("#")===0&&(E=E.slice(1),c.exec(E)&&[3,6,9,12].includes(E.length))){const b=E.length/3,T=[0,0,0];for(let y=0;y<3;++y){const g=parseInt(E.slice(b*y,b*y+b),16);T[y]=b===1?g<<4:b===2?g:b===3?g>>4:g>>8}return T}},u.toRgbString=function(m,E=16){const[b,T,y]=m;return`rgb:${_(b,E)}/${_(T,E)}/${_(y,E)}`}},5770:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.PAYLOAD_LIMIT=void 0,u.PAYLOAD_LIMIT=1e7},6351:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DcsHandler=u.DcsParser=void 0;const c=p(482),_=p(8742),m=p(5770),E=[];u.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=E,this._ident=0,this._handlerFb=()=>{},this._stack={paused:false,loopPosition:0,fallThrough:false}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=E}registerHandler(T,y){this._handlers[T]===void 0&&(this._handlers[T]=[]);const g=this._handlers[T];return g.push(y),{dispose:()=>{const $=g.indexOf(y);$!==-1&&g.splice($,1)}}}clearHandler(T){this._handlers[T]&&delete this._handlers[T]}setHandlerFallback(T){this._handlerFb=T}reset(){if(this._active.length)for(let T=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;T>=0;--T)this._active[T].unhook(false);this._stack.paused=false,this._active=E,this._ident=0}hook(T,y){if(this.reset(),this._ident=T,this._active=this._handlers[T]||E,this._active.length)for(let g=this._active.length-1;g>=0;g--)this._active[g].hook(y);else this._handlerFb(this._ident,"HOOK",y)}put(T,y,g){if(this._active.length)for(let $=this._active.length-1;$>=0;$--)this._active[$].put(T,y,g);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(T,y,g))}unhook(T,y=true){if(this._active.length){let g=false,$=this._active.length-1,R=false;if(this._stack.paused&&($=this._stack.loopPosition-1,g=y,R=this._stack.fallThrough,this._stack.paused=false),!R&&g===false){for(;$>=0&&(g=this._active[$].unhook(T),g!==true);$--)if(g instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=$,this._stack.fallThrough=false,g;$--}for(;$>=0;$--)if(g=this._active[$].unhook(false),g instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=$,this._stack.fallThrough=true,g}else this._handlerFb(this._ident,"UNHOOK",T);this._active=E,this._ident=0}};const b=new _.Params;b.addParam(0),u.DcsHandler=class{constructor(T){this._handler=T,this._data="",this._params=b,this._hitLimit=false}hook(T){this._params=T.length>1||T.params[0]?T.clone():b,this._data="",this._hitLimit=false}put(T,y,g){this._hitLimit||(this._data+=(0,c.utf32ToString)(T,y,g),this._data.length>m.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=true))}unhook(T){let y=false;if(this._hitLimit)y=false;else if(T&&(y=this._handler(this._data,this._params),y instanceof Promise))return y.then(g=>(this._params=b,this._data="",this._hitLimit=false,g));return this._params=b,this._data="",this._hitLimit=false,y}}},2015:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.EscapeSequenceParser=u.VT500_TRANSITION_TABLE=u.TransitionTable=void 0;const c=p(844),_=p(8742),m=p(6242),E=p(6351);class b{constructor($){this.table=new Uint8Array($)}setDefault($,R){this.table.fill($<<4|R)}add($,R,v,S){this.table[R<<8|$]=v<<4|S}addMany($,R,v,S){for(let O=0;O<$.length;O++)this.table[R<<8|$[O]]=v<<4|S}}u.TransitionTable=b;const T=160;u.VT500_TRANSITION_TABLE=function(){const g=new b(4095),$=Array.apply(null,Array(256)).map((A,I)=>I),R=(A,I)=>$.slice(A,I),v=R(32,127),S=R(0,24);S.push(25),S.push.apply(S,R(28,32));const O=R(0,14);let w;for(w in g.setDefault(1,0),g.addMany(v,0,2,0),O)g.addMany([24,26,153,154],w,3,0),g.addMany(R(128,144),w,3,0),g.addMany(R(144,152),w,3,0),g.add(156,w,0,0),g.add(27,w,11,1),g.add(157,w,4,8),g.addMany([152,158,159],w,0,7),g.add(155,w,11,3),g.add(144,w,11,9);return g.addMany(S,0,3,0),g.addMany(S,1,3,1),g.add(127,1,0,1),g.addMany(S,8,0,8),g.addMany(S,3,3,3),g.add(127,3,0,3),g.addMany(S,4,3,4),g.add(127,4,0,4),g.addMany(S,6,3,6),g.addMany(S,5,3,5),g.add(127,5,0,5),g.addMany(S,2,3,2),g.add(127,2,0,2),g.add(93,1,4,8),g.addMany(v,8,5,8),g.add(127,8,5,8),g.addMany([156,27,24,26,7],8,6,0),g.addMany(R(28,32),8,0,8),g.addMany([88,94,95],1,0,7),g.addMany(v,7,0,7),g.addMany(S,7,0,7),g.add(156,7,0,0),g.add(127,7,0,7),g.add(91,1,11,3),g.addMany(R(64,127),3,7,0),g.addMany(R(48,60),3,8,4),g.addMany([60,61,62,63],3,9,4),g.addMany(R(48,60),4,8,4),g.addMany(R(64,127),4,7,0),g.addMany([60,61,62,63],4,0,6),g.addMany(R(32,64),6,0,6),g.add(127,6,0,6),g.addMany(R(64,127),6,0,0),g.addMany(R(32,48),3,9,5),g.addMany(R(32,48),5,9,5),g.addMany(R(48,64),5,0,6),g.addMany(R(64,127),5,7,0),g.addMany(R(32,48),4,9,5),g.addMany(R(32,48),1,9,2),g.addMany(R(32,48),2,9,2),g.addMany(R(48,127),2,10,0),g.addMany(R(48,80),1,10,0),g.addMany(R(81,88),1,10,0),g.addMany([89,90,92],1,10,0),g.addMany(R(96,127),1,10,0),g.add(80,1,11,9),g.addMany(S,9,0,9),g.add(127,9,0,9),g.addMany(R(28,32),9,0,9),g.addMany(R(32,48),9,9,12),g.addMany(R(48,60),9,8,10),g.addMany([60,61,62,63],9,9,10),g.addMany(S,11,0,11),g.addMany(R(32,128),11,0,11),g.addMany(R(28,32),11,0,11),g.addMany(S,10,0,10),g.add(127,10,0,10),g.addMany(R(28,32),10,0,10),g.addMany(R(48,60),10,8,10),g.addMany([60,61,62,63],10,0,11),g.addMany(R(32,48),10,9,12),g.addMany(S,12,0,12),g.add(127,12,0,12),g.addMany(R(28,32),12,0,12),g.addMany(R(32,48),12,9,12),g.addMany(R(48,64),12,0,11),g.addMany(R(64,127),12,12,13),g.addMany(R(64,127),10,12,13),g.addMany(R(64,127),9,12,13),g.addMany(S,13,13,13),g.addMany(v,13,13,13),g.add(127,13,0,13),g.addMany([27,156,24,26],13,14,0),g.add(T,0,2,0),g.add(T,8,5,8),g.add(T,6,0,6),g.add(T,11,0,11),g.add(T,13,13,13),g}();class y extends c.Disposable{constructor($=u.VT500_TRANSITION_TABLE){super(),this._transitions=$,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new _.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(R,v,S)=>{},this._executeHandlerFb=R=>{},this._csiHandlerFb=(R,v)=>{},this._escHandlerFb=R=>{},this._errorHandlerFb=R=>R,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new m.OscParser),this._dcsParser=this.register(new E.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>true)}_identifier($,R=[64,126]){let v=0;if($.prefix){if($.prefix.length>1)throw new Error("only one byte as prefix supported");if(v=$.prefix.charCodeAt(0),v&&60>v||v>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if($.intermediates){if($.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let O=0;O<$.intermediates.length;++O){const w=$.intermediates.charCodeAt(O);if(32>w||w>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");v<<=8,v|=w}}if($.final.length!==1)throw new Error("final must be a single byte");const S=$.final.charCodeAt(0);if(R[0]>S||S>R[1])throw new Error(`final must be in range ${R[0]} .. ${R[1]}`);return v<<=8,v|=S,v}identToString($){const R=[];for(;$;)R.push(String.fromCharCode(255&$)),$>>=8;return R.reverse().join("")}setPrintHandler($){this._printHandler=$}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler($,R){const v=this._identifier($,[48,126]);this._escHandlers[v]===void 0&&(this._escHandlers[v]=[]);const S=this._escHandlers[v];return S.push(R),{dispose:()=>{const O=S.indexOf(R);O!==-1&&S.splice(O,1)}}}clearEscHandler($){this._escHandlers[this._identifier($,[48,126])]&&delete this._escHandlers[this._identifier($,[48,126])]}setEscHandlerFallback($){this._escHandlerFb=$}setExecuteHandler($,R){this._executeHandlers[$.charCodeAt(0)]=R}clearExecuteHandler($){this._executeHandlers[$.charCodeAt(0)]&&delete this._executeHandlers[$.charCodeAt(0)]}setExecuteHandlerFallback($){this._executeHandlerFb=$}registerCsiHandler($,R){const v=this._identifier($);this._csiHandlers[v]===void 0&&(this._csiHandlers[v]=[]);const S=this._csiHandlers[v];return S.push(R),{dispose:()=>{const O=S.indexOf(R);O!==-1&&S.splice(O,1)}}}clearCsiHandler($){this._csiHandlers[this._identifier($)]&&delete this._csiHandlers[this._identifier($)]}setCsiHandlerFallback($){this._csiHandlerFb=$}registerDcsHandler($,R){return this._dcsParser.registerHandler(this._identifier($),R)}clearDcsHandler($){this._dcsParser.clearHandler(this._identifier($))}setDcsHandlerFallback($){this._dcsParser.setHandlerFallback($)}registerOscHandler($,R){return this._oscParser.registerHandler($,R)}clearOscHandler($){this._oscParser.clearHandler($)}setOscHandlerFallback($){this._oscParser.setHandlerFallback($)}setErrorHandler($){this._errorHandler=$}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack($,R,v,S,O){this._parseStack.state=$,this._parseStack.handlers=R,this._parseStack.handlerPos=v,this._parseStack.transition=S,this._parseStack.chunkPos=O}parse($,R,v){let S,O=0,w=0,A=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,A=this._parseStack.chunkPos+1;else{if(v===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const I=this._parseStack.handlers;let L=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(v===false&&L>-1){for(;L>=0&&(S=I[L](this._params),S!==true);L--)if(S instanceof Promise)return this._parseStack.handlerPos=L,S}this._parseStack.handlers=[];break;case 4:if(v===false&&L>-1){for(;L>=0&&(S=I[L](),S!==true);L--)if(S instanceof Promise)return this._parseStack.handlerPos=L,S}this._parseStack.handlers=[];break;case 6:if(O=$[this._parseStack.chunkPos],S=this._dcsParser.unhook(O!==24&&O!==26,v),S)return S;O===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(O=$[this._parseStack.chunkPos],S=this._oscParser.end(O!==24&&O!==26,v),S)return S;O===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,A=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let I=A;I<R;++I){switch(O=$[I],w=this._transitions.table[this.currentState<<8|(O<160?O:T)],w>>4){case 2:for(let F=I+1;;++F){if(F>=R||(O=$[F])<32||O>126&&O<T){this._printHandler($,I,F),I=F-1;break}if(++F>=R||(O=$[F])<32||O>126&&O<T){this._printHandler($,I,F),I=F-1;break}if(++F>=R||(O=$[F])<32||O>126&&O<T){this._printHandler($,I,F),I=F-1;break}if(++F>=R||(O=$[F])<32||O>126&&O<T){this._printHandler($,I,F),I=F-1;break}}break;case 3:this._executeHandlers[O]?this._executeHandlers[O]():this._executeHandlerFb(O),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:I,code:O,currentState:this.currentState,collect:this._collect,params:this._params,abort:false}).abort)return;break;case 7:const L=this._csiHandlers[this._collect<<8|O];let x=L?L.length-1:-1;for(;x>=0&&(S=L[x](this._params),S!==true);x--)if(S instanceof Promise)return this._preserveStack(3,L,x,w,I),S;x<0&&this._csiHandlerFb(this._collect<<8|O,this._params),this.precedingCodepoint=0;break;case 8:do switch(O){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(O-48)}while(++I<R&&(O=$[I])>47&&O<60);I--;break;case 9:this._collect<<=8,this._collect|=O;break;case 10:const B=this._escHandlers[this._collect<<8|O];let H=B?B.length-1:-1;for(;H>=0&&(S=B[H](),S!==true);H--)if(S instanceof Promise)return this._preserveStack(4,B,H,w,I),S;H<0&&this._escHandlerFb(this._collect<<8|O),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|O,this._params);break;case 13:for(let F=I+1;;++F)if(F>=R||(O=$[F])===24||O===26||O===27||O>127&&O<T){this._dcsParser.put($,I,F),I=F-1;break}break;case 14:if(S=this._dcsParser.unhook(O!==24&&O!==26),S)return this._preserveStack(6,[],0,w,I),S;O===27&&(w|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let F=I+1;;F++)if(F>=R||(O=$[F])<32||O>127&&O<T){this._oscParser.put($,I,F),I=F-1;break}break;case 6:if(S=this._oscParser.end(O!==24&&O!==26),S)return this._preserveStack(5,[],0,w,I),S;O===27&&(w|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&w}}}u.EscapeSequenceParser=y},6242:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.OscHandler=u.OscParser=void 0;const c=p(5770),_=p(482),m=[];u.OscParser=class{constructor(){this._state=0,this._active=m,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:false,loopPosition:0,fallThrough:false}}registerHandler(E,b){this._handlers[E]===void 0&&(this._handlers[E]=[]);const T=this._handlers[E];return T.push(b),{dispose:()=>{const y=T.indexOf(b);y!==-1&&T.splice(y,1)}}}clearHandler(E){this._handlers[E]&&delete this._handlers[E]}setHandlerFallback(E){this._handlerFb=E}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=m}reset(){if(this._state===2)for(let E=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;E>=0;--E)this._active[E].end(false);this._stack.paused=false,this._active=m,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||m,this._active.length)for(let E=this._active.length-1;E>=0;E--)this._active[E].start();else this._handlerFb(this._id,"START")}_put(E,b,T){if(this._active.length)for(let y=this._active.length-1;y>=0;y--)this._active[y].put(E,b,T);else this._handlerFb(this._id,"PUT",(0,_.utf32ToString)(E,b,T))}start(){this.reset(),this._state=1}put(E,b,T){if(this._state!==3){if(this._state===1)for(;b<T;){const y=E[b++];if(y===59){this._state=2,this._start();break}if(y<48||57<y)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+y-48}this._state===2&&T-b>0&&this._put(E,b,T)}}end(E,b=true){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let T=false,y=this._active.length-1,g=false;if(this._stack.paused&&(y=this._stack.loopPosition-1,T=b,g=this._stack.fallThrough,this._stack.paused=false),!g&&T===false){for(;y>=0&&(T=this._active[y].end(E),T!==true);y--)if(T instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=y,this._stack.fallThrough=false,T;y--}for(;y>=0;y--)if(T=this._active[y].end(false),T instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=y,this._stack.fallThrough=true,T}else this._handlerFb(this._id,"END",E);this._active=m,this._id=-1,this._state=0}}},u.OscHandler=class{constructor(E){this._handler=E,this._data="",this._hitLimit=false}start(){this._data="",this._hitLimit=false}put(E,b,T){this._hitLimit||(this._data+=(0,_.utf32ToString)(E,b,T),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=true))}end(E){let b=false;if(this._hitLimit)b=false;else if(E&&(b=this._handler(this._data),b instanceof Promise))return b.then(T=>(this._data="",this._hitLimit=false,T));return this._data="",this._hitLimit=false,b}}},8742:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Params=void 0;const p=2147483647;class c{constructor(m=32,E=32){if(this.maxLength=m,this.maxSubParamsLength=E,E>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(m),this.length=0,this._subParams=new Int32Array(E),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(m),this._rejectDigits=false,this._rejectSubDigits=false,this._digitIsSub=false}static fromArray(m){const E=new c;if(!m.length)return E;for(let b=Array.isArray(m[0])?1:0;b<m.length;++b){const T=m[b];if(Array.isArray(T))for(let y=0;y<T.length;++y)E.addSubParam(T[y]);else E.addParam(T)}return E}clone(){const m=new c(this.maxLength,this.maxSubParamsLength);return m.params.set(this.params),m.length=this.length,m._subParams.set(this._subParams),m._subParamsLength=this._subParamsLength,m._subParamsIdx.set(this._subParamsIdx),m._rejectDigits=this._rejectDigits,m._rejectSubDigits=this._rejectSubDigits,m._digitIsSub=this._digitIsSub,m}toArray(){const m=[];for(let E=0;E<this.length;++E){m.push(this.params[E]);const b=this._subParamsIdx[E]>>8,T=255&this._subParamsIdx[E];T-b>0&&m.push(Array.prototype.slice.call(this._subParams,b,T))}return m}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=false,this._rejectSubDigits=false,this._digitIsSub=false}addParam(m){if(this._digitIsSub=false,this.length>=this.maxLength)this._rejectDigits=true;else{if(m<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=m>p?p:m}}addSubParam(m){if(this._digitIsSub=true,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=true;else{if(m<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=m>p?p:m,this._subParamsIdx[this.length-1]++}}hasSubParams(m){return(255&this._subParamsIdx[m])-(this._subParamsIdx[m]>>8)>0}getSubParams(m){const E=this._subParamsIdx[m]>>8,b=255&this._subParamsIdx[m];return b-E>0?this._subParams.subarray(E,b):null}getSubParamsAll(){const m={};for(let E=0;E<this.length;++E){const b=this._subParamsIdx[E]>>8,T=255&this._subParamsIdx[E];T-b>0&&(m[E]=this._subParams.slice(b,T))}return m}addDigit(m){let E;if(this._rejectDigits||!(E=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const b=this._digitIsSub?this._subParams:this.params,T=b[E-1];b[E-1]=~T?Math.min(10*T+m,p):m}}u.Params=c},5741:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.AddonManager=void 0,u.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let p=this._addons.length-1;p>=0;p--)this._addons[p].instance.dispose()}loadAddon(p,c){const _={instance:c,dispose:c.dispose,isDisposed:false};this._addons.push(_),c.dispose=()=>this._wrappedAddonDispose(_),c.activate(p)}_wrappedAddonDispose(p){if(p.isDisposed)return;let c=-1;for(let _=0;_<this._addons.length;_++)if(this._addons[_]===p){c=_;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");p.isDisposed=true,p.dispose.apply(p.instance),this._addons.splice(c,1)}}},8771:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferApiView=void 0;const c=p(3785),_=p(511);u.BufferApiView=class{constructor(m,E){this._buffer=m,this.type=E}init(m){return this._buffer=m,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(m){const E=this._buffer.lines.get(m);if(E)return new c.BufferLineApiView(E)}getNullCell(){return new _.CellData}}},3785:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferLineApiView=void 0;const c=p(511);u.BufferLineApiView=class{constructor(_){this._line=_}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(_,m){if(!(_<0||_>=this._line.length))return m?(this._line.loadCell(_,m),m):this._line.loadCell(_,new c.CellData)}translateToString(_,m,E){return this._line.translateToString(_,m,E)}}},8285:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferNamespaceApi=void 0;const c=p(8771),_=p(8460);u.BufferNamespaceApi=class{constructor(m){this._core=m,this._onBufferChange=new _.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ParserApi=void 0,u.ParserApi=class{constructor(p){this._core=p}registerCsiHandler(p,c){return this._core.registerCsiHandler(p,_=>c(_.toArray()))}addCsiHandler(p,c){return this.registerCsiHandler(p,c)}registerDcsHandler(p,c){return this._core.registerDcsHandler(p,(_,m)=>c(_,m.toArray()))}addDcsHandler(p,c){return this.registerDcsHandler(p,c)}registerEscHandler(p,c){return this._core.registerEscHandler(p,c)}addEscHandler(p,c){return this.registerEscHandler(p,c)}registerOscHandler(p,c){return this._core.registerOscHandler(p,c)}addOscHandler(p,c){return this.registerOscHandler(p,c)}}},7090:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.UnicodeApi=void 0,u.UnicodeApi=class{constructor(p){this._core=p}register(p){this._core.unicodeService.register(p)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(p){this._core.unicodeService.activeVersion=p}}},744:function(f,u,p){var c=this&&this.__decorate||function(g,$,R,v){var S,O=arguments.length,w=O<3?$:v===null?v=Object.getOwnPropertyDescriptor($,R):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,$,R,v);else for(var A=g.length-1;A>=0;A--)(S=g[A])&&(w=(O<3?S(w):O>3?S($,R,w):S($,R))||w);return O>3&&w&&Object.defineProperty($,R,w),w},_=this&&this.__param||function(g,$){return function(R,v){$(R,v,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.BufferService=u.MINIMUM_ROWS=u.MINIMUM_COLS=void 0;const m=p(2585),E=p(5295),b=p(8460),T=p(844);u.MINIMUM_COLS=2,u.MINIMUM_ROWS=1;let y=class extends T.Disposable{constructor(g){super(),this.isUserScrolling=false,this._onResize=this.register(new b.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new b.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(g.rawOptions.cols||0,u.MINIMUM_COLS),this.rows=Math.max(g.rawOptions.rows||0,u.MINIMUM_ROWS),this.buffers=this.register(new E.BufferSet(g,this))}get buffer(){return this.buffers.active}resize(g,$){this.cols=g,this.rows=$,this.buffers.resize(g,$),this._onResize.fire({cols:g,rows:$})}reset(){this.buffers.reset(),this.isUserScrolling=false}scroll(g,$=false){const R=this.buffer;let v;v=this._cachedBlankLine,v&&v.length===this.cols&&v.getFg(0)===g.fg&&v.getBg(0)===g.bg||(v=R.getBlankLine(g,$),this._cachedBlankLine=v),v.isWrapped=$;const S=R.ybase+R.scrollTop,O=R.ybase+R.scrollBottom;if(R.scrollTop===0){const w=R.lines.isFull;O===R.lines.length-1?w?R.lines.recycle().copyFrom(v):R.lines.push(v.clone()):R.lines.splice(O+1,0,v.clone()),w?this.isUserScrolling&&(R.ydisp=Math.max(R.ydisp-1,0)):(R.ybase++,this.isUserScrolling||R.ydisp++)}else{const w=O-S+1;R.lines.shiftElements(S+1,w-1,-1),R.lines.set(O,v.clone())}this.isUserScrolling||(R.ydisp=R.ybase),this._onScroll.fire(R.ydisp)}scrollLines(g,$,R){const v=this.buffer;if(g<0){if(v.ydisp===0)return;this.isUserScrolling=true}else g+v.ydisp>=v.ybase&&(this.isUserScrolling=false);const S=v.ydisp;v.ydisp=Math.max(Math.min(v.ydisp+g,v.ybase),0),S!==v.ydisp&&($||this._onScroll.fire(v.ydisp))}scrollPages(g){this.scrollLines(g*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(g){const $=g-this.buffer.ydisp;$!==0&&this.scrollLines($)}};y=c([_(0,m.IOptionsService)],y),u.BufferService=y},7994:(f,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CharsetService=void 0,u.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(p){this.glevel=p,this.charset=this._charsets[p]}setgCharset(p,c){this._charsets[p]=c,this.glevel===p&&(this.charset=c)}}},1753:function(f,u,p){var c=this&&this.__decorate||function(v,S,O,w){var A,I=arguments.length,L=I<3?S:w===null?w=Object.getOwnPropertyDescriptor(S,O):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(v,S,O,w);else for(var x=v.length-1;x>=0;x--)(A=v[x])&&(L=(I<3?A(L):I>3?A(S,O,L):A(S,O))||L);return I>3&&L&&Object.defineProperty(S,O,L),L},_=this&&this.__param||function(v,S){return function(O,w){S(O,w,v)}};Object.defineProperty(u,"__esModule",{value:true}),u.CoreMouseService=void 0;const m=p(2585),E=p(8460),b=p(844),T={NONE:{events:0,restrict:()=>false},X10:{events:1,restrict:v=>v.button!==4&&v.action===1&&(v.ctrl=false,v.alt=false,v.shift=false,true)},VT200:{events:19,restrict:v=>v.action!==32},DRAG:{events:23,restrict:v=>v.action!==32||v.button!==3},ANY:{events:31,restrict:v=>true}};function y(v,S){let O=(v.ctrl?16:0)|(v.shift?4:0)|(v.alt?8:0);return v.button===4?(O|=64,O|=v.action):(O|=3&v.button,4&v.button&&(O|=64),8&v.button&&(O|=128),v.action===32?O|=32:v.action!==0||S||(O|=3)),O}const g=String.fromCharCode,$={DEFAULT:v=>{const S=[y(v,false)+32,v.col+32,v.row+32];return S[0]>255||S[1]>255||S[2]>255?"":`\x1B[M${g(S[0])}${g(S[1])}${g(S[2])}`},SGR:v=>{const S=v.action===0&&v.button!==4?"m":"M";return`\x1B[<${y(v,true)};${v.col};${v.row}${S}`},SGR_PIXELS:v=>{const S=v.action===0&&v.button!==4?"m":"M";return`\x1B[<${y(v,true)};${v.x};${v.y}${S}`}};let R=class extends b.Disposable{constructor(v,S){super(),this._bufferService=v,this._coreService=S,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new E.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const O of Object.keys(T))this.addProtocol(O,T[O]);for(const O of Object.keys($))this.addEncoding(O,$[O]);this.reset()}addProtocol(v,S){this._protocols[v]=S}addEncoding(v,S){this._encodings[v]=S}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(v){if(!this._protocols[v])throw new Error(`unknown protocol "${v}"`);this._activeProtocol=v,this._onProtocolChange.fire(this._protocols[v].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(v){if(!this._encodings[v])throw new Error(`unknown encoding "${v}"`);this._activeEncoding=v}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(v){if(v.col<0||v.col>=this._bufferService.cols||v.row<0||v.row>=this._bufferService.rows||v.button===4&&v.action===32||v.button===3&&v.action!==32||v.button!==4&&(v.action===2||v.action===3)||(v.col++,v.row++,v.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,v,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(v))return false;const S=this._encodings[this._activeEncoding](v);return S&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(S):this._coreService.triggerDataEvent(S,true)),this._lastEvent=v,true}explainEvents(v){return{down:!!(1&v),up:!!(2&v),drag:!!(4&v),move:!!(8&v),wheel:!!(16&v)}}_equalEvents(v,S,O){if(O){if(v.x!==S.x||v.y!==S.y)return false}else if(v.col!==S.col||v.row!==S.row)return false;return v.button===S.button&&v.action===S.action&&v.ctrl===S.ctrl&&v.alt===S.alt&&v.shift===S.shift}};R=c([_(0,m.IBufferService),_(1,m.ICoreService)],R),u.CoreMouseService=R},6975:function(f,u,p){var c=this&&this.__decorate||function(R,v,S,O){var w,A=arguments.length,I=A<3?v:O===null?O=Object.getOwnPropertyDescriptor(v,S):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(R,v,S,O);else for(var L=R.length-1;L>=0;L--)(w=R[L])&&(I=(A<3?w(I):A>3?w(v,S,I):w(v,S))||I);return A>3&&I&&Object.defineProperty(v,S,I),I},_=this&&this.__param||function(R,v){return function(S,O){v(S,O,R)}};Object.defineProperty(u,"__esModule",{value:true}),u.CoreService=void 0;const m=p(2585),E=p(8460),b=p(1439),T=p(844),y=Object.freeze({insertMode:false}),g=Object.freeze({applicationCursorKeys:false,applicationKeypad:false,bracketedPasteMode:false,origin:false,reverseWraparound:false,sendFocus:false,wraparound:true});let $=class extends T.Disposable{constructor(R,v,S){super(),this._bufferService=R,this._logService=v,this._optionsService=S,this.isCursorInitialized=false,this.isCursorHidden=false,this._onData=this.register(new E.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new E.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new E.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new E.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,b.clone)(y),this.decPrivateModes=(0,b.clone)(g)}reset(){this.modes=(0,b.clone)(y),this.decPrivateModes=(0,b.clone)(g)}triggerDataEvent(R,v=false){if(this._optionsService.rawOptions.disableStdin)return;const S=this._bufferService.buffer;v&&this._optionsService.rawOptions.scrollOnUserInput&&S.ybase!==S.ydisp&&this._onRequestScrollToBottom.fire(),v&&this._onUserInput.fire(),this._logService.debug(`sending data "${R}"`,()=>R.split("").map(O=>O.charCodeAt(0))),this._onData.fire(R)}triggerBinaryEvent(R){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${R}"`,()=>R.split("").map(v=>v.charCodeAt(0))),this._onBinary.fire(R))}};$=c([_(0,m.IBufferService),_(1,m.ILogService),_(2,m.IOptionsService)],$),u.CoreService=$},9074:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DecorationService=void 0;const c=p(8055),_=p(8460),m=p(844),E=p(6106);let b=0,T=0;class y extends m.Disposable{constructor(){super(),this._decorations=new E.SortedList(R=>R==null?void 0:R.marker.line),this._onDecorationRegistered=this.register(new _.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new _.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,m.toDisposable)(()=>{for(const R of this._decorations.values())this._onDecorationRemoved.fire(R);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(R){if(R.marker.isDisposed)return;const v=new g(R);if(v){const S=v.marker.onDispose(()=>v.dispose());v.onDispose(()=>{v&&(this._decorations.delete(v)&&this._onDecorationRemoved.fire(v),S.dispose())}),this._decorations.insert(v),this._onDecorationRegistered.fire(v)}return v}reset(){for(const R of this._decorations.values())R.dispose();this._decorations.clear()}*getDecorationsAtCell(R,v,S){var O,w,A;let I=0,L=0;for(const x of this._decorations.getKeyIterator(v))I=(O=x.options.x)!==null&&O!==void 0?O:0,L=I+((w=x.options.width)!==null&&w!==void 0?w:1),R>=I&&R<L&&(!S||((A=x.options.layer)!==null&&A!==void 0?A:"bottom")===S)&&(yield x)}forEachDecorationAtCell(R,v,S,O){this._decorations.forEachByKey(v,w=>{var A,I,L;b=(A=w.options.x)!==null&&A!==void 0?A:0,T=b+((I=w.options.width)!==null&&I!==void 0?I:1),R>=b&&R<T&&(!S||((L=w.options.layer)!==null&&L!==void 0?L:"bottom")===S)&&O(w)})}dispose(){for(const R of this._decorations.values())this._onDecorationRemoved.fire(R);this.reset()}}u.DecorationService=y;class g extends m.Disposable{constructor(R){super(),this.options=R,this.isDisposed=false,this.onRenderEmitter=this.register(new _.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new _.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=R.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.InstantiationService=u.ServiceCollection=void 0;const c=p(2585),_=p(8343);class m{constructor(...b){this._entries=new Map;for(const[T,y]of b)this.set(T,y)}set(b,T){const y=this._entries.get(b);return this._entries.set(b,T),y}forEach(b){for(const[T,y]of this._entries.entries())b(T,y)}has(b){return this._entries.has(b)}get(b){return this._entries.get(b)}}u.ServiceCollection=m,u.InstantiationService=class{constructor(){this._services=new m,this._services.set(c.IInstantiationService,this)}setService(E,b){this._services.set(E,b)}getService(E){return this._services.get(E)}createInstance(E,...b){const T=(0,_.getServiceDependencies)(E).sort(($,R)=>$.index-R.index),y=[];for(const $ of T){const R=this._services.get($.id);if(!R)throw new Error(`[createInstance] ${E.name} depends on UNKNOWN service ${$.id}.`);y.push(R)}const g=T.length>0?T[0].index:b.length;if(b.length!==g)throw new Error(`[createInstance] First service dependency of ${E.name} at position ${g+1} conflicts with ${b.length} static arguments`);return new E(...b,...y)}}},7866:function(f,u,p){var c=this&&this.__decorate||function(y,g,$,R){var v,S=arguments.length,O=S<3?g:R===null?R=Object.getOwnPropertyDescriptor(g,$):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,g,$,R);else for(var w=y.length-1;w>=0;w--)(v=y[w])&&(O=(S<3?v(O):S>3?v(g,$,O):v(g,$))||O);return S>3&&O&&Object.defineProperty(g,$,O),O},_=this&&this.__param||function(y,g){return function($,R){g($,R,y)}};Object.defineProperty(u,"__esModule",{value:true}),u.LogService=void 0;const m=p(844),E=p(2585),b={debug:E.LogLevelEnum.DEBUG,info:E.LogLevelEnum.INFO,warn:E.LogLevelEnum.WARN,error:E.LogLevelEnum.ERROR,off:E.LogLevelEnum.OFF};let T=class extends m.Disposable{constructor(y){super(),this._optionsService=y,this.logLevel=E.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=b[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(y){for(let g=0;g<y.length;g++)typeof y[g]=="function"&&(y[g]=y[g]())}_log(y,g,$){this._evalLazyOptionalParams($),y.call(console,"xterm.js: "+g,...$)}debug(y,...g){this.logLevel<=E.LogLevelEnum.DEBUG&&this._log(console.log,y,g)}info(y,...g){this.logLevel<=E.LogLevelEnum.INFO&&this._log(console.info,y,g)}warn(y,...g){this.logLevel<=E.LogLevelEnum.WARN&&this._log(console.warn,y,g)}error(y,...g){this.logLevel<=E.LogLevelEnum.ERROR&&this._log(console.error,y,g)}};T=c([_(0,E.IOptionsService)],T),u.LogService=T},7302:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.OptionsService=u.DEFAULT_OPTIONS=void 0;const c=p(8460),_=p(6114),m=p(844);u.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:false,cursorStyle:"block",cursorWidth:1,customGlyphs:true,drawBoldTextInBrightColors:true,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:true,scrollSensitivity:1,screenReaderMode:false,smoothScrollDuration:0,macOptionIsMeta:false,macOptionClickForcesSelection:false,minimumContrastRatio:1,disableStdin:false,allowProposedApi:false,allowTransparency:false,tabStopWidth:8,theme:{},rightClickSelectsWord:_.isMac,windowOptions:{},windowsMode:false,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:true,convertEol:false,termName:"xterm",cancelEvents:false,overviewRulerWidth:0};const E=["normal","bold","100","200","300","400","500","600","700","800","900"];class b extends m.Disposable{constructor(y){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;const g=Object.assign({},u.DEFAULT_OPTIONS);for(const $ in y)if($ in g)try{const R=y[$];g[$]=this._sanitizeAndValidateOption($,R)}catch(R){console.error(R)}this.rawOptions=g,this.options=Object.assign({},g),this._setupOptions()}onSpecificOptionChange(y,g){return this.onOptionChange($=>{$===y&&g(this.rawOptions[y])})}onMultipleOptionChange(y,g){return this.onOptionChange($=>{y.indexOf($)!==-1&&g()})}_setupOptions(){const y=$=>{if(!($ in u.DEFAULT_OPTIONS))throw new Error(`No option with key "${$}"`);return this.rawOptions[$]},g=($,R)=>{if(!($ in u.DEFAULT_OPTIONS))throw new Error(`No option with key "${$}"`);R=this._sanitizeAndValidateOption($,R),this.rawOptions[$]!==R&&(this.rawOptions[$]=R,this._onOptionChange.fire($))};for(const $ in this.rawOptions){const R={get:y.bind(this,$),set:g.bind(this,$)};Object.defineProperty(this.options,$,R)}}_sanitizeAndValidateOption(y,g){switch(y){case"cursorStyle":if(g||(g=u.DEFAULT_OPTIONS[y]),!function($){return $==="block"||$==="underline"||$==="bar"}(g))throw new Error(`"${g}" is not a valid value for ${y}`);break;case"wordSeparator":g||(g=u.DEFAULT_OPTIONS[y]);break;case"fontWeight":case"fontWeightBold":if(typeof g=="number"&&1<=g&&g<=1e3)break;g=E.includes(g)?g:u.DEFAULT_OPTIONS[y];break;case"cursorWidth":g=Math.floor(g);case"lineHeight":case"tabStopWidth":if(g<1)throw new Error(`${y} cannot be less than 1, value: ${g}`);break;case"minimumContrastRatio":g=Math.max(1,Math.min(21,Math.round(10*g)/10));break;case"scrollback":if((g=Math.min(g,4294967295))<0)throw new Error(`${y} cannot be less than 0, value: ${g}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(g<=0)throw new Error(`${y} cannot be less than or equal to 0, value: ${g}`);case"rows":case"cols":if(!g&&g!==0)throw new Error(`${y} must be numeric, value: ${g}`)}return g}}u.OptionsService=b},2660:function(f,u,p){var c=this&&this.__decorate||function(b,T,y,g){var $,R=arguments.length,v=R<3?T:g===null?g=Object.getOwnPropertyDescriptor(T,y):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(b,T,y,g);else for(var S=b.length-1;S>=0;S--)($=b[S])&&(v=(R<3?$(v):R>3?$(T,y,v):$(T,y))||v);return R>3&&v&&Object.defineProperty(T,y,v),v},_=this&&this.__param||function(b,T){return function(y,g){T(y,g,b)}};Object.defineProperty(u,"__esModule",{value:true}),u.OscLinkService=void 0;const m=p(2585);let E=class{constructor(b){this._bufferService=b,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(b){const T=this._bufferService.buffer;if(b.id===void 0){const S=T.addMarker(T.ybase+T.y),O={data:b,id:this._nextId++,lines:[S]};return S.onDispose(()=>this._removeMarkerFromLink(O,S)),this._dataByLinkId.set(O.id,O),O.id}const y=b,g=this._getEntryIdKey(y),$=this._entriesWithId.get(g);if($)return this.addLineToLink($.id,T.ybase+T.y),$.id;const R=T.addMarker(T.ybase+T.y),v={id:this._nextId++,key:this._getEntryIdKey(y),data:y,lines:[R]};return R.onDispose(()=>this._removeMarkerFromLink(v,R)),this._entriesWithId.set(v.key,v),this._dataByLinkId.set(v.id,v),v.id}addLineToLink(b,T){const y=this._dataByLinkId.get(b);if(y&&y.lines.every(g=>g.line!==T)){const g=this._bufferService.buffer.addMarker(T);y.lines.push(g),g.onDispose(()=>this._removeMarkerFromLink(y,g))}}getLinkData(b){var T;return(T=this._dataByLinkId.get(b))===null||T===void 0?void 0:T.data}_getEntryIdKey(b){return`${b.id};;${b.uri}`}_removeMarkerFromLink(b,T){const y=b.lines.indexOf(T);y!==-1&&(b.lines.splice(y,1),b.lines.length===0&&(b.data.id!==void 0&&this._entriesWithId.delete(b.key),this._dataByLinkId.delete(b.id)))}};E=c([_(0,m.IBufferService)],E),u.OscLinkService=E},8343:(f,u)=>{function p(c,_,m){_.di$target===_?_.di$dependencies.push({id:c,index:m}):(_.di$dependencies=[{id:c,index:m}],_.di$target=_)}Object.defineProperty(u,"__esModule",{value:true}),u.createDecorator=u.getServiceDependencies=u.serviceRegistry=void 0,u.serviceRegistry=new Map,u.getServiceDependencies=function(c){return c.di$dependencies||[]},u.createDecorator=function(c){if(u.serviceRegistry.has(c))return u.serviceRegistry.get(c);const _=function(m,E,b){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");p(_,m,b)};return _.toString=()=>c,u.serviceRegistry.set(c,_),_}},2585:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.IDecorationService=u.IUnicodeService=u.IOscLinkService=u.IOptionsService=u.ILogService=u.LogLevelEnum=u.IInstantiationService=u.ICharsetService=u.ICoreService=u.ICoreMouseService=u.IBufferService=void 0;const c=p(8343);var _;u.IBufferService=(0,c.createDecorator)("BufferService"),u.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),u.ICoreService=(0,c.createDecorator)("CoreService"),u.ICharsetService=(0,c.createDecorator)("CharsetService"),u.IInstantiationService=(0,c.createDecorator)("InstantiationService"),(_=u.LogLevelEnum||(u.LogLevelEnum={}))[_.DEBUG=0]="DEBUG",_[_.INFO=1]="INFO",_[_.WARN=2]="WARN",_[_.ERROR=3]="ERROR",_[_.OFF=4]="OFF",u.ILogService=(0,c.createDecorator)("LogService"),u.IOptionsService=(0,c.createDecorator)("OptionsService"),u.IOscLinkService=(0,c.createDecorator)("OscLinkService"),u.IUnicodeService=(0,c.createDecorator)("UnicodeService"),u.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(f,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.UnicodeService=void 0;const c=p(8460),_=p(225);u.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;const m=new _.UnicodeV6;this.register(m),this._active=m.version,this._activeProvider=m}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(m){if(!this._providers[m])throw new Error(`unknown Unicode version "${m}"`);this._active=m,this._activeProvider=this._providers[m],this._onChange.fire(m)}register(m){this._providers[m.version]=m}wcwidth(m){return this._activeProvider.wcwidth(m)}getStringCellWidth(m){let E=0;const b=m.length;for(let T=0;T<b;++T){let y=m.charCodeAt(T);if(55296<=y&&y<=56319){if(++T>=b)return E+this.wcwidth(y);const g=m.charCodeAt(T);56320<=g&&g<=57343?y=1024*(y-55296)+g-56320+65536:E+=this.wcwidth(g)}E+=this.wcwidth(y)}return E}}}},o={};function l(f){var u=o[f];if(u!==void 0)return u.exports;var p=o[f]={exports:{}};return i[f].call(p.exports,p,p.exports,l),p.exports}var h={};return(()=>{var f=h;Object.defineProperty(f,"__esModule",{value:true}),f.Terminal=void 0;const u=l(3236),p=l(9042),c=l(7975),_=l(7090),m=l(5741),E=l(8285),b=["cols","rows"];f.Terminal=class{constructor(T){this._core=new u.Terminal(T),this._addonManager=new m.AddonManager,this._publicOptions=Object.assign({},this._core.options);const y=$=>this._core.options[$],g=($,R)=>{this._checkReadonlyOptions($),this._core.options[$]=R};for(const $ in this._core.options){const R={get:y.bind(this,$),set:g.bind(this,$)};Object.defineProperty(this._publicOptions,$,R)}}_checkReadonlyOptions(T){if(b.includes(T))throw new Error(`Option "${T}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new c.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new _.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new E.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const T=this._core.coreService.decPrivateModes;let y="none";switch(this._core.coreMouseService.activeProtocol){case"X10":y="x10";break;case"VT200":y="vt200";break;case"DRAG":y="drag";break;case"ANY":y="any"}return{applicationCursorKeysMode:T.applicationCursorKeys,applicationKeypadMode:T.applicationKeypad,bracketedPasteMode:T.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:y,originMode:T.origin,reverseWraparoundMode:T.reverseWraparound,sendFocusMode:T.sendFocus,wraparoundMode:T.wraparound}}get options(){return this._publicOptions}set options(T){for(const y in T)this._publicOptions[y]=T[y]}blur(){this._core.blur()}focus(){this._core.focus()}resize(T,y){this._verifyIntegers(T,y),this._core.resize(T,y)}open(T){this._core.open(T)}attachCustomKeyEventHandler(T){this._core.attachCustomKeyEventHandler(T)}registerLinkProvider(T){return this._core.registerLinkProvider(T)}registerCharacterJoiner(T){return this._checkProposedApi(),this._core.registerCharacterJoiner(T)}deregisterCharacterJoiner(T){this._checkProposedApi(),this._core.deregisterCharacterJoiner(T)}registerMarker(T=0){return this._verifyIntegers(T),this._core.addMarker(T)}registerDecoration(T){var y,g,$;return this._checkProposedApi(),this._verifyPositiveIntegers((y=T.x)!==null&&y!==void 0?y:0,(g=T.width)!==null&&g!==void 0?g:0,($=T.height)!==null&&$!==void 0?$:0),this._core.registerDecoration(T)}hasSelection(){return this._core.hasSelection()}select(T,y,g){this._verifyIntegers(T,y,g),this._core.select(T,y,g)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(T,y){this._verifyIntegers(T,y),this._core.selectLines(T,y)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(T){this._verifyIntegers(T),this._core.scrollLines(T)}scrollPages(T){this._verifyIntegers(T),this._core.scrollPages(T)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(T){this._verifyIntegers(T),this._core.scrollToLine(T)}clear(){this._core.clear()}write(T,y){this._core.write(T,y)}writeln(T,y){this._core.write(T),this._core.write(`\r
`,y)}paste(T){this._core.paste(T)}refresh(T,y){this._verifyIntegers(T,y),this._core.refresh(T,y)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(T){return this._addonManager.loadAddon(this,T)}static get strings(){return p}_verifyIntegers(...T){for(const y of T)if(y===1/0||isNaN(y)||y%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...T){for(const y of T)if(y&&(y===1/0||isNaN(y)||y%1!=0||y<0))throw new Error("This API only accepts positive integers")}}})(),h})()})}(mg)),mg.exports}var yF=$F();const RF=et({__name:"build",props:["blocklyInformation","current"],setup(s,{expose:n}){const i=new yF.Terminal,o=be(null),l={log:(...h)=>{i.writeln(h.join(" "))},error:(...h)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;31m"+h.join(" ")+"\x1B[0m")},warn:(...h)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;33m"+h.join(" ")+"\x1B[0m")},success:(...h)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;32m"+h.join(" ")+"\x1B[0m")},info:(...h)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;32m"+h.join(" ")+"\x1B[0m")},clear:()=>{i.clear()}};return xs(()=>{i.open(o.value),l.info('\u8BF7\u70B9\u51FB\u5DE6\u4FA7"\u7F16\u8BD1\u63D2\u4EF6"\u5F00\u59CB\u7F16\u8BD1')}),n({logger:l}),(h,f)=>(ie(),Se("div",{ref_key:"terminalRef",ref:o},null,512))}});var Eg,m$;function E0(){if(m$)return Eg;m$=1;function s(K){return K instanceof Map?K.clear=K.delete=K.set=function(){throw new Error("map is read-only")}:K instanceof Set&&(K.add=K.clear=K.delete=function(){throw new Error("set is read-only")}),Object.freeze(K),Object.getOwnPropertyNames(K).forEach(pe=>{const Le=K[pe],qe=typeof Le;(qe==="object"||qe==="function")&&!Object.isFrozen(Le)&&s(Le)}),K}class n{constructor(pe){pe.data===void 0&&(pe.data={}),this.data=pe.data,this.isMatchIgnored=false}ignoreMatch(){this.isMatchIgnored=true}}function i(K){return K.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function o(K,...pe){const Le=Object.create(null);for(const qe in K)Le[qe]=K[qe];return pe.forEach(function(qe){for(const Gt in qe)Le[Gt]=qe[Gt]}),Le}const l="</span>",h=K=>!!K.scope,f=(K,{prefix:pe})=>{if(K.startsWith("language:"))return K.replace("language:","language-");if(K.includes(".")){const Le=K.split(".");return[`${pe}${Le.shift()}`,...Le.map((qe,Gt)=>`${qe}${"_".repeat(Gt+1)}`)].join(" ")}return`${pe}${K}`};class u{constructor(pe,Le){this.buffer="",this.classPrefix=Le.classPrefix,pe.walk(this)}addText(pe){this.buffer+=i(pe)}openNode(pe){if(!h(pe))return;const Le=f(pe.scope,{prefix:this.classPrefix});this.span(Le)}closeNode(pe){h(pe)&&(this.buffer+=l)}value(){return this.buffer}span(pe){this.buffer+=`<span class="${pe}">`}}const p=(K={})=>{const pe={children:[]};return Object.assign(pe,K),pe};class c{constructor(){this.rootNode=p(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(pe){this.top.children.push(pe)}openNode(pe){const Le=p({scope:pe});this.add(Le),this.stack.push(Le)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(pe){return this.constructor._walk(pe,this.rootNode)}static _walk(pe,Le){return typeof Le=="string"?pe.addText(Le):Le.children&&(pe.openNode(Le),Le.children.forEach(qe=>this._walk(pe,qe)),pe.closeNode(Le)),pe}static _collapse(pe){typeof pe!="string"&&pe.children&&(pe.children.every(Le=>typeof Le=="string")?pe.children=[pe.children.join("")]:pe.children.forEach(Le=>{c._collapse(Le)}))}}class _ extends c{constructor(pe){super(),this.options=pe}addText(pe){pe!==""&&this.add(pe)}startScope(pe){this.openNode(pe)}endScope(){this.closeNode()}__addSublanguage(pe,Le){const qe=pe.root;Le&&(qe.scope=`language:${Le}`),this.add(qe)}toHTML(){return new u(this,this.options).value()}finalize(){return this.closeAllNodes(),true}}function m(K){return K?typeof K=="string"?K:K.source:null}function E(K){return y("(?=",K,")")}function b(K){return y("(?:",K,")*")}function T(K){return y("(?:",K,")?")}function y(...K){return K.map(Le=>m(Le)).join("")}function g(K){const pe=K[K.length-1];return typeof pe=="object"&&pe.constructor===Object?(K.splice(K.length-1,1),pe):{}}function $(...K){return"("+(g(K).capture?"":"?:")+K.map(qe=>m(qe)).join("|")+")"}function R(K){return new RegExp(K.toString()+"|").exec("").length-1}function v(K,pe){const Le=K&&K.exec(pe);return Le&&Le.index===0}const S=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function O(K,{joinWith:pe}){let Le=0;return K.map(qe=>{Le+=1;const Gt=Le;let wt=m(qe),Ue="";for(;wt.length>0;){const Be=S.exec(wt);if(!Be){Ue+=wt;break}Ue+=wt.substring(0,Be.index),wt=wt.substring(Be.index+Be[0].length),Be[0][0]==="\\"&&Be[1]?Ue+="\\"+String(Number(Be[1])+Gt):(Ue+=Be[0],Be[0]==="("&&Le++)}return Ue}).map(qe=>`(${qe})`).join(pe)}const w=/\b\B/,A="[a-zA-Z]\\w*",I="[a-zA-Z_]\\w*",L="\\b\\d+(\\.\\d+)?",x="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",B="\\b(0b[01]+)",H="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",F=(K={})=>{const pe=/^#![ ]*\//;return K.binary&&(K.begin=y(pe,/.*\b/,K.binary,/\b.*/)),o({scope:"meta",begin:pe,end:/$/,relevance:0,"on:begin":(Le,qe)=>{Le.index!==0&&qe.ignoreMatch()}},K)},X={begin:"\\\\[\\s\\S]",relevance:0},Z={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[X]},J={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[X]},D={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},P=function(K,pe,Le={}){const qe=o({scope:"comment",begin:K,end:pe,contains:[]},Le);qe.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:true,relevance:0});const Gt=$("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return qe.contains.push({begin:y(/[ ]+/,"(",Gt,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),qe},V=P("//","$"),j=P("/\\*","\\*/"),re=P("#","$"),G={scope:"number",begin:L,relevance:0},ae={scope:"number",begin:x,relevance:0},de={scope:"number",begin:B,relevance:0},fe={begin:/(?=\/[^/\n]*\/)/,contains:[{scope:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[X,{begin:/\[/,end:/\]/,relevance:0,contains:[X]}]}]},ee={scope:"title",begin:A,relevance:0},W={scope:"title",begin:I,relevance:0},Q={begin:"\\.\\s*"+I,relevance:0};var Ee=Object.freeze({__proto__:null,MATCH_NOTHING_RE:w,IDENT_RE:A,UNDERSCORE_IDENT_RE:I,NUMBER_RE:L,C_NUMBER_RE:x,BINARY_NUMBER_RE:B,RE_STARTERS_RE:H,SHEBANG:F,BACKSLASH_ESCAPE:X,APOS_STRING_MODE:Z,QUOTE_STRING_MODE:J,PHRASAL_WORDS_MODE:D,COMMENT:P,C_LINE_COMMENT_MODE:V,C_BLOCK_COMMENT_MODE:j,HASH_COMMENT_MODE:re,NUMBER_MODE:G,C_NUMBER_MODE:ae,BINARY_NUMBER_MODE:de,REGEXP_MODE:fe,TITLE_MODE:ee,UNDERSCORE_TITLE_MODE:W,METHOD_GUARD:Q,END_SAME_AS_BEGIN:function(K){return Object.assign(K,{"on:begin":(pe,Le)=>{Le.data._beginMatch=pe[1]},"on:end":(pe,Le)=>{Le.data._beginMatch!==pe[1]&&Le.ignoreMatch()}})}});function Xe(K,pe){K.input[K.index-1]==="."&&pe.ignoreMatch()}function Re(K,pe){K.className!==void 0&&(K.scope=K.className,delete K.className)}function _t(K,pe){pe&&K.beginKeywords&&(K.begin="\\b("+K.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",K.__beforeBegin=Xe,K.keywords=K.keywords||K.beginKeywords,delete K.beginKeywords,K.relevance===void 0&&(K.relevance=0))}function Ct(K,pe){Array.isArray(K.illegal)&&(K.illegal=$(...K.illegal))}function Rt(K,pe){if(K.match){if(K.begin||K.end)throw new Error("begin & end are not supported with match");K.begin=K.match,delete K.match}}function ct(K,pe){K.relevance===void 0&&(K.relevance=1)}const Ut=(K,pe)=>{if(!K.beforeMatch)return;if(K.starts)throw new Error("beforeMatch cannot be used with starts");const Le=Object.assign({},K);Object.keys(K).forEach(qe=>{delete K[qe]}),K.keywords=Le.keywords,K.begin=y(Le.beforeMatch,E(Le.begin)),K.starts={relevance:0,contains:[Object.assign(Le,{endsParent:true})]},K.relevance=0,delete Le.beforeMatch},Ui=["of","and","for","in","not","or","if","then","parent","list","value"],ai="keyword";function li(K,pe,Le=ai){const qe=Object.create(null);return typeof K=="string"?Gt(Le,K.split(" ")):Array.isArray(K)?Gt(Le,K):Object.keys(K).forEach(function(wt){Object.assign(qe,li(K[wt],pe,wt))}),qe;function Gt(wt,Ue){pe&&(Ue=Ue.map(Be=>Be.toLowerCase())),Ue.forEach(function(Be){const Ie=Be.split("|");qe[Ie[0]]=[wt,ci(Ie[0],Ie[1])]})}}function ci(K,pe){return pe?Number(pe):ks(K)?0:1}function ks(K){return Ui.includes(K.toLowerCase())}const Es={},$e=K=>{console.error(K)},rt=(K,...pe)=>{console.log(`WARN: ${K}`,...pe)},pt=(K,pe)=>{Es[`${K}/${pe}`]||(console.log(`Deprecated as of ${K}. ${pe}`),Es[`${K}/${pe}`]=true)},ts=new Error;function ye(K,pe,{key:Le}){let qe=0;const Gt=K[Le],wt={},Ue={};for(let Be=1;Be<=pe.length;Be++)Ue[Be+qe]=Gt[Be],wt[Be+qe]=true,qe+=R(pe[Be-1]);K[Le]=Ue,K[Le]._emit=wt,K[Le]._multi=true}function Zn(K){if(Array.isArray(K.begin)){if(K.skip||K.excludeBegin||K.returnBegin)throw $e("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),ts;if(typeof K.beginScope!="object"||K.beginScope===null)throw $e("beginScope must be object"),ts;ye(K,K.begin,{key:"beginScope"}),K.begin=O(K.begin,{joinWith:""})}}function Qn(K){if(Array.isArray(K.end)){if(K.skip||K.excludeEnd||K.returnEnd)throw $e("skip, excludeEnd, returnEnd not compatible with endScope: {}"),ts;if(typeof K.endScope!="object"||K.endScope===null)throw $e("endScope must be object"),ts;ye(K,K.end,{key:"endScope"}),K.end=O(K.end,{joinWith:""})}}function Fi(K){K.scope&&typeof K.scope=="object"&&K.scope!==null&&(K.beginScope=K.scope,delete K.scope)}function er(K){Fi(K),typeof K.beginScope=="string"&&(K.beginScope={_wrap:K.beginScope}),typeof K.endScope=="string"&&(K.endScope={_wrap:K.endScope}),Zn(K),Qn(K)}function Ot(K){function pe(Ue,Be){return new RegExp(m(Ue),"m"+(K.case_insensitive?"i":"")+(K.unicodeRegex?"u":"")+(Be?"g":""))}class Le{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(Be,Ie){Ie.position=this.position++,this.matchIndexes[this.matchAt]=Ie,this.regexes.push([Ie,Be]),this.matchAt+=R(Be)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const Be=this.regexes.map(Ie=>Ie[1]);this.matcherRe=pe(O(Be,{joinWith:"|"}),true),this.lastIndex=0}exec(Be){this.matcherRe.lastIndex=this.lastIndex;const Ie=this.matcherRe.exec(Be);if(!Ie)return null;const gs=Ie.findIndex((tr,mo)=>mo>0&&tr!==void 0),Ht=this.matchIndexes[gs];return Ie.splice(0,gs),Object.assign(Ie,Ht)}}class qe{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(Be){if(this.multiRegexes[Be])return this.multiRegexes[Be];const Ie=new Le;return this.rules.slice(Be).forEach(([gs,Ht])=>Ie.addRule(gs,Ht)),Ie.compile(),this.multiRegexes[Be]=Ie,Ie}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(Be,Ie){this.rules.push([Be,Ie]),Ie.type==="begin"&&this.count++}exec(Be){const Ie=this.getMatcher(this.regexIndex);Ie.lastIndex=this.lastIndex;let gs=Ie.exec(Be);if(this.resumingScanAtSamePosition()&&!(gs&&gs.index===this.lastIndex)){const Ht=this.getMatcher(0);Ht.lastIndex=this.lastIndex+1,gs=Ht.exec(Be)}return gs&&(this.regexIndex+=gs.position+1,this.regexIndex===this.count&&this.considerAll()),gs}}function Gt(Ue){const Be=new qe;return Ue.contains.forEach(Ie=>Be.addRule(Ie.begin,{rule:Ie,type:"begin"})),Ue.terminatorEnd&&Be.addRule(Ue.terminatorEnd,{type:"end"}),Ue.illegal&&Be.addRule(Ue.illegal,{type:"illegal"}),Be}function wt(Ue,Be){const Ie=Ue;if(Ue.isCompiled)return Ie;[Re,Rt,er,Ut].forEach(Ht=>Ht(Ue,Be)),K.compilerExtensions.forEach(Ht=>Ht(Ue,Be)),Ue.__beforeBegin=null,[_t,Ct,ct].forEach(Ht=>Ht(Ue,Be)),Ue.isCompiled=true;let gs=null;return typeof Ue.keywords=="object"&&Ue.keywords.$pattern&&(Ue.keywords=Object.assign({},Ue.keywords),gs=Ue.keywords.$pattern,delete Ue.keywords.$pattern),gs=gs||/\w+/,Ue.keywords&&(Ue.keywords=li(Ue.keywords,K.case_insensitive)),Ie.keywordPatternRe=pe(gs,true),Be&&(Ue.begin||(Ue.begin=/\B|\b/),Ie.beginRe=pe(Ie.begin),!Ue.end&&!Ue.endsWithParent&&(Ue.end=/\B|\b/),Ue.end&&(Ie.endRe=pe(Ie.end)),Ie.terminatorEnd=m(Ie.end)||"",Ue.endsWithParent&&Be.terminatorEnd&&(Ie.terminatorEnd+=(Ue.end?"|":"")+Be.terminatorEnd)),Ue.illegal&&(Ie.illegalRe=pe(Ue.illegal)),Ue.contains||(Ue.contains=[]),Ue.contains=[].concat(...Ue.contains.map(function(Ht){return N(Ht==="self"?Ue:Ht)})),Ue.contains.forEach(function(Ht){wt(Ht,Ie)}),Ue.starts&&wt(Ue.starts,Be),Ie.matcher=Gt(Ie),Ie}if(K.compilerExtensions||(K.compilerExtensions=[]),K.contains&&K.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return K.classNameAliases=o(K.classNameAliases||{}),wt(K)}function ss(K){return K?K.endsWithParent||ss(K.starts):false}function N(K){return K.variants&&!K.cachedVariants&&(K.cachedVariants=K.variants.map(function(pe){return o(K,{variants:null},pe)})),K.cachedVariants?K.cachedVariants:ss(K)?o(K,{starts:K.starts?o(K.starts):null}):Object.isFrozen(K)?o(K):K}var U="11.8.0";class q extends Error{constructor(pe,Le){super(pe),this.name="HTMLInjectionError",this.html=Le}}const ne=i,oe=o,ut=Symbol("nomatch"),wn=7,wa=function(K){const pe=Object.create(null),Le=Object.create(null),qe=[];let Gt=true;const wt="Could not find the language '{}', did you forget to load/include a language module?",Ue={disableAutodetect:true,name:"Plain text",contains:[]};let Be={ignoreUnescapedHTML:false,throwUnescapedHTML:false,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:_};function Ie(Oe){return Be.noHighlightRe.test(Oe)}function gs(Oe){let ze=Oe.className+" ";ze+=Oe.parentNode?Oe.parentNode.className:"";const ve=Be.languageDetectRe.exec(ze);if(ve){const Nt=Ci(ve[1]);return Nt||(rt(wt.replace("{}",ve[1])),rt("Falling back to no-highlight mode for this block.",Oe)),Nt?ve[1]:"no-highlight"}return ze.split(/\s+/).find(Nt=>Ie(Nt)||Ci(Nt))}function Ht(Oe,ze,ve){let Nt="",ls="";typeof ze=="object"?(Nt=Oe,ve=ze.ignoreIllegals,ls=ze.language):(pt("10.7.0","highlight(lang, code, ...args) has been deprecated."),pt("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),ls=Oe,Nt=ze),ve===void 0&&(ve=true);const hi={code:Nt,language:ls};vo("before:highlight",hi);const an=hi.result?hi.result:tr(hi.language,hi.code,ve);return an.code=hi.code,vo("after:highlight",an),an}function tr(Oe,ze,ve,Nt){const ls=Object.create(null);function hi(Ae,Fe){return Ae.keywords[Fe]}function an(){if(!st.keywords){cs.addText(kt);return}let Ae=0;st.keywordPatternRe.lastIndex=0;let Fe=st.keywordPatternRe.exec(kt),nt="";for(;Fe;){nt+=kt.substring(Ae,Fe.index);const At=Oi.case_insensitive?Fe[0].toLowerCase():Fe[0],fs=hi(st,At);if(fs){const[us,vc]=fs;if(cs.addText(nt),nt="",ls[At]=(ls[At]||0)+1,ls[At]<=wn&&(Ar+=vc),us.startsWith("_"))nt+=Fe[0];else{const _i=Oi.classNameAliases[us]||us;di(Fe[0],_i)}}else nt+=Fe[0];Ae=st.keywordPatternRe.lastIndex,Fe=st.keywordPatternRe.exec(kt)}nt+=kt.substring(Ae),cs.addText(nt)}function ht(){if(kt==="")return;let Ae=null;if(typeof st.subLanguage=="string"){if(!pe[st.subLanguage]){cs.addText(kt);return}Ae=tr(st.subLanguage,kt,true,bc[st.subLanguage]),bc[st.subLanguage]=Ae._top}else Ae=on(kt,st.subLanguage.length?st.subLanguage:null);st.relevance>0&&(Ar+=Ae.relevance),cs.__addSublanguage(Ae._emitter,Ae.language)}function is(){st.subLanguage!=null?ht():an(),kt=""}function di(Ae,Fe){Ae!==""&&(cs.startScope(Fe),cs.addText(Ae),cs.endScope())}function ka(Ae,Fe){let nt=1;const At=Fe.length-1;for(;nt<=At;){if(!Ae._emit[nt]){nt++;continue}const fs=Oi.classNameAliases[Ae[nt]]||Ae[nt],us=Fe[nt];fs?di(us,fs):(kt=us,an(),kt=""),nt++}}function kr(Ae,Fe){return Ae.scope&&typeof Ae.scope=="string"&&cs.openNode(Oi.classNameAliases[Ae.scope]||Ae.scope),Ae.beginScope&&(Ae.beginScope._wrap?(di(kt,Oi.classNameAliases[Ae.beginScope._wrap]||Ae.beginScope._wrap),kt=""):Ae.beginScope._multi&&(ka(Ae.beginScope,Fe),kt="")),st=Object.create(Ae,{parent:{value:st}}),st}function Ec(Ae,Fe,nt){let At=v(Ae.endRe,nt);if(At){if(Ae["on:end"]){const fs=new n(Ae);Ae["on:end"](Fe,fs),fs.isMatchIgnored&&(At=false)}if(At){for(;Ae.endsParent&&Ae.parent;)Ae=Ae.parent;return Ae}}if(Ae.endsWithParent)return Ec(Ae.parent,Fe,nt)}function Aa(Ae){return st.matcher.regexIndex===0?(kt+=Ae[0],1):(Ro=true,0)}function Sh(Ae){const Fe=Ae[0],nt=Ae.rule,At=new n(nt),fs=[nt.__beforeBegin,nt["on:begin"]];for(const us of fs)if(us&&(us(Ae,At),At.isMatchIgnored))return Aa(Fe);return nt.skip?kt+=Fe:(nt.excludeBegin&&(kt+=Fe),is(),!nt.returnBegin&&!nt.excludeBegin&&(kt=Fe)),kr(nt,Ae),nt.returnBegin?0:Fe.length}function $h(Ae){const Fe=Ae[0],nt=ze.substring(Ae.index),At=Ec(st,Ae,nt);if(!At)return ut;const fs=st;st.endScope&&st.endScope._wrap?(is(),di(Fe,st.endScope._wrap)):st.endScope&&st.endScope._multi?(is(),ka(st.endScope,Ae)):fs.skip?kt+=Fe:(fs.returnEnd||fs.excludeEnd||(kt+=Fe),is(),fs.excludeEnd&&(kt=Fe));do st.scope&&cs.closeNode(),!st.skip&&!st.subLanguage&&(Ar+=st.relevance),st=st.parent;while(st!==At.parent);return At.starts&&kr(At.starts,Ae),fs.returnEnd?0:Fe.length}function La(){const Ae=[];for(let Fe=st;Fe!==Oi;Fe=Fe.parent)Fe.scope&&Ae.unshift(Fe.scope);Ae.forEach(Fe=>cs.openNode(Fe))}let So={};function $o(Ae,Fe){const nt=Fe&&Fe[0];if(kt+=Ae,nt==null)return is(),0;if(So.type==="begin"&&Fe.type==="end"&&So.index===Fe.index&&nt===""){if(kt+=ze.slice(Fe.index,Fe.index+1),!Gt){const At=new Error(`0 width match regex (${Oe})`);throw At.languageName=Oe,At.badRule=So.rule,At}return 1}if(So=Fe,Fe.type==="begin")return Sh(Fe);if(Fe.type==="illegal"&&!ve){const At=new Error('Illegal lexeme "'+nt+'" for mode "'+(st.scope||"<unnamed>")+'"');throw At.mode=st,At}else if(Fe.type==="end"){const At=$h(Fe);if(At!==ut)return At}if(Fe.type==="illegal"&&nt==="")return 1;if(Ma>1e5&&Ma>Fe.index*3)throw new Error("potential infinite loop, way more iterations than matches");return kt+=nt,nt.length}const Oi=Ci(Oe);if(!Oi)throw $e(wt.replace("{}",Oe)),new Error('Unknown language: "'+Oe+'"');const Na=Ot(Oi);let yo="",st=Nt||Na;const bc={},cs=new Be.__emitter(Be);La();let kt="",Ar=0,Gi=0,Ma=0,Ro=false;try{if(Oi.__emitTokens)Oi.__emitTokens(ze,cs);else{for(st.matcher.considerAll();;){Ma++,Ro?Ro=false:st.matcher.considerAll(),st.matcher.lastIndex=Gi;const Ae=st.matcher.exec(ze);if(!Ae)break;const Fe=ze.substring(Gi,Ae.index),nt=$o(Fe,Ae);Gi=Ae.index+nt}$o(ze.substring(Gi))}return cs.finalize(),yo=cs.toHTML(),{language:Oe,value:yo,relevance:Ar,illegal:false,_emitter:cs,_top:st}}catch(Ae){if(Ae.message&&Ae.message.includes("Illegal"))return{language:Oe,value:ne(ze),illegal:true,relevance:0,_illegalBy:{message:Ae.message,index:Gi,context:ze.slice(Gi-100,Gi+100),mode:Ae.mode,resultSoFar:yo},_emitter:cs};if(Gt)return{language:Oe,value:ne(ze),illegal:false,relevance:0,errorRaised:Ae,_emitter:cs,_top:st};throw Ae}}function mo(Oe){const ze={value:ne(Oe),illegal:false,relevance:0,_top:Ue,_emitter:new Be.__emitter(Be)};return ze._emitter.addText(Oe),ze}function on(Oe,ze){ze=ze||Be.languages||Object.keys(pe);const ve=mo(Oe),Nt=ze.filter(Ci).filter(qt).map(is=>tr(is,Oe,false));Nt.unshift(ve);const ls=Nt.sort((is,di)=>{if(is.relevance!==di.relevance)return di.relevance-is.relevance;if(is.language&&di.language){if(Ci(is.language).supersetOf===di.language)return 1;if(Ci(di.language).supersetOf===is.language)return-1}return 0}),[hi,an]=ls,ht=hi;return ht.secondBest=an,ht}function Eo(Oe,ze,ve){const Nt=ze&&Le[ze]||ve;Oe.classList.add("hljs"),Oe.classList.add(`language-${Nt}`)}function Or(Oe){let ze=null;const ve=gs(Oe);if(Ie(ve))return;if(vo("before:highlightElement",{el:Oe,language:ve}),Oe.children.length>0&&(Be.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(Oe)),Be.throwUnescapedHTML))throw new q("One of your code blocks includes unescaped HTML.",Oe.innerHTML);ze=Oe;const Nt=ze.textContent,ls=ve?Ht(Nt,{language:ve,ignoreIllegals:true}):on(Nt);Oe.innerHTML=ls.value,Eo(Oe,ve,ls.language),Oe.result={language:ls.language,re:ls.relevance,relevance:ls.relevance},ls.secondBest&&(Oe.secondBest={language:ls.secondBest.language,relevance:ls.secondBest.relevance}),vo("after:highlightElement",{el:Oe,result:ls,text:Nt})}function js(Oe){Be=oe(Be,Oe)}const wr=()=>{Ls(),pt("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function ui(){Ls(),pt("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let As=false;function Ls(){if(document.readyState==="loading"){As=true;return}document.querySelectorAll(Be.cssSelector).forEach(Or)}function Pe(){As&&Ls()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",Pe,false);function Th(Oe,ze){let ve=null;try{ve=ze(K)}catch(Nt){if($e("Language definition for '{}' could not be registered.".replace("{}",Oe)),Gt)$e(Nt);else throw Nt;ve=Ue}ve.name||(ve.name=Oe),pe[Oe]=ve,ve.rawDefinition=ze.bind(null,K),ve.aliases&&Yt(ve.aliases,{languageName:Oe})}function mc(Oe){delete pe[Oe];for(const ze of Object.keys(Le))Le[ze]===Oe&&delete Le[ze]}function bo(){return Object.keys(pe)}function Ci(Oe){return Oe=(Oe||"").toLowerCase(),pe[Oe]||pe[Le[Oe]]}function Yt(Oe,{languageName:ze}){typeof Oe=="string"&&(Oe=[Oe]),Oe.forEach(ve=>{Le[ve.toLowerCase()]=ze})}function qt(Oe){const ze=Ci(Oe);return ze&&!ze.disableAutodetect}function as(Oe){Oe["before:highlightBlock"]&&!Oe["before:highlightElement"]&&(Oe["before:highlightElement"]=ze=>{Oe["before:highlightBlock"](Object.assign({block:ze.el},ze))}),Oe["after:highlightBlock"]&&!Oe["after:highlightElement"]&&(Oe["after:highlightElement"]=ze=>{Oe["after:highlightBlock"](Object.assign({block:ze.el},ze))})}function Bt(Oe){as(Oe),qe.push(Oe)}function He(Oe){const ze=qe.indexOf(Oe);ze!==-1&&qe.splice(ze,1)}function vo(Oe,ze){const ve=Oe;qe.forEach(function(Nt){Nt[ve]&&Nt[ve](ze)})}function To(Oe){return pt("10.7.0","highlightBlock will be removed entirely in v12.0"),pt("10.7.0","Please use highlightElement now."),Or(Oe)}Object.assign(K,{highlight:Ht,highlightAuto:on,highlightAll:Ls,highlightElement:Or,highlightBlock:To,configure:js,initHighlighting:wr,initHighlightingOnLoad:ui,registerLanguage:Th,unregisterLanguage:mc,listLanguages:bo,getLanguage:Ci,registerAliases:Yt,autoDetection:qt,inherit:oe,addPlugin:Bt,removePlugin:He}),K.debugMode=function(){Gt=false},K.safeMode=function(){Gt=true},K.versionString=U,K.regex={concat:y,lookahead:E,either:$,optional:T,anyNumberOfTimes:b};for(const Oe in Ee)typeof Ee[Oe]=="object"&&s(Ee[Oe]);return Object.assign(K,Ee),K},kn=wa({});return kn.newInstance=()=>wa({}),Eg=kn,kn.HighlightJS=kn,kn.default=kn,Eg}var bg,E$;function IF(){if(E$)return bg;E$=1;function s(n){const i=n.regex,o=i.concat(/[\p{L}_]/u,i.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),l=/[\p{L}0-9._:-]+/u,h={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},f={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},u=n.inherit(f,{begin:/\(/,end:/\)/}),p=n.inherit(n.APOS_STRING_MODE,{className:"string"}),c=n.inherit(n.QUOTE_STRING_MODE,{className:"string"}),_={endsWithParent:true,illegal:/</,relevance:0,contains:[{className:"attr",begin:l,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:true,variants:[{begin:/"/,end:/"/,contains:[h]},{begin:/'/,end:/'/,contains:[h]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:true,unicodeRegex:true,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[f,c,p,u,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[f,u,c,p]}]}]},n.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},h,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[c]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[_],starts:{end:/<\/style>/,returnEnd:true,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[_],starts:{end:/<\/script>/,returnEnd:true,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:i.concat(/</,i.lookahead(i.concat(o,i.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:o,relevance:0,starts:_}]},{className:"tag",begin:i.concat(/<\//,i.lookahead(i.concat(o,/>/))),contains:[{className:"name",begin:o,relevance:0},{begin:/>/,relevance:0,endsParent:true}]}]}}return bg=s,bg}var vg,b$;function CF(){if(b$)return vg;b$=1;function s(n){const i=n.regex,o={},l={begin:/\$\{/,end:/\}/,contains:["self",{begin:/:-/,contains:[o]}]};Object.assign(o,{className:"variable",variants:[{begin:i.concat(/\$[\w\d#@][\w\d_]*/,"(?![\\w\\d])(?![$])")},l]});const h={className:"subst",begin:/\$\(/,end:/\)/,contains:[n.BACKSLASH_ESCAPE]},f={begin:/<<-?\s*(?=\w+)/,starts:{contains:[n.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,className:"string"})]}},u={className:"string",begin:/"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,o,h]};h.contains.push(u);const p={className:"",begin:/\\"/},c={className:"string",begin:/'/,end:/'/},_={begin:/\$?\(\(/,end:/\)\)/,contains:[{begin:/\d+#[0-9a-f]+/,className:"number"},n.NUMBER_MODE,o]},m=["fish","bash","zsh","sh","csh","ksh","tcsh","dash","scsh"],E=n.SHEBANG({binary:`(${m.join("|")})`,relevance:10}),b={className:"function",begin:/\w[\w\d_]*\s*\(\s*\)\s*\{/,returnBegin:true,contains:[n.inherit(n.TITLE_MODE,{begin:/\w[\w\d_]*/})],relevance:0},T=["if","then","else","elif","fi","for","while","until","in","do","done","case","esac","function","select"],y=["true","false"],g={match:/(\/[a-z._-]+)+/},$=["break","cd","continue","eval","exec","exit","export","getopts","hash","pwd","readonly","return","shift","test","times","trap","umask","unset"],R=["alias","bind","builtin","caller","command","declare","echo","enable","help","let","local","logout","mapfile","printf","read","readarray","source","type","typeset","ulimit","unalias"],v=["autoload","bg","bindkey","bye","cap","chdir","clone","comparguments","compcall","compctl","compdescribe","compfiles","compgroups","compquote","comptags","comptry","compvalues","dirs","disable","disown","echotc","echoti","emulate","fc","fg","float","functions","getcap","getln","history","integer","jobs","kill","limit","log","noglob","popd","print","pushd","pushln","rehash","sched","setcap","setopt","stat","suspend","ttyctl","unfunction","unhash","unlimit","unsetopt","vared","wait","whence","where","which","zcompile","zformat","zftp","zle","zmodload","zparseopts","zprof","zpty","zregexparse","zsocket","zstyle","ztcp"],S=["chcon","chgrp","chown","chmod","cp","dd","df","dir","dircolors","ln","ls","mkdir","mkfifo","mknod","mktemp","mv","realpath","rm","rmdir","shred","sync","touch","truncate","vdir","b2sum","base32","base64","cat","cksum","comm","csplit","cut","expand","fmt","fold","head","join","md5sum","nl","numfmt","od","paste","ptx","pr","sha1sum","sha224sum","sha256sum","sha384sum","sha512sum","shuf","sort","split","sum","tac","tail","tr","tsort","unexpand","uniq","wc","arch","basename","chroot","date","dirname","du","echo","env","expr","factor","groups","hostid","id","link","logname","nice","nohup","nproc","pathchk","pinky","printenv","printf","pwd","readlink","runcon","seq","sleep","stat","stdbuf","stty","tee","test","timeout","tty","uname","unlink","uptime","users","who","whoami","yes"];return{name:"Bash",aliases:["sh"],keywords:{$pattern:/\b[a-z][a-z0-9._-]+\b/,keyword:T,literal:y,built_in:[...$,...R,"set","shopt",...v,...S]},contains:[E,n.SHEBANG(),b,_,n.HASH_COMMENT_MODE,f,g,u,p,c,o]}}return vg=s,vg}var Tg,v$;function OF(){if(v$)return Tg;v$=1;function s(n){const i=n.regex,o=n.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),l="decltype\\(auto\\)",h="[a-zA-Z_]\\w*::",f="<[^<>]+>",u="("+l+"|"+i.optional(h)+"[a-zA-Z_]\\w*"+i.optional(f)+")",p={className:"type",variants:[{begin:"\\b[a-z\\d_]*_t\\b"},{match:/\batomic_[a-z]{3,6}\b/}]},c="\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)",_={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[n.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+c+"|.)",end:"'",illegal:"."},n.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},m={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)((ll|LL|l|L)(u|U)?|(u|U)(ll|LL|l|L)?|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},E={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},n.inherit(_,{className:"string"}),{className:"string",begin:/<.*?>/},o,n.C_BLOCK_COMMENT_MODE]},b={className:"title",begin:i.optional(h)+n.IDENT_RE,relevance:0},T=i.optional(h)+n.IDENT_RE+"\\s*\\(",$={keyword:["asm","auto","break","case","continue","default","do","else","enum","extern","for","fortran","goto","if","inline","register","restrict","return","sizeof","struct","switch","typedef","union","volatile","while","_Alignas","_Alignof","_Atomic","_Generic","_Noreturn","_Static_assert","_Thread_local","alignas","alignof","noreturn","static_assert","thread_local","_Pragma"],type:["float","double","signed","unsigned","int","short","long","char","void","_Bool","_Complex","_Imaginary","_Decimal32","_Decimal64","_Decimal128","const","static","complex","bool","imaginary"],literal:"true false NULL",built_in:"std string wstring cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set pair bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap priority_queue make_pair array shared_ptr abort terminate abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf future isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf endl initializer_list unique_ptr"},R=[E,p,o,n.C_BLOCK_COMMENT_MODE,m,_],v={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:$,contains:R.concat([{begin:/\(/,end:/\)/,keywords:$,contains:R.concat(["self"]),relevance:0}]),relevance:0},S={begin:"("+u+"[\\*&\\s]+)+"+T,returnBegin:true,end:/[{;=]/,excludeEnd:true,keywords:$,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:l,keywords:$,relevance:0},{begin:T,returnBegin:true,contains:[n.inherit(b,{className:"title.function"})],relevance:0},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:$,relevance:0,contains:[o,n.C_BLOCK_COMMENT_MODE,_,m,p,{begin:/\(/,end:/\)/,keywords:$,relevance:0,contains:["self",o,n.C_BLOCK_COMMENT_MODE,_,m,p]}]},p,o,n.C_BLOCK_COMMENT_MODE,E]};return{name:"C",aliases:["h"],keywords:$,disableAutodetect:true,illegal:"</",contains:[].concat(v,S,R,[E,{begin:n.IDENT_RE+"::",keywords:$},{className:"class",beginKeywords:"enum class struct union",end:/[{;:<>=]/,contains:[{beginKeywords:"final class struct"},n.TITLE_MODE]}]),exports:{preprocessor:E,strings:_,keywords:$}}}return Tg=s,Tg}var Sg,T$;function wF(){if(T$)return Sg;T$=1;function s(n){const i=n.regex,o=n.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),l="decltype\\(auto\\)",h="[a-zA-Z_]\\w*::",f="<[^<>]+>",u="(?!struct)("+l+"|"+i.optional(h)+"[a-zA-Z_]\\w*"+i.optional(f)+")",p={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},c="\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)",_={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[n.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+c+"|.)",end:"'",illegal:"."},n.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},m={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)((ll|LL|l|L)(u|U)?|(u|U)(ll|LL|l|L)?|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},E={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},n.inherit(_,{className:"string"}),{className:"string",begin:/<.*?>/},o,n.C_BLOCK_COMMENT_MODE]},b={className:"title",begin:i.optional(h)+n.IDENT_RE,relevance:0},T=i.optional(h)+n.IDENT_RE+"\\s*\\(",y=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],g=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],$=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],R=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],O={type:g,keyword:y,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:$},w={className:"function.dispatch",relevance:0,keywords:{_hint:R},begin:i.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,n.IDENT_RE,i.lookahead(/(<[^<>]+>|)\s*\(/))},A=[w,E,p,o,n.C_BLOCK_COMMENT_MODE,m,_],I={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:O,contains:A.concat([{begin:/\(/,end:/\)/,keywords:O,contains:A.concat(["self"]),relevance:0}]),relevance:0},L={className:"function",begin:"("+u+"[\\*&\\s]+)+"+T,returnBegin:true,end:/[{;=]/,excludeEnd:true,keywords:O,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:l,keywords:O,relevance:0},{begin:T,returnBegin:true,contains:[b],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:true,contains:[_,m]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:O,relevance:0,contains:[o,n.C_BLOCK_COMMENT_MODE,_,m,p,{begin:/\(/,end:/\)/,keywords:O,relevance:0,contains:["self",o,n.C_BLOCK_COMMENT_MODE,_,m,p]}]},p,o,n.C_BLOCK_COMMENT_MODE,E]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:O,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(I,L,w,A,[E,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function)\\s*<(?!<)",end:">",keywords:O,contains:["self",p]},{begin:n.IDENT_RE+"::",keywords:O},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}return Sg=s,Sg}var $g,S$;function kF(){if(S$)return $g;S$=1;function s(n){const i=["bool","byte","char","decimal","delegate","double","dynamic","enum","float","int","long","nint","nuint","object","sbyte","short","string","ulong","uint","ushort"],o=["public","private","protected","static","internal","protected","abstract","async","extern","override","unsafe","virtual","new","sealed","partial"],l=["default","false","null","true"],h=["abstract","as","base","break","case","catch","class","const","continue","do","else","event","explicit","extern","finally","fixed","for","foreach","goto","if","implicit","in","interface","internal","is","lock","namespace","new","operator","out","override","params","private","protected","public","readonly","record","ref","return","scoped","sealed","sizeof","stackalloc","static","struct","switch","this","throw","try","typeof","unchecked","unsafe","using","virtual","void","volatile","while"],f=["add","alias","and","ascending","async","await","by","descending","equals","from","get","global","group","init","into","join","let","nameof","not","notnull","on","or","orderby","partial","remove","select","set","unmanaged","value|0","var","when","where","with","yield"],u={keyword:h.concat(f),built_in:i,literal:l},p=n.inherit(n.TITLE_MODE,{begin:"[a-zA-Z](\\.?\\w)*"}),c={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)(u|U|l|L|ul|UL|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},_={className:"string",begin:'@"',end:'"',contains:[{begin:'""'}]},m=n.inherit(_,{illegal:/\n/}),E={className:"subst",begin:/\{/,end:/\}/,keywords:u},b=n.inherit(E,{illegal:/\n/}),T={className:"string",begin:/\$"/,end:'"',illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},n.BACKSLASH_ESCAPE,b]},y={className:"string",begin:/\$@"/,end:'"',contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},E]},g=n.inherit(y,{illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},b]});E.contains=[y,T,_,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE,c,n.C_BLOCK_COMMENT_MODE],b.contains=[g,T,m,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE,c,n.inherit(n.C_BLOCK_COMMENT_MODE,{illegal:/\n/})];const $={variants:[y,T,_,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE]},R={begin:"<",end:">",contains:[{beginKeywords:"in out"},p]},v=n.IDENT_RE+"(<"+n.IDENT_RE+"(\\s*,\\s*"+n.IDENT_RE+")*>)?(\\[\\])?",S={begin:"@"+n.IDENT_RE,relevance:0};return{name:"C#",aliases:["cs","c#"],keywords:u,illegal:/::/,contains:[n.COMMENT("///","$",{returnBegin:true,contains:[{className:"doctag",variants:[{begin:"///",relevance:0},{begin:"<!--|-->"},{begin:"</?",end:">"}]}]}),n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE,{className:"meta",begin:"#",end:"$",keywords:{keyword:"if else elif endif define undef warning error line region endregion pragma checksum"}},$,c,{beginKeywords:"class interface",relevance:0,end:/[{;=]/,illegal:/[^\s:,]/,contains:[{beginKeywords:"where class"},p,R,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{beginKeywords:"namespace",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[p,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{beginKeywords:"record",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[p,R,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{className:"meta",begin:"^\\s*\\[(?=[\\w])",excludeBegin:true,end:"\\]",excludeEnd:true,contains:[{className:"string",begin:/"/,end:/"/}]},{beginKeywords:"new return throw await else",relevance:0},{className:"function",begin:"("+v+"\\s+)+"+n.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:true,end:/\s*[{;=]/,excludeEnd:true,keywords:u,contains:[{beginKeywords:o.join(" "),relevance:0},{begin:n.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:true,contains:[n.TITLE_MODE,R],relevance:0},{match:/\(\)/},{className:"params",begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:u,relevance:0,contains:[$,c,n.C_BLOCK_COMMENT_MODE]},n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},S]}}return $g=s,$g}var yg,$$;function AF(){if($$)return yg;$$=1;const s=u=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:u.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[u.APOS_STRING_MODE,u.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:u.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z][A-Za-z0-9_-]*/}}),n=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","p","q","quote","samp","section","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],i=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"],o=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"],l=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"],h=["align-content","align-items","align-self","all","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","content-visibility","counter-increment","counter-reset","cue","cue-after","cue-before","cursor","direction","display","empty-cells","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-smoothing","font-stretch","font-style","font-synthesis","font-variant","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","inline-size","isolation","justify-content","left","letter-spacing","line-break","line-height","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","perspective","perspective-origin","pointer-events","position","quotes","resize","rest","rest-after","rest-before","right","row-gap","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","speak","speak-as","src","tab-size","table-layout","text-align","text-align-all","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-transform","text-underline-position","top","transform","transform-box","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","z-index"].reverse();function f(u){const p=u.regex,c=s(u),_={begin:/-(webkit|moz|ms|o)-(?=[a-z])/},m="and or not only",E=/@-?\w[\w]*(-\w+)*/,b="[a-zA-Z-][a-zA-Z0-9_-]*",T=[u.APOS_STRING_MODE,u.QUOTE_STRING_MODE];return{name:"CSS",case_insensitive:true,illegal:/[=|'\$]/,keywords:{keyframePosition:"from to"},classNameAliases:{keyframePosition:"selector-tag"},contains:[c.BLOCK_COMMENT,_,c.CSS_NUMBER_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/,relevance:0},{className:"selector-class",begin:"\\."+b,relevance:0},c.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",variants:[{begin:":("+o.join("|")+")"},{begin:":(:)?("+l.join("|")+")"}]},c.CSS_VARIABLE,{className:"attribute",begin:"\\b("+h.join("|")+")\\b"},{begin:/:/,end:/[;}{]/,contains:[c.BLOCK_COMMENT,c.HEXCOLOR,c.IMPORTANT,c.CSS_NUMBER_MODE,...T,{begin:/(url|data-uri)\(/,end:/\)/,relevance:0,keywords:{built_in:"url data-uri"},contains:[...T,{className:"string",begin:/[^)]/,endsWithParent:true,excludeEnd:true}]},c.FUNCTION_DISPATCH]},{begin:p.lookahead(/@/),end:"[{;]",relevance:0,illegal:/:/,contains:[{className:"keyword",begin:E},{begin:/\s/,endsWithParent:true,excludeEnd:true,relevance:0,keywords:{$pattern:/[a-z-]+/,keyword:m,attribute:i.join(" ")},contains:[{begin:/[a-z-]+(?=:)/,className:"attribute"},...T,c.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"\\b("+n.join("|")+")\\b"}]}}return yg=f,yg}var Rg,y$;function LF(){if(y$)return Rg;y$=1;function s(n){const i=n.regex,o={begin:/<\/?[A-Za-z_]/,end:">",subLanguage:"xml",relevance:0},l={begin:"^[-\\*]{3,}",end:"$"},h={className:"code",variants:[{begin:"(`{3,})[^`](.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})[^~](.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},f={className:"bullet",begin:"^[ 	]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:true},u={begin:/^\[[^\n]+\]:/,returnBegin:true,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:true,excludeEnd:true},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:true}]},p=/[A-Za-z][A-Za-z0-9+.-]*/,c={variants:[{begin:/\[.+?\]\[.*?\]/,relevance:0},{begin:/\[.+?\]\(((data|javascript|mailto):|(?:http|ftp)s?:\/\/).*?\)/,relevance:2},{begin:i.concat(/\[.+?\]\(/,p,/:\/\/.*?\)/),relevance:2},{begin:/\[.+?\]\([./?&#].*?\)/,relevance:1},{begin:/\[.*?\]\(.*?\)/,relevance:0}],returnBegin:true,contains:[{match:/\[(?=\])/},{className:"string",relevance:0,begin:"\\[",end:"\\]",excludeBegin:true,returnEnd:true},{className:"link",relevance:0,begin:"\\]\\(",end:"\\)",excludeBegin:true,excludeEnd:true},{className:"symbol",relevance:0,begin:"\\]\\[",end:"\\]",excludeBegin:true,excludeEnd:true}]},_={className:"strong",contains:[],variants:[{begin:/_{2}(?!\s)/,end:/_{2}/},{begin:/\*{2}(?!\s)/,end:/\*{2}/}]},m={className:"emphasis",contains:[],variants:[{begin:/\*(?![*\s])/,end:/\*/},{begin:/_(?![_\s])/,end:/_/,relevance:0}]},E=n.inherit(_,{contains:[]}),b=n.inherit(m,{contains:[]});_.contains.push(b),m.contains.push(E);let T=[o,c];return[_,m,E,b].forEach($=>{$.contains=$.contains.concat(T)}),T=T.concat(_,m),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:T},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:T}]}]},o,f,_,m,{className:"quote",begin:"^>\\s+",contains:T,end:"$"},h,l,c,u]}}return Rg=s,Rg}var Ig,R$;function NF(){if(R$)return Ig;R$=1;function s(n){const i=n.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:i.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:i.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}return Ig=s,Ig}var Cg,I$;function MF(){if(I$)return Cg;I$=1;function s(n){const i=n.regex,o="([a-zA-Z_]\\w*[!?=]?|[-+~]@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?)",l=i.either(/\b([A-Z]+[a-z0-9]+)+/,/\b([A-Z]+[a-z0-9]+)+[A-Z]+/),h=i.concat(l,/(::\w+)*/),u={"variable.constant":["__FILE__","__LINE__","__ENCODING__"],"variable.language":["self","super"],keyword:["alias","and","begin","BEGIN","break","case","class","defined","do","else","elsif","end","END","ensure","for","if","in","module","next","not","or","redo","require","rescue","retry","return","then","undef","unless","until","when","while","yield",...["include","extend","prepend","public","private","protected","raise","throw"]],built_in:["proc","lambda","attr_accessor","attr_reader","attr_writer","define_method","private_constant","module_function"],literal:["true","false","nil"]},p={className:"doctag",begin:"@[A-Za-z]+"},c={begin:"#<",end:">"},_=[n.COMMENT("#","$",{contains:[p]}),n.COMMENT("^=begin","^=end",{contains:[p],relevance:10}),n.COMMENT("^__END__",n.MATCH_NOTHING_RE)],m={className:"subst",begin:/#\{/,end:/\}/,keywords:u},E={className:"string",contains:[n.BACKSLASH_ESCAPE,m],variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/`/,end:/`/},{begin:/%[qQwWx]?\(/,end:/\)/},{begin:/%[qQwWx]?\[/,end:/\]/},{begin:/%[qQwWx]?\{/,end:/\}/},{begin:/%[qQwWx]?</,end:/>/},{begin:/%[qQwWx]?\//,end:/\//},{begin:/%[qQwWx]?%/,end:/%/},{begin:/%[qQwWx]?-/,end:/-/},{begin:/%[qQwWx]?\|/,end:/\|/},{begin:/\B\?(\\\d{1,3})/},{begin:/\B\?(\\x[A-Fa-f0-9]{1,2})/},{begin:/\B\?(\\u\{?[A-Fa-f0-9]{1,6}\}?)/},{begin:/\B\?(\\M-\\C-|\\M-\\c|\\c\\M-|\\M-|\\C-\\M-)[\x20-\x7e]/},{begin:/\B\?\\(c|C-)[\x20-\x7e]/},{begin:/\B\?\\?\S/},{begin:i.concat(/<<[-~]?'?/,i.lookahead(/(\w+)(?=\W)[^\n]*\n(?:[^\n]*\n)*?\s*\1\b/)),contains:[n.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,contains:[n.BACKSLASH_ESCAPE,m]})]}]},b="[1-9](_?[0-9])*|0",T="[0-9](_?[0-9])*",y={className:"number",relevance:0,variants:[{begin:`\\b(${b})(\\.(${T}))?([eE][+-]?(${T})|r)?i?\\b`},{begin:"\\b0[dD][0-9](_?[0-9])*r?i?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*r?i?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*r?i?\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*r?i?\\b"},{begin:"\\b0(_?[0-7])+r?i?\\b"}]},g={variants:[{match:/\(\)/},{className:"params",begin:/\(/,end:/(?=\))/,excludeBegin:true,endsParent:true,keywords:u}]},A=[E,{variants:[{match:[/class\s+/,h,/\s+<\s+/,h]},{match:[/\b(class|module)\s+/,h]}],scope:{2:"title.class",4:"title.class.inherited"},keywords:u},{match:[/(include|extend)\s+/,h],scope:{2:"title.class"},keywords:u},{relevance:0,match:[h,/\.new[. (]/],scope:{1:"title.class"}},{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},{relevance:0,match:l,scope:"title.class"},{match:[/def/,/\s+/,o],scope:{1:"keyword",3:"title.function"},contains:[g]},{begin:n.IDENT_RE+"::"},{className:"symbol",begin:n.UNDERSCORE_IDENT_RE+"(!|\\?)?:",relevance:0},{className:"symbol",begin:":(?!\\s)",contains:[E,{begin:o}],relevance:0},y,{className:"variable",begin:"(\\$\\W)|((\\$|@@?)(\\w+))(?=[^@$?])(?![A-Za-z])(?![@$?'])"},{className:"params",begin:/\|/,end:/\|/,excludeBegin:true,excludeEnd:true,relevance:0,keywords:u},{begin:"("+n.RE_STARTERS_RE+"|unless)\\s*",keywords:"unless",contains:[{className:"regexp",contains:[n.BACKSLASH_ESCAPE,m],illegal:/\n/,variants:[{begin:"/",end:"/[a-z]*"},{begin:/%r\{/,end:/\}[a-z]*/},{begin:"%r\\(",end:"\\)[a-z]*"},{begin:"%r!",end:"![a-z]*"},{begin:"%r\\[",end:"\\][a-z]*"}]}].concat(c,_),relevance:0}].concat(c,_);m.contains=A,g.contains=A;const I="[>?]>",L="[\\w#]+\\(\\w+\\):\\d+:\\d+[>*]",x="(\\w+-)?\\d+\\.\\d+\\.\\d+(p\\d+)?[^\\d][^>]+>",B=[{begin:/^\s*=>/,starts:{end:"$",contains:A}},{className:"meta.prompt",begin:"^("+I+"|"+L+"|"+x+")(?=[ ])",starts:{end:"$",keywords:u,contains:A}}];return _.unshift(c),{name:"Ruby",aliases:["rb","gemspec","podspec","thor","irb"],keywords:u,illegal:/\/\*/,contains:[n.SHEBANG({binary:"ruby"})].concat(B).concat(_).concat(A)}}return Cg=s,Cg}var Og,C$;function DF(){if(C$)return Og;C$=1;function s(n){const f={keyword:["break","case","chan","const","continue","default","defer","else","fallthrough","for","func","go","goto","if","import","interface","map","package","range","return","select","struct","switch","type","var"],type:["bool","byte","complex64","complex128","error","float32","float64","int8","int16","int32","int64","string","uint8","uint16","uint32","uint64","int","uint","uintptr","rune"],literal:["true","false","iota","nil"],built_in:["append","cap","close","complex","copy","imag","len","make","new","panic","print","println","real","recover","delete"]};return{name:"Go",aliases:["golang"],keywords:f,illegal:"</",contains:[n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE,{className:"string",variants:[n.QUOTE_STRING_MODE,n.APOS_STRING_MODE,{begin:"`",end:"`"}]},{className:"number",variants:[{begin:n.C_NUMBER_RE+"[i]",relevance:1},n.C_NUMBER_MODE]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:true,contains:[n.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,endsParent:true,keywords:f,illegal:/["']/}]}]}}return Og=s,Og}var wg,O$;function xF(){if(O$)return wg;O$=1;function s(n){const i=n.regex,o=/[_A-Za-z][_0-9A-Za-z]*/;return{name:"GraphQL",aliases:["gql"],case_insensitive:true,disableAutodetect:false,keywords:{keyword:["query","mutation","subscription","type","input","schema","directive","interface","union","scalar","fragment","enum","on"],literal:["true","false","null"]},contains:[n.HASH_COMMENT_MODE,n.QUOTE_STRING_MODE,n.NUMBER_MODE,{scope:"punctuation",match:/[.]{3}/,relevance:0},{scope:"punctuation",begin:/[\!\(\)\:\=\[\]\{\|\}]{1}/,relevance:0},{scope:"variable",begin:/\$/,end:/\W/,excludeEnd:true,relevance:0},{scope:"meta",match:/@\w+/,excludeEnd:true},{scope:"symbol",begin:i.concat(o,i.lookahead(/\s*:/)),relevance:0}],illegal:[/[;<']/,/BEGIN/]}}return wg=s,wg}var kg,w$;function BF(){if(w$)return kg;w$=1;function s(n){const i=n.regex,o={className:"number",relevance:0,variants:[{begin:/([+-]+)?[\d]+_[\d_]+/},{begin:n.NUMBER_RE}]},l=n.COMMENT();l.variants=[{begin:/;/,end:/$/},{begin:/#/,end:/$/}];const h={className:"variable",variants:[{begin:/\$[\w\d"][\w\d_]*/},{begin:/\$\{(.*?)\}/}]},f={className:"literal",begin:/\bon|off|true|false|yes|no\b/},u={className:"string",contains:[n.BACKSLASH_ESCAPE],variants:[{begin:"'''",end:"'''",relevance:10},{begin:'"""',end:'"""',relevance:10},{begin:'"',end:'"'},{begin:"'",end:"'"}]},p={begin:/\[/,end:/\]/,contains:[l,f,h,u,o,"self"],relevance:0},c=/[A-Za-z0-9_-]+/,_=/"(\\"|[^"])*"/,m=/'[^']*'/,E=i.either(c,_,m),b=i.concat(E,"(\\s*\\.\\s*",E,")*",i.lookahead(/\s*=\s*[^#\s]/));return{name:"TOML, also INI",aliases:["toml"],case_insensitive:true,illegal:/\S/,contains:[l,{className:"section",begin:/\[+/,end:/\]+/},{begin:b,className:"attr",starts:{end:/$/,contains:[l,p,f,h,u,o]}}]}}return kg=s,kg}var Ag,k$;function PF(){if(k$)return Ag;k$=1;var s="[0-9](_*[0-9])*",n=`\\.(${s})`,i="[0-9a-fA-F](_*[0-9a-fA-F])*",o={className:"number",variants:[{begin:`(\\b(${s})((${n})|\\.)?|(${n}))[eE][+-]?(${s})[fFdD]?\\b`},{begin:`\\b(${s})((${n})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${n})[fFdD]?\\b`},{begin:`\\b(${s})[fFdD]\\b`},{begin:`\\b0[xX]((${i})\\.?|(${i})?\\.(${i}))[pP][+-]?(${s})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${i})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function l(f,u,p){return p===-1?"":f.replace(u,c=>l(f,u,p-1))}function h(f){const u=f.regex,p="[\xC0-\u02B8a-zA-Z_$][\xC0-\u02B8a-zA-Z_$0-9]*",c=p+l("(?:<"+p+"~~~(?:\\s*,\\s*"+p+"~~~)*>)?",/~~~/g,2),T={keyword:["synchronized","abstract","private","var","static","if","const ","for","while","strictfp","finally","protected","import","native","final","void","enum","else","break","transient","catch","instanceof","volatile","case","assert","package","default","public","try","switch","continue","throws","protected","public","private","module","requires","exports","do","sealed","yield","permits"],literal:["false","true","null"],type:["char","boolean","long","float","int","byte","short","double"],built_in:["super","this"]},y={className:"meta",begin:"@"+p,contains:[{begin:/\(/,end:/\)/,contains:["self"]}]},g={className:"params",begin:/\(/,end:/\)/,keywords:T,relevance:0,contains:[f.C_BLOCK_COMMENT_MODE],endsParent:true};return{name:"Java",aliases:["jsp"],keywords:T,illegal:/<\/|#/,contains:[f.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{begin:/\w+@/,relevance:0},{className:"doctag",begin:"@[A-Za-z]+"}]}),{begin:/import java\.[a-z]+\./,keywords:"import",relevance:2},f.C_LINE_COMMENT_MODE,f.C_BLOCK_COMMENT_MODE,{begin:/"""/,end:/"""/,className:"string",contains:[f.BACKSLASH_ESCAPE]},f.APOS_STRING_MODE,f.QUOTE_STRING_MODE,{match:[/\b(?:class|interface|enum|extends|implements|new)/,/\s+/,p],className:{1:"keyword",3:"title.class"}},{match:/non-sealed/,scope:"keyword"},{begin:[u.concat(/(?!else)/,p),/\s+/,p,/\s+/,/=(?!=)/],className:{1:"type",3:"variable",5:"operator"}},{begin:[/record/,/\s+/,p],className:{1:"keyword",3:"title.class"},contains:[g,f.C_LINE_COMMENT_MODE,f.C_BLOCK_COMMENT_MODE]},{beginKeywords:"new throw return else",relevance:0},{begin:["(?:"+c+"\\s+)",f.UNDERSCORE_IDENT_RE,/\s*(?=\()/],className:{2:"title.function"},keywords:T,contains:[{className:"params",begin:/\(/,end:/\)/,keywords:T,relevance:0,contains:[y,f.APOS_STRING_MODE,f.QUOTE_STRING_MODE,o,f.C_BLOCK_COMMENT_MODE]},f.C_LINE_COMMENT_MODE,f.C_BLOCK_COMMENT_MODE]},o,y]}}return Ag=h,Ag}var Lg,A$;function UF(){if(A$)return Lg;A$=1;const s="[A-Za-z$_][0-9A-Za-z$_]*",n=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends"],i=["true","false","null","undefined","NaN","Infinity"],o=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],l=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],h=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],f=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],u=[].concat(h,o,l);function p(c){const _=c.regex,m=(W,{after:Q})=>{const ce="</"+W[0].slice(1);return W.input.indexOf(ce,Q)!==-1},E=s,b={begin:"<>",end:"</>"},T=/<[A-Za-z0-9\\._:-]+\s*\/>/,y={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(W,Q)=>{const ce=W[0].length+W.index,Ee=W.input[ce];if(Ee==="<"||Ee===","){Q.ignoreMatch();return}Ee===">"&&(m(W,{after:ce})||Q.ignoreMatch());let Xe;const Re=W.input.substring(ce);if(Xe=Re.match(/^\s*=/)){Q.ignoreMatch();return}if((Xe=Re.match(/^\s+extends\s+/))&&Xe.index===0){Q.ignoreMatch();return}}},g={$pattern:s,keyword:n,literal:i,built_in:u,"variable.language":f},$="[0-9](_?[0-9])*",R=`\\.(${$})`,v="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",S={className:"number",variants:[{begin:`(\\b(${v})((${R})|\\.)?|(${R}))[eE][+-]?(${$})\\b`},{begin:`\\b(${v})\\b((${R})\\b|\\.)?|(${R})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},O={className:"subst",begin:"\\$\\{",end:"\\}",keywords:g,contains:[]},w={begin:"html`",end:"",starts:{end:"`",returnEnd:false,contains:[c.BACKSLASH_ESCAPE,O],subLanguage:"xml"}},A={begin:"css`",end:"",starts:{end:"`",returnEnd:false,contains:[c.BACKSLASH_ESCAPE,O],subLanguage:"css"}},I={begin:"gql`",end:"",starts:{end:"`",returnEnd:false,contains:[c.BACKSLASH_ESCAPE,O],subLanguage:"graphql"}},L={className:"string",begin:"`",end:"`",contains:[c.BACKSLASH_ESCAPE,O]},B={className:"comment",variants:[c.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:true,excludeBegin:true,relevance:0},{className:"variable",begin:E+"(?=\\s*(-)|$)",endsParent:true,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),c.C_BLOCK_COMMENT_MODE,c.C_LINE_COMMENT_MODE]},H=[c.APOS_STRING_MODE,c.QUOTE_STRING_MODE,w,A,I,L,{match:/\$\d+/},S];O.contains=H.concat({begin:/\{/,end:/\}/,keywords:g,contains:["self"].concat(H)});const F=[].concat(B,O.contains),X=F.concat([{begin:/\(/,end:/\)/,keywords:g,contains:["self"].concat(F)}]),Z={className:"params",begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:g,contains:X},J={variants:[{match:[/class/,/\s+/,E,/\s+/,/extends/,/\s+/,_.concat(E,"(",_.concat(/\./,E),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,E],scope:{1:"keyword",3:"title.class"}}]},D={relevance:0,match:_.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...o,...l]}},P={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},V={variants:[{match:[/function/,/\s+/,E,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[Z],illegal:/%/},j={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function re(W){return _.concat("(?!",W.join("|"),")")}const G={match:_.concat(/\b/,re([...h,"super","import"]),E,_.lookahead(/\(/)),className:"title.function",relevance:0},ae={begin:_.concat(/\./,_.lookahead(_.concat(E,/(?![0-9A-Za-z$_(])/))),end:E,excludeBegin:true,keywords:"prototype",className:"property",relevance:0},de={match:[/get|set/,/\s+/,E,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},Z]},fe="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+c.UNDERSCORE_IDENT_RE+")\\s*=>",ee={match:[/const|var|let/,/\s+/,E,/\s*/,/=\s*/,/(async\s*)?/,_.lookahead(fe)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[Z]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:g,exports:{PARAMS_CONTAINS:X,CLASS_REFERENCE:D},illegal:/#(?![$_A-z])/,contains:[c.SHEBANG({label:"shebang",binary:"node",relevance:5}),P,c.APOS_STRING_MODE,c.QUOTE_STRING_MODE,w,A,I,L,B,{match:/\$\d+/},S,D,{className:"attr",begin:E+_.lookahead(":"),relevance:0},ee,{begin:"("+c.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[B,c.REGEXP_MODE,{className:"function",begin:fe,returnBegin:true,end:"\\s*=>",contains:[{className:"params",variants:[{begin:c.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:true},{begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:g,contains:X}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:b.begin,end:b.end},{match:T},{begin:y.begin,"on:begin":y.isTrulyOpeningTag,end:y.end}],subLanguage:"xml",contains:[{begin:y.begin,end:y.end,skip:true,contains:["self"]}]}]},V,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+c.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:true,label:"func.def",contains:[Z,c.inherit(c.TITLE_MODE,{begin:E,className:"title.function"})]},{match:/\.\.\./,relevance:0},ae,{match:"\\$"+E,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[Z]},G,j,J,de,{match:/\$[(.]/}]}}return Lg=p,Lg}var Ng,L$;function FF(){if(L$)return Ng;L$=1;function s(n){const i={className:"attr",begin:/"(\\.|[^\\"\r\n])*"(?=\s*:)/,relevance:1.01},o={match:/[{}[\],:]/,className:"punctuation",relevance:0},l=["true","false","null"],h={scope:"literal",beginKeywords:l.join(" ")};return{name:"JSON",keywords:{literal:l},contains:[i,o,n.QUOTE_STRING_MODE,h,n.C_NUMBER_MODE,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE],illegal:"\\S"}}return Ng=s,Ng}var Mg,N$;function GF(){if(N$)return Mg;N$=1;var s="[0-9](_*[0-9])*",n=`\\.(${s})`,i="[0-9a-fA-F](_*[0-9a-fA-F])*",o={className:"number",variants:[{begin:`(\\b(${s})((${n})|\\.)?|(${n}))[eE][+-]?(${s})[fFdD]?\\b`},{begin:`\\b(${s})((${n})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${n})[fFdD]?\\b`},{begin:`\\b(${s})[fFdD]\\b`},{begin:`\\b0[xX]((${i})\\.?|(${i})?\\.(${i}))[pP][+-]?(${s})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${i})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function l(h){const f={keyword:"abstract as val var vararg get set class object open private protected public noinline crossinline dynamic final enum if else do while for when throw try catch finally import package is in fun override companion reified inline lateinit init interface annotation data sealed internal infix operator out by constructor super tailrec where const inner suspend typealias external expect actual",built_in:"Byte Short Char Int Long Boolean Float Double Void Unit Nothing",literal:"true false null"},u={className:"keyword",begin:/\b(break|continue|return|this)\b/,starts:{contains:[{className:"symbol",begin:/@\w+/}]}},p={className:"symbol",begin:h.UNDERSCORE_IDENT_RE+"@"},c={className:"subst",begin:/\$\{/,end:/\}/,contains:[h.C_NUMBER_MODE]},_={className:"variable",begin:"\\$"+h.UNDERSCORE_IDENT_RE},m={className:"string",variants:[{begin:'"""',end:'"""(?=[^"])',contains:[_,c]},{begin:"'",end:"'",illegal:/\n/,contains:[h.BACKSLASH_ESCAPE]},{begin:'"',end:'"',illegal:/\n/,contains:[h.BACKSLASH_ESCAPE,_,c]}]};c.contains.push(m);const E={className:"meta",begin:"@(?:file|property|field|get|set|receiver|param|setparam|delegate)\\s*:(?:\\s*"+h.UNDERSCORE_IDENT_RE+")?"},b={className:"meta",begin:"@"+h.UNDERSCORE_IDENT_RE,contains:[{begin:/\(/,end:/\)/,contains:[h.inherit(m,{className:"string"}),"self"]}]},T=o,y=h.COMMENT("/\\*","\\*/",{contains:[h.C_BLOCK_COMMENT_MODE]}),g={variants:[{className:"type",begin:h.UNDERSCORE_IDENT_RE},{begin:/\(/,end:/\)/,contains:[]}]},$=g;return $.variants[1].contains=[g],g.variants[1].contains=[$],{name:"Kotlin",aliases:["kt","kts"],keywords:f,contains:[h.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"}]}),h.C_LINE_COMMENT_MODE,y,u,p,E,b,{className:"function",beginKeywords:"fun",end:"[(]|$",returnBegin:true,excludeEnd:true,keywords:f,relevance:5,contains:[{begin:h.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:true,relevance:0,contains:[h.UNDERSCORE_TITLE_MODE]},{className:"type",begin:/</,end:/>/,keywords:"reified",relevance:0},{className:"params",begin:/\(/,end:/\)/,endsParent:true,keywords:f,relevance:0,contains:[{begin:/:/,end:/[=,\/]/,endsWithParent:true,contains:[g,h.C_LINE_COMMENT_MODE,y],relevance:0},h.C_LINE_COMMENT_MODE,y,E,b,m,h.C_NUMBER_MODE]},y]},{begin:[/class|interface|trait/,/\s+/,h.UNDERSCORE_IDENT_RE],beginScope:{3:"title.class"},keywords:"class interface trait",end:/[:\{(]|$/,excludeEnd:true,illegal:"extends implements",contains:[{beginKeywords:"public protected internal private constructor"},h.UNDERSCORE_TITLE_MODE,{className:"type",begin:/</,end:/>/,excludeBegin:true,excludeEnd:true,relevance:0},{className:"type",begin:/[,:]\s*/,end:/[<\(,){\s]|$/,excludeBegin:true,returnEnd:true},E,b]},m,{className:"meta",begin:"^#!/usr/bin/env",end:"$",illegal:`
`},T]}}return Mg=l,Mg}var Dg,M$;function HF(){if(M$)return Dg;M$=1;const s=p=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:p.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[p.APOS_STRING_MODE,p.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:p.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z][A-Za-z0-9_-]*/}}),n=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","p","q","quote","samp","section","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],i=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"],o=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"],l=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"],h=["align-content","align-items","align-self","all","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","content-visibility","counter-increment","counter-reset","cue","cue-after","cue-before","cursor","direction","display","empty-cells","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-smoothing","font-stretch","font-style","font-synthesis","font-variant","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","inline-size","isolation","justify-content","left","letter-spacing","line-break","line-height","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","perspective","perspective-origin","pointer-events","position","quotes","resize","rest","rest-after","rest-before","right","row-gap","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","speak","speak-as","src","tab-size","table-layout","text-align","text-align-all","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-transform","text-underline-position","top","transform","transform-box","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","z-index"].reverse(),f=o.concat(l);function u(p){const c=s(p),_=f,m="and or not only",E="[\\w-]+",b="("+E+"|@\\{"+E+"\\})",T=[],y=[],g=function(B){return{className:"string",begin:"~?"+B+".*?"+B}},$=function(B,H,F){return{className:B,begin:H,relevance:F}},R={$pattern:/[a-z-]+/,keyword:m,attribute:i.join(" ")},v={begin:"\\(",end:"\\)",contains:y,keywords:R,relevance:0};y.push(p.C_LINE_COMMENT_MODE,p.C_BLOCK_COMMENT_MODE,g("'"),g('"'),c.CSS_NUMBER_MODE,{begin:"(url|data-uri)\\(",starts:{className:"string",end:"[\\)\\n]",excludeEnd:true}},c.HEXCOLOR,v,$("variable","@@?"+E,10),$("variable","@\\{"+E+"\\}"),$("built_in","~?`[^`]*?`"),{className:"attribute",begin:E+"\\s*:",end:":",returnBegin:true,excludeEnd:true},c.IMPORTANT,{beginKeywords:"and not"},c.FUNCTION_DISPATCH);const S=y.concat({begin:/\{/,end:/\}/,contains:T}),O={beginKeywords:"when",endsWithParent:true,contains:[{beginKeywords:"and not"}].concat(y)},w={begin:b+"\\s*:",returnBegin:true,end:/[;}]/,relevance:0,contains:[{begin:/-(webkit|moz|ms|o)-/},c.CSS_VARIABLE,{className:"attribute",begin:"\\b("+h.join("|")+")\\b",end:/(?=:)/,starts:{endsWithParent:true,illegal:"[<=$]",relevance:0,contains:y}}]},A={className:"keyword",begin:"@(import|media|charset|font-face|(-[a-z]+-)?keyframes|supports|document|namespace|page|viewport|host)\\b",starts:{end:"[;{}]",keywords:R,returnEnd:true,contains:y,relevance:0}},I={className:"variable",variants:[{begin:"@"+E+"\\s*:",relevance:15},{begin:"@"+E}],starts:{end:"[;}]",returnEnd:true,contains:S}},L={variants:[{begin:"[\\.#:&\\[>]",end:"[;{}]"},{begin:b,end:/\{/}],returnBegin:true,returnEnd:true,illegal:`[<='$"]`,relevance:0,contains:[p.C_LINE_COMMENT_MODE,p.C_BLOCK_COMMENT_MODE,O,$("keyword","all\\b"),$("variable","@\\{"+E+"\\}"),{begin:"\\b("+n.join("|")+")\\b",className:"selector-tag"},c.CSS_NUMBER_MODE,$("selector-tag",b,0),$("selector-id","#"+b),$("selector-class","\\."+b,0),$("selector-tag","&",0),c.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",begin:":("+o.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+l.join("|")+")"},{begin:/\(/,end:/\)/,relevance:0,contains:S},{begin:"!important"},c.FUNCTION_DISPATCH]},x={begin:E+`:(:)?(${_.join("|")})`,returnBegin:true,contains:[L]};return T.push(p.C_LINE_COMMENT_MODE,p.C_BLOCK_COMMENT_MODE,A,I,x,w,L,O,c.FUNCTION_DISPATCH),{name:"Less",case_insensitive:true,illegal:`[=>'/<($"]`,contains:T}}return Dg=u,Dg}var xg,D$;function VF(){if(D$)return xg;D$=1;function s(n){const i="\\[=*\\[",o="\\]=*\\]",l={begin:i,end:o,contains:["self"]},h=[n.COMMENT("--(?!"+i+")","$"),n.COMMENT("--"+i,o,{contains:[l],relevance:10})];return{name:"Lua",keywords:{$pattern:n.UNDERSCORE_IDENT_RE,literal:"true false nil",keyword:"and break do else elseif end for goto if in local not or repeat return then until while",built_in:"_G _ENV _VERSION __index __newindex __mode __call __metatable __tostring __len __gc __add __sub __mul __div __mod __pow __concat __unm __eq __lt __le assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall arg self coroutine resume yield status wrap create running debug getupvalue debug sethook getmetatable gethook setmetatable setlocal traceback setfenv getinfo setupvalue getlocal getregistry getfenv io lines write close flush open output type read stderr stdin input stdout popen tmpfile math log max acos huge ldexp pi cos tanh pow deg tan cosh sinh random randomseed frexp ceil floor rad abs sqrt modf asin min mod fmod log10 atan2 exp sin atan os exit setlocale date getenv difftime remove time clock tmpname rename execute package preload loadlib loaded loaders cpath config path seeall string sub upper len gfind rep find match char dump gmatch reverse byte format gsub lower table setn insert getn foreachi maxn foreach concat sort remove"},contains:h.concat([{className:"function",beginKeywords:"function",end:"\\)",contains:[n.inherit(n.TITLE_MODE,{begin:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{className:"params",begin:"\\(",endsWithParent:true,contains:h}].concat(h)},n.C_NUMBER_MODE,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE,{className:"string",begin:i,end:o,contains:[l],relevance:5}])}}return xg=s,xg}var Bg,x$;function WF(){if(x$)return Bg;x$=1;function s(n){const i={className:"variable",variants:[{begin:"\\$\\("+n.UNDERSCORE_IDENT_RE+"\\)",contains:[n.BACKSLASH_ESCAPE]},{begin:/\$[@%<?\^\+\*]/}]},o={className:"string",begin:/"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,i]},l={className:"variable",begin:/\$\([\w-]+\s/,end:/\)/,keywords:{built_in:"subst patsubst strip findstring filter filter-out sort word wordlist firstword lastword dir notdir suffix basename addsuffix addprefix join wildcard realpath abspath error warning shell origin flavor foreach if or and call eval file value"},contains:[i]},h={begin:"^"+n.UNDERSCORE_IDENT_RE+"\\s*(?=[:+?]?=)"},f={className:"meta",begin:/^\.PHONY:/,end:/$/,keywords:{$pattern:/[\.\w]+/,keyword:".PHONY"}},u={className:"section",begin:/^[^\s]+:/,end:/$/,contains:[i]};return{name:"Makefile",aliases:["mk","mak","make"],keywords:{$pattern:/[\w-]+/,keyword:"define endef undefine ifdef ifndef ifeq ifneq else endif include -include sinclude override export unexport private vpath"},contains:[n.HASH_COMMENT_MODE,i,o,l,h,f,u]}}return Bg=s,Bg}var Pg,B$;function zF(){if(B$)return Pg;B$=1;function s(n){const i=n.regex,o=["abs","accept","alarm","and","atan2","bind","binmode","bless","break","caller","chdir","chmod","chomp","chop","chown","chr","chroot","close","closedir","connect","continue","cos","crypt","dbmclose","dbmopen","defined","delete","die","do","dump","each","else","elsif","endgrent","endhostent","endnetent","endprotoent","endpwent","endservent","eof","eval","exec","exists","exit","exp","fcntl","fileno","flock","for","foreach","fork","format","formline","getc","getgrent","getgrgid","getgrnam","gethostbyaddr","gethostbyname","gethostent","getlogin","getnetbyaddr","getnetbyname","getnetent","getpeername","getpgrp","getpriority","getprotobyname","getprotobynumber","getprotoent","getpwent","getpwnam","getpwuid","getservbyname","getservbyport","getservent","getsockname","getsockopt","given","glob","gmtime","goto","grep","gt","hex","if","index","int","ioctl","join","keys","kill","last","lc","lcfirst","length","link","listen","local","localtime","log","lstat","lt","ma","map","mkdir","msgctl","msgget","msgrcv","msgsnd","my","ne","next","no","not","oct","open","opendir","or","ord","our","pack","package","pipe","pop","pos","print","printf","prototype","push","q|0","qq","quotemeta","qw","qx","rand","read","readdir","readline","readlink","readpipe","recv","redo","ref","rename","require","reset","return","reverse","rewinddir","rindex","rmdir","say","scalar","seek","seekdir","select","semctl","semget","semop","send","setgrent","sethostent","setnetent","setpgrp","setpriority","setprotoent","setpwent","setservent","setsockopt","shift","shmctl","shmget","shmread","shmwrite","shutdown","sin","sleep","socket","socketpair","sort","splice","split","sprintf","sqrt","srand","stat","state","study","sub","substr","symlink","syscall","sysopen","sysread","sysseek","system","syswrite","tell","telldir","tie","tied","time","times","tr","truncate","uc","ucfirst","umask","undef","unless","unlink","unpack","unshift","untie","until","use","utime","values","vec","wait","waitpid","wantarray","warn","when","while","write","x|0","xor","y|0"],l=/[dualxmsipngr]{0,12}/,h={$pattern:/[\w.]+/,keyword:o.join(" ")},f={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:h},u={begin:/->\{/,end:/\}/},p={variants:[{begin:/\$\d/},{begin:i.concat(/[$%@](\^\w\b|#\w+(::\w+)*|\{\w+\}|\w+(::\w*)*)/,"(?![A-Za-z])(?![@$%])")},{begin:/[$%@][^\s\w{]/,relevance:0}]},c=[n.BACKSLASH_ESCAPE,f,p],_=[/!/,/\//,/\|/,/\?/,/'/,/"/,/#/],m=(T,y,g="\\1")=>{const $=g==="\\1"?g:i.concat(g,y);return i.concat(i.concat("(?:",T,")"),y,/(?:\\.|[^\\\/])*?/,$,/(?:\\.|[^\\\/])*?/,g,l)},E=(T,y,g)=>i.concat(i.concat("(?:",T,")"),y,/(?:\\.|[^\\\/])*?/,g,l),b=[p,n.HASH_COMMENT_MODE,n.COMMENT(/^=\w/,/=cut/,{endsWithParent:true}),u,{className:"string",contains:c,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*<",end:">",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[n.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[n.BACKSLASH_ESCAPE]},{begin:/\{\w+\}/,relevance:0},{begin:"-?\\w+\\s*=>",relevance:0}]},{className:"number",begin:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",relevance:0},{begin:"(\\/\\/|"+n.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[n.HASH_COMMENT_MODE,{className:"regexp",variants:[{begin:m("s|tr|y",i.either(..._,{capture:true}))},{begin:m("s|tr|y","\\(","\\)")},{begin:m("s|tr|y","\\[","\\]")},{begin:m("s|tr|y","\\{","\\}")}],relevance:2},{className:"regexp",variants:[{begin:/(m|qr)\/\//,relevance:0},{begin:E("(?:m|qr)?",/\//,/\//)},{begin:E("m|qr",i.either(..._,{capture:true}),/\1/)},{begin:E("m|qr",/\(/,/\)/)},{begin:E("m|qr",/\[/,/\]/)},{begin:E("m|qr",/\{/,/\}/)}]}]},{className:"function",beginKeywords:"sub",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:true,relevance:5,contains:[n.TITLE_MODE]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return f.contains=b,u.contains=b,{name:"Perl",aliases:["pl","pm"],keywords:h,contains:b}}return Pg=s,Pg}var Ug,P$;function jF(){if(P$)return Ug;P$=1;function s(n){const i={className:"built_in",begin:"\\b(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)\\w+"},o=/[a-zA-Z@][a-zA-Z0-9_]*/,p={"variable.language":["this","super"],$pattern:o,keyword:["while","export","sizeof","typedef","const","struct","for","union","volatile","static","mutable","if","do","return","goto","enum","else","break","extern","asm","case","default","register","explicit","typename","switch","continue","inline","readonly","assign","readwrite","self","@synchronized","id","typeof","nonatomic","IBOutlet","IBAction","strong","weak","copy","in","out","inout","bycopy","byref","oneway","__strong","__weak","__block","__autoreleasing","@private","@protected","@public","@try","@property","@end","@throw","@catch","@finally","@autoreleasepool","@synthesize","@dynamic","@selector","@optional","@required","@encode","@package","@import","@defs","@compatibility_alias","__bridge","__bridge_transfer","__bridge_retained","__bridge_retain","__covariant","__contravariant","__kindof","_Nonnull","_Nullable","_Null_unspecified","__FUNCTION__","__PRETTY_FUNCTION__","__attribute__","getter","setter","retain","unsafe_unretained","nonnull","nullable","null_unspecified","null_resettable","class","instancetype","NS_DESIGNATED_INITIALIZER","NS_UNAVAILABLE","NS_REQUIRES_SUPER","NS_RETURNS_INNER_POINTER","NS_INLINE","NS_AVAILABLE","NS_DEPRECATED","NS_ENUM","NS_OPTIONS","NS_SWIFT_UNAVAILABLE","NS_ASSUME_NONNULL_BEGIN","NS_ASSUME_NONNULL_END","NS_REFINED_FOR_SWIFT","NS_SWIFT_NAME","NS_SWIFT_NOTHROW","NS_DURING","NS_HANDLER","NS_ENDHANDLER","NS_VALUERETURN","NS_VOIDRETURN"],literal:["false","true","FALSE","TRUE","nil","YES","NO","NULL"],built_in:["dispatch_once_t","dispatch_queue_t","dispatch_sync","dispatch_async","dispatch_once"],type:["int","float","char","unsigned","signed","short","long","double","wchar_t","unichar","void","bool","BOOL","id|0","_Bool"]},c={$pattern:o,keyword:["@interface","@class","@protocol","@implementation"]};return{name:"Objective-C",aliases:["mm","objc","obj-c","obj-c++","objective-c++"],keywords:p,illegal:"</",contains:[i,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE,n.C_NUMBER_MODE,n.QUOTE_STRING_MODE,n.APOS_STRING_MODE,{className:"string",variants:[{begin:'@"',end:'"',illegal:"\\n",contains:[n.BACKSLASH_ESCAPE]}]},{className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},n.inherit(n.QUOTE_STRING_MODE,{className:"string"}),{className:"string",begin:/<.*?>/,end:/$/,illegal:"\\n"},n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{className:"class",begin:"("+c.keyword.join("|")+")\\b",end:/(\{|$)/,excludeEnd:true,keywords:c,contains:[n.UNDERSCORE_TITLE_MODE]},{begin:"\\."+n.UNDERSCORE_IDENT_RE,relevance:0}]}}return Ug=s,Ug}var Fg,U$;function XF(){if(U$)return Fg;U$=1;function s(n){const i=n.regex,o=/(?![A-Za-z0-9])(?![$])/,l=i.concat(/[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/,o),h=i.concat(/(\\?[A-Z][a-z0-9_\x7f-\xff]+|\\?[A-Z]+(?=[A-Z][a-z0-9_\x7f-\xff])){1,}/,o),f={scope:"variable",match:"\\$+"+l},u={scope:"meta",variants:[{begin:/<\?php/,relevance:10},{begin:/<\?=/},{begin:/<\?/,relevance:.1},{begin:/\?>/}]},p={scope:"subst",variants:[{begin:/\$\w+/},{begin:/\{\$/,end:/\}/}]},c=n.inherit(n.APOS_STRING_MODE,{illegal:null}),_=n.inherit(n.QUOTE_STRING_MODE,{illegal:null,contains:n.QUOTE_STRING_MODE.contains.concat(p)}),m={begin:/<<<[ \t]*(?:(\w+)|"(\w+)")\n/,end:/[ \t]*(\w+)\b/,contains:n.QUOTE_STRING_MODE.contains.concat(p),"on:begin":(X,Z)=>{Z.data._beginMatch=X[1]||X[2]},"on:end":(X,Z)=>{Z.data._beginMatch!==X[1]&&Z.ignoreMatch()}},E=n.END_SAME_AS_BEGIN({begin:/<<<[ \t]*'(\w+)'\n/,end:/[ \t]*(\w+)\b/}),b=`[ 	
]`,T={scope:"string",variants:[_,c,m,E]},y={scope:"number",variants:[{begin:"\\b0[bB][01]+(?:_[01]+)*\\b"},{begin:"\\b0[oO][0-7]+(?:_[0-7]+)*\\b"},{begin:"\\b0[xX][\\da-fA-F]+(?:_[\\da-fA-F]+)*\\b"},{begin:"(?:\\b\\d+(?:_\\d+)*(\\.(?:\\d+(?:_\\d+)*))?|\\B\\.\\d+)(?:[eE][+-]?\\d+)?"}],relevance:0},g=["false","null","true"],$=["__CLASS__","__DIR__","__FILE__","__FUNCTION__","__COMPILER_HALT_OFFSET__","__LINE__","__METHOD__","__NAMESPACE__","__TRAIT__","die","echo","exit","include","include_once","print","require","require_once","array","abstract","and","as","binary","bool","boolean","break","callable","case","catch","class","clone","const","continue","declare","default","do","double","else","elseif","empty","enddeclare","endfor","endforeach","endif","endswitch","endwhile","enum","eval","extends","final","finally","float","for","foreach","from","global","goto","if","implements","instanceof","insteadof","int","integer","interface","isset","iterable","list","match|0","mixed","new","never","object","or","private","protected","public","readonly","real","return","string","switch","throw","trait","try","unset","use","var","void","while","xor","yield"],R=["Error|0","AppendIterator","ArgumentCountError","ArithmeticError","ArrayIterator","ArrayObject","AssertionError","BadFunctionCallException","BadMethodCallException","CachingIterator","CallbackFilterIterator","CompileError","Countable","DirectoryIterator","DivisionByZeroError","DomainException","EmptyIterator","ErrorException","Exception","FilesystemIterator","FilterIterator","GlobIterator","InfiniteIterator","InvalidArgumentException","IteratorIterator","LengthException","LimitIterator","LogicException","MultipleIterator","NoRewindIterator","OutOfBoundsException","OutOfRangeException","OuterIterator","OverflowException","ParentIterator","ParseError","RangeException","RecursiveArrayIterator","RecursiveCachingIterator","RecursiveCallbackFilterIterator","RecursiveDirectoryIterator","RecursiveFilterIterator","RecursiveIterator","RecursiveIteratorIterator","RecursiveRegexIterator","RecursiveTreeIterator","RegexIterator","RuntimeException","SeekableIterator","SplDoublyLinkedList","SplFileInfo","SplFileObject","SplFixedArray","SplHeap","SplMaxHeap","SplMinHeap","SplObjectStorage","SplObserver","SplPriorityQueue","SplQueue","SplStack","SplSubject","SplTempFileObject","TypeError","UnderflowException","UnexpectedValueException","UnhandledMatchError","ArrayAccess","BackedEnum","Closure","Fiber","Generator","Iterator","IteratorAggregate","Serializable","Stringable","Throwable","Traversable","UnitEnum","WeakReference","WeakMap","Directory","__PHP_Incomplete_Class","parent","php_user_filter","self","static","stdClass"],S={keyword:$,literal:(X=>{const Z=[];return X.forEach(J=>{Z.push(J),J.toLowerCase()===J?Z.push(J.toUpperCase()):Z.push(J.toLowerCase())}),Z})(g),built_in:R},O=X=>X.map(Z=>Z.replace(/\|\d+$/,"")),w={variants:[{match:[/new/,i.concat(b,"+"),i.concat("(?!",O(R).join("\\b|"),"\\b)"),h],scope:{1:"keyword",4:"title.class"}}]},A=i.concat(l,"\\b(?!\\()"),I={variants:[{match:[i.concat(/::/,i.lookahead(/(?!class\b)/)),A],scope:{2:"variable.constant"}},{match:[/::/,/class/],scope:{2:"variable.language"}},{match:[h,i.concat(/::/,i.lookahead(/(?!class\b)/)),A],scope:{1:"title.class",3:"variable.constant"}},{match:[h,i.concat("::",i.lookahead(/(?!class\b)/))],scope:{1:"title.class"}},{match:[h,/::/,/class/],scope:{1:"title.class",3:"variable.language"}}]},L={scope:"attr",match:i.concat(l,i.lookahead(":"),i.lookahead(/(?!::)/))},x={relevance:0,begin:/\(/,end:/\)/,keywords:S,contains:[L,f,I,n.C_BLOCK_COMMENT_MODE,T,y,w]},B={relevance:0,match:[/\b/,i.concat("(?!fn\\b|function\\b|",O($).join("\\b|"),"|",O(R).join("\\b|"),"\\b)"),l,i.concat(b,"*"),i.lookahead(/(?=\()/)],scope:{3:"title.function.invoke"},contains:[x]};x.contains.push(B);const H=[L,I,n.C_BLOCK_COMMENT_MODE,T,y,w],F={begin:i.concat(/#\[\s*/,h),beginScope:"meta",end:/]/,endScope:"meta",keywords:{literal:g,keyword:["new","array"]},contains:[{begin:/\[/,end:/]/,keywords:{literal:g,keyword:["new","array"]},contains:["self",...H]},...H,{scope:"meta",match:h}]};return{case_insensitive:false,keywords:S,contains:[F,n.HASH_COMMENT_MODE,n.COMMENT("//","$"),n.COMMENT("/\\*","\\*/",{contains:[{scope:"doctag",match:"@[A-Za-z]+"}]}),{match:/__halt_compiler\(\);/,keywords:"__halt_compiler",starts:{scope:"comment",end:n.MATCH_NOTHING_RE,contains:[{match:/\?>/,scope:"meta",endsParent:true}]}},u,{scope:"variable.language",match:/\$this\b/},f,B,I,{match:[/const/,/\s/,l],scope:{1:"keyword",3:"variable.constant"}},w,{scope:"function",relevance:0,beginKeywords:"fn function",end:/[;{]/,excludeEnd:true,illegal:"[$%\\[]",contains:[{beginKeywords:"use"},n.UNDERSCORE_TITLE_MODE,{begin:"=>",endsParent:true},{scope:"params",begin:"\\(",end:"\\)",excludeBegin:true,excludeEnd:true,keywords:S,contains:["self",f,I,n.C_BLOCK_COMMENT_MODE,T,y]}]},{scope:"class",variants:[{beginKeywords:"enum",illegal:/[($"]/},{beginKeywords:"class interface trait",illegal:/[:($"]/}],relevance:0,end:/\{/,excludeEnd:true,contains:[{beginKeywords:"extends implements"},n.UNDERSCORE_TITLE_MODE]},{beginKeywords:"namespace",relevance:0,end:";",illegal:/[.']/,contains:[n.inherit(n.UNDERSCORE_TITLE_MODE,{scope:"title.class"})]},{beginKeywords:"use",relevance:0,end:";",contains:[{match:/\b(as|const|function)\b/,scope:"keyword"},n.UNDERSCORE_TITLE_MODE]},T,y]}}return Fg=s,Fg}var Gg,F$;function KF(){if(F$)return Gg;F$=1;function s(n){return{name:"PHP template",subLanguage:"xml",contains:[{begin:/<\?(php|=)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:true},{begin:'b"',end:'"',skip:true},{begin:"b'",end:"'",skip:true},n.inherit(n.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:true}),n.inherit(n.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:true})]}]}}return Gg=s,Gg}var Hg,G$;function YF(){if(G$)return Hg;G$=1;function s(n){return{name:"Plain text",aliases:["text","txt"],disableAutodetect:true}}return Hg=s,Hg}var Vg,H$;function qF(){if(H$)return Vg;H$=1;function s(n){const i=n.regex,o=/[\p{XID_Start}_]\p{XID_Continue}*/u,l=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],p={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:l,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},c={className:"meta",begin:/^(>>>|\.\.\.) /},_={className:"subst",begin:/\{/,end:/\}/,keywords:p,illegal:/#/},m={begin:/\{\{/,relevance:0},E={className:"string",contains:[n.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[n.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[n.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[n.BACKSLASH_ESCAPE,c,m,_]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[n.BACKSLASH_ESCAPE,c,m,_]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[n.BACKSLASH_ESCAPE,m,_]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,m,_]},n.APOS_STRING_MODE,n.QUOTE_STRING_MODE]},b="[0-9](_?[0-9])*",T=`(\\b(${b}))?\\.(${b})|\\b(${b})\\.`,y=`\\b|${l.join("|")}`,g={className:"number",relevance:0,variants:[{begin:`(\\b(${b})|(${T}))[eE][+-]?(${b})[jJ]?(?=${y})`},{begin:`(${T})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${y})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${y})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${y})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${y})`},{begin:`\\b(${b})[jJ](?=${y})`}]},$={className:"comment",begin:i.lookahead(/# type:/),end:/$/,keywords:p,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:true}]},R={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:true},{begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:p,contains:["self",c,g,E,n.HASH_COMMENT_MODE]}]};return _.contains=[E,g,c],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:true,keywords:p,illegal:/(<\/|\?)|=>/,contains:[c,g,{begin:/\bself\b/},{beginKeywords:"if",relevance:0},E,$,n.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,o],scope:{1:"keyword",3:"title.function"},contains:[R]},{variants:[{match:[/\bclass/,/\s+/,o,/\s*/,/\(\s*/,o,/\s*\)/]},{match:[/\bclass/,/\s+/,o]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[g,R,E]}]}}return Vg=s,Vg}var Wg,V$;function JF(){if(V$)return Wg;V$=1;function s(n){return{aliases:["pycon"],contains:[{className:"meta.prompt",starts:{end:/ |$/,starts:{end:"$",subLanguage:"python"}},variants:[{begin:/^>>>(?=[ ]|$)/},{begin:/^\.\.\.(?=[ ]|$)/}]}]}}return Wg=s,Wg}var zg,W$;function ZF(){if(W$)return zg;W$=1;function s(n){const i=n.regex,o=/(?:(?:[a-zA-Z]|\.[._a-zA-Z])[._a-zA-Z0-9]*)|\.(?!\d)/,l=i.either(/0[xX][0-9a-fA-F]+\.[0-9a-fA-F]*[pP][+-]?\d+i?/,/0[xX][0-9a-fA-F]+(?:[pP][+-]?\d+)?[Li]?/,/(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?[Li]?/),h=/[=!<>:]=|\|\||&&|:::?|<-|<<-|->>|->|\|>|[-+*\/?!$&|:<=>@^~]|\*\*/,f=i.either(/[()]/,/[{}]/,/\[\[/,/[[\]]/,/\\/,/,/);return{name:"R",keywords:{$pattern:o,keyword:"function if in break next repeat else for while",literal:"NULL NA TRUE FALSE Inf NaN NA_integer_|10 NA_real_|10 NA_character_|10 NA_complex_|10",built_in:"LETTERS letters month.abb month.name pi T F abs acos acosh all any anyNA Arg as.call as.character as.complex as.double as.environment as.integer as.logical as.null.default as.numeric as.raw asin asinh atan atanh attr attributes baseenv browser c call ceiling class Conj cos cosh cospi cummax cummin cumprod cumsum digamma dim dimnames emptyenv exp expression floor forceAndCall gamma gc.time globalenv Im interactive invisible is.array is.atomic is.call is.character is.complex is.double is.environment is.expression is.finite is.function is.infinite is.integer is.language is.list is.logical is.matrix is.na is.name is.nan is.null is.numeric is.object is.pairlist is.raw is.recursive is.single is.symbol lazyLoadDBfetch length lgamma list log max min missing Mod names nargs nzchar oldClass on.exit pos.to.env proc.time prod quote range Re rep retracemem return round seq_along seq_len seq.int sign signif sin sinh sinpi sqrt standardGeneric substitute sum switch tan tanh tanpi tracemem trigamma trunc unclass untracemem UseMethod xtfrm"},contains:[n.COMMENT(/#'/,/$/,{contains:[{scope:"doctag",match:/@examples/,starts:{end:i.lookahead(i.either(/\n^#'\s*(?=@[a-zA-Z]+)/,/\n^(?!#')/)),endsParent:true}},{scope:"doctag",begin:"@param",end:/$/,contains:[{scope:"variable",variants:[{match:o},{match:/`(?:\\.|[^`\\])+`/}],endsParent:true}]},{scope:"doctag",match:/@[a-zA-Z]+/},{scope:"keyword",match:/\\[a-zA-Z]+/}]}),n.HASH_COMMENT_MODE,{scope:"string",contains:[n.BACKSLASH_ESCAPE],variants:[n.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\(/,end:/\)(-*)"/}),n.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\{/,end:/\}(-*)"/}),n.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\[/,end:/\](-*)"/}),n.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\(/,end:/\)(-*)'/}),n.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\{/,end:/\}(-*)'/}),n.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\[/,end:/\](-*)'/}),{begin:'"',end:'"',relevance:0},{begin:"'",end:"'",relevance:0}]},{relevance:0,variants:[{scope:{1:"operator",2:"number"},match:[h,l]},{scope:{1:"operator",2:"number"},match:[/%[^%]*%/,l]},{scope:{1:"punctuation",2:"number"},match:[f,l]},{scope:{2:"number"},match:[/[^a-zA-Z0-9._]|^/,l]}]},{scope:{3:"operator"},match:[o,/\s+/,/<-/,/\s+/]},{scope:"operator",relevance:0,variants:[{match:h},{match:/%[^%]*%/}]},{scope:"punctuation",relevance:0,match:f},{begin:"`",end:"`",contains:[{begin:/\\./}]}]}}return zg=s,zg}var jg,z$;function QF(){if(z$)return jg;z$=1;function s(n){const i=n.regex,o={className:"title.function.invoke",relevance:0,begin:i.concat(/\b/,/(?!let\b)/,n.IDENT_RE,i.lookahead(/\s*\(/))},l="([ui](8|16|32|64|128|size)|f(32|64))?",h=["abstract","as","async","await","become","box","break","const","continue","crate","do","dyn","else","enum","extern","false","final","fn","for","if","impl","in","let","loop","macro","match","mod","move","mut","override","priv","pub","ref","return","self","Self","static","struct","super","trait","true","try","type","typeof","unsafe","unsized","use","virtual","where","while","yield"],f=["true","false","Some","None","Ok","Err"],u=["drop ","Copy","Send","Sized","Sync","Drop","Fn","FnMut","FnOnce","ToOwned","Clone","Debug","PartialEq","PartialOrd","Eq","Ord","AsRef","AsMut","Into","From","Default","Iterator","Extend","IntoIterator","DoubleEndedIterator","ExactSizeIterator","SliceConcatExt","ToString","assert!","assert_eq!","bitflags!","bytes!","cfg!","col!","concat!","concat_idents!","debug_assert!","debug_assert_eq!","env!","panic!","file!","format!","format_args!","include_bytes!","include_str!","line!","local_data_key!","module_path!","option_env!","print!","println!","select!","stringify!","try!","unimplemented!","unreachable!","vec!","write!","writeln!","macro_rules!","assert_ne!","debug_assert_ne!"],p=["i8","i16","i32","i64","i128","isize","u8","u16","u32","u64","u128","usize","f32","f64","str","char","bool","Box","Option","Result","String","Vec"];return{name:"Rust",aliases:["rs"],keywords:{$pattern:n.IDENT_RE+"!?",type:p,keyword:h,literal:f,built_in:u},illegal:"</",contains:[n.C_LINE_COMMENT_MODE,n.COMMENT("/\\*","\\*/",{contains:["self"]}),n.inherit(n.QUOTE_STRING_MODE,{begin:/b?"/,illegal:null}),{className:"string",variants:[{begin:/b?r(#*)"(.|\n)*?"\1(?!#)/},{begin:/b?'\\?(x\w{2}|u\w{4}|U\w{8}|.)'/}]},{className:"symbol",begin:/'[a-zA-Z_][a-zA-Z0-9_]*/},{className:"number",variants:[{begin:"\\b0b([01_]+)"+l},{begin:"\\b0o([0-7_]+)"+l},{begin:"\\b0x([A-Fa-f0-9_]+)"+l},{begin:"\\b(\\d[\\d_]*(\\.[0-9_]+)?([eE][+-]?[0-9_]+)?)"+l}],relevance:0},{begin:[/fn/,/\s+/,n.UNDERSCORE_IDENT_RE],className:{1:"keyword",3:"title.function"}},{className:"meta",begin:"#!?\\[",end:"\\]",contains:[{className:"string",begin:/"/,end:/"/}]},{begin:[/let/,/\s+/,/(?:mut\s+)?/,n.UNDERSCORE_IDENT_RE],className:{1:"keyword",3:"keyword",4:"variable"}},{begin:[/for/,/\s+/,n.UNDERSCORE_IDENT_RE,/\s+/,/in/],className:{1:"keyword",3:"variable",5:"keyword"}},{begin:[/type/,/\s+/,n.UNDERSCORE_IDENT_RE],className:{1:"keyword",3:"title.class"}},{begin:[/(?:trait|enum|struct|union|impl|for)/,/\s+/,n.UNDERSCORE_IDENT_RE],className:{1:"keyword",3:"title.class"}},{begin:n.IDENT_RE+"::",keywords:{keyword:"Self",built_in:u,type:p}},{className:"punctuation",begin:"->"},o]}}return jg=s,jg}var Xg,j$;function eG(){if(j$)return Xg;j$=1;const s=u=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:u.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[u.APOS_STRING_MODE,u.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:u.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z][A-Za-z0-9_-]*/}}),n=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","p","q","quote","samp","section","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],i=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"],o=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"],l=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"],h=["align-content","align-items","align-self","all","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","content-visibility","counter-increment","counter-reset","cue","cue-after","cue-before","cursor","direction","display","empty-cells","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-smoothing","font-stretch","font-style","font-synthesis","font-variant","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","inline-size","isolation","justify-content","left","letter-spacing","line-break","line-height","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","perspective","perspective-origin","pointer-events","position","quotes","resize","rest","rest-after","rest-before","right","row-gap","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","speak","speak-as","src","tab-size","table-layout","text-align","text-align-all","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-transform","text-underline-position","top","transform","transform-box","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","z-index"].reverse();function f(u){const p=s(u),c=l,_=o,m="@[a-z-]+",E="and or not only",T={className:"variable",begin:"(\\$[a-zA-Z-][a-zA-Z0-9_-]*)\\b",relevance:0};return{name:"SCSS",case_insensitive:true,illegal:"[=/|']",contains:[u.C_LINE_COMMENT_MODE,u.C_BLOCK_COMMENT_MODE,p.CSS_NUMBER_MODE,{className:"selector-id",begin:"#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},p.ATTRIBUTE_SELECTOR_MODE,{className:"selector-tag",begin:"\\b("+n.join("|")+")\\b",relevance:0},{className:"selector-pseudo",begin:":("+_.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+c.join("|")+")"},T,{begin:/\(/,end:/\)/,contains:[p.CSS_NUMBER_MODE]},p.CSS_VARIABLE,{className:"attribute",begin:"\\b("+h.join("|")+")\\b"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:/:/,end:/[;}{]/,relevance:0,contains:[p.BLOCK_COMMENT,T,p.HEXCOLOR,p.CSS_NUMBER_MODE,u.QUOTE_STRING_MODE,u.APOS_STRING_MODE,p.IMPORTANT,p.FUNCTION_DISPATCH]},{begin:"@(page|font-face)",keywords:{$pattern:m,keyword:"@page @font-face"}},{begin:"@",end:"[{;]",returnBegin:true,keywords:{$pattern:/[a-z-]+/,keyword:E,attribute:i.join(" ")},contains:[{begin:m,className:"keyword"},{begin:/[a-z-]+(?=:)/,className:"attribute"},T,u.QUOTE_STRING_MODE,u.APOS_STRING_MODE,p.HEXCOLOR,p.CSS_NUMBER_MODE]},p.FUNCTION_DISPATCH]}}return Xg=f,Xg}var Kg,X$;function tG(){if(X$)return Kg;X$=1;function s(n){return{name:"Shell Session",aliases:["console","shellsession"],contains:[{className:"meta.prompt",begin:/^\s{0,3}[/~\w\d[\]()@-]*[>%$#][ ]?/,starts:{end:/[^\\](?=\s*$)/,subLanguage:"bash"}}]}}return Kg=s,Kg}var Yg,K$;function sG(){if(K$)return Yg;K$=1;function s(n){const i=n.regex,o=n.COMMENT("--","$"),l={className:"string",variants:[{begin:/'/,end:/'/,contains:[{begin:/''/}]}]},h={begin:/"/,end:/"/,contains:[{begin:/""/}]},f=["true","false","unknown"],u=["double precision","large object","with timezone","without timezone"],p=["bigint","binary","blob","boolean","char","character","clob","date","dec","decfloat","decimal","float","int","integer","interval","nchar","nclob","national","numeric","real","row","smallint","time","timestamp","varchar","varying","varbinary"],c=["add","asc","collation","desc","final","first","last","view"],_=["abs","acos","all","allocate","alter","and","any","are","array","array_agg","array_max_cardinality","as","asensitive","asin","asymmetric","at","atan","atomic","authorization","avg","begin","begin_frame","begin_partition","between","bigint","binary","blob","boolean","both","by","call","called","cardinality","cascaded","case","cast","ceil","ceiling","char","char_length","character","character_length","check","classifier","clob","close","coalesce","collate","collect","column","commit","condition","connect","constraint","contains","convert","copy","corr","corresponding","cos","cosh","count","covar_pop","covar_samp","create","cross","cube","cume_dist","current","current_catalog","current_date","current_default_transform_group","current_path","current_role","current_row","current_schema","current_time","current_timestamp","current_path","current_role","current_transform_group_for_type","current_user","cursor","cycle","date","day","deallocate","dec","decimal","decfloat","declare","default","define","delete","dense_rank","deref","describe","deterministic","disconnect","distinct","double","drop","dynamic","each","element","else","empty","end","end_frame","end_partition","end-exec","equals","escape","every","except","exec","execute","exists","exp","external","extract","false","fetch","filter","first_value","float","floor","for","foreign","frame_row","free","from","full","function","fusion","get","global","grant","group","grouping","groups","having","hold","hour","identity","in","indicator","initial","inner","inout","insensitive","insert","int","integer","intersect","intersection","interval","into","is","join","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","language","large","last_value","lateral","lead","leading","left","like","like_regex","listagg","ln","local","localtime","localtimestamp","log","log10","lower","match","match_number","match_recognize","matches","max","member","merge","method","min","minute","mod","modifies","module","month","multiset","national","natural","nchar","nclob","new","no","none","normalize","not","nth_value","ntile","null","nullif","numeric","octet_length","occurrences_regex","of","offset","old","omit","on","one","only","open","or","order","out","outer","over","overlaps","overlay","parameter","partition","pattern","per","percent","percent_rank","percentile_cont","percentile_disc","period","portion","position","position_regex","power","precedes","precision","prepare","primary","procedure","ptf","range","rank","reads","real","recursive","ref","references","referencing","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","release","result","return","returns","revoke","right","rollback","rollup","row","row_number","rows","running","savepoint","scope","scroll","search","second","seek","select","sensitive","session_user","set","show","similar","sin","sinh","skip","smallint","some","specific","specifictype","sql","sqlexception","sqlstate","sqlwarning","sqrt","start","static","stddev_pop","stddev_samp","submultiset","subset","substring","substring_regex","succeeds","sum","symmetric","system","system_time","system_user","table","tablesample","tan","tanh","then","time","timestamp","timezone_hour","timezone_minute","to","trailing","translate","translate_regex","translation","treat","trigger","trim","trim_array","true","truncate","uescape","union","unique","unknown","unnest","update","upper","user","using","value","values","value_of","var_pop","var_samp","varbinary","varchar","varying","versioning","when","whenever","where","width_bucket","window","with","within","without","year"],m=["abs","acos","array_agg","asin","atan","avg","cast","ceil","ceiling","coalesce","corr","cos","cosh","count","covar_pop","covar_samp","cume_dist","dense_rank","deref","element","exp","extract","first_value","floor","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","last_value","lead","listagg","ln","log","log10","lower","max","min","mod","nth_value","ntile","nullif","percent_rank","percentile_cont","percentile_disc","position","position_regex","power","rank","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","row_number","sin","sinh","sqrt","stddev_pop","stddev_samp","substring","substring_regex","sum","tan","tanh","translate","translate_regex","treat","trim","trim_array","unnest","upper","value_of","var_pop","var_samp","width_bucket"],E=["current_catalog","current_date","current_default_transform_group","current_path","current_role","current_schema","current_transform_group_for_type","current_user","session_user","system_time","system_user","current_time","localtime","current_timestamp","localtimestamp"],b=["create table","insert into","primary key","foreign key","not null","alter table","add constraint","grouping sets","on overflow","character set","respect nulls","ignore nulls","nulls first","nulls last","depth first","breadth first"],T=m,y=[..._,...c].filter(S=>!m.includes(S)),g={className:"variable",begin:/@[a-z0-9][a-z0-9_]*/},$={className:"operator",begin:/[-+*/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?/,relevance:0},R={begin:i.concat(/\b/,i.either(...T),/\s*\(/),relevance:0,keywords:{built_in:T}};function v(S,{exceptions:O,when:w}={}){const A=w;return O=O||[],S.map(I=>I.match(/\|\d+$/)||O.includes(I)?I:A(I)?`${I}|0`:I)}return{name:"SQL",case_insensitive:true,illegal:/[{}]|<\//,keywords:{$pattern:/\b[\w\.]+/,keyword:v(y,{when:S=>S.length<3}),literal:f,type:p,built_in:E},contains:[{begin:i.either(...b),relevance:0,keywords:{$pattern:/[\w\.]+/,keyword:y.concat(b),literal:f,type:p}},{className:"type",begin:i.either(...u)},R,g,l,h,n.C_NUMBER_MODE,n.C_BLOCK_COMMENT_MODE,o,$]}}return Yg=s,Yg}var qg,Y$;function iG(){if(Y$)return qg;Y$=1;function s(I){return I?typeof I=="string"?I:I.source:null}function n(I){return i("(?=",I,")")}function i(...I){return I.map(x=>s(x)).join("")}function o(I){const L=I[I.length-1];return typeof L=="object"&&L.constructor===Object?(I.splice(I.length-1,1),L):{}}function l(...I){return"("+(o(I).capture?"":"?:")+I.map(B=>s(B)).join("|")+")"}const h=I=>i(/\b/,I,/\w$/.test(I)?/\b/:/\B/),f=["Protocol","Type"].map(h),u=["init","self"].map(h),p=["Any","Self"],c=["actor","any","associatedtype","async","await",/as\?/,/as!/,"as","break","case","catch","class","continue","convenience","default","defer","deinit","didSet","distributed","do","dynamic","else","enum","extension","fallthrough",/fileprivate\(set\)/,"fileprivate","final","for","func","get","guard","if","import","indirect","infix",/init\?/,/init!/,"inout",/internal\(set\)/,"internal","in","is","isolated","nonisolated","lazy","let","mutating","nonmutating",/open\(set\)/,"open","operator","optional","override","postfix","precedencegroup","prefix",/private\(set\)/,"private","protocol",/public\(set\)/,"public","repeat","required","rethrows","return","set","some","static","struct","subscript","super","switch","throws","throw",/try\?/,/try!/,"try","typealias",/unowned\(safe\)/,/unowned\(unsafe\)/,"unowned","var","weak","where","while","willSet"],_=["false","nil","true"],m=["assignment","associativity","higherThan","left","lowerThan","none","right"],E=["#colorLiteral","#column","#dsohandle","#else","#elseif","#endif","#error","#file","#fileID","#fileLiteral","#filePath","#function","#if","#imageLiteral","#keyPath","#line","#selector","#sourceLocation","#warn_unqualified_access","#warning"],b=["abs","all","any","assert","assertionFailure","debugPrint","dump","fatalError","getVaList","isKnownUniquelyReferenced","max","min","numericCast","pointwiseMax","pointwiseMin","precondition","preconditionFailure","print","readLine","repeatElement","sequence","stride","swap","swift_unboxFromSwiftValueWithType","transcode","type","unsafeBitCast","unsafeDowncast","withExtendedLifetime","withUnsafeMutablePointer","withUnsafePointer","withVaList","withoutActuallyEscaping","zip"],T=l(/[/=\-+!*%<>&|^~?]/,/[\u00A1-\u00A7]/,/[\u00A9\u00AB]/,/[\u00AC\u00AE]/,/[\u00B0\u00B1]/,/[\u00B6\u00BB\u00BF\u00D7\u00F7]/,/[\u2016-\u2017]/,/[\u2020-\u2027]/,/[\u2030-\u203E]/,/[\u2041-\u2053]/,/[\u2055-\u205E]/,/[\u2190-\u23FF]/,/[\u2500-\u2775]/,/[\u2794-\u2BFF]/,/[\u2E00-\u2E7F]/,/[\u3001-\u3003]/,/[\u3008-\u3020]/,/[\u3030]/),y=l(T,/[\u0300-\u036F]/,/[\u1DC0-\u1DFF]/,/[\u20D0-\u20FF]/,/[\uFE00-\uFE0F]/,/[\uFE20-\uFE2F]/),g=i(T,y,"*"),$=l(/[a-zA-Z_]/,/[\u00A8\u00AA\u00AD\u00AF\u00B2-\u00B5\u00B7-\u00BA]/,/[\u00BC-\u00BE\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF]/,/[\u0100-\u02FF\u0370-\u167F\u1681-\u180D\u180F-\u1DBF]/,/[\u1E00-\u1FFF]/,/[\u200B-\u200D\u202A-\u202E\u203F-\u2040\u2054\u2060-\u206F]/,/[\u2070-\u20CF\u2100-\u218F\u2460-\u24FF\u2776-\u2793]/,/[\u2C00-\u2DFF\u2E80-\u2FFF]/,/[\u3004-\u3007\u3021-\u302F\u3031-\u303F\u3040-\uD7FF]/,/[\uF900-\uFD3D\uFD40-\uFDCF\uFDF0-\uFE1F\uFE30-\uFE44]/,/[\uFE47-\uFEFE\uFF00-\uFFFD]/),R=l($,/\d/,/[\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]/),v=i($,R,"*"),S=i(/[A-Z]/,R,"*"),O=["autoclosure",i(/convention\(/,l("swift","block","c"),/\)/),"discardableResult","dynamicCallable","dynamicMemberLookup","escaping","frozen","GKInspectable","IBAction","IBDesignable","IBInspectable","IBOutlet","IBSegueAction","inlinable","main","nonobjc","NSApplicationMain","NSCopying","NSManaged",i(/objc\(/,v,/\)/),"objc","objcMembers","propertyWrapper","requires_stored_property_inits","resultBuilder","testable","UIApplicationMain","unknown","usableFromInline"],w=["iOS","iOSApplicationExtension","macOS","macOSApplicationExtension","macCatalyst","macCatalystApplicationExtension","watchOS","watchOSApplicationExtension","tvOS","tvOSApplicationExtension","swift"];function A(I){const L={match:/\s+/,relevance:0},x=I.COMMENT("/\\*","\\*/",{contains:["self"]}),B=[I.C_LINE_COMMENT_MODE,x],H={match:[/\./,l(...f,...u)],className:{2:"keyword"}},F={match:i(/\./,l(...c)),relevance:0},X=c.filter(Ot=>typeof Ot=="string").concat(["_|0"]),Z=c.filter(Ot=>typeof Ot!="string").concat(p).map(h),J={variants:[{className:"keyword",match:l(...Z,...u)}]},D={$pattern:l(/\b\w+/,/#\w+/),keyword:X.concat(E),literal:_},P=[H,F,J],V={match:i(/\./,l(...b)),relevance:0},j={className:"built_in",match:i(/\b/,l(...b),/(?=\()/)},re=[V,j],G={match:/->/,relevance:0},ae={className:"operator",relevance:0,variants:[{match:g},{match:`\\.(\\.|${y})+`}]},de=[G,ae],fe="([0-9]_*)+",ee="([0-9a-fA-F]_*)+",W={className:"number",relevance:0,variants:[{match:`\\b(${fe})(\\.(${fe}))?([eE][+-]?(${fe}))?\\b`},{match:`\\b0x(${ee})(\\.(${ee}))?([pP][+-]?(${fe}))?\\b`},{match:/\b0o([0-7]_*)+\b/},{match:/\b0b([01]_*)+\b/}]},Q=(Ot="")=>({className:"subst",variants:[{match:i(/\\/,Ot,/[0\\tnr"']/)},{match:i(/\\/,Ot,/u\{[0-9a-fA-F]{1,8}\}/)}]}),ce=(Ot="")=>({className:"subst",match:i(/\\/,Ot,/[\t ]*(?:[\r\n]|\r\n)/)}),Ee=(Ot="")=>({className:"subst",label:"interpol",begin:i(/\\/,Ot,/\(/),end:/\)/}),Xe=(Ot="")=>({begin:i(Ot,/"""/),end:i(/"""/,Ot),contains:[Q(Ot),ce(Ot),Ee(Ot)]}),Re=(Ot="")=>({begin:i(Ot,/"/),end:i(/"/,Ot),contains:[Q(Ot),Ee(Ot)]}),_t={className:"string",variants:[Xe(),Xe("#"),Xe("##"),Xe("###"),Re(),Re("#"),Re("##"),Re("###")]},Ct={match:i(/`/,v,/`/)},Rt={className:"variable",match:/\$\d+/},ct={className:"variable",match:`\\$${R}+`},Ut=[Ct,Rt,ct],Ui={match:/(@|#(un)?)available/,className:"keyword",starts:{contains:[{begin:/\(/,end:/\)/,keywords:w,contains:[...de,W,_t]}]}},ai={className:"keyword",match:i(/@/,l(...O))},li={className:"meta",match:i(/@/,v)},ci=[Ui,ai,li],ks={match:n(/\b[A-Z]/),relevance:0,contains:[{className:"type",match:i(/(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)/,R,"+")},{className:"type",match:S,relevance:0},{match:/[?!]+/,relevance:0},{match:/\.\.\./,relevance:0},{match:i(/\s+&\s+/,n(S)),relevance:0}]},Es={begin:/</,end:/>/,keywords:D,contains:[...B,...P,...ci,G,ks]};ks.contains.push(Es);const $e={match:i(v,/\s*:/),keywords:"_|0",relevance:0},rt={begin:/\(/,end:/\)/,relevance:0,keywords:D,contains:["self",$e,...B,...P,...re,...de,W,_t,...Ut,...ci,ks]},pt={begin:/</,end:/>/,contains:[...B,ks]},ts={begin:l(n(i(v,/\s*:/)),n(i(v,/\s+/,v,/\s*:/))),end:/:/,relevance:0,contains:[{className:"keyword",match:/\b_\b/},{className:"params",match:v}]},ye={begin:/\(/,end:/\)/,keywords:D,contains:[ts,...B,...P,...de,W,_t,...ci,ks,rt],endsParent:true,illegal:/["']/},Zn={match:[/func/,/\s+/,l(Ct.match,v,g)],className:{1:"keyword",3:"title.function"},contains:[pt,ye,L],illegal:[/\[/,/%/]},Qn={match:[/\b(?:subscript|init[?!]?)/,/\s*(?=[<(])/],className:{1:"keyword"},contains:[pt,ye,L],illegal:/\[|%/},Fi={match:[/operator/,/\s+/,g],className:{1:"keyword",3:"title"}},er={begin:[/precedencegroup/,/\s+/,S],className:{1:"keyword",3:"title"},contains:[ks],keywords:[...m,..._],end:/}/};for(const Ot of _t.variants){const ss=Ot.contains.find(U=>U.label==="interpol");ss.keywords=D;const N=[...P,...re,...de,W,_t,...Ut];ss.contains=[...N,{begin:/\(/,end:/\)/,contains:["self",...N]}]}return{name:"Swift",keywords:D,contains:[...B,Zn,Qn,{beginKeywords:"struct protocol class extension enum actor",end:"\\{",excludeEnd:true,keywords:D,contains:[I.inherit(I.TITLE_MODE,{className:"title.class",begin:/[A-Za-z$_][\u00C0-\u02B80-9A-Za-z$_]*/}),...P]},Fi,er,{beginKeywords:"import",end:/$/,contains:[...B],relevance:0},...P,...re,...de,W,_t,...Ut,...ci,ks,rt]}}return qg=A,qg}var Jg,q$;function nG(){if(q$)return Jg;q$=1;function s(n){const i="true false yes no null",o="[\\w#;/?:@&=+$,.~*'()[\\]]+",l={className:"attr",variants:[{begin:"\\w[\\w :\\/.-]*:(?=[ 	]|$)"},{begin:'"\\w[\\w :\\/.-]*":(?=[ 	]|$)'},{begin:"'\\w[\\w :\\/.-]*':(?=[ 	]|$)"}]},h={className:"template-variable",variants:[{begin:/\{\{/,end:/\}\}/},{begin:/%\{/,end:/\}/}]},f={className:"string",relevance:0,variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/\S+/}],contains:[n.BACKSLASH_ESCAPE,h]},u=n.inherit(f,{variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/[^\s,{}[\]]+/}]}),p="[0-9]{4}(-[0-9][0-9]){0,2}",c="([Tt \\t][0-9][0-9]?(:[0-9][0-9]){2})?",_="(\\.[0-9]*)?",m="([ \\t])*(Z|[-+][0-9][0-9]?(:[0-9][0-9])?)?",E={className:"number",begin:"\\b"+p+c+_+m+"\\b"},b={end:",",endsWithParent:true,excludeEnd:true,keywords:i,relevance:0},T={begin:/\{/,end:/\}/,contains:[b],illegal:"\\n",relevance:0},y={begin:"\\[",end:"\\]",contains:[b],illegal:"\\n",relevance:0},g=[l,{className:"meta",begin:"^---\\s*$",relevance:10},{className:"string",begin:"[\\|>]([1-9]?[+-])?[ ]*\\n( +)[^ ][^\\n]*\\n(\\2[^\\n]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:true,excludeEnd:true,relevance:0},{className:"type",begin:"!\\w+!"+o},{className:"type",begin:"!<"+o+">"},{className:"type",begin:"!"+o},{className:"type",begin:"!!"+o},{className:"meta",begin:"&"+n.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+n.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"-(?=[ ]|$)",relevance:0},n.HASH_COMMENT_MODE,{beginKeywords:i,keywords:{literal:i}},E,{className:"number",begin:n.C_NUMBER_RE+"\\b",relevance:0},T,y,f],$=[...g];return $.pop(),$.push(u),b.contains=$,{name:"YAML",case_insensitive:true,aliases:["yml"],contains:g}}return Jg=s,Jg}var Zg,J$;function rG(){if(J$)return Zg;J$=1;const s="[A-Za-z$_][0-9A-Za-z$_]*",n=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends"],i=["true","false","null","undefined","NaN","Infinity"],o=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],l=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],h=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],f=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],u=[].concat(h,o,l);function p(_){const m=_.regex,E=(Q,{after:ce})=>{const Ee="</"+Q[0].slice(1);return Q.input.indexOf(Ee,ce)!==-1},b=s,T={begin:"<>",end:"</>"},y=/<[A-Za-z0-9\\._:-]+\s*\/>/,g={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(Q,ce)=>{const Ee=Q[0].length+Q.index,Xe=Q.input[Ee];if(Xe==="<"||Xe===","){ce.ignoreMatch();return}Xe===">"&&(E(Q,{after:Ee})||ce.ignoreMatch());let Re;const _t=Q.input.substring(Ee);if(Re=_t.match(/^\s*=/)){ce.ignoreMatch();return}if((Re=_t.match(/^\s+extends\s+/))&&Re.index===0){ce.ignoreMatch();return}}},$={$pattern:s,keyword:n,literal:i,built_in:u,"variable.language":f},R="[0-9](_?[0-9])*",v=`\\.(${R})`,S="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",O={className:"number",variants:[{begin:`(\\b(${S})((${v})|\\.)?|(${v}))[eE][+-]?(${R})\\b`},{begin:`\\b(${S})\\b((${v})\\b|\\.)?|(${v})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},w={className:"subst",begin:"\\$\\{",end:"\\}",keywords:$,contains:[]},A={begin:"html`",end:"",starts:{end:"`",returnEnd:false,contains:[_.BACKSLASH_ESCAPE,w],subLanguage:"xml"}},I={begin:"css`",end:"",starts:{end:"`",returnEnd:false,contains:[_.BACKSLASH_ESCAPE,w],subLanguage:"css"}},L={begin:"gql`",end:"",starts:{end:"`",returnEnd:false,contains:[_.BACKSLASH_ESCAPE,w],subLanguage:"graphql"}},x={className:"string",begin:"`",end:"`",contains:[_.BACKSLASH_ESCAPE,w]},H={className:"comment",variants:[_.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:true,excludeBegin:true,relevance:0},{className:"variable",begin:b+"(?=\\s*(-)|$)",endsParent:true,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),_.C_BLOCK_COMMENT_MODE,_.C_LINE_COMMENT_MODE]},F=[_.APOS_STRING_MODE,_.QUOTE_STRING_MODE,A,I,L,x,{match:/\$\d+/},O];w.contains=F.concat({begin:/\{/,end:/\}/,keywords:$,contains:["self"].concat(F)});const X=[].concat(H,w.contains),Z=X.concat([{begin:/\(/,end:/\)/,keywords:$,contains:["self"].concat(X)}]),J={className:"params",begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:$,contains:Z},D={variants:[{match:[/class/,/\s+/,b,/\s+/,/extends/,/\s+/,m.concat(b,"(",m.concat(/\./,b),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,b],scope:{1:"keyword",3:"title.class"}}]},P={relevance:0,match:m.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...o,...l]}},V={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},j={variants:[{match:[/function/,/\s+/,b,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[J],illegal:/%/},re={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function G(Q){return m.concat("(?!",Q.join("|"),")")}const ae={match:m.concat(/\b/,G([...h,"super","import"]),b,m.lookahead(/\(/)),className:"title.function",relevance:0},de={begin:m.concat(/\./,m.lookahead(m.concat(b,/(?![0-9A-Za-z$_(])/))),end:b,excludeBegin:true,keywords:"prototype",className:"property",relevance:0},fe={match:[/get|set/,/\s+/,b,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},J]},ee="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+_.UNDERSCORE_IDENT_RE+")\\s*=>",W={match:[/const|var|let/,/\s+/,b,/\s*/,/=\s*/,/(async\s*)?/,m.lookahead(ee)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[J]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:$,exports:{PARAMS_CONTAINS:Z,CLASS_REFERENCE:P},illegal:/#(?![$_A-z])/,contains:[_.SHEBANG({label:"shebang",binary:"node",relevance:5}),V,_.APOS_STRING_MODE,_.QUOTE_STRING_MODE,A,I,L,x,H,{match:/\$\d+/},O,P,{className:"attr",begin:b+m.lookahead(":"),relevance:0},W,{begin:"("+_.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[H,_.REGEXP_MODE,{className:"function",begin:ee,returnBegin:true,end:"\\s*=>",contains:[{className:"params",variants:[{begin:_.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:true},{begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:$,contains:Z}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:T.begin,end:T.end},{match:y},{begin:g.begin,"on:begin":g.isTrulyOpeningTag,end:g.end}],subLanguage:"xml",contains:[{begin:g.begin,end:g.end,skip:true,contains:["self"]}]}]},j,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+_.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:true,label:"func.def",contains:[J,_.inherit(_.TITLE_MODE,{begin:b,className:"title.function"})]},{match:/\.\.\./,relevance:0},de,{match:"\\$"+b,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[J]},ae,re,D,fe,{match:/\$[(.]/}]}}function c(_){const m=p(_),E=s,b=["any","void","number","boolean","string","object","never","symbol","bigint","unknown"],T={beginKeywords:"namespace",end:/\{/,excludeEnd:true,contains:[m.exports.CLASS_REFERENCE]},y={beginKeywords:"interface",end:/\{/,excludeEnd:true,keywords:{keyword:"interface extends",built_in:b},contains:[m.exports.CLASS_REFERENCE]},g={className:"meta",relevance:10,begin:/^\s*['"]use strict['"]/},$=["type","namespace","interface","public","private","protected","implements","declare","abstract","readonly","enum","override"],R={$pattern:s,keyword:n.concat($),literal:i,built_in:u.concat(b),"variable.language":f},v={className:"meta",begin:"@"+E},S=(w,A,I)=>{const L=w.contains.findIndex(x=>x.label===A);if(L===-1)throw new Error("can not find mode to replace");w.contains.splice(L,1,I)};Object.assign(m.keywords,R),m.exports.PARAMS_CONTAINS.push(v),m.contains=m.contains.concat([v,T,y]),S(m,"shebang",_.SHEBANG()),S(m,"use_strict",g);const O=m.contains.find(w=>w.label==="func.def");return O.relevance=0,Object.assign(m,{name:"TypeScript",aliases:["ts","tsx","mts","cts"]}),m}return Zg=c,Zg}var Qg,Z$;function oG(){if(Z$)return Qg;Z$=1;function s(n){const i=n.regex,o={className:"string",begin:/"(""|[^/n])"C\b/},l={className:"string",begin:/"/,end:/"/,illegal:/\n/,contains:[{begin:/""/}]},h=/\d{1,2}\/\d{1,2}\/\d{4}/,f=/\d{4}-\d{1,2}-\d{1,2}/,u=/(\d|1[012])(:\d+){0,2} *(AM|PM)/,p=/\d{1,2}(:\d{1,2}){1,2}/,c={className:"literal",variants:[{begin:i.concat(/# */,i.either(f,h),/ *#/)},{begin:i.concat(/# */,p,/ *#/)},{begin:i.concat(/# */,u,/ *#/)},{begin:i.concat(/# */,i.either(f,h),/ +/,i.either(u,p),/ *#/)}]},_={className:"number",relevance:0,variants:[{begin:/\b\d[\d_]*((\.[\d_]+(E[+-]?[\d_]+)?)|(E[+-]?[\d_]+))[RFD@!#]?/},{begin:/\b\d[\d_]*((U?[SIL])|[%&])?/},{begin:/&H[\dA-F_]+((U?[SIL])|[%&])?/},{begin:/&O[0-7_]+((U?[SIL])|[%&])?/},{begin:/&B[01_]+((U?[SIL])|[%&])?/}]},m={className:"label",begin:/^\w+:/},E=n.COMMENT(/'''/,/$/,{contains:[{className:"doctag",begin:/<\/?/,end:/>/}]}),b=n.COMMENT(null,/$/,{variants:[{begin:/'/},{begin:/([\t ]|^)REM(?=\s)/}]});return{name:"Visual Basic .NET",aliases:["vb"],case_insensitive:true,classNameAliases:{label:"symbol"},keywords:{keyword:"addhandler alias aggregate ansi as async assembly auto binary by byref byval call case catch class compare const continue custom declare default delegate dim distinct do each equals else elseif end enum erase error event exit explicit finally for friend from function get global goto group handles if implements imports in inherits interface into iterator join key let lib loop me mid module mustinherit mustoverride mybase myclass namespace narrowing new next notinheritable notoverridable of off on operator option optional order overloads overridable overrides paramarray partial preserve private property protected public raiseevent readonly redim removehandler resume return select set shadows shared skip static step stop structure strict sub synclock take text then throw to try unicode until using when where while widening with withevents writeonly yield",built_in:"addressof and andalso await directcast gettype getxmlnamespace is isfalse isnot istrue like mod nameof new not or orelse trycast typeof xor cbool cbyte cchar cdate cdbl cdec cint clng cobj csbyte cshort csng cstr cuint culng cushort",type:"boolean byte char date decimal double integer long object sbyte short single string uinteger ulong ushort",literal:"true false nothing"},illegal:"//|\\{|\\}|endif|gosub|variant|wend|^\\$ ",contains:[o,l,c,_,m,E,b,{className:"meta",begin:/[\t ]*#(const|disable|else|elseif|enable|end|externalsource|if|region)\b/,end:/$/,keywords:{keyword:"const disable else elseif enable end externalsource if region then"},contains:[b]}]}}return Qg=s,Qg}var ef,Q$;function aG(){if(Q$)return ef;Q$=1;function s(n){n.regex;const i=n.COMMENT(/\(;/,/;\)/);i.contains.push("self");const o=n.COMMENT(/;;/,/$/),l=["anyfunc","block","br","br_if","br_table","call","call_indirect","data","drop","elem","else","end","export","func","global.get","global.set","local.get","local.set","local.tee","get_global","get_local","global","if","import","local","loop","memory","memory.grow","memory.size","module","mut","nop","offset","param","result","return","select","set_global","set_local","start","table","tee_local","then","type","unreachable"],h={begin:[/(?:func|call|call_indirect)/,/\s+/,/\$[^\s)]+/],className:{1:"keyword",3:"title.function"}},f={className:"variable",begin:/\$[\w_]+/},u={match:/(\((?!;)|\))+/,className:"punctuation",relevance:0},p={className:"number",relevance:0,match:/[+-]?\b(?:\d(?:_?\d)*(?:\.\d(?:_?\d)*)?(?:[eE][+-]?\d(?:_?\d)*)?|0x[\da-fA-F](?:_?[\da-fA-F])*(?:\.[\da-fA-F](?:_?[\da-fA-D])*)?(?:[pP][+-]?\d(?:_?\d)*)?)\b|\binf\b|\bnan(?::0x[\da-fA-F](?:_?[\da-fA-D])*)?\b/},c={match:/(i32|i64|f32|f64)(?!\.)/,className:"type"},_={className:"keyword",match:/\b(f32|f64|i32|i64)(?:\.(?:abs|add|and|ceil|clz|const|convert_[su]\/i(?:32|64)|copysign|ctz|demote\/f64|div(?:_[su])?|eqz?|extend_[su]\/i32|floor|ge(?:_[su])?|gt(?:_[su])?|le(?:_[su])?|load(?:(?:8|16|32)_[su])?|lt(?:_[su])?|max|min|mul|nearest|neg?|or|popcnt|promote\/f32|reinterpret\/[fi](?:32|64)|rem_[su]|rot[lr]|shl|shr_[su]|store(?:8|16|32)?|sqrt|sub|trunc(?:_[su]\/f(?:32|64))?|wrap\/i64|xor))\b/};return{name:"WebAssembly",keywords:{$pattern:/[\w.]+/,keyword:l},contains:[o,i,{match:[/(?:offset|align)/,/\s*/,/=/],className:{1:"keyword",3:"operator"}},f,u,h,n.QUOTE_STRING_MODE,c,_,p]}}return ef=s,ef}var tf,ey;function lG(){if(ey)return tf;ey=1;var s=E0();return s.registerLanguage("xml",IF()),s.registerLanguage("bash",CF()),s.registerLanguage("c",OF()),s.registerLanguage("cpp",wF()),s.registerLanguage("csharp",kF()),s.registerLanguage("css",AF()),s.registerLanguage("markdown",LF()),s.registerLanguage("diff",NF()),s.registerLanguage("ruby",MF()),s.registerLanguage("go",DF()),s.registerLanguage("graphql",xF()),s.registerLanguage("ini",BF()),s.registerLanguage("java",PF()),s.registerLanguage("javascript",UF()),s.registerLanguage("json",FF()),s.registerLanguage("kotlin",GF()),s.registerLanguage("less",HF()),s.registerLanguage("lua",VF()),s.registerLanguage("makefile",WF()),s.registerLanguage("perl",zF()),s.registerLanguage("objectivec",jF()),s.registerLanguage("php",XF()),s.registerLanguage("php-template",KF()),s.registerLanguage("plaintext",YF()),s.registerLanguage("python",qF()),s.registerLanguage("python-repl",JF()),s.registerLanguage("r",ZF()),s.registerLanguage("rust",QF()),s.registerLanguage("scss",eG()),s.registerLanguage("shell",tG()),s.registerLanguage("sql",sG()),s.registerLanguage("swift",iG()),s.registerLanguage("yaml",nG()),s.registerLanguage("typescript",rG()),s.registerLanguage("vbnet",oG()),s.registerLanguage("wasm",aG()),s.HighlightJS=s,s.default=s,tf=s,tf}var cG=lG();const uG=Jf(cG),ty="[A-Za-z$_][0-9A-Za-z$_]*",hG=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends"],dG=["true","false","null","undefined","NaN","Infinity"],b0=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],v0=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],T0=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],_G=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],pG=[].concat(T0,b0,v0);function gG(s){const n=s.regex,i=(P,{after:V})=>{const j="</"+P[0].slice(1);return P.input.indexOf(j,V)!==-1},o=ty,l={begin:"<>",end:"</>"},h=/<[A-Za-z0-9\\._:-]+\s*\/>/,f={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(P,V)=>{const j=P[0].length+P.index,re=P.input[j];if(re==="<"||re===","){V.ignoreMatch();return}re===">"&&(i(P,{after:j})||V.ignoreMatch());let G;const ae=P.input.substring(j);if(G=ae.match(/^\s*=/)){V.ignoreMatch();return}if((G=ae.match(/^\s+extends\s+/))&&G.index===0){V.ignoreMatch();return}}},u={$pattern:ty,keyword:hG,literal:dG,built_in:pG,"variable.language":_G},p="[0-9](_?[0-9])*",c=`\\.(${p})`,_="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",m={className:"number",variants:[{begin:`(\\b(${_})((${c})|\\.)?|(${c}))[eE][+-]?(${p})\\b`},{begin:`\\b(${_})\\b((${c})\\b|\\.)?|(${c})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},E={className:"subst",begin:"\\$\\{",end:"\\}",keywords:u,contains:[]},b={begin:"html`",end:"",starts:{end:"`",returnEnd:false,contains:[s.BACKSLASH_ESCAPE,E],subLanguage:"xml"}},T={begin:"css`",end:"",starts:{end:"`",returnEnd:false,contains:[s.BACKSLASH_ESCAPE,E],subLanguage:"css"}},y={begin:"gql`",end:"",starts:{end:"`",returnEnd:false,contains:[s.BACKSLASH_ESCAPE,E],subLanguage:"graphql"}},g={className:"string",begin:"`",end:"`",contains:[s.BACKSLASH_ESCAPE,E]},R={className:"comment",variants:[s.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:true,excludeBegin:true,relevance:0},{className:"variable",begin:o+"(?=\\s*(-)|$)",endsParent:true,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),s.C_BLOCK_COMMENT_MODE,s.C_LINE_COMMENT_MODE]},v=[s.APOS_STRING_MODE,s.QUOTE_STRING_MODE,b,T,y,g,{match:/\$\d+/},m];E.contains=v.concat({begin:/\{/,end:/\}/,keywords:u,contains:["self"].concat(v)});const S=[].concat(R,E.contains),O=S.concat([{begin:/\(/,end:/\)/,keywords:u,contains:["self"].concat(S)}]),w={className:"params",begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:u,contains:O},A={variants:[{match:[/class/,/\s+/,o,/\s+/,/extends/,/\s+/,n.concat(o,"(",n.concat(/\./,o),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,o],scope:{1:"keyword",3:"title.class"}}]},I={relevance:0,match:n.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...b0,...v0]}},L={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},x={variants:[{match:[/function/,/\s+/,o,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[w],illegal:/%/},B={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function H(P){return n.concat("(?!",P.join("|"),")")}const F={match:n.concat(/\b/,H([...T0,"super","import"]),o,n.lookahead(/\(/)),className:"title.function",relevance:0},X={begin:n.concat(/\./,n.lookahead(n.concat(o,/(?![0-9A-Za-z$_(])/))),end:o,excludeBegin:true,keywords:"prototype",className:"property",relevance:0},Z={match:[/get|set/,/\s+/,o,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},w]},J="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+s.UNDERSCORE_IDENT_RE+")\\s*=>",D={match:[/const|var|let/,/\s+/,o,/\s*/,/=\s*/,/(async\s*)?/,n.lookahead(J)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[w]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:u,exports:{PARAMS_CONTAINS:O,CLASS_REFERENCE:I},illegal:/#(?![$_A-z])/,contains:[s.SHEBANG({label:"shebang",binary:"node",relevance:5}),L,s.APOS_STRING_MODE,s.QUOTE_STRING_MODE,b,T,y,g,R,{match:/\$\d+/},m,I,{className:"attr",begin:o+n.lookahead(":"),relevance:0},D,{begin:"("+s.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[R,s.REGEXP_MODE,{className:"function",begin:J,returnBegin:true,end:"\\s*=>",contains:[{className:"params",variants:[{begin:s.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:true},{begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:u,contains:O}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:l.begin,end:l.end},{match:h},{begin:f.begin,"on:begin":f.isTrulyOpeningTag,end:f.end}],subLanguage:"xml",contains:[{begin:f.begin,end:f.end,skip:true,contains:["self"]}]}]},x,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+s.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:true,label:"func.def",contains:[w,s.inherit(s.TITLE_MODE,{begin:o,className:"title.function"})]},{match:/\.\.\./,relevance:0},X,{match:"\\$"+o,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[w]},F,B,A,Z,{match:/\$[(.]/}]}}var fG=E0();const sf=Jf(fG);var sy=et({props:{code:{type:String,required:true},language:{type:String,default:""},autodetect:{type:Boolean,default:true},ignoreIllegals:{type:Boolean,default:true}},setup:function(s){var n=be(s.language);Mt(function(){return s.language},function(l){n.value=l});var i=me(function(){return s.autodetect||!n.value}),o=me(function(){return!i.value&&!sf.getLanguage(n.value)});return{className:me(function(){return o.value?"":"hljs "+n.value}),highlightedCode:me(function(){var l;if(o.value)return console.warn('The language "'+n.value+'" you specified could not be found.'),s.code.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;");if(i.value){var h=sf.highlightAuto(s.code);return n.value=(l=h.language)!==null&&l!==void 0?l:"",h.value}return(h=sf.highlight(s.code,{language:n.value,ignoreIllegals:s.ignoreIllegals})).value})}},render:function(){return ju("pre",{},[ju("code",{class:this.className,innerHTML:this.highlightedCode,tabindex:"0"})])}}),mG={install:function(s){s.component("highlightjs",sy)},component:sy};const EG=et({__name:"code",props:["blocklyInformation","current"],setup(s){uG.registerLanguage("javascript",gG);const n=mG.component;return(i,o)=>s.blocklyInformation.code?(ie(),Ye(ge(n),{key:0,code:s.blocklyInformation.code,lang:"javascript"},null,8,["code"])):ot("",true)}}),bG={},vG={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},TG=le("path",{d:"M7.724 65.49C13.36 55.11 21.79 46.47 32 40.56C39.63 36.15 48.25 33.26 57.46 32.33C59.61 32.11 61.79 32 64 32H448C483.3 32 512 60.65 512 96V416C512 451.3 483.3 480 448 480H64C28.65 480 0 451.3 0 416V96C0 93.79 .112 91.61 .3306 89.46C1.204 80.85 3.784 72.75 7.724 65.49V65.49zM48 416C48 424.8 55.16 432 64 432H448C456.8 432 464 424.8 464 416V224H48V416z"},null,-1),SG=[TG];function $G(s,n){return ie(),Se("svg",vG,SG)}const yG=Jn(bG,[["render",$G]]);let Uu;const RG=new Uint8Array(16);function IG(){if(!Uu&&(Uu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Uu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Uu(RG)}const Is=[];for(let s=0;s<256;++s)Is.push((s+256).toString(16).slice(1));function CG(s,n=0){return(Is[s[n+0]]+Is[s[n+1]]+Is[s[n+2]]+Is[s[n+3]]+"-"+Is[s[n+4]]+Is[s[n+5]]+"-"+Is[s[n+6]]+Is[s[n+7]]+"-"+Is[s[n+8]]+Is[s[n+9]]+"-"+Is[s[n+10]]+Is[s[n+11]]+Is[s[n+12]]+Is[s[n+13]]+Is[s[n+14]]+Is[s[n+15]]).toLowerCase()}const OG=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),iy={randomUUID:OG};function Rr(s,n,i){if(iy.randomUUID&&!n&&!s)return iy.randomUUID();s=s||{};const o=s.random||(s.rng||IG)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,n){i=i||0;for(let l=0;l<16;++l)n[i+l]=o[l];return n}return CG(o)}class lo{constructor(){this.listenerMap=new Map,this._listeners=[],this.proxyMap=new Map,this.proxies=[]}get listeners(){return this._listeners.concat(this.proxies.flatMap(n=>n()))}subscribe(n,i){this.listenerMap.has(n)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different handlers for the same event/hook.`),this.unsubscribe(n)),this.listenerMap.set(n,i),this._listeners.push(i)}unsubscribe(n){if(this.listenerMap.has(n)){const i=this.listenerMap.get(n);this.listenerMap.delete(n);const o=this._listeners.indexOf(i);o>=0&&this._listeners.splice(o,1)}}registerProxy(n,i){this.proxyMap.has(n)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different proxies for the same event/hook.`),this.unregisterProxy(n)),this.proxyMap.set(n,i),this.proxies.push(i)}unregisterProxy(n){if(!this.proxyMap.has(n))return;const i=this.proxyMap.get(n);this.proxyMap.delete(n);const o=this.proxies.indexOf(i);o>=0&&this.proxies.splice(o,1)}}class es extends lo{constructor(n){super(),this.entity=n}emit(n){this.listeners.forEach(i=>i(n,this.entity))}}class ei extends lo{constructor(n){super(),this.entity=n}emit(n){let i=false;const o=()=>[i=true];for(const l of Array.from(this.listeners.values()))if(l(n,o,this.entity),i)return{prevented:true};return{prevented:false}}}class wG extends lo{execute(n,i){let o=n;for(const l of this.listeners)o=l(o,i);return o}}class Bi extends wG{constructor(n){super(),this.entity=n}execute(n){return super.execute(n,this.entity)}}class kG extends lo{constructor(n){super(),this.entity=n}execute(n){const i=[];for(const o of this.listeners)i.push(o(n,this.entity));return i}}function vn(){const s=Symbol(),n=new Map,i=new Set,o=(p,c)=>{c instanceof lo&&c.registerProxy(s,()=>{var _,m;return(m=(_=n.get(p))===null||_===void 0?void 0:_.listeners)!==null&&m!==void 0?m:[]})},l=p=>{const c=new lo;n.set(p,c),i.forEach(_=>o(p,_[p]))},h=p=>{i.add(p);for(const c of n.keys())o(c,p[c])},f=p=>{for(const c of n.keys())p[c]instanceof lo&&p[c].unregisterProxy(s);i.delete(p)},u=()=>{i.forEach(p=>f(p)),n.clear()};return new Proxy({},{get(p,c){return c==="addTarget"?h:c==="removeTarget"?f:c==="destroy"?u:typeof c!="string"||c.startsWith("_")?p[c]:(n.has(c)||l(c),n.get(c))}})}class ny{constructor(n,i){if(this.destructed=false,this.events={destruct:new es(this)},!n||!i)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=Rr(),this.from=n,this.to=i,this.from.connectionCount++,this.to.connectionCount++}destruct(){this.events.destruct.emit(),this.from.connectionCount--,this.to.connectionCount--,this.destructed=true}}class AG{constructor(n,i){if(!n||!i)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=Rr(),this.from=n,this.to=i}}function Af(s,n){return Object.fromEntries(Object.entries(s).map(([i,o])=>[i,n(o)]))}class S0{constructor(){this.id=Rr(),this.events={loaded:new es(this),beforeAddInput:new ei(this),addInput:new es(this),beforeRemoveInput:new ei(this),removeInput:new es(this),beforeAddOutput:new ei(this),addOutput:new es(this),beforeRemoveOutput:new ei(this),removeOutput:new es(this),update:new es(this)},this.hooks={beforeLoad:new Bi(this),afterSave:new Bi(this)}}get graph(){return this.graphInstance}addInput(n,i){return this.addInterface("input",n,i)}addOutput(n,i){return this.addInterface("output",n,i)}removeInput(n){return this.removeInterface("input",n)}removeOutput(n){return this.removeInterface("output",n)}registerGraph(n){this.graphInstance=n}load(n){this.hooks.beforeLoad.execute(n),this.id=n.id,this.title=n.title,Object.entries(n.inputs).forEach(([i,o])=>{this.inputs[i]&&(this.inputs[i].load(o),this.inputs[i].nodeId=this.id)}),Object.entries(n.outputs).forEach(([i,o])=>{this.outputs[i]&&(this.outputs[i].load(o),this.outputs[i].nodeId=this.id)}),this.events.loaded.emit(this)}save(){const n=Af(this.inputs,l=>l.save()),i=Af(this.outputs,l=>l.save()),o={type:this.type,id:this.id,title:this.title,inputs:n,outputs:i};return this.hooks.afterSave.execute(o)}onPlaced(){}onDestroy(){}initializeIo(){Object.entries(this.inputs).forEach(([n,i])=>this.initializeIntf("input",n,i)),Object.entries(this.outputs).forEach(([n,i])=>this.initializeIntf("output",n,i))}initializeIntf(n,i,o){o.isInput=n==="input",o.nodeId=this.id,o.events.setValue.subscribe(this,()=>this.events.update.emit({type:n,name:i,intf:o}))}addInterface(n,i,o){const l=n==="input"?this.events.beforeAddInput:this.events.beforeAddOutput,h=n==="input"?this.events.addInput:this.events.addOutput,f=n==="input"?this.inputs:this.outputs;return l.emit(o).prevented?false:(f[i]=o,this.initializeIntf(n,i,o),h.emit(o),true)}removeInterface(n,i){const o=n==="input"?this.events.beforeRemoveInput:this.events.beforeRemoveOutput,l=n==="input"?this.events.removeInput:this.events.removeOutput,h=n==="input"?this.inputs[i]:this.outputs[i];if(!h||o.emit(h).prevented)return false;if(h.connectionCount>0)if(this.graphInstance)this.graphInstance.connections.filter(u=>u.from===h||u.to===h).forEach(u=>{this.graphInstance.removeConnection(u)});else throw new Error("Interface is connected, but no graph instance is specified. Unable to delete interface");return h.events.setValue.unsubscribe(this),n==="input"?delete this.inputs[i]:delete this.outputs[i],l.emit(h),true}}let $0=class extends S0{load(n){super.load(n)}save(){return super.save()}};function Pi(s){return class extends $0{constructor(){var n,i;super(),this.type=s.type,this.title=(n=s.title)!==null&&n!==void 0?n:s.type,this.inputs={},this.outputs={},this.calculate=s.calculate?(o,l)=>s.calculate.call(this,o,l):void 0,this.executeFactory("input",s.inputs),this.executeFactory("output",s.outputs),(i=s.onCreate)===null||i===void 0||i.call(this)}onPlaced(){var n;(n=s.onPlaced)===null||n===void 0||n.call(this)}onDestroy(){var n;(n=s.onDestroy)===null||n===void 0||n.call(this)}executeFactory(n,i){Object.keys(i||{}).forEach(o=>{const l=i[o]();n==="input"?this.addInput(o,l):this.addOutput(o,l)})}}}class LG extends $0{}function pm(s){return class extends LG{constructor(){var n,i,o,l;super(),this.type=s.type,this.title=(n=s.title)!==null&&n!==void 0?n:s.type,this.inputs={},this.outputs={},this.preventUpdate=false,this.staticInputKeys=Object.keys((i=s.inputs)!==null&&i!==void 0?i:{}),this.staticOutputKeys=Object.keys((o=s.outputs)!==null&&o!==void 0?o:{}),this.executeFactory("input",s.inputs),this.executeFactory("output",s.outputs),s.calculate&&(this.calculate=(h,f)=>{var u;return(u=s.calculate)===null||u===void 0?void 0:u.call(this,h,f)}),(l=s.onCreate)===null||l===void 0||l.call(this)}onPlaced(){var n;this.events.update.subscribe(this,i=>{i&&(i.type==="input"&&this.staticInputKeys.includes(i.name)||i.type==="output"&&this.staticOutputKeys.includes(i.name))&&this.onUpdate()}),this.onUpdate(),(n=s.onPlaced)===null||n===void 0||n.call(this)}onDestroy(){var n;(n=s.onDestroy)===null||n===void 0||n.call(this)}load(n){this.preventUpdate=true,this.hooks.beforeLoad.execute(n),this.id=n.id,this.title=n.title;for(const i of this.staticInputKeys)this.inputs[i].load(n.inputs[i]),this.inputs[i].nodeId=this.id;for(const i of this.staticOutputKeys)this.outputs[i].load(n.outputs[i]),this.outputs[i].nodeId=this.id;this.preventUpdate=false,this.onUpdate(),this.preventUpdate=true;for(const i of Object.keys(n.inputs))this.staticInputKeys.includes(i)||(this.inputs[i].load(n.inputs[i]),this.inputs[i].nodeId=this.id);for(const i of Object.keys(n.outputs))this.staticOutputKeys.includes(i)||(this.outputs[i].load(n.outputs[i]),this.outputs[i].nodeId=this.id);this.preventUpdate=false,this.events.loaded.emit(this)}onUpdate(){var n,i,o,l;if(this.preventUpdate)return;this.graph&&this.graph.activeTransactions++;const h=this.getStaticValues(this.staticInputKeys,this.inputs),f=this.getStaticValues(this.staticOutputKeys,this.outputs),u=s.onUpdate.call(this,h,f);this.updateInterfaces("input",(n=u.inputs)!==null&&n!==void 0?n:{},(i=u.forceUpdateInputs)!==null&&i!==void 0?i:[]),this.updateInterfaces("output",(o=u.outputs)!==null&&o!==void 0?o:{},(l=u.forceUpdateOutputs)!==null&&l!==void 0?l:[]),this.graph&&this.graph.activeTransactions--}getStaticValues(n,i){const o={};for(const l of n)o[l]=i[l].value;return o}updateInterfaces(n,i,o){const l=n==="input"?this.staticInputKeys:this.staticOutputKeys,h=n==="input"?this.inputs:this.outputs;for(const f of Object.keys(h))l.includes(f)||i[f]&&!o.includes(f)||(n==="input"?this.removeInput(f):this.removeOutput(f));for(const f of Object.keys(i)){if(h[f])continue;const u=i[f]();n==="input"?this.addInput(f,u):this.addOutput(f,u)}}executeFactory(n,i){Object.keys(i||{}).forEach(o=>{const l=i[o]();n==="input"?this.addInput(o,l):this.addOutput(o,l)})}}}class bh{get nodes(){return this._nodes}get connections(){return this._connections}get loading(){return this._loading}get destroying(){return this._destroying}constructor(n,i){this.id=Rr(),this.inputs=[],this.outputs=[],this.activeTransactions=0,this._nodes=[],this._connections=[],this._loading=false,this._destroying=false,this.events={beforeAddNode:new ei(this),addNode:new es(this),beforeRemoveNode:new ei(this),removeNode:new es(this),beforeAddConnection:new ei(this),addConnection:new es(this),checkConnection:new ei(this),beforeRemoveConnection:new ei(this),removeConnection:new es(this)},this.hooks={save:new Bi(this),load:new Bi(this),checkConnection:new kG(this)},this.nodeEvents=vn(),this.nodeHooks=vn(),this.connectionEvents=vn(),this.editor=n,this.template=i,n.registerGraph(this)}addNode(n){if(!this.events.beforeAddNode.emit(n).prevented)return this.nodeEvents.addTarget(n.events),this.nodeHooks.addTarget(n.hooks),n.registerGraph(this),this._nodes.push(n),n=this.nodes.find(i=>i.id===n.id),n.onPlaced(),this.events.addNode.emit(n),n}removeNode(n){if(this.nodes.includes(n)){if(this.events.beforeRemoveNode.emit(n).prevented)return;const i=[...Object.values(n.inputs),...Object.values(n.outputs)];this.connections.filter(o=>i.includes(o.from)||i.includes(o.to)).forEach(o=>this.removeConnection(o)),this._nodes.splice(this.nodes.indexOf(n),1),this.events.removeNode.emit(n),n.onDestroy(),this.nodeEvents.removeTarget(n.events),this.nodeHooks.removeTarget(n.hooks)}}addConnection(n,i){const o=this.checkConnection(n,i);if(!o.connectionAllowed||this.events.beforeAddConnection.emit({from:n,to:i}).prevented)return;for(const h of o.connectionsInDanger){const f=this.connections.find(u=>u.id===h.id);f&&this.removeConnection(f)}const l=new ny(o.dummyConnection.from,o.dummyConnection.to);return this.internalAddConnection(l),l}removeConnection(n){if(this.connections.includes(n)){if(this.events.beforeRemoveConnection.emit(n).prevented)return;n.destruct(),this._connections.splice(this.connections.indexOf(n),1),this.events.removeConnection.emit(n),this.connectionEvents.removeTarget(n.events)}}checkConnection(n,i){if(!n||!i)return{connectionAllowed:false};const o=this.findNodeById(n.nodeId),l=this.findNodeById(i.nodeId);if(o&&l&&o===l)return{connectionAllowed:false};if(n.isInput&&!i.isInput){const u=n;n=i,i=u}if(n.isInput||!i.isInput)return{connectionAllowed:false};if(this.connections.some(u=>u.from===n&&u.to===i))return{connectionAllowed:false};if(this.events.checkConnection.emit({from:n,to:i}).prevented)return{connectionAllowed:false};const h=this.hooks.checkConnection.execute({from:n,to:i});if(h.some(u=>!u.connectionAllowed))return{connectionAllowed:false};const f=Array.from(new Set(h.flatMap(u=>u.connectionsInDanger)));return{connectionAllowed:true,dummyConnection:new AG(n,i),connectionsInDanger:f}}findNodeInterface(n){for(const i of this.nodes){for(const o in i.inputs){const l=i.inputs[o];if(l.id===n)return l}for(const o in i.outputs){const l=i.outputs[o];if(l.id===n)return l}}}findNodeById(n){return this.nodes.find(i=>i.id===n)}load(n){try{this._loading=true;const i=[];for(let o=this.connections.length-1;o>=0;o--)this.removeConnection(this.connections[o]);for(let o=this.nodes.length-1;o>=0;o--)this.removeNode(this.nodes[o]);this.id=n.id,this.inputs=n.inputs,this.outputs=n.outputs;for(const o of n.nodes){const l=this.editor.nodeTypes.get(o.type);if(!l){i.push(`Node type ${o.type} is not registered`);continue}const h=new l.type;this.addNode(h),h.load(o)}for(const o of n.connections){const l=this.findNodeInterface(o.from),h=this.findNodeInterface(o.to);if(l)if(h){const f=new ny(l,h);f.id=o.id,this.internalAddConnection(f)}else{i.push(`Could not find interface with id ${o.to}`);continue}else{i.push(`Could not find interface with id ${o.from}`);continue}}return this.hooks.load.execute(n),i}finally{this._loading=false}}save(){const n={id:this.id,nodes:this.nodes.map(i=>i.save()),connections:this.connections.map(i=>({id:i.id,from:i.from.id,to:i.to.id})),inputs:this.inputs,outputs:this.outputs};return this.hooks.save.execute(n)}destroy(){this._destroying=true;for(const n of this.nodes)this.removeNode(n);this.editor.unregisterGraph(this)}internalAddConnection(n){this.connectionEvents.addTarget(n.events),this._connections.push(n),this.events.addConnection.emit(n)}}let yt=class{set connectionCount(n){this._connectionCount=n,this.events.setConnectionCount.emit(n)}get connectionCount(){return this._connectionCount}set value(n){this.events.beforeSetValue.emit(n).prevented||(this._value=n,this.events.setValue.emit(n))}get value(){return this._value}constructor(n,i){this.id=Rr(),this.nodeId="",this.port=true,this.hidden=false,this.events={setConnectionCount:new es(this),beforeSetValue:new ei(this),setValue:new es(this),updated:new es(this)},this.hooks={load:new Bi(this),save:new Bi(this)},this._connectionCount=0,this.name=n,this._value=i}load(n){this.id=n.id,this.templateId=n.templateId,this.value=n.value,this.hooks.load.execute(n)}save(){const n={id:this.id,templateId:this.templateId,value:this.value};return this.hooks.save.execute(n)}setComponent(n){return this.component=n,this}setPort(n){return this.port=n,this}setHidden(n){return this.hidden=n,this}use(n,...i){return n(this,...i),this}};const tc="__baklava_GraphNode-";function ma(s){return tc+s.id}function NG(s){return class extends S0{constructor(){super(...arguments),this.type=ma(s),this._title="GraphNode",this.inputs={},this.outputs={},this.template=s,this.calculate=async(i,o)=>{if(!this.subgraph)throw new Error(`GraphNode ${this.id}: calculate called without subgraph being initialized`);if(typeof o.engine=="object"&&o.engine&&typeof o.engine.runGraph=="function"){const l=new Map;for(const p of this.subgraph.nodes)Object.values(p.inputs).forEach(c=>{c.connectionCount===0&&l.set(c.id,c.value)});Object.entries(i).forEach(([p,c])=>{const _=this.subgraph.inputs.find(m=>m.id===p);l.set(_.nodeInterfaceId,c)});const h=await o.engine.runGraph(this.subgraph,l,o.globalValues),f=new Map;h.forEach((p,c)=>{const _=this.subgraph.nodes.find(m=>m.id===c);p.forEach((m,E)=>{f.set(_.outputs[E].id,m)})});const u={};return this.subgraph.outputs.forEach(p=>{u[p.id]=f.get(p.nodeInterfaceId)}),u._calculationResults=h,u}}}get title(){return this._title}set title(i){this.template.name=i}load(i){if(!this.subgraph)throw new Error("Cannot load a graph node without a graph");if(!this.template)throw new Error("Unable to load graph node without graph template");this.subgraph.load(i.graphState),super.load(i)}save(){if(!this.subgraph)throw new Error("Cannot save a graph node without a graph");return{...super.save(),graphState:this.subgraph.save()}}onPlaced(){this.template.events.updated.subscribe(this,()=>this.initialize()),this.template.events.nameChanged.subscribe(this,i=>{this._title=i}),this.initialize()}onDestroy(){var i;this.template.events.updated.unsubscribe(this),this.template.events.nameChanged.unsubscribe(this),(i=this.subgraph)===null||i===void 0||i.destroy()}initialize(){this.subgraph&&this.subgraph.destroy(),this.subgraph=this.template.createGraph(),this._title=this.template.name,this.updateInterfaces(),this.events.update.emit(null)}updateInterfaces(){if(!this.subgraph)throw new Error("Trying to update interfaces without graph instance");for(const i of this.subgraph.inputs)i.id in this.inputs?this.inputs[i.id].name=i.name:this.addInput(i.id,new yt(i.name,void 0));for(const i of Object.keys(this.inputs))this.subgraph.inputs.some(o=>o.id===i)||this.removeInput(i);for(const i of this.subgraph.outputs)i.id in this.outputs?this.outputs[i.id].name=i.name:this.addOutput(i.id,new yt(i.name,void 0));for(const i of Object.keys(this.outputs))this.subgraph.outputs.some(o=>o.id===i)||this.removeOutput(i);this.addOutput("_calculationResults",new yt("_calculationResults",void 0).setHidden(true))}}}class vh{static fromGraph(n,i){return new vh(n.save(),i)}get name(){return this._name}set name(n){this._name=n,this.events.nameChanged.emit(n);const i=this.editor.nodeTypes.get(ma(this));i&&(i.title=n)}constructor(n,i){this.id=Rr(),this._name="Subgraph",this.events={nameChanged:new es(this),updated:new es(this)},this.hooks={beforeLoad:new Bi(this),afterSave:new Bi(this)},this.editor=i,n.id&&(this.id=n.id),n.name&&(this._name=n.name),this.update(n)}update(n){this.nodes=n.nodes,this.connections=n.connections,this.inputs=n.inputs,this.outputs=n.outputs,this.events.updated.emit()}save(){return{id:this.id,name:this.name,nodes:this.nodes,connections:this.connections,inputs:this.inputs,outputs:this.outputs}}createGraph(n){const i=new Map,o=m=>{const E=Rr();return i.set(m,E),E},l=m=>{const E=i.get(m);if(!E)throw new Error(`Unable to create graph from template: Could not map old id ${m} to new id`);return E},h=m=>Af(m,E=>({id:o(E.id),templateId:E.id,value:E.value})),f=this.nodes.map(m=>({...m,id:o(m.id),inputs:h(m.inputs),outputs:h(m.outputs)})),u=this.connections.map(m=>({id:o(m.id),from:l(m.from),to:l(m.to)})),p=this.inputs.map(m=>({id:m.id,name:m.name,nodeInterfaceId:l(m.nodeInterfaceId)})),c=this.outputs.map(m=>({id:m.id,name:m.name,nodeInterfaceId:l(m.nodeInterfaceId)})),_={id:Rr(),nodes:f,connections:u,inputs:p,outputs:c};return n||(n=new bh(this.editor)),n.load(_),n.template=this,n}}let MG=class{constructor(){this.events={loaded:new es(this),beforeRegisterNodeType:new ei(this),registerNodeType:new es(this),beforeUnregisterNodeType:new ei(this),unregisterNodeType:new es(this),beforeAddGraphTemplate:new ei(this),addGraphTemplate:new es(this),beforeRemoveGraphTemplate:new ei(this),removeGraphTemplate:new es(this),registerGraph:new es(this),unregisterGraph:new es(this)},this.hooks={save:new Bi(this),load:new Bi(this)},this.graphTemplateEvents=vn(),this.graphTemplateHooks=vn(),this.graphEvents=vn(),this.graphHooks=vn(),this.nodeEvents=vn(),this.nodeHooks=vn(),this.connectionEvents=vn(),this._graphs=new Set,this._nodeTypes=new Map,this._graph=new bh(this),this._graphTemplates=[],this._loading=false}get nodeTypes(){return this._nodeTypes}get graph(){return this._graph}get graphTemplates(){return this._graphTemplates}get graphs(){return this._graphs}get loading(){return this._loading}registerNodeType(n,i){var o,l;if(this.events.beforeRegisterNodeType.emit({type:n,options:i}).prevented)return;const h=new n;this._nodeTypes.set(h.type,{type:n,category:(o=i==null?void 0:i.category)!==null&&o!==void 0?o:"default",title:(l=i==null?void 0:i.title)!==null&&l!==void 0?l:h.title}),this.events.registerNodeType.emit({type:n,options:i})}unregisterNodeType(n){const i=typeof n=="string"?n:new n().type;if(this.nodeTypes.has(i)){if(this.events.beforeUnregisterNodeType.emit(i).prevented)return;this._nodeTypes.delete(i),this.events.unregisterNodeType.emit(i)}}addGraphTemplate(n){if(this.events.beforeAddGraphTemplate.emit(n).prevented)return;this._graphTemplates.push(n),this.graphTemplateEvents.addTarget(n.events),this.graphTemplateHooks.addTarget(n.hooks);const i=NG(n);this.registerNodeType(i,{category:"Subgraphs",title:n.name}),this.events.addGraphTemplate.emit(n)}removeGraphTemplate(n){if(this.graphTemplates.includes(n)){if(this.events.beforeRemoveGraphTemplate.emit(n).prevented)return;const i=ma(n);for(const o of[this.graph,...this.graphs.values()]){const l=o.nodes.filter(h=>h.type===i);for(const h of l)o.removeNode(h)}this.unregisterNodeType(i),this._graphTemplates.splice(this._graphTemplates.indexOf(n),1),this.graphTemplateEvents.removeTarget(n.events),this.graphTemplateHooks.removeTarget(n.hooks),this.events.removeGraphTemplate.emit(n)}}registerGraph(n){this.graphEvents.addTarget(n.events),this.graphHooks.addTarget(n.hooks),this.nodeEvents.addTarget(n.nodeEvents),this.nodeHooks.addTarget(n.nodeHooks),this.connectionEvents.addTarget(n.connectionEvents),this.events.registerGraph.emit(n),this._graphs.add(n)}unregisterGraph(n){this.graphEvents.removeTarget(n.events),this.graphHooks.removeTarget(n.hooks),this.nodeEvents.removeTarget(n.nodeEvents),this.nodeHooks.removeTarget(n.nodeHooks),this.connectionEvents.removeTarget(n.connectionEvents),this.events.unregisterGraph.emit(n),this._graphs.delete(n)}load(n){try{this._loading=true,n=this.hooks.load.execute(n),n.graphTemplates.forEach(o=>{const l=new vh(o,this);this.addGraphTemplate(l)});const i=this._graph.load(n.graph);return this.events.loaded.emit(),i.forEach(o=>console.warn(o)),i}finally{this._loading=false}}save(){const n={graph:this.graph.save(),graphTemplates:this.graphTemplates.map(i=>i.save())};return this.hooks.save.execute(n)}};var ry;(function(s){s.Running="Running",s.Idle="Idle",s.Paused="Paused",s.Stopped="Stopped"})(ry||(ry={}));let Lf=null;function DG(s){Lf=s}function On(){if(!Lf)throw new Error("providePlugin() must be called before usePlugin()");return{viewModel:Lf}}function rn(){const{viewModel:s}=On();return{graph:tn(s.value,"displayedGraph"),switchGraph:s.value.switchGraph}}function y0(s){const{graph:n}=rn(),i=be(null),o=be(null);return{dragging:me(()=>!!i.value),onPointerDown:p=>{i.value={x:p.pageX,y:p.pageY},o.value={x:s.value.x,y:s.value.y}},onPointerMove:p=>{if(i.value){const c=p.pageX-i.value.x,_=p.pageY-i.value.y;s.value.x=o.value.x+c/n.value.scaling,s.value.y=o.value.y+_/n.value.scaling}},onPointerUp:()=>{i.value=null,o.value=null}}}function xG(){const{graph:s}=rn();return{transform:(i,o)=>{const l=i/s.value.scaling-s.value.panning.x,h=o/s.value.scaling-s.value.panning.y;return[l,h]}}}function BG(){const{graph:s}=rn();let n=[],i=-1,o={x:0,y:0};const l=me(()=>s.value.panning),h=y0(l),f=me(()=>({"transform-origin":"0 0",transform:`scale(${s.value.scaling}) translate(${s.value.panning.x}px, ${s.value.panning.y}px)`})),u=(b,T,y)=>{const g=[b/s.value.scaling-s.value.panning.x,T/s.value.scaling-s.value.panning.y],$=[b/y-s.value.panning.x,T/y-s.value.panning.y],R=[$[0]-g[0],$[1]-g[1]];s.value.panning.x+=R[0],s.value.panning.y+=R[1],s.value.scaling=y},p=b=>{b.preventDefault();let T=b.deltaY;b.deltaMode===1&&(T*=32);const y=s.value.scaling*(1-T/3e3);u(b.offsetX,b.offsetY,y)},c=()=>({ax:n[0].clientX,ay:n[0].clientY,bx:n[1].clientX,by:n[1].clientY});return{styles:f,...h,onPointerDown:b=>{if(n.push(b),h.onPointerDown(b),n.length===2){const{ax:T,ay:y,bx:g,by:$}=c();o={x:T+(g-T)/2,y:y+($-y)/2}}},onPointerMove:b=>{for(let T=0;T<n.length;T++)if(b.pointerId==n[T].pointerId){n[T]=b;break}if(n.length==2){const{ax:T,ay:y,bx:g,by:$}=c(),R=T-g,v=y-$,S=Math.sqrt(R*R+v*v);if(i>0){const O=s.value.scaling*(1+(S-i)/500);u(o.x,o.y,O)}i=S}else h.onPointerMove(b)},onPointerUp:b=>{n=n.filter(T=>T.pointerId!==b.pointerId),i=-1,h.onPointerUp()},onMouseWheel:p}}var Di=(s=>(s[s.NONE=0]="NONE",s[s.ALLOWED=1]="ALLOWED",s[s.FORBIDDEN=2]="FORBIDDEN",s))(Di||{});function PG(){const{graph:s}=rn(),n=be(null),i=be(null),o=u=>{n.value&&(n.value.mx=u.offsetX/s.value.scaling-s.value.panning.x,n.value.my=u.offsetY/s.value.scaling-s.value.panning.y)},l=()=>{if(i.value){const u=s.value.connections.find(p=>p.to===i.value);i.value.isInput&&u?(n.value={status:Di.NONE,from:u.from},s.value.removeConnection(u)):n.value={status:Di.NONE,from:i.value},n.value.mx=void 0,n.value.my=void 0}},h=()=>{n.value&&i.value&&s.value.addConnection(n.value.from,n.value.to),n.value=null};return ac("hoveredOver",u=>{if(i.value=u??null,u&&n.value){n.value.to=u;const p=s.value.checkConnection(n.value.from,n.value.to);if(n.value.status=p.connectionAllowed?Di.ALLOWED:Di.FORBIDDEN,p.connectionAllowed){const c=p.connectionsInDanger.map(_=>_.id);s.value.connections.forEach(_=>{c.includes(_.id)&&(_.isInDanger=true)})}}else!u&&n.value&&(n.value.to=void 0,n.value.status=Di.NONE,s.value.connections.forEach(p=>{p.isInDanger=false}))}),{temporaryConnection:n,onMouseMove:o,onMouseDown:l,onMouseUp:h}}const UG=et({setup(){const{viewModel:s}=On(),{graph:n}=rn();return{styles:me(()=>{const o=s.value.settings.background,l=n.value.panning.x*n.value.scaling,h=n.value.panning.y*n.value.scaling,f=n.value.scaling*o.gridSize,u=f/o.gridDivision,p=`${f}px ${f}px, ${f}px ${f}px`,c=n.value.scaling>o.subGridVisibleThreshold?`, ${u}px ${u}px, ${u}px ${u}px`:"";return{backgroundPosition:`left ${l}px top ${h}px`,backgroundSize:`${p} ${c}`}})}}}),Kt=(s,n)=>{const i=s.__vccOpts||s;for(const[o,l]of n)i[o]=l;return i};function FG(s,n,i,o,l,h){return ie(),Se("div",{class:"background",style:Qs(s.styles)},null,4)}const GG=Kt(UG,[["render",FG]]);var oy;const R0=typeof window<"u",HG=s=>typeof s=="string",VG=()=>{};R0&&((oy=window==null?void 0:window.navigator)!=null&&oy.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function WG(s){return typeof s=="function"?s():ge(s)}function zG(s){return s}function jG(s,n,i=false){return n.reduce((o,l)=>(l in s&&(!i||s[l]!==void 0)&&(o[l]=s[l]),o),{})}function XG(s){return hw()?($y(s),true):false}var KG=Object.defineProperty,YG=Object.defineProperties,qG=Object.getOwnPropertyDescriptors,ay=Object.getOwnPropertySymbols,JG=Object.prototype.hasOwnProperty,ZG=Object.prototype.propertyIsEnumerable,ly=(s,n,i)=>n in s?KG(s,n,{enumerable:true,configurable:true,writable:true,value:i}):s[n]=i,QG=(s,n)=>{for(var i in n||(n={}))JG.call(n,i)&&ly(s,i,n[i]);if(ay)for(var i of ay(n))ZG.call(n,i)&&ly(s,i,n[i]);return s},eH=(s,n)=>YG(s,qG(n));function tH(s){if(!ha(s))return Ry(s);const n=Array.isArray(s.value)?new Array(s.value.length):{};for(const i in s.value)n[i]=cw(()=>({get(){return s.value[i]},set(o){if(Array.isArray(s.value)){const l=[...s.value];l[i]=o,s.value=l}else{const l=eH(QG({},s.value),{[i]:o});Object.setPrototypeOf(l,s.value),s.value=l}}}));return n}function Bl(s){var n;const i=WG(s);return(n=i==null?void 0:i.$el)!=null?n:i}const gm=R0?window:void 0;function ao(...s){let n,i,o,l;if(HG(s[0])||Array.isArray(s[0])?([i,o,l]=s,n=gm):[n,i,o,l]=s,!n)return VG;Array.isArray(i)||(i=[i]),Array.isArray(o)||(o=[o]);const h=[],f=()=>{h.forEach(_=>_()),h.length=0},u=(_,m,E)=>(_.addEventListener(m,E,l),()=>_.removeEventListener(m,E,l)),p=Mt(()=>Bl(n),_=>{f(),_&&h.push(...i.flatMap(m=>o.map(E=>u(_,m,E))))},{immediate:true,flush:"post"}),c=()=>{p(),f()};return XG(c),c}function Nf(s,n,i={}){const{window:o=gm,ignore:l=[],capture:h=true,detectIframe:f=false}=i;if(!o)return;let u=true,p;const c=b=>l.some(T=>{if(typeof T=="string")return Array.from(o.document.querySelectorAll(T)).some(y=>y===b.target||b.composedPath().includes(y));{const y=Bl(T);return y&&(b.target===y||b.composedPath().includes(y))}}),_=b=>{o.clearTimeout(p);const T=Bl(s);if(!(!T||T===b.target||b.composedPath().includes(T))){if(b.detail===0&&(u=!c(b)),!u){u=true;return}n(b)}},m=[ao(o,"click",_,{passive:true,capture:h}),ao(o,"pointerdown",b=>{const T=Bl(s);T&&(u=!b.composedPath().includes(T)&&!c(b))},{passive:true}),ao(o,"pointerup",b=>{if(b.button===0){const T=b.composedPath();b.composedPath=()=>T,p=o.setTimeout(()=>_(b),50)}},{passive:true}),f&&ao(o,"blur",b=>{var T;const y=Bl(s);((T=o.document.activeElement)==null?void 0:T.tagName)==="IFRAME"&&!(y!=null&&y.contains(o.document.activeElement))&&n(b)})].filter(Boolean);return()=>m.forEach(b=>b())}const cy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uy="__vueuse_ssr_handlers__";cy[uy]=cy[uy]||{};var sH=Object.defineProperty,iH=Object.defineProperties,nH=Object.getOwnPropertyDescriptors,hy=Object.getOwnPropertySymbols,rH=Object.prototype.hasOwnProperty,oH=Object.prototype.propertyIsEnumerable,dy=(s,n,i)=>n in s?sH(s,n,{enumerable:true,configurable:true,writable:true,value:i}):s[n]=i,aH=(s,n)=>{for(var i in n||(n={}))rH.call(n,i)&&dy(s,i,n[i]);if(hy)for(var i of hy(n))oH.call(n,i)&&dy(s,i,n[i]);return s},lH=(s,n)=>iH(s,nH(n));const I0={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},cH=Object.keys(I0);function uH(s={}){const{target:n=gm}=s,i=be(false),o=be(s.initialValue||{});Object.assign(o.value,I0,o.value);const l=h=>{i.value=true,!(s.pointerTypes&&!s.pointerTypes.includes(h.pointerType))&&(o.value=jG(h,cH,false))};return n&&(ao(n,"pointerdown",l,{passive:true}),ao(n,"pointermove",l,{passive:true}),ao(n,"pointerleave",()=>i.value=false,{passive:true})),lH(aH({},tH(o)),{isInside:i})}var _y;(function(s){s.UP="UP",s.RIGHT="RIGHT",s.DOWN="DOWN",s.LEFT="LEFT",s.NONE="NONE"})(_y||(_y={}));var hH=Object.defineProperty,py=Object.getOwnPropertySymbols,dH=Object.prototype.hasOwnProperty,_H=Object.prototype.propertyIsEnumerable,gy=(s,n,i)=>n in s?hH(s,n,{enumerable:true,configurable:true,writable:true,value:i}):s[n]=i,pH=(s,n)=>{for(var i in n||(n={}))dH.call(n,i)&&gy(s,i,n[i]);if(py)for(var i of py(n))_H.call(n,i)&&gy(s,i,n[i]);return s};const gH={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};pH({linear:zG},gH);const fH=et({props:{modelValue:{type:Boolean,default:false},items:{type:Array,required:true},x:{type:Number,default:0},y:{type:Number,default:0},isNested:{type:Boolean,default:false},isFlipped:{type:Object,default:()=>({x:false,y:false})},flippable:{type:Boolean,default:false}},emits:["click","update:modelValue"],setup(s,{emit:n}){let i=null;const o=be(null),l=be(-1),h=be(0),f=be({x:false,y:false}),u=me(()=>s.flippable&&(f.value.x||s.isFlipped.x)),p=me(()=>s.flippable&&(f.value.y||s.isFlipped.y)),c=me(()=>{const g={};return s.isNested||(g.top=(p.value?s.y-h.value:s.y)+"px",g.left=s.x+"px"),g}),_=me(()=>({"--flipped-x":u.value,"--flipped-y":p.value,"--nested":s.isNested})),m=me(()=>s.items.map(g=>({...g,hover:false})));return Mt([()=>s.y,()=>s.items],()=>{var g,$,R,v;h.value=s.items.length*30;const S=(($=(g=o.value)==null?void 0:g.parentElement)==null?void 0:$.offsetWidth)??0,O=((v=(R=o.value)==null?void 0:R.parentElement)==null?void 0:v.offsetHeight)??0;f.value.x=!s.isNested&&s.x>S*.75,f.value.y=!s.isNested&&s.y+h.value>O-20}),Nf(o,()=>{s.modelValue&&n("update:modelValue",false)}),{el:o,activeMenu:l,flippedX:u,flippedY:p,styles:c,classes:_,itemsWithHoverProperty:m,onClick:g=>{!g.submenu&&g.value&&(n("click",g.value),n("update:modelValue",false))},onChildClick:g=>{n("click",g),l.value=-1,s.isNested||n("update:modelValue",false)},onClickOutside:Nf,onMouseEnter:(g,$)=>{s.items[$].submenu&&(l.value=$,i!==null&&(clearTimeout(i),i=null))},onMouseLeave:(g,$)=>{s.items[$].submenu&&(i=window.setTimeout(()=>{l.value=-1,i=null},200))}}}}),mH=["onMouseenter","onMouseleave","onClick"],EH={class:"flex-fill"},bH={key:0,class:"__submenu-icon",style:{"line-height":"1em"}},vH=le("svg",{width:"13",height:"13",viewBox:"-60 120 250 250"},[le("path",{d:"M160.875 279.5625 L70.875 369.5625 L70.875 189.5625 L160.875 279.5625 Z",stroke:"none",fill:"white"})],-1),TH=[vH];function SH(s,n,i,o,l,h){const f=Ze("context-menu",true);return ie(),Ye(lc,{name:"slide-fade"},{default:We(()=>[Hs(le("div",{ref:"el",class:tt(["baklava-context-menu",s.classes]),style:Qs(s.styles)},[(ie(true),Se(xt,null,ni(s.itemsWithHoverProperty,(u,p)=>(ie(),Se(xt,null,[u.isDivider?(ie(),Se("div",{key:`d-${p}`,class:"divider"})):(ie(),Se("div",{key:`i-${p}`,class:tt(["item",{submenu:!!u.submenu,"--disabled":!!u.disabled}]),onMouseenter:c=>s.onMouseEnter(c,p),onMouseleave:c=>s.onMouseLeave(c,p),onClick:si(c=>s.onClick(u),["stop","prevent"])},[le("div",EH,Pt(u.label),1),u.submenu?(ie(),Se("div",bH,TH)):ot("",true),u.submenu?(ie(),Ye(f,{key:1,value:s.activeMenu===p,items:u.submenu,"is-nested":true,"is-flipped":{x:s.flippedX,y:s.flippedY},flippable:s.flippable,onClick:s.onChildClick},null,8,["value","items","is-flipped","flippable","onClick"])):ot("",true)],42,mH))],64))),256))],6),[[$i,s.modelValue]])]),_:1})}const C0=Kt(fH,[["render",SH]]),$H={},yH={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"16",height:"16",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},RH=le("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),IH=le("circle",{cx:"12",cy:"12",r:"1"},null,-1),CH=le("circle",{cx:"12",cy:"19",r:"1"},null,-1),OH=le("circle",{cx:"12",cy:"5",r:"1"},null,-1),wH=[RH,IH,CH,OH];function kH(s,n){return ie(),Se("svg",yH,wH)}const O0=Kt($H,[["render",kH]]),AH=et({props:{node:{type:Object,required:true},intf:{type:Object,required:true}},setup(s){const{viewModel:n}=On(),i=ri("hoveredOver"),o=be(null),l=me(()=>s.intf.connectionCount>0),h=me(()=>({"--input":s.intf.isInput,"--output":!s.intf.isInput,"--connected":l.value})),f=me(()=>s.intf.component&&s.intf.connectionCount===0&&(s.intf.isInput||!s.intf.port)),u=()=>{i(s.intf)},p=()=>{i(void 0)},c=()=>{o.value&&n.value.hooks.renderInterface.execute({intf:s.intf,el:o.value})},_=()=>{const m=n.value.displayedGraph.sidebar;m.nodeId=s.node.id,m.optionName=s.intf.name,m.visible=true};return xs(c),Oy(c),{el:o,isConnected:l,classes:h,showComponent:f,startHover:u,endHover:p,openSidebar:_}}}),LH=["id"],NH={key:2,class:"align-middle"};function MH(s,n,i,o,l,h){return ie(),Se("div",{id:s.intf.id,ref:"el",class:tt(["baklava-node-interface",s.classes])},[s.intf.port?(ie(),Se("div",{key:0,class:"__port",onPointerover:n[0]||(n[0]=(...f)=>s.startHover&&s.startHover(...f)),onPointerout:n[1]||(n[1]=(...f)=>s.endHover&&s.endHover(...f))},null,32)):ot("",true),s.showComponent?(ie(),Ye(ti(s.intf.component),{key:1,modelValue:s.intf.value,"onUpdate:modelValue":n[2]||(n[2]=f=>s.intf.value=f),node:s.node,intf:s.intf,onOpenSidebar:s.openSidebar},null,40,["modelValue","node","intf","onOpenSidebar"])):(ie(),Se("span",NH,Pt(s.intf.name),1))],10,LH)}const fy=Kt(AH,[["render",MH]]),DH=["id","data-node-type"],xH=["onPointerdown"],BH={class:"__title-label"},PH={class:"__menu"},UH=["onKeydown"],FH={class:"__content"},GH={class:"__outputs"},HH={class:"__inputs"},VH=et({__name:"Node",props:{node:null,selected:{type:Boolean,default:false}},emits:["select"],setup(s,{emit:n}){const i=s,{viewModel:o}=On(),{graph:l,switchGraph:h}=rn(),f=y0(tn(i.node,"position")),u=be(null),p=be(false),c=be(""),_=be(null),m=be(false),E=me(()=>{const I=[{value:"rename",label:"Rename"},{value:"delete",label:"Delete"}];return i.node.type.startsWith(tc)&&I.push({value:"editSubgraph",label:"Edit Subgraph"}),I}),b=me(()=>({"--selected":i.selected,"--dragging":f.dragging.value,"--two-column":!!i.node.twoColumn})),T=me(()=>{var I,L;return{top:`${((I=i.node.position)==null?void 0:I.y)??0}px`,left:`${((L=i.node.position)==null?void 0:L.x)??0}px`,width:`${i.node.width??200}px`}}),y=me(()=>Object.values(i.node.inputs).filter(I=>!I.hidden)),g=me(()=>Object.values(i.node.outputs).filter(I=>!I.hidden)),$=()=>{n("select")},R=I=>{f.onPointerDown(I),document.addEventListener("pointermove",f.onPointerMove),document.addEventListener("pointerup",v),$()},v=()=>{f.onPointerUp(),document.removeEventListener("pointermove",f.onPointerMove),document.removeEventListener("pointerup",v)},S=()=>{m.value=true},O=async I=>{var L;switch(I){case"delete":l.value.removeNode(i.node);break;case"rename":c.value=i.node.title,p.value=true,await ps(),(L=_.value)==null||L.focus();break;case"editSubgraph":h(i.node.template);break}},w=()=>{i.node.title=c.value,p.value=false},A=()=>{u.value&&o.value.hooks.renderNode.execute({node:i.node,el:u.value})};return xs(A),Oy(A),(I,L)=>(ie(),Se("div",{id:s.node.id,ref_key:"el",ref:u,class:tt(["baklava-node",ge(b)]),style:Qs(ge(T)),"data-node-type":s.node.type,onPointerdown:$},[le("div",{class:"__title",onPointerdown:si(R,["self","stop"])},[p.value?Hs((ie(),Se("input",{key:1,ref_key:"renameInputEl",ref:_,"onUpdate:modelValue":L[1]||(L[1]=x=>c.value=x),type:"text",class:"baklava-input",placeholder:"Node Name",onBlur:w,onKeydown:la(w,["enter"])},null,40,UH)),[[wy,c.value]]):(ie(),Se(xt,{key:0},[le("div",BH,Pt(s.node.title),1),le("div",PH,[De(O0,{class:"--clickable",onClick:S}),De(C0,{modelValue:m.value,"onUpdate:modelValue":L[0]||(L[0]=x=>m.value=x),x:0,y:0,items:ge(E),onClick:O},null,8,["modelValue","items"])])],64))],40,xH),le("div",FH,[le("div",GH,[(ie(true),Se(xt,null,ni(ge(g),x=>(ie(),Ye(fy,{key:x.id,node:s.node,intf:x},null,8,["node","intf"]))),128))]),le("div",HH,[(ie(true),Se(xt,null,ni(ge(y),x=>(ie(),Ye(fy,{key:x.id,node:s.node,intf:x},null,8,["node","intf"]))),128))])])],46,DH))}}),WH=et({props:{x1:{type:Number,required:true},y1:{type:Number,required:true},x2:{type:Number,required:true},y2:{type:Number,required:true},state:{type:Number,default:Di.NONE},isTemporary:{type:Boolean,default:false}},setup(s){const{viewModel:n}=On(),{graph:i}=rn(),o=(f,u)=>{const p=(f+i.value.panning.x)*i.value.scaling,c=(u+i.value.panning.y)*i.value.scaling;return[p,c]},l=me(()=>{const[f,u]=o(s.x1,s.y1),[p,c]=o(s.x2,s.y2);if(n.value.settings.useStraightConnections)return`M ${f} ${u} L ${p} ${c}`;{const _=.3*Math.abs(f-p);return`M ${f} ${u} C ${f+_} ${u}, ${p-_} ${c}, ${p} ${c}`}}),h=me(()=>({"--temporary":s.isTemporary,"--allowed":s.state===Di.ALLOWED,"--forbidden":s.state===Di.FORBIDDEN}));return{d:l,classes:h}}}),zH=["d"];function jH(s,n,i,o,l,h){return ie(),Se("path",{class:tt(["baklava-connection",s.classes]),d:s.d},null,10,zH)}const w0=Kt(WH,[["render",jH]]);function XH(s){return document.getElementById(s.id)}function Ea(s){const n=document.getElementById(s.id),i=n==null?void 0:n.getElementsByClassName("__port");return{node:(n==null?void 0:n.closest(".baklava-node"))??null,interface:n,port:i&&i.length>0?i[0]:null}}const KH=et({components:{"connection-view":w0},props:{connection:{type:Object,required:true}},setup(s){const{graph:n}=rn();let i;const o=be({x1:0,y1:0,x2:0,y2:0}),l=me(()=>s.connection.isInDanger?Di.FORBIDDEN:Di.NONE),h=me(()=>{var c;return(c=n.value.findNodeById(s.connection.from.nodeId))==null?void 0:c.position}),f=me(()=>{var c;return(c=n.value.findNodeById(s.connection.to.nodeId))==null?void 0:c.position}),u=c=>c.node&&c.interface&&c.port?[c.node.offsetLeft+c.interface.offsetLeft+c.port.offsetLeft+c.port.clientWidth/2,c.node.offsetTop+c.interface.offsetTop+c.port.offsetTop+c.port.clientHeight/2]:[0,0],p=()=>{const c=Ea(s.connection.from),_=Ea(s.connection.to);c.node&&_.node&&(i||(i=new ResizeObserver(()=>{p()}),i.observe(c.node),i.observe(_.node)));const[m,E]=u(c),[b,T]=u(_);o.value={x1:m,y1:E,x2:b,y2:T}};return xs(async()=>{await ps(),p()}),ba(()=>{i&&i.disconnect()}),Mt([h,f],()=>p(),{deep:true}),{d:o,state:l}}});function YH(s,n,i,o,l,h){const f=Ze("connection-view");return ie(),Ye(f,{x1:s.d.x1,y1:s.d.y1,x2:s.d.x2,y2:s.d.y2,state:s.state},null,8,["x1","y1","x2","y2","state"])}const qH=Kt(KH,[["render",YH]]);function sh(s){return s.node&&s.interface&&s.port?[s.node.offsetLeft+s.interface.offsetLeft+s.port.offsetLeft+s.port.clientWidth/2,s.node.offsetTop+s.interface.offsetTop+s.port.offsetTop+s.port.clientHeight/2]:[0,0]}const JH=et({components:{"connection-view":w0},props:{connection:{type:Object,required:true}},setup(s){const n=me(()=>s.connection?s.connection.status:Di.NONE);return{d:me(()=>{if(!s.connection)return{input:[0,0],output:[0,0]};const o=sh(Ea(s.connection.from)),l=s.connection.to?sh(Ea(s.connection.to)):[s.connection.mx||o[0],s.connection.my||o[1]];return s.connection.from.isInput?{input:l,output:o}:{input:o,output:l}}),status:n}}});function ZH(s,n,i,o,l,h){const f=Ze("connection-view");return ie(),Ye(f,{x1:s.d.input[0],y1:s.d.input[1],x2:s.d.output[0],y2:s.d.output[1],state:s.status,"is-temporary":""},null,8,["x1","y1","x2","y2","state"])}const QH=Kt(JH,[["render",ZH]]),eV=et({setup(){const{graph:s}=rn(),n=be(null),i=be(300),o=me(()=>{const c=s.value.sidebar.nodeId;return s.value.nodes.find(_=>_.id===c)}),l=me(()=>({width:`${i.value}px`})),h=me(()=>o.value?[...Object.values(o.value.inputs),...Object.values(o.value.outputs)].filter(_=>_.displayInSidebar&&_.component):[]),f=()=>{s.value.sidebar.visible=false},u=()=>{window.addEventListener("mousemove",p),window.addEventListener("mouseup",()=>{window.removeEventListener("mousemove",p)},{once:true})},p=c=>{var _,m;const E=((m=(_=n.value)==null?void 0:_.parentElement)==null?void 0:m.getBoundingClientRect().width)??500;i.value-=c.movementX,i.value<300?i.value=300:i.value>.9*E&&(i.value=.9*E)};return{el:n,graph:s,node:o,styles:l,displayedInterfaces:h,startResize:u,close:f}}}),tV={class:"__header"},sV={class:"__node-name"};function iV(s,n,i,o,l,h){return ie(),Se("div",{ref:"el",class:tt(["baklava-sidebar",{"--open":s.graph.sidebar.visible}]),style:Qs(s.styles)},[le("div",{class:"__resizer",onMousedown:n[0]||(n[0]=(...f)=>s.startResize&&s.startResize(...f))},null,32),le("div",tV,[le("button",{tabindex:"-1",class:"__close",onClick:n[1]||(n[1]=(...f)=>s.close&&s.close(...f))}," \xD7 "),le("div",sV,[le("b",null,Pt(s.node?s.node.title:""),1)])]),(ie(true),Se(xt,null,ni(s.displayedInterfaces,f=>(ie(),Se("div",{key:f.id,class:"__interface"},[(ie(),Ye(ti(f.component),{modelValue:f.value,"onUpdate:modelValue":u=>f.value=u,node:s.node,intf:f},null,8,["modelValue","onUpdate:modelValue","node","intf"]))]))),128))],6)}const nV=Kt(eV,[["render",iV]]),rV=et({setup(){const{viewModel:s}=On(),{graph:n}=rn(),i=be(null),o=be(false);let l,h=false,f={x1:0,y1:0,x2:0,y2:0};const u=()=>{var R,v;if(!l)return;const S=new Map,O=new Map;for(const I of n.value.nodes){const L=XH(I),x=(L==null?void 0:L.clientWidth)??0,B=(L==null?void 0:L.clientHeight)??0,H=((R=I.position)==null?void 0:R.x)??0,F=((v=I.position)==null?void 0:v.y)??0;S.set(I,{x1:H,y1:F,x2:H+x,y2:F+B}),O.set(I,L)}const w={x1:Number.MAX_SAFE_INTEGER,y1:Number.MAX_SAFE_INTEGER,x2:Number.MIN_SAFE_INTEGER,y2:Number.MIN_SAFE_INTEGER};for(const I of S.values())I.x1<w.x1&&(w.x1=I.x1),I.y1<w.y1&&(w.y1=I.y1),I.x2>w.x2&&(w.x2=I.x2),I.y2>w.y2&&(w.y2=I.y2);const A=50;w.x1-=A,w.y1-=A,w.x2+=A,w.y2+=A,f=w,l.clearRect(0,0,l.canvas.width,l.canvas.height),l.strokeStyle="white";for(const I of n.value.connections){const[L,x]=sh(Ea(I.from)),[B,H]=sh(Ea(I.to)),[F,X]=p(L,x),[Z,J]=p(B,H);if(l.beginPath(),l.moveTo(F,X),s.value.settings.useStraightConnections)l.lineTo(Z,J);else{const D=.3*Math.abs(F-Z);l.bezierCurveTo(F+D,X,Z-D,J,Z,J)}l.stroke()}l.strokeStyle="lightgray";for(const[I,L]of S.entries()){const[x,B]=p(L.x1,L.y1),[H,F]=p(L.x2,L.y2);l.fillStyle=_(O.get(I)),l.beginPath(),l.rect(x,B,H-x,F-B),l.fill(),l.stroke()}if(o.value){const I=E(),[L,x]=p(I.x1,I.y1),[B,H]=p(I.x2,I.y2);l.fillStyle="rgba(255, 255, 255, 0.2)",l.fillRect(L,x,B-L,H-x)}},p=(R,v)=>[(R-f.x1)/(f.x2-f.x1)*l.canvas.clientWidth,(v-f.y1)/(f.y2-f.y1)*l.canvas.clientHeight],c=(R,v)=>[R*(f.x2-f.x1)/l.canvas.clientWidth+f.x1,v*(f.y2-f.y1)/l.canvas.clientHeight+f.y1],_=R=>{if(R){const v=R.querySelector(".__content");if(v){const O=m(v);if(O)return O}const S=m(R);if(S)return S}return"gray"},m=R=>{const v=getComputedStyle(R).backgroundColor;if(v&&v!=="rgba(0, 0, 0, 0)")return v},E=()=>{const R=i.value.parentElement.offsetWidth,v=i.value.parentElement.offsetHeight,S=R/n.value.scaling-n.value.panning.x,O=v/n.value.scaling-n.value.panning.y;return{x1:-n.value.panning.x,y1:-n.value.panning.y,x2:S,y2:O}},b=R=>{R.button===0&&(h=true,T(R))},T=R=>{if(h){const[v,S]=c(R.offsetX,R.offsetY),O=E(),w=(O.x1-O.x2)/2,A=(O.y1-O.y2)/2;n.value.panning.x=-(v+w),n.value.panning.y=-(S+A)}},y=()=>{h=false},g=()=>{o.value=true},$=()=>{o.value=false,y()};return xs(()=>{l=i.value.getContext("2d"),l.imageSmoothingQuality="high",u()}),{canvas:i,showViewBounds:o,mousedown:b,mousemove:T,mouseup:y,mouseenter:g,mouseleave:$}}});function oV(s,n,i,o,l,h){return ie(),Se("canvas",{ref:"canvas",class:"baklava-minimap",onMouseenter:n[0]||(n[0]=(...f)=>s.mouseenter&&s.mouseenter(...f)),onMouseleave:n[1]||(n[1]=(...f)=>s.mouseleave&&s.mouseleave(...f)),onMousedown:n[2]||(n[2]=si((...f)=>s.mousedown&&s.mousedown(...f),["self"])),onMousemove:n[3]||(n[3]=si((...f)=>s.mousemove&&s.mousemove(...f),["self"])),onMouseup:n[4]||(n[4]=(...f)=>s.mouseup&&s.mouseup(...f))},null,544)}const aV=Kt(rV,[["render",oV]]),lV=et({components:{ContextMenu:C0,VerticalDots:O0},props:{type:{type:String,required:true},title:{type:String,required:true}},setup(s){const{viewModel:n}=On(),{switchGraph:i}=rn(),o=be(false),l=me(()=>s.type.startsWith(tc));return{showContextMenu:o,hasContextMenu:l,contextMenuItems:[{label:"Edit Subgraph",value:"editSubgraph"},{label:"Delete Subgraph",value:"deleteSubgraph"}],openContextMenu:()=>{o.value=true},onContextMenuClick:p=>{const c=s.type.substring(tc.length),_=n.value.editor.graphTemplates.find(m=>m.id===c);if(_)switch(p){case"editSubgraph":i(_);break;case"deleteSubgraph":n.value.editor.removeGraphTemplate(_);break}}}}}),cV=["data-node-type"],uV={class:"__title"},hV={class:"__title-label"},dV={key:0,class:"__menu"};function _V(s,n,i,o,l,h){const f=Ze("vertical-dots"),u=Ze("context-menu");return ie(),Se("div",{class:"baklava-node --palette","data-node-type":s.type},[le("div",uV,[le("div",hV,Pt(s.title),1),s.hasContextMenu?(ie(),Se("div",dV,[De(f,{class:"--clickable",onPointerdown:n[0]||(n[0]=si(()=>{},["stop","prevent"])),onClick:si(s.openContextMenu,["stop","prevent"])},null,8,["onClick"]),De(u,{modelValue:s.showContextMenu,"onUpdate:modelValue":n[1]||(n[1]=p=>s.showContextMenu=p),x:-100,y:0,items:s.contextMenuItems,onClick:s.onContextMenuClick,onPointerdown:n[2]||(n[2]=si(()=>{},["stop","prevent"]))},null,8,["modelValue","items","onClick"])])):ot("",true)])],8,cV)}const pV=Kt(lV,[["render",_V]]);let Fu;const gV=new Uint8Array(16);function fV(){if(!Fu&&(Fu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Fu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Fu(gV)}const Cs=[];for(let s=0;s<256;++s)Cs.push((s+256).toString(16).slice(1));function mV(s,n=0){return(Cs[s[n+0]]+Cs[s[n+1]]+Cs[s[n+2]]+Cs[s[n+3]]+"-"+Cs[s[n+4]]+Cs[s[n+5]]+"-"+Cs[s[n+6]]+Cs[s[n+7]]+"-"+Cs[s[n+8]]+Cs[s[n+9]]+"-"+Cs[s[n+10]]+Cs[s[n+11]]+Cs[s[n+12]]+Cs[s[n+13]]+Cs[s[n+14]]+Cs[s[n+15]]).toLowerCase()}const EV=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),my={randomUUID:EV};function sc(s,n,i){if(my.randomUUID&&!n&&!s)return my.randomUUID();s=s||{};const o=s.random||(s.rng||fV)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,n){i=i||0;for(let l=0;l<16;++l)n[i+l]=o[l];return n}return mV(o)}et({props:{intf:{type:Object,required:true}},setup(s){return{onClick:()=>{s.intf.callback&&s.intf.callback()}}}});et({props:{intf:{type:Object,required:true}}});const Ey=9;function bV(s){return"validate"in s}const fm=(s,n=3)=>{const i=be(null),o=be(false),l=be(false),h=be("0"),f=me(()=>{const m=s.value.value.toFixed(n);return m.length>Ey?s.value.value.toExponential(Ey-5):m}),u=m=>Number.isNaN(m)?false:bV(s.value)?s.value.validate(m):true,p=m=>{u(m)&&(s.value.value=m)};return Mt(h,()=>{l.value=false}),{editMode:o,invalid:l,tempValue:h,inputEl:i,stringRepresentation:f,validate:u,setValue:p,enterEditMode:async()=>{h.value=s.value.value.toFixed(n),o.value=true,await ps(),i.value&&i.value.focus()},leaveEditMode:()=>{const m=parseFloat(h.value);u(m)?(p(m),o.value=false):l.value=true}}},vV={},TV={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},SV=le("polyline",{points:"6 9 12 15 18 9"},null,-1),$V=[SV];function yV(s,n){return ie(),Se("svg",TV,$V)}const mm=Kt(vV,[["render",yV]]);et({components:{"i-arrow":mm},props:{intf:{type:Object,required:true}},setup(s){const n=fm(tn(s,"intf"),0);return{...n,increment:()=>{n.setValue(s.intf.value+1)},decrement:()=>{n.setValue(s.intf.value-1)}}}});et({components:{"i-arrow":mm},props:{intf:{type:Object,required:true}},setup(s){const n=fm(tn(s,"intf"));return{...n,increment:()=>{n.setValue(s.intf.value+.1)},decrement:()=>{n.setValue(s.intf.value-.1)}}}});const RV=et({components:{"i-arrow":mm},props:{intf:{type:Object,required:true}},setup(s){const n=be(null),i=be(false),o=me(()=>s.intf.items.find(f=>typeof f=="string"?f===s.intf.value:f.value===s.intf.value)),l=me(()=>o.value?typeof o.value=="string"?o.value:o.value.text:""),h=f=>{s.intf.value=typeof f=="string"?f:f.value};return Nf(n,()=>{i.value=false}),{el:n,open:i,selectedItem:o,selectedText:l,setSelected:h}}}),IV=["title"],CV={class:"__selected"},OV={class:"__text"},wV={class:"__icon"},kV={class:"__dropdown"},AV={class:"item --header"},LV=["onClick"];function NV(s,n,i,o,l,h){const f=Ze("i-arrow");return ie(),Se("div",{ref:"el",class:tt(["baklava-select",{"--open":s.open}]),title:s.intf.name,onClick:n[0]||(n[0]=u=>s.open=!s.open)},[le("div",CV,[le("div",OV,Pt(s.selectedText),1),le("div",wV,[De(f)])]),De(lc,{name:"slide-fade"},{default:We(()=>[Hs(le("div",kV,[le("div",AV,Pt(s.intf.name),1),(ie(true),Se(xt,null,ni(s.intf.items,(u,p)=>(ie(),Se("div",{key:p,class:tt(["item",{"--active":u===s.selectedItem}]),onClick:c=>s.setSelected(u)},Pt(typeof u=="string"?u:u.text),11,LV))),128))],512),[[$i,s.open]])]),_:1})],10,IV)}const MV=Kt(RV,[["render",NV]]);class Em extends yt{constructor(n,i,o){super(n,i),this.component=ky(MV),this.items=o}}et({props:{intf:{type:Object,required:true}},setup(s){const n=be(null),i=fm(tn(s,"intf")),o=be(false),l=be(false),h=me(()=>Math.min(100,Math.max(0,s.intf.value*100/(s.intf.max-s.intf.min))));return{...i,el:n,percentage:h,mousedown:()=>{i.editMode.value||(l.value=true)},mouseup:()=>{i.editMode.value||(o.value||i.enterEditMode(),l.value=false,o.value=false)},mousemove:_=>{if(i.editMode.value)return;const m=Math.max(s.intf.min,Math.min(s.intf.max,(s.intf.max-s.intf.min)*(_.offsetX/n.value.clientWidth)+s.intf.min));l.value&&(i.setValue(m),o.value=true)},mouseleave:_=>{i.editMode.value||(l.value&&(_.offsetX>=n.value.clientWidth?i.setValue(s.intf.max):_.offsetX<=0&&i.setValue(s.intf.min)),l.value=false,o.value=false)}}}});et({props:{intf:{type:Object,required:true}}});const DV=et({props:{intf:{type:Object,required:true},modelValue:{type:String,required:true}},emits:["update:modelValue"],setup(s,{emit:n}){return{v:me({get:()=>s.modelValue,set:o=>{n("update:modelValue",o)}})}}}),xV=["placeholder","title"];function BV(s,n,i,o,l,h){return ie(),Se("div",null,[Hs(le("input",{"onUpdate:modelValue":n[0]||(n[0]=f=>s.v=f),type:"text",class:"baklava-input",placeholder:s.intf.name,title:s.intf.name},null,8,xV),[[wy,s.v]])])}const PV=Kt(DV,[["render",BV]]);class Ws extends yt{constructor(){super(...arguments),this.component=ky(PV)}}const ic="__baklava_SubgraphInputNode",nc="__baklava_SubgraphOutputNode",k0=Pi({type:ic,title:"Subgraph Input",inputs:{name:()=>new Ws("Name","Input").setPort(false)},outputs:{placeholder:()=>new yt("Connection",void 0)},onCreate(){this.graphInterfaceId=sc()}}),A0=Pi({type:nc,title:"Subgraph Output",inputs:{name:()=>new Ws("Name","Output").setPort(false),placeholder:()=>new yt("Connection",void 0)},onCreate(){this.graphInterfaceId=sc()}});function L0(s,n,i){if(!n.template)return false;if(ma(n.template)===i)return true;const o=s.graphTemplates.find(h=>ma(h)===i);return o?o.nodes.filter(h=>h.type.startsWith(tc)).some(h=>L0(s,n,h.type)):false}const UV=et({components:{PaletteEntry:pV},setup(){const{viewModel:s}=On(),{x:n,y:i}=uH(),{transform:o}=xG(),l=ri("editorEl"),h=be(null),f=me(()=>{const c=Array.from(s.value.editor.nodeTypes.entries()),_=new Set(c.map(([,E])=>E.category)),m=[];for(const E of _.values()){let b=c.filter(([,T])=>T.category===E);s.value.displayedGraph.template?b=b.filter(([T])=>!L0(s.value.editor,s.value.displayedGraph,T)):b=b.filter(([T])=>![ic,nc].includes(T)),b.length>0&&m.push({name:E,nodeTypes:Object.fromEntries(b)})}return m.sort((E,b)=>E.name==="default"?-1:b.name==="default"||E.name>b.name?1:-1),m}),u=me(()=>{if(!h.value||!(l!=null&&l.value))return{};const{left:c,top:_}=l.value.getBoundingClientRect();return{top:`${i.value-_}px`,left:`${n.value-c}px`}});return{draggedNode:h,categories:f,draggedNodeStyles:u,onDragStart:(c,_)=>{h.value={type:c,nodeInformation:_};const m=()=>{const E=In(new _.type);s.value.displayedGraph.addNode(E);const b=l.value.getBoundingClientRect(),[T,y]=o(n.value-b.left,i.value-b.top);E.position.x=T,E.position.y=y,h.value=null,document.removeEventListener("pointerup",m)};document.addEventListener("pointerup",m)},mouseX:n,mouseY:i}}}),FV={class:"baklava-node-palette"},GV={key:0};function HV(s,n,i,o,l,h){const f=Ze("PaletteEntry");return ie(),Se(xt,null,[le("div",FV,[(ie(true),Se(xt,null,ni(s.categories,u=>(ie(),Se("section",{key:u.name},[u.name!=="default"?(ie(),Se("h1",GV,Pt(u.name),1)):ot("",true),(ie(true),Se(xt,null,ni(u.nodeTypes,(p,c)=>(ie(),Ye(f,{key:c,type:c,title:p.title,onPointerdown:_=>s.onDragStart(c,p)},null,8,["type","title","onPointerdown"]))),128))]))),128))]),De(lc,{name:"fade"},{default:We(()=>[s.draggedNode?(ie(),Se("div",{key:0,class:"baklava-dragged-node",style:Qs(s.draggedNodeStyles)},[De(f,{type:s.draggedNode.type,title:s.draggedNode.nodeInformation.title},null,8,["type","title"])],4)):ot("",true)]),_:1})],64)}const VV=Kt(UV,[["render",HV]]),rc="SAVE_SUBGRAPH";function WV(s,n){const i=()=>{const o=s.value;if(!o.template)throw new Error("Graph template property not set");const l=[],h=[],f=o.nodes.filter(m=>m.type===ic);for(const m of f){const E=o.connections.filter(b=>b.from===m.outputs.placeholder);E.forEach(b=>{h.push({id:m.graphInterfaceId,name:m.inputs.name.value,nodeInterfaceId:b.to.id})}),l.push(...E)}const u=[],p=o.nodes.filter(m=>m.type===nc);for(const m of p){const E=o.connections.filter(b=>b.to===m.inputs.placeholder);E.forEach(b=>{u.push({id:m.graphInterfaceId,name:m.inputs.name.value,nodeInterfaceId:b.from.id})}),l.push(...E)}const c=o.connections.filter(m=>!l.includes(m)),_=o.nodes.filter(m=>m.type!==ic&&m.type!==nc);o.template.update({inputs:h,outputs:u,connections:c.map(m=>({id:m.id,from:m.from.id,to:m.to.id})),nodes:_.map(m=>m.save())}),o.template.panning=o.panning,o.template.scaling=o.scaling};n.registerCommand(rc,{canExecute:()=>{var o;return s.value!==((o=s.value.editor)==null?void 0:o.graph)},execute:i})}const N0="CREATE_SUBGRAPH",by=[ic,nc];function zV(s,n,i){const o=()=>s.value.selectedNodes.filter(h=>!by.includes(h.type)).length>0,l=()=>{const h=s.value,f=s.value.editor;if(h.selectedNodes.length===0)return;const u=h.selectedNodes.filter(A=>!by.includes(A.type)),p=u.flatMap(A=>Object.values(A.inputs)),c=u.flatMap(A=>Object.values(A.outputs)),_=h.connections.filter(A=>!c.includes(A.from)&&p.includes(A.to)),m=h.connections.filter(A=>c.includes(A.from)&&!p.includes(A.to)),E=h.connections.filter(A=>c.includes(A.from)&&p.includes(A.to)),b=_.map(A=>A.to),T=m.map(A=>A.from),y=new Map,g=[];for(const A of b){const I=sc();y.set(A.id,I),g.push({id:I,nodeInterfaceId:A.id,name:A.name})}const $=[];for(const A of T){const I=sc();y.set(A.id,I),$.push({id:I,nodeInterfaceId:A.id,name:A.name})}const R=In(new vh({connections:E.map(A=>({id:A.id,from:A.from.id,to:A.to.id})),inputs:g,outputs:$,nodes:u.map(A=>A.save())},f));f.addGraphTemplate(R);const v=f.nodeTypes.get(ma(R));if(!v)throw new Error("Unable to create subgraph: Could not find corresponding graph node type");const S=In(new v.type);h.addNode(S);const O=Math.round(u.map(A=>A.position.x).reduce((A,I)=>A+I,0)/u.length),w=Math.round(u.map(A=>A.position.y).reduce((A,I)=>A+I,0)/u.length);S.position.x=O,S.position.y=w,_.forEach(A=>{h.removeConnection(A),h.addConnection(A.from,S.inputs[y.get(A.to.id)])}),m.forEach(A=>{h.removeConnection(A),h.addConnection(S.outputs[y.get(A.from.id)],A.to)}),u.forEach(A=>h.removeNode(A)),n.canExecuteCommand(rc)&&n.executeCommand(rc),i(R),s.value.panning={...h.panning},s.value.scaling=h.scaling};n.registerCommand(N0,{canExecute:o,execute:l})}const vy="DELETE_NODES";function jV(s,n){n.registerCommand(vy,{canExecute:()=>s.value.selectedNodes.length>0,execute(){s.value.selectedNodes.forEach(i=>s.value.removeNode(i))}}),n.registerHotkey(["Delete"],vy)}const M0="SWITCH_TO_MAIN_GRAPH";function XV(s,n,i){n.registerCommand(M0,{canExecute:()=>s.value!==s.value.editor.graph,execute:()=>{n.executeCommand(rc),i(s.value.editor.graph)}})}function KV(s,n,i){jV(s,n),zV(s,n,i),WV(s,n),XV(s,n,i)}class Ty{constructor(n,i){this.type=n,n==="addNode"?this.nodeId=i:this.nodeState=i}undo(n){this.type==="addNode"?this.removeNode(n):this.addNode(n)}redo(n){this.type==="addNode"&&this.nodeState?this.addNode(n):this.type==="removeNode"&&this.nodeId&&this.removeNode(n)}addNode(n){const i=n.editor.nodeTypes.get(this.nodeState.type);if(!i)return;const o=new i.type;n.addNode(o),o.load(this.nodeState),this.nodeId=o.id}removeNode(n){const i=n.nodes.find(o=>o.id===this.nodeId);i&&(this.nodeState=i.save(),n.removeNode(i))}}class Sy{constructor(n,i){if(this.type=n,n==="addConnection")this.connectionId=i;else{const o=i;this.connectionState={id:o.id,from:o.from.id,to:o.to.id}}}undo(n){this.type==="addConnection"?this.removeConnection(n):this.addConnection(n)}redo(n){this.type==="addConnection"&&this.connectionState?this.addConnection(n):this.type==="removeConnection"&&this.connectionId&&this.removeConnection(n)}addConnection(n){const i=n.findNodeInterface(this.connectionState.from),o=n.findNodeInterface(this.connectionState.to);!i||!o||n.addConnection(i,o)}removeConnection(n){const i=n.connections.find(o=>o.id===this.connectionId);i&&(this.connectionState={id:i.id,from:i.from.id,to:i.to.id},n.removeConnection(i))}}class YV{constructor(n){if(this.type="transaction",n.length===0)throw new Error("Can't create a transaction with no steps");this.steps=n}undo(n){for(let i=this.steps.length-1;i>=0;i--)this.steps[i].undo(n)}redo(n){for(let i=0;i<this.steps.length;i++)this.steps[i].redo(n)}}const Mf="UNDO",Df="REDO",D0="START_TRANSACTION",x0="COMMIT_TRANSACTION";function qV(s,n){const i=Symbol("HistoryToken"),o=be(200),l=be([]),h=be(false),f=be(-1),u=be(false),p=be([]),c=g=>{if(!h.value)if(u.value)p.value.push(g);else for(f.value!==l.value.length-1&&(l.value=l.value.slice(0,f.value+1)),l.value.push(g),f.value++;l.value.length>o.value;)l.value.shift()},_=()=>{u.value=true},m=()=>{u.value=false,p.value.length>0&&(c(new YV(p.value)),p.value=[])},E=()=>l.value.length!==0&&f.value!==-1,b=()=>{E()&&(h.value=true,l.value[f.value--].undo(s.value),h.value=false)},T=()=>l.value.length!==0&&f.value<l.value.length-1,y=()=>{T()&&(h.value=true,l.value[++f.value].redo(s.value),h.value=false)};return Mt(s,(g,$)=>{$&&($.events.addNode.unsubscribe(i),$.events.removeNode.unsubscribe(i),$.events.addConnection.unsubscribe(i),$.events.removeConnection.unsubscribe(i)),g&&(g.events.addNode.subscribe(i,R=>{c(new Ty("addNode",R.id))}),g.events.removeNode.subscribe(i,R=>{c(new Ty("removeNode",R.save()))}),g.events.addConnection.subscribe(i,R=>{c(new Sy("addConnection",R.id))}),g.events.removeConnection.subscribe(i,R=>{c(new Sy("removeConnection",R))}))},{immediate:true}),n.registerCommand(Mf,{canExecute:E,execute:b}),n.registerCommand(Df,{canExecute:T,execute:y}),n.registerCommand(D0,{canExecute:()=>!u.value,execute:_}),n.registerCommand(x0,{canExecute:()=>u.value,execute:m}),n.registerHotkey(["Control","z"],Mf),n.registerHotkey(["Control","y"],Df),In({maxSteps:o})}const xf="COPY",Bf="PASTE",JV="CLEAR_CLIPBOARD";function ZV(s,n,i){const o=Symbol("ClipboardToken"),l=be(""),h=be(""),f=me(()=>!l.value),u=()=>{l.value="",h.value=""},p=()=>{const m=s.value.selectedNodes.flatMap(b=>[...Object.values(b.inputs),...Object.values(b.outputs)]),E=s.value.connections.filter(b=>m.includes(b.from)||m.includes(b.to)).map(b=>({from:b.from.id,to:b.to.id}));h.value=JSON.stringify(E),l.value=JSON.stringify(s.value.selectedNodes.map(b=>b.save()))},c=(m,E,b)=>{for(const T of m){let y;if((!b||b==="input")&&(y=Object.values(T.inputs).find(g=>g.id===E)),!y&&(!b||b==="output")&&(y=Object.values(T.outputs).find(g=>g.id===E)),y)return y}},_=()=>{if(f.value)return;const m=new Map,E=JSON.parse(l.value),b=JSON.parse(h.value),T=[],y=[],g=s.value;i.executeCommand(D0);for(const $ of E){const R=n.value.nodeTypes.get($.type);if(!R){console.warn(`Node type ${$.type} not registered`);return}const v=new R.type,S=v.id;T.push(v);const O=w=>{Object.values(w).forEach(A=>{A.hooks.load.subscribe(o,I=>{const L=sc();return m.set(I.id,L),A.id=L,A.hooks.load.unsubscribe(o),I})})};O(v.inputs),O(v.outputs),v.hooks.beforeLoad.subscribe(o,w=>{const A=w;return A.position&&(A.position.x+=10,A.position.y+=10),v.hooks.beforeLoad.unsubscribe(o),A}),g.addNode(v),v.load($),v.id=S,m.set($.id,S)}for(const $ of b){const R=c(T,m.get($.from),"output"),v=c(T,m.get($.to),"input");if(!R||!v)continue;const S=g.addConnection(R,v);S&&y.push(S)}return i.executeCommand(x0),{newNodes:T,newConnections:y}};return i.registerCommand(xf,{canExecute:()=>true,execute:p}),i.registerHotkey(["Control","c"],xf),i.registerCommand(Bf,{canExecute:()=>!f.value,execute:_}),i.registerHotkey(["Control","v"],Bf),i.registerCommand(JV,{canExecute:()=>true,execute:u}),In({isEmpty:f})}const QV="OPEN_SIDEBAR";function e3(s,n){n.registerCommand(QV,{execute:i=>{s.value.sidebar.nodeId=i,s.value.sidebar.visible=true},canExecute:()=>true})}function t3(s,n){e3(s,n)}const s3={},i3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},n3=le("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),r3=le("path",{d:"M9 13l-4 -4l4 -4m-4 4h11a4 4 0 0 1 0 8h-1"},null,-1),o3=[n3,r3];function a3(s,n){return ie(),Se("svg",i3,o3)}const l3=Kt(s3,[["render",a3]]),c3={},u3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},h3=le("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),d3=le("path",{d:"M15 13l4 -4l-4 -4m4 4h-11a4 4 0 0 0 0 8h1"},null,-1),_3=[h3,d3];function p3(s,n){return ie(),Se("svg",u3,_3)}const g3=Kt(c3,[["render",p3]]),f3={},m3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},E3=le("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),b3=le("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1),v3=le("line",{x1:"5",y1:"12",x2:"11",y2:"18"},null,-1),T3=le("line",{x1:"5",y1:"12",x2:"11",y2:"6"},null,-1),S3=[E3,b3,v3,T3];function $3(s,n){return ie(),Se("svg",m3,S3)}const y3=Kt(f3,[["render",$3]]),R3={},I3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},C3=le("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),O3=le("path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"},null,-1),w3=le("rect",{x:"9",y:"3",width:"6",height:"4",rx:"2"},null,-1),k3=[C3,O3,w3];function A3(s,n){return ie(),Se("svg",I3,k3)}const L3=Kt(R3,[["render",A3]]),N3={},M3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},D3=le("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),x3=le("rect",{x:"8",y:"8",width:"12",height:"12",rx:"2"},null,-1),B3=le("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"},null,-1),P3=[D3,x3,B3];function U3(s,n){return ie(),Se("svg",M3,P3)}const F3=Kt(N3,[["render",U3]]),G3={},H3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},V3=le("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),W3=le("path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"},null,-1),z3=le("circle",{cx:"12",cy:"14",r:"2"},null,-1),j3=le("polyline",{points:"14 4 14 8 8 8 8 4"},null,-1),X3=[V3,W3,z3,j3];function K3(s,n){return ie(),Se("svg",H3,X3)}const Y3=Kt(G3,[["render",K3]]),q3={},J3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Z3=_w('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 3h4v4h-4z"></path><path d="M3 17h4v4h-4z"></path><path d="M17 17h4v4h-4z"></path><path d="M7 17l5 -4l5 4"></path><line x1="12" y1="7" x2="12" y2="13"></line>',6),Q3=[Z3];function e4(s,n){return ie(),Se("svg",J3,Q3)}const t4=Kt(q3,[["render",e4]]),s4=et({props:{command:{type:String,required:true},title:{type:String,required:true},icon:{type:Object,required:false,default:void 0}},setup(){const{viewModel:s}=On();return{viewModel:s}}}),i4=["disabled","title"];function n4(s,n,i,o,l,h){return ie(),Se("button",{class:"baklava-toolbar-entry baklava-toolbar-button",disabled:!s.viewModel.commandHandler.canExecuteCommand(s.command),title:s.title,onClick:n[0]||(n[0]=f=>s.viewModel.commandHandler.executeCommand(s.command))},[s.icon?(ie(),Ye(ti(s.icon),{key:0})):(ie(),Se(xt,{key:1},[Dt(Pt(s.title),1)],64))],8,i4)}const r4=Kt(s4,[["render",n4]]),o4=et({components:{ToolbarButton:r4},setup(){const{viewModel:s}=On();return{isSubgraph:me(()=>s.value.displayedGraph!==s.value.editor.graph),commands:[{command:xf,title:"Copy",icon:F3},{command:Bf,title:"Paste",icon:L3},{command:Mf,title:"Undo",icon:l3},{command:Df,title:"Redo",icon:g3},{command:N0,title:"Create Subgraph",icon:t4}],subgraphCommands:[{command:rc,title:"Save Subgraph",icon:Y3},{command:M0,title:"Back to Main Graph",icon:y3}]}}}),a4={class:"baklava-toolbar"};function l4(s,n,i,o,l,h){const f=Ze("toolbar-button");return ie(),Se("div",a4,[(ie(true),Se(xt,null,ni(s.commands,u=>(ie(),Ye(f,{key:u.command,command:u.command,title:u.title,icon:u.icon},null,8,["command","title","icon"]))),128)),s.isSubgraph?(ie(true),Se(xt,{key:0},ni(s.subgraphCommands,u=>(ie(),Ye(f,{key:u.command,command:u.command,title:u.title,icon:u.icon},null,8,["command","title","icon"]))),128)):ot("",true)])}const c4=Kt(o4,[["render",l4]]),u4=et({components:{Background:GG,Node:VH,ConnectionWrapper:qH,TemporaryConnection:QH,Sidebar:nV,Minimap:aV,NodePalette:VV,Toolbar:c4},props:{viewModel:{type:Object,required:true}},setup(s){const n=Symbol("EditorToken"),i=tn(s,"viewModel");DG(i);const o=be(null);ac("editorEl",o);const l=me(()=>s.viewModel.displayedGraph.nodes),h=me(()=>s.viewModel.displayedGraph.connections),f=me(()=>s.viewModel.displayedGraph.selectedNodes),u=BG(),p=PG(),c=me(()=>({...u.styles.value})),_=be(0);s.viewModel.editor.hooks.load.subscribe(n,R=>(_.value++,R));const m=R=>{u.onPointerMove(R),p.onMouseMove(R)},E=R=>{R.button===0&&(R.target===o.value&&($(),u.onPointerDown(R)),p.onMouseDown())},b=R=>{u.onPointerUp(R),p.onMouseUp()},T=R=>{R.key==="Tab"&&R.preventDefault(),s.viewModel.commandHandler.handleKeyDown(R)},y=R=>{s.viewModel.commandHandler.handleKeyUp(R)},g=R=>{s.viewModel.commandHandler.pressedKeys.includes("Control")||$(),s.viewModel.displayedGraph.selectedNodes.push(R)},$=()=>{s.viewModel.displayedGraph.selectedNodes=[]};return{el:o,counter:_,nodes:l,connections:h,selectedNodes:f,nodeContainerStyle:c,onPointerMove:m,onPointerDown:E,onPointerUp:b,keyDown:T,keyUp:y,selectNode:g,temporaryConnection:p.temporaryConnection,mouseWheel:u.onMouseWheel,dragging:u.dragging}}}),h4={class:"connections-container"};function d4(s,n,i,o,l,h){const f=Ze("background"),u=Ze("toolbar"),p=Ze("node-palette"),c=Ze("connection-wrapper"),_=Ze("temporary-connection"),m=Ze("node"),E=Ze("sidebar"),b=Ze("minimap");return ie(),Se("div",{ref:"el",tabindex:"-1",class:tt(["baklava-editor",{"baklava-ignore-mouse":!!s.temporaryConnection||s.dragging,"--temporary-connection":!!s.temporaryConnection}]),onPointermove:n[0]||(n[0]=si((...T)=>s.onPointerMove&&s.onPointerMove(...T),["self"])),onPointerdown:n[1]||(n[1]=(...T)=>s.onPointerDown&&s.onPointerDown(...T)),onPointerup:n[2]||(n[2]=(...T)=>s.onPointerUp&&s.onPointerUp(...T)),onWheel:n[3]||(n[3]=si((...T)=>s.mouseWheel&&s.mouseWheel(...T),["self"])),onKeydown:n[4]||(n[4]=(...T)=>s.keyDown&&s.keyDown(...T)),onKeyup:n[5]||(n[5]=(...T)=>s.keyUp&&s.keyUp(...T))},[Qt(s.$slots,"background",{},()=>[De(f)]),Qt(s.$slots,"toolbar",{},()=>[De(u)]),Qt(s.$slots,"palette",{},()=>[De(p)]),(ie(),Se("svg",h4,[(ie(true),Se(xt,null,ni(s.connections,T=>(ie(),Se("g",{key:T.id+s.counter.toString()},[Qt(s.$slots,"connection",{connection:T},()=>[De(c,{connection:T},null,8,["connection"])])]))),128)),Qt(s.$slots,"temporaryConnection",{temporaryConnection:s.temporaryConnection},()=>[s.temporaryConnection?(ie(),Ye(_,{key:0,connection:s.temporaryConnection},null,8,["connection"])):ot("",true)])])),le("div",{class:"node-container",style:Qs(s.nodeContainerStyle)},[De(dw,{name:"fade"},{default:We(()=>[(ie(true),Se(xt,null,ni(s.nodes,T=>Qt(s.$slots,"node",{node:T,selected:s.selectedNodes.includes(T),onSelect:y=>s.selectNode(T)},()=>[(ie(),Ye(m,{key:T.id+s.counter.toString(),node:T,selected:s.selectedNodes.includes(T),onSelect:y=>s.selectNode(T)},null,8,["node","selected","onSelect"]))])),256))]),_:3})],4),Qt(s.$slots,"sidebar",{},()=>[De(E)]),Qt(s.$slots,"minimap",{},()=>[s.viewModel.settings.enableMinimap?(ie(),Ye(b,{key:0})):ot("",true)])],34)}const _4=Kt(u4,[["render",d4]]);function p4(s){const n=be([]),i=be([]);return{pressedKeys:n,handleKeyDown:f=>{n.value.includes(f.key)||n.value.push(f.key),i.value.forEach(u=>{u.keys.every(p=>n.value.includes(p))&&s(u.commandName)})},handleKeyUp:f=>{const u=n.value.indexOf(f.key);u>=0&&n.value.splice(u,1)},registerHotkey:(f,u)=>{i.value.push({keys:f,commandName:u})}}}const g4=()=>{const s=be(new Map),n=(h,f)=>{if(s.value.has(h))throw new Error(`Command "${h}" already exists`);s.value.set(h,f)},i=(h,f=false,...u)=>{if(!s.value.has(h)){if(f)throw new Error(`[CommandHandler] Command ${h} not registered`);return}return s.value.get(h).execute(...u)},o=(h,f=false,...u)=>{if(!s.value.has(h)){if(f)throw new Error(`[CommandHandler] Command ${h} not registered`);return false}return s.value.get(h).canExecute(u)},l=p4(i);return In({registerCommand:n,executeCommand:i,canExecuteCommand:o,...l})},f4=s=>!(s instanceof bh);function m4(s,n){return{switchGraph:o=>{let l;if(f4(o))l=new bh(s.value),o.createGraph(l),l.inputs.forEach(h=>{const f=new k0;f.inputs.name.value=h.name,f.graphInterfaceId=h.id,l.addNode(f);const u=l.findNodeInterface(h.nodeInterfaceId);if(!u){console.warn(`Could not find target interface ${h.nodeInterfaceId} for subgraph input node`);return}l.addConnection(f.outputs.placeholder,u)}),l.outputs.forEach(h=>{const f=new A0;f.inputs.name.value=h.name,f.graphInterfaceId=h.id,l.addNode(f);const u=l.findNodeInterface(h.nodeInterfaceId);if(!u){console.warn(`Could not find target interface ${h.nodeInterfaceId} for subgraph input node`);return}l.addConnection(u,f.inputs.placeholder)});else{if(o!==s.value.graph)throw new Error("Can only switch using 'Graph' instance when it is the root graph. Otherwise a 'GraphTemplate' must be used.");l=o}n.value&&n.value!==s.value.graph&&n.value.destroy(),l.panning=l.panning??o.panning??{x:0,y:0},l.scaling=l.scaling??o.scaling??1,l.selectedNodes=l.selectedNodes??[],l.sidebar=l.sidebar??{visible:false,nodeId:"",optionName:""},n.value=l}}}function E4(s){s.position=s.position??{x:0,y:0},s.disablePointerEvents=false,s.twoColumn=s.twoColumn??false,s.width=s.width??200}function b4(s){const n=be(s??new MG),i=Symbol("ViewModelToken"),o=be(null),l=uw(o),{switchGraph:h}=m4(n,o),f=me(()=>l.value&&l.value!==n.value.graph),u=In({useStraightConnections:false,enableMinimap:false,background:{gridSize:100,gridDivision:5,subGridVisibleThreshold:.6}}),p=g4(),c=qV(l,p),_=ZV(l,n,p),m={renderNode:new Bi(null),renderInterface:new Bi(null)};return KV(l,p,h),t3(l,p),Mt(n,(E,b)=>{b&&(b.events.registerGraph.unsubscribe(i),b.graphEvents.beforeAddNode.unsubscribe(i),E.nodeHooks.beforeLoad.unsubscribe(i),E.nodeHooks.afterSave.unsubscribe(i),E.graphTemplateHooks.beforeLoad.unsubscribe(i),E.graphTemplateHooks.afterSave.unsubscribe(i)),E&&(E.nodeHooks.beforeLoad.subscribe(i,(T,y)=>(y.position=T.position??{x:0,y:0},y.width=T.width??200,y.twoColumn=T.twoColumn??false,T)),E.nodeHooks.afterSave.subscribe(i,(T,y)=>(T.position=y.position,T.width=y.width,T.twoColumn=y.twoColumn,T)),E.graphTemplateHooks.beforeLoad.subscribe(i,(T,y)=>(y.panning=T.panning,y.scaling=T.scaling,T)),E.graphTemplateHooks.afterSave.subscribe(i,(T,y)=>(T.panning=y.panning,T.scaling=y.scaling,T)),E.graphEvents.beforeAddNode.subscribe(i,T=>E4(T)),n.value.registerNodeType(k0,{category:"Subgraphs"}),n.value.registerNodeType(A0,{category:"Subgraphs"}),h(E.graph))},{immediate:true}),In({editor:n,displayedGraph:l,isSubgraph:f,settings:u,commandHandler:p,history:c,clipboard:_,hooks:m,switchGraph:h})}function v4(s){let n;return pw({setup(){const i=b4();return n=i,{viewModel:i}},render(){return ju(_4,{viewModel:this.viewModel})}}).mount(s),n}const T4=Pi({type:"\u8F93\u5165",inputs:{name:()=>new Ws("\u5B57\u6BB5\u540D\u79F0","").setPort(false)},outputs:{output:()=>new yt("\u8F93\u5165\u503C",0)},calculate(){return{}}}),S4=Pi({type:"\u8F93\u51FA",inputs:{output:()=>new yt("\u8F93\u51FA\u503C",0)},calculate(){return{}}}),$4=[T4,S4].map(s=>[s,"\u8F93\u5165\u4E0E\u8F93\u51FA"]),y4=Pi({type:"\u83B7\u53D6\u5BF9\u8C61\u5C5E\u6027",inputs:{object:()=>new yt("\u5BF9\u8C61",0),property:()=>new Ws("\u5C5E\u6027","")},outputs:{value:()=>new yt("\u503C",0)},calculate(){return{}}}),R4=Pi({type:"\u8BBE\u7F6E\u5BF9\u8C61\u5C5E\u6027",inputs:{object:()=>new yt("\u5BF9\u8C61",0),property:()=>new Ws("\u5C5E\u6027",""),value:()=>new Ws("\u503C","")},outputs:{value:()=>new yt("\u6539\u53D8\u540E\u7684\u5BF9\u8C61",0)},calculate(s,n){return{}}}),I4=pm({type:"\u521B\u5EFA\u5BF9\u8C61",inputs:{prototype:()=>new Ws("\u539F\u578B\uFF0C\u7528\u9017\u53F7\u5206\u9694","").setPort(false)},outputs:{value:()=>new yt("\u5BF9\u8C61",0)},onUpdate(){var s;return{inputs:Object.fromEntries((s=this.inputs.prototype.value)==null?void 0:s.split(",").filter(n=>n).map(n=>[n,()=>new yt(n,0)]))}}}),C4=pm({type:"\u5206\u79BB\u5BF9\u8C61",inputs:{value:()=>new yt("\u5BF9\u8C61",0),prototype:()=>new Ws("\u539F\u578B\uFF0C\u7528\u9017\u53F7\u5206\u9694","").setPort(false)},onUpdate(){var s;return{outputs:Object.fromEntries((s=this.inputs.prototype.value)==null?void 0:s.split(",").filter(n=>n).map(n=>[n,()=>new yt(n,0)]))}}}),O4=[I4,C4,y4,R4].map(s=>[s,"\u5BF9\u8C61"]),w4=Pi({type:"\u4E8C\u5143\u903B\u8F91\u8FD0\u7B97",inputs:{left:()=>new yt("A",0),right:()=>new yt("B",0),operator:()=>new Em("\u8FD0\u7B97\u7B26","A\u5927\u4E8EB",["A\u5927\u4E8EB","A\u5C0F\u4E8EB","A\u7B49\u4E8EB","A\u4E0D\u7B49\u4E8EB","A\u5927\u4E8E\u7B49\u4E8EB","A\u5C0F\u4E8E\u7B49\u4E8EB"])},outputs:{value:()=>new yt("\u8F93\u51FA\u503C",0)}}),k4=Pi({type:"\u5355\u5143\u903B\u8F91\u8FD0\u7B97",inputs:{value:()=>new yt("\u503C",0),operator:()=>new Em("\u8FD0\u7B97\u7B26","!",["\u53D6\u53CD"])},outputs:{value:()=>new yt("\u8F93\u51FA\u503C",0)}}),A4=Pi({type:"\u4E09\u5143\u903B\u8F91\u8FD0\u7B97",inputs:{condition:()=>new yt("\u6761\u4EF6",0),trueValue:()=>new Ws("\u771F\u503C",""),falseValue:()=>new Ws("\u5047\u503C","")},outputs:{value:()=>new yt("\u8F93\u51FA\u503C",0)}}),L4=[w4,k4,A4].map(s=>[s,"\u903B\u8F91"]),N4=pm({type:"\u5B57\u7B26\u4E32\u6A21\u677F",inputs:{template:()=>new Ws("\u6A21\u677F","").setPort(false)},outputs:{value:()=>new yt("\u8F93\u51FA","")},onUpdate({template:s}){const n=s.match(/%.+?%/g);return{inputs:n?Object.fromEntries(n.map(i=>i.slice(1,-1)).map(i=>[i,()=>new Ws(i,"")])):void 0}}}),M4=[N4].map(s=>[s,"\u5B57\u7B26\u4E32"]),D4=Pi({type:"\u6570\u5B57\u5E38\u91CF/\u8F6C\u4E3A\u6570\u5B57",inputs:{value:()=>new Ws("\u8F93\u5165","0")},outputs:{value:()=>new yt("\u8F93\u51FA","0")}}),x4=[D4].map(s=>[s,"\u6570\u5B57"]),B4=Pi({type:"\u961F\u5217",inputs:{value:()=>new yt("\u8F93\u5165\u503C",0),length:()=>new Ws("\u957F\u5EA6","10").setPort(false)},outputs:{value:()=>new yt("\u961F\u5217\u8F93\u51FA",0),overflow:()=>new yt("\u6EA2\u51FA",0)}}),P4=[B4].map(s=>[s,"\u6570\u636E\u7ED3\u6784"]),U4=Pi({type:"HTTP",inputs:{url:()=>new Ws("URL",""),method:()=>new Em("\u65B9\u6CD5","GET",["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS"]).setPort(false),headers:()=>new yt("\u5934\u90E8",0),body:()=>new yt("\u4E3B\u4F53",0)},outputs:{code:()=>new yt("\u72B6\u6001\u7801",0),body:()=>new yt("\u8FD4\u56DE\u4F53",0),headers:()=>new yt("\u8FD4\u56DE\u5934\u90E8",0)}}),F4=[U4].map(s=>[s,"\u63A5\u53E3"]),G4=[...$4,...O4,...L4,...M4,...x4,...P4,...F4],H4=s=>(Pf("data-v-640d55fc"),s=s(),Uf(),s),V4={style:{height:"100%",width:"100%"}},W4=H4(()=>le("div",{style:{width:"100%",padding:"5px","padding-left":"20px",height:"25px"}},[le("button",{class:"menu-button"},"\u9000\u51FA\u7F16\u8F91\u6A21\u5F0F")],-1)),z4={style:{width:"100%",height:"100%"}},j4=et({__name:"data-flow",setup(s){const n=be(null);return xs(()=>{const i=v4(ge(n));console.info(i),G4.forEach(o=>i.editor.registerNodeType(o[0],{category:o[1]}))}),(i,o)=>(ie(),Se("div",V4,[W4,le("div",z4,[le("div",{style:{height:"100%"},ref_key:"baklava_workspace",ref:n},null,512)])]))}});const X4=Jn(j4,[["__scopeId","data-v-640d55fc"]]),B0=s=>(Pf("data-v-f698a1aa"),s=s(),Uf(),s),K4={style:{display:"flex","flex-flow":"column nowrap",height:"100%",width:"100%"}},Y4={style:{height:"100%",display:"flex","flex-flow":"column"}},q4=B0(()=>le("div",null,"\u5728\u5DE6\u4FA7\u9009\u62E9\u6216\u521B\u5EFA\u4E00\u4E2ABlockly\u4EE3\u7801",-1)),J4={style:{height:"100%"}},Z4={style:{position:"fixed",bottom:"0",top:"0",right:"0",width:"400px","background-color":"#ffffff7a","z-index":"1000","backdrop-filter":"blur(50px)","box-shadow":"9px -7px 20px 0px black","background-size":"50px"}},Q4=B0(()=>le("div",null,"Loading...",-1)),e5={style:{height:"25px",background:"var(--bg1)",display:"flex",width:"100%","z-index":"999"}},t5={style:{"margin-left":"auto","align-self":"center",height:"100%","margin-right":"20px"}},s5=et({__name:"index",setup(s){const n=be({import:false,export:false}),i=be(null),o=be(void 0),l=be(false),h=be(false),f=be(false),u=be("blockly"),p=be({}),c=be(null),_=be("hidden");let m=be({build:'\u70B9\u51FB\u5DE6\u4FA7"\u7F16\u8BD1\u63D2\u4EF6"\u67E5\u770B'}),E=null;async function b(){await r0(o.value,i.value)}function T(){E&&clearTimeout(E),E=setTimeout(()=>{b(),E=null},1e3)}xs(()=>{Mt(o,async(g,$)=>{if(!g)return;l.value=true;const R=await Rn("load-blockly-block",parseInt(g.toString()));l.value=false,await ps(()=>{i.value.load(R)}),m.value.build='\u70B9\u51FB\u5DE6\u4FA7"\u7F16\u8BD1\u63D2\u4EF6"\u67E5\u770B'}),Mt(_,async(g,$)=>{if(![g,$].includes("hidden"))return;const R=setInterval(()=>{console.info("resize"),i.value.updateSize()},10);setTimeout(()=>{clearInterval(R)},1e3)}),ps(()=>{i.value.setAutoSaveListener(T)})});async function y(g,$){const R=await xB(g,$);R&&(o.value=R)}return(g,$)=>{const R=Ze("k-empty"),v=Ze("k-layout");return ie(),Se(xt,null,[De(bw,{modelValue:n.value.import,"onUpdate:modelValue":$[0]||($[0]=S=>n.value.import=S),onCallback:y},null,8,["modelValue"]),De(vw,{modelValue:n.value.export,"onUpdate:modelValue":$[1]||($[1]=S=>n.value.export=S)},null,8,["modelValue"]),De(v,{class:"page-blockly"},{header:We(()=>{var S,O;return[Dt(" Blockly - "+Pt(((O=(S=ge(Yn).blockly.filter(w=>{var A,I;return((A=w.id)==null?void 0:A.toString())===((I=o.value)==null?void 0:I.toString())}))==null?void 0:S[0])==null?void 0:O.name)??"\u4E3B\u9875")+" "+Pt(f.value?"\u4FDD\u5B58\u4E2D...":""),1)]}),left:We(()=>[De(XB,{blocks:ge(Yn).blockly,current:o.value,"onUpdate:current":$[2]||($[2]=S=>o.value=S),workspace:i.value,panel:ge(m),dialog:n.value,logger:c.value},null,8,["blocks","current","workspace","panel","dialog","logger"])]),default:We(()=>[le("div",K4,[le("div",Y4,[o.value===void 0&&!h.value?(ie(),Ye(R,{key:0},{default:We(()=>[q4]),_:1})):ot("",true),Hs((ie(),Ye(gw,null,[De(SF,{ref_key:"editor",ref:i,flow:p.value,"onUpdate:flow":$[3]||($[3]=S=>p.value=S),workspace:u.value,"onUpdate:workspace":$[4]||($[4]=S=>u.value=S)},null,8,["flow","workspace"])],1536)),[[$i,(u.value==="blockly"||u.value==="meta")&&o.value!=null&&!l.value||h.value]]),Hs(le("div",J4,[De(X4,{flow:p.value,"onUpdate:flow":$[5]||($[5]=S=>p.value=S),workspace:u.value,"onUpdate:workspace":$[6]||($[6]=S=>u.value=S)},null,8,["flow","workspace"])],512),[[$i,u.value==="data-flow"&&o.value!=null&&!l.value||h.value]]),De(lc,{name:"meta-ui-change"},{default:We(()=>[Hs(le("div",Z4,[De(hP,{workspace:u.value,"onUpdate:workspace":$[7]||($[7]=S=>u.value=S),current:o.value,onMetaChange:$[8]||($[8]=S=>T())},null,8,["workspace","current"])],512),[[$i,u.value==="meta"&&o.value!=null&&!l.value||h.value]])]),_:1}),Hs(le("div",null,[o.value===void 0&&!h.value?(ie(),Ye(R,{key:0},{default:We(()=>[Q4]),_:1})):ot("",true)],512),[[$i,l.value&&!h.value]])]),o.value!=null?(ie(),Se("div",{key:0,class:"transition-animation",style:Qs([{"border-top":"3px solid var(--bg1)",display:"flex","flex-flow":"column nowrap"},{height:_.value.toString()==="hidden"?"25px":"40%"}])},[le("div",e5,[le("div",{style:Qs([{height:"100%",display:"inline-flex","align-self":"center","padding-left":"20px","padding-right":"20px","border-radius":"4px 4px 0px 0px",cursor:"pointer"},{background:_.value=="build"?"var(--bg3)":""}]),onClick:$[9]||($[9]=S=>_.value="build")},"\u7F16\u8BD1",4),le("div",{style:Qs([{height:"100%",display:"inline-flex","align-self":"center","padding-left":"20px","padding-right":"20px","border-radius":"4px 4px 0px 0px",cursor:"pointer"},{background:_.value=="result"?"var(--bg3)":""}]),onClick:$[10]||($[10]=S=>_.value="result")},"\u4EE3\u7801\u7ED3\u679C",4),le("div",{style:Qs([{height:"100%",display:"inline-flex","align-self":"center","padding-left":"20px","padding-right":"20px","border-radius":"4px 4px 0px 0px",cursor:"pointer"},{background:_.value=="log"?"var(--bg3)":""}]),onClick:$[11]||($[11]=S=>_.value="log")},"\u8FD0\u884C\u65E5\u5FD7",4),le("div",t5,[le("div",{style:{height:"18px",width:"18px",background:"var(--bg1)",padding:"2px",margin:"2px"},onClick:$[12]||($[12]=S=>_.value="hidden")},[De(yG)])])]),Hs(le("div",{style:Qs([{overflow:"scroll",color:"var(--fg2)",height:"100%",width:"100%",contain:"size"},{background:_.value==="build"?"black":"var(--bg2)"}]),class:"scroll"},[Hs(De(RF,{current:o.value,ref_key:"build_console",ref:c,style:{margin:"6px"}},null,8,["current"]),[[$i,_.value==="build"]]),_.value!="hidden"?Hs((ie(),Ye(EG,{key:0,current:o.value,blocklyInformation:ge(m)},null,8,["current","blocklyInformation"])),[[$i,_.value==="result"]]):ot("",true)],4),[[$i,_.value!="hidden"]])],4)):ot("",true)])]),_:1})],64)}}});const i5=Jn(s5,[["__scopeId","data-v-f698a1aa"]]),n5={},r5={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},o5=le("path",{fill:"currentColor",d:"M411.8 207.8C406.2 217.8 395.5 223.1 384 223.1H192C180.5 223.1 169.8 217.8 164.2 207.8C158.5 197.7 158.6 185.4 164.6 175.5L260.6 15.54C266.3 5.897 276.8 0 288 0C299.2 0 309.7 5.898 315.4 15.54L411.4 175.5C417.4 185.4 417.5 197.7 411.8 207.8V207.8zM288 31.1L192 191.1H384L288 31.1zM472 271.1C494.1 271.1 512 289.9 512 311.1V456C512 478.1 494.1 496 472 496H328C305.9 496 288 478.1 288 456V311.1C288 289.9 305.9 271.1 328 271.1H472zM472 303.1H328C323.6 303.1 320 307.6 320 311.1V456C320 460.4 323.6 464 328 464H472C476.4 464 480 460.4 480 456V311.1C480 307.6 476.4 303.1 472 303.1zM256 384C256 454.7 198.7 512 128 512C57.31 512 0 454.7 0 384C0 313.3 57.31 255.1 128 255.1C198.7 255.1 256 313.3 256 384zM128 287.1C74.98 287.1 32 330.1 32 384C32 437 74.98 480 128 480C181 480 224 437 224 384C224 330.1 181 287.1 128 287.1z"},null,-1),a5=[o5];function l5(s,n){return ie(),Se("svg",r5,a5)}const c5=Jn(n5,[["render",l5]]);tw.register("blockly",c5);const y5=s=>{s.page({name:"Blockly \u53EF\u89C6\u5316\u7F16\u7A0B",path:"/blockly",icon:"blockly",authority:5,component:i5,fields:["blockly"]})};export{y5 as default};
