var y=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var K=Object.prototype.hasOwnProperty;var E=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var P=(e,r)=>()=>(e&&(r=e(e=0)),r);var d=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var w=(e,r,t,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of J(r))!K.call(e,n)&&n!==t&&y(e,n,{get:()=>r[n],enumerable:!(a=I(r,n))||a.enumerable});return e},h=(e,r,t)=>(w(e,r,"default"),t&&w(t,r,"default"));var L=e=>w(y({},"__esModule",{value:!0}),e);import{Buffer as _}from"https://registry.koishi.chat/modules/buffer/index.js";import f from"https://registry.koishi.chat/modules/process/index.js";var p=P(()=>{});var g={};import*as ye from"https://registry.koishi.chat/modules/koishi/index.js";var R=P(()=>{p();h(g,ye)});var M=d((Ee,q)=>{p();var U=/\/\*[^]*?\*\//g,X=/(\bdefault\s+)?\b(let|const|class|function(?:\s*\*)?)(\s+)(\*?\s*[$\w][$\w\s\d,.=]+)([^]*?)$/i,Y=/(^|\s+)export(?!\w)\s*(\{[^{}]*?\}.*?(?=;\n?|$)|[^]*?(?=[\n;]|$))/gi,O=/\bfrom\s+(["'])([^"']*)\1/gi,S=/\bdefault(\s+as\s+(\w+))?\b/i,v=/\b(\w+)\s+as\s+(\w+)\b/gi;function j(e){return typeof e=="string"?j(e.replace(/{|}/g,"").split(/\s*,\s*/).map(r=>r.trim())):e.reduce((r,t)=>r.concat(t.split(/\s*,\s*/).map(a=>a.trim())),[])}function G(e){return e.replace(/[{\s}]+/g,"").split(",").reduce((r,t)=>Object.assign(r,{[t.split(":")[0]]:t.split(":")[1]}),{})}function Q(e,r,t,a){return e=e||"module.exports",r=r||"require",t=t||"Object.assign",(n,c,i)=>{let s=`${c}${e}`;i=i.replace(U,o=>o.replace(/\S/g," "));let l=i.match(X);if(l){if(l[2]==="let"||l[2]==="const"){let o=l[4].split("=").filter(Boolean),u="";return o.length!==1&&(u=o[o.length-1],o=o.slice(0,o.length-1)),!l[4].includes("=")&&l[4].includes(",")?`${c}${i};${l[2]==="let"&&a?a("let",j(o),null,e,r,t):`${t}(${e},{${o.join(",")}})`}`:(o[0].includes(",")&&(o=o[0].split(",")),`${c}${l[2]}${l[3]}${o.map($=>`${$}=${e}.${$.trim()}`).join(`=void 0;${l[2]} `)}=${u}${l[5]}`)}(l[2]==="class"||l[2].includes("function"))&&(s=s.replace(c,`${c}const ${l[4].split(/[({\s]+/)[0].replace("*","")}=`)),l[1]||(s+=`.${l[4].split(/[({\s]+/)[0].replace("*","")}`)}let m=i.match(S);if(i.match(O)){let o=i.replace(v,"$2").replace(O,"").replace(/\s+/g,""),u;i=i.replace(O,(ve,be,H)=>`=${r}("${u=H}")`),i=i.replace(v,"$1:$2");let $=i.split("=").pop().trim();return o==="*"?`${s}=${a?a("*",$,u,e,r,t):$}`:m?(m[2]&&(s+=`.${m[2]}`),`${s}=${a?a("default",$,u,e,r,t):$}`):`${c}const ${i};${a?a("const",j(o),u,e,r,t):`${t}(${e},${o})`}`}return m?l||!i.match(v)?i=i.replace(S,"").trim():i=i.match(v)[0].split(" ").shift():i=i.replace(v,"$2:$1"),!m&&i.charAt()==="{"?i.includes("}")?`${c}${a?a("object",G(i),null,e,r,t):`${t}(${e},${i.replace(/\s+/g,"")})`}`:`${c}${e}=${i}`:`${s}=${i}`}}q.exports=(e,r,t,a,n)=>e.replace(Y,Q(r,t,a,n))});var D=d(F=>{p();function C(e,r){for(var t=[];e.length;)t.push(e.shift().trim().replace(/ as /g,":"));return"const { "+t.join(", ")+" } = "+r}function Z(e,r,t){return e.length&&!t?C(e,r):"const "+t+" = "+r+(e.length?`;
`+C(e,t):"")}function x(e,r){return r=r||"require",e.replace(/(^|;\s*|\r?\n+)import\s*((?:\*\s*as)?\s*([a-z$_][\w$]*)?\s*,?\s*(?:{([\s\S]*?)})?)?\s*(from)?\s*(['"`][^'"`]+['"`])(?=;?)(?=([^"'`]*["'`][^"'`]*["'`])*[^"'`]*$)/gi,function(t,a,n,c,i,s,l){return l=r+"("+l+")",(a||"")+(s?Z(i?i.split(","):[],l,c):l)})}F.rewrite=x});import k from"https://registry.koishi.chat/modules/util/index.js";var A=d((Me,N)=>{p();N.exports=k});var fe=d((Fe,z)=>{p();var ee=Object.create,b=Object.defineProperty,re=Object.getOwnPropertyDescriptor,te=Object.getOwnPropertyNames,ie=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty,le=(e,r)=>b(e,"name",{value:r,configurable:!0}),ne=(e,r)=>{for(var t in r)b(e,t,{get:r[t],enumerable:!0})},T=(e,r,t,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of te(r))!ae.call(e,n)&&n!==t&&b(e,n,{get:()=>r[n],enumerable:!(a=re(r,n))||a.enumerable});return e},oe=(e,r,t)=>(t=e!=null?ee(ie(e)):{},T(r||!e||!e.__esModule?b(t,"default",{value:e,enumerable:!0}):t,e)),pe=e=>T(b({},"__esModule",{value:!0}),e),V={};ne(V,{Config:()=>_e,apply:()=>W,inject:()=>ge,name:()=>$e,reusable:()=>me});z.exports=pe(V);var B=(R(),L(g)),ce=oe(M()),se=D(),ue=A(),$e="miniplug",ge={optional:["notifier"]},me=!0,_e=B.Schema.object({code:B.Schema.string().role("codemirror",{lang:"javascript"}).default(`
export const name = "greet"

export function apply(ctx) {
  ctx.logger.info("Hello, World!")
}
      `.trim())});function W(e,r){let t={module:{exports:{}},require:E};try{new Function("{ "+Object.keys(t).join(", ")+" }",(0,ce.default)((0,se.rewrite)(r.code))).call({},t);let n=t.module.exports;e.registry.resolve(n?.default)?e.plugin(n.default):e.plugin(n)}catch(a){e.logger.error(a),e.notifier?.create({type:"danger",content:a instanceof Error?String(a):"Uncaught "+(0,ue.inspect)(a,{breakLength:1/0})})}}le(W,"apply")});export default fe();
