var sk=Object.defineProperty;var ik=(s,n,i)=>n in s?sk(s,n,{enumerable:true,configurable:true,writable:true,value:i}):s[n]=i;var to=(s,n,i)=>(ik(s,typeof n!="symbol"?n+"":n,i),i);import{send as wn,store as Jn,icons as nk}from"@koishijs/client";import{defineComponent as Xe,ref as Ee,watch as Ct,resolveComponent as ht,openBlock as oe,createBlock as Je,withCtx as je,createElementVNode as he,createVNode as Me,createTextVNode as xt,computed as _e,createElementBlock as be,normalizeClass as tt,renderSlot as Mt,toDisplayString as Bt,Fragment as Pt,renderList as di,mergeProps as ca,createCommentVNode as qe,warn as rk,getCurrentInstance as Qn,unref as ue,onMounted as Ws,watchEffect as ok,onBeforeUnmount as kr,inject as Vs,isRef as Hl,onScopeDispose as $y,shallowRef as Gu,nextTick as rs,provide as rc,toRef as cn,onUnmounted as ak,useAttrs as lk,useSlots as yy,resolveDynamicComponent as ui,withModifiers as Is,normalizeStyle as Js,Text as ck,reactive as Vi,h as Yu,markRaw as qu,toRefs as Ry,Transition as oc,withDirectives as ci,withKeys as io,vShow as Fi,isVNode as Iy,render as Cy,toRaw as cf,TransitionGroup as uk,shallowReadonly as hk,getCurrentScope as dk,onUpdated as Oy,vModelText as ky,customRef as _k,createStaticVNode as Uf,createApp as pk,KeepAlive as gk}from"vue";import{isClient as er,useEventListener as J_,useResizeObserver as fk}from"@vueuse/core";function mk(s,n){for(var i=0;i<n.length;i++){const o=n[i];if(typeof o!="string"&&!Array.isArray(o)){for(const l in o)if(l!=="default"&&!(l in s)){const g=Object.getOwnPropertyDescriptor(o,l);g&&Object.defineProperty(s,l,g.get?g:{enumerable:true,get:()=>o[l]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}const Ek={class:"dialog-footer"},vk=Xe({__name:"import",props:["modelValue"],emits:["update:modelValue","callback"],setup(s,{emit:n}){const i=Ee(""),o=s,l=n,g=Ee(false),m=Ee(false);function u(){l("update:modelValue",false),l("callback",i.value,m.value),i.value="",m.value=false}return Ct(o,p=>{g.value=o.modelValue}),Ct(g,p=>{l("update:modelValue",p)}),(p,c)=>{const d=ht("el-input"),_=ht("el-checkbox"),b=ht("el-button"),$=ht("el-dialog");return oe(),Je($,{modelValue:g.value,"onUpdate:modelValue":c[4]||(c[4]=E=>g.value=E),title:"导入插件",width:"700px"},{footer:je(()=>[he("span",Ek,[Me(b,{onClick:c[2]||(c[2]=E=>l("update:modelValue"))},{default:je(()=>c[5]||(c[5]=[xt("关闭")])),_:1}),Me(b,{type:"primary",onClick:c[3]||(c[3]=E=>u())},{default:je(()=>c[6]||(c[6]=[xt(" 导入 ")])),_:1})])]),default:je(()=>[Me(d,{type:"textarea",rows:"10","input-style":"height: 200px;resize:none;",modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=E=>i.value=E)},null,8,["modelValue"]),Me(_,{label:"作为全新插件导入",modelValue:m.value,"onUpdate:modelValue":c[1]||(c[1]=E=>m.value=E)},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),bk=Xe({__name:"export",props:["modelValue"],emits:["update:modelValue"],setup(s,{emit:n}){const i=Ee(false);Ct(s,g=>{i.value=g.modelValue});const l=_e(()=>i.value??"");return(g,m)=>{const u=ht("el-input"),p=ht("el-dialog");return oe(),Je(p,{modelValue:i.value,"onUpdate:modelValue":m[1]||(m[1]=c=>i.value=c),title:"导出插件",width:"700px"},{default:je(()=>[Me(u,{type:"textarea",rows:"10","input-style":"height: 200px;resize:none;",modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=c=>l.value=c),readonly:""},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),Tk=Xe({__name:"blockly-tab-item",props:{label:{},value:{},modelValue:{}},emits:["update:modelValue"],setup(s){return(n,i)=>(oe(),be("div",{class:tt(["k-tab-item k-menu-item",{active:n.value===n.modelValue}]),onClick:i[0]||(i[0]=o=>n.$emit("update:modelValue",n.value))},[Mt(n.$slots,"default",{},()=>[xt(Bt(n.label.name)+" ",1),he("span",{class:tt({dot:true,enabled:n.label.enabled,edited:n.label.edited})},null,2)],true)],2))}});const sr=(s,n)=>{const i=s.__vccOpts||s;for(const[o,l]of n)i[o]=l;return i},Sk=sr(Tk,[["__scopeId","data-v-6575bcb5"]]),$k=Xe({__name:"blockly-tab-group",props:{data:{},modelValue:{},filter:{type:Function}},emits:["update:modelValue"],setup(s,{emit:n}){const i=s;console.info(i.data);const o=n,l=_e({get:()=>i.modelValue,set:g=>o("update:modelValue",g)});return(g,m)=>(oe(true),be(Pt,null,di(g.data,(u,p)=>(oe(),be(Pt,{key:p},[!g.filter||g.filter(p)?(oe(),Je(Sk,{key:0,modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=c=>l.value=c),label:u,value:p},{default:je(()=>[Mt(g.$slots,"default",ca({ref_for:true},{id:u}))]),_:2},1032,["modelValue","label","value"])):qe("v-if",true)],64))),128))}});const yk='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',Rk=s=>getComputedStyle(s).position==="fixed"?false:s.offsetParent!==null,sT=s=>Array.from(s.querySelectorAll(yk)).filter(n=>Ik(n)&&Rk(n)),Ik=s=>{if(s.tabIndex>0||s.tabIndex===0&&s.getAttribute("tabIndex")!==null)return true;if(s.disabled)return false;switch(s.nodeName){case"A":return!!s.href&&s.rel!=="ignore";case"INPUT":return!(s.type==="hidden"||s.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return true;default:return false}},Ck=()=>er&&/firefox/i.test(window.navigator.userAgent);/**
* @vue/shared v3.5.6
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Bl=()=>{},Ok=Object.prototype.hasOwnProperty,Ju=(s,n)=>Ok.call(s,n),Vl=s=>typeof s=="function",Sr=s=>typeof s=="string",Wl=s=>s!==null&&typeof s=="object",kk=s=>{const n=Object.create(null);return i=>n[i]||(n[i]=s(i))},wk=/-(\w)/g,Ak=kk(s=>s.replace(wk,(n,i)=>i?i.toUpperCase():""));var Lk=typeof global=="object"&&global&&global.Object===Object&&global;const Nk=Lk;var Mk=typeof self=="object"&&self&&self.Object===Object&&self,Dk=Nk||Mk||Function("return this")();const Ff=Dk;var xk=Ff.Symbol;const Cr=xk;var wy=Object.prototype,Bk=wy.hasOwnProperty,Pk=wy.toString,wl=Cr?Cr.toStringTag:void 0;function Uk(s){var n=Bk.call(s,wl),i=s[wl];try{s[wl]=void 0;var o=true}catch{}var l=Pk.call(s);return o&&(n?s[wl]=i:delete s[wl]),l}var Fk=Object.prototype,Gk=Fk.toString;function Hk(s){return Gk.call(s)}var Vk="[object Null]",Wk="[object Undefined]",iT=Cr?Cr.toStringTag:void 0;function Gf(s){return s==null?s===void 0?Wk:Vk:iT&&iT in Object(s)?Uk(s):Hk(s)}function Hf(s){return s!=null&&typeof s=="object"}var zk="[object Symbol]";function Vf(s){return typeof s=="symbol"||Hf(s)&&Gf(s)==zk}function jk(s,n){for(var i=-1,o=s==null?0:s.length,l=Array(o);++i<o;)l[i]=n(s[i],i,s);return l}var Xk=Array.isArray;const ac=Xk;var Kk=1/0,nT=Cr?Cr.prototype:void 0,rT=nT?nT.toString:void 0;function Ay(s){if(typeof s=="string")return s;if(ac(s))return jk(s,Ay)+"";if(Vf(s))return rT?rT.call(s):"";var n=s+"";return n=="0"&&1/s==-Kk?"-0":n}function Zu(s){var n=typeof s;return s!=null&&(n=="object"||n=="function")}function Yk(s){return s}var qk="[object AsyncFunction]",Jk="[object Function]",Zk="[object GeneratorFunction]",Qk="[object Proxy]";function ew(s){if(!Zu(s))return false;var n=Gf(s);return n==Jk||n==Zk||n==qk||n==Qk}var tw=Ff["__core-js_shared__"];const Z_=tw;var oT=function(){var s=/[^.]+$/.exec(Z_&&Z_.keys&&Z_.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function sw(s){return!!oT&&oT in s}var iw=Function.prototype,nw=iw.toString;function rw(s){if(s!=null){try{return nw.call(s)}catch{}try{return s+""}catch{}}return""}var ow=/[\\^$.*+?()[\]{}|]/g,aw=/^\[object .+?Constructor\]$/,lw=Function.prototype,cw=Object.prototype,uw=lw.toString,hw=cw.hasOwnProperty,dw=RegExp("^"+uw.call(hw).replace(ow,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _w(s){if(!Zu(s)||sw(s))return false;var n=ew(s)?dw:aw;return n.test(rw(s))}function pw(s,n){return s==null?void 0:s[n]}function Wf(s,n){var i=pw(s,n);return _w(i)?i:void 0}function gw(s,n,i){switch(i.length){case 0:return s.call(n);case 1:return s.call(n,i[0]);case 2:return s.call(n,i[0],i[1]);case 3:return s.call(n,i[0],i[1],i[2])}return s.apply(n,i)}var fw=800,mw=16,Ew=Date.now;function vw(s){var n=0,i=0;return function(){var o=Ew(),l=mw-(o-i);if(i=o,l>0){if(++n>=fw)return arguments[0]}else n=0;return s.apply(void 0,arguments)}}function bw(s){return function(){return s}}var Tw=function(){try{var s=Wf(Object,"defineProperty");return s({},"",{}),s}catch{}}();const Qu=Tw;var Sw=Qu?function(s,n){return Qu(s,"toString",{configurable:true,enumerable:false,value:bw(n),writable:true})}:Yk;const $w=Sw;var yw=vw($w);const Rw=yw;var Iw=9007199254740991,Cw=/^(?:0|[1-9]\d*)$/;function Ly(s,n){var i=typeof s;return n=n??Iw,!!n&&(i=="number"||i!="symbol"&&Cw.test(s))&&s>-1&&s%1==0&&s<n}function Ow(s,n,i){n=="__proto__"&&Qu?Qu(s,n,{configurable:true,enumerable:true,value:i,writable:true}):s[n]=i}function Ny(s,n){return s===n||s!==s&&n!==n}var kw=Object.prototype,ww=kw.hasOwnProperty;function Aw(s,n,i){var o=s[n];(!(ww.call(s,n)&&Ny(o,i))||i===void 0&&!(n in s))&&Ow(s,n,i)}var aT=Math.max;function Lw(s,n,i){return n=aT(n===void 0?s.length-1:n,0),function(){for(var o=arguments,l=-1,g=aT(o.length-n,0),m=Array(g);++l<g;)m[l]=o[n+l];l=-1;for(var u=Array(n+1);++l<n;)u[l]=o[l];return u[n]=i(m),gw(s,this,u)}}var Nw=9007199254740991;function Mw(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=Nw}var Dw="[object Arguments]";function lT(s){return Hf(s)&&Gf(s)==Dw}var My=Object.prototype,xw=My.hasOwnProperty,Bw=My.propertyIsEnumerable,Pw=lT(function(){return arguments}())?lT:function(s){return Hf(s)&&xw.call(s,"callee")&&!Bw.call(s,"callee")};const Dy=Pw;var Uw=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fw=/^\w*$/;function Gw(s,n){if(ac(s))return false;var i=typeof s;return i=="number"||i=="symbol"||i=="boolean"||s==null||Vf(s)?true:Fw.test(s)||!Uw.test(s)||n!=null&&s in Object(n)}var Hw=Wf(Object,"create");const zl=Hw;function Vw(){this.__data__=zl?zl(null):{},this.size=0}function Ww(s){var n=this.has(s)&&delete this.__data__[s];return this.size-=n?1:0,n}var zw="__lodash_hash_undefined__",jw=Object.prototype,Xw=jw.hasOwnProperty;function Kw(s){var n=this.__data__;if(zl){var i=n[s];return i===zw?void 0:i}return Xw.call(n,s)?n[s]:void 0}var Yw=Object.prototype,qw=Yw.hasOwnProperty;function Jw(s){var n=this.__data__;return zl?n[s]!==void 0:qw.call(n,s)}var Zw="__lodash_hash_undefined__";function Qw(s,n){var i=this.__data__;return this.size+=this.has(s)?0:1,i[s]=zl&&n===void 0?Zw:n,this}function uo(s){var n=-1,i=s==null?0:s.length;for(this.clear();++n<i;){var o=s[n];this.set(o[0],o[1])}}uo.prototype.clear=Vw;uo.prototype.delete=Ww;uo.prototype.get=Kw;uo.prototype.has=Jw;uo.prototype.set=Qw;function eA(){this.__data__=[],this.size=0}function hh(s,n){for(var i=s.length;i--;)if(Ny(s[i][0],n))return i;return-1}var tA=Array.prototype,sA=tA.splice;function iA(s){var n=this.__data__,i=hh(n,s);if(i<0)return false;var o=n.length-1;return i==o?n.pop():sA.call(n,i,1),--this.size,true}function nA(s){var n=this.__data__,i=hh(n,s);return i<0?void 0:n[i][1]}function rA(s){return hh(this.__data__,s)>-1}function oA(s,n){var i=this.__data__,o=hh(i,s);return o<0?(++this.size,i.push([s,n])):i[o][1]=n,this}function ba(s){var n=-1,i=s==null?0:s.length;for(this.clear();++n<i;){var o=s[n];this.set(o[0],o[1])}}ba.prototype.clear=eA;ba.prototype.delete=iA;ba.prototype.get=nA;ba.prototype.has=rA;ba.prototype.set=oA;var aA=Wf(Ff,"Map");const lA=aA;function cA(){this.size=0,this.__data__={hash:new uo,map:new(lA||ba),string:new uo}}function uA(s){var n=typeof s;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?s!=="__proto__":s===null}function dh(s,n){var i=s.__data__;return uA(n)?i[typeof n=="string"?"string":"hash"]:i.map}function hA(s){var n=dh(this,s).delete(s);return this.size-=n?1:0,n}function dA(s){return dh(this,s).get(s)}function _A(s){return dh(this,s).has(s)}function pA(s,n){var i=dh(this,s),o=i.size;return i.set(s,n),this.size+=i.size==o?0:1,this}function fo(s){var n=-1,i=s==null?0:s.length;for(this.clear();++n<i;){var o=s[n];this.set(o[0],o[1])}}fo.prototype.clear=cA;fo.prototype.delete=hA;fo.prototype.get=dA;fo.prototype.has=_A;fo.prototype.set=pA;var gA="Expected a function";function zf(s,n){if(typeof s!="function"||n!=null&&typeof n!="function")throw new TypeError(gA);var i=function(){var o=arguments,l=n?n.apply(this,o):o[0],g=i.cache;if(g.has(l))return g.get(l);var m=s.apply(this,o);return i.cache=g.set(l,m)||g,m};return i.cache=new(zf.Cache||fo),i}zf.Cache=fo;var fA=500;function mA(s){var n=zf(s,function(o){return i.size===fA&&i.clear(),o}),i=n.cache;return n}var EA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vA=/\\(\\)?/g,bA=mA(function(s){var n=[];return s.charCodeAt(0)===46&&n.push(""),s.replace(EA,function(i,o,l,g){n.push(l?g.replace(vA,"$1"):o||i)}),n});const TA=bA;function SA(s){return s==null?"":Ay(s)}function _h(s,n){return ac(s)?s:Gw(s,n)?[s]:TA(SA(s))}var $A=1/0;function jf(s){if(typeof s=="string"||Vf(s))return s;var n=s+"";return n=="0"&&1/s==-$A?"-0":n}function xy(s,n){n=_h(n,s);for(var i=0,o=n.length;s!=null&&i<o;)s=s[jf(n[i++])];return i&&i==o?s:void 0}function yA(s,n,i){var o=s==null?void 0:xy(s,n);return o===void 0?i:o}function RA(s,n){for(var i=-1,o=n.length,l=s.length;++i<o;)s[l+i]=n[i];return s}var cT=Cr?Cr.isConcatSpreadable:void 0;function IA(s){return ac(s)||Dy(s)||!!(cT&&s&&s[cT])}function By(s,n,i,o,l){var g=-1,m=s.length;for(i||(i=IA),l||(l=[]);++g<m;){var u=s[g];n>0&&i(u)?n>1?By(u,n-1,i,o,l):RA(l,u):o||(l[l.length]=u)}return l}function CA(s){var n=s==null?0:s.length;return n?By(s,1):[]}function OA(s){return Rw(Lw(s,void 0,CA),s+"")}function kA(s,n){return s!=null&&n in Object(s)}function wA(s,n,i){n=_h(n,s);for(var o=-1,l=n.length,g=false;++o<l;){var m=jf(n[o]);if(!(g=s!=null&&i(s,m)))break;s=s[m]}return g||++o!=l?g:(l=s==null?0:s.length,!!l&&Mw(l)&&Ly(m,l)&&(ac(s)||Dy(s)))}function AA(s,n){return s!=null&&wA(s,n,kA)}function Py(s){for(var n=-1,i=s==null?0:s.length,o={};++n<i;){var l=s[n];o[l[0]]=l[1]}return o}function Uy(s){return s==null}function LA(s,n,i,o){if(!Zu(s))return s;n=_h(n,s);for(var l=-1,g=n.length,m=g-1,u=s;u!=null&&++l<g;){var p=jf(n[l]),c=i;if(p==="__proto__"||p==="constructor"||p==="prototype")return s;if(l!=m){var d=u[p];c=o?o(d,p,u):void 0,c===void 0&&(c=Zu(d)?d:Ly(n[l+1])?[]:{})}Aw(u,p,c),u=u[p]}return s}function NA(s,n,i){for(var o=-1,l=n.length,g={};++o<l;){var m=n[o],u=xy(s,m);i(u,m)&&LA(g,_h(m,s),u)}return g}function MA(s,n){return NA(s,n,function(i,o){return AA(s,o)})}var DA=OA(function(s,n){return s==null?{}:MA(s,n)});const xA=DA,Fy=s=>s===void 0,eh=s=>typeof s=="number",uT=s=>typeof Element>"u"?false:s instanceof Element,BA=s=>Sr(s)?!Number.isNaN(Number(s)):false,hT=s=>Object.keys(s);class PA extends Error{constructor(n){super(n),this.name="ElementPlusError"}}function UA(s,n){throw new PA(`[${s}] ${n}`)}const Gy=(s="")=>s.split(" ").filter(n=>!!n.trim()),dT=(s,n)=>{if(!s||!n)return false;if(n.includes(" "))throw new Error("className should not contain space.");return s.classList.contains(n)},FA=(s,n)=>{!s||!n.trim()||s.classList.add(...Gy(n))},GA=(s,n)=>{!s||!n.trim()||s.classList.remove(...Gy(n))},HA=(s,n)=>{var i;if(!er||!s||!n)return"";let o=Ak(n);o==="float"&&(o="cssFloat");try{const l=s.style[o];if(l)return l;const g=(i=document.defaultView)==null?void 0:i.getComputedStyle(s,"");return g?g[o]:""}catch{return s.style[o]}};function uf(s,n="px"){if(!s)return"";if(eh(s)||BA(s))return`${s}${n}`;if(Sr(s))return s}let Ru;const VA=s=>{var n;if(!er)return 0;if(Ru!==void 0)return Ru;const i=document.createElement("div");i.className=`${s}-scrollbar__wrap`,i.style.visibility="hidden",i.style.width="100px",i.style.position="absolute",i.style.top="-9999px",document.body.appendChild(i);const o=i.offsetWidth;i.style.overflow="scroll";const l=document.createElement("div");l.style.width="100%",i.appendChild(l);const g=l.offsetWidth;return(n=i.parentNode)==null||n.removeChild(i),Ru=o-g,Ru};/*! Element Plus Icons Vue v2.3.1 */var WA=Xe({name:"CircleCheck",__name:"circle-check",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),he("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),zA=WA,jA=Xe({name:"CircleCloseFilled",__name:"circle-close-filled",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),Hy=jA,XA=Xe({name:"CircleClose",__name:"circle-close",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),he("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),Vy=XA,KA=Xe({name:"Close",__name:"close",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),YA=KA,qA=Xe({name:"Hide",__name:"hide",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),he("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),JA=qA,ZA=Xe({name:"InfoFilled",__name:"info-filled",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),Wy=ZA,QA=Xe({name:"Loading",__name:"loading",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),th=QA,eL=Xe({name:"SuccessFilled",__name:"success-filled",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),zy=eL,tL=Xe({name:"View",__name:"view",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),sL=tL,iL=Xe({name:"WarningFilled",__name:"warning-filled",setup(s){return(n,i)=>(oe(),be("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[he("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),jy=iL;const Xy="__epPropKey",$r=s=>s,nL=s=>Wl(s)&&!!s[Xy],Ky=(s,n)=>{if(!Wl(s)||nL(s))return s;const{values:i,required:o,default:l,type:g,validator:m}=s,p={type:g,required:!!o,validator:i||m?c=>{let d=false,_=[];if(i&&(_=Array.from(i),Ju(s,"default")&&_.push(l),d||(d=_.includes(c))),m&&(d||(d=m(c))),!d&&_.length>0){const b=[...new Set(_)].map($=>JSON.stringify($)).join(", ");rk(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${b}], got value ${JSON.stringify(c)}.`)}return d}:void 0,[Xy]:true};return Ju(s,"default")&&(p.default=l),p},Ta=s=>Py(Object.entries(s).map(([n,i])=>[n,Ky(i,n)])),sh=$r([String,Object,Function]),rL={Close:YA,SuccessFilled:zy,InfoFilled:Wy,WarningFilled:jy,CircleCloseFilled:Hy},_T={success:zy,warning:jy,error:Hy,info:Wy},oL={validating:th,success:zA,error:Vy},Xf=(s,n)=>{if(s.install=i=>{for(const o of[s,...Object.values(n??{})])i.component(o.name,o)},n)for(const[i,o]of Object.entries(n))s[i]=o;return s},aL=s=>(s.install=Bl,s),Kf={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},hf="update:modelValue",Yy=["","default","small","large"],lL=s=>["",...Yy].includes(s);var Hu=(s=>(s[s.TEXT=1]="TEXT",s[s.CLASS=2]="CLASS",s[s.STYLE=4]="STYLE",s[s.PROPS=8]="PROPS",s[s.FULL_PROPS=16]="FULL_PROPS",s[s.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",s[s.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",s[s.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",s[s.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",s[s.NEED_PATCH=512]="NEED_PATCH",s[s.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",s[s.HOISTED=-1]="HOISTED",s[s.BAIL=-2]="BAIL",s))(Hu||{});const cL=s=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(s),uL=s=>s,hL=["class","style"],dL=/^on[A-Z]/,_L=(s={})=>{const{excludeListeners:n=false,excludeKeys:i}=s,o=_e(()=>((i==null?void 0:i.value)||[]).concat(hL)),l=Qn();return l?_e(()=>{var g;return Py(Object.entries((g=l.proxy)==null?void 0:g.$attrs).filter(([m])=>!o.value.includes(m)&&!(n&&dL.test(m))))}):_e(()=>({}))},pL=({from:s,replacement:n,scope:i,version:o,ref:l,type:g="API"},m)=>{Ct(()=>ue(m),u=>{},{immediate:true})},gL=(s,n,i,o)=>{let l={offsetX:0,offsetY:0};const g=c=>{const d=c.clientX,_=c.clientY,{offsetX:b,offsetY:$}=l,E=s.value.getBoundingClientRect(),y=E.left,f=E.top,v=E.width,T=E.height,S=document.documentElement.clientWidth,R=document.documentElement.clientHeight,O=-y+b,A=-f+$,L=S-y-v+b,I=R-f-T+$,k=U=>{let P=b+U.clientX-d,z=$+U.clientY-_;o!=null&&o.value||(P=Math.min(Math.max(P,O),L),z=Math.min(Math.max(z,A),I)),l={offsetX:P,offsetY:z},s.value&&(s.value.style.transform=`translate(${uf(P)}, ${uf(z)})`)},B=()=>{document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",B)};document.addEventListener("mousemove",k),document.addEventListener("mouseup",B)},m=()=>{n.value&&s.value&&n.value.addEventListener("mousedown",g)},u=()=>{n.value&&s.value&&n.value.removeEventListener("mousedown",g)},p=()=>{l={offsetX:0,offsetY:0},s.value&&(s.value.style.transform="none")};return Ws(()=>{ok(()=>{i.value?m():u()})}),kr(()=>{u()}),{resetPosition:p}};var fL={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const mL=s=>(n,i)=>EL(n,i,ue(s)),EL=(s,n,i)=>yA(i,s,s).replace(/\{(\w+)\}/g,(o,l)=>{var g;return`${(g=n==null?void 0:n[l])!=null?g:`{${l}}`}`}),vL=s=>{const n=_e(()=>ue(s).name),i=Hl(s)?s:Ee(s);return{lang:n,locale:i,t:mL(s)}},qy=Symbol("localeContextKey"),bL=s=>{const n=s||Vs(qy,Ee());return vL(_e(()=>n.value||fL))},Vu="el",TL="is-",so=(s,n,i,o,l)=>{let g=`${s}-${n}`;return i&&(g+=`-${i}`),o&&(g+=`__${o}`),l&&(g+=`--${l}`),g},Jy=Symbol("namespaceContextKey"),Zy=s=>{const n=s||(Qn()?Vs(Jy,Ee(Vu)):Ee(Vu));return _e(()=>ue(n)||Vu)},tr=(s,n)=>{const i=Zy(n);return{namespace:i,b:(y="")=>so(i.value,s,y,"",""),e:y=>y?so(i.value,s,"",y,""):"",m:y=>y?so(i.value,s,"","",y):"",be:(y,f)=>y&&f?so(i.value,s,y,f,""):"",em:(y,f)=>y&&f?so(i.value,s,"",y,f):"",bm:(y,f)=>y&&f?so(i.value,s,y,"",f):"",bem:(y,f,v)=>y&&f&&v?so(i.value,s,y,f,v):"",is:(y,...f)=>{const v=f.length>=1?f[0]:true;return y&&v?`${TL}${y}`:""},cssVar:y=>{const f={};for(const v in y)y[v]&&(f[`--${i.value}-${v}`]=y[v]);return f},cssVarName:y=>`--${i.value}-${y}`,cssVarBlock:y=>{const f={};for(const v in y)y[v]&&(f[`--${i.value}-${s}-${v}`]=y[v]);return f},cssVarBlockName:y=>`--${i.value}-${s}-${y}`}},SL=(s,n={})=>{Hl(s)||UA("[useLockscreen]","You need to pass a ref param to this function");const i=n.ns||tr("popup"),o=_e(()=>i.bm("parent","hidden"));if(!er||dT(document.body,o.value))return;let l=0,g=false,m="0";const u=()=>{setTimeout(()=>{GA(document==null?void 0:document.body,o.value),g&&document&&(document.body.style.width=m)},200)};Ct(s,p=>{if(!p){u();return}g=!dT(document.body,o.value),g&&(m=document.body.style.width),l=VA(i.namespace.value);const c=document.documentElement.clientHeight<document.body.scrollHeight,d=HA(document.body,"overflowY");l>0&&(c||d==="scroll")&&g&&(document.body.style.width=`calc(100% - ${l}px)`),FA(document.body,o.value)}),$y(()=>u())},Qy=s=>{const n=Qn();return _e(()=>{var i,o;return(o=(i=n==null?void 0:n.proxy)==null?void 0:i.$props)==null?void 0:o[s]})},e0=s=>{if(!s)return{onClick:Bl,onMousedown:Bl,onMouseup:Bl};let n=false,i=false;return{onClick:m=>{n&&i&&s(m),n=i=false},onMousedown:m=>{n=m.target===m.currentTarget},onMouseup:m=>{i=m.target===m.currentTarget}}},pT={prefix:Math.floor(Math.random()*1e4),current:0},$L=Symbol("elIdInjection"),yL=()=>Qn()?Vs($L,pT):pT,df=s=>{const n=yL(),i=Zy();return _e(()=>ue(s)||`${i.value}-id-${n.prefix}-${n.current++}`)};let la=[];const gT=s=>{const n=s;n.key===Kf.esc&&la.forEach(i=>i(n))},RL=s=>{Ws(()=>{la.length===0&&document.addEventListener("keydown",gT),er&&la.push(s)}),kr(()=>{la=la.filter(n=>n!==s),la.length===0&&er&&document.removeEventListener("keydown",gT)})},fT={current:0},mT=Ee(0),t0=2e3,ET=Symbol("elZIndexContextKey"),s0=Symbol("zIndexContextKey"),IL=s=>{const n=Qn()?Vs(ET,fT):fT,i=s||(Qn()?Vs(s0,void 0):void 0),o=_e(()=>{const m=ue(i);return eh(m)?m:t0}),l=_e(()=>o.value+mT.value),g=()=>(n.current++,mT.value=n.current,l.value);return!er&&Vs(ET),{initialZIndex:o,currentZIndex:l,nextZIndex:g}};function CL(s){let n;function i(){if(s.value==null)return;const{selectionStart:l,selectionEnd:g,value:m}=s.value;if(l==null||g==null)return;const u=m.slice(0,Math.max(0,l)),p=m.slice(Math.max(0,g));n={selectionStart:l,selectionEnd:g,value:m,beforeTxt:u,afterTxt:p}}function o(){if(s.value==null||n==null)return;const{value:l}=s.value,{beforeTxt:g,afterTxt:m,selectionStart:u}=n;if(g==null||m==null||u==null)return;let p=l.length;if(l.endsWith(m))p=l.length-m.length;else if(l.startsWith(g))p=g.length;else{const c=g[u-1],d=l.indexOf(c,u-1);d!==-1&&(p=d+1)}s.value.setSelectionRange(p,p)}return[i,o]}const i0=Ky({type:String,values:Yy,required:false}),n0=Symbol("size"),OL=()=>{const s=Vs(n0,{});return _e(()=>ue(s.size)||"")};function kL(s,{beforeFocus:n,afterFocus:i,beforeBlur:o,afterBlur:l}={}){const g=Qn(),{emit:m}=g,u=Gu(),p=Ee(false),c=b=>{Vl(n)&&n(b)||p.value||(p.value=true,m("focus",b),i==null||i())},d=b=>{var $;Vl(o)&&o(b)||b.relatedTarget&&(($=u.value)!=null&&$.contains(b.relatedTarget))||(p.value=false,m("blur",b),l==null||l())},_=()=>{var b,$;(b=u.value)!=null&&b.contains(document.activeElement)&&u.value!==document.activeElement||($=s.value)==null||$.focus()};return Ct(u,b=>{b&&b.setAttribute("tabindex","-1")}),J_(u,"focus",c,true),J_(u,"blur",d,true),J_(u,"click",_,true),{isFocused:p,wrapperRef:u,handleFocus:c,handleBlur:d}}function wL({afterComposition:s,emit:n}){const i=Ee(false),o=u=>{n==null||n("compositionstart",u),i.value=true},l=u=>{var p;n==null||n("compositionupdate",u);const c=(p=u.target)==null?void 0:p.value,d=c[c.length-1]||"";i.value=!cL(d)},g=u=>{n==null||n("compositionend",u),i.value&&(i.value=false,rs(()=>s(u)))};return{isComposing:i,handleComposition:u=>{u.type==="compositionend"?g(u):l(u)},handleCompositionStart:o,handleCompositionUpdate:l,handleCompositionEnd:g}}const AL=Symbol("emptyValuesContextKey");Ta({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:s=>Vl(s)?!s():!s}});const LL=Ta({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),NL=s=>xA(LL,s),r0=Symbol(),ih=Ee();function Yf(s,n=void 0){const i=Qn()?Vs(r0,ih):ih;return s?_e(()=>{var o,l;return(l=(o=i.value)==null?void 0:o[s])!=null?l:n}):i}function ML(s,n){const i=Yf(),o=tr(s,_e(()=>{var u;return((u=i.value)==null?void 0:u.namespace)||Vu})),l=bL(_e(()=>{var u;return(u=i.value)==null?void 0:u.locale})),g=IL(_e(()=>{var u;return((u=i.value)==null?void 0:u.zIndex)||t0})),m=_e(()=>{var u;return ue(n)||((u=i.value)==null?void 0:u.size)||""});return DL(_e(()=>ue(i)||{})),{ns:o,locale:l,zIndex:g,size:m}}const DL=(s,n,i=false)=>{var o;const l=!!Qn(),g=l?Yf():void 0,m=(o=n==null?void 0:n.provide)!=null?o:l?rc:void 0;if(!m)return;const u=_e(()=>{const p=ue(s);return g!=null&&g.value?xL(g.value,p):p});return m(r0,u),m(qy,_e(()=>u.value.locale)),m(Jy,_e(()=>u.value.namespace)),m(s0,_e(()=>u.value.zIndex)),m(n0,{size:_e(()=>u.value.size||"")}),m(AL,_e(()=>({emptyValues:u.value.emptyValues,valueOnClear:u.value.valueOnClear}))),(i||!ih.value)&&(ih.value=u.value),u},xL=(s,n)=>{const i=[...new Set([...hT(s),...hT(n)])],o={};for(const l of i)o[l]=n[l]!==void 0?n[l]:s[l];return o};var Sa=(s,n)=>{const i=s.__vccOpts||s;for(const[o,l]of n)i[o]=l;return i};const BL=Ta({size:{type:$r([Number,String])},color:{type:String}}),PL=Xe({name:"ElIcon",inheritAttrs:false}),UL=Xe({...PL,props:BL,setup(s){const n=s,i=tr("icon"),o=_e(()=>{const{size:l,color:g}=n;return!l&&!g?{}:{fontSize:Fy(l)?void 0:uf(l),"--color":g}});return(l,g)=>(oe(),be("i",ca({class:ue(i).b(),style:ue(o)},l.$attrs),[Mt(l.$slots,"default")],16))}});var FL=Sa(UL,[["__file","icon.vue"]]);const Er=Xf(FL),qf=Symbol("formContextKey"),o0=Symbol("formItemContextKey"),a0=(s,n={})=>{const i=Ee(void 0),o=n.prop?i:Qy("size"),l=n.global?i:OL(),g=n.form?{size:void 0}:Vs(qf,void 0),m=n.formItem?{size:void 0}:Vs(o0,void 0);return _e(()=>o.value||ue(s)||(m==null?void 0:m.size)||(g==null?void 0:g.size)||l.value||"")},Jf=s=>{const n=Qy("disabled"),i=Vs(qf,void 0);return _e(()=>n.value||ue(s)||(i==null?void 0:i.disabled)||false)},l0=()=>{const s=Vs(qf,void 0),n=Vs(o0,void 0);return{form:s,formItem:n}},GL=(s,{formItemContext:n,disableIdGeneration:i,disableIdManagement:o})=>{i||(i=Ee(false)),o||(o=Ee(false));const l=Ee();let g;const m=_e(()=>{var u;return!!(!(s.label||s.ariaLabel)&&n&&n.inputIds&&((u=n.inputIds)==null?void 0:u.length)<=1)});return Ws(()=>{g=Ct([cn(s,"id"),i],([u,p])=>{const c=u??(p?void 0:df().value);c!==l.value&&(n!=null&&n.removeInputId&&(l.value&&n.removeInputId(l.value),!(o!=null&&o.value)&&!p&&c&&n.addInputId(c)),l.value=c)},{immediate:true})}),ak(()=>{g&&g(),n!=null&&n.removeInputId&&l.value&&n.removeInputId(l.value)}),{isLabeledByFormItem:m,inputId:l}};let an;const HL=`
  height:0 !important;
  visibility:hidden !important;
  ${Ck()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,VL=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function WL(s){const n=window.getComputedStyle(s),i=n.getPropertyValue("box-sizing"),o=Number.parseFloat(n.getPropertyValue("padding-bottom"))+Number.parseFloat(n.getPropertyValue("padding-top")),l=Number.parseFloat(n.getPropertyValue("border-bottom-width"))+Number.parseFloat(n.getPropertyValue("border-top-width"));return{contextStyle:VL.map(m=>`${m}:${n.getPropertyValue(m)}`).join(";"),paddingSize:o,borderSize:l,boxSizing:i}}function vT(s,n=1,i){var o;an||(an=document.createElement("textarea"),document.body.appendChild(an));const{paddingSize:l,borderSize:g,boxSizing:m,contextStyle:u}=WL(s);an.setAttribute("style",`${u};${HL}`),an.value=s.value||s.placeholder||"";let p=an.scrollHeight;const c={};m==="border-box"?p=p+g:m==="content-box"&&(p=p-l),an.value="";const d=an.scrollHeight-l;if(eh(n)){let _=d*n;m==="border-box"&&(_=_+l+g),p=Math.max(_,p),c.minHeight=`${_}px`}if(eh(i)){let _=d*i;m==="border-box"&&(_=_+l+g),p=Math.min(_,p)}return c.height=`${p}px`,(o=an.parentNode)==null||o.removeChild(an),an=void 0,c}const zL=Ta({id:{type:String,default:void 0},size:i0,disabled:Boolean,modelValue:{type:$r([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:$r([Boolean,Object]),default:false},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:sh},prefixIcon:{type:sh},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:true},inputStyle:{type:$r([Object,Array,String]),default:()=>uL({})},autofocus:Boolean,rows:{type:Number,default:2},...NL(["ariaLabel"])}),jL={[hf]:s=>Sr(s),input:s=>Sr(s),change:s=>Sr(s),focus:s=>s instanceof FocusEvent,blur:s=>s instanceof FocusEvent,clear:()=>true,mouseleave:s=>s instanceof MouseEvent,mouseenter:s=>s instanceof MouseEvent,keydown:s=>s instanceof Event,compositionstart:s=>s instanceof CompositionEvent,compositionupdate:s=>s instanceof CompositionEvent,compositionend:s=>s instanceof CompositionEvent},XL=Xe({name:"ElInput",inheritAttrs:false}),KL=Xe({...XL,props:zL,emits:jL,setup(s,{expose:n,emit:i}){const o=s,l=lk(),g=yy(),m=_e(()=>{const me={};return o.containerRole==="combobox"&&(me["aria-haspopup"]=l["aria-haspopup"],me["aria-owns"]=l["aria-owns"],me["aria-expanded"]=l["aria-expanded"]),me}),u=_e(()=>[o.type==="textarea"?f.b():y.b(),y.m($.value),y.is("disabled",E.value),y.is("exceed",ne.value),{[y.b("group")]:g.prepend||g.append,[y.m("prefix")]:g.prefix||o.prefixIcon,[y.m("suffix")]:g.suffix||o.suffixIcon||o.clearable||o.showPassword,[y.bm("suffix","password-clear")]:F.value&&V.value,[y.b("hidden")]:o.type==="hidden"},l.class]),p=_e(()=>[y.e("wrapper"),y.is("focus",k.value)]),c=_L({excludeKeys:_e(()=>Object.keys(m.value))}),{form:d,formItem:_}=l0(),{inputId:b}=GL(o,{formItemContext:_}),$=a0(),E=Jf(),y=tr("input"),f=tr("textarea"),v=Gu(),T=Gu(),S=Ee(false),R=Ee(false),O=Ee(),A=Gu(o.inputStyle),L=_e(()=>v.value||T.value),{wrapperRef:I,isFocused:k,handleFocus:B,handleBlur:U}=kL(L,{beforeFocus(){return E.value},afterBlur(){var me;o.validateEvent&&((me=_==null?void 0:_.validate)==null||me.call(_,"blur").catch(He=>void 0))}}),P=_e(()=>{var me;return(me=d==null?void 0:d.statusIcon)!=null?me:false}),z=_e(()=>(_==null?void 0:_.validateState)||""),W=_e(()=>z.value&&oL[z.value]),j=_e(()=>R.value?sL:JA),K=_e(()=>[l.style]),ee=_e(()=>[o.inputStyle,A.value,{resize:o.resize}]),M=_e(()=>Uy(o.modelValue)?"":String(o.modelValue)),F=_e(()=>o.clearable&&!E.value&&!o.readonly&&!!M.value&&(k.value||S.value)),V=_e(()=>o.showPassword&&!E.value&&!o.readonly&&!!M.value&&(!!M.value||k.value)),X=_e(()=>o.showWordLimit&&!!o.maxlength&&(o.type==="text"||o.type==="textarea")&&!E.value&&!o.readonly&&!o.showPassword),H=_e(()=>M.value.length),ne=_e(()=>!!X.value&&H.value>Number(o.maxlength)),Ie=_e(()=>!!g.suffix||!!o.suffixIcon||F.value||o.showPassword||X.value||!!z.value&&P.value),[de,ot]=CL(v);fk(T,me=>{if(ce(),!X.value||o.resize!=="both")return;const He=me[0],{width:Dt}=He.contentRect;O.value={right:`calc(100% - ${Dt+15+6}px)`}});const x=()=>{const{type:me,autosize:He}=o;if(!(!er||me!=="textarea"||!T.value))if(He){const Dt=Wl(He)?He.minRows:void 0,ve=Wl(He)?He.maxRows:void 0,Bs=vT(T.value,Dt,ve);A.value={overflowY:"hidden",...Bs},rs(()=>{T.value.offsetHeight,A.value=Bs})}else A.value={minHeight:vT(T.value).minHeight}},ce=(me=>{let He=false;return()=>{var Dt;if(He||!o.autosize)return;((Dt=T.value)==null?void 0:Dt.offsetParent)===null||(me(),He=true)}})(x),ae=()=>{const me=L.value,He=o.formatter?o.formatter(M.value):M.value;!me||me.value===He||(me.value=He)},De=async me=>{de();let{value:He}=me.target;if(o.formatter&&(He=o.parser?o.parser(He):He),!st.value){if(He===M.value){ae();return}i(hf,He),i("input",He),await rs(),ae(),ot()}},$e=me=>{i("change",me.target.value)},{isComposing:st,handleCompositionStart:bt,handleCompositionUpdate:Ut,handleCompositionEnd:jt}=wL({emit:i,afterComposition:De}),Ve=()=>{R.value=!R.value,Ss()},Ss=async()=>{var me;await rs(),(me=L.value)==null||me.focus()},Cs=()=>{var me;return(me=L.value)==null?void 0:me.blur()},Os=me=>{S.value=false,i("mouseleave",me)},zs=me=>{S.value=true,i("mouseenter",me)},xs=me=>{i("keydown",me)},kt=()=>{var me;(me=L.value)==null||me.select()},ts=()=>{i(hf,""),i("change",""),i("clear"),i("input","")};return Ct(()=>o.modelValue,()=>{var me;rs(()=>x()),o.validateEvent&&((me=_==null?void 0:_.validate)==null||me.call(_,"change").catch(He=>void 0))}),Ct(M,()=>ae()),Ct(()=>o.type,async()=>{await rs(),ae(),x()}),Ws(()=>{!o.formatter&&o.parser,ae(),rs(x)}),n({input:v,textarea:T,ref:L,textareaStyle:ee,autosize:cn(o,"autosize"),isComposing:st,focus:Ss,blur:Cs,select:kt,clear:ts,resizeTextarea:x}),(me,He)=>(oe(),be("div",ca(ue(m),{class:[ue(u),{[ue(y).bm("group","append")]:me.$slots.append,[ue(y).bm("group","prepend")]:me.$slots.prepend}],style:ue(K),role:me.containerRole,onMouseenter:zs,onMouseleave:Os}),[qe(" input "),me.type!=="textarea"?(oe(),be(Pt,{key:0},[qe(" prepend slot "),me.$slots.prepend?(oe(),be("div",{key:0,class:tt(ue(y).be("group","prepend"))},[Mt(me.$slots,"prepend")],2)):qe("v-if",true),he("div",{ref_key:"wrapperRef",ref:I,class:tt(ue(p))},[qe(" prefix slot "),me.$slots.prefix||me.prefixIcon?(oe(),be("span",{key:0,class:tt(ue(y).e("prefix"))},[he("span",{class:tt(ue(y).e("prefix-inner"))},[Mt(me.$slots,"prefix"),me.prefixIcon?(oe(),Je(ue(Er),{key:0,class:tt(ue(y).e("icon"))},{default:je(()=>[(oe(),Je(ui(me.prefixIcon)))]),_:1},8,["class"])):qe("v-if",true)],2)],2)):qe("v-if",true),he("input",ca({id:ue(b),ref_key:"input",ref:v,class:ue(y).e("inner")},ue(c),{minlength:me.minlength,maxlength:me.maxlength,type:me.showPassword?R.value?"text":"password":me.type,disabled:ue(E),readonly:me.readonly,autocomplete:me.autocomplete,tabindex:me.tabindex,"aria-label":me.ariaLabel,placeholder:me.placeholder,style:me.inputStyle,form:me.form,autofocus:me.autofocus,onCompositionstart:ue(bt),onCompositionupdate:ue(Ut),onCompositionend:ue(jt),onInput:De,onChange:$e,onKeydown:xs}),null,16,["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","onCompositionstart","onCompositionupdate","onCompositionend"]),qe(" suffix slot "),ue(Ie)?(oe(),be("span",{key:1,class:tt(ue(y).e("suffix"))},[he("span",{class:tt(ue(y).e("suffix-inner"))},[!ue(F)||!ue(V)||!ue(X)?(oe(),be(Pt,{key:0},[Mt(me.$slots,"suffix"),me.suffixIcon?(oe(),Je(ue(Er),{key:0,class:tt(ue(y).e("icon"))},{default:je(()=>[(oe(),Je(ui(me.suffixIcon)))]),_:1},8,["class"])):qe("v-if",true)],64)):qe("v-if",true),ue(F)?(oe(),Je(ue(Er),{key:1,class:tt([ue(y).e("icon"),ue(y).e("clear")]),onMousedown:Is(ue(Bl),["prevent"]),onClick:ts},{default:je(()=>[Me(ue(Vy))]),_:1},8,["class","onMousedown"])):qe("v-if",true),ue(V)?(oe(),Je(ue(Er),{key:2,class:tt([ue(y).e("icon"),ue(y).e("password")]),onClick:Ve},{default:je(()=>[(oe(),Je(ui(ue(j))))]),_:1},8,["class"])):qe("v-if",true),ue(X)?(oe(),be("span",{key:3,class:tt(ue(y).e("count"))},[he("span",{class:tt(ue(y).e("count-inner"))},Bt(ue(H))+" / "+Bt(me.maxlength),3)],2)):qe("v-if",true),ue(z)&&ue(W)&&ue(P)?(oe(),Je(ue(Er),{key:4,class:tt([ue(y).e("icon"),ue(y).e("validateIcon"),ue(y).is("loading",ue(z)==="validating")])},{default:je(()=>[(oe(),Je(ui(ue(W))))]),_:1},8,["class"])):qe("v-if",true)],2)],2)):qe("v-if",true)],2),qe(" append slot "),me.$slots.append?(oe(),be("div",{key:1,class:tt(ue(y).be("group","append"))},[Mt(me.$slots,"append")],2)):qe("v-if",true)],64)):(oe(),be(Pt,{key:1},[qe(" textarea "),he("textarea",ca({id:ue(b),ref_key:"textarea",ref:T,class:[ue(f).e("inner"),ue(y).is("focus",ue(k))]},ue(c),{minlength:me.minlength,maxlength:me.maxlength,tabindex:me.tabindex,disabled:ue(E),readonly:me.readonly,autocomplete:me.autocomplete,style:ue(ee),"aria-label":me.ariaLabel,placeholder:me.placeholder,form:me.form,autofocus:me.autofocus,rows:me.rows,onCompositionstart:ue(bt),onCompositionupdate:ue(Ut),onCompositionend:ue(jt),onInput:De,onFocus:ue(B),onBlur:ue(U),onChange:$e,onKeydown:xs}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),ue(X)?(oe(),be("span",{key:0,style:Js(O.value),class:tt(ue(y).e("count"))},Bt(ue(H))+" / "+Bt(me.maxlength),7)):qe("v-if",true)],64))],16,["role"]))}});var YL=Sa(KL,[["__file","input.vue"]]);const c0=Xf(YL),Q_="focus-trap.focus-after-trapped",ep="focus-trap.focus-after-released",qL="focus-trap.focusout-prevented",bT={cancelable:true,bubbles:false},JL={cancelable:true,bubbles:false},TT="focusAfterTrapped",ST="focusAfterReleased",ZL=Symbol("elFocusTrap"),Zf=Ee(),ph=Ee(0),Qf=Ee(0);let Iu=0;const u0=s=>{const n=[],i=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const l=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||l?NodeFilter.FILTER_SKIP:o.tabIndex>=0||o===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)n.push(i.currentNode);return n},$T=(s,n)=>{for(const i of s)if(!QL(i,n))return i},QL=(s,n)=>{if(getComputedStyle(s).visibility==="hidden")return true;for(;s;){if(n&&s===n)return false;if(getComputedStyle(s).display==="none")return true;s=s.parentElement}return false},eN=s=>{const n=u0(s),i=$T(n,s),o=$T(n.reverse(),s);return[i,o]},tN=s=>s instanceof HTMLInputElement&&"select"in s,fr=(s,n)=>{if(s&&s.focus){const i=document.activeElement;s.focus({preventScroll:true}),Qf.value=window.performance.now(),s!==i&&tN(s)&&n&&s.select()}};function yT(s,n){const i=[...s],o=s.indexOf(n);return o!==-1&&i.splice(o,1),i}const sN=()=>{let s=[];return{push:o=>{const l=s[0];l&&o!==l&&l.pause(),s=yT(s,o),s.unshift(o)},remove:o=>{var l,g;s=yT(s,o),(g=(l=s[0])==null?void 0:l.resume)==null||g.call(l)}}},iN=(s,n=false)=>{const i=document.activeElement;for(const o of s)if(fr(o,n),document.activeElement!==i)return},RT=sN(),nN=()=>ph.value>Qf.value,Cu=()=>{Zf.value="pointer",ph.value=window.performance.now()},IT=()=>{Zf.value="keyboard",ph.value=window.performance.now()},rN=()=>(Ws(()=>{Iu===0&&(document.addEventListener("mousedown",Cu),document.addEventListener("touchstart",Cu),document.addEventListener("keydown",IT)),Iu++}),kr(()=>{Iu--,Iu<=0&&(document.removeEventListener("mousedown",Cu),document.removeEventListener("touchstart",Cu),document.removeEventListener("keydown",IT))}),{focusReason:Zf,lastUserFocusTimestamp:ph,lastAutomatedFocusTimestamp:Qf}),Ou=s=>new CustomEvent(qL,{...JL,detail:s}),oN=Xe({name:"ElFocusTrap",inheritAttrs:false,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[TT,ST,"focusin","focusout","focusout-prevented","release-requested"],setup(s,{emit:n}){const i=Ee();let o,l;const{focusReason:g}=rN();RL(E=>{s.trapped&&!m.paused&&n("release-requested",E)});const m={paused:false,pause(){this.paused=true},resume(){this.paused=false}},u=E=>{if(!s.loop&&!s.trapped||m.paused)return;const{key:y,altKey:f,ctrlKey:v,metaKey:T,currentTarget:S,shiftKey:R}=E,{loop:O}=s,A=y===Kf.tab&&!f&&!v&&!T,L=document.activeElement;if(A&&L){const I=S,[k,B]=eN(I);if(k&&B){if(!R&&L===B){const P=Ou({focusReason:g.value});n("focusout-prevented",P),P.defaultPrevented||(E.preventDefault(),O&&fr(k,true))}else if(R&&[k,I].includes(L)){const P=Ou({focusReason:g.value});n("focusout-prevented",P),P.defaultPrevented||(E.preventDefault(),O&&fr(B,true))}}else if(L===I){const P=Ou({focusReason:g.value});n("focusout-prevented",P),P.defaultPrevented||E.preventDefault()}}};rc(ZL,{focusTrapRef:i,onKeydown:u}),Ct(()=>s.focusTrapEl,E=>{E&&(i.value=E)},{immediate:true}),Ct([i],([E],[y])=>{E&&(E.addEventListener("keydown",u),E.addEventListener("focusin",d),E.addEventListener("focusout",_)),y&&(y.removeEventListener("keydown",u),y.removeEventListener("focusin",d),y.removeEventListener("focusout",_))});const p=E=>{n(TT,E)},c=E=>n(ST,E),d=E=>{const y=ue(i);if(!y)return;const f=E.target,v=E.relatedTarget,T=f&&y.contains(f);s.trapped||v&&y.contains(v)||(o=v),T&&n("focusin",E),!m.paused&&s.trapped&&(T?l=f:fr(l,true))},_=E=>{const y=ue(i);if(!(m.paused||!y))if(s.trapped){const f=E.relatedTarget;!Uy(f)&&!y.contains(f)&&setTimeout(()=>{if(!m.paused&&s.trapped){const v=Ou({focusReason:g.value});n("focusout-prevented",v),v.defaultPrevented||fr(l,true)}},0)}else{const f=E.target;f&&y.contains(f)||n("focusout",E)}};async function b(){await rs();const E=ue(i);if(E){RT.push(m);const y=E.contains(document.activeElement)?o:document.activeElement;if(o=y,!E.contains(y)){const v=new Event(Q_,bT);E.addEventListener(Q_,p),E.dispatchEvent(v),v.defaultPrevented||rs(()=>{let T=s.focusStartEl;Sr(T)||(fr(T),document.activeElement!==T&&(T="first")),T==="first"&&iN(u0(E),true),(document.activeElement===y||T==="container")&&fr(E)})}}}function $(){const E=ue(i);if(E){E.removeEventListener(Q_,p);const y=new CustomEvent(ep,{...bT,detail:{focusReason:g.value}});E.addEventListener(ep,c),E.dispatchEvent(y),!y.defaultPrevented&&(g.value=="keyboard"||!nN()||E.contains(document.activeElement))&&fr(o??document.body),E.removeEventListener(ep,c),RT.remove(m)}}return Ws(()=>{s.trapped&&b(),Ct(()=>s.trapped,E=>{E?b():$()})}),kr(()=>{s.trapped&&$(),i.value&&(i.value.removeEventListener("keydown",u),i.value.removeEventListener("focusin",d),i.value.removeEventListener("focusout",_),i.value=void 0)}),{onKeydown:u}}});function aN(s,n,i,o,l,g){return Mt(s.$slots,"default",{handleKeydown:s.onKeydown})}var lN=Sa(oN,[["render",aN],["__file","focus-trap.vue"]]);const h0=Symbol("buttonGroupContextKey"),cN=(s,n)=>{pL({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},_e(()=>s.type==="text"));const i=Vs(h0,void 0),o=Yf("button"),{form:l}=l0(),g=a0(_e(()=>i==null?void 0:i.size)),m=Jf(),u=Ee(),p=yy(),c=_e(()=>s.type||(i==null?void 0:i.type)||""),d=_e(()=>{var E,y,f;return(f=(y=s.autoInsertSpace)!=null?y:(E=o.value)==null?void 0:E.autoInsertSpace)!=null?f:false}),_=_e(()=>s.tag==="button"?{ariaDisabled:m.value||s.loading,disabled:m.value||s.loading,autofocus:s.autofocus,type:s.nativeType}:{}),b=_e(()=>{var E;const y=(E=p.default)==null?void 0:E.call(p);if(d.value&&(y==null?void 0:y.length)===1){const f=y[0];if((f==null?void 0:f.type)===ck){const v=f.children;return/^\p{Unified_Ideograph}{2}$/u.test(v.trim())}}return false});return{_disabled:m,_size:g,_type:c,_ref:u,_props:_,shouldAddSpace:b,handleClick:E=>{if(m.value||s.loading){E.stopPropagation();return}s.nativeType==="reset"&&(l==null||l.resetFields()),n("click",E)}}},uN=["default","primary","success","warning","info","danger","text",""],hN=["button","submit","reset"],_f=Ta({size:i0,disabled:Boolean,type:{type:String,values:uN,default:""},icon:{type:sh},nativeType:{type:String,values:hN,default:"button"},loading:Boolean,loadingIcon:{type:sh,default:()=>th},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:$r([String,Object]),default:"button"}}),dN={click:s=>s instanceof MouseEvent};function Ds(s,n){_N(s)&&(s="100%");var i=pN(s);return s=n===360?s:Math.min(n,Math.max(0,parseFloat(s))),i&&(s=parseInt(String(s*n),10)/100),Math.abs(s-n)<1e-6?1:(n===360?s=(s<0?s%n+n:s%n)/parseFloat(String(n)):s=s%n/parseFloat(String(n)),s)}function ku(s){return Math.min(1,Math.max(0,s))}function _N(s){return typeof s=="string"&&s.indexOf(".")!==-1&&parseFloat(s)===1}function pN(s){return typeof s=="string"&&s.indexOf("%")!==-1}function d0(s){return s=parseFloat(s),(isNaN(s)||s<0||s>1)&&(s=1),s}function wu(s){return s<=1?"".concat(Number(s)*100,"%"):s}function no(s){return s.length===1?"0"+s:String(s)}function gN(s,n,i){return{r:Ds(s,255)*255,g:Ds(n,255)*255,b:Ds(i,255)*255}}function CT(s,n,i){s=Ds(s,255),n=Ds(n,255),i=Ds(i,255);var o=Math.max(s,n,i),l=Math.min(s,n,i),g=0,m=0,u=(o+l)/2;if(o===l)m=0,g=0;else{var p=o-l;switch(m=u>.5?p/(2-o-l):p/(o+l),o){case s:g=(n-i)/p+(n<i?6:0);break;case n:g=(i-s)/p+2;break;case i:g=(s-n)/p+4;break}g/=6}return{h:g,s:m,l:u}}function tp(s,n,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?s+(n-s)*(6*i):i<1/2?n:i<2/3?s+(n-s)*(2/3-i)*6:s}function fN(s,n,i){var o,l,g;if(s=Ds(s,360),n=Ds(n,100),i=Ds(i,100),n===0)l=i,g=i,o=i;else{var m=i<.5?i*(1+n):i+n-i*n,u=2*i-m;o=tp(u,m,s+1/3),l=tp(u,m,s),g=tp(u,m,s-1/3)}return{r:o*255,g:l*255,b:g*255}}function OT(s,n,i){s=Ds(s,255),n=Ds(n,255),i=Ds(i,255);var o=Math.max(s,n,i),l=Math.min(s,n,i),g=0,m=o,u=o-l,p=o===0?0:u/o;if(o===l)g=0;else{switch(o){case s:g=(n-i)/u+(n<i?6:0);break;case n:g=(i-s)/u+2;break;case i:g=(s-n)/u+4;break}g/=6}return{h:g,s:p,v:m}}function mN(s,n,i){s=Ds(s,360)*6,n=Ds(n,100),i=Ds(i,100);var o=Math.floor(s),l=s-o,g=i*(1-n),m=i*(1-l*n),u=i*(1-(1-l)*n),p=o%6,c=[i,m,g,g,u,i][p],d=[u,i,i,m,g,g][p],_=[g,g,u,i,i,m][p];return{r:c*255,g:d*255,b:_*255}}function kT(s,n,i,o){var l=[no(Math.round(s).toString(16)),no(Math.round(n).toString(16)),no(Math.round(i).toString(16))];return o&&l[0].startsWith(l[0].charAt(1))&&l[1].startsWith(l[1].charAt(1))&&l[2].startsWith(l[2].charAt(1))?l[0].charAt(0)+l[1].charAt(0)+l[2].charAt(0):l.join("")}function EN(s,n,i,o,l){var g=[no(Math.round(s).toString(16)),no(Math.round(n).toString(16)),no(Math.round(i).toString(16)),no(vN(o))];return l&&g[0].startsWith(g[0].charAt(1))&&g[1].startsWith(g[1].charAt(1))&&g[2].startsWith(g[2].charAt(1))&&g[3].startsWith(g[3].charAt(1))?g[0].charAt(0)+g[1].charAt(0)+g[2].charAt(0)+g[3].charAt(0):g.join("")}function vN(s){return Math.round(parseFloat(s)*255).toString(16)}function wT(s){return Ri(s)/255}function Ri(s){return parseInt(s,16)}function bN(s){return{r:s>>16,g:(s&65280)>>8,b:s&255}}var pf={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function TN(s){var n={r:0,g:0,b:0},i=1,o=null,l=null,g=null,m=false,u=false;return typeof s=="string"&&(s=yN(s)),typeof s=="object"&&(jn(s.r)&&jn(s.g)&&jn(s.b)?(n=gN(s.r,s.g,s.b),m=true,u=String(s.r).substr(-1)==="%"?"prgb":"rgb"):jn(s.h)&&jn(s.s)&&jn(s.v)?(o=wu(s.s),l=wu(s.v),n=mN(s.h,o,l),m=true,u="hsv"):jn(s.h)&&jn(s.s)&&jn(s.l)&&(o=wu(s.s),g=wu(s.l),n=fN(s.h,o,g),m=true,u="hsl"),Object.prototype.hasOwnProperty.call(s,"a")&&(i=s.a)),i=d0(i),{ok:m,format:s.format||u,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:i}}var SN="[-\\+]?\\d+%?",$N="[-\\+]?\\d*\\.\\d+%?",br="(?:".concat($N,")|(?:").concat(SN,")"),sp="[\\s|\\(]+(".concat(br,")[,|\\s]+(").concat(br,")[,|\\s]+(").concat(br,")\\s*\\)?"),ip="[\\s|\\(]+(".concat(br,")[,|\\s]+(").concat(br,")[,|\\s]+(").concat(br,")[,|\\s]+(").concat(br,")\\s*\\)?"),ln={CSS_UNIT:new RegExp(br),rgb:new RegExp("rgb"+sp),rgba:new RegExp("rgba"+ip),hsl:new RegExp("hsl"+sp),hsla:new RegExp("hsla"+ip),hsv:new RegExp("hsv"+sp),hsva:new RegExp("hsva"+ip),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function yN(s){if(s=s.trim().toLowerCase(),s.length===0)return false;var n=false;if(pf[s])s=pf[s],n=true;else if(s==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i=ln.rgb.exec(s);return i?{r:i[1],g:i[2],b:i[3]}:(i=ln.rgba.exec(s),i?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=ln.hsl.exec(s),i?{h:i[1],s:i[2],l:i[3]}:(i=ln.hsla.exec(s),i?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=ln.hsv.exec(s),i?{h:i[1],s:i[2],v:i[3]}:(i=ln.hsva.exec(s),i?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=ln.hex8.exec(s),i?{r:Ri(i[1]),g:Ri(i[2]),b:Ri(i[3]),a:wT(i[4]),format:n?"name":"hex8"}:(i=ln.hex6.exec(s),i?{r:Ri(i[1]),g:Ri(i[2]),b:Ri(i[3]),format:n?"name":"hex"}:(i=ln.hex4.exec(s),i?{r:Ri(i[1]+i[1]),g:Ri(i[2]+i[2]),b:Ri(i[3]+i[3]),a:wT(i[4]+i[4]),format:n?"name":"hex8"}:(i=ln.hex3.exec(s),i?{r:Ri(i[1]+i[1]),g:Ri(i[2]+i[2]),b:Ri(i[3]+i[3]),format:n?"name":"hex"}:false)))))))))}function jn(s){return!!ln.CSS_UNIT.exec(String(s))}var RN=function(){function s(n,i){n===void 0&&(n=""),i===void 0&&(i={});var o;if(n instanceof s)return n;typeof n=="number"&&(n=bN(n)),this.originalInput=n;var l=TN(n);this.originalInput=n,this.r=l.r,this.g=l.g,this.b=l.b,this.a=l.a,this.roundA=Math.round(100*this.a)/100,this.format=(o=i.format)!==null&&o!==void 0?o:l.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=l.ok}return s.prototype.isDark=function(){return this.getBrightness()<128},s.prototype.isLight=function(){return!this.isDark()},s.prototype.getBrightness=function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},s.prototype.getLuminance=function(){var n=this.toRgb(),i,o,l,g=n.r/255,m=n.g/255,u=n.b/255;return g<=.03928?i=g/12.92:i=Math.pow((g+.055)/1.055,2.4),m<=.03928?o=m/12.92:o=Math.pow((m+.055)/1.055,2.4),u<=.03928?l=u/12.92:l=Math.pow((u+.055)/1.055,2.4),.2126*i+.7152*o+.0722*l},s.prototype.getAlpha=function(){return this.a},s.prototype.setAlpha=function(n){return this.a=d0(n),this.roundA=Math.round(100*this.a)/100,this},s.prototype.isMonochrome=function(){var n=this.toHsl().s;return n===0},s.prototype.toHsv=function(){var n=OT(this.r,this.g,this.b);return{h:n.h*360,s:n.s,v:n.v,a:this.a}},s.prototype.toHsvString=function(){var n=OT(this.r,this.g,this.b),i=Math.round(n.h*360),o=Math.round(n.s*100),l=Math.round(n.v*100);return this.a===1?"hsv(".concat(i,", ").concat(o,"%, ").concat(l,"%)"):"hsva(".concat(i,", ").concat(o,"%, ").concat(l,"%, ").concat(this.roundA,")")},s.prototype.toHsl=function(){var n=CT(this.r,this.g,this.b);return{h:n.h*360,s:n.s,l:n.l,a:this.a}},s.prototype.toHslString=function(){var n=CT(this.r,this.g,this.b),i=Math.round(n.h*360),o=Math.round(n.s*100),l=Math.round(n.l*100);return this.a===1?"hsl(".concat(i,", ").concat(o,"%, ").concat(l,"%)"):"hsla(".concat(i,", ").concat(o,"%, ").concat(l,"%, ").concat(this.roundA,")")},s.prototype.toHex=function(n){return n===void 0&&(n=false),kT(this.r,this.g,this.b,n)},s.prototype.toHexString=function(n){return n===void 0&&(n=false),"#"+this.toHex(n)},s.prototype.toHex8=function(n){return n===void 0&&(n=false),EN(this.r,this.g,this.b,this.a,n)},s.prototype.toHex8String=function(n){return n===void 0&&(n=false),"#"+this.toHex8(n)},s.prototype.toHexShortString=function(n){return n===void 0&&(n=false),this.a===1?this.toHexString(n):this.toHex8String(n)},s.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},s.prototype.toRgbString=function(){var n=Math.round(this.r),i=Math.round(this.g),o=Math.round(this.b);return this.a===1?"rgb(".concat(n,", ").concat(i,", ").concat(o,")"):"rgba(".concat(n,", ").concat(i,", ").concat(o,", ").concat(this.roundA,")")},s.prototype.toPercentageRgb=function(){var n=function(i){return"".concat(Math.round(Ds(i,255)*100),"%")};return{r:n(this.r),g:n(this.g),b:n(this.b),a:this.a}},s.prototype.toPercentageRgbString=function(){var n=function(i){return Math.round(Ds(i,255)*100)};return this.a===1?"rgb(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%)"):"rgba(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%, ").concat(this.roundA,")")},s.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return false;for(var n="#"+kT(this.r,this.g,this.b,false),i=0,o=Object.entries(pf);i<o.length;i++){var l=o[i],g=l[0],m=l[1];if(n===m)return g}return false},s.prototype.toString=function(n){var i=!!n;n=n??this.format;var o=false,l=this.a<1&&this.a>=0,g=!i&&l&&(n.startsWith("hex")||n==="name");return g?n==="name"&&this.a===0?this.toName():this.toRgbString():(n==="rgb"&&(o=this.toRgbString()),n==="prgb"&&(o=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(o=this.toHexString()),n==="hex3"&&(o=this.toHexString(true)),n==="hex4"&&(o=this.toHex8String(true)),n==="hex8"&&(o=this.toHex8String()),n==="name"&&(o=this.toName()),n==="hsl"&&(o=this.toHslString()),n==="hsv"&&(o=this.toHsvString()),o||this.toHexString())},s.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},s.prototype.clone=function(){return new s(this.toString())},s.prototype.lighten=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.l+=n/100,i.l=ku(i.l),new s(i)},s.prototype.brighten=function(n){n===void 0&&(n=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(n/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(n/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(n/100)))),new s(i)},s.prototype.darken=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.l-=n/100,i.l=ku(i.l),new s(i)},s.prototype.tint=function(n){return n===void 0&&(n=10),this.mix("white",n)},s.prototype.shade=function(n){return n===void 0&&(n=10),this.mix("black",n)},s.prototype.desaturate=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.s-=n/100,i.s=ku(i.s),new s(i)},s.prototype.saturate=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.s+=n/100,i.s=ku(i.s),new s(i)},s.prototype.greyscale=function(){return this.desaturate(100)},s.prototype.spin=function(n){var i=this.toHsl(),o=(i.h+n)%360;return i.h=o<0?360+o:o,new s(i)},s.prototype.mix=function(n,i){i===void 0&&(i=50);var o=this.toRgb(),l=new s(n).toRgb(),g=i/100,m={r:(l.r-o.r)*g+o.r,g:(l.g-o.g)*g+o.g,b:(l.b-o.b)*g+o.b,a:(l.a-o.a)*g+o.a};return new s(m)},s.prototype.analogous=function(n,i){n===void 0&&(n=6),i===void 0&&(i=30);var o=this.toHsl(),l=360/i,g=[this];for(o.h=(o.h-(l*n>>1)+720)%360;--n;)o.h=(o.h+l)%360,g.push(new s(o));return g},s.prototype.complement=function(){var n=this.toHsl();return n.h=(n.h+180)%360,new s(n)},s.prototype.monochromatic=function(n){n===void 0&&(n=6);for(var i=this.toHsv(),o=i.h,l=i.s,g=i.v,m=[],u=1/n;n--;)m.push(new s({h:o,s:l,v:g})),g=(g+u)%1;return m},s.prototype.splitcomplement=function(){var n=this.toHsl(),i=n.h;return[this,new s({h:(i+72)%360,s:n.s,l:n.l}),new s({h:(i+216)%360,s:n.s,l:n.l})]},s.prototype.onBackground=function(n){var i=this.toRgb(),o=new s(n).toRgb(),l=i.a+o.a*(1-i.a);return new s({r:(i.r*i.a+o.r*o.a*(1-i.a))/l,g:(i.g*i.a+o.g*o.a*(1-i.a))/l,b:(i.b*i.a+o.b*o.a*(1-i.a))/l,a:l})},s.prototype.triad=function(){return this.polyad(3)},s.prototype.tetrad=function(){return this.polyad(4)},s.prototype.polyad=function(n){for(var i=this.toHsl(),o=i.h,l=[this],g=360/n,m=1;m<n;m++)l.push(new s({h:(o+m*g)%360,s:i.s,l:i.l}));return l},s.prototype.equals=function(n){return this.toRgbString()===new s(n).toRgbString()},s}();function gr(s,n=20){return s.mix("#141414",n).toString()}function IN(s){const n=Jf(),i=tr("button");return _e(()=>{let o={},l=s.color;if(l){const g=l.match(/var\((.*?)\)/);g&&(l=window.getComputedStyle(window.document.documentElement).getPropertyValue(g[1]));const m=new RN(l),u=s.dark?m.tint(20).toString():gr(m,20);if(s.plain)o=i.cssVarBlock({"bg-color":s.dark?gr(m,90):m.tint(90).toString(),"text-color":l,"border-color":s.dark?gr(m,50):m.tint(50).toString(),"hover-text-color":`var(${i.cssVarName("color-white")})`,"hover-bg-color":l,"hover-border-color":l,"active-bg-color":u,"active-text-color":`var(${i.cssVarName("color-white")})`,"active-border-color":u}),n.value&&(o[i.cssVarBlockName("disabled-bg-color")]=s.dark?gr(m,90):m.tint(90).toString(),o[i.cssVarBlockName("disabled-text-color")]=s.dark?gr(m,50):m.tint(50).toString(),o[i.cssVarBlockName("disabled-border-color")]=s.dark?gr(m,80):m.tint(80).toString());else{const p=s.dark?gr(m,30):m.tint(30).toString(),c=m.isDark()?`var(${i.cssVarName("color-white")})`:`var(${i.cssVarName("color-black")})`;if(o=i.cssVarBlock({"bg-color":l,"text-color":c,"border-color":l,"hover-bg-color":p,"hover-text-color":c,"hover-border-color":p,"active-bg-color":u,"active-border-color":u}),n.value){const d=s.dark?gr(m,50):m.tint(50).toString();o[i.cssVarBlockName("disabled-bg-color")]=d,o[i.cssVarBlockName("disabled-text-color")]=s.dark?"rgba(255, 255, 255, 0.5)":`var(${i.cssVarName("color-white")})`,o[i.cssVarBlockName("disabled-border-color")]=d}}}return o})}const CN=Xe({name:"ElButton"}),ON=Xe({...CN,props:_f,emits:dN,setup(s,{expose:n,emit:i}){const o=s,l=IN(o),g=tr("button"),{_ref:m,_size:u,_type:p,_disabled:c,_props:d,shouldAddSpace:_,handleClick:b}=cN(o,i),$=_e(()=>[g.b(),g.m(p.value),g.m(u.value),g.is("disabled",c.value),g.is("loading",o.loading),g.is("plain",o.plain),g.is("round",o.round),g.is("circle",o.circle),g.is("text",o.text),g.is("link",o.link),g.is("has-bg",o.bg)]);return n({ref:m,size:u,type:p,disabled:c,shouldAddSpace:_}),(E,y)=>(oe(),Je(ui(E.tag),ca({ref_key:"_ref",ref:m},ue(d),{class:ue($),style:ue(l),onClick:ue(b)}),{default:je(()=>[E.loading?(oe(),be(Pt,{key:0},[E.$slots.loading?Mt(E.$slots,"loading",{key:0}):(oe(),Je(ue(Er),{key:1,class:tt(ue(g).is("loading"))},{default:je(()=>[(oe(),Je(ui(E.loadingIcon)))]),_:1},8,["class"]))],64)):E.icon||E.$slots.icon?(oe(),Je(ue(Er),{key:1},{default:je(()=>[E.icon?(oe(),Je(ui(E.icon),{key:0})):Mt(E.$slots,"icon",{key:1})]),_:3})):qe("v-if",true),E.$slots.default?(oe(),be("span",{key:2,class:tt({[ue(g).em("text","expand")]:ue(_)})},[Mt(E.$slots,"default")],2)):qe("v-if",true)]),_:3},16,["class","style","onClick"]))}});var kN=Sa(ON,[["__file","button.vue"]]);const wN={size:_f.size,type:_f.type},AN=Xe({name:"ElButtonGroup"}),LN=Xe({...AN,props:wN,setup(s){const n=s;rc(h0,Vi({size:cn(n,"size"),type:cn(n,"type")}));const i=tr("button");return(o,l)=>(oe(),be("div",{class:tt(ue(i).b("group"))},[Mt(o.$slots,"default")],2))}});var _0=Sa(LN,[["__file","button-group.vue"]]);const NN=Xf(kN,{ButtonGroup:_0});aL(_0);var ki=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function em(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}const gf="_trap-focus-children",ro=[],AT=s=>{if(ro.length===0)return;const n=ro[ro.length-1][gf];if(n.length>0&&s.code===Kf.tab){if(n.length===1){s.preventDefault(),document.activeElement!==n[0]&&n[0].focus();return}const i=s.shiftKey,o=s.target===n[0],l=s.target===n[n.length-1];o&&i&&(s.preventDefault(),n[n.length-1].focus()),l&&!i&&(s.preventDefault(),n[0].focus())}},MN={beforeMount(s){s[gf]=sT(s),ro.push(s),ro.length<=1&&document.addEventListener("keydown",AT)},updated(s){rs(()=>{s[gf]=sT(s)})},unmounted(){ro.shift(),ro.length===0&&document.removeEventListener("keydown",AT)}},DN=Ta({mask:{type:Boolean,default:true},customMaskEvent:Boolean,overlayClass:{type:$r([String,Array,Object])},zIndex:{type:$r([String,Number])}}),xN={click:s=>s instanceof MouseEvent},BN="overlay";var PN=Xe({name:"ElOverlay",props:DN,emits:xN,setup(s,{slots:n,emit:i}){const o=tr(BN),l=p=>{i("click",p)},{onClick:g,onMousedown:m,onMouseup:u}=e0(s.customMaskEvent?void 0:l);return()=>s.mask?Me("div",{class:[o.b(),s.overlayClass],style:{zIndex:s.zIndex},onClick:g,onMousedown:m,onMouseup:u},[Mt(n,"default")],Hu.STYLE|Hu.CLASS|Hu.PROPS,["onClick","onMouseup","onMousedown"]):Yu("div",{class:s.overlayClass,style:{zIndex:s.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Mt(n,"default")])}});const UN=PN,FN=Xe({name:"ElMessageBox",directives:{TrapFocus:MN},components:{ElButton:NN,ElFocusTrap:lN,ElInput:c0,ElOverlay:UN,ElIcon:Er,...rL},inheritAttrs:false,props:{buttonSize:{type:String,validator:lL},modal:{type:Boolean,default:true},lockScroll:{type:Boolean,default:true},showClose:{type:Boolean,default:true},closeOnClickModal:{type:Boolean,default:true},closeOnPressEscape:{type:Boolean,default:true},closeOnHashChange:{type:Boolean,default:true},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:false,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(s,{emit:n}){const{locale:i,zIndex:o,ns:l,size:g}=ML("message-box",_e(()=>s.buttonSize)),{t:m}=i,{nextZIndex:u}=o,p=Ee(false),c=Vi({autofocus:true,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:false,distinguishCancelAndClose:false,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:true,modalClass:"",showCancelButton:false,showConfirmButton:true,type:"",title:void 0,showInput:false,action:"",confirmButtonLoading:false,cancelButtonLoading:false,confirmButtonLoadingIcon:qu(th),cancelButtonLoadingIcon:qu(th),confirmButtonDisabled:false,editorErrorMessage:"",validateError:false,zIndex:u()}),d=_e(()=>{const K=c.type;return{[l.bm("icon",K)]:K&&_T[K]}}),_=df(),b=df(),$=_e(()=>c.icon||_T[c.type]||""),E=_e(()=>!!c.message),y=Ee(),f=Ee(),v=Ee(),T=Ee(),S=Ee(),R=_e(()=>c.confirmButtonClass);Ct(()=>c.inputValue,async K=>{await rs(),s.boxType==="prompt"&&K!==null&&P()},{immediate:true}),Ct(()=>p.value,K=>{var ee,M;K&&(s.boxType!=="prompt"&&(c.autofocus?v.value=(M=(ee=S.value)==null?void 0:ee.$el)!=null?M:y.value:v.value=y.value),c.zIndex=u()),s.boxType==="prompt"&&(K?rs().then(()=>{var F;T.value&&T.value.$el&&(c.autofocus?v.value=(F=z())!=null?F:y.value:v.value=y.value)}):(c.editorErrorMessage="",c.validateError=false))});const O=_e(()=>s.draggable),A=_e(()=>s.overflow);gL(y,f,O,A),Ws(async()=>{await rs(),s.closeOnHashChange&&window.addEventListener("hashchange",L)}),kr(()=>{s.closeOnHashChange&&window.removeEventListener("hashchange",L)});function L(){p.value&&(p.value=false,rs(()=>{c.action&&n("action",c.action)}))}const I=()=>{s.closeOnClickModal&&U(c.distinguishCancelAndClose?"close":"cancel")},k=e0(I),B=K=>{if(c.inputType!=="textarea")return K.preventDefault(),U("confirm")},U=K=>{var ee;s.boxType==="prompt"&&K==="confirm"&&!P()||(c.action=K,c.beforeClose?(ee=c.beforeClose)==null||ee.call(c,K,c,L):L())},P=()=>{if(s.boxType==="prompt"){const K=c.inputPattern;if(K&&!K.test(c.inputValue||""))return c.editorErrorMessage=c.inputErrorMessage||m("el.messagebox.error"),c.validateError=true,false;const ee=c.inputValidator;if(typeof ee=="function"){const M=ee(c.inputValue);if(M===false)return c.editorErrorMessage=c.inputErrorMessage||m("el.messagebox.error"),c.validateError=true,false;if(typeof M=="string")return c.editorErrorMessage=M,c.validateError=true,false}}return c.editorErrorMessage="",c.validateError=false,true},z=()=>{const K=T.value.$refs;return K.input||K.textarea},W=()=>{U("close")},j=()=>{s.closeOnPressEscape&&W()};return s.lockScroll&&SL(p),{...Ry(c),ns:l,overlayEvent:k,visible:p,hasMessage:E,typeClass:d,contentId:_,inputId:b,btnSize:g,iconComponent:$,confirmButtonClasses:R,rootRef:y,focusStartRef:v,headerRef:f,inputRef:T,confirmRef:S,doClose:L,handleClose:W,onCloseRequested:j,handleWrapperClick:I,handleInputEnter:B,handleAction:U,t:m}}});function GN(s,n,i,o,l,g){const m=ht("el-icon"),u=ht("close"),p=ht("el-input"),c=ht("el-button"),d=ht("el-focus-trap"),_=ht("el-overlay");return oe(),Je(oc,{name:"fade-in-linear",onAfterLeave:b=>s.$emit("vanish"),persisted:""},{default:je(()=>[ci(Me(_,{"z-index":s.zIndex,"overlay-class":[s.ns.is("message-box"),s.modalClass],mask:s.modal},{default:je(()=>[he("div",{role:"dialog","aria-label":s.title,"aria-modal":"true","aria-describedby":s.showInput?void 0:s.contentId,class:tt(`${s.ns.namespace.value}-overlay-message-box`),onClick:s.overlayEvent.onClick,onMousedown:s.overlayEvent.onMousedown,onMouseup:s.overlayEvent.onMouseup},[Me(d,{loop:"",trapped:s.visible,"focus-trap-el":s.rootRef,"focus-start-el":s.focusStartRef,onReleaseRequested:s.onCloseRequested},{default:je(()=>[he("div",{ref:"rootRef",class:tt([s.ns.b(),s.customClass,s.ns.is("draggable",s.draggable),{[s.ns.m("center")]:s.center}]),style:Js(s.customStyle),tabindex:"-1",onClick:Is(()=>{},["stop"])},[s.title!==null&&s.title!==void 0?(oe(),be("div",{key:0,ref:"headerRef",class:tt([s.ns.e("header"),{"show-close":s.showClose}])},[he("div",{class:tt(s.ns.e("title"))},[s.iconComponent&&s.center?(oe(),Je(m,{key:0,class:tt([s.ns.e("status"),s.typeClass])},{default:je(()=>[(oe(),Je(ui(s.iconComponent)))]),_:1},8,["class"])):qe("v-if",true),he("span",null,Bt(s.title),1)],2),s.showClose?(oe(),be("button",{key:0,type:"button",class:tt(s.ns.e("headerbtn")),"aria-label":s.t("el.messagebox.close"),onClick:b=>s.handleAction(s.distinguishCancelAndClose?"close":"cancel"),onKeydown:io(Is(b=>s.handleAction(s.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[Me(m,{class:tt(s.ns.e("close"))},{default:je(()=>[Me(u)]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):qe("v-if",true)],2)):qe("v-if",true),he("div",{id:s.contentId,class:tt(s.ns.e("content"))},[he("div",{class:tt(s.ns.e("container"))},[s.iconComponent&&!s.center&&s.hasMessage?(oe(),Je(m,{key:0,class:tt([s.ns.e("status"),s.typeClass])},{default:je(()=>[(oe(),Je(ui(s.iconComponent)))]),_:1},8,["class"])):qe("v-if",true),s.hasMessage?(oe(),be("div",{key:1,class:tt(s.ns.e("message"))},[Mt(s.$slots,"default",{},()=>[s.dangerouslyUseHTMLString?(oe(),Je(ui(s.showInput?"label":"p"),{key:1,for:s.showInput?s.inputId:void 0,innerHTML:s.message},null,8,["for","innerHTML"])):(oe(),Je(ui(s.showInput?"label":"p"),{key:0,for:s.showInput?s.inputId:void 0},{default:je(()=>[xt(Bt(s.dangerouslyUseHTMLString?"":s.message),1)]),_:1},8,["for"]))])],2)):qe("v-if",true)],2),ci(he("div",{class:tt(s.ns.e("input"))},[Me(p,{id:s.inputId,ref:"inputRef",modelValue:s.inputValue,"onUpdate:modelValue":b=>s.inputValue=b,type:s.inputType,placeholder:s.inputPlaceholder,"aria-invalid":s.validateError,class:tt({invalid:s.validateError}),onKeydown:io(s.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),he("div",{class:tt(s.ns.e("errormsg")),style:Js({visibility:s.editorErrorMessage?"visible":"hidden"})},Bt(s.editorErrorMessage),7)],2),[[Fi,s.showInput]])],10,["id"]),he("div",{class:tt(s.ns.e("btns"))},[s.showCancelButton?(oe(),Je(c,{key:0,loading:s.cancelButtonLoading,"loading-icon":s.cancelButtonLoadingIcon,class:tt([s.cancelButtonClass]),round:s.roundButton,size:s.btnSize,onClick:b=>s.handleAction("cancel"),onKeydown:io(Is(b=>s.handleAction("cancel"),["prevent"]),["enter"])},{default:je(()=>[xt(Bt(s.cancelButtonText||s.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):qe("v-if",true),ci(Me(c,{ref:"confirmRef",type:"primary",loading:s.confirmButtonLoading,"loading-icon":s.confirmButtonLoadingIcon,class:tt([s.confirmButtonClasses]),round:s.roundButton,disabled:s.confirmButtonDisabled,size:s.btnSize,onClick:b=>s.handleAction("confirm"),onKeydown:io(Is(b=>s.handleAction("confirm"),["prevent"]),["enter"])},{default:je(()=>[xt(Bt(s.confirmButtonText||s.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[Fi,s.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[Fi,s.visible]])]),_:3},8,["onAfterLeave"])}var HN=Sa(FN,[["render",GN],["__file","index.vue"]]);const jl=new Map,VN=s=>{let n=document.body;return s.appendTo&&(Sr(s.appendTo)&&(n=document.querySelector(s.appendTo)),uT(s.appendTo)&&(n=s.appendTo),uT(n)||(n=document.body)),n},WN=(s,n,i=null)=>{const o=Me(HN,s,Vl(s.message)||Iy(s.message)?{default:Vl(s.message)?s.message:()=>s.message}:null);return o.appContext=i,Cy(o,n),VN(s).appendChild(n.firstElementChild),o.component},zN=()=>document.createElement("div"),jN=(s,n)=>{const i=zN();s.onVanish=()=>{Cy(null,i),jl.delete(l)},s.onAction=g=>{const m=jl.get(l);let u;s.showInput?u={value:l.inputValue,action:g}:u=g,s.callback?s.callback(u,o.proxy):g==="cancel"||g==="close"?s.distinguishCancelAndClose&&g!=="cancel"?m.reject("close"):m.reject("cancel"):m.resolve(u)};const o=WN(s,i,n),l=o.proxy;for(const g in s)Ju(s,g)&&!Ju(l.$props,g)&&(l[g]=s[g]);return l.visible=true,l};function $a(s,n=null){if(!er)return Promise.reject();let i;return Sr(s)||Iy(s)?s={message:s}:i=s.callback,new Promise((o,l)=>{const g=jN(s,n??$a._context);jl.set(g,{options:s,callback:i,resolve:o,reject:l})})}const XN=["alert","confirm","prompt"],KN={alert:{closeOnPressEscape:false,closeOnClickModal:false},confirm:{showCancelButton:true},prompt:{showCancelButton:true,showInput:true}};XN.forEach(s=>{$a[s]=YN(s)});function YN(s){return(n,i,o,l)=>{let g="";return Wl(i)?(o=i,g=""):Fy(i)?g="":g=i,$a(Object.assign({title:g,message:n,type:"",...KN[s]},o,{boxType:s}),l)}}$a.close=()=>{jl.forEach((s,n)=>{n.doClose()}),jl.clear()};$a._context=null;const mr=$a;mr.install=s=>{mr._context=s._context,s.config.globalProperties.$msgbox=mr,s.config.globalProperties.$messageBox=mr,s.config.globalProperties.$alert=mr.alert,s.config.globalProperties.$confirm=mr.confirm,s.config.globalProperties.$prompt=mr.prompt};const Nl=mr,qN={name:"import"},JN={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:{height:"24px"}};function ZN(s,n,i,o,l,g){return oe(),be("svg",JN,n[0]||(n[0]=[he("path",{fill:"currentColor",d:"M263 383C258.3 387.7 256 393.8 256 400s2.344 12.28 7.031 16.97c9.375 9.375 24.56 9.375 33.94 0l80-80c9.375-9.375 9.375-24.56 0-33.94l-80-80c-9.375-9.375-24.56-9.375-33.94 0s-9.375 24.56 0 33.94L302.1 296H24C10.75 296 0 306.8 0 320s10.75 24 24 24h278.1L263 383zM493.3 93.38l-74.63-74.64C406.6 6.742 390.3 0 373.4 0H192C156.7 0 127.1 28.66 128 64l.0078 168c.002 13.26 10.75 24 24 24s24-10.75 23.1-24L176 64.13c0-8.836 7.162-16 16-16h160L352 128c0 17.67 14.33 32 32 32h79.1v288c0 8.836-7.164 16-16 16H192c-8.838 0-16-7.164-16-16l-.002-40C176 394.7 165.3 384 152 384s-24 10.75-23.1 24L128 448c.002 35.34 28.65 64 64 64H448c35.2 0 64-28.8 64-64V138.6C512 121.7 505.3 105.4 493.3 93.38z"},null,-1)]))}const QN=sr(qN,[["render",ZN]]),eM={},tM={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",style:{height:"24px"},fill:"currentColor"};function sM(s,n){return oe(),be("svg",tM,n[0]||(n[0]=[he("path",{d:"M320 464c8.8 0 16-7.2 16-16V160H256c-17.7 0-32-14.3-32-32V48H64c-8.8 0-16 7.2-16 16V448c0 8.8 7.2 16 16 16H320zM0 64C0 28.7 28.7 0 64 0H229.5c17 0 33.3 6.7 45.3 18.7l90.5 90.5c12 12 18.7 28.3 18.7 45.3V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64z"},null,-1)]))}const iM=sr(eM,[["render",sM]]);/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const nM=4,LT=0,NT=1,rM=2;function ya(s){let n=s.length;for(;--n>=0;)s[n]=0}const oM=0,p0=1,aM=2,lM=3,cM=258,tm=29,lc=256,Xl=lc+1+tm,ua=30,sm=19,g0=2*Xl+1,oo=15,np=16,uM=7,im=256,f0=16,m0=17,E0=18,ff=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Wu=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),hM=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),v0=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dM=512,Kn=new Array((Xl+2)*2);ya(Kn);const Pl=new Array(ua*2);ya(Pl);const Kl=new Array(dM);ya(Kl);const Yl=new Array(cM-lM+1);ya(Yl);const nm=new Array(tm);ya(nm);const nh=new Array(ua);ya(nh);function rp(s,n,i,o,l){this.static_tree=s,this.extra_bits=n,this.extra_base=i,this.elems=o,this.max_length=l,this.has_stree=s&&s.length}let b0,T0,S0;function op(s,n){this.dyn_tree=s,this.max_code=0,this.stat_desc=n}const $0=s=>s<256?Kl[s]:Kl[256+(s>>>7)],ql=(s,n)=>{s.pending_buf[s.pending++]=n&255,s.pending_buf[s.pending++]=n>>>8&255},hi=(s,n,i)=>{s.bi_valid>np-i?(s.bi_buf|=n<<s.bi_valid&65535,ql(s,s.bi_buf),s.bi_buf=n>>np-s.bi_valid,s.bi_valid+=i-np):(s.bi_buf|=n<<s.bi_valid&65535,s.bi_valid+=i)},Cn=(s,n,i)=>{hi(s,i[n*2],i[n*2+1])},y0=(s,n)=>{let i=0;do i|=s&1,s>>>=1,i<<=1;while(--n>0);return i>>>1},_M=s=>{s.bi_valid===16?(ql(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0):s.bi_valid>=8&&(s.pending_buf[s.pending++]=s.bi_buf&255,s.bi_buf>>=8,s.bi_valid-=8)},pM=(s,n)=>{const i=n.dyn_tree,o=n.max_code,l=n.stat_desc.static_tree,g=n.stat_desc.has_stree,m=n.stat_desc.extra_bits,u=n.stat_desc.extra_base,p=n.stat_desc.max_length;let c,d,_,b,$,E,y=0;for(b=0;b<=oo;b++)s.bl_count[b]=0;for(i[s.heap[s.heap_max]*2+1]=0,c=s.heap_max+1;c<g0;c++)d=s.heap[c],b=i[i[d*2+1]*2+1]+1,b>p&&(b=p,y++),i[d*2+1]=b,!(d>o)&&(s.bl_count[b]++,$=0,d>=u&&($=m[d-u]),E=i[d*2],s.opt_len+=E*(b+$),g&&(s.static_len+=E*(l[d*2+1]+$)));if(y!==0){do{for(b=p-1;s.bl_count[b]===0;)b--;s.bl_count[b]--,s.bl_count[b+1]+=2,s.bl_count[p]--,y-=2}while(y>0);for(b=p;b!==0;b--)for(d=s.bl_count[b];d!==0;)_=s.heap[--c],!(_>o)&&(i[_*2+1]!==b&&(s.opt_len+=(b-i[_*2+1])*i[_*2],i[_*2+1]=b),d--)}},R0=(s,n,i)=>{const o=new Array(oo+1);let l=0,g,m;for(g=1;g<=oo;g++)l=l+i[g-1]<<1,o[g]=l;for(m=0;m<=n;m++){let u=s[m*2+1];u!==0&&(s[m*2]=y0(o[u]++,u))}},gM=()=>{let s,n,i,o,l;const g=new Array(oo+1);for(i=0,o=0;o<tm-1;o++)for(nm[o]=i,s=0;s<1<<ff[o];s++)Yl[i++]=o;for(Yl[i-1]=o,l=0,o=0;o<16;o++)for(nh[o]=l,s=0;s<1<<Wu[o];s++)Kl[l++]=o;for(l>>=7;o<ua;o++)for(nh[o]=l<<7,s=0;s<1<<Wu[o]-7;s++)Kl[256+l++]=o;for(n=0;n<=oo;n++)g[n]=0;for(s=0;s<=143;)Kn[s*2+1]=8,s++,g[8]++;for(;s<=255;)Kn[s*2+1]=9,s++,g[9]++;for(;s<=279;)Kn[s*2+1]=7,s++,g[7]++;for(;s<=287;)Kn[s*2+1]=8,s++,g[8]++;for(R0(Kn,Xl+1,g),s=0;s<ua;s++)Pl[s*2+1]=5,Pl[s*2]=y0(s,5);b0=new rp(Kn,ff,lc+1,Xl,oo),T0=new rp(Pl,Wu,0,ua,oo),S0=new rp(new Array(0),hM,0,sm,uM)},I0=s=>{let n;for(n=0;n<Xl;n++)s.dyn_ltree[n*2]=0;for(n=0;n<ua;n++)s.dyn_dtree[n*2]=0;for(n=0;n<sm;n++)s.bl_tree[n*2]=0;s.dyn_ltree[im*2]=1,s.opt_len=s.static_len=0,s.sym_next=s.matches=0},C0=s=>{s.bi_valid>8?ql(s,s.bi_buf):s.bi_valid>0&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0},MT=(s,n,i,o)=>{const l=n*2,g=i*2;return s[l]<s[g]||s[l]===s[g]&&o[n]<=o[i]},ap=(s,n,i)=>{const o=s.heap[i];let l=i<<1;for(;l<=s.heap_len&&(l<s.heap_len&&MT(n,s.heap[l+1],s.heap[l],s.depth)&&l++,!MT(n,o,s.heap[l],s.depth));)s.heap[i]=s.heap[l],i=l,l<<=1;s.heap[i]=o},DT=(s,n,i)=>{let o,l,g=0,m,u;if(s.sym_next!==0)do o=s.pending_buf[s.sym_buf+g++]&255,o+=(s.pending_buf[s.sym_buf+g++]&255)<<8,l=s.pending_buf[s.sym_buf+g++],o===0?Cn(s,l,n):(m=Yl[l],Cn(s,m+lc+1,n),u=ff[m],u!==0&&(l-=nm[m],hi(s,l,u)),o--,m=$0(o),Cn(s,m,i),u=Wu[m],u!==0&&(o-=nh[m],hi(s,o,u)));while(g<s.sym_next);Cn(s,im,n)},mf=(s,n)=>{const i=n.dyn_tree,o=n.stat_desc.static_tree,l=n.stat_desc.has_stree,g=n.stat_desc.elems;let m,u,p=-1,c;for(s.heap_len=0,s.heap_max=g0,m=0;m<g;m++)i[m*2]!==0?(s.heap[++s.heap_len]=p=m,s.depth[m]=0):i[m*2+1]=0;for(;s.heap_len<2;)c=s.heap[++s.heap_len]=p<2?++p:0,i[c*2]=1,s.depth[c]=0,s.opt_len--,l&&(s.static_len-=o[c*2+1]);for(n.max_code=p,m=s.heap_len>>1;m>=1;m--)ap(s,i,m);c=g;do m=s.heap[1],s.heap[1]=s.heap[s.heap_len--],ap(s,i,1),u=s.heap[1],s.heap[--s.heap_max]=m,s.heap[--s.heap_max]=u,i[c*2]=i[m*2]+i[u*2],s.depth[c]=(s.depth[m]>=s.depth[u]?s.depth[m]:s.depth[u])+1,i[m*2+1]=i[u*2+1]=c,s.heap[1]=c++,ap(s,i,1);while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1],pM(s,n),R0(i,p,s.bl_count)},xT=(s,n,i)=>{let o,l=-1,g,m=n[0*2+1],u=0,p=7,c=4;for(m===0&&(p=138,c=3),n[(i+1)*2+1]=65535,o=0;o<=i;o++)g=m,m=n[(o+1)*2+1],!(++u<p&&g===m)&&(u<c?s.bl_tree[g*2]+=u:g!==0?(g!==l&&s.bl_tree[g*2]++,s.bl_tree[f0*2]++):u<=10?s.bl_tree[m0*2]++:s.bl_tree[E0*2]++,u=0,l=g,m===0?(p=138,c=3):g===m?(p=6,c=3):(p=7,c=4))},BT=(s,n,i)=>{let o,l=-1,g,m=n[0*2+1],u=0,p=7,c=4;for(m===0&&(p=138,c=3),o=0;o<=i;o++)if(g=m,m=n[(o+1)*2+1],!(++u<p&&g===m)){if(u<c)do Cn(s,g,s.bl_tree);while(--u!==0);else g!==0?(g!==l&&(Cn(s,g,s.bl_tree),u--),Cn(s,f0,s.bl_tree),hi(s,u-3,2)):u<=10?(Cn(s,m0,s.bl_tree),hi(s,u-3,3)):(Cn(s,E0,s.bl_tree),hi(s,u-11,7));u=0,l=g,m===0?(p=138,c=3):g===m?(p=6,c=3):(p=7,c=4)}},fM=s=>{let n;for(xT(s,s.dyn_ltree,s.l_desc.max_code),xT(s,s.dyn_dtree,s.d_desc.max_code),mf(s,s.bl_desc),n=sm-1;n>=3&&s.bl_tree[v0[n]*2+1]===0;n--);return s.opt_len+=3*(n+1)+5+5+4,n},mM=(s,n,i,o)=>{let l;for(hi(s,n-257,5),hi(s,i-1,5),hi(s,o-4,4),l=0;l<o;l++)hi(s,s.bl_tree[v0[l]*2+1],3);BT(s,s.dyn_ltree,n-1),BT(s,s.dyn_dtree,i-1)},EM=s=>{let n=4093624447,i;for(i=0;i<=31;i++,n>>>=1)if(n&1&&s.dyn_ltree[i*2]!==0)return LT;if(s.dyn_ltree[9*2]!==0||s.dyn_ltree[10*2]!==0||s.dyn_ltree[13*2]!==0)return NT;for(i=32;i<lc;i++)if(s.dyn_ltree[i*2]!==0)return NT;return LT};let PT=false;const vM=s=>{PT||(gM(),PT=true),s.l_desc=new op(s.dyn_ltree,b0),s.d_desc=new op(s.dyn_dtree,T0),s.bl_desc=new op(s.bl_tree,S0),s.bi_buf=0,s.bi_valid=0,I0(s)},O0=(s,n,i,o)=>{hi(s,(oM<<1)+(o?1:0),3),C0(s),ql(s,i),ql(s,~i),i&&s.pending_buf.set(s.window.subarray(n,n+i),s.pending),s.pending+=i},bM=s=>{hi(s,p0<<1,3),Cn(s,im,Kn),_M(s)},TM=(s,n,i,o)=>{let l,g,m=0;s.level>0?(s.strm.data_type===rM&&(s.strm.data_type=EM(s)),mf(s,s.l_desc),mf(s,s.d_desc),m=fM(s),l=s.opt_len+3+7>>>3,g=s.static_len+3+7>>>3,g<=l&&(l=g)):l=g=i+5,i+4<=l&&n!==-1?O0(s,n,i,o):s.strategy===nM||g===l?(hi(s,(p0<<1)+(o?1:0),3),DT(s,Kn,Pl)):(hi(s,(aM<<1)+(o?1:0),3),mM(s,s.l_desc.max_code+1,s.d_desc.max_code+1,m+1),DT(s,s.dyn_ltree,s.dyn_dtree)),I0(s),o&&C0(s)},SM=(s,n,i)=>(s.pending_buf[s.sym_buf+s.sym_next++]=n,s.pending_buf[s.sym_buf+s.sym_next++]=n>>8,s.pending_buf[s.sym_buf+s.sym_next++]=i,n===0?s.dyn_ltree[i*2]++:(s.matches++,n--,s.dyn_ltree[(Yl[i]+lc+1)*2]++,s.dyn_dtree[$0(n)*2]++),s.sym_next===s.sym_end);var $M=vM,yM=O0,RM=TM,IM=SM,CM=bM,OM={_tr_init:$M,_tr_stored_block:yM,_tr_flush_block:RM,_tr_tally:IM,_tr_align:CM};const kM=(s,n,i,o)=>{let l=s&65535|0,g=s>>>16&65535|0,m=0;for(;i!==0;){m=i>2e3?2e3:i,i-=m;do l=l+n[o++]|0,g=g+l|0;while(--m);l%=65521,g%=65521}return l|g<<16|0};var Jl=kM;const wM=()=>{let s,n=[];for(var i=0;i<256;i++){s=i;for(var o=0;o<8;o++)s=s&1?3988292384^s>>>1:s>>>1;n[i]=s}return n},AM=new Uint32Array(wM()),LM=(s,n,i,o)=>{const l=AM,g=o+i;s^=-1;for(let m=o;m<g;m++)s=s>>>8^l[(s^n[m])&255];return s^-1};var Rs=LM,ho={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ra={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:NM,_tr_stored_block:Ef,_tr_flush_block:MM,_tr_tally:yr,_tr_align:DM}=OM,{Z_NO_FLUSH:Rr,Z_PARTIAL_FLUSH:xM,Z_FULL_FLUSH:BM,Z_FINISH:Gi,Z_BLOCK:UT,Z_OK:Ms,Z_STREAM_END:FT,Z_STREAM_ERROR:On,Z_DATA_ERROR:PM,Z_BUF_ERROR:lp,Z_DEFAULT_COMPRESSION:UM,Z_FILTERED:FM,Z_HUFFMAN_ONLY:Au,Z_RLE:GM,Z_FIXED:HM,Z_DEFAULT_STRATEGY:VM,Z_UNKNOWN:WM,Z_DEFLATED:gh}=Ra,zM=9,jM=15,XM=8,KM=29,YM=256,vf=YM+1+KM,qM=30,JM=19,ZM=2*vf+1,QM=15,vt=3,Tr=258,kn=Tr+vt+1,e1=32,ha=42,rm=57,bf=69,Tf=73,Sf=91,$f=103,ao=113,Ml=666,Qs=1,Ia=2,_o=3,Ca=4,t1=3,lo=(s,n)=>(s.msg=ho[n],n),GT=s=>s*2-(s>4?9:0),vr=s=>{let n=s.length;for(;--n>=0;)s[n]=0},s1=s=>{let n,i,o,l=s.w_size;n=s.hash_size,o=n;do i=s.head[--o],s.head[o]=i>=l?i-l:0;while(--n);n=l,o=n;do i=s.prev[--o],s.prev[o]=i>=l?i-l:0;while(--n)};let i1=(s,n,i)=>(n<<s.hash_shift^i)&s.hash_mask,Ir=i1;const Ci=s=>{const n=s.state;let i=n.pending;i>s.avail_out&&(i=s.avail_out),i!==0&&(s.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+i),s.next_out),s.next_out+=i,n.pending_out+=i,s.total_out+=i,s.avail_out-=i,n.pending-=i,n.pending===0&&(n.pending_out=0))},Oi=(s,n)=>{MM(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,n),s.block_start=s.strstart,Ci(s.strm)},Lt=(s,n)=>{s.pending_buf[s.pending++]=n},Al=(s,n)=>{s.pending_buf[s.pending++]=n>>>8&255,s.pending_buf[s.pending++]=n&255},yf=(s,n,i,o)=>{let l=s.avail_in;return l>o&&(l=o),l===0?0:(s.avail_in-=l,n.set(s.input.subarray(s.next_in,s.next_in+l),i),s.state.wrap===1?s.adler=Jl(s.adler,n,l,i):s.state.wrap===2&&(s.adler=Rs(s.adler,n,l,i)),s.next_in+=l,s.total_in+=l,l)},k0=(s,n)=>{let i=s.max_chain_length,o=s.strstart,l,g,m=s.prev_length,u=s.nice_match;const p=s.strstart>s.w_size-kn?s.strstart-(s.w_size-kn):0,c=s.window,d=s.w_mask,_=s.prev,b=s.strstart+Tr;let $=c[o+m-1],E=c[o+m];s.prev_length>=s.good_match&&(i>>=2),u>s.lookahead&&(u=s.lookahead);do if(l=n,!(c[l+m]!==E||c[l+m-1]!==$||c[l]!==c[o]||c[++l]!==c[o+1])){o+=2,l++;do;while(c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&o<b);if(g=Tr-(b-o),o=b-Tr,g>m){if(s.match_start=n,m=g,g>=u)break;$=c[o+m-1],E=c[o+m]}}while((n=_[n&d])>p&&--i!==0);return m<=s.lookahead?m:s.lookahead},da=s=>{const n=s.w_size;let i,o,l;do{if(o=s.window_size-s.lookahead-s.strstart,s.strstart>=n+(n-kn)&&(s.window.set(s.window.subarray(n,n+n-o),0),s.match_start-=n,s.strstart-=n,s.block_start-=n,s.insert>s.strstart&&(s.insert=s.strstart),s1(s),o+=n),s.strm.avail_in===0)break;if(i=yf(s.strm,s.window,s.strstart+s.lookahead,o),s.lookahead+=i,s.lookahead+s.insert>=vt)for(l=s.strstart-s.insert,s.ins_h=s.window[l],s.ins_h=Ir(s,s.ins_h,s.window[l+1]);s.insert&&(s.ins_h=Ir(s,s.ins_h,s.window[l+vt-1]),s.prev[l&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=l,l++,s.insert--,!(s.lookahead+s.insert<vt)););}while(s.lookahead<kn&&s.strm.avail_in!==0)},w0=(s,n)=>{let i=s.pending_buf_size-5>s.w_size?s.w_size:s.pending_buf_size-5,o,l,g,m=0,u=s.strm.avail_in;do{if(o=65535,g=s.bi_valid+42>>3,s.strm.avail_out<g||(g=s.strm.avail_out-g,l=s.strstart-s.block_start,o>l+s.strm.avail_in&&(o=l+s.strm.avail_in),o>g&&(o=g),o<i&&(o===0&&n!==Gi||n===Rr||o!==l+s.strm.avail_in)))break;m=n===Gi&&o===l+s.strm.avail_in?1:0,Ef(s,0,0,m),s.pending_buf[s.pending-4]=o,s.pending_buf[s.pending-3]=o>>8,s.pending_buf[s.pending-2]=~o,s.pending_buf[s.pending-1]=~o>>8,Ci(s.strm),l&&(l>o&&(l=o),s.strm.output.set(s.window.subarray(s.block_start,s.block_start+l),s.strm.next_out),s.strm.next_out+=l,s.strm.avail_out-=l,s.strm.total_out+=l,s.block_start+=l,o-=l),o&&(yf(s.strm,s.strm.output,s.strm.next_out,o),s.strm.next_out+=o,s.strm.avail_out-=o,s.strm.total_out+=o)}while(m===0);return u-=s.strm.avail_in,u&&(u>=s.w_size?(s.matches=2,s.window.set(s.strm.input.subarray(s.strm.next_in-s.w_size,s.strm.next_in),0),s.strstart=s.w_size,s.insert=s.strstart):(s.window_size-s.strstart<=u&&(s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,s.insert>s.strstart&&(s.insert=s.strstart)),s.window.set(s.strm.input.subarray(s.strm.next_in-u,s.strm.next_in),s.strstart),s.strstart+=u,s.insert+=u>s.w_size-s.insert?s.w_size-s.insert:u),s.block_start=s.strstart),s.high_water<s.strstart&&(s.high_water=s.strstart),m?Ca:n!==Rr&&n!==Gi&&s.strm.avail_in===0&&s.strstart===s.block_start?Ia:(g=s.window_size-s.strstart,s.strm.avail_in>g&&s.block_start>=s.w_size&&(s.block_start-=s.w_size,s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,g+=s.w_size,s.insert>s.strstart&&(s.insert=s.strstart)),g>s.strm.avail_in&&(g=s.strm.avail_in),g&&(yf(s.strm,s.window,s.strstart,g),s.strstart+=g,s.insert+=g>s.w_size-s.insert?s.w_size-s.insert:g),s.high_water<s.strstart&&(s.high_water=s.strstart),g=s.bi_valid+42>>3,g=s.pending_buf_size-g>65535?65535:s.pending_buf_size-g,i=g>s.w_size?s.w_size:g,l=s.strstart-s.block_start,(l>=i||(l||n===Gi)&&n!==Rr&&s.strm.avail_in===0&&l<=g)&&(o=l>g?g:l,m=n===Gi&&s.strm.avail_in===0&&o===l?1:0,Ef(s,s.block_start,o,m),s.block_start+=o,Ci(s.strm)),m?_o:Qs)},cp=(s,n)=>{let i,o;for(;;){if(s.lookahead<kn){if(da(s),s.lookahead<kn&&n===Rr)return Qs;if(s.lookahead===0)break}if(i=0,s.lookahead>=vt&&(s.ins_h=Ir(s,s.ins_h,s.window[s.strstart+vt-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),i!==0&&s.strstart-i<=s.w_size-kn&&(s.match_length=k0(s,i)),s.match_length>=vt)if(o=yr(s,s.strstart-s.match_start,s.match_length-vt),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=vt){s.match_length--;do s.strstart++,s.ins_h=Ir(s,s.ins_h,s.window[s.strstart+vt-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart;while(--s.match_length!==0);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=Ir(s,s.ins_h,s.window[s.strstart+1]);else o=yr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(o&&(Oi(s,false),s.strm.avail_out===0))return Qs}return s.insert=s.strstart<vt-1?s.strstart:vt-1,n===Gi?(Oi(s,true),s.strm.avail_out===0?_o:Ca):s.sym_next&&(Oi(s,false),s.strm.avail_out===0)?Qs:Ia},oa=(s,n)=>{let i,o,l;for(;;){if(s.lookahead<kn){if(da(s),s.lookahead<kn&&n===Rr)return Qs;if(s.lookahead===0)break}if(i=0,s.lookahead>=vt&&(s.ins_h=Ir(s,s.ins_h,s.window[s.strstart+vt-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=vt-1,i!==0&&s.prev_length<s.max_lazy_match&&s.strstart-i<=s.w_size-kn&&(s.match_length=k0(s,i),s.match_length<=5&&(s.strategy===FM||s.match_length===vt&&s.strstart-s.match_start>4096)&&(s.match_length=vt-1)),s.prev_length>=vt&&s.match_length<=s.prev_length){l=s.strstart+s.lookahead-vt,o=yr(s,s.strstart-1-s.prev_match,s.prev_length-vt),s.lookahead-=s.prev_length-1,s.prev_length-=2;do++s.strstart<=l&&(s.ins_h=Ir(s,s.ins_h,s.window[s.strstart+vt-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart);while(--s.prev_length!==0);if(s.match_available=0,s.match_length=vt-1,s.strstart++,o&&(Oi(s,false),s.strm.avail_out===0))return Qs}else if(s.match_available){if(o=yr(s,0,s.window[s.strstart-1]),o&&Oi(s,false),s.strstart++,s.lookahead--,s.strm.avail_out===0)return Qs}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(o=yr(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<vt-1?s.strstart:vt-1,n===Gi?(Oi(s,true),s.strm.avail_out===0?_o:Ca):s.sym_next&&(Oi(s,false),s.strm.avail_out===0)?Qs:Ia},n1=(s,n)=>{let i,o,l,g;const m=s.window;for(;;){if(s.lookahead<=Tr){if(da(s),s.lookahead<=Tr&&n===Rr)return Qs;if(s.lookahead===0)break}if(s.match_length=0,s.lookahead>=vt&&s.strstart>0&&(l=s.strstart-1,o=m[l],o===m[++l]&&o===m[++l]&&o===m[++l])){g=s.strstart+Tr;do;while(o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&l<g);s.match_length=Tr-(g-l),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=vt?(i=yr(s,1,s.match_length-vt),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(i=yr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),i&&(Oi(s,false),s.strm.avail_out===0))return Qs}return s.insert=0,n===Gi?(Oi(s,true),s.strm.avail_out===0?_o:Ca):s.sym_next&&(Oi(s,false),s.strm.avail_out===0)?Qs:Ia},r1=(s,n)=>{let i;for(;;){if(s.lookahead===0&&(da(s),s.lookahead===0)){if(n===Rr)return Qs;break}if(s.match_length=0,i=yr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,i&&(Oi(s,false),s.strm.avail_out===0))return Qs}return s.insert=0,n===Gi?(Oi(s,true),s.strm.avail_out===0?_o:Ca):s.sym_next&&(Oi(s,false),s.strm.avail_out===0)?Qs:Ia};function Rn(s,n,i,o,l){this.good_length=s,this.max_lazy=n,this.nice_length=i,this.max_chain=o,this.func=l}const Dl=[new Rn(0,0,0,0,w0),new Rn(4,4,8,4,cp),new Rn(4,5,16,8,cp),new Rn(4,6,32,32,cp),new Rn(4,4,16,16,oa),new Rn(8,16,32,32,oa),new Rn(8,16,128,128,oa),new Rn(8,32,128,256,oa),new Rn(32,128,258,1024,oa),new Rn(32,258,258,4096,oa)],o1=s=>{s.window_size=2*s.w_size,vr(s.head),s.max_lazy_match=Dl[s.level].max_lazy,s.good_match=Dl[s.level].good_length,s.nice_match=Dl[s.level].nice_length,s.max_chain_length=Dl[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=vt-1,s.match_available=0,s.ins_h=0};function a1(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=gh,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(ZM*2),this.dyn_dtree=new Uint16Array((2*qM+1)*2),this.bl_tree=new Uint16Array((2*JM+1)*2),vr(this.dyn_ltree),vr(this.dyn_dtree),vr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(QM+1),this.heap=new Uint16Array(2*vf+1),vr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*vf+1),vr(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const cc=s=>{if(!s)return 1;const n=s.state;return!n||n.strm!==s||n.status!==ha&&n.status!==rm&&n.status!==bf&&n.status!==Tf&&n.status!==Sf&&n.status!==$f&&n.status!==ao&&n.status!==Ml?1:0},A0=s=>{if(cc(s))return lo(s,On);s.total_in=s.total_out=0,s.data_type=WM;const n=s.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?rm:n.wrap?ha:ao,s.adler=n.wrap===2?0:1,n.last_flush=-2,NM(n),Ms},L0=s=>{const n=A0(s);return n===Ms&&o1(s.state),n},l1=(s,n)=>cc(s)||s.state.wrap!==2?On:(s.state.gzhead=n,Ms),N0=(s,n,i,o,l,g)=>{if(!s)return On;let m=1;if(n===UM&&(n=6),o<0?(m=0,o=-o):o>15&&(m=2,o-=16),l<1||l>zM||i!==gh||o<8||o>15||n<0||n>9||g<0||g>HM||o===8&&m!==1)return lo(s,On);o===8&&(o=9);const u=new a1;return s.state=u,u.strm=s,u.status=ha,u.wrap=m,u.gzhead=null,u.w_bits=o,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=l+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+vt-1)/vt),u.window=new Uint8Array(u.w_size*2),u.head=new Uint16Array(u.hash_size),u.prev=new Uint16Array(u.w_size),u.lit_bufsize=1<<l+6,u.pending_buf_size=u.lit_bufsize*4,u.pending_buf=new Uint8Array(u.pending_buf_size),u.sym_buf=u.lit_bufsize,u.sym_end=(u.lit_bufsize-1)*3,u.level=n,u.strategy=g,u.method=i,L0(s)},c1=(s,n)=>N0(s,n,gh,jM,XM,VM),u1=(s,n)=>{if(cc(s)||n>UT||n<0)return s?lo(s,On):On;const i=s.state;if(!s.output||s.avail_in!==0&&!s.input||i.status===Ml&&n!==Gi)return lo(s,s.avail_out===0?lp:On);const o=i.last_flush;if(i.last_flush=n,i.pending!==0){if(Ci(s),s.avail_out===0)return i.last_flush=-1,Ms}else if(s.avail_in===0&&GT(n)<=GT(o)&&n!==Gi)return lo(s,lp);if(i.status===Ml&&s.avail_in!==0)return lo(s,lp);if(i.status===ha&&i.wrap===0&&(i.status=ao),i.status===ha){let l=gh+(i.w_bits-8<<4)<<8,g=-1;if(i.strategy>=Au||i.level<2?g=0:i.level<6?g=1:i.level===6?g=2:g=3,l|=g<<6,i.strstart!==0&&(l|=e1),l+=31-l%31,Al(i,l),i.strstart!==0&&(Al(i,s.adler>>>16),Al(i,s.adler&65535)),s.adler=1,i.status=ao,Ci(s),i.pending!==0)return i.last_flush=-1,Ms}if(i.status===rm){if(s.adler=0,Lt(i,31),Lt(i,139),Lt(i,8),i.gzhead)Lt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Lt(i,i.gzhead.time&255),Lt(i,i.gzhead.time>>8&255),Lt(i,i.gzhead.time>>16&255),Lt(i,i.gzhead.time>>24&255),Lt(i,i.level===9?2:i.strategy>=Au||i.level<2?4:0),Lt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Lt(i,i.gzhead.extra.length&255),Lt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(s.adler=Rs(s.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=bf;else if(Lt(i,0),Lt(i,0),Lt(i,0),Lt(i,0),Lt(i,0),Lt(i,i.level===9?2:i.strategy>=Au||i.level<2?4:0),Lt(i,t1),i.status=ao,Ci(s),i.pending!==0)return i.last_flush=-1,Ms}if(i.status===bf){if(i.gzhead.extra){let l=i.pending,g=(i.gzhead.extra.length&65535)-i.gzindex;for(;i.pending+g>i.pending_buf_size;){let u=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+u),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>l&&(s.adler=Rs(s.adler,i.pending_buf,i.pending-l,l)),i.gzindex+=u,Ci(s),i.pending!==0)return i.last_flush=-1,Ms;l=0,g-=u}let m=new Uint8Array(i.gzhead.extra);i.pending_buf.set(m.subarray(i.gzindex,i.gzindex+g),i.pending),i.pending+=g,i.gzhead.hcrc&&i.pending>l&&(s.adler=Rs(s.adler,i.pending_buf,i.pending-l,l)),i.gzindex=0}i.status=Tf}if(i.status===Tf){if(i.gzhead.name){let l=i.pending,g;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>l&&(s.adler=Rs(s.adler,i.pending_buf,i.pending-l,l)),Ci(s),i.pending!==0)return i.last_flush=-1,Ms;l=0}i.gzindex<i.gzhead.name.length?g=i.gzhead.name.charCodeAt(i.gzindex++)&255:g=0,Lt(i,g)}while(g!==0);i.gzhead.hcrc&&i.pending>l&&(s.adler=Rs(s.adler,i.pending_buf,i.pending-l,l)),i.gzindex=0}i.status=Sf}if(i.status===Sf){if(i.gzhead.comment){let l=i.pending,g;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>l&&(s.adler=Rs(s.adler,i.pending_buf,i.pending-l,l)),Ci(s),i.pending!==0)return i.last_flush=-1,Ms;l=0}i.gzindex<i.gzhead.comment.length?g=i.gzhead.comment.charCodeAt(i.gzindex++)&255:g=0,Lt(i,g)}while(g!==0);i.gzhead.hcrc&&i.pending>l&&(s.adler=Rs(s.adler,i.pending_buf,i.pending-l,l))}i.status=$f}if(i.status===$f){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Ci(s),i.pending!==0))return i.last_flush=-1,Ms;Lt(i,s.adler&255),Lt(i,s.adler>>8&255),s.adler=0}if(i.status=ao,Ci(s),i.pending!==0)return i.last_flush=-1,Ms}if(s.avail_in!==0||i.lookahead!==0||n!==Rr&&i.status!==Ml){let l=i.level===0?w0(i,n):i.strategy===Au?r1(i,n):i.strategy===GM?n1(i,n):Dl[i.level].func(i,n);if((l===_o||l===Ca)&&(i.status=Ml),l===Qs||l===_o)return s.avail_out===0&&(i.last_flush=-1),Ms;if(l===Ia&&(n===xM?DM(i):n!==UT&&(Ef(i,0,0,false),n===BM&&(vr(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Ci(s),s.avail_out===0))return i.last_flush=-1,Ms}return n!==Gi?Ms:i.wrap<=0?FT:(i.wrap===2?(Lt(i,s.adler&255),Lt(i,s.adler>>8&255),Lt(i,s.adler>>16&255),Lt(i,s.adler>>24&255),Lt(i,s.total_in&255),Lt(i,s.total_in>>8&255),Lt(i,s.total_in>>16&255),Lt(i,s.total_in>>24&255)):(Al(i,s.adler>>>16),Al(i,s.adler&65535)),Ci(s),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Ms:FT)},h1=s=>{if(cc(s))return On;const n=s.state.status;return s.state=null,n===ao?lo(s,PM):Ms},d1=(s,n)=>{let i=n.length;if(cc(s))return On;const o=s.state,l=o.wrap;if(l===2||l===1&&o.status!==ha||o.lookahead)return On;if(l===1&&(s.adler=Jl(s.adler,n,i,0)),o.wrap=0,i>=o.w_size){l===0&&(vr(o.head),o.strstart=0,o.block_start=0,o.insert=0);let p=new Uint8Array(o.w_size);p.set(n.subarray(i-o.w_size,i),0),n=p,i=o.w_size}const g=s.avail_in,m=s.next_in,u=s.input;for(s.avail_in=i,s.next_in=0,s.input=n,da(o);o.lookahead>=vt;){let p=o.strstart,c=o.lookahead-(vt-1);do o.ins_h=Ir(o,o.ins_h,o.window[p+vt-1]),o.prev[p&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=p,p++;while(--c);o.strstart=p,o.lookahead=vt-1,da(o)}return o.strstart+=o.lookahead,o.block_start=o.strstart,o.insert=o.lookahead,o.lookahead=0,o.match_length=o.prev_length=vt-1,o.match_available=0,s.next_in=m,s.input=u,s.avail_in=g,o.wrap=l,Ms};var _1=c1,p1=N0,g1=L0,f1=A0,m1=l1,E1=u1,v1=h1,b1=d1,T1="pako deflate (from Nodeca project)",Ul={deflateInit:_1,deflateInit2:p1,deflateReset:g1,deflateResetKeep:f1,deflateSetHeader:m1,deflate:E1,deflateEnd:v1,deflateSetDictionary:b1,deflateInfo:T1};const S1=(s,n)=>Object.prototype.hasOwnProperty.call(s,n);var $1=function(s){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const i=n.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(const o in i)S1(i,o)&&(s[o]=i[o])}}return s},y1=s=>{let n=0;for(let o=0,l=s.length;o<l;o++)n+=s[o].length;const i=new Uint8Array(n);for(let o=0,l=0,g=s.length;o<g;o++){let m=s[o];i.set(m,l),l+=m.length}return i},fh={assign:$1,flattenChunks:y1};let M0=true;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{M0=false}const Zl=new Uint8Array(256);for(let s=0;s<256;s++)Zl[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;Zl[254]=Zl[254]=1;var R1=s=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(s);let n,i,o,l,g,m=s.length,u=0;for(l=0;l<m;l++)i=s.charCodeAt(l),(i&64512)===55296&&l+1<m&&(o=s.charCodeAt(l+1),(o&64512)===56320&&(i=65536+(i-55296<<10)+(o-56320),l++)),u+=i<128?1:i<2048?2:i<65536?3:4;for(n=new Uint8Array(u),g=0,l=0;g<u;l++)i=s.charCodeAt(l),(i&64512)===55296&&l+1<m&&(o=s.charCodeAt(l+1),(o&64512)===56320&&(i=65536+(i-55296<<10)+(o-56320),l++)),i<128?n[g++]=i:i<2048?(n[g++]=192|i>>>6,n[g++]=128|i&63):i<65536?(n[g++]=224|i>>>12,n[g++]=128|i>>>6&63,n[g++]=128|i&63):(n[g++]=240|i>>>18,n[g++]=128|i>>>12&63,n[g++]=128|i>>>6&63,n[g++]=128|i&63);return n};const I1=(s,n)=>{if(n<65534&&s.subarray&&M0)return String.fromCharCode.apply(null,s.length===n?s:s.subarray(0,n));let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(s[o]);return i};var C1=(s,n)=>{const i=n||s.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(s.subarray(0,n));let o,l;const g=new Array(i*2);for(l=0,o=0;o<i;){let m=s[o++];if(m<128){g[l++]=m;continue}let u=Zl[m];if(u>4){g[l++]=65533,o+=u-1;continue}for(m&=u===2?31:u===3?15:7;u>1&&o<i;)m=m<<6|s[o++]&63,u--;if(u>1){g[l++]=65533;continue}m<65536?g[l++]=m:(m-=65536,g[l++]=55296|m>>10&1023,g[l++]=56320|m&1023)}return I1(g,l)},O1=(s,n)=>{n=n||s.length,n>s.length&&(n=s.length);let i=n-1;for(;i>=0&&(s[i]&192)===128;)i--;return i<0||i===0?n:i+Zl[s[i]]>n?i:n},Ql={string2buf:R1,buf2string:C1,utf8border:O1};function k1(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var D0=k1;const x0=Object.prototype.toString,{Z_NO_FLUSH:w1,Z_SYNC_FLUSH:A1,Z_FULL_FLUSH:L1,Z_FINISH:N1,Z_OK:rh,Z_STREAM_END:M1,Z_DEFAULT_COMPRESSION:D1,Z_DEFAULT_STRATEGY:x1,Z_DEFLATED:B1}=Ra;function uc(s){this.options=fh.assign({level:D1,method:B1,chunkSize:16384,windowBits:15,memLevel:8,strategy:x1},s||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=false,this.chunks=[],this.strm=new D0,this.strm.avail_out=0;let i=Ul.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(i!==rh)throw new Error(ho[i]);if(n.header&&Ul.deflateSetHeader(this.strm,n.header),n.dictionary){let o;if(typeof n.dictionary=="string"?o=Ql.string2buf(n.dictionary):x0.call(n.dictionary)==="[object ArrayBuffer]"?o=new Uint8Array(n.dictionary):o=n.dictionary,i=Ul.deflateSetDictionary(this.strm,o),i!==rh)throw new Error(ho[i]);this._dict_set=true}}uc.prototype.push=function(s,n){const i=this.strm,o=this.options.chunkSize;let l,g;if(this.ended)return false;for(n===~~n?g=n:g=n===true?N1:w1,typeof s=="string"?i.input=Ql.string2buf(s):x0.call(s)==="[object ArrayBuffer]"?i.input=new Uint8Array(s):i.input=s,i.next_in=0,i.avail_in=i.input.length;;){if(i.avail_out===0&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(g===A1||g===L1)&&i.avail_out<=6){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(l=Ul.deflate(i,g),l===M1)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),l=Ul.deflateEnd(this.strm),this.onEnd(l),this.ended=true,l===rh;if(i.avail_out===0){this.onData(i.output);continue}if(g>0&&i.next_out>0){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(i.avail_in===0)break}return true};uc.prototype.onData=function(s){this.chunks.push(s)};uc.prototype.onEnd=function(s){s===rh&&(this.result=fh.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};function om(s,n){const i=new uc(n);if(i.push(s,true),i.err)throw i.msg||ho[i.err];return i.result}function P1(s,n){return n=n||{},n.raw=true,om(s,n)}function U1(s,n){return n=n||{},n.gzip=true,om(s,n)}var F1=uc,G1=om,H1=P1,V1=U1,W1=Ra,z1={Deflate:F1,deflate:G1,deflateRaw:H1,gzip:V1,constants:W1};const Lu=16209,j1=16191;var X1=function(n,i){let o,l,g,m,u,p,c,d,_,b,$,E,y,f,v,T,S,R,O,A,L,I,k,B;const U=n.state;o=n.next_in,k=n.input,l=o+(n.avail_in-5),g=n.next_out,B=n.output,m=g-(i-n.avail_out),u=g+(n.avail_out-257),p=U.dmax,c=U.wsize,d=U.whave,_=U.wnext,b=U.window,$=U.hold,E=U.bits,y=U.lencode,f=U.distcode,v=(1<<U.lenbits)-1,T=(1<<U.distbits)-1;e:do{E<15&&($+=k[o++]<<E,E+=8,$+=k[o++]<<E,E+=8),S=y[$&v];t:for(;;){if(R=S>>>24,$>>>=R,E-=R,R=S>>>16&255,R===0)B[g++]=S&65535;else if(R&16){O=S&65535,R&=15,R&&(E<R&&($+=k[o++]<<E,E+=8),O+=$&(1<<R)-1,$>>>=R,E-=R),E<15&&($+=k[o++]<<E,E+=8,$+=k[o++]<<E,E+=8),S=f[$&T];s:for(;;){if(R=S>>>24,$>>>=R,E-=R,R=S>>>16&255,R&16){if(A=S&65535,R&=15,E<R&&($+=k[o++]<<E,E+=8,E<R&&($+=k[o++]<<E,E+=8)),A+=$&(1<<R)-1,A>p){n.msg="invalid distance too far back",U.mode=Lu;break e}if($>>>=R,E-=R,R=g-m,A>R){if(R=A-R,R>d&&U.sane){n.msg="invalid distance too far back",U.mode=Lu;break e}if(L=0,I=b,_===0){if(L+=c-R,R<O){O-=R;do B[g++]=b[L++];while(--R);L=g-A,I=B}}else if(_<R){if(L+=c+_-R,R-=_,R<O){O-=R;do B[g++]=b[L++];while(--R);if(L=0,_<O){R=_,O-=R;do B[g++]=b[L++];while(--R);L=g-A,I=B}}}else if(L+=_-R,R<O){O-=R;do B[g++]=b[L++];while(--R);L=g-A,I=B}for(;O>2;)B[g++]=I[L++],B[g++]=I[L++],B[g++]=I[L++],O-=3;O&&(B[g++]=I[L++],O>1&&(B[g++]=I[L++]))}else{L=g-A;do B[g++]=B[L++],B[g++]=B[L++],B[g++]=B[L++],O-=3;while(O>2);O&&(B[g++]=B[L++],O>1&&(B[g++]=B[L++]))}}else if(R&64){n.msg="invalid distance code",U.mode=Lu;break e}else{S=f[(S&65535)+($&(1<<R)-1)];continue s}break}}else if(R&64)if(R&32){U.mode=j1;break e}else{n.msg="invalid literal/length code",U.mode=Lu;break e}else{S=y[(S&65535)+($&(1<<R)-1)];continue t}break}}while(o<l&&g<u);O=E>>3,o-=O,E-=O<<3,$&=(1<<E)-1,n.next_in=o,n.next_out=g,n.avail_in=o<l?5+(l-o):5-(o-l),n.avail_out=g<u?257+(u-g):257-(g-u),U.hold=$,U.bits=E};const aa=15,HT=852,VT=592,WT=0,up=1,zT=2,K1=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Y1=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),q1=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),J1=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Z1=(s,n,i,o,l,g,m,u)=>{const p=u.bits;let c=0,d=0,_=0,b=0,$=0,E=0,y=0,f=0,v=0,T=0,S,R,O,A,L,I=null,k;const B=new Uint16Array(aa+1),U=new Uint16Array(aa+1);let P=null,z,W,j;for(c=0;c<=aa;c++)B[c]=0;for(d=0;d<o;d++)B[n[i+d]]++;for($=p,b=aa;b>=1&&B[b]===0;b--);if($>b&&($=b),b===0)return l[g++]=1<<24|64<<16|0,l[g++]=1<<24|64<<16|0,u.bits=1,0;for(_=1;_<b&&B[_]===0;_++);for($<_&&($=_),f=1,c=1;c<=aa;c++)if(f<<=1,f-=B[c],f<0)return-1;if(f>0&&(s===WT||b!==1))return-1;for(U[1]=0,c=1;c<aa;c++)U[c+1]=U[c]+B[c];for(d=0;d<o;d++)n[i+d]!==0&&(m[U[n[i+d]]++]=d);if(s===WT?(I=P=m,k=20):s===up?(I=K1,P=Y1,k=257):(I=q1,P=J1,k=0),T=0,d=0,c=_,L=g,E=$,y=0,O=-1,v=1<<$,A=v-1,s===up&&v>HT||s===zT&&v>VT)return 1;for(;;){z=c-y,m[d]+1<k?(W=0,j=m[d]):m[d]>=k?(W=P[m[d]-k],j=I[m[d]-k]):(W=32+64,j=0),S=1<<c-y,R=1<<E,_=R;do R-=S,l[L+(T>>y)+R]=z<<24|W<<16|j|0;while(R!==0);for(S=1<<c-1;T&S;)S>>=1;if(S!==0?(T&=S-1,T+=S):T=0,d++,--B[c]===0){if(c===b)break;c=n[i+m[d]]}if(c>$&&(T&A)!==O){for(y===0&&(y=$),L+=_,E=c-y,f=1<<E;E+y<b&&(f-=B[E+y],!(f<=0));)E++,f<<=1;if(v+=1<<E,s===up&&v>HT||s===zT&&v>VT)return 1;O=T&A,l[O]=$<<24|E<<16|L-g|0}}return T!==0&&(l[L+T]=c-y<<24|64<<16|0),u.bits=$,0};var Fl=Z1;const Q1=0,B0=1,P0=2,{Z_FINISH:jT,Z_BLOCK:eD,Z_TREES:Nu,Z_OK:po,Z_STREAM_END:tD,Z_NEED_DICT:sD,Z_STREAM_ERROR:Wi,Z_DATA_ERROR:U0,Z_MEM_ERROR:F0,Z_BUF_ERROR:iD,Z_DEFLATED:XT}=Ra,mh=16180,KT=16181,YT=16182,qT=16183,JT=16184,ZT=16185,QT=16186,eS=16187,tS=16188,sS=16189,oh=16190,Xn=16191,hp=16192,iS=16193,dp=16194,nS=16195,rS=16196,oS=16197,aS=16198,Mu=16199,Du=16200,lS=16201,cS=16202,uS=16203,hS=16204,dS=16205,_p=16206,_S=16207,pS=16208,Yt=16209,G0=16210,H0=16211,nD=852,rD=592,oD=15,aD=oD,gS=s=>(s>>>24&255)+(s>>>8&65280)+((s&65280)<<8)+((s&255)<<24);function lD(){this.strm=null,this.mode=0,this.last=false,this.wrap=0,this.havedict=false,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const mo=s=>{if(!s)return 1;const n=s.state;return!n||n.strm!==s||n.mode<mh||n.mode>H0?1:0},V0=s=>{if(mo(s))return Wi;const n=s.state;return s.total_in=s.total_out=n.total=0,s.msg="",n.wrap&&(s.adler=n.wrap&1),n.mode=mh,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(nD),n.distcode=n.distdyn=new Int32Array(rD),n.sane=1,n.back=-1,po},W0=s=>{if(mo(s))return Wi;const n=s.state;return n.wsize=0,n.whave=0,n.wnext=0,V0(s)},z0=(s,n)=>{let i;if(mo(s))return Wi;const o=s.state;return n<0?(i=0,n=-n):(i=(n>>4)+5,n<48&&(n&=15)),n&&(n<8||n>15)?Wi:(o.window!==null&&o.wbits!==n&&(o.window=null),o.wrap=i,o.wbits=n,W0(s))},j0=(s,n)=>{if(!s)return Wi;const i=new lD;s.state=i,i.strm=s,i.window=null,i.mode=mh;const o=z0(s,n);return o!==po&&(s.state=null),o},cD=s=>j0(s,aD);let fS=true,pp,gp;const uD=s=>{if(fS){pp=new Int32Array(512),gp=new Int32Array(32);let n=0;for(;n<144;)s.lens[n++]=8;for(;n<256;)s.lens[n++]=9;for(;n<280;)s.lens[n++]=7;for(;n<288;)s.lens[n++]=8;for(Fl(B0,s.lens,0,288,pp,0,s.work,{bits:9}),n=0;n<32;)s.lens[n++]=5;Fl(P0,s.lens,0,32,gp,0,s.work,{bits:5}),fS=false}s.lencode=pp,s.lenbits=9,s.distcode=gp,s.distbits=5},X0=(s,n,i,o)=>{let l;const g=s.state;return g.window===null&&(g.wsize=1<<g.wbits,g.wnext=0,g.whave=0,g.window=new Uint8Array(g.wsize)),o>=g.wsize?(g.window.set(n.subarray(i-g.wsize,i),0),g.wnext=0,g.whave=g.wsize):(l=g.wsize-g.wnext,l>o&&(l=o),g.window.set(n.subarray(i-o,i-o+l),g.wnext),o-=l,o?(g.window.set(n.subarray(i-o,i),0),g.wnext=o,g.whave=g.wsize):(g.wnext+=l,g.wnext===g.wsize&&(g.wnext=0),g.whave<g.wsize&&(g.whave+=l))),0},hD=(s,n)=>{let i,o,l,g,m,u,p,c,d,_,b,$,E,y,f=0,v,T,S,R,O,A,L,I;const k=new Uint8Array(4);let B,U;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(mo(s)||!s.output||!s.input&&s.avail_in!==0)return Wi;i=s.state,i.mode===Xn&&(i.mode=hp),m=s.next_out,l=s.output,p=s.avail_out,g=s.next_in,o=s.input,u=s.avail_in,c=i.hold,d=i.bits,_=u,b=p,I=po;e:for(;;)switch(i.mode){case mh:if(i.wrap===0){i.mode=hp;break}for(;d<16;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if(i.wrap&2&&c===35615){i.wbits===0&&(i.wbits=15),i.check=0,k[0]=c&255,k[1]=c>>>8&255,i.check=Rs(i.check,k,2,0),c=0,d=0,i.mode=KT;break}if(i.head&&(i.head.done=false),!(i.wrap&1)||(((c&255)<<8)+(c>>8))%31){s.msg="incorrect header check",i.mode=Yt;break}if((c&15)!==XT){s.msg="unknown compression method",i.mode=Yt;break}if(c>>>=4,d-=4,L=(c&15)+8,i.wbits===0&&(i.wbits=L),L>15||L>i.wbits){s.msg="invalid window size",i.mode=Yt;break}i.dmax=1<<i.wbits,i.flags=0,s.adler=i.check=1,i.mode=c&512?sS:Xn,c=0,d=0;break;case KT:for(;d<16;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if(i.flags=c,(i.flags&255)!==XT){s.msg="unknown compression method",i.mode=Yt;break}if(i.flags&57344){s.msg="unknown header flags set",i.mode=Yt;break}i.head&&(i.head.text=c>>8&1),i.flags&512&&i.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,i.check=Rs(i.check,k,2,0)),c=0,d=0,i.mode=YT;case YT:for(;d<32;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}i.head&&(i.head.time=c),i.flags&512&&i.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,i.check=Rs(i.check,k,4,0)),c=0,d=0,i.mode=qT;case qT:for(;d<16;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}i.head&&(i.head.xflags=c&255,i.head.os=c>>8),i.flags&512&&i.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,i.check=Rs(i.check,k,2,0)),c=0,d=0,i.mode=JT;case JT:if(i.flags&1024){for(;d<16;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}i.length=c,i.head&&(i.head.extra_len=c),i.flags&512&&i.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,i.check=Rs(i.check,k,2,0)),c=0,d=0}else i.head&&(i.head.extra=null);i.mode=ZT;case ZT:if(i.flags&1024&&($=i.length,$>u&&($=u),$&&(i.head&&(L=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(o.subarray(g,g+$),L)),i.flags&512&&i.wrap&4&&(i.check=Rs(i.check,o,$,g)),u-=$,g+=$,i.length-=$),i.length))break e;i.length=0,i.mode=QT;case QT:if(i.flags&2048){if(u===0)break e;$=0;do L=o[g+$++],i.head&&L&&i.length<65536&&(i.head.name+=String.fromCharCode(L));while(L&&$<u);if(i.flags&512&&i.wrap&4&&(i.check=Rs(i.check,o,$,g)),u-=$,g+=$,L)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=eS;case eS:if(i.flags&4096){if(u===0)break e;$=0;do L=o[g+$++],i.head&&L&&i.length<65536&&(i.head.comment+=String.fromCharCode(L));while(L&&$<u);if(i.flags&512&&i.wrap&4&&(i.check=Rs(i.check,o,$,g)),u-=$,g+=$,L)break e}else i.head&&(i.head.comment=null);i.mode=tS;case tS:if(i.flags&512){for(;d<16;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if(i.wrap&4&&c!==(i.check&65535)){s.msg="header crc mismatch",i.mode=Yt;break}c=0,d=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=true),s.adler=i.check=0,i.mode=Xn;break;case sS:for(;d<32;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}s.adler=i.check=gS(c),c=0,d=0,i.mode=oh;case oh:if(i.havedict===0)return s.next_out=m,s.avail_out=p,s.next_in=g,s.avail_in=u,i.hold=c,i.bits=d,sD;s.adler=i.check=1,i.mode=Xn;case Xn:if(n===eD||n===Nu)break e;case hp:if(i.last){c>>>=d&7,d-=d&7,i.mode=_p;break}for(;d<3;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}switch(i.last=c&1,c>>>=1,d-=1,c&3){case 0:i.mode=iS;break;case 1:if(uD(i),i.mode=Mu,n===Nu){c>>>=2,d-=2;break e}break;case 2:i.mode=rS;break;case 3:s.msg="invalid block type",i.mode=Yt}c>>>=2,d-=2;break;case iS:for(c>>>=d&7,d-=d&7;d<32;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if((c&65535)!==(c>>>16^65535)){s.msg="invalid stored block lengths",i.mode=Yt;break}if(i.length=c&65535,c=0,d=0,i.mode=dp,n===Nu)break e;case dp:i.mode=nS;case nS:if($=i.length,$){if($>u&&($=u),$>p&&($=p),$===0)break e;l.set(o.subarray(g,g+$),m),u-=$,g+=$,p-=$,m+=$,i.length-=$;break}i.mode=Xn;break;case rS:for(;d<14;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if(i.nlen=(c&31)+257,c>>>=5,d-=5,i.ndist=(c&31)+1,c>>>=5,d-=5,i.ncode=(c&15)+4,c>>>=4,d-=4,i.nlen>286||i.ndist>30){s.msg="too many length or distance symbols",i.mode=Yt;break}i.have=0,i.mode=oS;case oS:for(;i.have<i.ncode;){for(;d<3;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}i.lens[P[i.have++]]=c&7,c>>>=3,d-=3}for(;i.have<19;)i.lens[P[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,B={bits:i.lenbits},I=Fl(Q1,i.lens,0,19,i.lencode,0,i.work,B),i.lenbits=B.bits,I){s.msg="invalid code lengths set",i.mode=Yt;break}i.have=0,i.mode=aS;case aS:for(;i.have<i.nlen+i.ndist;){for(;f=i.lencode[c&(1<<i.lenbits)-1],v=f>>>24,T=f>>>16&255,S=f&65535,!(v<=d);){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if(S<16)c>>>=v,d-=v,i.lens[i.have++]=S;else{if(S===16){for(U=v+2;d<U;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if(c>>>=v,d-=v,i.have===0){s.msg="invalid bit length repeat",i.mode=Yt;break}L=i.lens[i.have-1],$=3+(c&3),c>>>=2,d-=2}else if(S===17){for(U=v+3;d<U;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}c>>>=v,d-=v,L=0,$=3+(c&7),c>>>=3,d-=3}else{for(U=v+7;d<U;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}c>>>=v,d-=v,L=0,$=11+(c&127),c>>>=7,d-=7}if(i.have+$>i.nlen+i.ndist){s.msg="invalid bit length repeat",i.mode=Yt;break}for(;$--;)i.lens[i.have++]=L}}if(i.mode===Yt)break;if(i.lens[256]===0){s.msg="invalid code -- missing end-of-block",i.mode=Yt;break}if(i.lenbits=9,B={bits:i.lenbits},I=Fl(B0,i.lens,0,i.nlen,i.lencode,0,i.work,B),i.lenbits=B.bits,I){s.msg="invalid literal/lengths set",i.mode=Yt;break}if(i.distbits=6,i.distcode=i.distdyn,B={bits:i.distbits},I=Fl(P0,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,B),i.distbits=B.bits,I){s.msg="invalid distances set",i.mode=Yt;break}if(i.mode=Mu,n===Nu)break e;case Mu:i.mode=Du;case Du:if(u>=6&&p>=258){s.next_out=m,s.avail_out=p,s.next_in=g,s.avail_in=u,i.hold=c,i.bits=d,X1(s,b),m=s.next_out,l=s.output,p=s.avail_out,g=s.next_in,o=s.input,u=s.avail_in,c=i.hold,d=i.bits,i.mode===Xn&&(i.back=-1);break}for(i.back=0;f=i.lencode[c&(1<<i.lenbits)-1],v=f>>>24,T=f>>>16&255,S=f&65535,!(v<=d);){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if(T&&!(T&240)){for(R=v,O=T,A=S;f=i.lencode[A+((c&(1<<R+O)-1)>>R)],v=f>>>24,T=f>>>16&255,S=f&65535,!(R+v<=d);){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}c>>>=R,d-=R,i.back+=R}if(c>>>=v,d-=v,i.back+=v,i.length=S,T===0){i.mode=dS;break}if(T&32){i.back=-1,i.mode=Xn;break}if(T&64){s.msg="invalid literal/length code",i.mode=Yt;break}i.extra=T&15,i.mode=lS;case lS:if(i.extra){for(U=i.extra;d<U;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}i.length+=c&(1<<i.extra)-1,c>>>=i.extra,d-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=cS;case cS:for(;f=i.distcode[c&(1<<i.distbits)-1],v=f>>>24,T=f>>>16&255,S=f&65535,!(v<=d);){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if(!(T&240)){for(R=v,O=T,A=S;f=i.distcode[A+((c&(1<<R+O)-1)>>R)],v=f>>>24,T=f>>>16&255,S=f&65535,!(R+v<=d);){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}c>>>=R,d-=R,i.back+=R}if(c>>>=v,d-=v,i.back+=v,T&64){s.msg="invalid distance code",i.mode=Yt;break}i.offset=S,i.extra=T&15,i.mode=uS;case uS:if(i.extra){for(U=i.extra;d<U;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}i.offset+=c&(1<<i.extra)-1,c>>>=i.extra,d-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){s.msg="invalid distance too far back",i.mode=Yt;break}i.mode=hS;case hS:if(p===0)break e;if($=b-p,i.offset>$){if($=i.offset-$,$>i.whave&&i.sane){s.msg="invalid distance too far back",i.mode=Yt;break}$>i.wnext?($-=i.wnext,E=i.wsize-$):E=i.wnext-$,$>i.length&&($=i.length),y=i.window}else y=l,E=m-i.offset,$=i.length;$>p&&($=p),p-=$,i.length-=$;do l[m++]=y[E++];while(--$);i.length===0&&(i.mode=Du);break;case dS:if(p===0)break e;l[m++]=i.length,p--,i.mode=Du;break;case _p:if(i.wrap){for(;d<32;){if(u===0)break e;u--,c|=o[g++]<<d,d+=8}if(b-=p,s.total_out+=b,i.total+=b,i.wrap&4&&b&&(s.adler=i.check=i.flags?Rs(i.check,l,b,m-b):Jl(i.check,l,b,m-b)),b=p,i.wrap&4&&(i.flags?c:gS(c))!==i.check){s.msg="incorrect data check",i.mode=Yt;break}c=0,d=0}i.mode=_S;case _S:if(i.wrap&&i.flags){for(;d<32;){if(u===0)break e;u--,c+=o[g++]<<d,d+=8}if(i.wrap&4&&c!==(i.total&4294967295)){s.msg="incorrect length check",i.mode=Yt;break}c=0,d=0}i.mode=pS;case pS:I=tD;break e;case Yt:I=U0;break e;case G0:return F0;case H0:default:return Wi}return s.next_out=m,s.avail_out=p,s.next_in=g,s.avail_in=u,i.hold=c,i.bits=d,(i.wsize||b!==s.avail_out&&i.mode<Yt&&(i.mode<_p||n!==jT))&&X0(s,s.output,s.next_out,b-s.avail_out),_-=s.avail_in,b-=s.avail_out,s.total_in+=_,s.total_out+=b,i.total+=b,i.wrap&4&&b&&(s.adler=i.check=i.flags?Rs(i.check,l,b,s.next_out-b):Jl(i.check,l,b,s.next_out-b)),s.data_type=i.bits+(i.last?64:0)+(i.mode===Xn?128:0)+(i.mode===Mu||i.mode===dp?256:0),(_===0&&b===0||n===jT)&&I===po&&(I=iD),I},dD=s=>{if(mo(s))return Wi;let n=s.state;return n.window&&(n.window=null),s.state=null,po},_D=(s,n)=>{if(mo(s))return Wi;const i=s.state;return i.wrap&2?(i.head=n,n.done=false,po):Wi},pD=(s,n)=>{const i=n.length;let o,l,g;return mo(s)||(o=s.state,o.wrap!==0&&o.mode!==oh)?Wi:o.mode===oh&&(l=1,l=Jl(l,n,i,0),l!==o.check)?U0:(g=X0(s,n,i,i),g?(o.mode=G0,F0):(o.havedict=1,po))};var gD=W0,fD=z0,mD=V0,ED=cD,vD=j0,bD=hD,TD=dD,SD=_D,$D=pD,yD="pako inflate (from Nodeca project)",Yn={inflateReset:gD,inflateReset2:fD,inflateResetKeep:mD,inflateInit:ED,inflateInit2:vD,inflate:bD,inflateEnd:TD,inflateGetHeader:SD,inflateSetDictionary:$D,inflateInfo:yD};function RD(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=false}var ID=RD;const K0=Object.prototype.toString,{Z_NO_FLUSH:CD,Z_FINISH:OD,Z_OK:ec,Z_STREAM_END:fp,Z_NEED_DICT:mp,Z_STREAM_ERROR:kD,Z_DATA_ERROR:mS,Z_MEM_ERROR:wD}=Ra;function hc(s){this.options=fh.assign({chunkSize:1024*64,windowBits:15,to:""},s||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(s&&s.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=false,this.chunks=[],this.strm=new D0,this.strm.avail_out=0;let i=Yn.inflateInit2(this.strm,n.windowBits);if(i!==ec)throw new Error(ho[i]);if(this.header=new ID,Yn.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=Ql.string2buf(n.dictionary):K0.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(i=Yn.inflateSetDictionary(this.strm,n.dictionary),i!==ec)))throw new Error(ho[i])}hc.prototype.push=function(s,n){const i=this.strm,o=this.options.chunkSize,l=this.options.dictionary;let g,m,u;if(this.ended)return false;for(n===~~n?m=n:m=n===true?OD:CD,K0.call(s)==="[object ArrayBuffer]"?i.input=new Uint8Array(s):i.input=s,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),g=Yn.inflate(i,m),g===mp&&l&&(g=Yn.inflateSetDictionary(i,l),g===ec?g=Yn.inflate(i,m):g===mS&&(g=mp));i.avail_in>0&&g===fp&&i.state.wrap>0&&s[i.next_in]!==0;)Yn.inflateReset(i),g=Yn.inflate(i,m);switch(g){case kD:case mS:case mp:case wD:return this.onEnd(g),this.ended=true,false}if(u=i.avail_out,i.next_out&&(i.avail_out===0||g===fp))if(this.options.to==="string"){let p=Ql.utf8border(i.output,i.next_out),c=i.next_out-p,d=Ql.buf2string(i.output,p);i.next_out=c,i.avail_out=o-c,c&&i.output.set(i.output.subarray(p,p+c),0),this.onData(d)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(!(g===ec&&u===0)){if(g===fp)return g=Yn.inflateEnd(this.strm),this.onEnd(g),this.ended=true,true;if(i.avail_in===0)break}}return true};hc.prototype.onData=function(s){this.chunks.push(s)};hc.prototype.onEnd=function(s){s===ec&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fh.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};function am(s,n){const i=new hc(n);if(i.push(s),i.err)throw i.msg||ho[i.err];return i.result}function AD(s,n){return n=n||{},n.raw=true,am(s,n)}var LD=hc,ND=am,MD=AD,DD=am,xD=Ra,BD={Inflate:LD,inflate:ND,inflateRaw:MD,ungzip:DD,constants:xD};const{Deflate:n5,deflate:r5,deflateRaw:o5,gzip:PD}=z1,{Inflate:a5,inflate:l5,inflateRaw:c5,ungzip:UD}=BD;var FD=PD,GD=UD;function HD(s){let n=new Uint8Array(s.length);for(let i=0;i<s.length;i++)n[i]=s.charCodeAt(i);return n.buffer}const VD=`{\r
  "name": "koishi-plugin-blockly-null",\r
  "description": "Use blockly to develop a simple koishi plugin",\r
  "version": "1.2.14",\r
  "main": "lib/index.js",\r
  "typings": "lib/index.d.ts",\r
  "repository": {\r
    "type": "git",\r
    "url": "https://github.com/yexiaoquan/koishi-plugin-blockly-null"\r
  },\r
  "homepage": "https://blockly.koishi.chat",\r
  "files": [\r
    "lib",\r
    "dist",\r
    "media"\r
  ],\r
  "license": "AGPL-3.0",\r
  "scripts": {\r
    "docs:dev": "vitepress dev docs --open",\r
    "docs:build": "vitepress build docs",\r
    "docs:serve": "vitepress serve docs",\r
    "test": "yakumo mocha -r esbuild-register -r yml-register --exit"\r
  },\r
  "keywords": [\r
    "chatbot",\r
    "koishi",\r
    "plugin",\r
    "blockly",\r
    "lowcode",\r
    "program",\r
    "develop",\r
    "flowgraph",\r
    "dataflow",\r
    "visualization"\r
  ],\r
  "koishi": {\r
    "browser": true,\r
    "public": [\r
      "dist"\r
    ],\r
    "description": {\r
      "zh": "Blockly的fork版,多了一些奇怪的块"\r
    },\r
    "service": {\r
      "required": [\r
        "database",\r
        "console",\r
        "puppeteer"\r
      ]\r
    }\r
  },\r
  "peerDependencies": {\r
    "@koishijs/plugin-console": "^5.7.7",\r
    "koishi": "^4.12.8"\r
  },\r
  "devDependencies": {\r
    "@baklavajs/themes": "^2.0.1-next.0",\r
    "@highlightjs/vue-plugin": "^2.1.2",\r
    "@koishijs/client": "^5.7.6",\r
    "@koishijs/plugin-console": "^5.7.6",\r
    "@koishijs/vitepress": "^1.9.5",\r
    "@mit-app-inventor/blockly-block-lexical-variables": "^0.0.13",\r
    "@types/node": "^18.16.8",\r
    "@types/pako": "^2.0.0",\r
    "@types/semver": "^7.5.0",\r
    "@types/uuid": "^9.0.1",\r
    "baklavajs": "2.0.2-beta.3",\r
    "blockly": "9.2.1",\r
    "chai": "^4.3.7",\r
    "element-plus": "^2.3.4",\r
    "highlight.js": "^11.8.0",\r
    "koishi": "^4.11.6",\r
    "mocha": "^10.2.0",\r
    "pako": "^2.1.0",\r
    "sass": "^1.62.1",\r
    "semver": "^7.5.0",\r
    "typescript": "^4.9.5",\r
    "uuid": "^9.0.0",\r
    "vitepress": "1.0.0-alpha.26",\r
    "xterm": "^5.1.0",\r
    "yakumo-mocha": "^0.3.1"\r
  },\r
  "dependencies": {\r
    "jsonpath-plus": "^7.2.0",\r
    "uuid": "^9.0.0"\r
  }\r
}\r
`,WD=JSON.parse(VD),Y0=1,Rf=WD.version??"0.0.0";function zD(s,n,i){const l=encodeURI(JSON.stringify({version:Y0,plugin_version:Rf,vendors:[],body:i,name:s,uuid:n})),g=btoa(String.fromCharCode.apply(null,FD(l)));let m=`插件名称: ${s}
`;return m+=`导出时间: ${new Date().toLocaleString()}
`,m+=`-=-=-=-=--=-=-=-=- BEGIN KOISHI BLOCKLY BLOCK V1 -=-=--=-=-=--=-=--=-=-=-
`,m+=`${g.replace(/(.{64})/g,`$1
`)}
`,m+=`-=-=--=-=-=--=-=-=-=- END KOISHI BLOCKLY BLOCK V1 -=-=--=-=-=--=-=--=-=-=-
`,m.replace(`

`,`
`)}function jD(s){var l;const n=(l=s.match(/[=–-]+\s+BEGIN KOISHI BLOCKLY BLOCK V1\s+[=–-]+\n([\s\S]+)\n[=–-]+\s+END KOISHI BLOCKLY BLOCK V1\s+[=–-]+/))==null?void 0:l[1].replace(/[\r\n\t ]/g,"");if(!n)return null;const i=GD(HD(atob(n)),{to:"string"});if(!i)return null;const o=JSON.parse(decodeURI(i));return o||null}const XD=`export const name = "{{name}}"\r
export async function apply(ctx){\r
{{apply}}\r
}\r
`;var Ep={exports:{}},vp={exports:{}},bp={exports:{}},Tp={exports:{}},ES;function lm(){return ES||(ES=1,function(s,n){(function(i,o){s.exports=o()})(ki,function(){var i={},o=function(e,t,r,a){e=e+" was deprecated in "+t+" and will be deleted in "+r+".",a&&(e+=`
Use `+a+" instead."),console.warn(e)},l=function(e,t){g(),Fc=setTimeout(function(){t&&t.handleRightClick(e)},lO)},g=function(){Fc&&(clearTimeout(Fc),Fc=0)},m=function(){Uc=null},u=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&c(e)},p=function(e){return`${e.pointerId}`},c=function(e){const t=p(e);return Uc?Uc===t:e.type==="pointerdown"?(Uc=t,true):false},d=function(e){if(o("setClientFromTouch()","version 9","version 10"),e.type.startsWith("touch")&&e.changedTouches){const t=e.changedTouches[0];e.clientX=t.clientX,e.clientY=t.clientY}},_=function(e){return o("isMouseOrTouchEvent()","version 9","version 10"),e.type.startsWith("touch")||e.type.startsWith("mouse")||e.type.startsWith("pointer")},b=function(e){return o("isTouchEvent()","version 9","version 10"),e.type.startsWith("touch")||e.type.startsWith("pointer")},$=function(e){o("splitEventByTouches()","version 9","version 10");const t=[];if(e.changedTouches)for(let r=0;r<e.changedTouches.length;r++)t[r]={type:e.type,changedTouches:[e.changedTouches[r]],target:e.target,stopPropagation(){e.stopPropagation()},preventDefault(){e.preventDefault()}};else t.push(e);return t},E=function(e,t,r,a,h,C){function D(Y){(h||u(Y))&&(r?a.call(r,Y):a(Y))}if(C!==void 0&&o("The opt_noPreventDefault argument of conditionalBind","version 9","version 10"),C=[],t in Pr)for(let Y=0;Y<Pr[t].length;Y++){const pe=Pr[t][Y];e.addEventListener(pe,D,false),C.push([e,pe,D])}else e.addEventListener(t,D,false),C.push([e,t,D]);return C},y=function(e,t,r,a){function h(D){r?a.call(r,D):a(D)}const C=[];if(t in Pr)for(let D=0;D<Pr[t].length;D++){const Y=Pr[t][D];e.addEventListener(Y,h,false),C.push([e,Y,h])}else e.addEventListener(t,h,false),C.push([e,t,h]);return C},f=function(e){const t=e[e.length-1][2];for(;e.length;){const r=e.pop();r[0].removeEventListener(r[1],r[2],false)}return t},v=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||e.target.getAttribute("data-is-text-input")==="true")return true;if(e.target instanceof HTMLInputElement)return e=e.target,e.type==="text"||e.type==="number"||e.type==="email"||e.type==="password"||e.type==="search"||e.type==="tel"||e.type==="url";if(e.target instanceof HTMLTextAreaElement)return true}return false},T=function(e){return e.ctrlKey&&_d?true:e.button===2},S=function(e,t,r){const a=t.createSVGPoint();return a.x=e.clientX,a.y=e.clientY,r||(r=t.getScreenCTM().inverse()),a.matrixTransform(r)},R=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*cv,y:e.deltaY*cv};case 2:return{x:e.deltaX*uv,y:e.deltaY*uv}}},O=function(e){return No[e]||null},A=function(){const e=[];for(const t in No)e.push(No[t]);return e},L=function(e){No[e.id]=e},I=function(e){delete No[e.id]},k=function(){return hv},B=function(e){hv=e},U=function(){return gd},P=function(e){gd=e},z=function(){return dv},W=function(e){dv=e},j=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),r=e.getCachedParentSvgSize();var a=t.parentElement;if(a instanceof HTMLElement){var h=a.offsetWidth;a=a.offsetHeight,r.width!==h&&(t.setAttribute("width",h+"px"),e.setCachedParentSvgSize(h,null)),r.height!==a&&(t.setAttribute("height",a+"px"),e.setCachedParentSvgSize(null,a)),e.resize()}},K=function(e,t){const r=Object.create(null),a=e.getDescendants(true);t&&(e=e.getNextBlock())&&(e=a.indexOf(e),a.splice(e,a.length-e));for(let h=0,C;C=a[h];h++)r[C.type]?r[C.type]++:r[C.type]=1;return r},ee=function(e){return function(){this.jsonInit(e)}},M=function(e){fd.defineBlocksWithJsonArrayInternal(e)},F=function(e){X(V(e))},V=function(e){const t={};for(let r=0;r<e.length;r++){const a=e[r];if(!a){console.warn(`Block definition #${r} in JSON array is ${a}. Skipping`);continue}const h=a.type;h?t[h]={init:ee(a)}:console.warn(`Block definition #${r} in JSON array is missing a type attribute. Skipping.`)}return t},X=function(e){for(const t of Object.keys(e)){const r=e[t];t in ri&&console.warn(`Block definiton "${t}" overwrites previous definition.`),ri[t]=r}},H=function(e,t,r){e=document.createElementNS(Mo,String(e));for(const a in t)e.setAttribute(a,`${t[a]}`);return r&&r.appendChild(e),e},ne=function(e,t){return t=t.split(" "),t.every(r=>e.classList.contains(r))?false:(e.classList.add(...t),true)},Ie=function(e,t){e.classList.remove(...t.split(" "))},de=function(e,t){return t=t.split(" "),t.every(r=>!e.classList.contains(r))?false:(e.classList.remove(...t),true)},ot=function(e,t){return e.classList.contains(t)},x=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},te=function(e,t){const r=t.nextSibling;if(t=t.parentNode,!t)throw Error("Reference node has no parent.");r?t.insertBefore(e,r):t.appendChild(e)},ce=function(e,t){return!!(e.compareDocumentPosition(t)&fn.DOCUMENT_POSITION_CONTAINED_BY)},ae=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},De=function(){md++,qi||(qi=Object.create(null))},$e=function(){md--,md||(qi=null)},st=function(e){const t=e.textContent+`
`+e.className.baseVal;let r;if(qi&&(r=qi[t]))return r;try{r=e.getComputedTextLength()}catch{return 8*e.textContent.length}return qi&&(qi[t]=r),r},bt=function(e,t,r,a){return Ut(e,t+"pt",r,a)},Ut=function(e,t,r,a){const h=e.textContent;e=h+`
`+e.className.baseVal;var C;return qi&&(C=qi[e])||(Wc||(C=document.createElement("canvas"),C.className="blocklyComputeCanvas",document.body.appendChild(C),Wc=C.getContext("2d")),Wc.font=r+" "+t+" "+a,C=h?Wc.measureText(h).width:0,qi&&(qi[e]=C)),C},jt=function(e,t,r,a){const h=document.createElement("span");h.style.font=r+" "+t+" "+a,h.textContent=e,e=document.createElement("div"),e.style.width="1px",e.style.height="0",t=document.createElement("div"),t.setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),t.appendChild(h),t.appendChild(e),document.body.appendChild(t),r={height:0,baseline:0};try{t.style.alignItems="baseline",r.baseline=e.offsetTop-h.offsetTop,t.style.alignItems="flex-end",r.height=e.offsetTop-h.offsetTop}finally{document.body.removeChild(t)}return r},Ve=function(e){return e*Math.PI/180},Ss=function(e){return 180*e/Math.PI},Cs=function(e,t,r){if(r<e){const a=r;r=e,e=a}return Math.max(e,Math.min(t,r))},Os=function(e){return _v.getSizeInternal(e)},zs=function(e){if(kt(e,"display")!=="none")return xs(e);const t=e.style,r=t.display,a=t.visibility,h=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const C=e.offsetWidth;return e=e.offsetHeight,t.display=r,t.position=h,t.visibility=a,new $s(C,e)},xs=function(e){return new $s(e.offsetWidth,e.offsetHeight)},kt=function(e,t){return e=window.getComputedStyle(e),e[t]||e.getPropertyValue(t)},ts=function(e,t){return o("Blockly.utils.style.getCascadedStyle","version 9","version 10"),e.currentStyle?e.currentStyle[t]:""},me=function(e){const t=new Oe(0,0);e=e.getBoundingClientRect();var r=document.documentElement;return r=new Oe(window.pageXOffset||r.scrollLeft,window.pageYOffset||r.scrollTop),t.x=e.left+r.x,t.y=e.top+r.y,t},He=function(){const e=document.body,t=document.documentElement;return new Oe(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},Dt=function(e){const t=parseFloat(kt(e,"borderLeftWidth")),r=parseFloat(kt(e,"borderRightWidth")),a=parseFloat(kt(e,"borderTopWidth"));return e=parseFloat(kt(e,"borderBottomWidth")),new es(a,e,t,r)},ve=function(e,t,r){e=Bs(e,t,r),t.scrollLeft=e.x,t.scrollTop=e.y},Bs=function(e,t,r){var a=me(e),h=me(t),C=Dt(t);const D=a.x-h.x-C.left;return a=a.y-h.y-C.top,h=xs(e),e=t.clientWidth-h.width,h=t.clientHeight-h.height,C=t.scrollLeft,t=t.scrollTop,r?(C+=D-e/2,t+=a-h/2):(C+=Math.min(D,Math.max(D-e,0)),t+=Math.min(a,Math.max(a-h,0))),new Oe(C,t)},vs=function(){Tt||(Tt=document.createElement("div"),Tt.className="blocklyDropDownDiv",(z()||document.body).appendChild(Tt),Bo=document.createElement("div"),Bo.className="blocklyDropDownContent",Tt.appendChild(Bo),Gr=document.createElement("div"),Gr.className="blocklyDropDownArrow",Tt.appendChild(Gr),Tt.style.opacity="0",Tt.style.transition="transform "+jc+"s, opacity "+jc+"s",Tt.addEventListener("focusin",function(){ne(Tt,"blocklyFocused")}),Tt.addEventListener("focusout",function(){de(Tt,"blocklyFocused")}))},ks=function(e){Td=e},Rt=function(){return or},Li=function(){return Bo},as=function(){Bo.textContent="",Bo.style.width=""},N=function(e,t){Tt.style.backgroundColor=e,Tt.style.borderColor=t},G=function(e,t,r,a){return at(ie(t),e,r,a)},J=function(e,t,r){return gv=true,at(le(e),e,t,r)},ie=function(e){var t=e.getSvgRoot();const r=e.workspace.scale,a=e.height*r;return e=e.width*r,t=me(t),new es(t.y,t.y+a,t.x,t.x+e)},le=function(e){return e=e.getScaledBBox(),new es(e.top,e.bottom,e.left,e.right)},at=function(e,t,r,a){const h=e.left+(e.right-e.left)/2,C=e.bottom;e=e.top,a&&(e+=a),a=t.getSourceBlock();let D=a.workspace;for(;D.options.parentWorkspace;)D=D.options.parentWorkspace;return ks(D.getParentSvg().parentNode),Xi(t,a.RTL,h,C,h,e,r)},Xi=function(e,t,r,a,h,C,D){return or=e,Fr=D||null,Tt.style.direction=t?"rtl":"ltr",e=k(),Do=e.getRenderer().getClassName(),xo=e.getTheme().getClassName(),Do&&ne(Tt,Do),xo&&ne(Tt,xo),Ue(r,a,h,C)},ka=function(e,t,r,a){return e=fe(e,r.left,r.right,a.width),{initialX:e.divX,initialY:t,finalX:e.divX,finalY:t+vd,arrowX:e.arrowX,arrowY:-(Ga/2+Ed),arrowAtTop:true,arrowVisible:true}},Ln=function(e,t,r,a){return e=fe(e,r.left,r.right,a.width),{initialX:e.divX,initialY:t-a.height,finalX:e.divX,finalY:t-a.height-vd,arrowX:e.arrowX,arrowY:a.height-2*Ed-Ga/2,arrowAtTop:false,arrowVisible:true}},q=function(e,t,r){return e=fe(e,t.left,t.right,r.width),{initialX:e.divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:false}},fe=function(e,t,r,a){return t=Cs(t,e-a/2,r-a),e=e-Ga/2-t,r=pv,e=Cs(r,e,a-r-Ga),{arrowX:e,divX:t}},Ae=function(){return!!or},Qe=function(e,t){return or===e?(t?Ot():Ht(),true):false},Ht=function(){Tt.style.transform="translate(0, 0)",Tt.style.opacity="0",bd=setTimeout(function(){Ot()},1e3*jc),Fr&&(Fr(),Fr=null)},Ot=function(){Ae()&&(bd&&clearTimeout(bd),Tt.style.transform="",Tt.style.left="",Tt.style.top="",Tt.style.opacity="0",Tt.style.display="none",Tt.style.backgroundColor="",Tt.style.borderColor="",Fr&&(Fr(),Fr=null),as(),or=null,Do&&(de(Tt,Do),Do=""),xo&&(de(Tt,xo),xo=""),k().markFocused())},Ue=function(e,t,r,a){e=Sd.getPositionMetrics(e,t,r,a),e.arrowVisible?(Gr.style.display="",Gr.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",Gr.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):Gr.style.display="none",t=Math.floor(e.initialX),r=Math.floor(e.initialY),a=Math.floor(e.finalX);const h=Math.floor(e.finalY);return Tt.style.left=t+"px",Tt.style.top=r+"px",Tt.style.display="block",Tt.style.opacity="1",Tt.style.transform="translate("+(a-t)+"px,"+(h-r)+"px)",!!e.arrowAtTop},Be=function(){if(or){var e=or.getSourceBlock();e=gv?le(or):ie(e);const t=e.left+(e.right-e.left)/2;Ue(t,e.bottom,t,e.top)}else Ht()},ye=function(e,t,r,a){if(!(e instanceof Se)&&typeof e!="string"||String(e).trim()==="")throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=String(e).toLowerCase(),typeof t!="string"||t.trim()==="")throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const h=t.toLowerCase();if(!r)throw Error("Can not register a null value");let C=ar[e],D=Xc[e];if(C||(C=ar[e]=Object.create(null),D=Xc[e]=Object.create(null)),fs(e,r),!a&&C[h])throw Error('Name "'+h+'" with type "'+e+'" already registered.');C[h]=r,D[h]=t},fs=function(e,t){switch(e){case String(Se.FIELD):if(typeof t.fromJson!="function")throw Error('Type "'+e+'" must have a fromJson function')}},Vt=function(e,t){e=String(e).toLowerCase(),t=t.toLowerCase();const r=ar[e];r&&r[t]?(delete ar[e][t],delete Xc[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},ir=function(e,t,r){e=String(e).toLowerCase(),t=t.toLowerCase();const a=ar[e];if(!a||!a[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",r)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return a[t]},Eo=function(e,t){return e=String(e).toLowerCase(),t=t.toLowerCase(),(e=ar[e])?!!e[t]:false},dn=function(e,t,r){return ir(e,t,r)},vo=function(e,t,r){return ir(e,t,r)},wr=function(e,t,r){e=String(e).toLowerCase();var a=ar[e];if(!a){if(a=`Unable to find [${e}] in the registry.`,r)throw Error(`${a} You must require or register a ${e} plugin.`);return console.warn(a),null}if(!t)return a;e=Xc[e],r=Object.create(null),t=Object.keys(a);for(let h=0;h<t.length;h++){const C=t[h];r[e[C]]=a[C]}return r},si=function(e,t,r){return t=t.plugins[e.toString()]||Bn,typeof t=="function"?t:dn(e,t,r)},Ar=function(){return"blockly-"+(hO++).toString(36)},pi=function(){return mv.genUid()},Ps=function(e){Ha=e},Us=function(){return Ha},Pe=function(e){Rd.fireInternal(e)},Oh=function(e){ls()&&(Ho.length||setTimeout(mc,0),Ho.push(e))},mc=function(){const e=bo(Ho,true);Ho.length=0;for(let t=0,r;r=e[t];t++){if(!r.workspaceId)continue;const a=O(r.workspaceId);a&&a.fireChangeListener(r)}},bo=function(e,t){e=e.slice(),t||e.reverse();const r=[],a=Object.create(null);for(let D=0,Y;Y=e[D];D++)if(!Y.isNull()){var h=[Y.isUiEvent?Wa:Y.type,Y.blockId,Y.workspaceId].join(" "),C=a[h];const pe=C?C.event:null;C?Y.type===Xs&&C.index===D-1?(h=Y,pe.newParentId=h.newParentId,pe.newInputName=h.newInputName,pe.newCoordinate=h.newCoordinate,C.index=D):Y.type===Ts&&Y.element===pe.element&&Y.name===pe.name?pe.newValue=Y.newValue:Y.type===Vr?(C=Y,pe.viewTop=C.viewTop,pe.viewLeft=C.viewLeft,pe.scale=C.scale,pe.oldScale=C.oldScale):(Y.type!==cr||pe.type!==Pn)&&(a[h]={event:Y,index:D},r.push(Y)):(a[h]={event:Y,index:D},r.push(Y))}e=r.filter(function(D){return!D.isNull()}),t||e.reverse();for(let D=1,Y;Y=e[D];D++)Y.type===Ts&&Y.element==="mutation"&&e.unshift(e.splice(D,1)[0]);return e},Ni=function(){for(let e=0,t;t=Ho[e];e++)t.recordUndo=false},Jt=function(){$d++},Zt=function(){$d--},ls=function(){return $d===0},Ft=function(){return Ev},We=function(e){Rd.setGroupInternal(e)},To=function(e){Ev=typeof e=="boolean"?e?pi():"":e},So=function(e){const t=[];e=e.getDescendants(false);for(let r=0,a;a=e[r];r++)t[r]=a.id;return t},Re=function(e,t){var r=Te(e.type);if(!r)throw Error("Unknown event type.");return Ke(r)?r.fromJson(e,t):(r=new r,r.fromJson(e),r.workspaceId=t.id,r)},Ke=function(e){return Object.getOwnPropertyDescriptors(e).fromJson&&typeof e.fromJson=="function"},Te=function(e){const t=dn(Se.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},Nt=function(e){if((e.type===Xs||e.type===ws)&&e.workspaceId){var t=O(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const r=Ha;try{Ha=false;const a=e.getParent();if(a&&a.isEnabled()){const h=e.getDescendants(false);for(let C=0,D;D=h[C];C++)D.setEnabled(true)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do e.setEnabled(false),e=e.getNextBlock();while(e)}finally{Ha=r}}}},cs=function(e){({document:zr=zr,DOMParser:su=su,XMLSerializer:iu=iu}=e)},gi=function(){return o("Blockly.utils.xml.getDocument","version 9","version 10"),zr},_n=function(e){o("Blockly.utils.xml.setDocument","version 9","version 10"),zr=e},_t=function(e){return zr.createElementNS(Id,e)},ss=function(e){return zr.createTextNode(e)},fi=function(e){return new su().parseFromString(e,"text/xml")},wa=function(e){return new iu().serializeToString(e)},Lr=function(e,t){vv(e,t)},Ec=function(e){vv=e},Aa=function(e,t){Sv.confirmInternal(e,t)},kh=function(e,t){bv(e,t)},wh=function(e){bv=e},La=function(e,t,r){Tv(e,t,r)},$o=function(e){Tv=e},yo=function(e){e=e.getAllBlocks(false);const t=new Set;for(let r=0;r<e.length;r++){const a=e[r].getVarModels();if(a)for(let h=0;h<a.length;h++){const C=a[h];C.getId()&&t.add(C)}}return Array.from(t.values())},Mi=function(e){e=e.getAllBlocks(false);const t=new Set;for(let a=0,h;h=e[a];a++){var r=h.getDeveloperVariables;if(r){r=r();for(let C=0;C<r.length;C++)t.add(r[C])}}return Array.from(t.values())},Na=function(e){let t=[];const r=document.createElement("button");return r.setAttribute("text","%{BKY_NEW_VARIABLE}"),r.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(a){wt(a.getTargetWorkspace())}),t.push(r),e=Ro(e),t=t.concat(e)},Ro=function(e){e=e.getVariablesOfType("");const t=[];if(0<e.length){var r=e[e.length-1];if(ri.variables_set){var a=_t("block");a.setAttribute("type","variables_set"),a.setAttribute("gap",ri.math_change?"8":"24"),a.appendChild(we(r)),t.push(a)}if(ri.math_change&&(a=_t("block"),a.setAttribute("type","math_change"),a.setAttribute("gap",ri.variables_get?"20":"8"),a.appendChild(we(r)),r=js('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),a.appendChild(r),t.push(a)),ri.variables_get){e.sort(Za.compareByName);for(let h=0,C;C=e[h];h++)r=_t("block"),r.setAttribute("type","variables_get"),r.setAttribute("gap","8"),r.appendChild(we(C)),t.push(r)}}return t},nt=function(e){return kd.generateUniqueNameInternal(e)},vc=function(e){return us(ru.charAt(0),e.getAllVariableNames())},us=function(e,t){if(!t.length)return e;const r=ru;let a="",h=r.indexOf(e);for(;;){let C=false;for(let D=0;D<t.length;D++)if(t[D].toLowerCase()===e){C=true;break}if(!C)break;h++,h===r.length&&(h=0,a=`${Number(a)+1}`),e=r.charAt(h)+a}return e},wt=function(e,t,r){function a(C){Ki(Ye.NEW_VARIABLE_TITLE,C,function(D){if(D){const Y=Io(D,e);if(Y){let pe;Y.type===h?pe=Ye.VARIABLE_ALREADY_EXISTS.replace("%1",Y.name):(pe=Ye.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,pe=pe.replace("%1",Y.name).replace("%2",Y.type)),Lr(pe,function(){a(D)})}else e.createVariable(D,h),t&&t(D)}else t&&t(null)})}const h=r||"";a("")},Nr=function(e,t,r){function a(h){const C=Ye.RENAME_VARIABLE_TITLE.replace("%1",t.name);Ki(C,h,function(D){if(D){var Y=Ma(D,t.type,e);Y?(Y=Ye.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",Y.name).replace("%2",Y.type),Lr(Y,function(){a(D)})):(e.renameVariableById(t.getId(),D),r&&r(D))}else r&&r(null)})}a("")},Ki=function(e,t,r){La(e,t,function(a){a&&(a=a.replace(/[\s\xa0]+/g," ").trim(),a===Ye.RENAME_VARIABLE||a===Ye.NEW_VARIABLE)&&(a=null),r(a)})},Ma=function(e,t,r){r=r.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let a=0,h;h=r[a];a++)if(h.name.toLowerCase()===e&&h.type!==t)return h;return null},Io=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let r=0,a;a=t[r];r++)if(a.name.toLowerCase()===e)return a;return null},we=function(e){const t=_t("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type),e=ss(e.name),t.appendChild(e),t},Fe=function(e,t,r,a){let h=lt(e,t,r,a);return h||(h=At(e,t,r,a)),h},lt=function(e,t,r,a){const h=e.getPotentialVariableMap();let C=null;if(t&&(C=e.getVariableById(t),!C&&h&&(C=h.getVariableById(t)),C))return C;if(r){if(a===void 0)throw Error("Tried to look up a variable by name without a type");C=e.getVariable(r,a),!C&&h&&(C=h.getVariable(r,a))}return C},At=function(e,t,r,a){const h=e.getPotentialVariableMap();return r||(r=nt(e.isFlyout?e.targetWorkspace:e)),h?h.createVariable(r,a,t):e.createVariable(r,a,t)},ms=function(e,t){e=e.getAllVariables();const r=[];if(t.length!==e.length)for(let a=0;a<e.length;a++){const h=e[a];t.indexOf(h)===-1&&r.push(h)}return r},hs=function(e){if(Ad)throw Error("CSS already injected");Ld+=`
`+e},bc=function(e,t){Ad||(Ad=true,e&&(e=t.replace(/[\\/]$/,""),t=Ld.replace(/<<<PATH>>>/g,e),Ld="",e=document.createElement("style"),e.id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},mi=function(e){const t=new Oe(0,0);var r=e.x&&e.getAttribute("x");const a=e.y&&e.getAttribute("y");return r&&(t.x=parseInt(r)),a&&(t.y=parseInt(a)),(r=(r=e.getAttribute("transform"))&&r.match($v))&&(t.x+=Number(r[1]),r[3]&&(t.y+=Number(r[3]))),(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&(e=e.match(yv))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},Tc=function(e){let t=0,r=0;for(;e;){const a=mi(e);if(t+=a.x,r+=a.y,(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1)break;e=e.parentNode}return new Oe(t,r)},Cm=function(){return o("Blockly.utils.svgMath.is3dSupported","version 9","version 10"),true},Ah=function(){const e=He();return new es(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},Lh=function(){const e=document.documentElement,t=window;return new Oe(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},Om=function(e,t){var r=t.x;t=t.y;const a=e.getInjectionDiv().getBoundingClientRect();return r=new Oe(r-a.left,t-a.top),t=e.getOriginOffsetInPixels(),Oe.difference(r,t).scale(1/e.scale)},GR=function(e,t){const r=_t("xml");var a=km(yo(e));a.hasChildNodes()&&r.appendChild(a),a=e.getTopComments(true);for(let h=0;h<a.length;h++)r.appendChild(a[h].toXmlWithXY(t));for(e=e.getTopBlocks(true),a=0;a<e.length;a++)r.appendChild(Sc(e[a],t));return r},km=function(e){const t=_t("variables");for(let r=0;r<e.length;r++){const a=e[r],h=_t("variable");h.appendChild(ss(a.name)),a.type&&h.setAttribute("type",a.type),h.id=a.getId(),t.appendChild(h)}return t},Sc=function(e,t){if(e.isInsertionMarker()&&(e=e.getChildren(false)[0],!e))return new DocumentFragment;let r=0;e.workspace.RTL&&(r=e.workspace.getWidth()),t=Mr(e,t);const a=e.getRelativeToSurfaceXY();return t.setAttribute("x",Math.round(e.workspace.RTL?r-a.x:a.x)),t.setAttribute("y",Math.round(a.y)),t},HR=function(e){if(e.isSerializable()){const t=_t("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},VR=function(e,t){for(let r=0;r<e.inputList.length;r++){const a=e.inputList[r];for(let h=0;h<a.fieldRow.length;h++){const C=HR(a.fieldRow[h]);C&&t.appendChild(C)}}},Mr=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(false)[0])?Mr(t):new DocumentFragment;const r=_t(e.isShadow()?"shadow":"block");if(r.setAttribute("type",e.type),t||r.setAttribute("id",e.id),e.mutationToDom){var a=e.mutationToDom();a&&(a.hasChildNodes()||a.hasAttributes())&&r.appendChild(a)}if(VR(e,r),a=e.getCommentText()){var h=e.commentModel.size,C=e.commentModel.pinned,D=_t("comment");D.appendChild(ss(a)),D.setAttribute("pinned",C),D.setAttribute("h",h.height),D.setAttribute("w",h.width),r.appendChild(D)}for(e.data&&(a=_t("data"),a.appendChild(ss(e.data)),r.appendChild(a)),a=0;a<e.inputList.length;a++){h=e.inputList[a];var Y=void 0;if(C=true,h.type!==rt.DUMMY){D=h.connection.targetBlock(),h.type===rt.VALUE?Y=_t("value"):h.type===rt.STATEMENT&&(Y=_t("statement"));const ke=h.connection.getShadowDom();!ke||D&&D.isShadow()||Y.appendChild(wm(ke,t)),D&&(D=Mr(D,t),D.nodeType===fn.ELEMENT_NODE&&(Y.appendChild(D),C=false)),Y.setAttribute("name",h.name),C||r.appendChild(Y)}}e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&r.setAttribute("inline",e.inputsInline.toString()),e.isCollapsed()&&r.setAttribute("collapsed","true"),e.isEnabled()||r.setAttribute("disabled","true"),e.isDeletable()||e.isShadow()||r.setAttribute("deletable","false"),e.isMovable()||e.isShadow()||r.setAttribute("movable","false"),e.isEditable()||r.setAttribute("editable","false"),Y=e.getNextBlock();let pe;return Y&&(a=Mr(Y,t),a.nodeType===fn.ELEMENT_NODE&&(pe=_t("next"),pe.appendChild(a),r.appendChild(pe))),e=e.nextConnection&&e.nextConnection.getShadowDom(),!e||Y&&Y.isShadow()||pe.appendChild(wm(e,t)),r},wm=function(e,t){let r=e=e.cloneNode(true),a;for(;r;)if(t&&r.nodeName==="shadow"&&r.removeAttribute("id"),r.firstChild)r=r.firstChild;else{for(;r&&!r.nextSibling;){a=r,r=r.parentNode;let h;a.nodeType===fn.TEXT_NODE&&a.data.trim()===""&&((h=r)==null?void 0:h.firstChild)!==a&&x(a)}r&&(a=r,r=r.nextSibling,a.nodeType===fn.TEXT_NODE&&a.data.trim()===""&&x(a))}return e},Di=function(e){return wa(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},WR=function(e){e=Di(e).split("<");let t="";for(let r=1;r<e.length;r++){const a=e[r];a[0]==="/"&&(t=t.substring(2)),e[r]=t+"<"+a,a[0]!=="/"&&a.slice(-2)!=="/>"&&(t+="  ")}return e=e.join(`
`),e=e.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),e.replace(/^\n/,"")},js=function(e){const t=fi(e);if(!t||!t.documentElement||t.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+e);return t.documentElement},zR=function(e,t){return t.setResizesEnabled(false),t.clear(),e=Da(e,t),t.setResizesEnabled(true),e},Da=function(e,t){let r=0;t.RTL&&(r=t.getWidth());const a=[];De();const h=Ft();h||We(true),t.setResizesEnabled&&t.setResizesEnabled(false);let C=true;try{for(let D=0,Y;Y=e.childNodes[D];D++){const pe=Y.nodeName.toLowerCase(),ke=Y;if(pe==="block"||pe==="shadow"&&!Us()){const ft=Co(ke,t);a.push(ft.id);const zt=ke.hasAttribute("x")?parseInt(ke.getAttribute("x")):10,yi=ke.hasAttribute("y")?parseInt(ke.getAttribute("y")):10;isNaN(zt)||isNaN(yi)||ft.moveBy(t.RTL?r-zt:zt,yi),C=false}else{if(pe==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(pe==="comment")t.rendered?Gs.fromXmlRendered(ke,t,r):vn.fromXml(ke,t);else if(pe==="variables"){if(C)Am(ke,t);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");C=false}}}}finally{h||We(false),$e()}return t.setResizesEnabled&&t.setResizesEnabled(true),Pe(new(Te(Go))(t)),a},jR=function(e,t){if(!t.getBlocksBoundingBox)return Da(e,t);var r=t.getBlocksBoundingBox();if(e=Da(e,t),r&&r.top!==r.bottom){var a=r.bottom;r=t.RTL?r.right:r.left;var h=1/0;let C=-1/0,D=1/0;for(let Y=0;Y<e.length;Y++){const pe=t.getBlockById(e[Y]).getRelativeToSurfaceXY();pe.y<D&&(D=pe.y),pe.x<h&&(h=pe.x),pe.x>C&&(C=pe.x)}for(a=a-D+10,r=t.RTL?r-C:r-h,h=0;h<e.length;h++)t.getBlockById(e[h]).moveBy(r,a)}return e},Co=function(e,t){Jt();var r=t.getAllVariables();let a;try{if(a=Nh(e,t),t.rendered){const h=a,C=a.getDescendants(false);h.setConnectionTracking(false);for(let D=C.length-1;0<=D;D--)C[D].initSvg();for(let D=C.length-1;0<=D;D--)C[D].render(false);setTimeout(function(){h.disposed||h.setConnectionTracking(true)},1),h.updateDisabled(),t.resizeContents()}else{const h=a.getDescendants(false);for(let C=h.length-1;0<=C;C--)h[C].initModel()}}finally{Zt()}if(ls()){for(e=ms(t,r),t=0;t<e.length;t++)r=e[t],Pe(new(Te(Hr))(r));Pe(new(Te(ws))(a))}return a},Am=function(e,t){for(let r=0;r<e.children.length;r++){const a=e.children[r],h=a.getAttribute("type"),C=a.getAttribute("id");t.createVariable(a.textContent,h,C)}},XR=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let r=0;r<e.children.length;r++){const a=e.children[r];if(a.nodeType!==fn.TEXT_NODE)switch(a.nodeName.toLowerCase()){case"mutation":t.mutation.push(a);break;case"comment":t.comment.push(a);break;case"data":t.data.push(a);break;case"title":case"field":t.field.push(a);break;case"value":case"statement":t.input.push(a);break;case"next":t.next.push(a);break;default:console.warn("Ignoring unknown tag: "+a.nodeName)}}return t},KR=function(e,t){let r=false;for(let a=0;a<e.length;a++){const h=e[a];t.domToMutation&&(t.domToMutation(h),t.initSvg&&(r=true))}return r},YR=function(e,t){for(let a=0;a<e.length;a++){var r=e[a];const h=r.textContent,C=r.getAttribute("pinned")==="true",D=parseInt(r.getAttribute("w"));if(r=parseInt(r.getAttribute("h")),t.setCommentText(h),t.commentModel.pinned=C,isNaN(D)||isNaN(r)||(t.commentModel.size=new $s(D,r)),C&&t.getCommentIcon&&!t.isInFlyout){const Y=t;setTimeout(function(){Y.getCommentIcon().setVisible(true)},1)}}},qR=function(e,t){for(let r=0;r<e.length;r++)t.data=e[r].textContent},JR=function(e,t){for(let r=0;r<e.length;r++){const a=e[r],h=a.getAttribute("name");eI(t,h,a)}},Lm=function(e){const t={childBlockElement:null,childShadowElement:null};for(let r=0;r<e.childNodes.length;r++){const a=e.childNodes[r];a.nodeType===fn.ELEMENT_NODE&&(a.nodeName.toLowerCase()==="block"?t.childBlockElement=a:a.nodeName.toLowerCase()==="shadow"&&(t.childShadowElement=a))}return t},ZR=function(e,t,r,a){for(let C=0;C<e.length;C++){var h=e[C];const D=h.getAttribute("name"),Y=r.getInput(D);if(!Y){console.warn("Ignoring non-existent input "+D+" in block "+a);break}if(h=Lm(h),h.childBlockElement){if(!Y.connection)throw TypeError("Input connection does not exist.");Nh(h.childBlockElement,t,Y.connection,false)}if(h.childShadowElement){let pe;(pe=Y.connection)==null||pe.setShadowDom(h.childShadowElement)}}},QR=function(e,t,r){for(let a=0;a<e.length;a++){const h=Lm(e[a]);if(h.childBlockElement){if(!r.nextConnection)throw TypeError("Next statement does not exist.");if(r.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Nh(h.childBlockElement,t,r.nextConnection,true)}h.childShadowElement&&r.nextConnection&&r.nextConnection.setShadowDom(h.childShadowElement)}},Nh=function(e,t,r,a){const h=e.getAttribute("type");if(!h)throw TypeError("Block type unspecified: "+e.outerHTML);var C=e.getAttribute("id");C=t.newBlock(h,C);const D=XR(e),Y=KR(D.mutation,C);if(YR(D.comment,C),qR(D.data,C),r)if(a)if(C.previousConnection)r.connect(C.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(C.outputConnection)r.connect(C.outputConnection);else if(C.previousConnection)r.connect(C.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(JR(D.field,C),ZR(D.input,t,C,h),QR(D.next,t,C),Y&&C.initSvg(),(t=e.getAttribute("inline"))&&C.setInputsInline(t==="true"),(t=e.getAttribute("disabled"))&&C.setEnabled(t!=="true"&&t!=="disabled"),(t=e.getAttribute("deletable"))&&C.setDeletable(t==="true"),(t=e.getAttribute("movable"))&&C.setMovable(t==="true"),(t=e.getAttribute("editable"))&&C.setEditable(t==="true"),(t=e.getAttribute("collapsed"))&&C.setCollapsed(t==="true"),e.nodeName.toLowerCase()==="shadow"){for(e=C.getChildren(false),t=0;t<e.length;t++)if(!e[t].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(C.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");C.setShadow(true)}return C},eI=function(e,t,r){const a=e.getField(t);a?a.fromXml(r):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},tI=function(e){for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];if(r.nodeName.toLowerCase()==="next"){e.removeChild(r);break}}},sI=function(e,t){return o("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith"),e.startsWith(t)},$c=function(e){return e.length?e.reduce(function(t,r){return t.length<r.length?t:r}).length:0},Nm=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||$c(e);let a;for(a=0;a<t;a++){for(var h=e[0][a],C=1;C<e.length;C++)if(h!==e[C][a])return r;h===" "&&(r=a+1)}for(h=1;h<e.length;h++)if((C=e[h][a])&&C!==" ")return r;return t},Mm=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||$c(e);let a;for(a=0;a<t;a++){for(var h=e[0].substr(-a-1,1),C=1;C<e.length;C++)if(h!==e[C].substr(-a-1,1))return r;h===" "&&(r=a+1)}for(h=1;h<e.length;h++)if((C=e[h].charAt(e[h].length-a-1))&&C!==" ")return r;return t},Dm=function(e,t){e=e.split(`
`);for(let r=0;r<e.length;r++)e[r]=iI(e[r],t);return e.join(`
`)},iI=function(e,t){if(e.length<=t)return e;const r=e.trim().split(/\s+/);for(var a=0;a<r.length;a++)r[a].length>t&&(t=r[a].length);var h=-1/0;let C,D=1;do{a=h,C=e,e=[],h=r.length/D;let Y=1;for(let pe=0;pe<r.length-1;pe++)Y<(pe+1.5)/h?(Y++,e[pe]=true):e[pe]=false;e=xm(r,e,t),h=Mh(r,e,t),e=nI(r,e),D++}while(h>a);return C},Mh=function(e,t,r){const a=[0],h=[];for(var C=0;C<e.length;C++)a[a.length-1]+=e[C].length,t[C]===true?(a.push(0),h.push(e[C].charAt(e[C].length-1))):t[C]===false&&a[a.length-1]++;for(e=Math.max(...a),t=0,C=0;C<a.length;C++)t-=2*Math.pow(Math.abs(r-a[C]),1.5),t-=Math.pow(e-a[C],1.5),".?!".indexOf(h[C])!==-1?t+=r/3:",;)]}".indexOf(h[C])!==-1&&(t+=r/4);return 1<a.length&&a[a.length-1]<=a[a.length-2]&&(t+=.5),t},xm=function(e,t,r){let a=Mh(e,t,r),h;for(let C=0;C<t.length-1;C++){if(t[C]===t[C+1])continue;const D=[].concat(t);D[C]=!D[C],D[C+1]=!D[C+1];const Y=Mh(e,D,r);Y>a&&(a=Y,h=D)}return h?xm(e,h,r):t},nI=function(e,t){const r=[];for(let a=0;a<e.length;a++)r.push(e[a]),t[a]!==void 0&&r.push(t[a]?`
`:" ");return r.join("")},Bm=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},rI=function(e){au=e},oI=function(){return au},aI=function(){return el},lI=function(){return _s},xa=function(e){if(e=Pm(e)){for(e=e.tooltip;typeof e=="function";)e=e();if(typeof e!="string")throw Error("Tooltip function must return a string.");return e}return""},Pm=function(e){for(;e&&e.tooltip;){if(typeof e.tooltip=="string"||typeof e.tooltip=="function")return e;e=e.tooltip}return null},Um=function(){_s||(_s=document.createElement("div"),_s.className="blocklyTooltipDiv",(z()||document.body).appendChild(_s))},yc=function(e){e.mouseOverWrapper_=y(e,"pointerover",null,cI),e.mouseOutWrapper_=y(e,"pointerout",null,uI),e.addEventListener("pointermove",Fm,false)},Rc=function(e){e&&(f(e.mouseOverWrapper_),f(e.mouseOutWrapper_),e.removeEventListener("pointermove",Fm))},cI=function(e){Wo||(e=Pm(e.currentTarget),Bi!==e&&(Dr(),sl=null,Bi=e),clearTimeout(Iv))},uI=function(e){Wo||(Iv=setTimeout(function(){sl=Bi=null,Dr()},1),clearTimeout(tl))},Fm=function(e){if(Bi&&Bi.tooltip&&!Wo)if(el){const t=Md-e.pageX;e=Dd-e.pageY,Math.sqrt(t*t+e*e)>Cv&&Dr()}else sl!==Bi&&(clearTimeout(tl),Md=e.pageX,Dd=e.pageY,tl=setTimeout(pI,Ov))},Gm=function(){sl=Bi=null,Dr()},Dr=function(){el&&(el=false,_s&&(_s.style.display="none")),tl&&clearTimeout(tl)},Hm=function(){Dr(),Wo=true},Vm=function(){Wo=false},hI=function(){_s&&Bi&&(typeof au=="function"?au(_s,Bi):dI())},dI=function(){var e=xa(Bi);e=Dm(e,Rv),e=e.split(`
`);for(let t=0;t<e.length;t++){const r=document.createElement("div");r.appendChild(document.createTextNode(e[t])),_s.appendChild(r)}},_I=function(e){const t=document.documentElement.clientWidth,r=document.documentElement.clientHeight;let a=Md;a=e?a-(xd+_s.offsetWidth):a+xd;let h=Dd+Bd;return h+_s.offsetHeight>r+window.scrollY&&(h-=_s.offsetHeight+2*Bd),e?a=Math.max(lu-window.scrollX,a):a+_s.offsetWidth>t+window.scrollX-2*lu&&(a=t-_s.offsetWidth-2*lu),{x:a,y:h}},pI=function(){if(!Wo&&(sl=Bi,_s)){_s.textContent="",hI();var e=Bi.RTL;_s.style.direction=e?"rtl":"ltr",_s.style.display="block",el=true;var{x:t,y:r}=_I(e);_s.style.left=t+"px",_s.style.top=r+"px"}},Wm=function(){return Pd},gI=function(e){Pd=e},zm=function(){return Ud},fI=function(e){Ud=e},xr=function(e){e=String(e).toLowerCase().trim();var t=kv[e];if(t||(t=e.substring(0,2)==="0x"?"#"+e.substring(2):e,t=t[0]==="#"?t:"#"+t,/^#[0-9a-f]{6}$/.test(t)))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var r=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return r&&(e=Number(r[1]),t=Number(r[2]),r=Number(r[3]),0<=e&&256>e&&0<=t&&256>t&&0<=r&&256>r)?Ic(e,t,r):null},Ic=function(e,t,r){return t=e<<16|t<<8|r,16>e?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},Dh=function(e){return e=xr(e),e?(e=parseInt(e.substr(1),16),[e>>16,e>>8&255,e&255]):[0,0,0]},xh=function(e,t,r){let a=0,h=0,C=0;if(t===0)C=h=a=r;else{const D=Math.floor(e/60),Y=e/60-D;e=r*(1-t);const pe=r*(1-t*Y);switch(t=r*(1-t*(1-Y)),D){case 1:a=pe,h=r,C=e;break;case 2:a=e,h=r,C=t;break;case 3:a=e,h=pe,C=r;break;case 4:a=t,h=e,C=r;break;case 5:a=r,h=e,C=pe;break;case 6:case 0:a=r,h=t,C=e}}return Ic(Math.floor(a),Math.floor(h),Math.floor(C))},Oo=function(e,t,r){return e=xr(e),!e||(t=xr(t),!t)?null:(e=Dh(e),t=Dh(t),Ic(Math.round(t[0]+r*(e[0]-t[0])),Math.round(t[1]+r*(e[1]-t[1])),Math.round(t[2]+r*(e[2]-t[2]))))},Bh=function(e){return xh(e,Pd,255*Ud)},Ph=function(e,t){const r=[];var a=e.split("");a.push("");var h=0;e=[];let C=null;for(let pe=0;pe<a.length;pe++){var D=a[pe];if(h===0)D==="%"?((h=e.join(""))&&r.push(h),e.length=0,h=1):e.push(D);else if(h===1)D==="%"?(e.push(D),h=0):t&&"0"<=D&&"9">=D?(h=2,C=D,(D=e.join(""))&&r.push(D),e.length=0):D==="{"?h=3:(e.push("%",D),h=0);else if(h===2)if("0"<=D&&"9">=D)C+=D;else{var Y=void 0;r.push(parseInt((Y=C)!=null?Y:"",10)),pe--,h=0}else h===3&&(D===""?(e.splice(0,0,"%{"),pe--,h=0):D!=="}"?e.push(D):(h=e.join(""),/[A-Z]\w*/i.test(h)?(D=h.toUpperCase(),(D=D.startsWith("BKY_")?D.substring(4):null)&&D in Ye?(h=Ye[D],typeof h=="string"?Array.prototype.push.apply(r,Ph(h,t)):t?r.push(String(h)):r.push(h)):r.push("%{"+h+"}")):r.push("%{"+h+"}"),h=e.length=0))}for((t=e.join(""))&&r.push(t),Y=[],e.length=0,a=0;a<r.length;a++)typeof r[a]=="string"?e.push(r[a]):((t=e.join(""))&&Y.push(t),e.length=0,Y.push(r[a]));return(t=e.join(""))&&Y.push(t),e.length=0,Y},Uh=function(e){return Ph(e,true)},Qt=function(e){return typeof e!="string"?e:(e=Ph(e,false),e.length?String(e[0]):"")},Cc=function(e){let t=true;const r=Ye,a=e.match(/%{BKY_[A-Z]\w*}/ig);if(a)for(let h=0;h<a.length;h++){const C=a[h].toUpperCase();r[C.slice(6,-1)]===void 0&&(console.warn("No message string for "+a[h]+" in "+e),t=false)}return t},ko=function(e){const t=typeof e=="string"?Qt(e):e;var r=Number(t);if(!isNaN(r)&&0<=r&&360>=r)return{hue:r,hex:xh(r,Wm(),255*zm())};if(r=xr(t))return{hue:null,hex:r};throw r='Invalid colour: "'+t+'"',e!==t&&(r+=' (from "'+e+'")'),Error(r)},wo=function(){return Qi},mI=function(e){Qi=e},jm=function(){Qi||(Qi=document.createElement("div"),Qi.className="blocklyWidgetDiv",(z()||document.body).appendChild(Qi))},Fh=function(e,t,r){pn(),cu=e,uu=r,(e=Qi)&&(e.style.direction=t?"rtl":"ltr",e.style.display="block",t=k(),zo=t.getRenderer().getClassName(),jo=t.getTheme().getClassName(),zo&&ne(e,zo),jo&&ne(e,jo))},pn=function(){if(Xm()){cu=null;var e=Qi;e&&(e.style.display="none",e.style.left="",e.style.top="",uu&&uu(),uu=null,e.textContent="",zo&&(de(e,zo),zo=""),jo&&(de(e,jo),jo=""),k().markFocused())}},Xm=function(){return!!cu},Gh=function(e){cu===e&&pn()},Km=function(e,t,r){Qi.style.left=e+"px",Qi.style.top=t+"px",Qi.style.height=r+"px"},Ym=function(e,t,r,a){const h=vI(e,t,r);e=EI(e,t,r,a),0>h?Km(e,0,r.height+h):Km(e,h,r.height)},EI=function(e,t,r,a){return a?Math.min(Math.max(t.right-r.width,e.left),e.right-r.width):Math.max(Math.min(t.left,e.right-r.width),e.left)},vI=function(e,t,r){return t.bottom+r.height>=e.bottom?t.top-r.height:t.bottom},xi=function(e,t){ye(Se.FIELD,e,t)},bI=function(e){Vt(Se.FIELD,e)},Hh=function(e){return wv.fromJsonInternal(e)},TI=function(e){const t=vo(Se.FIELD,e.type);if(t){if(typeof t.fromJson!="function")throw new TypeError("returned Field was not a IRegistrableField");return t.fromJson(e)}return console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null},gn=function(e,t){e.setAttribute(fO,t)},Xt=function(e,t,r){Array.isArray(r)&&(r=r.join(" ")),e.setAttribute(gO+t,`${r}`)},SI=function(e){return e!==pt.SKIP_SETUP},$I=function(e){let t=false;const r=e.map(([D,Y])=>typeof D=="string"?[Qt(D),Y]:(t=true,[D.alt!==null?Object.assign({},D,{alt:Qt(D.alt)}):Object.assign({},D),Y]));if(t||2>e.length)return{options:r};var a=r.map(([D])=>D),h=$c(a);e=Nm(a,h);const C=Mm(a,h);return!e&&!C||h<=e+C?{options:r}:(h=e?a[0].substring(0,e-1):void 0,a=C?a[0].substr(1-C):void 0,{options:yI(r,e,C),prefix:h,suffix:a})},yI=function(e,t,r){return e.map(([a,h])=>[a.substring(t,a.length-r),h])},qm=function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=false;for(let r=0;r<e.length;r++){const a=e[r];Array.isArray(a)?typeof a[1]!="string"?(t=true,console.error("Invalid option["+r+"]: Each FieldDropdown option id must be a string. Found "+a[1]+" in: ",a)):a[0]&&typeof a[0]!="string"&&typeof a[0].src!="string"&&(t=true,console.error("Invalid option["+r+"]: Each FieldDropdown option must have a string label or image description. Found"+a[0]+" in: ",a)):(t=true,console.error("Invalid option["+r+"]: Each FieldDropdown option must be an array. Found: ",a))}if(t)throw TypeError("Found invalid FieldDropdown options.")},RI=function(e,t){o("Blockly.utils.object.inherits","version 9","version 10"),e.superClass_=t.prototype,Object.setPrototypeOf(e,t),e.prototype=Object.create(t.prototype),e.prototype.constructor=e},II=function(e,t){o("Blockly.utils.object.mixin","May 2022","May 2023","Object.assign");for(const r in t)e[r]=t[r]},nr=function(e,t){for(const r in t)e[r]=t[r]!==null&&typeof t[r]=="object"?nr(e[r]||Object.create(null),t[r]):t[r];return e},CI=function(e){return o("Blockly.utils.object.values","version 9","version 10","Object.values"),Object.values(e)},Oc=function(e){return e?((e instanceof Element||typeof e=="string")&&(e=Zm(e),e=wI(e)),OI(e),e):null},OI=function(e){const t=e.kind;if(e=e.contents,t&&t!==Lv&&t!==zd)throw Error("Invalid toolbox kind "+t+". Please supply either "+Lv+" or "+zd);if(!e)throw Error("Toolbox must have a contents attribute.")},kc=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:zh(e):[]},Vh=function(e){return Nv.hasCategoriesInternal(e)},kI=function(e){if(!e)return false;const t=e.kind;return t?t===zd:!!e.contents.filter(function(r){return r.kind.toUpperCase()==="CATEGORY"}).length},Wh=function(e){return e&&e.contents?!!e.contents.filter(function(t){return t.kind.toUpperCase()==="CATEGORY"}).length:false},wI=function(e){const t={contents:zh(e)};return e instanceof Node&&Jm(e,t),t},zh=function(e){const t=[];let r=e.childNodes;r||(r=e);for(let a=0,h;h=r[a];a++){if(!h.tagName)continue;e={};const C=h.tagName.toUpperCase();e.kind=C,C==="BLOCK"?e.blockxml=h:h.childNodes&&0<h.childNodes.length&&(e.contents=zh(h)),Jm(h,e),t.push(e)}return t},Jm=function(e,t){for(let r=0;r<e.attributes.length;r++){const a=e.attributes[r];-1<a.nodeName.indexOf("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[a.nodeName.replace("css-","")]=a.value):t[a.nodeName]=a.value}},Zm=function(e){let t=null;if(e)if(typeof e=="string"){if(t=js(e),t.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},wc=function(e,t){if(typeof e!="string"||e.trim()==="")throw Error('Error: Invalid extension name "'+e+'"');if(Xo[e])throw Error('Error: Extension "'+e+'" is already registered.');if(typeof t!="function")throw Error('Error: Extension "'+e+'" must be a function');Xo[e]=t},AI=function(e,t){if(!t||typeof t!="object")throw Error('Error: Mixin "'+e+'" must be a object');wc(e,function(){this.mixin(t)})},LI=function(e,t,r,a){const h='Error when registering mutator "'+e+'": ';tE(h,t);const C=eE(t,h);if(r&&typeof r!="function")throw Error(h+'Extension "'+e+'" is not a function');wc(e,function(){C&&this.setMutator(new i.Mutator$$module$build$src$core$mutator(a||[],this)),this.mixin(t),r&&r.apply(this)})},NI=function(e){Qm(e)?delete Xo[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},Qm=function(e){return!!Xo[e]},jh=function(e,t,r){const a=Xo[e];if(typeof a!="function")throw Error('Error: Extension "'+e+'" not found.');let h;if(r?MI(e,t):h=Kh(t),a.apply(t),r)tE('Error after applying mutator "'+e+'": ',t);else if(!BI(h,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},MI=function(e,t){if(Kh(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},DI=function(e,t){return Xh(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},xI=function(e,t){return Xh(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},eE=function(e,t){return Xh(e.compose,e.decompose,t+" compose/decompose")},Xh=function(e,t,r){if(e&&t){if(typeof e!="function"||typeof t!="function")throw Error(r+" must be a function");return true}if(!e&&!t)return false;throw Error(r+"Must have both or neither functions")},tE=function(e,t){const r=DI(t,e),a=xI(t,e);if(!r&&!a)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");eE(t,e)},Kh=function(e){const t=[];return e.domToMutation!==void 0&&t.push(e.domToMutation),e.mutationToDom!==void 0&&t.push(e.mutationToDom),e.saveExtraState!==void 0&&t.push(e.saveExtraState),e.loadExtraState!==void 0&&t.push(e.loadExtraState),e.compose!==void 0&&t.push(e.compose),e.decompose!==void 0&&t.push(e.decompose),t},BI=function(e,t){if(t=Kh(t),t.length!==e.length)return false;for(let r=0;r<t.length;r++)if(e[r]!==t[r])return false;return true},Ac=function(e){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")e();else{const t=setInterval(function(){document.readyState==="complete"&&(clearInterval(t),e())},10)}},PI=function(e,t){const r=[];return typeof document=="object"&&Ac(function(){for(const a in t)Cc(t[a])}),function(){this.type&&r.indexOf(this.type)===-1&&(UI(this,e,t),r.push(this.type)),this.setTooltip(function(){var a=String(this.getFieldValue(e));let h=t[a];return h===null?r.indexOf(this.type)===-1&&(a="No tooltip mapping for value "+a+" of field "+e,this.type!==null&&(a+=" of block type "+this.type),console.warn(a+".")):h=Qt(h),h}.bind(this))}},UI=function(e,t,r){var a=e.getField(t);if(a instanceof tn&&!a.isOptionListDynamic()){a=a.getOptions();for(let h=0;h<a.length;h++){const C=a[h][1];r[C]===null&&console.warn("No tooltip mapping for value "+C+" of field "+t+" of block type "+e.type)}}},FI=function(e,t){return typeof document=="object"&&Ac(function(){Cc(e)}),function(){this.setTooltip(function(){const r=this.getField(t);return Qt(e).replace("%1",r?r.getText():"")}.bind(this))}},GI=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},ii=function(e,t){return t=e.indexOf(t),t===-1?false:(e.splice(t,1),true)},Ge=function(e,t){return" "+e+","+t+" "},Ei=function(e,t){return" "+e+t.join("")},Fs=function(e,t){return" M "+e+","+t+" "},Wt=function(e,t){return" m "+e+","+t+" "},Nn=function(e,t){return" l "+e+","+t+" "},Ba=function(e){return" l"+e.join("")},Ne=function(e,t){return" "+e+" "+t+" "},ds=function(e,t,r,a){return e+" "+r+" "+r+" "+t+a},HI=function(e){return o("Blockly.utils.getRelativeXY","December 2021","December 2022","Blockly.utils.svgMath.getRelativeXY"),mi(e)},VI=function(e){return o("Blockly.utils.getInjectionDivXY_","December 2021","December 2022","Blockly.utils.svgMath.getInjectionDivXY"),Tc(e)},WI=function(e){return o("Blockly.utils.tokenizeInterpolation","December 2021","December 2022","Blockly.utils.parsing.tokenizeInterpolation"),Uh(e)},zI=function(e){return o("Blockly.utils.replaceMessageReferences","December 2021","December 2022","Blockly.utils.parsing.replaceMessageReferences"),Qt(e)},jI=function(e){return o("Blockly.utils.checkMessageReferences","December 2021","December 2022","Blockly.utils.parsing.checkMessageReferences"),Cc(e)},XI=function(){return o("Blockly.utils.is3dSupported","December 2021","December 2022","Blockly.utils.svgMath.is3dSupported"),Cm()},KI=function(){return o("Blockly.utils.getViewportBBox","December 2021","December 2022","Blockly.utils.svgMath.getViewportBBox"),Ah()},YI=function(e,t){return o("Blockly.utils.arrayRemove","December 2021","December 2022","Blockly.array.removeElem"),ii(e,t)},qI=function(){return o("Blockly.utils.getDocumentScroll","December 2021","December 2022","Blockly.utils.svgMath.getDocumentScroll"),Lh()},JI=function(e,t){return o("Blockly.utils.getBlockTypeCounts","December 2021","December 2022","Blockly.common.getBlockTypeCounts"),K(e,t)},ZI=function(e,t){return o("Blockly.utils.screenToWsCoordinates","December 2021","December 2022","Blockly.utils.svgMath.screenToWsCoordinates"),Om(e,t)},QI=function(e){return o("Blockly.utils.parseBlockColour","December 2021","December 2022","Blockly.utils.parsing.parseBlockColour"),ko(e)},eC=function(e){o("Blockly.utils.runAfterPageLoad","December 2021","December 2022"),Ac(e)},Yh=function(e,t){ye(Se.SERIALIZER,e,t)},tC=function(e){Vt(Se.SERIALIZER,e)},Mn=function(e,{addCoordinates:t=false,addInputBlocks:r=true,addNextBlocks:a=true,doFullSerialization:h=true}={}){if(e.isInsertionMarker())return null;const C={type:e.type,id:e.id};return t&&iC(e,C),sC(e,C),nC(e,C),rC(e,C),oC(e,C,h),r&&aC(e,C,h),a&&lC(e,C,h),C},sC=function(e,t){e.isCollapsed()&&(t.collapsed=true),e.isEnabled()||(t.enabled=false),e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},iC=function(e,t){const r=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(r.RTL?r.getWidth()-e.x:e.x),t.y=Math.round(e.y)},nC=function(e,t){e.saveExtraState?(e=e.saveExtraState(),e!==null&&(t.extraState=e)):e.mutationToDom&&(e=e.mutationToDom(),e!==null&&(t.extraState=Di(e).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},rC=function(e,t){e.getCommentText()&&(t.icons={comment:{text:e.getCommentText(),pinned:e.commentModel.pinned,height:Math.round(e.commentModel.size.height),width:Math.round(e.commentModel.size.width)}})},oC=function(e,t,r){const a=Object.create(null);for(let h=0;h<e.inputList.length;h++){const C=e.inputList[h];for(let D=0;D<C.fieldRow.length;D++){const Y=C.fieldRow[D];Y.isSerializable()&&(a[Y.name]=Y.saveState(r))}}Object.keys(a).length&&(t.fields=a)},aC=function(e,t,r){const a=Object.create(null);for(let h=0;h<e.inputList.length;h++){const C=e.inputList[h];if(C.type===rt.DUMMY)continue;const D=sE(C.connection,r);D&&(a[C.name]=D)}Object.keys(a).length&&(t.inputs=a)},lC=function(e,t,r){e.nextConnection&&(e=sE(e.nextConnection,r))&&(t.next=e)},sE=function(e,t){const r=e.getShadowState(true);if(e=e.targetBlock(),!r&&!e)return null;const a=Object.create(null);return r&&(a.shadow=r),e&&!e.isShadow()&&(a.block=Mn(e,{doFullSerialization:t})),a},Br=function(e,t,{recordUndo:r=false}={}){return qh(e,t,{recordUndo:r})},qh=function(e,t,{parentConnection:r,isShadow:a=false,recordUndo:h=false}={}){const C=Us();Ps(h),(h=Ft())||We(true),Jt();const D=iE(e,t,{parentConnection:r,isShadow:a});return Zt(),Pe(new(Te(ws))(D)),We(h),Ps(C),t.rendered&&setTimeout(()=>{D.disposed||D.setConnectionTracking(true)},1),D},iE=function(e,t,{parentConnection:r,isShadow:a=false}={}){if(!e.type)throw new xv(e);const h=t.newBlock(e.type,e.id);return h.setShadow(a),cC(h,e),uC(h,e),hC(h,e),dC(r,h,e),_C(h,e),pC(h,e),gC(h,e),fC(h,e),mC(h,t.rendered),h},cC=function(e,t){let r=t.x===void 0?0:t.x;t=t.y===void 0?0:t.y;const a=e.workspace;r=a.RTL?a.getWidth()-r:r,e.moveBy(r,t)},uC=function(e,t){t.collapsed&&e.setCollapsed(true),t.enabled===false&&e.setEnabled(false),t.inline!==void 0&&e.setInputsInline(t.inline),t.data!==void 0&&(e.data=t.data)},hC=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(js(t.extraState)))},dC=function(e,t,r){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new Pv(r);if(e.type===rt.VALUE){var a=t.outputConnection;if(!a)throw new ll("output",t,r)}else if(a=t.previousConnection,!a)throw new ll("previous",t,r);if(!e.connect(a)){const h=t.workspace.connectionChecker;throw new Bv(h.getErrorMessage(h.canConnectWithReason(a,e,false),a,e),e.type===rt.VALUE?"output connection":"previous connection",t,r)}}},_C=function(e,t){t.icons&&(t=t.icons.comment)&&(e.setCommentText(t.text),"pinned"in t&&(e.commentModel.pinned=t.pinned),"width"in t&&"height"in t&&(e.commentModel.size=new $s(t.width,t.height)),t.pinned&&e.rendered&&!e.isInFlyout&&setTimeout(()=>e.getCommentIcon().setVisible(true),1))},pC=function(e,t){if(t.fields){var r=Object.keys(t.fields);for(let a=0;a<r.length;a++){const h=r[a],C=t.fields[h],D=e.getField(h);D?D.loadState(C):console.warn(`Ignoring non-existant field ${h} in block ${e.type}`)}}},gC=function(e,t){if(t.inputs){var r=Object.keys(t.inputs);for(let a=0;a<r.length;a++){const h=r[a],C=e.getInput(h);if(!C||!C.connection)throw new ll(h,e,t);nE(C.connection,t.inputs[h])}}},fC=function(e,t){if(t.next){if(!e.nextConnection)throw new ll("next",e,t);nE(e.nextConnection,t.next)}},nE=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&iE(t.block,e.getSourceBlock().workspace,{parentConnection:e})},mC=function(e,t){if(t)for(e.setConnectionTracking(false),e.initSvg(),e.render(false),e=e.getIcons(),t=0;t<e.length;t++)e[t].computeIconLocation();else e.initModel()},EC=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},vC=function(e,t){let r=null;t=t.outputConnection;const a=t.getConnectionChecker();for(let h=0,C;C=e.inputList[h];h++){const D=C.connection;if(D&&a.canConnect(t,D,false)){if(r)return null;r=D}}return r},bC=function(e,t){let r;for(;r=vC(e,t);)if(e=r.targetBlock(),!e||e.isShadow())return r;return null},Lc=function(e){let t=e.outputConnection;return(!t||e.previousConnection&&e.previousConnection.isConnected())&&(t=e.previousConnection),t},rE=function(e){const t=e.workspace;var r=e.getSvgRoot();t.getAudioManager().play("delete");const a=t.getSvgXY(r);r=r.cloneNode(true),r.setAttribute("transform","translate("+a.x+","+a.y+")"),t.getParentSvg().appendChild(r),oE(r,{x:a.x,y:a.y,width:e.width,height:e.height},t.RTL,new Date,t.scale)},oE=function(e,t,r,a,h){const C=(new Date().getTime()-a.getTime())/150;1<C?x(e):(e.setAttribute("transform","translate("+(t.x+(r?-1:1)*t.width*h/2*C)+","+(t.y+t.height*h*C)+") scale("+(1-C)*h+")"),setTimeout(oE,10,e,t,r,a,h))},aE=function(e){const t=e.workspace,r=t.scale;if(t.getAudioManager().play("click"),!(1>r)){var a=t.getSvgXY(e.getSvgRoot());e.outputConnection?(a.x+=(e.RTL?3:-3)*r,a.y+=13*r):e.previousConnection&&(a.x+=(e.RTL?-23:23)*r,a.y+=3*r),e=H(Q.CIRCLE,{cx:a.x,cy:a.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg()),lE(e,new Date,r)}},lE=function(e,t,r){const a=(new Date().getTime()-t.getTime())/150;1<a?x(e):(e.setAttribute("r",(25*a*r).toString()),e.style.opacity=(1-a).toString(),pu=setTimeout(lE,10,e,t,r))},cE=function(e){if(Pa(),e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),dl=e.getSvgRoot(),uE(dl,t,new Date)}},uE=function(e,t,r){const a=(new Date().getTime()-r.getTime())/200;let h="";1>=a&&(h=`skewX(${Math.round(Math.sin(a*Math.PI*3)*(1-a)*t)})`,pu=setTimeout(uE,10,e,t,r)),e.skew_=h,e.setAttribute("transform",e.translate_+e.skew_)},Pa=function(){if(dl){pu&&clearTimeout(pu);const e=dl;e.skew_="",e.setAttribute("transform",e.translate_),dl=null}},Ua=function(e){Zd.copyInternal(e)},TC=function(e){Hn=e.toCopyData()},Jh=function(){if(!Hn)return null;let e=Hn.source;return e.isFlyout&&(e=e.targetWorkspace),Hn.typeCounts&&e.isCapacityAvailable(Hn.typeCounts)?e.paste(Hn.saveInfo):null},Nc=function(e){return Zd.duplicateInternal(e)},SC=function(e){const t=Hn;Ua(e);let r,a,h;return e=(h=(r=e.toCopyData())==null||(a=r.source)==null?void 0:a.paste(Hn.saveInfo))!=null?h:null,Hn=t,e},hE=function(){return gl},dE=function(e){gl=e},Mc=function(e,t,r){if(Fh(Qd,r,_E),t.length){var a=$C(t,r);fl=a,yC(a,e,r),setTimeout(function(){a.focus()},1),gl=null}else Dc()},$C=function(e,t){const r=new Fd;r.setRole(li.MENU);for(let a=0;a<e.length;a++){const h=e[a],C=new Gd(h.text);C.setRightToLeft(t),C.setRole(li.MENUITEM),r.addChild(C),C.setEnabled(h.enabled),h.enabled&&C.onAction(function(){Dc(),h.callback(h.scope)},{})}return r},yC=function(e,t,r){const a=Ah();t=new es(t.clientY+a.top,t.clientY+a.top,t.clientX+a.left,t.clientX+a.left),RC(e);const h=e.getSize();r&&(t.left+=h.width,t.right+=h.width,a.left+=h.width,a.right+=h.width),Ym(a,t,h,r),e.focus()},RC=function(e){var t=wo();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),ne(t,"blocklyContextMenu"),E(t,"contextmenu",null,IC),e.focus()},IC=function(e){e.preventDefault(),e.stopPropagation()},Dc=function(){Gh(Qd),gl=null},_E=function(){fl&&(fl.dispose(),fl=null)},CC=function(e,t){return()=>{Jt();let r;try{r=Co(t,e.workspace);const a=e.getRelativeToSurfaceXY();a.x=e.RTL?a.x-i.config$$module$build$src$core$config.snapRadius:a.x+i.config$$module$build$src$core$config.snapRadius,a.y+=2*i.config$$module$build$src$core$config.snapRadius,r.moveBy(a.x,a.y)}finally{Zt()}ls()&&!r.isShadow()&&Pe(new(Te(ws))(r)),r.select()}},pE=function(e){return{text:Ye.REMOVE_COMMENT,enabled:true,callback:function(){We(true),e.dispose(),We(false)}}},gE=function(e){return{text:Ye.DUPLICATE_COMMENT,enabled:true,callback:function(){Nc(e)}}},OC=function(e,t){const r={enabled:true};return r.text=Ye.ADD_COMMENT,r.callback=function(){const a=new Gs(e,Ye.WORKSPACE_COMMENT_DEFAULT_TEXT,Gs.DEFAULT_SIZE,Gs.DEFAULT_SIZE);var h=e.getInjectionDiv().getBoundingClientRect();h=new Oe(t.clientX-h.left,t.clientY-h.top);const C=e.getOriginOffsetInPixels();h=Oe.difference(h,C),h.scale(1/e.scale),a.moveBy(h.x,h.y),e.rendered&&(a.initSvg(),a.render(),a.select())},r},Zh=function(e,t,r,a,h,C){const D=C.scrollbar&&C.scrollbar.canScrollVertically();return e.horizontal===Jo.LEFT?(r=h.absoluteMetrics.left+r,D&&C.RTL&&(r+=Kt.scrollbarThickness)):(r=h.absoluteMetrics.left+h.viewMetrics.width-t.width-r,D&&!C.RTL&&(r-=Kt.scrollbarThickness)),e.vertical===Vn.TOP?e=h.absoluteMetrics.top+a:(e=h.absoluteMetrics.top+h.viewMetrics.height-t.height-a,C.scrollbar&&C.scrollbar.canScrollHorizontally()&&(e-=Kt.scrollbarThickness)),new es(e,e+t.height,r,r+t.width)},Qh=function(e,t){return{horizontal:t.toolboxMetrics.position===et.LEFT||e.horizontalLayout&&!e.RTL?Jo.RIGHT:Jo.LEFT,vertical:t.toolboxMetrics.position===et.BOTTOM?Vn.TOP:Vn.BOTTOM}},ed=function(e,t,r,a){const h=e.left,C=e.right-e.left,D=e.bottom-e.top;for(let Y=0;Y<a.length;Y++){const pe=a[Y];e.intersects(pe)&&(e=r===dr.UP?pe.top-D-t:pe.bottom+t,e=new es(e,e+D,h,h+C),Y=-1)}return e},fE=function(){It.registry.register({name:Tn.ESCAPE,preconditionFn(e){return!e.options.readOnly},callback(e){return e.hideChaff(),true},keyCodes:[xe.ESC]})},mE=function(){It.registry.register({name:Tn.DELETE,preconditionFn(e){const t=U();return!e.options.readOnly&&t!=null&&t.isDeletable()},callback(e,t){return t.preventDefault(),bn.inProgress()?false:(U().checkAndDelete(),true)},keyCodes:[xe.DELETE,xe.BACKSPACE]})},EE=function(){const e=It.registry.createSerializedKey(xe.C,[xe.CTRL]),t=It.registry.createSerializedKey(xe.C,[xe.ALT]),r=It.registry.createSerializedKey(xe.C,[xe.META]);It.registry.register({name:Tn.COPY,preconditionFn(a){const h=U();return!a.options.readOnly&&!bn.inProgress()&&h!=null&&h.isDeletable()&&h.isMovable()},callback(a,h){return h.preventDefault(),a.hideChaff(),Ua(U()),true},keyCodes:[e,t,r]})},vE=function(){const e=It.registry.createSerializedKey(xe.X,[xe.CTRL]),t=It.registry.createSerializedKey(xe.X,[xe.ALT]),r=It.registry.createSerializedKey(xe.X,[xe.META]);It.registry.register({name:Tn.CUT,preconditionFn(a){const h=U();return!a.options.readOnly&&!bn.inProgress()&&h!=null&&h instanceof Pi&&h.isDeletable()&&h.isMovable()&&!h.workspace.isFlyout},callback(){const a=U();return a?(Ua(a),a.checkAndDelete(),true):false},keyCodes:[e,t,r]})},bE=function(){const e=It.registry.createSerializedKey(xe.V,[xe.CTRL]),t=It.registry.createSerializedKey(xe.V,[xe.ALT]),r=It.registry.createSerializedKey(xe.V,[xe.META]);It.registry.register({name:Tn.PASTE,preconditionFn(a){return!a.options.readOnly&&!bn.inProgress()},callback(){return!!Jh()},keyCodes:[e,t,r]})},TE=function(){const e=It.registry.createSerializedKey(xe.Z,[xe.CTRL]),t=It.registry.createSerializedKey(xe.Z,[xe.ALT]),r=It.registry.createSerializedKey(xe.Z,[xe.META]);It.registry.register({name:Tn.UNDO,preconditionFn(a){return!a.options.readOnly&&!bn.inProgress()},callback(a){return a.hideChaff(),a.undo(false),true},keyCodes:[e,t,r]})},SE=function(){const e=It.registry.createSerializedKey(xe.Z,[xe.SHIFT,xe.CTRL]),t=It.registry.createSerializedKey(xe.Z,[xe.SHIFT,xe.ALT]),r=It.registry.createSerializedKey(xe.Z,[xe.SHIFT,xe.META]),a=It.registry.createSerializedKey(xe.Y,[xe.CTRL]);It.registry.register({name:Tn.REDO,preconditionFn(h){return!bn.inProgress()&&!h.options.readOnly},callback(h){return h.hideChaff(),h.undo(true),true},keyCodes:[e,t,r,a]})},$E=function(){fE(),mE(),EE(),vE(),bE(),TE(),SE()},Ao=function(e){return e.startPublishing!==void 0&&e.stopPublishing!==void 0},kC=function(e){return e.doProcedureUpdate!==void 0},rr=function(e){for(const t of e.getAllBlocks(false))kC(t)&&t.doProcedureUpdate()},td=function(e){const t=e.getBlocksByType("procedures_defnoreturn",false).map(function(r){return r.getProcedureDef()});return e=e.getBlocksByType("procedures_defreturn",false).map(function(r){return r.getProcedureDef()}),t.sort(yE),e.sort(yE),[t,e]},yE=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},RE=function(e,t){if(t.isInFlyout)return e;for(e=e||Ye.UNNAMED_KEY||"unnamed";!wC(e,t.workspace,t);){const r=e.match(/^(.*?)(\d+)$/);e=r?r[1]+(parseInt(r[2])+1):e+"2"}return e},wC=function(e,t,r){return!IE(e,t,r)},IE=function(e,t,r){t=t.getAllBlocks(false);for(let h=0;h<t.length;h++)if(t[h]!==r){var a=t[h];if(a.getProcedureDef&&(a=a.getProcedureDef(),Ui.equals(a[0],e)))return true}return false},AC=function(e){var t=this.getSourceBlock();if(!t)throw new ps;e=e.trim();const r=RE(e,t),a=this.getValue();if(a!==e&&a!==r)for(e=t.workspace.getAllBlocks(false),t=0;t<e.length;t++){const h=e[t];h.renameProcedure&&h.renameProcedure(a,r)}return r},sd=function(e){function t(C,D){for(let pe=0;pe<C.length;pe++){var Y=C[pe][0];const ke=C[pe][1],ft=_t("block");ft.setAttribute("type",D),ft.setAttribute("gap","16");const zt=_t("mutation");for(zt.setAttribute("name",Y),ft.appendChild(zt),Y=0;Y<ke.length;Y++){const yi=_t("arg");yi.setAttribute("name",ke[Y]),zt.appendChild(yi)}r.push(ft)}}const r=[];if(ri.procedures_defnoreturn){var a=_t("block");a.setAttribute("type","procedures_defnoreturn"),a.setAttribute("gap","16");var h=_t("field");h.setAttribute("name","NAME"),h.appendChild(ss(Ye.PROCEDURES_DEFNORETURN_PROCEDURE)),a.appendChild(h),r.push(a)}return ri.procedures_defreturn&&(a=_t("block"),a.setAttribute("type","procedures_defreturn"),a.setAttribute("gap","16"),h=_t("field"),h.setAttribute("name","NAME"),h.appendChild(ss(Ye.PROCEDURES_DEFRETURN_PROCEDURE)),a.appendChild(h),r.push(a)),ri.procedures_ifreturn&&(a=_t("block"),a.setAttribute("type","procedures_ifreturn"),a.setAttribute("gap","16"),r.push(a)),r.length&&r[r.length-1].setAttribute("gap","24"),e=td(e),t(e[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),r},CE=function(e){var t=[],r=e.getBlocksByType("procedures_mutatorarg",false);for(let C=0,D;D=r[C];C++)t.push(D.getFieldValue("NAME"));r=_t("xml");const a=_t("block");a.setAttribute("type","procedures_mutatorarg");const h=_t("field");h.setAttribute("name","NAME"),t=us(p_,t),t=ss(t),h.appendChild(t),a.appendChild(h),r.appendChild(a),e.updateToolbox(r)},OE=function(e){if(e.type===Pn&&e.bubbleType==="mutator"&&e.isOpen&&e.blockId){e=O(e.workspaceId).getBlockById(e.blockId);var t=e.type;(t==="procedures_defnoreturn"||t==="procedures_defreturn")&&(e=e.mutator.getWorkspace(),CE(e),e.addChangeListener(LC))}},LC=function(e){(e.type===ws||e.type===En||e.type===Ts)&&(e=O(e.workspaceId),CE(e))},kE=function(e,t){const r=[];t=t.getAllBlocks(false);for(let h=0;h<t.length;h++){var a=t[h];a.getProcedureCall&&(a=a.getProcedureCall())&&Ui.equals(a,e)&&r.push(t[h])}return r},NC=function(e){const t=Us();var r=e.getProcedureDef()[0];const a=e.mutationToDom(true);e=kE(r,e.workspace);for(let C=0,D;D=e[C];C++){r=(r=D.mutationToDom())&&Di(r),D.domToMutation&&D.domToMutation(a);var h=D.mutationToDom();h=h&&Di(h),r!==h&&(Ps(false),Pe(new(Te(Ts))(D,"mutation",null,r,h)),Ps(t))}},MC=function(e,t){t=t.getAllBlocks(false);for(let a=0;a<t.length;a++){var r=t[a];if(r.getProcedureDef&&(r=r.getProcedureDef())&&Ui.equals(r[0],e))return t[a]}return null},wE=function(e){return e.isDynamic},xc=function(){return cb},DC=function(){o("Blockly.blockRendering.debug.stopDebugger()","version 8","version 10","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)"),cb=false},Fa=function(e,t){ye(Se.RENDERER,e,t)},xC=function(e){Vt(Se.RENDERER,e)},BC=function(){o("Blockly.blockRendering.stopDebugger()","September 2021","September 2022","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)"),DC()},AE=function(e,t,r){return e=new(dn(Se.RENDERER,e))(e),e.init(t,r),e},LE=function(e){wt(e.getTargetWorkspace(),void 0,"String")},NE=function(e){wt(e.getTargetWorkspace(),void 0,"Number")},ME=function(e){wt(e.getTargetWorkspace(),void 0,"Colour")},id=function(e){let t=[],r=document.createElement("button");return r.setAttribute("text",Ye.NEW_STRING_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(r),r=document.createElement("button"),r.setAttribute("text",Ye.NEW_NUMBER_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(r),r=document.createElement("button"),r.setAttribute("text",Ye.NEW_COLOUR_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(r),e.registerButtonCallback("CREATE_VARIABLE_STRING",LE),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",NE),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",ME),e=DE(e),t=t.concat(e)},DE=function(e){e=e.getAllVariables();const t=[];if(0<e.length){if(ri.variables_set_dynamic){var r=e[e.length-1];const a=_t("block");a.setAttribute("type","variables_set_dynamic"),a.setAttribute("gap","24"),a.appendChild(we(r)),t.push(a)}if(ri.variables_get_dynamic){e.sort(Za.compareByName);for(let a=0,h;h=e[a];a++)r=_t("block"),r.setAttribute("type","variables_get_dynamic"),r.setAttribute("gap","8"),r.appendChild(we(h)),t.push(r)}}return t},PC=function(e){e.resizeContents()},UC=function(e){const t=Object.create(null),r=wr(Se.SERIALIZER,true);for(const a in r){let h;const C=(h=r[a])==null?void 0:h.save(e);C&&(t[a]=C)}return t},FC=function(e,t,{recordUndo:r=false}={}){var a=wr(Se.SERIALIZER,true);if(a){a=Object.entries(a).sort((C,D)=>D[1].priority-C[1].priority);var h=Us();Ps(r),(r=Ft())||We(true),De(),t instanceof rn&&t.setResizesEnabled(false);for(const[,C]of a.reverse()){let D;(D=C)==null||D.clear(t)}for(let[C,D]of a.reverse())if(e[C]){let Y;(Y=D)==null||Y.load(e[C],t)}t instanceof rn&&t.setResizesEnabled(true),$e(),Pe(new(Te(Go))(t)),We(r),Ps(h)}},nd=function(e){const t={id:e.getId(),name:e.getName(),returnTypes:e.getReturnTypes()};return e.getParameters().length&&(t.parameters=e.getParameters().map(r=>rd(r))),t},rd=function(e){const t={id:e.getId(),name:e.getName()};return e.getTypes().length&&(t.types=e.getTypes()),t},od=function(e,t,r,a){if(e=new e(a,r.name,r.id).setReturnTypes(r.returnTypes),!r.parameters)return e;for(const[h,C]of r.parameters.entries())e.insertParameter(ad(t,C,a),h);return e},ad=function(e,t,r){return e=new e(r,t.name,t.id),t.types&&e.setTypes(t.types),e},Bc=function(e,t,r){const a=r.getBoundingRectangle(),h=a.right-a.left,C=Cs(t.top,a.top,t.top+t.height-(a.bottom-a.top))-a.top;let D=t.left;return t=t.left+t.width-h,e.RTL?D=Math.min(t,D):t=Math.max(D,t),(e=Cs(D,a.left,t)-a.left)||C?(r.moveBy(e,C),true):false},xE=function(e){return t=>{var r=e.getMetricsManager();if(r.hasFixedEdges()&&!e.isDragging()){var a;if(yd.indexOf((a=t.type)!=null?a:"")!==-1){a=r.getScrollMetrics(true);const h=GC(e,t);h&&(r=Ft(),We(t.group),Bc(e,a,h)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),r!==null&&We(r))}else t.type===Vr&&t.scale&&t.oldScale&&t.scale>t.oldScale&&ld(e)}}},GC=function(e,t){let r=null;switch(t.type){case ws:case Xs:(r=e.getBlockById(t.blockId))&&(r=r.getRootBlock());break;case Wr:case Un:r=e.getCommentById(t.commentId)}return r},ld=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(true);var r=e.getTopBoundedElements();for(let a=0,h;h=r[a];a++)Bc(e,t,h)}},HC=function(e,t){if(typeof e=="string"&&(e=document.getElementById(e)||document.querySelector(e)),!e||!ce(document,e))throw Error("Error: container is not in current document.");t=new sn(t||{});const r=document.createElement("div");r.className="injectionDiv",r.tabIndex=0,Xt(r,Gt.LABEL,Ye.WORKSPACE_ARIA_LABEL),e.appendChild(r),e=VC(r,t);const a=new Wb(r),h=new Vb(r),C=WC(e,t,a,h);return zC(C),B(C),j(C),r.addEventListener("focusin",function(){B(C)}),C},VC=function(e,t){e.setAttribute("dir","LTR"),bc(t.hasCss,t.pathToMedia),e=H(Q.SVG,{xmlns:Mo,"xmlns:html":Yi,"xmlns:xlink":oi,version:"1.1",class:"blocklySvg",tabindex:"0"},e);const r=H(Q.DEFS,{},e),a=String(Math.random()).substring(2);return t.gridPattern=__.createDom(a,t.gridOptions,r),e},WC=function(e,t,r,a){t.parentWorkspace=null,t=new rn(t,r,a),r=t.options,t.scale=r.zoomOptions.startScale,e.appendChild(t.createDom("blocklyMainBackground")),a=t.getInjectionDiv();var h=t.getRenderer().getClassName();return h&&ne(a,h),(h=t.getTheme().getClassName())&&ne(a,h),!r.hasCategories&&r.languageTree&&(a=t.addFlyout(Q.SVG),te(a,e)),r.hasTrashcan&&t.addTrashcan(),r.zoomOptions&&r.zoomOptions.controls&&t.addZoomControls(),t.getThemeManager().subscribe(e,"workspaceBackgroundColour","background-color"),t.translate(0,0),t.addChangeListener(xE(t)),j(t),jm(),vs(),Um(),t},zC=function(e){const t=e.options;var r=e.getParentSvg();if(E(r.parentNode,"contextmenu",null,function(a){v(a)||a.preventDefault()}),r=E(window,"resize",null,function(){e.hideChaff(true),j(e),ld(e)}),e.setResizeHandlerWrapper(r),XC(),t.languageTree){r=e.getToolbox();const a=e.getFlyout(true);r?r.init():a&&(a.init(e),a.show(t.languageTree),typeof a.scrollToStart=="function"&&a.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new k_(e,t.moveOptions.scrollbars===true||!!t.moveOptions.scrollbars.horizontal,t.moveOptions.scrollbars===true||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&KC(t.pathToMedia,e)},jC=function(e){const t=k();t&&!(v(e)||t.rendered&&!t.isVisible())&&It.registry.onKeyDown(t,e)},XC=function(){zb||(E(document,"scroll",null,function(){const e=A();for(let t=0,r;r=e[t];t++)r instanceof rn&&r.updateInverseScreenCTM()}),E(document,"keydown",null,jC),y(document,"touchend",null,g),y(document,"touchcancel",null,g),Lo&&E(window,"orientationchange",document,function(){j(k())})),zb=true},KC=function(e,t){function r(){for(;h.length;)f(h.pop());a.preload()}const a=t.getAudioManager();a.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),a.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),a.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const h=[];h.push(E(document,"pointermove",null,r,true)),h.push(E(document,"touchstart",null,r,true))},BE=function(e,t,r){if(e=e.getProcedureMap().get(t),!e)throw Error("Cannot rename the parameter of a procedure that does not exist in the procedure map");return e.getParameters().find(a=>a.getId()===r)},PE=function(){$t.registry.register({displayText(){return Ye.UNDO},preconditionFn(e){return 0<e.workspace.getUndoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(false)},scopeType:$t.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},UE=function(){$t.registry.register({displayText(){return Ye.REDO},preconditionFn(e){return 0<e.workspace.getRedoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(true)},scopeType:$t.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},FE=function(){$t.registry.register({displayText(){return Ye.CLEAN_UP},preconditionFn(e){return e.workspace.isMovable()?1<e.workspace.getTopBlocks(false).length?"enabled":"disabled":"hidden"},callback(e){e.workspace.cleanUp()},scopeType:$t.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},GE=function(e,t){function r(C){h--,C.setCollapsed(e),h===0&&We(false)}let a=0,h=0;We(true);for(let C=0;C<t.length;C++){let D=t[C];for(;D;)h++,setTimeout(r.bind(null,D),a),D=D.getNextBlock(),a+=10}},HE=function(){$t.registry.register({displayText(){return Ye.COLLAPSE_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(false);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(!r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){GE(true,e.workspace.getTopBlocks(true))},scopeType:$t.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},VE=function(){$t.registry.register({displayText(){return Ye.EXPAND_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(false);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){GE(false,e.workspace.getTopBlocks(true))},scopeType:$t.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},WE=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(false));else{e=e.getChildren(false);for(let r=0;r<e.length;r++)WE(e[r],t)}},cd=function(e){const t=[];e=e.getTopBlocks(true);for(let r=0;r<e.length;r++)WE(e[r],t);return t},Pc=function(e,t){We(t);const r=e.shift();r&&(r.isDeadOrDying()?Pc(e,t):(r.dispose(false,true),setTimeout(Pc,10,e,t))),We(false)},zE=function(){$t.registry.register({displayText(e){return e.workspace?(e=cd(e.workspace).length,e===1?Ye.DELETE_BLOCK:Ye.DELETE_X_BLOCKS.replace("%1",String(e))):""},preconditionFn(e){return e.workspace&&0<cd(e.workspace).length?"enabled":"disabled"},callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=cd(e.workspace),r=pi();2>t.length?Pc(t,r):Aa(Ye.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(a){a&&Pc(t,r)})}},scopeType:$t.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},YC=function(){PE(),UE(),FE(),HE(),VE(),zE()},jE=function(){$t.registry.register({displayText(){return Ye.DUPLICATE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(e){e.block&&Nc(e.block)},scopeType:$t.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},XE=function(){$t.registry.register({displayText(e){return e.block.getCommentIcon()?Ye.REMOVE_COMMENT:Ye.ADD_COMMENT},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden"},callback(e){e=e.block,e.getCommentIcon()?e.setCommentText(null):e.setCommentText("")},scopeType:$t.ScopeType.BLOCK,id:"blockComment",weight:2})},KE=function(){$t.registry.register({displayText(e){return e.block.getInputsInline()?Ye.EXTERNAL_INPUTS:Ye.INLINE_INPUTS},preconditionFn(e){if(e=e.block,!e.isInFlyout&&e.isMovable()&&!e.isCollapsed()){for(let t=1;t<e.inputList.length;t++)if(e.inputList[t-1].type!==rt.STATEMENT&&e.inputList[t].type!==rt.STATEMENT)return"enabled"}return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:$t.ScopeType.BLOCK,id:"blockInline",weight:3})},YE=function(){$t.registry.register({displayText(e){return e.block.isCollapsed()?Ye.EXPAND_BLOCK:Ye.COLLAPSE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:$t.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},qE=function(){$t.registry.register({displayText(e){return e.block.isEnabled()?Ye.DISABLE_BLOCK:Ye.ENABLE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.workspace.options.disable&&e.isEditable()?e.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback(e){e=e.block;const t=Ft();t||We(true),e.setEnabled(!e.isEnabled()),t||We(false)},scopeType:$t.ScopeType.BLOCK,id:"blockDisable",weight:5})},JE=function(){$t.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(false).length,(t=t.getNextBlock())&&(e-=t.getDescendants(false).length),e===1?Ye.DELETE_BLOCK:Ye.DELETE_X_BLOCKS.replace("%1",String(e))},preconditionFn(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback(e){e.block&&e.block.checkAndDelete()},scopeType:$t.ScopeType.BLOCK,id:"blockDelete",weight:6})},ZE=function(){$t.registry.register({displayText(){return Ye.HELP},preconditionFn(e){return e=e.block,(typeof e.helpUrl=="function"?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block.showHelp()},scopeType:$t.ScopeType.BLOCK,id:"blockHelp",weight:7})},qC=function(){jE(),XE(),KE(),YE(),qE(),JE(),ZE()},QE=function(){YC(),qC()},JC=function(e){const t=[];e=e.getDescendants(false);for(let r=0,a;a=e[r];r++){const h=a.getIcons();for(let C=0;C<h.length;C++){const D={location:h[C].getIconLocation(),icon:h[C]};t.push(D)}}return t},ZC=function(e){k().hideChaff(e)},QC=function(e){o("Blockly.resizeSvgContents","December 2021","December 2022","Blockly.WorkspaceSvg.resizeSvgContents"),PC(e)},eO=function(e){o("Blockly.copy","December 2021","December 2022","Blockly.clipboard.copy"),Ua(e)},tO=function(){return o("Blockly.paste","December 2021","December 2022","Blockly.clipboard.paste"),!!Jh()},sO=function(e){o("Blockly.duplicate","December 2021","December 2022","Blockly.clipboard.duplicate"),Nc(e)},iO=function(e){return o("Blockly.isNumber","December 2021","December 2022","Blockly.utils.string.isNumber"),Bm(e)},nO=function(e){return o("Blockly.hueToHex","December 2021","December 2022","Blockly.utils.colour.hueToHex"),Bh(e)},rO=function(e,t,r,a){return o("Blockly.bindEvent_","December 2021","December 2022","Blockly.browserEvents.bind"),y(e,t,r,a)},oO=function(e){return o("Blockly.unbindEvent_","December 2021","December 2022","Blockly.browserEvents.unbind"),f(e)},aO=function(e,t,r,a,h,C){return o("Blockly.bindEventWithChecks_","December 2021","December 2022","Blockly.browserEvents.conditionalBind"),E(e,t,r,a,h)},ze=ze||{};ze.scope={},ze.ASSUME_ES5=false,ze.ASSUME_NO_NATIVE_MAP=false,ze.ASSUME_NO_NATIVE_SET=false,ze.SIMPLE_FROUND_POLYFILL=false,ze.ISOLATE_POLYFILLS=false,ze.FORCE_POLYFILL_PROMISE=false,ze.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=false,ze.defineProperty=ze.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},ze.getGlobal=function(e){e=[typeof globalThis=="object"&&globalThis,e,typeof window=="object"&&window,typeof self=="object"&&self,typeof ki=="object"&&ki];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},ze.global=ze.getGlobal(this),ze.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",ze.TRUST_ES6_POLYFILLS=!ze.ISOLATE_POLYFILLS||ze.IS_SYMBOL_NATIVE,ze.polyfills={},ze.propertyToPolyfillSymbol={},ze.POLYFILL_PREFIX="$jscp$",ze.polyfill=function(e,t,r,a){t&&(ze.ISOLATE_POLYFILLS?ze.polyfillIsolated(e,t,r,a):ze.polyfillUnisolated(e,t,r,a))},ze.polyfillUnisolated=function(e,t,r,a){for(r=ze.global,e=e.split("."),a=0;a<e.length-1;a++){var h=e[a];if(!(h in r))return;r=r[h]}e=e[e.length-1],a=r[e],t=t(a),t!=a&&t!=null&&ze.defineProperty(r,e,{configurable:true,writable:true,value:t})},ze.polyfillIsolated=function(e,t,r,a){var h=e.split(".");e=h.length===1,a=h[0],a=!e&&a in ze.polyfills?ze.polyfills:ze.global;for(var C=0;C<h.length-1;C++){var D=h[C];if(!(D in a))return;a=a[D]}h=h[h.length-1],r=ze.IS_SYMBOL_NATIVE&&r==="es6"?a[h]:null,t=t(r),t!=null&&(e?ze.defineProperty(ze.polyfills,h,{configurable:true,writable:true,value:t}):t!==r&&(ze.propertyToPolyfillSymbol[h]===void 0&&(r=1e9*Math.random()>>>0,ze.propertyToPolyfillSymbol[h]=ze.IS_SYMBOL_NATIVE?ze.global.Symbol(h):ze.POLYFILL_PREFIX+r+"$"+h),ze.defineProperty(a,ze.propertyToPolyfillSymbol[h],{configurable:true,writable:true,value:t})))},ze.polyfill("globalThis",function(e){return e||ze.global},"es_2020","es3"),ze.polyfill("Object.getOwnPropertyDescriptors",function(e){return e||function(t){for(var r={},a=Reflect.ownKeys(t),h=0;h<a.length;h++)r[a[h]]=Object.getOwnPropertyDescriptor(t,a[h]);return r}},"es8","es5"),ze.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:false,value:e[t++]}:{done:true}}},ze.arrayIterator=function(e){return{next:ze.arrayIteratorImpl(e)}},ze.initSymbol=function(){},ze.iteratorPrototype=function(e){return e={next:e},e[Symbol.iterator]=function(){return this},e},ze.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var r=0,a=false,h={next:function(){if(!a&&r<e.length){var C=r++;return{value:t(C,e[C]),done:false}}return a=true,{done:true,value:void 0}}};return h[Symbol.iterator]=function(){return h},h},ze.polyfill("Array.prototype.values",function(e){return e||function(){return ze.iteratorFromArray(this,function(t,r){return r})}},"es8","es3"),ze.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},ze.polyfill("Object.values",function(e){return e||function(t){var r=[],a;for(a in t)ze.owns(t,a)&&r.push(t[a]);return r}},"es8","es3"),ze.polyfill("Array.prototype.flat",function(e){return e||function(t){t=t===void 0?1:t;for(var r=[],a=0;a<this.length;a++){var h=this[a];Array.isArray(h)&&0<t?(h=Array.prototype.flat.call(h,t-1),r.push.apply(r,h)):r.push(h)}return r}},"es9","es5"),ze.polyfill("Object.entries",function(e){return e||function(t){var r=[],a;for(a in t)ze.owns(t,a)&&r.push([a,t[a]]);return r}},"es8","es3");var ni=ni||{};ni.global=globalThis||root,ni.define=function(e,t){return t},ni.DEBUG=false,ni.DISALLOW_TEST_ONLY_CODE=!ni.DEBUG,ni.provide=function(e){},ni.module=function(e){},ni.module.get=function(e){},ni.module.declareLegacyNamespace=function(){},ni.setTestOnly=function(e){if(ni.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},ni.require=function(e){},ni.requireType=function(e){};var bs={};bs.warn=o;var lO=750,ev="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Uc=null,Pr={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Fc=0,vi={};vi.TOUCH_ENABLED=ev,vi.TOUCH_MAP=Pr,vi.checkTouchIdentifier=c,vi.clearTouchIdentifier=m,vi.getTouchIdentifierFromEvent=p,vi.isMouseOrTouchEvent=_,vi.isTouchEvent=b,vi.longStart=l,vi.longStop=g,vi.setClientFromTouch=d,vi.shouldHandleEvent=u,vi.splitEventByTouches=$;var ud,tv,sv,iv,Gc,Hc,hd,nv,rv,ov;(function(e){function t(a){return r.indexOf(a.toUpperCase())!==-1}ud=e;const r=ud.toUpperCase();tv=t("JavaFX"),sv=t("WebKit"),iv=t("Gecko")&&!sv,Gc=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Hc=t("iPad")||t("Macintosh")&&0<e,hd=t("iPhone")&&!Hc,nv=t("Macintosh"),rv=Hc||Gc&&!t("Mobile")||t("Silk"),ov=!rv&&(hd||Gc)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var cO=ud,av=tv,dd=iv,Vc=Gc,Lo=Hc,lv=hd,_d=nv,pd=ov,Dn={};Dn.ANDROID=Vc,Dn.GECKO=dd,Dn.IPAD=Lo,Dn.IPHONE=lv,Dn.JavaFx=av,Dn.MAC=_d,Dn.MOBILE=pd,Dn.raw=cO;var cv=40,uv=125,xn={};xn.bind=y,xn.conditionalBind=E,xn.getScrollDeltaPixels=R,xn.isRightButton=T,xn.isTargetInput=v,xn.mouseToSvg=S,xn.unbind=f;var ri=Object.create(null),No,hv,gd,dv,Ur,fd;No=Object.create(null),gd=null,Ur=[],fd={defineBlocksWithJsonArrayInternal:F},i.module$build$src$core$common={},i.module$build$src$core$common.TEST_ONLY=fd,i.module$build$src$core$common.createBlockDefinitionsFromJsonArray=V,i.module$build$src$core$common.defineBlocks=X,i.module$build$src$core$common.defineBlocksWithJsonArray=M,i.module$build$src$core$common.draggingConnections=Ur,i.module$build$src$core$common.getAllWorkspaces=A,i.module$build$src$core$common.getBlockTypeCounts=K,i.module$build$src$core$common.getMainWorkspace=k,i.module$build$src$core$common.getParentContainer=z,i.module$build$src$core$common.getSelected=U,i.module$build$src$core$common.getWorkspaceById=O,i.module$build$src$core$common.registerWorkspace=L,i.module$build$src$core$common.setMainWorkspace=B,i.module$build$src$core$common.setParentContainer=W,i.module$build$src$core$common.setSelected=P,i.module$build$src$core$common.svgResize=j,i.module$build$src$core$common.unregisterWorkpace=I;var Mo="http://www.w3.org/2000/svg",Yi="http://www.w3.org/1999/xhtml",oi="http://www.w3.org/1999/xlink",fn;(function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_POSITION_CONTAINED_BY=16]="DOCUMENT_POSITION_CONTAINED_BY"})(fn||(fn={}));var qi=null,md=0,Wc=null,Es={};Es.HTML_NS=Yi,Es.NodeType=fn,Es.SVG_NS=Mo,Es.XLINK_NS=oi,Es.addClass=ne,Es.containsNode=ce,Es.createSvgElement=H,Es.getFastTextWidth=bt,Es.getFastTextWidthWithSizeString=Ut,Es.getTextWidth=st,Es.hasClass=ot,Es.insertAfter=te,Es.measureFontMetrics=jt,Es.removeClass=de,Es.removeClasses=Ie,Es.removeNode=x,Es.setCssTransform=ae,Es.startTextWidthCache=De,Es.stopTextWidthCache=$e;var zc={};zc.clamp=Cs,zc.toDegrees=Ss,zc.toRadians=Ve;var es=class{constructor(e,t,r,a){this.top=e,this.bottom=t,this.left=r,this.right=a}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return!(this.left>e.right||this.right<e.left||this.top>e.bottom||this.bottom<e.top)}},Oe=class{constructor(e,t){this.x=e,this.y=t}clone(){return new Oe(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t?true:e&&t?e.x===t.x&&e.y===t.y:false}static distance(e,t){const r=e.x-t.x;return e=e.y-t.y,Math.sqrt(r*r+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new Oe(e.x-t.x,e.y-t.y)}static sum(e,t){return new Oe(e.x+t.x,e.y+t.y)}},$s=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t?true:e&&t?e.width===t.width&&e.height===t.height:false}},_v={getSizeInternal:zs},mn={};mn.TEST_ONLY=_v,mn.getBorderBox=Dt,mn.getCascadedStyle=ts,mn.getComputedStyle=kt,mn.getContainerOffsetToScrollInto=Bs,mn.getPageOffset=me,mn.getSize=Os,mn.getViewportPageOffset=He,mn.scrollIntoContainerView=ve;var Ga=16,Ed=1,pv=12,vd=16,jc=.25,bd=null,Fr=null,Do="",xo="",Tt,Bo,Gr,Td=null,or=null,gv=null,Sd={getBoundsInfo:function(){const e=me(Td),t=Os(Td);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,r,a){const h=Sd.getBoundsInfo(),C=Os(Tt);return t+C.height<h.bottom?ka(e,t,h,C):a-C.height>h.top?Ln(r,a,h,C):t+C.height<document.documentElement.clientHeight?ka(e,t,h,C):a-C.height>document.documentElement.clientTop?Ln(r,a,h,C):q(e,h,C)}},is={};is.ANIMATION_TIME=jc,is.ARROW_HORIZONTAL_PADDING=pv,is.ARROW_SIZE=Ga,is.BORDER_SIZE=Ed,is.PADDING_Y=vd,is.TEST_ONLY=Sd,is.clearContent=as,is.createDom=vs,is.getContentDiv=Li,is.getOwner=Rt,is.getPositionX=fe,is.hide=Ht,is.hideIfOwner=Qe,is.hideWithoutAnimation=Ot,is.isVisible=Ae,is.repositionForWindowResize=Be,is.setBoundsElement=ks,is.setColour=N,is.show=Xi,is.showPositionedByBlock=G,is.showPositionedByField=J;var ar=Object.create(null),uO={typeMap:ar},Xc=Object.create(null),Bn="default",Se=class{constructor(e){this.name=e}toString(){return this.name}};Se.CONNECTION_CHECKER=new Se("connectionChecker"),Se.CURSOR=new Se("cursor"),Se.EVENT=new Se("event"),Se.FIELD=new Se("field"),Se.RENDERER=new Se("renderer"),Se.TOOLBOX=new Se("toolbox"),Se.THEME=new Se("theme"),Se.TOOLBOX_ITEM=new Se("toolboxItem"),Se.FLYOUTS_VERTICAL_TOOLBOX=new Se("flyoutsVerticalToolbox"),Se.FLYOUTS_HORIZONTAL_TOOLBOX=new Se("flyoutsHorizontalToolbox"),Se.METRICS_MANAGER=new Se("metricsManager"),Se.BLOCK_DRAGGER=new Se("blockDragger"),Se.SERIALIZER=new Se("serializer");var Ji={};Ji.DEFAULT=Bn,Ji.TEST_ONLY=uO,Ji.Type=Se,Ji.getAllItems=wr,Ji.getClass=dn,Ji.getClassFromOptions=si,Ji.getObject=vo,Ji.hasItem=Eo,Ji.register=ye,Ji.unregister=Vt;var fv="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",mv={genUid:()=>{const e=fv.length,t=[];for(let r=0;20>r;r++)t[r]=fv.charAt(Math.random()*e);return t.join("")}},hO=0,Kc={};Kc.TEST_ONLY=mv,Kc.genUid=pi,Kc.getNextUniqueId=Ar;var Ev="",Ha=true,$d=0,ws="create",En="delete",Ts="change",Xs="move",Hr="var_create",Po="var_delete",Va="var_rename",Wa="ui",Uo="drag",lr="selected",cr="click",za="marker_move",Pn="bubble_open",ja="trashcan_open",Xa="toolbox_item_select",Ka="theme_change",Vr="viewport_change",Wr="comment_create",Fo="comment_delete",Ya="comment_change",Un="comment_move",Go="finished_loading",Yc="procedure_create",qa="procedure_delete",qc="procedure_rename",Jc="procedure_enable",Zc="procedure_change_return",Qc="procedure_parameter_create",eu="procedure_parameter_delete",tu="procedure_parameter_rename",yd=[ws,Xs,Wr,Un],Ho=[],Rd={FIRE_QUEUE:Ho,fireNow:mc,fireInternal:Oh,setGroupInternal:To},Ze={};Ze.BLOCK_CHANGE=Ts,Ze.BLOCK_CREATE=ws,Ze.BLOCK_DELETE=En,Ze.BLOCK_DRAG=Uo,Ze.BLOCK_MOVE=Xs,Ze.BUBBLE_OPEN=Pn,Ze.BUMP_EVENTS=yd,Ze.CHANGE=Ts,Ze.CLICK=cr,Ze.COMMENT_CHANGE=Ya,Ze.COMMENT_CREATE=Wr,Ze.COMMENT_DELETE=Fo,Ze.COMMENT_MOVE=Un,Ze.CREATE=ws,Ze.DELETE=En,Ze.FINISHED_LOADING=Go,Ze.MARKER_MOVE=za,Ze.MOVE=Xs,Ze.PROCEDURE_CHANGE_RETURN=Zc,Ze.PROCEDURE_CREATE=Yc,Ze.PROCEDURE_DELETE=qa,Ze.PROCEDURE_ENABLE=Jc,Ze.PROCEDURE_PARAMETER_CREATE=Qc,Ze.PROCEDURE_PARAMETER_DELETE=eu,Ze.PROCEDURE_PARAMETER_RENAME=tu,Ze.PROCEDURE_RENAME=qc,Ze.SELECTED=lr,Ze.TEST_ONLY=Rd,Ze.THEME_CHANGE=Ka,Ze.TOOLBOX_ITEM_SELECT=Xa,Ze.TRASHCAN_OPEN=ja,Ze.UI=Wa,Ze.VAR_CREATE=Hr,Ze.VAR_DELETE=Po,Ze.VAR_RENAME=Va,Ze.VIEWPORT_CHANGE=Vr,Ze.clearPendingUndo=Ni,Ze.disable=Jt,Ze.disableOrphans=Nt,Ze.enable=Zt,Ze.filter=bo,Ze.fire=Pe,Ze.fromJson=Re,Ze.get=Te,Ze.getDescendantIds=So,Ze.getGroup=Ft,Ze.getRecordUndo=Us,Ze.isEnabled=ls,Ze.setGroup=We,Ze.setRecordUndo=Ps;var rt;(function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY"})(rt||(rt={})),i.module$build$src$core$input_types={},i.module$build$src$core$input_types.inputTypes=rt;var zr,su,iu,Id;({document:zr,DOMParser:su,XMLSerializer:iu}=globalThis),Id="https://developers.google.com/blockly/xml",i.module$build$src$core$utils$xml={},i.module$build$src$core$utils$xml.NAME_SPACE=Id,i.module$build$src$core$utils$xml.createElement=_t,i.module$build$src$core$utils$xml.createTextNode=ss,i.module$build$src$core$utils$xml.domToText=wa,i.module$build$src$core$utils$xml.getDocument=gi,i.module$build$src$core$utils$xml.injectDependencies=cs,i.module$build$src$core$utils$xml.setDocument=_n,i.module$build$src$core$utils$xml.textToDomDocument=fi;var vv=function(e,t){window.alert(e),t&&t()},bv=function(e,t){t(window.confirm(e))},Tv=function(e,t,r){r(window.prompt(e,t))},Sv={confirmInternal:kh},ai={};ai.TEST_ONLY=Sv,ai.alert=Lr,ai.confirm=Aa,ai.prompt=La,ai.setAlert=Ec,ai.setConfirm=wh,ai.setPrompt=$o;var Ye,Cd;Ye=Object.create(null),Cd=function(e){Object.keys(e).forEach(function(t){Ye[t]=e[t]})},i.module$build$src$core$msg={},i.module$build$src$core$msg.Msg=Ye,i.module$build$src$core$msg.setLocale=Cd;var jr=class{constructor(){this.workspaceId=void 0,this.isUiEvent=false,this.type="",this.group=Ft(),this.recordUndo=Us()}toJson(){return{type:this.type,group:this.group}}fromJson(e){this.isBlank=false,this.group=e.group||""}static fromJson(e,t,r){return o("Blockly.Events.Abstract.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),r.isBlank=false,r.group=e.group||"",r.workspaceId=t.id,r}isNull(){return false}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=O(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},Ja=class extends jr{constructor(e){super(),this.isBlank=typeof e>"u",e&&(this.varId=e.getId(),this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}fromJson(e){o("Blockly.Events.VarBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.varId=e.varId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Ja),t.varId=e.varId,t}},Od=class extends Ja{constructor(e){super(e),this.type=Hr,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}fromJson(e){o("Blockly.Events.VarCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.varType=e.varType,this.varName=e.varName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Od),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.createVariable(this.varName,this.varType,this.varId):t.deleteVariableById(this.varId)}};ye(Se.EVENT,Hr,Od);var Za=class{constructor(e,t,r,a){this.workspace=e,this.name=t,this.type=r||"",this.id_=a||pi()}getId(){return this.id_}static compareByName(e,t){return e.name.localeCompare(t.name,void 0,{sensitivity:"base"})}},nu,ru,kd;nu="VARIABLE",ru="ijkmnopqrstuvwxyzabcdefgh",kd={generateUniqueNameInternal:vc},i.module$build$src$core$variables={},i.module$build$src$core$variables.CATEGORY_NAME=nu,i.module$build$src$core$variables.TEST_ONLY=kd,i.module$build$src$core$variables.VAR_LETTER_OPTIONS=ru,i.module$build$src$core$variables.allDeveloperVariables=Mi,i.module$build$src$core$variables.allUsedVarModels=yo,i.module$build$src$core$variables.createVariableButtonHandler=wt,i.module$build$src$core$variables.flyoutCategory=Na,i.module$build$src$core$variables.flyoutCategoryBlocks=Ro,i.module$build$src$core$variables.generateUniqueName=nt,i.module$build$src$core$variables.generateUniqueNameFromOptions=us,i.module$build$src$core$variables.generateVariableFieldDom=we,i.module$build$src$core$variables.getAddedVariables=ms,i.module$build$src$core$variables.getOrCreateVariablePackage=Fe,i.module$build$src$core$variables.getVariable=lt,i.module$build$src$core$variables.nameUsedWithAnyType=Io,i.module$build$src$core$variables.promptName=Ki,i.module$build$src$core$variables.renameVariable=Nr;var vn=class{constructor(e,t,r,a,h){this.workspace=e,this.editable_=this.movable_=this.deletable_=true,this.disposed_=false,this.isComment=true,this.id=h&&!e.getCommentById(h)?h:pi(),e.addTopComment(this),this.xy_=new Oe(0,0),this.height_=r,this.width_=a,this.RTL=e.RTL,this.content_=t,vn.fireCreateEvent(this)}dispose(){this.disposed_||(ls()&&Pe(new(Te(Fo))(this)),this.workspace.removeTopComment(this),this.disposed_=true)}getHeight(){return this.height_}setHeight(e){this.height_=e}getWidth(){return this.width_}setWidth(e){this.width_=e}getXY(){return new Oe(this.xy_.x,this.xy_.y)}moveBy(e,t){const r=new(Te(Un))(this);this.xy_.translate(e,t),r.recordNew(),Pe(r)}isDeletable(){return this.deletable_&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(e){this.deletable_=e}isMovable(){return this.movable_&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(e){this.movable_=e}isEditable(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(e){this.editable_=e}getContent(){return this.content_}setContent(e){this.content_!==e&&(Pe(new(Te(Ya))(this,this.content_,e)),this.content_=e)}toXmlWithXY(e){return e=this.toXml(e),e.setAttribute("x",`${Math.round(this.xy_.x)}`),e.setAttribute("y",`${Math.round(this.xy_.y)}`),e.setAttribute("h",`${this.height_}`),e.setAttribute("w",`${this.width_}`),e}toXml(e){const t=_t("comment");return e||(t.id=this.id),t.textContent=this.getContent(),t}static fireCreateEvent(e){if(ls()){const t=Ft();t||We(true);try{Pe(new(Te(Wr))(e))}finally{t||We(false)}}}static fromXml(e,t){var r=vn.parseAttributes(e);return t=new vn(t,r.content,r.h,r.w,r.id),r=e.getAttribute("x"),e=e.getAttribute("y"),r=r?parseInt(r,10):NaN,e=e?parseInt(e,10):NaN,isNaN(r)||isNaN(e)||t.moveBy(r,e),vn.fireCreateEvent(t),t}static parseAttributes(e){const t=e.getAttribute("h"),r=e.getAttribute("w"),a=e.getAttribute("x"),h=e.getAttribute("y"),C=e.getAttribute("id");if(!C)throw Error("No ID present in XML comment definition.");let D;return{id:C,h:t?parseInt(t):100,w:r?parseInt(r):100,x:a?parseInt(a):NaN,y:h?parseInt(h):NaN,content:(D=e.textContent)!=null?D:""}}},Zi=class extends jr{constructor(e){super(),this.isBlank=true,this.recordUndo=false,this.isUiEvent=true,this.isBlank=typeof e>"u",this.workspaceId=e||""}},wd=class extends Zi{constructor(e,t,r){super(r),this.type=lr,this.oldElementId=e??void 0,this.newElementId=t??void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}fromJson(e){o("Blockly.Events.Selected.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldElementId=e.oldElementId,this.newElementId=e.newElementId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new wd),t.oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};ye(Se.EVENT,lr,wd);var Ad=false,Ld=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
}

.blocklyNonSelectable {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.blocklyWsDragSurface {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
}

/* Added as a separate rule with multiple classes to make it more specific
   than a bootstrap rule that selects svg:root. See issue #1275 for context.
*/
.blocklyWsDragSurface.blocklyOverflowVisible {
  overflow: visible;
}

.blocklyBlockDragSurface {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: visible !important;
  z-index: 50;  /* Display below toolbox, but above everything else. */
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
  overflow: auto;
  overflow-x: hidden;
  position: relative;
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
}

.blocklyDropDownButton {
  display: inline-block;
  float: left;
  padding: 0;
  margin: 4px;
  border-radius: 4px;
  outline: none;
  border: 1px solid;
  transition: box-shadow .1s;
  cursor: pointer;
}

.blocklyArrowTop {
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyArrowBottom {
  border-bottom: 1px solid;
  border-right: 1px solid;
  border-bottom-right-radius: 4px;
  border-color: inherit;
}

.blocklyResizeSE {
  cursor: se-resize;
  fill: #aaa;
}

.blocklyResizeSW {
  cursor: sw-resize;
  fill: #aaa;
}

.blocklyResizeLine {
  stroke: #515A5A;
  stroke-width: 1;
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  /* backup for browsers (e.g. IE11) that don't support grab */
  cursor: url("<<<PATH>>>/handopen.cur"), auto;
  cursor: grab;
  cursor: -webkit-grab;
}

  /* backup for browsers (e.g. IE11) that don't support grabbing */
.blocklyDragging {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Change the cursor on the whole drag surface in case the mouse gets
   ahead of block during a drag. This way the cursor is still a closed hand.
  */
.blocklyBlockDragSurface .blocklyDraggable {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabled>.blocklyPath {
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyMultilineText {
  font-family: monospace;
}

.blocklyNonEditableText>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

/*
  Don't allow users to select text.  It gets annoying when trying to
  drag a block and selected text moves instead.
*/
.blocklySvg text,
.blocklyBlockDragSurface text {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  cursor: inherit;
}

.blocklyHidden {
  display: none;
}

.blocklyFieldDropdown:not(.blocklyHidden) {
  display: block;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Edge and IE introduce a close icon when the input value is longer than a
   certain length. This affects our sizing calculations of the text input.
   Hiding the close icon to avoid that. */
.blocklyHtmlInput::-ms-clear {
  display: none;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  position: relative;  /* Compatibility with gapi, reset from goog-menu */
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}
`,Nd={};Nd.inject=bc,Nd.register=hs;var Q=class{constructor(e){this.tagName=e}toString(){return this.tagName}};Q.ANIMATE=new Q("animate"),Q.CIRCLE=new Q("circle"),Q.CLIPPATH=new Q("clipPath"),Q.DEFS=new Q("defs"),Q.FECOMPOSITE=new Q("feComposite"),Q.FECOMPONENTTRANSFER=new Q("feComponentTransfer"),Q.FEFLOOD=new Q("feFlood"),Q.FEFUNCA=new Q("feFuncA"),Q.FEGAUSSIANBLUR=new Q("feGaussianBlur"),Q.FEPOINTLIGHT=new Q("fePointLight"),Q.FESPECULARLIGHTING=new Q("feSpecularLighting"),Q.FILTER=new Q("filter"),Q.FOREIGNOBJECT=new Q("foreignObject"),Q.G=new Q("g"),Q.IMAGE=new Q("image"),Q.LINE=new Q("line"),Q.PATH=new Q("path"),Q.PATTERN=new Q("pattern"),Q.POLYGON=new Q("polygon"),Q.RECT=new Q("rect"),Q.SVG=new Q("svg"),Q.TEXT=new Q("text"),Q.TSPAN=new Q("tspan");var $v=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,yv=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,dO={XY_REGEX:$v,XY_STYLE_REGEX:yv},ur={};ur.TEST_ONLY=dO,ur.getDocumentScroll=Lh,ur.getInjectionDivXY=Tc,ur.getRelativeXY=mi,ur.getViewportBBox=Ah,ur.is3dSupported=Cm,ur.screenToWsCoordinates=Om;var As=8,ou=3,_O=2,Gs=class extends vn{constructor(e,t,r,a,h){super(e,t,r,a,h),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.eventsInit_=false,this.deleteIconBorder_=this.deleteGroup_=this.resizeGroup_=this.foreignObject_=this.svgHandleTarget_=this.svgRectTarget_=this.textarea_=null,this.rendered_=this.autoLayout_=this.focused_=false,this.svgGroup_=H(Q.G,{class:"blocklyComment"}),this.svgGroup_.translate_="",this.workspace=e,this.svgRect_=H(Q.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:ou,ry:ou}),this.svgGroup_.appendChild(this.svgRect_),this.useDragSurface_=!!e.getBlockDragSurface(),this.render()}dispose(){this.disposed_||(U()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),ls()&&Pe(new(Te(Fo))(this)),x(this.svgGroup_),this.disposeInternal_(),Jt(),super.dispose(),Zt())}initSvg(e){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit_||(E(this.svgRectTarget_,"pointerdown",this,this.pathMouseDown_),E(this.svgHandleTarget_,"pointerdown",this,this.pathMouseDown_)),this.eventsInit_=true,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!e&&this.textarea_&&this.textarea_.select()}pathMouseDown_(e){const t=this.workspace.getGesture(e);t&&t.handleBubbleStart(e,this)}showContextMenu(e){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts")}select(){if(U()!==this){var e=null;if(U()){e=U().id,Jt();try{U().unselect()}finally{Zt()}}e=new(Te(lr))(e,this.id,this.workspace.id),Pe(e),P(this),this.addSelect()}}unselect(){if(U()===this){var e=new(Te(lr))(this.id,null,this.workspace.id);Pe(e),P(null),this.removeSelect(),this.blurFocus()}}addSelect(){ne(this.svgGroup_,"blocklySelected"),this.setFocus()}removeSelect(){ne(this.svgGroup_,"blocklySelected"),this.blurFocus()}addFocus(){ne(this.svgGroup_,"blocklyFocused")}removeFocus(){de(this.svgGroup_,"blocklyFocused")}getRelativeToSurfaceXY(){let e=0,t=0;const r=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;let a=this.getSvgRoot();if(a)do{var h=mi(a);e+=h.x,t+=h.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===a&&(h=this.workspace.getBlockDragSurface().getSurfaceTranslation(),e+=h.x,t+=h.y),a=a.parentNode}while(a&&a!==this.workspace.getBubbleCanvas()&&a!==r);return this.xy_=new Oe(e,t)}moveBy(e,t){const r=new(Te(Un))(this),a=this.getRelativeToSurfaceXY();this.translate(a.x+e,a.y+t),this.xy_=new Oe(a.x+e,a.y+t),r.recordNew(),Pe(r),this.workspace.resizeContents()}translate(e,t){this.xy_=new Oe(e,t),this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")}moveToDragSurface(){if(this.useDragSurface_){var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(e.x,e.y),this.workspace.getBlockDragSurface().setBlocksAndShow(this.getSvgRoot())}}moveDuringDrag(e,t){e?e.translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))}moveTo(e,t){this.translate(e,t)}clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform")}getBoundingRectangle(){var e=this.getRelativeToSurfaceXY();const t=this.getHeightWidth(),r=e.y,a=e.y+t.height;let h;return this.RTL?(h=e.x-t.width,e=e.x):(h=e.x,e=e.x+t.width),new es(r,a,h,e)}updateMovable(){this.isMovable()?ne(this.svgGroup_,"blocklyDraggable"):de(this.svgGroup_,"blocklyDraggable")}setMovable(e){super.setMovable(e),this.updateMovable()}setEditable(e){super.setEditable(e),this.textarea_&&(this.textarea_.readOnly=!e)}setDragging(e){e?(e=this.getSvgRoot(),e.translate_="",e.skew_="",ne(this.svgGroup_,"blocklyDragging")):de(this.svgGroup_,"blocklyDragging")}getSvgRoot(){return this.svgGroup_}getContent(){return this.textarea_?this.textarea_.value:this.content_}setContent(e){super.setContent(e),this.textarea_&&(this.textarea_.value=e)}setDeleteStyle(e){e?ne(this.svgGroup_,"blocklyDraggingDelete"):de(this.svgGroup_,"blocklyDraggingDelete")}setAutoLayout(e){}toXmlWithXY(e){let t=0;this.workspace.RTL&&(t=this.workspace.getWidth()),e=this.toXml(e);const r=this.getRelativeToSurfaceXY();return e.setAttribute("x",Math.round(this.workspace.RTL?t-r.x:r.x)),e.setAttribute("y",Math.round(r.y)),e.setAttribute("h",this.getHeight()),e.setAttribute("w",this.getWidth()),e}toCopyData(){return{saveInfo:this.toXmlWithXY(),source:this.workspace,typeCounts:null}}getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()}}render(){if(!this.rendered_){var e=this.getHeightWidth();this.createEditor_(),this.svgGroup_.appendChild(this.foreignObject_),this.svgHandleTarget_=H(Q.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup_.appendChild(this.svgHandleTarget_),this.svgRectTarget_=H(Q.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:ou,ry:ou}),this.svgGroup_.appendChild(this.svgRectTarget_),this.addResizeDom_(),this.isDeletable()&&this.addDeleteDom_(),this.setSize_(e.width,e.height),this.textarea_.value=this.content_,this.rendered_=true,this.resizeGroup_&&E(this.resizeGroup_,"pointerdown",this,this.resizeMouseDown_),this.isDeletable()&&(E(this.deleteGroup_,"pointerdown",this,this.deleteMouseDown_),E(this.deleteGroup_,"pointerout",this,this.deleteMouseOut_),E(this.deleteGroup_,"pointerup",this,this.deleteMouseUp_))}}createEditor_(){this.foreignObject_=H(Q.FOREIGNOBJECT,{x:0,y:Gs.TOP_OFFSET,class:"blocklyCommentForeignObject"});const e=document.createElementNS(Yi,"body");e.setAttribute("xmlns",Yi),e.className="blocklyMinimalBody";const t=document.createElementNS(Yi,"textarea");return t.className="blocklyCommentTextarea",t.setAttribute("dir",this.RTL?"RTL":"LTR"),t.readOnly=!this.isEditable(),e.appendChild(t),this.textarea_=t,this.foreignObject_.appendChild(e),E(t,"wheel",this,function(r){r.stopPropagation()}),E(t,"change",this,function(r){this.setContent(t.value)}),this.foreignObject_}addResizeDom_(){this.resizeGroup_=H(Q.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup_),H(Q.POLYGON,{points:"0,x x,x x,0".replace(/x/g,As.toString())},this.resizeGroup_),H(Q.LINE,{class:"blocklyResizeLine",x1:As/3,y1:As-1,x2:As-1,y2:As/3},this.resizeGroup_),H(Q.LINE,{class:"blocklyResizeLine",x1:2*As/3,y1:As-1,x2:As-1,y2:2*As/3},this.resizeGroup_)}addDeleteDom_(){this.deleteGroup_=H(Q.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup_),this.deleteIconBorder_=H(Q.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup_),H(Q.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup_),H(Q.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup_)}resizeMouseDown_(e){this.unbindDragEvents_(),T(e)||(this.workspace.startDrag(e,new Oe(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper_=E(document,"pointerup",this,this.resizeMouseUp_),this.onMouseMoveWrapper_=E(document,"pointermove",this,this.resizeMouseMove_),this.workspace.hideChaff()),e.stopPropagation()}deleteMouseDown_(e){this.deleteIconBorder_&&ne(this.deleteIconBorder_,"blocklyDeleteIconHighlighted"),e.stopPropagation()}deleteMouseOut_(e){this.deleteIconBorder_&&de(this.deleteIconBorder_,"blocklyDeleteIconHighlighted")}deleteMouseUp_(e){this.dispose(),e.stopPropagation()}unbindDragEvents_(){this.onMouseUpWrapper_&&(f(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(f(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}resizeMouseUp_(e){m(),this.unbindDragEvents_()}resizeMouseMove_(e){this.autoLayout_=false,e=this.workspace.moveDrag(e),this.setSize_(this.RTL?-e.x:e.x,e.y)}resizeComment_(){const e=this.getHeightWidth(),t=Gs.TOP_OFFSET,r=2*_O;this.foreignObject_.setAttribute("width",e.width),this.foreignObject_.setAttribute("height",(e.height-t).toString()),this.RTL&&this.foreignObject_.setAttribute("x",(-e.width).toString()),this.textarea_.style.width=e.width-r+"px",this.textarea_.style.height=e.height-r-t+"px"}setSize_(e,t){e=Math.max(e,45),t=Math.max(t,20+Gs.TOP_OFFSET),this.width_=e,this.height_=t,this.svgRect_.setAttribute("width",e),this.svgRect_.setAttribute("height",t),this.svgRectTarget_.setAttribute("width",e),this.svgRectTarget_.setAttribute("height",t),this.svgHandleTarget_.setAttribute("width",e),this.svgHandleTarget_.setAttribute("height",Gs.TOP_OFFSET),this.RTL&&(this.svgRect_.setAttribute("transform","scale(-1 1)"),this.svgRectTarget_.setAttribute("transform","scale(-1 1)")),this.resizeGroup_&&(this.RTL?(this.resizeGroup_.setAttribute("transform","translate("+(-e+As)+","+(t-As)+") scale(-1 1)"),this.deleteGroup_.setAttribute("transform","translate("+(-e+As)+","+-As+") scale(-1 1)")):(this.resizeGroup_.setAttribute("transform","translate("+(e-As)+","+(t-As)+")"),this.deleteGroup_.setAttribute("transform","translate("+(e-As)+","+-As+")"))),this.resizeComment_()}disposeInternal_(){this.svgHandleTarget_=this.svgRectTarget_=this.foreignObject_=this.textarea_=null,this.disposed_=true}setFocus(){this.focused_=true,setTimeout(()=>{this.disposed_||(this.textarea_.focus(),this.addFocus(),this.svgRectTarget_&&ne(this.svgRectTarget_,"blocklyCommentTargetFocused"),this.svgHandleTarget_&&ne(this.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))},0)}blurFocus(){this.focused_=false,setTimeout(()=>{this.disposed_||(this.textarea_.blur(),this.removeFocus(),this.svgRectTarget_&&de(this.svgRectTarget_,"blocklyCommentTargetFocused"),this.svgHandleTarget_&&de(this.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))},0)}static fromXmlRendered(e,t,r){Jt();let a;try{const h=vn.parseAttributes(e);if(a=new Gs(t,h.content,h.h,h.w,h.id),t.rendered&&(a.initSvg(true),a.render()),!isNaN(h.x)&&!isNaN(h.y))if(t.RTL){const C=r||t.getWidth();a.moveBy(C-h.x,h.y)}else a.moveBy(h.x,h.y)}finally{Zt()}return vn.fireCreateEvent(a),a}};Gs.DEFAULT_SIZE=100,Gs.TOP_OFFSET=10,hs(`
.blocklyCommentForeignObject {
  position: relative;
  z-index: 0;
}

.blocklyCommentRect {
  fill: #E7DE8E;
  stroke: #bcA903;
  stroke-width: 1px;
}

.blocklyCommentTarget {
  fill: transparent;
  stroke: #bcA903;
}

.blocklyCommentTargetFocused {
  fill: none;
}

.blocklyCommentHandleTarget {
  fill: none;
}

.blocklyCommentHandleTargetFocused {
  fill: transparent;
}

.blocklyFocused>.blocklyCommentRect {
  fill: #B9B272;
  stroke: #B9B272;
}

.blocklySelected>.blocklyCommentTarget {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCommentDeleteIcon {
  cursor: pointer;
  fill: #000;
  display: none;
}

.blocklySelected > .blocklyCommentDeleteIcon {
  display: block;
}

.blocklyDeleteIconShape {
  fill: #000;
  stroke: #000;
  stroke-width: 1px;
}

.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {
  stroke: #fc3;
}
`),i.module$build$src$core$xml={},i.module$build$src$core$xml.appendDomToWorkspace=jR,i.module$build$src$core$xml.blockToDom=Mr,i.module$build$src$core$xml.blockToDomWithXY=Sc,i.module$build$src$core$xml.clearWorkspaceAndLoadFromXml=zR,i.module$build$src$core$xml.deleteNext=tI,i.module$build$src$core$xml.domToBlock=Co,i.module$build$src$core$xml.domToPrettyText=WR,i.module$build$src$core$xml.domToText=Di,i.module$build$src$core$xml.domToVariables=Am,i.module$build$src$core$xml.domToWorkspace=Da,i.module$build$src$core$xml.textToDom=js,i.module$build$src$core$xml.variablesToDom=km,i.module$build$src$core$xml.workspaceToDom=GR;var Vo=class extends jr{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}fromJson(e){o("Blockly.Events.BlockBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.blockId=e.blockId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Vo),t.blockId=e.blockId,t}},Xr=class extends Vo{constructor(e,t,r,a,h){super(e),this.type=Ts,e&&(this.element=t,this.name=r||void 0,this.oldValue=a,this.newValue=h)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}fromJson(e){o("Blockly.Events.BlockChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.element=e.element,this.name=e.name,this.oldValue=e.oldValue,this.newValue=e.newValue}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Xr),t.element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(t=t.getBlockById(this.blockId),!t)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");switch(t.mutator&&t.mutator.setVisible(false),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":t.setEnabled(!e);break;case"inline":t.setInputsInline(!!e);break;case"mutation":const r=Xr.getExtraBlockState_(t);t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(js(e||"<mutation/>")),Pe(new Xr(t,"mutation",null,r,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState())?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?Di(e):""}};ye(Se.EVENT,Ts,Xr);var Qa=class{constructor(e){this.workspace=e,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),t.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,t)),this.setMarkerSvg(t.getDrawer().createDom()),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(t)t.dispose(),this.markers.delete(e);else throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor_}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=e)&&(e=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(e),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(e){e?(this.workspace.getBlockCanvas().appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null}setMarkerSvg(e){e?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(e,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(e)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const e=Object.keys(this.markers);for(let t=0,r;r=e[t];t++)this.unregisterMarker(r);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};Qa.LOCAL_MARKER="local_marker_1",i.module$build$src$core$utils$string={},i.module$build$src$core$utils$string.commonWordPrefix=Nm,i.module$build$src$core$utils$string.commonWordSuffix=Mm,i.module$build$src$core$utils$string.isNumber=Bm,i.module$build$src$core$utils$string.shortestStringLength=$c,i.module$build$src$core$utils$string.startsWith=sI,i.module$build$src$core$utils$string.wrap=Dm;var au=void 0,el=false,Wo=false,Rv=50,Iv=0,tl=0,Md=0,Dd=0,Bi=null,sl=null,xd=0,Bd=10,Cv=10,Ov=750,lu=5,_s=null,ns={};ns.HOVER_MS=Ov,ns.LIMIT=Rv,ns.MARGINS=lu,ns.OFFSET_X=xd,ns.OFFSET_Y=Bd,ns.RADIUS_OK=Cv,ns.bindMouseEvents=yc,ns.block=Hm,ns.createDom=Um,ns.dispose=Gm,ns.getCustomTooltip=oI,ns.getDiv=lI,ns.getTooltipOfObject=xa,ns.hide=Dr,ns.isVisible=aI,ns.setCustomTooltip=rI,ns.unbindMouseEvents=Rc,ns.unblock=Vm;var Pd=.45,Ud=.65,kv={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Hs={};Hs.blend=Oo,Hs.getHsvSaturation=Wm,Hs.getHsvValue=zm,Hs.hexToRgb=Dh,Hs.hsvToHex=xh,Hs.hueToHex=Bh,Hs.names=kv,Hs.parse=xr,Hs.rgbToHex=Ic,Hs.setHsvSaturation=gI,Hs.setHsvValue=fI;var il={};il.checkMessageReferences=Cc,il.parseBlockColour=ko,il.replaceMessageReferences=Qt,il.tokenizeInterpolation=Uh;var pO=class{},cu=null,uu=null,zo="",jo="",Qi,en={};en.createDom=jm,en.getDiv=wo,en.hide=pn,en.hideIfOwner=Gh,en.isVisible=Xm,en.positionWithAnchor=Ym,en.show=Fh,en.testOnly_setDiv=mI;var pt=class{constructor(e,t,r){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=false,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=true,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=true,this.SERIALIZABLE=false,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new $s(0,0),e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(Qt(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=e}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=H(Q.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}createBorderRect_(){this.borderRect_=H(Q.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=H(Q.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");yc(e),this.mouseDownWrapper_=E(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return e=this.saveLegacyState(pt),e!==null?e:this.getValue()}loadState(e){this.loadLegacyState(pt,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?(e=_t("field"),e.setAttribute("name",this.name||""),Di(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml?(this.fromXml(js(t)),true):false}dispose(){Qe(this),Gh(this),Rc(this.getClickTarget_()),this.mouseDownWrapper_&&f(this.mouseDownWrapper_),x(this.fieldGroup_),this.disposed=true}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(ne(e,"blocklyEditableText"),de(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(ne(e,"blocklyNonEditableText"),de(e,"blocklyEditableText"),e.style.cursor=""))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==pt.prototype.showEditor_}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=false;return this.name&&(this.SERIALIZABLE?e=true:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=true)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}updateSize_(e){const t=this.getConstants();e=e!==void 0?e:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let r=2*e,a=t.FIELD_TEXT_HEIGHT,h=0;this.textElement_&&(h=bt(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY),r+=h),this.borderRect_&&(a=Math.max(a,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=a,this.size_.width=r,this.positionTextElement_(e,h),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var r=this.getConstants(),a=this.size_.height/2,h;this.textElement_.setAttribute("x",`${(h=this.getSourceBlock())!=null&&h.RTL?this.size_.width-t-e:e}`),this.textElement_.setAttribute("y",`${r.FIELD_TEXT_BASELINE_CENTER?a:a-r.FIELD_TEXT_HEIGHT/2+r.FIELD_TEXT_BASELINE}`)}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",`${this.size_.width}`),this.borderRect_.setAttribute("height",`${this.size_.height}`),this.borderRect_.setAttribute("rx",`${this.getConstants().FIELD_BORDER_RECT_RADIUS}`),this.borderRect_.setAttribute("ry",`${this.getConstants().FIELD_BORDER_RECT_RADIUS}`))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=false):this.visible_&&this.size_.width===0&&(this.render_(),this.size_.width!==0&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new $s(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new ps;if(this.borderRect_){var r=this.borderRect_.getBoundingClientRect();e=me(this.borderRect_),t=r.width,r=r.height}else{r=this.sourceBlock_.getHeightWidth();const a=t.workspace.scale;e=this.getAbsoluteXY_(),t=(r.width+1)*a,r=(r.height+1)*a,dd?(e.x+=1.5*a,e.y+=1.5*a):(e.x-=.5*a,e.y-=.5*a)}return new es(e.y,e.y+r,e.x,e.x+t)}getDisplayText_(){let e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"…"),e=e.replace(/\s/g,pt.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="‏"),e):pt.NBSP}getText(){const e=this.getText_();return String(e!==null?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=true,this.constants_=null}forceRerender(){this.isDirty_=true,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())}setValue(e){if(e!==null){var t=this.doClassValidation_(e);if(e=this.processValidation_(e,t),!(e instanceof Error)){if((t=this.getValidator())&&(t=t.call(this,e),e=this.processValidation_(e,t),e instanceof Error))return;if(t=this.sourceBlock_,!t||!t.disposed){var r=this.getValue();r===e?this.doValueUpdate_(e):(this.doValueUpdate_(e),t&&ls()&&Pe(new(Te(Ts))(t,"field",this.name||null,r,e)),this.isDirty_&&this.forceRerender())}}}}processValidation_(e,t){return t===null?(this.doValueInvalid_(e),this.isDirty_&&this.forceRerender(),Error()):(t!==void 0&&(e=t),e)}getValue(){return this.value_}doClassValidation_(e){return e??null}doValueUpdate_(e){this.value_=e,this.isDirty_=true}doValueInvalid_(e){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||e===""||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip_=e}getTooltip(){const e=this.getClickTarget_();return xa(e||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return me(this.getClickTarget_())}referencesVariables(){return false}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new ps;const r=t.inputList;for(let a=0;a<t.inputList.length;a++){const h=r[a],C=h.fieldRow;for(let D=0;D<C.length;D++)if(C[D]===this){e=h;break}}return e}getFlipRtl(){return false}isTabNavigable(){return false}onShortcut(e){return false}setCursorSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.cursorSvg_=e}else this.cursorSvg_=null}setMarkerSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.markerSvg_=e}else this.markerSvg_=null}updateMarkers_(){var e=this.getSourceBlock();if(!e)throw new ps;e=e.workspace,e.keyboardAccessibilityMode&&this.cursorSvg_&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg_&&e.getMarker(Qa.LOCAL_MARKER).draw()}};pt.NBSP=" ",pt.SKIP_SETUP=new pO;var ps=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},wv={fromJsonInternal:TI},nl={};nl.TEST_ONLY=wv,nl.fromJson=Hh,nl.register=xi,nl.unregister=bI;var gO="aria-",fO="role",li;(function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem"})(li||(li={}));var Gt;(function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin"})(Gt||(Gt={}));var rl={};rl.Role=li,rl.State=Gt,rl.setRole=gn,rl.setState=Xt;var xe;(function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"})(xe||(xe={}));var Fd=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu goog-menu blocklyNonSelectable",t.tabIndex=0,this.roleName&&gn(t,this.roleName),this.element=t;for(let r=0,a;a=this.menuItems[r];r++)t.appendChild(a.createDom());return this.mouseOverHandler=E(t,"pointerover",this,this.handleMouseOver,true),this.clickHandler=E(t,"pointerdown",this,this.handleClick,true),this.mouseEnterHandler=E(t,"pointerenter",this,this.handleMouseEnter,true),this.mouseLeaveHandler=E(t,"pointerleave",this,this.handleMouseLeave,true),this.onKeyDownHandler=E(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&(e.focus({preventScroll:true}),ne(e,"blocklyFocused"))}blur(){const e=this.getElement();e&&(e.blur(),de(e,"blocklyFocused"))}setRole(e){this.roleName=e}dispose(){this.mouseOverHandler&&(f(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(f(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(f(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(f(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(f(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e=0,t;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){for(let r=0,a;a=this.menuItems[r];r++)if(a.getElement()===e)return a}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;t&&(t.setHighlighted(false),this.highlightedItem=null),e&&(e.setHighlighted(true),this.highlightedItem=e,t=this.getElement(),ve(e.getElement(),t),Xt(t,Gt.ACTIVEDESCENDANT,e.getId()))}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>e?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){e+=t;let r;for(;r=this.menuItems[e];){if(r.isEnabled()){this.setHighlighted(r);break}e+=t}}handleMouseOver(e){(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){const t=this.openingCoords;if(this.openingCoords=null,t&&typeof e.clientX=="number"){const r=new Oe(e.clientX,e.clientY);if(1>Oe.distance(t,r))return}(e=this.getMenuItem(e.target))&&e.performAction()}handleMouseEnter(e){this.focus()}handleMouseLeave(e){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.keyCode){case xe.ENTER:case xe.SPACE:t&&t.performAction();break;case xe.UP:this.highlightPrevious();break;case xe.DOWN:this.highlightNext();break;case xe.PAGE_UP:case xe.HOME:this.highlightFirst();break;case xe.PAGE_DOWN:case xe.END:this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=Os(e);return t.height=e.scrollHeight,t}},Gd=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=true,this.element=null,this.rightToLeft=false,this.roleName=null,this.highlight=this.checked=this.checkable=false,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=Ar(),this.element=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var r=document.createElement("div");r.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",t.appendChild(r)}return r=this.content,typeof this.content=="string"&&(r=document.createTextNode(this.content)),t.appendChild(r),e.appendChild(t),this.roleName&&gn(e,this.roleName),Xt(e,Gt.SELECTED,this.checkable&&this.checked||false),Xt(e,Gt.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return(e=this.opt_value)!=null?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?(ne(t,"blocklyMenuItemHighlight"),ne(t,"goog-menuitem-highlight")):(de(t,"blocklyMenuItemHighlight"),de(t,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(e,t){this.actionHandler=e.bind(t)}},tn=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null,this.SERIALIZABLE=true,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions_=null,SI(e)&&(Array.isArray(e)?(qm(e),e=$I(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption_=this.getOptions(false)[0],r&&this.configure_(r),this.setValue(this.selectedOption_[1]),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(false),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(tn,e)||(this.isOptionListDynamic()&&this.getOptions(false),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=H(Q.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&ne(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((e=this.getSourceBlock())!=null&&e.isShadow())}createTextArrow_(){this.arrow_=H(Q.TSPAN,{},this.textElement_);let e;this.arrow_.appendChild(document.createTextNode((e=this.getSourceBlock())!=null&&e.RTL?tn.ARROW_CHAR+" ":" "+tn.ARROW_CHAR));let t;(t=this.getSourceBlock())!=null&&t.RTL?this.getTextElement().insertBefore(this.arrow_,this.textContent_):this.getTextElement().appendChild(this.arrow_)}createSVGArrow_(){this.svgArrow_=H(Q.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(oi,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new ps;this.dropdownCreate_(),this.menu_.openingCoords=e&&typeof e.clientX=="number"?new Oe(e.clientX,e.clientY):null,as(),e=this.menu_.render(Li()),ne(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(e=t.isShadow()?t.getParent().getColour():t.getColour(),t=t.isShadow()?t.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,N(e,t)),J(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()}dropdownCreate_(){const e=this.getSourceBlock();if(!e)throw new ps;const t=new Fd;t.setRole(li.LISTBOX),this.menu_=t;const r=this.getOptions(false);this.selectedMenuItem_=null;for(let h=0;h<r.length;h++){const[C,D]=r[h];if(typeof C=="object"){var a=new Image(C.width,C.height);a.src=C.src,a.alt=C.alt||""}else a=C;a=new Gd(a,D),a.setRole(li.OPTION),a.setRightToLeft(e.RTL),a.setCheckable(true),t.addChild(a),a.setChecked(D===this.value_),D===this.value_&&(this.selectedMenuItem_=a),a.onAction(this.handleMenuActionEvent_,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()}handleMenuActionEvent_(e){Qe(this,true),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:e&&this.generatedOptions_?this.generatedOptions_:(this.generatedOptions_=this.menuGenerator_(),qm(this.generatedOptions_),this.generatedOptions_)}doClassValidation_(e){return this.getOptions(true).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(true);for(let t=0,r;r=e[t];t++)r[1]===this.value_&&(this.selectedOption_=r)}applyColour(){const e=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",e.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow_&&(this.sourceBlock_.isShadow()?this.arrow_.style.fill=e.colourSecondary:this.arrow_.style.fill=e.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement_.style.display="none";const e=this.selectedOption_&&this.selectedOption_[0];e&&typeof e=="object"?this.renderSelectedImage_(e):this.renderSelectedText_(),this.positionBorderRect_()}renderSelectedImage_(e){const t=this.getSourceBlock();if(!t)throw new ps;this.imageElement_.style.display="",this.imageElement_.setAttributeNS(oi,"xlink:href",e.src),this.imageElement_.setAttribute("height",`${e.height}`),this.imageElement_.setAttribute("width",`${e.width}`);const r=Number(e.height);e=Number(e.width);var a=!!this.borderRect_;const h=Math.max(a?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,r+EO);a=a?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let C;C=this.svgArrow_?this.positionSVGArrow_(e+a,h/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):bt(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=e+C+2*a,this.size_.height=h;let D=0;t.RTL?this.imageElement_.setAttribute("x",(a+C).toString()):(D=e+C,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",a.toString())),this.imageElement_.setAttribute("y",(h/2-r/2).toString()),this.positionTextElement_(D+a,e+C)}renderSelectedText_(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();ne(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const r=bt(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let a=0;this.svgArrow_&&(a=this.positionSVGArrow_(r+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=r+a+2*t,this.size_.height=e,this.positionTextElement_(t,r)}positionSVGArrow_(e,t){if(!this.svgArrow_)return 0;const r=this.getSourceBlock();if(!r)throw new ps;const a=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,h=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,C=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(r.RTL?a:e+h)+","+t+")"),C+h}getText_(){if(!this.selectedOption_)return null;const e=this.selectedOption_[0];return typeof e=="object"?e.alt:e}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}};tn.CHECKMARK_OVERHANG=25,tn.MAX_MENU_HEIGHT_VH=.45,tn.ARROW_CHAR="▾";var mO=5,EO=2*mO;xi("field_dropdown",tn),i.module$build$src$core$field_dropdown={},i.module$build$src$core$field_dropdown.FieldDropdown=tn;var Hd=class extends Zi{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=Pn,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=r)}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}fromJson(e){o("Blockly.Events.BubbleOpen.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isOpen=e.isOpen,this.bubbleType=e.bubbleType,this.blockId=e.blockId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Hd),t.isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}},Vd;(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(Vd||(Vd={})),ye(Se.EVENT,Pn,Hd);var Kt=class{constructor(e,t,r,a,h){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new Oe(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=true,this.position=new Oe(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=r||false,this.margin=h!==void 0?h:Kt.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),a&&(e+=" "+a),this.outerSvg=H(Q.SVG,{class:e}),a=H(Q.G,{},this.outerSvg),this.svgBackground=H(Q.RECT,{class:"blocklyScrollbarBackground"},a),e=Math.floor((Kt.scrollbarThickness-5)/2),this.svgHandle=H(Q.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},a),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),te(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=E(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=E(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=Kt.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),f(this.onMouseDownBarWrapper_),f(this.onMouseDownHandleWrapper_),x(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,ae(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&(e=this.workspace.getMetrics(),!e)||this.oldHostMetrics&&Kt.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop:true}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=Kt.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=Kt.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-Kt.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(false);else{this.pair||this.setVisible(true);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var r=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=Kt.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-Kt.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(false);else{this.pair||this.setVisible(true);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var r=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){const t=e!==this.isVisible();if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),m(),this.cleanUp(),T(e))e.stopPropagation();else{var t=S(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var r=Tc(this.svgHandle);r=this.horizontal?r.x:r.y;var a=this.handlePosition,h=.95*this.handleLength;t<=r?a-=h:t>=r+this.handleLength&&(a+=h),this.setHandlePosition(this.constrainHandlePosition(a)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),T(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.workspace.setupDragSurface(),this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=E(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=E(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){this.workspace.resetDragSurface(),m(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(true),this.onMouseUpWrapper_&&(f(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(f(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||t===void 0)&&this.updateMetrics()}setOrigin(e,t){this.origin=new Oe(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};Kt.scrollbarThickness=ev?25:15,Kt.DEFAULT_SCROLLBAR_MARGIN=.5;var it=class{constructor(e,t,r,a,h,C){this.resizeGroup=this.bubbleBack=this.bubbleArrow=this.bubbleGroup=null,this.height=this.width=this.relativeTop=this.relativeLeft=0,this.autoLayout=true,this.onMouseDownResizeWrapper=this.onMouseDownBubbleWrapper=this.moveCallback=this.resizeCallback=null,this.rendered=this.disposed=false,this.workspace_=e,this.content_=t,this.shape_=r,r=it.ARROW_ANGLE,this.workspace_.RTL&&(r=-r),this.arrowRadians=Ve(r),e.getBubbleCanvas().appendChild(this.createDom(t,!(!h||!C))),this.setAnchorLocation(a),h&&C||(e=this.content_.getBBox(),h=e.width+2*it.BORDER_WIDTH,C=e.height+2*it.BORDER_WIDTH),this.setBubbleSize(h,C),this.positionBubble(),this.renderArrow(),this.rendered=true}createDom(e,t){this.bubbleGroup=H(Q.G,{});var r={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return av&&(r={}),r=H(Q.G,r,this.bubbleGroup),this.bubbleArrow=H(Q.PATH,{},r),this.bubbleBack=H(Q.RECT,{class:"blocklyDraggable",x:0,y:0,rx:it.BORDER_WIDTH,ry:it.BORDER_WIDTH},r),t?(this.resizeGroup=H(Q.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup),t=2*it.BORDER_WIDTH,H(Q.POLYGON,{points:"0,x x,x x,0".replace(/x/g,t.toString())},this.resizeGroup),H(Q.LINE,{class:"blocklyResizeLine",x1:t/3,y1:t-1,x2:t-1,y2:t/3},this.resizeGroup),H(Q.LINE,{class:"blocklyResizeLine",x1:2*t/3,y1:t-1,x2:t-1,y2:2*t/3},this.resizeGroup)):this.resizeGroup=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper=E(this.bubbleBack,"pointerdown",this,this.bubbleMouseDown),this.resizeGroup&&(this.onMouseDownResizeWrapper=E(this.resizeGroup,"pointerdown",this,this.resizeMouseDown))),this.bubbleGroup.appendChild(e),this.bubbleGroup}getSvgRoot(){return this.bubbleGroup}setSvgId(e){let t;(t=this.bubbleGroup)==null||t.setAttribute("data-block-id",e)}bubbleMouseDown(e){const t=this.workspace_.getGesture(e);t&&t.handleBubbleStart(e,this)}showContextMenu(e){}isDeletable(){return false}setDeleteStyle(e){}resizeMouseDown(e){this.promote(),it.unbindDragEvents(),T(e)||(this.workspace_.startDrag(e,new Oe(this.workspace_.RTL?-this.width:this.width,this.height)),it.onMouseUpWrapper=E(document,"pointerup",this,it.bubbleMouseUp),it.onMouseMoveWrapper=E(document,"pointermove",this,this.resizeMouseMove),this.workspace_.hideChaff()),e.stopPropagation()}resizeMouseMove(e){this.autoLayout=false,e=this.workspace_.moveDrag(e),this.setBubbleSize(this.workspace_.RTL?-e.x:e.x,e.y),this.workspace_.RTL&&this.positionBubble()}registerResizeEvent(e){this.resizeCallback=e}registerMoveEvent(e){this.moveCallback=e}promote(){let e;const t=(e=this.bubbleGroup)==null?void 0:e.parentNode;return(t==null?void 0:t.lastChild)!==this.bubbleGroup&&this.bubbleGroup?(t==null||t.appendChild(this.bubbleGroup),true):false}setAnchorLocation(e){this.anchorXY=e,this.rendered&&this.positionBubble()}layoutBubble(){var e=this.workspace_.getMetricsManager().getViewMetrics(true),t=this.getOptimalRelativeLeft(e),r=this.getOptimalRelativeTop(e),a=this.shape_.getBBox();const h={x:t,y:-this.height-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},C={x:-this.width-30,y:r};r={x:a.width,y:r};var D={x:t,y:a.height};t=a.width<a.height?r:D,a=a.width<a.height?D:r,r=this.getOverlap(h,e),D=this.getOverlap(C,e);const Y=this.getOverlap(t,e);e=this.getOverlap(a,e),e=Math.max(r,D,Y,e),r===e?(this.relativeLeft=h.x,this.relativeTop=h.y):D===e?(this.relativeLeft=C.x,this.relativeTop=C.y):Y===e?(this.relativeLeft=t.x,this.relativeTop=t.y):(this.relativeLeft=a.x,this.relativeTop=a.y)}getOverlap(e,t){var r=this.workspace_.RTL?this.anchorXY.x-e.x-this.width:e.x+this.anchorXY.x;return e=e.y+this.anchorXY.y,Math.max(0,Math.min(1,(Math.min(r+this.width,t.left+t.width)-Math.max(r,t.left))*(Math.min(e+this.height,t.top+t.height)-Math.max(e,t.top))/(this.width*this.height)))}getOptimalRelativeLeft(e){let t=-this.width/4;if(this.width>e.width)return t;if(this.workspace_.RTL){var r=this.anchorXY.x-t,a=e.left+e.width;e=e.left+Kt.scrollbarThickness/this.workspace_.scale,r-this.width<e?t=-(e-this.anchorXY.x+this.width):r>a&&(t=-(a-this.anchorXY.x))}else{r=t+this.anchorXY.x,a=r+this.width;const h=e.left;e=e.left+e.width-Kt.scrollbarThickness/this.workspace_.scale,r<h?t=h-this.anchorXY.x:a>e&&(t=e-this.anchorXY.x-this.width)}return t}getOptimalRelativeTop(e){let t=-this.height/4;if(this.height>e.height)return t;const r=this.anchorXY.y+t,a=r+this.height,h=e.top;e=e.top+e.height-Kt.scrollbarThickness/this.workspace_.scale;const C=this.anchorXY.y;return r<h?t=h-C:a>e&&(t=e-C-this.height),t}positionBubble(){let e=this.anchorXY.x;e=this.workspace_.RTL?e-(this.relativeLeft+this.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchorXY.y)}moveTo(e,t){let r;(r=this.bubbleGroup)==null||r.setAttribute("transform","translate("+e+","+t+")")}setDragging(e){!e&&this.moveCallback&&this.moveCallback()}getBubbleSize(){return new $s(this.width,this.height)}setBubbleSize(e,t){const r=2*it.BORDER_WIDTH;e=Math.max(e,r+45),t=Math.max(t,r+20),this.width=e,this.height=t;let a;(a=this.bubbleBack)==null||a.setAttribute("width",e.toString());let h;(h=this.bubbleBack)==null||h.setAttribute("height",t.toString()),this.resizeGroup&&(this.workspace_.RTL?this.resizeGroup.setAttribute("transform","translate("+2*it.BORDER_WIDTH+","+(t-r)+") scale(-1 1)"):this.resizeGroup.setAttribute("transform","translate("+(e-r)+","+(t-r)+")")),this.autoLayout&&this.layoutBubble(),this.positionBubble(),this.renderArrow(),this.resizeCallback&&this.resizeCallback()}renderArrow(){const e=[];var t=this.width/2,r=this.height/2,a=-this.relativeLeft,h=-this.relativeTop;if(t===a&&r===h)e.push("M "+t+","+r);else{h-=r,a-=t,this.workspace_.RTL&&(a*=-1);var C=Math.sqrt(h*h+a*a),D=Math.acos(a/C);0>h&&(D=2*Math.PI-D);var Y=D+Math.PI/2;Y>2*Math.PI&&(Y-=2*Math.PI);var pe=Math.sin(Y);const zt=Math.cos(Y);var ke=this.getBubbleSize();Y=(ke.width+ke.height)/it.ARROW_THICKNESS,Y=Math.min(Y,ke.width,ke.height)/4,ke=1-it.ANCHOR_RADIUS/C,a=t+ke*a,h=r+ke*h,ke=t+Y*zt;const yi=r+Y*pe;t-=Y*zt,r-=Y*pe,pe=D+this.arrowRadians,pe>2*Math.PI&&(pe-=2*Math.PI),D=Math.sin(pe)*C/it.ARROW_BEND,C=Math.cos(pe)*C/it.ARROW_BEND,e.push("M"+ke+","+yi),e.push("C"+(ke+C)+","+(yi+D)+" "+a+","+h+" "+a+","+h),e.push("C"+a+","+h+" "+(t+C)+","+(r+D)+" "+t+","+r)}e.push("z");let ft;(ft=this.bubbleArrow)==null||ft.setAttribute("d",e.join(" "))}setColour(e){let t;(t=this.bubbleBack)==null||t.setAttribute("fill",e);let r;(r=this.bubbleArrow)==null||r.setAttribute("fill",e)}dispose(){this.onMouseDownBubbleWrapper&&f(this.onMouseDownBubbleWrapper),this.onMouseDownResizeWrapper&&f(this.onMouseDownResizeWrapper),it.unbindDragEvents(),x(this.bubbleGroup),this.disposed=true}moveDuringDrag(e,t){e?e.translateSurface(t.x,t.y):this.moveTo(t.x,t.y),this.relativeLeft=this.workspace_.RTL?this.anchorXY.x-t.x-this.width:t.x-this.anchorXY.x,this.relativeTop=t.y-this.anchorXY.y,this.renderArrow()}getRelativeToSurfaceXY(){return new Oe(this.workspace_.RTL?-this.relativeLeft+this.anchorXY.x-this.width:this.anchorXY.x+this.relativeLeft,this.anchorXY.y+this.relativeTop)}setAutoLayout(e){this.autoLayout=e}static unbindDragEvents(){it.onMouseUpWrapper&&(f(it.onMouseUpWrapper),it.onMouseUpWrapper=null),it.onMouseMoveWrapper&&(f(it.onMouseMoveWrapper),it.onMouseMoveWrapper=null)}static bubbleMouseUp(e){m(),it.unbindDragEvents()}static textToDom(e){const t=H(Q.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:it.BORDER_WIDTH});e=e.split(`
`);for(let r=0;r<e.length;r++){const a=H(Q.TSPAN,{dy:"1em",x:it.BORDER_WIDTH},t),h=document.createTextNode(e[r]);a.appendChild(h)}return t}static createNonEditableBubble(e,t,r){if(r=new it(t.workspace,e,t.pathObject.svgPath,r,null,null),r.setSvgId(t.id),t.RTL){t=e.getBBox().width;for(let a=0,h;h=e.childNodes[a];a++)h.setAttribute("text-anchor","end"),h.setAttribute("x",(t+it.BORDER_WIDTH).toString())}return r}};it.BORDER_WIDTH=6,it.ARROW_THICKNESS=5,it.ARROW_ANGLE=20,it.ARROW_BEND=4,it.ANCHOR_RADIUS=8,it.onMouseUpWrapper=null,it.onMouseMoveWrapper=null;var Wd,Av;Wd=28,i.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:Wd,connectingSnapRadius:Wd,currentConnectionPreference:8,bumpDelay:250},Av={},Av.config=i.config$$module$build$src$core$config;var hu=class{constructor(e){this.iconGroup_=null,this.collapseHidden=true,this.SIZE=17,this.iconXY_=this.bubble_=null,e||o("Calling the Icon constructor with a null block","version 9","version 10","a non-null block"),this.block_=e}createIcon(){this.iconGroup_||(this.iconGroup_=H(Q.G,{class:"blocklyIconGroup"}),this.getBlock().isInFlyout&&ne(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.getBlock().getSvgRoot().appendChild(this.iconGroup_),E(this.iconGroup_,"pointerup",this,this.iconClick_),this.updateEditable())}dispose(){x(this.iconGroup_),this.setVisible(false)}updateEditable(){}isVisible(){return!!this.bubble_}iconClick_(e){this.getBlock().workspace.isDragging()||this.getBlock().isInFlyout||T(e)||this.setVisible(!this.isVisible())}applyColour(){this.bubble_&&this.isVisible()&&this.bubble_.setColour(this.getBlock().style.colourPrimary)}setIconLocation(e){this.iconXY_=e,this.bubble_&&this.isVisible()&&this.bubble_.setAnchorLocation(e)}computeIconLocation(){var e=this.getBlock().getRelativeToSurfaceXY();const t=mi(this.iconGroup_);e=new Oe(e.x+t.x+this.SIZE/2,e.y+t.y+this.SIZE/2),Oe.equals(this.getIconLocation(),e)||this.setIconLocation(e)}getIconLocation(){return this.iconXY_}getCorrectedSize(){return new $s(this.SIZE,this.SIZE-2)}drawIcon_(e){}setVisible(e){}getBlock(){if(!this.block_)throw Error("Block is not set for this icon.");return this.block_}},ol={};ol.deepMerge=nr,ol.inherits=RI,ol.mixin=II,ol.values=CI;var Kr=class{constructor(e,t,r,a){this.name=e,this.startHats=false,this.blockStyles=t||Object.create(null),this.categoryStyles=r||Object.create(null),this.componentStyles=a||Object.create(null),this.fontStyle=Object.create(null),ye(Se.THEME,e,this)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){return(e=this.componentStyles[e])&&typeof e=="string"&&this.getComponentStyle(e)?this.getComponentStyle(e):e?String(e):null}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const r=new Kr(e);let a=t.base;if(a){if(typeof a=="string"){let h;a=(h=vo(Se.THEME,a))!=null?h:void 0}a instanceof Kr&&(nr(r,a),r.name=e)}return nr(r.blockStyles,t.blockStyles),nr(r.categoryStyles,t.categoryStyles),nr(r.componentStyles,t.componentStyles),nr(r.fontStyle,t.fontStyle),t.startHats!==null&&(r.startHats=t.startHats),r}},vO={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},bO={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},du=new Kr("classic",vO,bO),zd="categoryToolbox",Lv="flyoutToolbox",et;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(et||(et={}));var Nv={hasCategoriesInternal:kI},hr={};hr.Position=et,hr.TEST_ONLY=Nv,hr.convertFlyoutDefToJsonArray=kc,hr.convertToolboxDefToJson=Oc,hr.hasCategories=Vh,hr.isCategoryCollapsible=Wh,hr.parseToolboxTree=Zm;var sn=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,r=false;var a=false,h=false,C=false,D=false,Y=false;const pe=!!e.readOnly;if(!pe){var ke;t=Oc((ke=e.toolbox)!=null?ke:null),r=Vh(t),a=e.trashcan,a=a===void 0?r:a,h=e.collapse,h=h===void 0?r:h,C=e.comments,C=C===void 0?r:C,D=e.disable,D=D===void 0?r:D,Y=e.sounds,Y=Y===void 0?true:Y}ke=e.maxTrashcanContents,a?ke===void 0&&(ke=32):ke=0;const ft=!!e.rtl;let zt=e.horizontalLayout;zt===void 0&&(zt=false);var yi=e.toolboxPosition!=="end";yi=zt?yi?et.TOP:et.BOTTOM:yi===ft?et.RIGHT:et.LEFT;let K_=e.css;K_===void 0&&(K_=true);let Y_="https://blockly-demo.appspot.com/static/media/";e.media?Y_=e.media.endsWith("/")?e.media:e.media+"/":"path"in e&&(o("path","Nov 2014","Jul 2023","media"),Y_=e.path+"media/");const Zb=e.oneBasedIndex,ek=e.renderer||"geras",tk=e.plugins||{};let q_=e.modalInputs;q_===void 0&&(q_=true),this.RTL=ft,this.oneBasedIndex=Zb===void 0?true:Zb,this.collapse=h,this.comments=C,this.disable=D,this.readOnly=pe,this.maxBlocks=e.maxBlocks||1/0;let Qb;this.maxInstances=(Qb=e.maxInstances)!=null?Qb:null,this.modalInputs=q_,this.pathToMedia=Y_,this.hasCategories=r,this.moveOptions=sn.parseMoveOptions_(e,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=a,this.maxTrashcanContents=ke,this.hasSounds=Y,this.hasCss=K_,this.horizontalLayout=zt,this.languageTree=t,this.gridOptions=sn.parseGridOptions_(e),this.zoomOptions=sn.parseZoomOptions_(e),this.toolboxPosition=yi,this.theme=sn.parseThemeOptions_(e),this.renderer=ek;let eT;this.rendererOverrides=(eT=e.rendererOverrides)!=null?eT:null;let tT;this.parentWorkspace=(tT=e.parentWorkspace)!=null?tT:null,this.plugins=tk}static parseMoveOptions_(e,t){const r=e.move||{},a={};return r.scrollbars===void 0&&e.scrollbars===void 0?a.scrollbars=t:typeof r.scrollbars=="object"?(a.scrollbars={horizontal:!!r.scrollbars.horizontal,vertical:!!r.scrollbars.vertical},a.scrollbars.horizontal&&a.scrollbars.vertical?a.scrollbars=true:a.scrollbars.horizontal||a.scrollbars.vertical||(a.scrollbars=false)):a.scrollbars=!!r.scrollbars||!!e.scrollbars,a.wheel=a.scrollbars&&r.wheel!==void 0?!!r.wheel:typeof a.scrollbars=="object",a.drag=a.scrollbars?r.drag===void 0?true:!!r.drag:false,a}static parseZoomOptions_(e){e=e.zoom||{};const t={};return t.controls=e.controls===void 0?false:!!e.controls,t.wheel=e.wheel===void 0?false:!!e.wheel,t.startScale=e.startScale===void 0?1:Number(e.startScale),t.maxScale=e.maxScale===void 0?3:Number(e.maxScale),t.minScale=e.minScale===void 0?.3:Number(e.minScale),t.scaleSpeed=e.scaleSpeed===void 0?1.2:Number(e.scaleSpeed),t.pinch=e.pinch===void 0?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions_(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=e.length===void 0?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions_(e){return e=e.theme||du,typeof e=="string"?vo(Se.THEME,e):e instanceof Kr?e:Kr.defineTheme(e.name||"builtin"+Ar(),e)}},Mv;i.Mutator$$module$build$src$core$mutator=class extends hu{constructor(e,t){t||o("Calling the Mutator constructor without passing the block it is attached to","version 9","version 10","the constructor by passing the list of subblocks and the block instance to attach the mutator to"),super(t??null),this.workspace_=null,this.workspaceHeight=this.workspaceWidth=0,this.updateWorkspacePid=this.sourceListener=this.rootBlock=this.svgDialog=null,this.quarkNames=e}setBlock(e){this.block_=e}getWorkspace(){return this.workspace_}drawIcon_(e){H(Q.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},e),H(Q.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},e),H(Q.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},e)}iconClick_(e){this.getBlock().isEditable()&&super.iconClick_(e)}createEditor(){if(this.svgDialog=H(Q.SVG,{x:it.BORDER_WIDTH,y:it.BORDER_WIDTH}),this.quarkNames.length){var e=_t("xml");for(let a=0,h;h=this.quarkNames[a];a++){var t=_t("block");t.setAttribute("type",h),e.appendChild(t)}}else e=null;var r=this.getBlock();return t=new sn({disable:false,parentWorkspace:r.workspace,media:r.workspace.options.pathToMedia,rtl:r.RTL,horizontalLayout:false,renderer:r.workspace.options.renderer,rendererOverrides:r.workspace.options.rendererOverrides}),t.toolboxPosition=r.RTL?et.RIGHT:et.LEFT,(r=!!e)&&(t.languageTree=Oc(e)),this.workspace_=this.newWorkspaceSvg(t),this.workspace_.internalIsMutator=true,this.workspace_.addChangeListener(Nt),e=r?this.workspace_.addFlyout(Q.G):null,t=this.workspace_.createDom("blocklyMutatorBackground"),e&&t.insertBefore(e,this.workspace_.svgBlockCanvas_),this.svgDialog.appendChild(t),this.svgDialog}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}updateEditable(){super.updateEditable(),this.getBlock().isInFlyout||(this.getBlock().isEditable()?this.iconGroup_&&de(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(false),this.iconGroup_&&ne(this.iconGroup_,"blocklyIconGroupReadonly")))}resizeBubble(){if(this.workspace_){var e=2*it.BORDER_WIDTH,t=this.workspace_.getCanvas(),r=t.getBBox(),a=r.width+r.x,h=r.height+3*e,C=this.workspace_.getFlyout();if(C){const D=C.getWorkspace().getMetricsManager().getScrollMetrics();h=Math.max(h,D.height+20),a+=C.getWidth()}(C=this.getBlock().RTL)&&(a=-r.x),a+=3*e,(Math.abs(this.workspaceWidth-a)>e||Math.abs(this.workspaceHeight-h)>e)&&(this.workspaceWidth=a,this.workspaceHeight=h,this.bubble_.setBubbleSize(a+e,h+e),this.svgDialog.setAttribute("width",`${a}`),this.svgDialog.setAttribute("height",`${h}`),this.workspace_.setCachedParentSvgSize(a,h)),C&&t.setAttribute("transform",`translate(${this.workspaceWidth}, 0)`),this.workspace_.resize()}}onBubbleMove(){this.workspace_&&this.workspace_.recordDragTargets()}setVisible(e){if(e!==this.isVisible()){var t=this.getBlock();if(Pe(new(Te(Pn))(t,e,"mutator")),e){this.bubble_=new it(t.workspace,this.createEditor(),t.pathObject.svgPath,this.iconXY_,null,null),e=this.workspace_,this.bubble_.setSvgId(t.id),this.bubble_.registerMoveEvent(this.onBubbleMove.bind(this));var r=e.options.languageTree,a=e.getFlyout();r&&(a.init(e),a.show(r)),this.rootBlock=t.decompose(e),r=this.rootBlock.getDescendants(false);for(let h=0,C;C=r[h];h++)C.render();if(this.rootBlock.setMovable(false),this.rootBlock.setDeletable(false),a?(r=2*a.CORNER_RADIUS,a=this.rootBlock.RTL?a.getWidth()+r:r):a=r=16,t.RTL&&(a=-a),this.rootBlock.moveBy(a,r),t.saveConnections){const h=this.rootBlock;t.saveConnections(h),this.sourceListener=()=>{const C=this.getBlock();C.saveConnections&&C.saveConnections(h)},t.workspace.addChangeListener(this.sourceListener)}this.resizeBubble(),e.addChangeListener(this.workspaceChanged.bind(this)),this.updateWorkspace(),this.applyColour()}else this.svgDialog=null,this.workspace_.dispose(),this.rootBlock=this.workspace_=null,(a=this.bubble_)==null||a.dispose(),this.bubble_=null,this.workspaceHeight=this.workspaceWidth=0,this.sourceListener&&(t.workspace.removeChangeListener(this.sourceListener),this.sourceListener=null)}}workspaceChanged(e){this.shouldIgnoreMutatorEvent_(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.updateWorkspace()},0))}shouldIgnoreMutatorEvent_(e){return e.isUiEvent||e.type===ws||e.type===Ts&&e.element==="disabled"}updateWorkspace(){if(!this.workspace_.isDragging()){var e=this.workspace_.getTopBlocks(false);for(let a=0,h;h=e[a];a++){var t=h.getRelativeToSurfaceXY();if(20>t.y&&h.moveBy(0,20-t.y),h.RTL){var r=-20;const C=this.workspace_.getFlyout();C&&(r-=C.getWidth()),t.x>r&&h.moveBy(r-t.x,0)}else 20>t.x&&h.moveBy(20-t.x,0)}}if(this.rootBlock&&this.rootBlock.workspace===this.workspace_){(e=Ft())||We(true);const a=this.getBlock();if(t=Xr.getExtraBlockState_(a),r=a.rendered,a.rendered=false,a.compose(this.rootBlock),a.rendered=r,a.initSvg(),a.rendered&&a.render(),r=Xr.getExtraBlockState_(a),t!==r){Pe(new(Te(Ts))(a,"mutation",null,t,r));const h=Ft();setTimeout(function(){const C=Ft();We(h),a.bumpNeighbours(),We(C)},i.config$$module$build$src$core$config.bumpDelay)}this.workspace_.isDragging()||setTimeout(()=>this.resizeBubble(),0),We(e)}}dispose(){this.getBlock().mutator=null,super.dispose()}updateBlockStyle(){var e=this.workspace_;if(e&&e.getAllBlocks(false)){const t=e.getAllBlocks(false);for(let r=0,a;a=t[r];r++)a.setStyle(a.getStyleName());if(e=e.getFlyout()){e=e.getWorkspace().getAllBlocks(false);for(let r=0,a;a=e[r];r++)a.setStyle(a.getStyleName())}}}static reconnect(e,t,r){if(!e||!e.getSourceBlock().workspace)return false;r=t.getInput(r).connection;const a=e.targetBlock();return a&&a!==t||!r||r.targetConnection===e?false:(r.isConnected()&&r.disconnect(),r.connect(e),true)}static findParentWs(e){let t=null;if(e&&e.options){const r=e.options.parentWorkspace;e.isFlyout?r&&r.options&&(t=r.options.parentWorkspace):r&&(t=r)}return t}},Mv={},Mv.Mutator=i.Mutator$$module$build$src$core$mutator;var Xo=Object.create(null),TO={allExtensions:Xo};wc("parent_tooltip_when_inline",GI),i.module$build$src$core$extensions={},i.module$build$src$core$extensions.TEST_ONLY=TO,i.module$build$src$core$extensions.apply=jh,i.module$build$src$core$extensions.buildTooltipForDropdown=PI,i.module$build$src$core$extensions.buildTooltipWithFieldText=FI,i.module$build$src$core$extensions.isRegistered=Qm,i.module$build$src$core$extensions.register=wc,i.module$build$src$core$extensions.registerMixin=AI,i.module$build$src$core$extensions.registerMutator=LI,i.module$build$src$core$extensions.runAfterPageLoad=Ac,i.module$build$src$core$extensions.unregister=NI;var Dv={};Dv.removeElem=ii;var Fn={};Fn.arc=ds,Fn.curve=Ei,Fn.line=Ba,Fn.lineOnAxis=Ne,Fn.lineTo=Nn,Fn.moveBy=Wt,Fn.moveTo=Fs,Fn.point=Ge;var gt={};gt.Coordinate=Oe,gt.KeyCodes=xe,gt.Rect=es,gt.Size=$s,gt.Svg=Q,gt.aria=rl,gt.array=Dv,gt.arrayRemove=YI,gt.browserEvents=xn,gt.checkMessageReferences=jI,gt.colour=Hs,gt.deprecation=bs,gt.dom=Es,gt.extensions=i.module$build$src$core$extensions,gt.getBlockTypeCounts=JI,gt.getDocumentScroll=qI,gt.getInjectionDivXY_=VI,gt.getRelativeXY=HI,gt.getViewportBBox=KI,gt.idGenerator=Kc,gt.is3dSupported=XI,gt.math=zc,gt.object=ol,gt.parseBlockColour=QI,gt.parsing=il,gt.replaceMessageReferences=zI,gt.runAfterPageLoad=eC,gt.screenToWsCoordinates=ZI,gt.string=i.module$build$src$core$utils$string,gt.style=mn,gt.svgMath=ur,gt.svgPaths=Fn,gt.tokenizeInterpolation=WI,gt.toolbox=hr,gt.userAgent=Dn,gt.xml=i.module$build$src$core$utils$xml;var jd=class extends Zi{constructor(e,t){super(t),this.type=ja,this.isOpen=e}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}fromJson(e){o("Blockly.Events.TrashcanOpen.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isOpen=e.isOpen}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new jd),t.isOpen=e.isOpen,t}};ye(Se.EVENT,ja,jd);var Gn=class{constructor(e){this.name_=e}toString(){return this.name_}};Gn.POSITIONABLE=new Gn("positionable"),Gn.DRAG_TARGET=new Gn("drag_target"),Gn.DELETE_AREA=new Gn("delete_area"),Gn.AUTOHIDEABLE=new Gn("autohideable");var ys=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const r=e.component.id;if(!t&&this.componentData.has(r)){var a;throw Error('Plugin "'+r+'" with capabilities "'+((a=this.componentData.get(r))==null?void 0:a.capabilities)+'" already added.')}for(this.componentData.set(r,e),t=[],a=0;a<e.capabilities.length;a++){const h=String(e.capabilities[a]).toLowerCase();if(t.push(h),this.capabilityToComponentIds.has(h)){let C;(C=this.capabilityToComponentIds.get(h))==null||C.push(r)}else this.capabilityToComponentIds.set(h,[r])}this.componentData.get(r).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let r=0;r<t.capabilities.length;r++){const a=String(t.capabilities[r]).toLowerCase();ii(this.capabilityToComponentIds.get(a),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');if(this.hasCapability(e,t))console.warn('Plugin "'+e+'already has capability "'+t+'"');else{t=String(t).toLowerCase();var r;(r=this.componentData.get(e))==null||r.capabilities.push(t);var a;(a=this.capabilityToComponentIds.get(t))==null||a.push(e)}}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=String(t).toLowerCase(),ii(this.componentData.get(e).capabilities,t),ii(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+`doesn't have capability "`+t+'" to remove')}hasCapability(e,t){return t=String(t).toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.indexOf(t)!==-1}getComponent(e){let t;return(t=this.componentData.get(e))==null?void 0:t.component}getComponents(e,t){if(e=String(e).toLowerCase(),e=this.capabilityToComponentIds.get(e),!e)return[];const r=[];if(t){const a=[];e.forEach(h=>{a.push(this.componentData.get(h))}),a.sort(function(h,C){return h.weight-C.weight}),a.forEach(function(h){r.push(h.component)})}else e.forEach(a=>{r.push(this.componentData.get(a).component)});return r}};ys.Capability=Gn;var al=class extends Error{},xv=class extends al{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},ll=class extends al{constructor(e,t,r){super(`The block ${t.toDevString()} is missing a(n) ${e}
connection`),this.block=t,this.state=r}},Bv=class extends al{constructor(e,t,r,a){super(`The block ${r.toDevString()} could not connect its
${t} to its parent, because: ${e}`),this.childBlock=r,this.childState=a}},Pv=class extends al{constructor(e){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=e}},Ko={};Ko.BadConnectionCheck=Bv,Ko.DeserializationError=al,Ko.MissingBlockType=xv,Ko.MissingConnection=ll,Ko.RealChildOfShadow=Pv;var Uv=100,Fv=75,Gv=50,_u={};_u.BLOCKS=Gv,_u.PROCEDURES=Fv,_u.VARIABLES=Uv;var Xd={};Xd.register=Yh,Xd.unregister=tC;var Hv=class{constructor(){this.priority=Gv}save(e){const t=[];for(const r of e.getTopBlocks(false))(e=Mn(r,{addCoordinates:true,doFullSerialization:false}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const r of e)Br(r,t,{recordUndo:Us()})}clear(e){for(const t of e.getTopBlocks(false))t.dispose(false)}};Yh("blocks",new Hv);var cl={};cl.BlockSerializer=Hv,cl.append=Br,cl.appendInternal=qh,cl.save=Mn;var Kd=class extends Vo{constructor(e){super(e),this.type=ws,e&&(e.isShadow()&&(this.recordUndo=false),this.xml=Sc(e),this.ids=So(e),this.json=Mn(e,{addCoordinates:true}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=Di(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}fromJson(e){o("Blockly.Events.BlockCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.xml=js(e.xml),this.ids=e.ids,this.json=e.json,e.recordUndo!==void 0&&(this.recordUndo=e.recordUndo)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Kd),t.xml=js(e.xml),t.ids=e.ids,t.json=e.json,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(e)Br(this.json,t);else for(e=0;e<this.ids.length;e++){const r=this.ids[e],a=t.getBlockById(r);a?a.dispose(false):r===this.blockId&&console.warn("Can't uncreate non-existent block: "+r)}}};ye(Se.EVENT,ws,Kd);var Yd=class extends Vo{constructor(e){if(super(e),this.type=En,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=false),this.oldXml=Sc(e),this.ids=So(e),this.wasShadow=e.isShadow(),this.oldJson=Mn(e,{addCoordinates:true})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=Di(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}fromJson(e){o("Blockly.Events.BlockDelete.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldXml=js(e.oldXml),this.ids=e.ids,this.wasShadow=e.wasShadow||this.oldXml.tagName.toLowerCase()==="shadow",this.oldJson=e.oldJson,e.recordUndo!==void 0&&(this.recordUndo=e.recordUndo)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Yd),t.oldXml=js(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||t.oldXml.tagName.toLowerCase()==="shadow",t.oldJson=e.oldJson,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const r=this.ids[e],a=t.getBlockById(r);a?a.dispose(false):r===this.blockId&&console.warn("Can't delete non-existent block: "+r)}else Br(this.oldJson,t)}};ye(Se.EVENT,En,Yd);var Le;(function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(Le||(Le={})),i.module$build$src$core$connection_type={},i.module$build$src$core$connection_type.ConnectionType=Le;var St=class{constructor(e,t){this.type=t,this.targetConnection=null,this.disposed=false,this.shadowDom_=this.check_=null,this.y=this.x=0,this.shadowState_=null,this.sourceBlock_=e}connect_(e){const t=Le.INPUT_VALUE,r=this.getSourceBlock();var a=e.getSourceBlock();e.isConnected()&&e.disconnect();let h;if(this.isConnected()){const D=this.stashShadowState_(),Y=this.targetBlock();Y.isShadow()?Y.dispose(false):(this.disconnect(),h=Y),this.applyShadowState_(D)}let C;ls()&&(C=new(Te(Xs))(a)),EC(this,e),a.setParent(r),C&&(C.recordNew(),Pe(C)),h&&(e=this.type===t?h.outputConnection:h.previousConnection,(a=St.getConnectionForOrphanedConnection(a,e))?e.connect(a):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.setShadowStateInternal_();const e=this.targetBlock();e&&e.unplug()}this.disposed=true}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Le.INPUT_VALUE||this.type===Le.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return true;if(this.getConnectionChecker().canConnect(this,e,false)){const t=Ft();t||We(true),this.isSuperior()?this.connect_(e):e.connect_(this),t||We(false)}return this.isConnected()}disconnect(){var e=this.targetConnection;if(!e)throw Error("Source connection not connected.");if(e.targetConnection!==this)throw Error("Target connection not connected to source connection.");let t,r;this.isSuperior()?(t=this.sourceBlock_,r=e.getSourceBlock(),e=this):(t=e.getSourceBlock(),r=this.sourceBlock_);const a=Ft();a||We(true),this.disconnectInternal_(t,r),r.isShadow()||e.respawnShadow_(),a||We(false)}disconnectInternal_(e,t){let r;ls()&&(r=new(Te(Xs))(t)),(e=this.targetConnection)&&(e.targetConnection=null),this.targetConnection=null,t.setParent(null),r&&(r.recordNew(),Pe(r))}respawnShadow_(){this.createShadowBlock_(true)}targetBlock(){if(this.isConnected()){let e,t;return(t=(e=this.targetConnection)==null?void 0:e.getSourceBlock())!=null?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,false)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check_=e,this.onCheckChanged_()):this.check_=null,this}getCheck(){return this.check_}setShadowDom(e){this.setShadowStateInternal_({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Mr(this.targetBlock()):this.shadowDom_}setShadowState(e){this.setShadowStateInternal_({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?Mn(this.targetBlock()):this.shadowState_}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let r=0;r<t.length;r++)if(t[r].connection===this){e=t[r];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let r=0,a;a=e.inputList[r];r++)if(a.connection===this){t=a;break}if(t)t='Input "'+t.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return t+e.toDevString()}stashShadowState_(){const e=this.getShadowDom(true),t=this.getShadowState(true);return this.shadowState_=this.shadowDom_=null,{shadowDom:e,shadowState:t}}applyShadowState_({shadowDom:e,shadowState:t}){this.shadowDom_=e,this.shadowState_=t}setShadowStateInternal_({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom_=e,this.shadowState_=t,(e=this.targetBlock())?e.isShadow()?(e.dispose(false),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock())):(e=this.createShadowBlock_(false),this.serializeShadow_(e),e&&e.dispose(false)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock()))}createShadowBlock_(e){var t=this.getSourceBlock();const r=this.getShadowState(),a=this.getShadowDom();if(t.isDeadOrDying()||!r&&!a)return null;if(r)return t=qh(r,t.workspace,{parentConnection:e?this:void 0,isShadow:true,recordUndo:false});if(a){if(t=Co(a,t.workspace),e)if(this.type===Le.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===Le.NEXT_STATEMENT){if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return t}return null}serializeShadow_(e){e&&(this.shadowDom_=Mr(e),this.shadowState_=Mn(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===Le.OUTPUT_VALUE)return bC(e,t.getSourceBlock());e=e.lastConnectionInStack(true);const r=t.getConnectionChecker();return e&&r.canConnect(t,e,false)?e:null}};St.CAN_CONNECT=0,St.REASON_SELF_CONNECTION=1,St.REASON_WRONG_TYPE=2,St.REASON_TARGET_NULL=3,St.REASON_CHECKS_FAILED=4,St.REASON_DIFFERENT_WORKSPACES=5,St.REASON_SHADOW_PARENT=6,St.REASON_DRAG_CHECKS_FAILED=7,St.REASON_PREVIOUS_AND_OUTPUT=8;var ul="_TEMP_COLLAPSED_INPUT",hl="_TEMP_COLLAPSED_FIELD",qd={};qd.COLLAPSED_FIELD_NAME=hl,qd.COLLAPSED_INPUT_NAME=ul,i.FieldLabel$$module$build$src$core$field_label=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.class_=null,this.EDITABLE=false,e!==pt.SKIP_SETUP&&(r?this.configure_(r):this.class_=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class_=e.class)}initView(){this.createTextElement_(),this.class_&&ne(this.getTextElement(),this.class_)}doClassValidation_(e){return e==null?null:String(e)}setClass(e){this.textElement_&&(this.class_&&de(this.textElement_,this.class_),e&&ne(this.textElement_,e)),this.class_=e}static fromJson(e){return new this(Qt(e.text),void 0,e)}},xi("field_label",i.FieldLabel$$module$build$src$core$field_label),i.FieldLabel$$module$build$src$core$field_label.prototype.DEFAULT_VALUE="",i.FieldLabel$$module$build$src$core$field_label;var Yo=class{constructor(e,t,r,a){if(this.type=e,this.name=t,this.connection=a,this.fieldRow=[],this.align=i.Align$$module$build$src$core$input.LEFT,this.visible=true,e!==rt.DUMMY&&!t)throw Error("Value inputs and statement inputs must have non-empty name.");this.sourceBlock=r}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,r){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||t===""&&r)&&(typeof t=="string"&&(t=Hh({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.rendered&&(t.init(),t.applyColour()),t.name=r,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&(this.sourceBlock.render(),this.sourceBlock.bumpNeighbours())),e}removeField(e,t){for(let r=0,a;a=this.fieldRow[r];r++)if(a.name===e)return a.dispose(),this.fieldRow.splice(r,1),this.sourceBlock.rendered&&(this.sourceBlock.render(),this.sourceBlock.bumpNeighbours()),true;if(t)return false;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let a=0,h;h=this.fieldRow[a];a++)h.setVisible(e);if(this.connection){var r=this.connection;e?t=r.startTrackingAll():r.stopTrackingAll(),(r=r.targetBlock())&&(r.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e=0,t;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.render(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init()}dispose(){for(let e=0,t;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}},Jd;(function(e){e=e.Align||(e.Align={}),e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(Yo||(Yo={})),i.Align$$module$build$src$core$input=Yo.Align,Jd={},Jd.Align=i.Align$$module$build$src$core$input,Jd.Input=Yo;var ge=class{constructor(e,t,r){if(this.wsCoordinate_=null,!t)throw Error("Cannot create a node without a location.");this.type_=e,this.isConnection_=ge.isConnectionType_(e),this.location_=t,this.processParams_(r||null)}processParams_(e){e&&e.wsCoordinate&&(this.wsCoordinate_=e.wsCoordinate)}getLocation(){return this.location_}getType(){return this.type_}getWsCoordinate(){return this.wsCoordinate_}isConnection(){return this.isConnection_}findNextForInput_(){var e=this.location_.getParentInput();const t=e.getSourceBlock();for(e=t.inputList.indexOf(e),e+=1;e<t.inputList.length;e++){const r=t.inputList[e],a=r.fieldRow;for(let h=0;h<a.length;h++){const C=a[h];if(C.isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(C)}if(r.connection)return ge.createInputNode(r)}return null}findNextForField_(){var e=this.location_,t=e.getParentInput();const r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var a=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)+1;a<r.inputList.length;a++){t=r.inputList[a];const h=t.fieldRow;for(;e<h.length;){if(h[e].isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(h[e]);e++}if(e=0,t.connection)return ge.createInputNode(t)}return null}findPrevForInput_(){const e=this.location_.getParentInput(),t=e.getSourceBlock();for(var r=t.inputList.indexOf(e);0<=r;r--){var a=t.inputList[r];if(a.connection&&a!==e)return ge.createInputNode(a);a=a.fieldRow;for(let h=a.length-1;0<=h;h--){const C=a[h];if(C.isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(C)}}return null}findPrevForField_(){var e=this.location_;const t=e.getParentInput(),r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var a=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)-1;0<=a;a--){var h=r.inputList[a];if(h.connection&&h!==t)return ge.createInputNode(h);for(h=h.fieldRow;-1<e;){if(h[e].isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(h[e]);e--}0<=a-1&&(e=r.inputList[a-1].fieldRow.length-1)}return null}navigateBetweenStacks_(e){var t=this.getLocation();if(t.getSourceBlock){var r=t.getSourceBlock();r&&(t=r)}if(!t||t.isDeadOrDying())return null;r=t.getRootBlock(),t=r.workspace.getTopBlocks(true);for(let a=0;a<t.length;a++)if(r.id===t[a].id)return e=a+(e?1:-1),e===-1||e===t.length?null:ge.createStackNode(t[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")}findTopASTNodeForBlock_(e){const t=Lc(e);return t?ge.createConnectionNode(t):ge.createBlockNode(e)}getOutAstNodeForBlock_(e){if(!e)return null;e=e.getTopStackBlock();const t=Lc(e);return t&&t.targetConnection&&t.targetConnection.getParentInput()?ge.createInputNode(t.targetConnection.getParentInput()):ge.createStackNode(e)}findFirstFieldOrInput_(e){e=e.inputList;for(let t=0;t<e.length;t++){const r=e[t],a=r.fieldRow;for(let h=0;h<a.length;h++){const C=a[h];if(C.isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(C)}if(r.connection)return ge.createInputNode(r)}return null}getSourceBlock(){return this.getType()===ge.types.BLOCK?this.getLocation():this.getType()===ge.types.STACK?this.getLocation():this.getType()===ge.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type_){case ge.types.STACK:return this.navigateBetweenStacks_(true);case ge.types.OUTPUT:return ge.createBlockNode(this.location_.getSourceBlock());case ge.types.FIELD:return this.findNextForField_();case ge.types.INPUT:return this.findNextForInput_();case ge.types.BLOCK:return ge.createConnectionNode(this.location_.nextConnection);case ge.types.PREVIOUS:return ge.createBlockNode(this.location_.getSourceBlock());case ge.types.NEXT:return ge.createConnectionNode(this.location_.targetConnection)}return null}in(){switch(this.type_){case ge.types.WORKSPACE:const e=this.location_.getTopBlocks(true);if(0<e.length)return ge.createStackNode(e[0]);break;case ge.types.STACK:return this.findTopASTNodeForBlock_(this.location_);case ge.types.BLOCK:return this.findFirstFieldOrInput_(this.location_);case ge.types.INPUT:return ge.createConnectionNode(this.location_.targetConnection)}return null}prev(){switch(this.type_){case ge.types.STACK:return this.navigateBetweenStacks_(false);case ge.types.FIELD:return this.findPrevForField_();case ge.types.INPUT:return this.findPrevForInput_();case ge.types.BLOCK:var e=Lc(this.location_);return ge.createConnectionNode(e);case ge.types.PREVIOUS:if((e=this.location_.targetConnection)&&!e.getParentInput())return ge.createConnectionNode(e);break;case ge.types.NEXT:return ge.createBlockNode(this.location_.getSourceBlock())}return null}out(){switch(this.type_){case ge.types.STACK:var e=this.location_,t=e.getRelativeToSurfaceXY();return t=new Oe(t.x,t.y+ge.DEFAULT_OFFSET_Y),ge.createWorkspaceNode(e.workspace,t);case ge.types.OUTPUT:return e=this.location_,(t=e.targetConnection)?ge.createConnectionNode(t):ge.createStackNode(e.getSourceBlock());case ge.types.FIELD:if(e=this.location_.getSourceBlock(),!e)throw Error("The current AST location is not associated with a block");return ge.createBlockNode(e);case ge.types.INPUT:return ge.createBlockNode(this.location_.getSourceBlock());case ge.types.BLOCK:return this.getOutAstNodeForBlock_(this.location_);case ge.types.PREVIOUS:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock());case ge.types.NEXT:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock())}return null}static isConnectionType_(e){switch(e){case ge.types.PREVIOUS:case ge.types.NEXT:case ge.types.INPUT:case ge.types.OUTPUT:return true}return false}static createFieldNode(e){return e?new ge(ge.types.FIELD,e):null}static createConnectionNode(e){if(!e)return null;const t=e.type;return t===Le.INPUT_VALUE||t===Le.NEXT_STATEMENT&&e.getParentInput()?ge.createInputNode(e.getParentInput()):t===Le.NEXT_STATEMENT?new ge(ge.types.NEXT,e):t===Le.OUTPUT_VALUE?new ge(ge.types.OUTPUT,e):t===Le.PREVIOUS_STATEMENT?new ge(ge.types.PREVIOUS,e):null}static createInputNode(e){return e&&e.connection?new ge(ge.types.INPUT,e.connection):null}static createBlockNode(e){return e?new ge(ge.types.BLOCK,e):null}static createStackNode(e){return e?new ge(ge.types.STACK,e):null}static createWorkspaceNode(e,t){return t&&e?new ge(ge.types.WORKSPACE,e,{wsCoordinate:t}):null}static createTopNode(e){const t=Lc(e);return t?ge.createConnectionNode(t):ge.createBlockNode(e)}};ge.NAVIGATE_ALL_FIELDS=false,ge.DEFAULT_OFFSET_Y=-20,function(e){e=e.types||(e.types={}),e.FIELD="field",e.BLOCK="block",e.INPUT="input",e.OUTPUT="output",e.NEXT="next",e.PREVIOUS="previous",e.STACK="stack",e.WORKSPACE="workspace"}(ge||(ge={}));var qo=class{constructor(e,t,r){if(this.data=null,this.disposed=false,this.hue_=null,this.colour_="#000000",this.styleName_="",this.loadExtraState=this.saveExtraState=this.domToMutation=this.mutationToDom=this.destroy=this.init=void 0,this.suppressPrefixSuffix=false,this.decompose=this.compose=this.getDeveloperVariables=void 0,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=false,this.tooltip="",this.contextMenu=true,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=true,this.collapsed_=this.isShadow_=false,this.outputShape_=null,this.disposing=false,this.comment=null,this.isInsertionMarker_=false,this.hat=void 0,this.onchangeWrapper_=this.helpUrl=this.rendered=null,this.statementInputCount=0,this.workspace=e,this.id=r&&!e.getBlockById(r)?r:pi(),e.setBlockById(this.id,this),this.commentModel={text:null,pinned:false,size:new $s(160,80)},this.xy_=new Oe(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,r=ri[t],!r||typeof r!="object")throw TypeError("Invalid block definition for type: "+t);Object.assign(this,r)}e.addTopBlock(this),e.addTypedBlock(this),new.target===qo&&this.doInit_()}doInit_(){const e=Ft();e||We(true);const t=Us();try{typeof this.init=="function"&&(Ps(false),this.init(),Ps(t)),ls()&&Pe(new(Te(ws))(this))}finally{e||We(false),Ps(t)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(e){if(!this.isDeadOrDying()){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(e),ls()&&Pe(new(Te(En))(this)),Jt();try{this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=true;for(let r=this.childBlocks_.length-1;0<=r;r--)this.childBlocks_[r].dispose(false);for(let r=0,a;a=this.inputList[r];r++)a.dispose();this.inputList.length=0;const t=this.getConnections_(true);for(let r=0,a;a=t[r];r++)a.dispose()}finally{Zt(),typeof this.destroy=="function"&&this.destroy(),this.disposed=true}}}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(let e=0,t;t=this.inputList[e];e++)for(let r=0,a;a=t.fieldRow[r];r++)a.initModel&&a.initModel()}unplug(e){this.outputConnection&&this.unplugFromRow_(e),this.previousConnection&&this.unplugFromStack_(e)}unplugFromRow_(e){let t=null;this.outputConnection.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&e&&(e=this.getOnlyValueConnection_())&&e.isConnected()&&!e.targetBlock().isShadow()&&(e=e.targetConnection,e==null||e.disconnect(),this.workspace.connectionChecker.canConnect(e,t,false)?t.connect(e):e==null||e.onFailedConnect(t))}getOnlyValueConnection_(){let e=null;for(let t=0;t<this.inputList.length;t++){const r=this.inputList[t].connection;if(r&&r.type===Le.INPUT_VALUE&&r.targetConnection){if(e)return null;e=r}}return e}unplugFromStack_(e){let t=null;this.previousConnection.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect());const r=this.getNextBlock();e&&r&&!r.isShadow()&&(e=this.nextConnection.targetConnection,e==null||e.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,false)&&t.connect(e))}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t=0,r;r=this.inputList[t];t++)r.connection&&e.push(r.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const r=t.targetBlock();if(!r||e&&r.isShadow())return t;t=r.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t=0,r;r=this.inputList[t];t++)if(r.connection&&r.connection.targetBlock()===e)return r;return null}getSurroundParent(){let e=this,t;do if(t=e,e=e.getParent(),!e)return null;while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getFirstStatementConnection(){for(let e=0,t;t=this.inputList[e];e++)if(t.connection&&t.connection.type===Le.NEXT_STATEMENT)return t.connection;return null}getRootBlock(){let e,t=this;do e=t,t=e.parentBlock_;while(t);return e}getTopStackBlock(){let e=this,t;do t=e.getPreviousBlock();while(t&&t.getNextBlock()===e&&(e=t));return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let r=0,a;a=this.inputList[r];r++)if(a.connection){var t=a.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),r=!!t;if(r&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!r&&e)throw Error("Block not connected to new parent.");if(r&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?ii(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],r=this.getChildren(e);for(let a,h=0;a=r[h];h++)t.push(...a.getDescendants(e));return t}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setDeletable(e){this.deletable_=e}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setMovable(e){this.movable_=e}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(K(this,true)):true}isShadow(){return this.isShadow_}setShadow(e){this.isShadow_=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setEditable(e){this.editable_=e;for(let t=0,r;r=this.inputList[t];t++)for(let a=0,h;h=r.fieldRow[a];a++)h.updateEditable()}isDisposed(){return this.disposed}getMatchingConnection(e,t){const r=this.getConnections_(true);if(e=e.getConnections_(true),r.length!==e.length)throw Error("Connection lists did not match in length.");for(let a=0;a<e.length;a++)if(e[a]===t)return r[a];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return xa(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(e){e=ko(e),this.hue_=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&typeof e!="function")throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=e,this.onchangeWrapper_=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(e){if(typeof e!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(e===void 0?"nothing":e+" of type "+typeof e)+" instead");for(let t=0,r;r=this.inputList[t];t++)for(let a=0,h;h=r.fieldRow[a];a++)if(h.name===e)return h;return null}getVars(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let a=0,h;h=r.fieldRow[a];a++)h.referencesVariables()&&e.push(h.getValue());return e}getVarModels(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let a=0,h;h=r.fieldRow[a];a++)if(h.referencesVariables()){const C=this.workspace.getVariableById(h.getValue());C&&e.push(C)}return e}updateVarName(e){for(let t=0,r;r=this.inputList[t];t++)for(let a=0,h;h=r.fieldRow[a];a++)h.referencesVariables()&&e.getId()===h.getValue()&&h.refreshVariableName()}renameVarById(e,t){for(let r=0,a;a=this.inputList[r];r++)for(let h=0,C;C=a.fieldRow[h];h++)C.referencesVariables()&&e===C.getValue()&&C.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const r=this.getField(t);if(!r)throw Error('Field "'+t+'" not found.');r.setValue(e)}setPreviousStatement(e,t){if(e)t===void 0&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Le.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)t===void 0&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Le.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)t===void 0&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Le.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(Pe(new(Te(Ts))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type===rt.DUMMY&&this.inputList[e].type===rt.DUMMY)return false;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type===rt.VALUE&&this.inputList[e].type===rt.DUMMY)return true;return false}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(e){if(this.isEnabled()!==e){const t=this.disabled;this.disabled=!e,Pe(new(Te(Ts))(this,"disabled",null,t,!e))}}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(e.disabled)return true;e=e.getSurroundParent()}return false}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(Pe(new(Te(Ts))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){function r(ke){let ft=ke.getCheck();return!ft&&ke.targetConnection&&(ft=ke.targetConnection.getCheck()),!!ft&&(ft.indexOf("Boolean")!==-1||ft.indexOf("Number")!==-1)}function a(){let ke,ft;D&&D.getType()===((ke=Y)==null?void 0:ke.getType())&&D.getLocation()===((ft=Y)==null?void 0:ft.getLocation())&&(D=null)}var h=[];t=t||"?";const C=ge.NAVIGATE_ALL_FIELDS;ge.NAVIGATE_ALL_FIELDS=true;let D=ge.createBlockNode(this);const Y=D;for(;D;){switch(D.getType()){case ge.types.INPUT:var pe=D.getLocation();D.in()?r(pe)&&h.push("("):h.push(t);break;case ge.types.FIELD:pe=D.getLocation(),pe.name!==hl&&h.push(pe.getText())}if(pe=D,D=pe.in()||pe.next(),!D){for(D=pe.out(),a();D&&!D.next();)D=D.out(),a(),D&&D.getType()===ge.types.INPUT&&r(D.getLocation())&&h.push(")");D&&(D=D.next())}}for(ge.NAVIGATE_ALL_FIELDS=C,t=2;t<h.length;t++)h[t-2]==="("&&h[t]===")"&&(h[t-2]=h[t-1],h.splice(t-1,2));return h=h.reduce(function(ke,ft){return ke+(ke.substr(-1)==="("||ft===")"?"":" ")+ft},""),h=h.trim()||"???",e&&h.length>e&&(h=h.substring(0,e-3)+"..."),h}appendValueInput(e){return this.appendInput_(rt.VALUE,e)}appendStatementInput(e){return this.appendInput_(rt.STATEMENT,e)}appendDummyInput(e){return this.appendInput_(rt.DUMMY,e||"")}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");e.style?this.jsonInitStyle_(e,t):this.jsonInitColour_(e,t);for(var r=0;e["message"+r]!==void 0;)this.interpolate_(e["message"+r],e["args"+r]||[],e["lastDummyAlign"+r],t),r++;if(e.inputsInline!==void 0&&this.setInputsInline(e.inputsInline),e.output!==void 0&&this.setOutput(true,e.output),e.outputShape!==void 0&&this.setOutputShape(e.outputShape),e.previousStatement!==void 0&&this.setPreviousStatement(true,e.previousStatement),e.nextStatement!==void 0&&this.setNextStatement(true,e.nextStatement),e.tooltip!==void 0&&(r=Qt(e.tooltip),this.setTooltip(r)),e.enableContextMenu!==void 0&&(this.contextMenu=!!e.enableContextMenu),e.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),e.helpUrl!==void 0&&(r=Qt(e.helpUrl),this.setHelpUrl(r)),typeof e.extensions=="string"&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),e.mutator!==void 0&&jh(e.mutator,this,true),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)jh(e[t],this,false)}jsonInitColour_(e,t){if("colour"in e)if(e.colour===void 0)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch{console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle_(e,t){e=e.style;try{this.setStyle(e)}catch{console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(t!==void 0&&typeof t!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const r in e)this[r]!==void 0&&t.push(r);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate_(e,t,r,a){e=Uh(e),this.validateTokens_(e,t.length),t=this.interpolateArguments_(e,t,r),r=[];for(let h=0,C;C=t[h];h++)if(this.isInputKeyword_(C.type)){if(e=this.inputFromJson_(C,a)){for(let D=0,Y;Y=r[D];D++)e.appendField(Y[0],Y[1]);r.length=0}}else(e=this.fieldFromJson_(C))&&r.push([e,C.name])}validateTokens_(e,t){const r=[];let a=0;for(let h=0;h<e.length;h++){const C=e[h];if(typeof C=="number"){if(1>C||C>t)throw Error('Block "'+this.type+'": Message index %'+C+" out of range.");if(r[C])throw Error('Block "'+this.type+'": Message index %'+C+" duplicated.");r[C]=true,a++}}if(a!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments_(e,t,r){const a=[];for(let h=0;h<e.length;h++){let C=e[h];typeof C=="number"&&(C=t[C-1]),!(typeof C=="string"&&(C=this.stringToFieldJson_(C),!C))&&a.push(C)}return(e=a.length)&&!this.isInputKeyword_(a[e-1].type)&&(e={type:"input_dummy"},r&&(e.align=r),a.push(e)),a}fieldFromJson_(e){const t=Hh(e);return!t&&e.alt?typeof e.alt=="string"?(e=this.stringToFieldJson_(e.alt))?this.fieldFromJson_(e):null:this.fieldFromJson_(e.alt):t}inputFromJson_(e,t){var r={LEFT:i.Align$$module$build$src$core$input.LEFT,RIGHT:i.Align$$module$build$src$core$input.RIGHT,CENTRE:i.Align$$module$build$src$core$input.CENTRE,CENTER:i.Align$$module$build$src$core$input.CENTRE};let a=null;switch(e.type){case"input_value":a=this.appendValueInput(e.name);break;case"input_statement":a=this.appendStatementInput(e.name);break;case"input_dummy":a=this.appendDummyInput(e.name)}return a?(e.check&&a.setCheck(e.check),e.align&&(r=r[e.align.toUpperCase()],r===void 0?console.warn(t+"Illegal align value: ",e.align):a.setAlign(r)),a):null}isInputKeyword_(e){return e==="input_value"||e==="input_statement"||e==="input_dummy"}stringToFieldJson_(e){return(e=e.trim())?{type:"field_label",text:e}:null}appendInput_(e,t){let r=null;return(e===rt.VALUE||e===rt.STATEMENT)&&(r=this.makeConnection_(e)),e===rt.STATEMENT&&this.statementInputCount++,e=new Yo(e,t,this,r),this.inputList.push(e),e}moveInputBefore(e,t){if(e!==t){var r=-1,a=t?-1:this.inputList.length;for(let h=0,C;C=this.inputList[h];h++)if(C.name===e){if(r=h,a!==-1)break}else if(t&&C.name===t&&(a=h,r!==-1))break;if(r===-1)throw Error('Named input "'+e+'" not found.');if(a===-1)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(r,a)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const r=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,r)}removeInput(e,t){for(let r=0,a;a=this.inputList[r];r++)if(a.name===e)return a.type===rt.STATEMENT&&this.statementInputCount--,a.dispose(),this.inputList.splice(r,1),true;if(t)return false;throw Error("Input not found: "+e)}getInput(e){for(let t=0,r;r=this.inputList[t];t++)if(r.name===e)return r;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){return this.commentModel.text}setCommentText(e){this.commentModel.text!==e&&(Pe(new(Te(Ts))(this,"comment",null,this.commentModel.text,e)),this.comment=this.commentModel.text=e)}setWarningText(e,t){}setMutator(e){}getRelativeToSurfaceXY(){return this.xy_}moveBy(e,t){if(this.parentBlock_)throw Error("Block has parent.");const r=new(Te(Xs))(this);this.xy_.translate(e,t),r.recordNew(),Pe(r)}makeConnection_(e){return new St(this,e)}allInputsFilled(e){if(e===void 0&&(e=true),!e&&this.isShadow())return false;for(let r=0,a;a=this.inputList[r];r++)if(a.connection){var t=a.connection.targetBlock();if(!t||!t.allInputsFilled(e))return false}return(t=this.getNextBlock())?t.allInputsFilled(e):true}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};qo.COLLAPSED_INPUT_NAME=ul,qo.COLLAPSED_FIELD_NAME=hl;var pu=null,dl=null,_l={};_l.connectionUiEffect=aE,_l.disconnectUiEffect=cE,_l.disconnectUiStop=Pa,_l.disposeUiEffect=rE;var Vv=class extends hu{constructor(e){super(e),this.cachedText="",this.paragraphElement_=this.textarea_=this.foreignObject=this.onInputWrapper=this.onChangeWrapper=this.onWheelWrapper=this.onMouseUpWrapper=null,this.model=e.commentModel;let t;this.model.text=(t=this.model.text)!=null?t:"",this.createIcon()}drawIcon_(e){H(Q.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},e),H(Q.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},e),H(Q.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},e)}createEditor(){this.foreignObject=H(Q.FOREIGNOBJECT,{x:it.BORDER_WIDTH,y:it.BORDER_WIDTH});const e=document.createElementNS(Yi,"body");e.setAttribute("xmlns",Yi),e.className="blocklyMinimalBody";const t=this.textarea_=document.createElementNS(Yi,"textarea");t.className="blocklyCommentTextarea",t.setAttribute("dir",this.getBlock().RTL?"RTL":"LTR");let r;return t.value=(r=this.model.text)!=null?r:"",this.resizeTextarea(),e.appendChild(t),this.foreignObject.appendChild(e),this.onMouseUpWrapper=E(t,"focus",this,this.startEdit,true),this.onWheelWrapper=E(t,"wheel",this,function(a){a.stopPropagation()}),this.onChangeWrapper=E(t,"change",this,function(a){this.cachedText!==this.model.text&&Pe(new(Te(Ts))(this.getBlock(),"comment",null,this.cachedText,this.model.text))}),this.onInputWrapper=E(t,"input",this,function(a){this.model.text=t.value}),setTimeout(t.focus.bind(t),0),this.foreignObject}updateEditable(){super.updateEditable(),this.isVisible()&&(this.disposeBubble(),this.createBubble())}onBubbleResize(){this.isVisible()&&this.bubble_&&(this.model.size=this.bubble_.getBubbleSize(),this.resizeTextarea())}resizeTextarea(){if(this.textarea_&&this.foreignObject){var e=this.model.size,t=2*it.BORDER_WIDTH,r=e.width-t;e=e.height-t,this.foreignObject.setAttribute("width",`${r}`),this.foreignObject.setAttribute("height",`${e}`),this.textarea_.style.width=r-4+"px",this.textarea_.style.height=e-4+"px"}}setVisible(e){e!==this.isVisible()&&(Pe(new(Te(Pn))(this.getBlock(),e,"comment")),(this.model.pinned=e)?this.createBubble():this.disposeBubble())}createBubble(){this.getBlock().isEditable()?this.createEditableBubble():this.createNonEditableBubble()}createEditableBubble(){const e=this.getBlock();this.bubble_=new it(e.workspace,this.createEditor(),e.pathObject.svgPath,this.iconXY_,this.model.size.width,this.model.size.height),this.bubble_.setSvgId(e.id),this.bubble_.registerResizeEvent(this.onBubbleResize.bind(this)),this.applyColour()}createNonEditableBubble(){let e;this.paragraphElement_=it.textToDom((e=this.model.text)!=null?e:""),this.bubble_=it.createNonEditableBubble(this.paragraphElement_,this.getBlock(),this.iconXY_),this.applyColour()}disposeBubble(){this.onMouseUpWrapper&&(f(this.onMouseUpWrapper),this.onMouseUpWrapper=null),this.onWheelWrapper&&(f(this.onWheelWrapper),this.onWheelWrapper=null),this.onChangeWrapper&&(f(this.onChangeWrapper),this.onChangeWrapper=null),this.onInputWrapper&&(f(this.onInputWrapper),this.onInputWrapper=null),this.bubble_&&(this.bubble_.dispose(),this.bubble_=null),this.paragraphElement_=this.foreignObject=this.textarea_=null}startEdit(e){let t;(t=this.bubble_)!=null&&t.promote()&&this.textarea_.focus(),this.cachedText=this.model.text}getBubbleSize(){return this.model.size}setBubbleSize(e,t){this.bubble_?this.bubble_.setBubbleSize(e,t):(this.model.size.width=e,this.model.size.height=t)}updateText(){if(this.textarea_){let e;this.textarea_.value=(e=this.model.text)!=null?e:""}else this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model.text)}dispose(){this.getBlock().comment=null,super.dispose()}};hs(`
.blocklyCommentTextarea {
  background-color: #fef49c;
  border: 0;
  display: block;
  margin: 0;
  outline: 0;
  padding: 3px;
  resize: none;
  text-overflow: hidden;
}
`);var Hn=null,Zd={duplicateInternal:SC,copyInternal:TC},pl={};pl.TEST_ONLY=Zd,pl.copy=Ua,pl.duplicate=Nc,pl.paste=Jh;var gl,Qd,fl;gl=null,Qd={},fl=null,i.module$build$src$core$contextmenu={},i.module$build$src$core$contextmenu.callbackFactory=CC,i.module$build$src$core$contextmenu.commentDeleteOption=pE,i.module$build$src$core$contextmenu.commentDuplicateOption=gE,i.module$build$src$core$contextmenu.dispose=_E,i.module$build$src$core$contextmenu.getCurrentBlock=hE,i.module$build$src$core$contextmenu.hide=Dc,i.module$build$src$core$contextmenu.setCurrentBlock=dE,i.module$build$src$core$contextmenu.show=Mc,i.module$build$src$core$contextmenu.workspaceCommentOption=OC;var $t=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(e){if(this.registry_.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registry_.set(e.id,e)}unregister(e){if(!this.registry_.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registry_.delete(e)}getItem(e){let t;return(t=this.registry_.get(e))!=null?t:null}getContextMenuOptions(e,t){const r=[];for(const h of this.registry_.values())if(e===h.scopeType){var a=h.preconditionFn(t);a!=="hidden"&&(a={text:typeof h.displayText=="function"?h.displayText(t):h.displayText,enabled:a==="enabled",callback:h.callback,scope:t,weight:h.weight},r.push(a))}return r.sort(function(h,C){return h.weight-C.weight}),r}};(function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",e.registry=new e})($t||($t={})),$t.ScopeType;var Wv=30,zv=true,Yr=[];Yr[Le.INPUT_VALUE]=Le.OUTPUT_VALUE,Yr[Le.OUTPUT_VALUE]=Le.INPUT_VALUE,Yr[Le.NEXT_STATEMENT]=Le.PREVIOUS_STATEMENT,Yr[Le.PREVIOUS_STATEMENT]=Le.NEXT_STATEMENT;var e_="RENAME_VARIABLE_ID",t_="DELETE_VARIABLE_ID",jv=class{constructor(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"}setDrawer(e){this.drawer_=e}getDrawer(){return this.drawer_}getCurNode(){return this.curNode_}setCurNode(e){const t=this.curNode_;this.curNode_=e,this.drawer_&&this.drawer_.draw(t,this.curNode_)}draw(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)}hide(){this.drawer_&&this.drawer_.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},s_=class extends jv{constructor(){super(),this.type="cursor"}next(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()===ge.types.NEXT||e.getType()===ge.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e}in(){var e=this.getCurNode();if(!e)return null;(e.getType()===ge.types.PREVIOUS||e.getType()===ge.types.OUTPUT)&&(e=e.next());let t,r;return(e=(r=(t=e)==null?void 0:t.in())!=null?r:null)&&this.setCurNode(e),e}prev(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()===ge.types.NEXT||e.getType()===ge.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e}out(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()===ge.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null}};ye(Se.CURSOR,Bn,s_);var ml=class extends s_{constructor(){super()}next(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null}in(){return this.next()}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null}out(){return this.prev()}getNextNode_(e,t){if(!e)return null;const r=e.in()||e.next();return t(r)?r:r?this.getNextNode_(r,t):(e=this.findSiblingOrParent_(e.out()),t(e)?e:e?this.getNextNode_(e,t):null)}getPreviousNode_(e,t){if(!e)return null;let r=e.prev();return r=r?this.getRightMostChild_(r):e.out(),t(r)?r:r?this.getPreviousNode_(r,t):null}validNode_(e){let t=false;return e=e&&e.getType(),(e===ge.types.OUTPUT||e===ge.types.INPUT||e===ge.types.FIELD||e===ge.types.NEXT||e===ge.types.PREVIOUS||e===ge.types.WORKSPACE)&&(t=true),t}findSiblingOrParent_(e){if(!e)return null;const t=e.next();return t||this.findSiblingOrParent_(e.out())}getRightMostChild_(e){if(!e.in())return e;for(e=e.in();e&&e.next();)e=e.next();return this.getRightMostChild_(e)}};ml.registrationName="basicCursor",ye(Se.CURSOR,ml.registrationName,ml);var Xv=class extends ml{validNode_(e){let t=false;const r=e&&e.getType();return e&&(e=e.getLocation(),r===ge.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(t=true)),t}},i_=10,Ks=class extends St{constructor(e,t){super(e,t),this.targetConnection=this.highlightPath=null,this.db_=e.workspace.connectionDBList[t],this.dbOpposite_=e.workspace.connectionDBList[Yr[t]],this.offsetInBlock_=new Oe(0,0),this.trackedState_=Ks.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState_===Ks.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e){if(!this.sourceBlock_.workspace.isDragging()){var t=this.sourceBlock_.getRootBlock();if(!t.isInFlyout){var r=false;if(!t.isMovable()){if(t=e.getSourceBlock().getRootBlock(),!t.isMovable())return;e=this,r=true}var a=U()==t;a||t.addSelect();var h=e.x+i.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*i_)-this.x,C=e.y+i.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*i_)-this.y;r&&(C=-C),t.RTL&&(h=e.x-i.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*i_)-this.x),t.moveBy(h,C),a||t.removeSelect()}}}moveTo(e,t){this.trackedState_===Ks.TrackedState.WILL_TRACK?(this.db_.addConnection(this,t),this.trackedState_=Ks.TrackedState.TRACKED):this.trackedState_===Ks.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,t)),this.x=e,this.y=t}moveBy(e,t){this.moveTo(this.x+e,this.y+t)}moveToOffset(e){this.moveTo(e.x+this.offsetInBlock_.x,e.y+this.offsetInBlock_.y)}setOffsetInBlock(e,t){this.offsetInBlock_.x=e,this.offsetInBlock_.y=t}getOffsetInBlock(){return this.offsetInBlock_}tighten(){const e=this.targetConnection.x-this.x,t=this.targetConnection.y-this.y;if(e!==0||t!==0){const a=this.targetBlock();var r=a.getSvgRoot();if(!r)throw Error("block is not rendered.");r=mi(r),a.getSvgRoot().setAttribute("transform","translate("+(r.x-e)+","+(r.y-t)+")"),a.moveConnections(-e,-t)}}closest(e,t){return this.dbOpposite_.searchForClosest(this,e,t)}highlight(){if(!this.highlightPath){var e=this.sourceBlock_.workspace.getRenderer().getConstants(),t=e.shapeFor(this);this.type===Le.INPUT_VALUE||this.type===Le.OUTPUT_VALUE?(e=e.TAB_OFFSET_FROM_TOP,t=Wt(0,-e)+Ne("v",e)+t.pathDown+Ne("v",e)):(e=e.NOTCH_OFFSET_LEFT-e.CORNER_RADIUS,t=Wt(-e,0)+Ne("h",e)+t.pathLeft+Ne("h",e)),e=this.sourceBlock_.getRelativeToSurfaceXY(),this.highlightPath=H(Q.PATH,{class:"blocklyHighlightedConnectionPath",d:t,transform:"translate("+(this.x-e.x)+","+(this.y-e.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())}}unhighlight(){this.highlightPath&&(x(this.highlightPath),this.highlightPath=null)}setTracking(e){e&&this.trackedState_===Ks.TrackedState.TRACKED||!e&&this.trackedState_===Ks.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db_.addConnection(this,this.y),this.trackedState_=Ks.TrackedState.TRACKED):(this.trackedState_===Ks.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=Ks.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(false),this.targetConnection){const r=this.targetBlock().getDescendants(false);for(let a=0;a<r.length;a++){var e=r[a],t=e.getConnections_(true);for(let h=0;h<t.length;h++)t[h].setTracking(false);for(e=e.getIcons(),t=0;t<e.length;t++)e[t].setVisible(false)}}}startTrackingAll(){this.setTracking(true);let e=[];if(this.type!==Le.INPUT_VALUE&&this.type!==Le.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let r;t.isCollapsed()?(r=[],t.outputConnection&&r.push(t.outputConnection),t.nextConnection&&r.push(t.nextConnection),t.previousConnection&&r.push(t.previousConnection)):r=t.getConnections_(true);for(let a=0;a<r.length;a++)e.push(...r[a].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(Us()){const r=Ft();setTimeout(function(){t.isDisposed()||t.getParent()||(We(r),this.bumpAwayFrom(e),We(false))}.bind(this),i.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal_(e,t){super.disconnectInternal_(e,t),e.rendered&&e.render(),t.rendered&&(t.updateDisabled(),t.render(),t.getSvgRoot().style.display="block")}respawnShadow_(){super.respawnShadow_();var e=this.targetBlock();e&&(e.initSvg(),e.render(false),e=this.getSourceBlock(),e.rendered&&e.render())}neighbours(e){return this.dbOpposite_.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock();const r=t.rendered,a=e.rendered;r&&t.updateDisabled(),a&&e.updateDisabled(),r&&a&&(this.type===Le.NEXT_STATEMENT||this.type===Le.PREVIOUS_STATEMENT?e.render():t.render()),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,false)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}};(function(e){e=e.TrackedState||(e.TrackedState={}),e[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"})(Ks||(Ks={})),Ks.TrackedState;var Kv=class extends hu{constructor(e){super(e),this.paragraphElement=null,this.collapseHidden=false,this.createIcon(),this.text=Object.create(null)}drawIcon_(e){H(Q.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},e),H(Q.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},e),H(Q.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},e)}setVisible(e){e!==this.isVisible()&&(Pe(new(Te(Pn))(this.getBlock(),e,"warning")),e?this.createBubble():this.disposeBubble())}createBubble(){this.paragraphElement=it.textToDom(this.getText()),this.bubble_=it.createNonEditableBubble(this.paragraphElement,this.getBlock(),this.iconXY_),this.applyColour()}disposeBubble(){this.bubble_&&(this.bubble_.dispose(),this.bubble_=null),this.paragraphElement=null}setText(e,t){this.text[t]!==e&&(e?this.text[t]=e:delete this.text[t],this.isVisible()&&(this.setVisible(false),this.setVisible(true)))}getText(){const e=[];for(const t in this.text)e.push(this.text[t]);return e.join(`
`)}dispose(){this.getBlock().warning=null,super.dispose()}},Pi=class extends qo{constructor(e,t,r){super(e,t,r),this.renderingDebugger=null,this.width=this.height=0,this.warningTextDb=new Map,this.warning=this.commentIcon_=this.mutator=null,this.eventsInit_=this.renderIsInProgress_=this.rendered=false,this.workspace=e,this.decompose=this.decompose,this.compose=this.compose,this.saveConnections=this.saveConnections,this.customContextMenu=this.customContextMenu,this.svgGroup_=H(Q.G,{}),this.svgGroup_.translate_="",this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup_,this.style),this.useDragSurface_=!!e.getBlockDragSurface(),e=this.pathObject.svgPath,e.tooltip=this,yc(e),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(let t=0,r;r=this.inputList[t];t++)r.init();var e=this.getIcons();for(let t=0;t<e.length;t++)e[t].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||E(e,"pointerdown",this,this.onMouseDown_),this.eventsInit_=true,e.parentNode||this.workspace.getCanvas().appendChild(e)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(U()!==this){var e=null;if(U()){e=U().id,Jt();try{U().unselect()}finally{Zt()}}e=new(Te(lr))(e,this.id,this.workspace.id),Pe(e),P(this),this.addSelect()}}unselect(){if(U()===this){var e=new(Te(lr))(this.id,null,this.workspace.id);e.workspaceId=this.workspace.id,Pe(e),P(null),this.removeSelect()}}getIcons(){const e=[];return this.mutator&&e.push(this.mutator),this.commentIcon_&&e.push(this.commentIcon_),this.warning&&e.push(this.warning),e}setParent(e){const t=this.parentBlock_;if(e!==t){De(),super.setParent(e),$e();var r=this.getSvgRoot();if(!this.workspace.isClearing&&r){var a=this.getRelativeToSurfaceXY();e?(e.getSvgRoot().appendChild(r),e=this.getRelativeToSurfaceXY(),this.moveConnections(e.x-a.x,e.y-a.y)):t&&(this.workspace.getCanvas().appendChild(r),this.translate(a.x,a.y)),this.applyColour()}}}getRelativeToSurfaceXY(){let e=0,t=0;const r=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;let a=this.getSvgRoot();if(a)do{var h=mi(a);e+=h.x,t+=h.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===a&&(h=this.workspace.getBlockDragSurface().getSurfaceTranslation(),e+=h.x,t+=h.y),a=a.parentNode}while(a&&a!==this.workspace.getCanvas()&&a!==r);return new Oe(e,t)}moveBy(e,t){if(this.parentBlock_)throw Error("Block has parent.");const r=ls();let a=null;r&&(a=new(Te(Xs))(this));const h=this.getRelativeToSurfaceXY();this.translate(h.x+e,h.y+t),this.moveConnections(e,t),r&&a&&(a.recordNew(),Pe(a)),this.workspace.resizeContents()}translate(e,t){this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")}moveToDragSurface(){if(this.useDragSurface_){var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(e.x,e.y),(e=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(e)}}moveTo(e){const t=this.getRelativeToSurfaceXY();this.moveBy(e.x-t.x,e.y-t.y)}moveOffDragSurface(e){this.useDragSurface_&&(this.translate(e.x,e.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))}moveDuringDrag(e){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(e.x,e.y):(this.svgGroup_.translate_="translate("+e.x+","+e.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))}clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform")}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var e=this.workspace.getGrid();if(e&&e.shouldSnap()){var t=e.getSpacing(),r=t/2,a=this.getRelativeToSurfaceXY();e=Math.round(Math.round((a.x-r)/t)*t+r-a.x),t=Math.round(Math.round((a.y-r)/t)*t+r-a.y),(e||t)&&this.moveBy(e,t)}}}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY(),t=this.getHeightWidth();let r,a;return this.RTL?(r=e.x-t.width,a=e.x):(r=e.x,a=e.x+t.width),new es(e.y,e.y+t.height,r,a)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e=0,t;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),e?this.rendered&&this.render():this.updateCollapsed_())}updateCollapsed_(){var e=this.isCollapsed();const t=ul,r=hl;for(let h=0,C;C=this.inputList[h];h++)C.name!==t&&C.setVisible(!e);if(e){e=this.getIcons();for(let h=0,C;C=e[h];h++)C.setVisible(false);e=this.toString(Wv);var a=this.getField(r);a?a.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new i.FieldLabel$$module$build$src$core$field_label(e),r)}else this.updateDisabled(),this.removeInput(t)}tab(e,t){const r=new Xv;r.setCurNode(ge.createFieldNode(e)),e=r.getCurNode(),t?r.next():r.prev(),(t=r.getCurNode())&&t!==e&&(t.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(t))}onMouseDown_(e){const t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}showHelp(){const e=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const e=$t.registry.getContextMenuOptions($t.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e}showContextMenu(e){const t=this.generateContextMenu();t&&t.length&&(Mc(e,t,this.RTL),dE(this))}moveConnections(e,t){if(this.rendered){for(var r=this.getConnections_(false),a=0;a<r.length;a++)r[a].moveBy(e,t);for(r=this.getIcons(),a=0;a<r.length;a++)r[a].computeIconLocation();for(r=0;r<this.childBlocks_.length;r++)this.childBlocks_[r].moveConnections(e,t)}}setDragging(e){if(e){var t=this.getSvgRoot();t.translate_="",t.skew_="",Ur.push(...this.getConnections_(true)),ne(this.svgGroup_,"blocklyDragging")}else Ur.length=0,de(this.svgGroup_,"blocklyDragging");for(t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(true))}getSvgRoot(){return this.svgGroup_}dispose(e,t){if(!this.isDeadOrDying()){Gm(),Rc(this.pathObject.svgPath),De();var r=this.workspace;U()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),hE()===this&&Dc(),t&&this.rendered&&(this.unplug(e),rE(this)),this.rendered=false;for(var a of this.warningTextDb.values())clearTimeout(a);for(this.warningTextDb.clear(),t=this.getIcons(),a=0;a<t.length;a++)t[a].dispose();U()===this&&P(null),super.dispose(!!e),x(this.svgGroup_),r.resizeContents(),this.svgGroup_=null,$e()}}checkAndDelete(){this.workspace.isFlyout||(We(true),this.workspace.hideChaff(),this.outputConnection?this.dispose(false,true):this.dispose(true,true),We(false))}toCopyData(){return this.isInsertionMarker_?null:{saveInfo:Mn(this,{addCoordinates:true,addNextBlocks:false}),source:this.workspace,typeCounts:K(this,true)}}applyColour(){this.pathObject.applyColour(this);const e=this.getIcons();for(let t=0;t<e.length;t++)e[t].applyColour();for(let t=0,r;r=this.inputList[t];t++)for(let a=0,h;h=r.fieldRow[a];a++)h.applyColour()}updateDisabled(){const e=this.getChildren(false);if(this.applyColour(),!this.isCollapsed())for(let t=0,r;r=e[t];t++)r.rendered&&r.updateDisabled()}getCommentIcon(){return this.commentIcon_}setCommentText(e){this.commentModel.text!==e&&(super.setCommentText(e),e=e!==null,!!this.commentIcon_===e?this.commentIcon_.updateText():(e?this.comment=this.commentIcon_=new Vv(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))}setWarningText(e,t){const r=t||"";if(r)this.warningTextDb.has(r)&&(clearTimeout(this.warningTextDb.get(r)),this.warningTextDb.delete(r));else{for(var a of this.warningTextDb.values())clearTimeout(a);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(r,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(r),this.setWarningText(e,r))},100));else{if(this.isInFlyout&&(e=null),t=false,typeof e=="string"){a=this.getSurroundParent();let h=null;for(;a;)a.isCollapsed()&&(h=a),a=a.getSurroundParent();h&&h.setWarningText(Ye.COLLAPSED_WARNINGS_WARNING,Pi.COLLAPSED_WARNING_ID),this.warning||(this.warning=new Kv(this),t=true),this.warning.setText(e,r)}else this.warning&&!r?(this.warning.dispose(),t=true):this.warning&&(t=this.warning.getText(),this.warning.setText("",r),(a=this.warning.getText())||this.warning.dispose(),t=t!==a);t&&this.rendered&&(this.render(),this.bumpNeighbours())}}setMutator(e){this.mutator&&this.mutator!==e&&this.mutator.dispose(),e&&(e.setBlock(this),this.mutator=e,e.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())}setEnabled(e){this.isEnabled()!==e&&(super.setEnabled(e),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(e){this.rendered&&this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(true)}removeSelect(){this.pathObject.updateSelected(false)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,t)this.hat=t.hat,this.pathObject.setStyle(t),this.colour_=t.colourPrimary,this.style=t,this.applyColour();else throw Error("Invalid style name: "+e)}bringToFront(){let e=this;do{const t=e.getSvgRoot(),r=t.parentNode,a=r.childNodes;a[a.length-1]!==t&&r.appendChild(t),e=e.getParent()}while(e)}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}setNextStatement(e,t){super.setNextStatement(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}setOutput(e,t){super.setOutput(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}setInputsInline(e){super.setInputsInline(e),this.rendered&&(this.render(),this.bumpNeighbours())}removeInput(e,t){return e=super.removeInput(e,t),this.rendered&&(this.render(),this.bumpNeighbours()),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}appendInput_(e,t){return e=super.appendInput_(e,t),this.rendered&&(this.render(),this.bumpNeighbours()),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var r=this.inputList[t].connection;r&&(r.setTracking(e),(r=r.targetBlock())&&r.setConnectionTracking(e))}}getConnections_(e){const t=[];if((e||this.rendered)&&(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_))for(let r=0,a;a=this.inputList[r];r++)a.connection&&t.push(a.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Ks(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){this.getRootBlock().bumpNeighboursInternal()}bumpNeighboursInternal(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(false)){if(t.isSuperior()){let r;(r=t.targetBlock())==null||r.bumpNeighboursInternal()}for(const r of t.neighbours(i.config$$module$build$src$core$config.snapRadius))r.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&r.isConnected()||(t.isSuperior()?r.bumpAwayFrom(t):t.bumpAwayFrom(r)))}}scheduleSnapAndBump(){const e=Ft();setTimeout(()=>{We(e),this.snapToGrid(),We(false)},i.config$$module$build$src$core$config.bumpDelay/2),setTimeout(()=>{We(e),this.bumpNeighbours(),We(false)},i.config$$module$build$src$core$config.bumpDelay)}positionNearConnection(e,t){e.type!==Le.NEXT_STATEMENT&&e.type!==Le.INPUT_VALUE||this.moveBy(t.x-e.x,t.y-e.y)}getFirstStatementConnection(){return super.getFirstStatementConnection()}getChildren(e){return super.getChildren(e)}render(e){if(!this.renderIsInProgress_){this.renderIsInProgress_=true;try{if(this.rendered=true,De(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),e!==false){const t=this.getParent();t?t.render(true):this.workspace.resizeContents()}$e(),this.updateMarkers_()}finally{this.renderIsInProgress_=false}}}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(Qa.LOCAL_MARKER).draw()}updateConnectionLocations_(){const e=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(e),this.outputConnection&&this.outputConnection.moveToOffset(e);for(let t=0;t<this.inputList.length;t++){const r=this.inputList[t].connection;r&&(r.moveToOffset(e),r.isConnected()&&r.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(e),this.nextConnection.isConnected()&&this.nextConnection.tighten())}setCursorSvg(e){this.pathObject.setCursorSvg(e)}setMarkerSvg(e){this.pathObject.setMarkerSvg(e)}getHeightWidth(){let e=this.height,t=this.width;var r=this.getNextBlock();if(r){r=r.getHeightWidth();const a=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=r.height-a,t=Math.max(t,r.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}};Pi.INLINE=-1,Pi.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Yv=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return false}},gu=class extends Yv{constructor(){super(),this.wouldDelete_=false}wouldDelete(e,t){return e instanceof Pi?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e&&!t)):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},Vn;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"})(Vn||(Vn={}));var Jo;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(Jo||(Jo={}));var dr;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"})(dr||(dr={}));var qr={};qr.bumpDirection=dr,qr.bumpPositionRect=ed,qr.getCornerOppositeToolbox=Qh,qr.getStartPositionRect=Zh,qr.horizontalPosition=Jo,qr.verticalPosition=Vn;var Ys={width:96,height:124,url:"sprites.png"},qv=class extends gu{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents_=[],this.flyout=null,this.isLidOpen=false,this.minOpenness_=0,this.lidTask_=this.svgLid_=this.svgGroup_=null,this.top_=this.left_=this.lidOpen_=0,this.initialized_=false,0>=this.workspace.options.maxTrashcanContents||(e=new sn({scrollbars:true,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:true}}),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===et.TOP?et.BOTTOM:et.TOP,this.flyout=new(si(Se.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,true))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===et.RIGHT?et.LEFT:et.RIGHT,this.flyout=new(si(Se.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,true))(e)),this.workspace.addChangeListener(this.onDelete_.bind(this)))}createDom(){this.svgGroup_=H(Q.G,{class:"blocklyTrash"});let e;const t=String(Math.random()).substring(2);e=H(Q.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_),H(Q.RECT,{width:Zo,height:fu,y:Qo},e);const r=H(Q.IMAGE,{width:Ys.width,x:-n_,height:Ys.height,y:-r_,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_);return r.setAttributeNS(oi,"xlink:href",this.workspace.options.pathToMedia+Ys.url),e=H(Q.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),H(Q.RECT,{width:Zo,height:Qo},e),this.svgLid_=H(Q.IMAGE,{width:Ys.width,x:-n_,height:Ys.height,y:-r_,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS(oi,"xlink:href",this.workspace.options.pathToMedia+Ys.url),y(this.svgGroup_,"pointerdown",this,this.blockMouseDownWhenOpenable_),y(this.svgGroup_,"pointerup",this,this.click),y(r,"pointerover",this,this.mouseOver_),y(r,"pointerout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_}init(){0<this.workspace.options.maxTrashcanContents&&(te(this.flyout.createDom(Q.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[ys.Capability.AUTOHIDEABLE,ys.Capability.DELETE_AREA,ys.Capability.DRAG_TARGET,ys.Capability.POSITIONABLE]}),this.initialized_=true,this.setLidOpen(false)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&(x(this.svgGroup_),this.svgGroup_=null),this.svgLid_=null,this.lidTask_&&clearTimeout(this.lidTask_)}hasContents_(){return!!this.contents_.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents_.map(function(r){return JSON.parse(r)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let r;(r=this.flyout)==null||r.show(e),t.cursor=""},10),this.fireUiEvent_(true)}}closeFlyout(){if(this.contentsIsOpen()){var e;(e=this.flyout)==null||e.hide(),this.fireUiEvent_(false),this.workspace.recordDragTargets()}}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())}position(e,t){if(this.initialized_){var r=Qh(this.workspace,e);e=Zh(r,new $s(Zo,fu+Qo),SO,Jv,e,this.workspace),t=ed(e,Jv,r.vertical===Vn.TOP?dr.DOWN:dr.UP,t),this.top_=t.top,this.left_=t.left;var a;(a=this.svgGroup_)==null||a.setAttribute("transform","translate("+this.left_+","+this.top_+")")}}getBoundingRectangle(){return new es(this.top_,this.top_+fu+Qo,this.left_,this.left_+Zo)}getClientRect(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect();const t=e.top+r_-mu;return e=e.left+n_-mu,new es(t,t+Qo+fu+2*mu,e,e+Zo+2*mu)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(false)}onDrop(e){setTimeout(this.setLidOpen.bind(this,false),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask_&&clearTimeout(this.lidTask_),this.isLidOpen=e,this.animateLid_())}animateLid_(){const e=RO;var t=1/(e+1);this.lidOpen_+=this.isLidOpen?t:-t,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*Qv),t=Zv+this.lidOpen_*(IO-Zv),this.svgGroup_&&(this.svgGroup_.style.opacity=t.toString()),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),yO/e))}setLidAngle_(e){const t=this.workspace.toolboxPosition===et.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let r;(r=this.svgLid_)==null||r.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:Zo-4)+","+(Qo-2)+")")}setMinOpenness_(e){this.minOpenness_=e,this.isLidOpen||this.setLidAngle_(e*Qv)}closeLid(){this.setLidOpen(false)}click(){this.hasContents_()&&this.openFlyout()}fireUiEvent_(e){e=new(Te(ja))(e,this.workspace.id),Pe(e)}blockMouseDownWhenOpenable_(e){!this.contentsIsOpen()&&this.hasContents_()&&e.stopPropagation()}mouseOver_(){this.hasContents_()&&this.setLidOpen(true)}mouseOut_(){this.setLidOpen(false)}onDelete_(e){if(!(0>=this.workspace.options.maxTrashcanContents||e.type!==En||e.type!==En||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson_(e.oldJson)),this.contents_.indexOf(e)===-1){for(this.contents_.unshift(e);this.contents_.length>this.workspace.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_($O)}}}cleanBlockJson_(e){function t(r){if(r){if(delete r.id,delete r.x,delete r.y,delete r.enabled,r.icons&&r.icons.comment){var a=r.icons.comment;delete a.height,delete a.width,delete a.pinned}a=r.inputs;for(var h in a){var C=a[h];const D=C.block;C=C.shadow,D&&t(D),C&&t(C)}r.next&&(h=r.next,r=h.block,h=h.shadow,r&&t(r),h&&t(h))}}return e=JSON.parse(JSON.stringify(e)),t(e),Object.assign({},{kind:"BLOCK"},e)}},Zo=47,fu=44,Qo=16,Jv=20,SO=20,mu=10,n_=0,r_=32,$O=.1,yO=80,RO=4,Zv=.4,IO=.8,Qv=45,o_=class extends Zi{constructor(e,t,r){super(r),this.type=Xa,this.oldItem=e??void 0,this.newItem=t??void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}fromJson(e){o("Blockly.Events.ToolboxItemSelect.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldItem=e.oldItem,this.newItem=e.newItem}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new o_),t.oldItem=e.oldItem,t.newItem=e.newItem,t}};ye(Se.EVENT,Xa,o_);var a_=class{constructor(e,t,r){this.id_=e.toolboxitemid||Ar(),this.level_=(this.parent_=r||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return false}isCollapsible(){return false}dispose(){}setVisible_(e){}},nn=class extends a_{constructor(e,t,r){super(e,t,r),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=false,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const r=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(r)}}parseCategoryDef_(e){this.name_="name"in e?Qt(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),gn(this.htmlDiv_,li.TREEITEM),Xt(this.htmlDiv_,Gt.SELECTED,false),Xt(this.htmlDiv_,Gt.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),gn(this.iconDom_,li.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&Xt(this.htmlDiv_,Gt.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ne(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&ne(e,t),t=`${nn.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&ne(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ne(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&ne(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=nn.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle_(t);if(e)return this.parseColour_(e)}return""}getColourfromStyle_(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour_(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(e){if(e=Qt(e),e==null||e==="")return"";var t=Number(e);return isNaN(t)?(t=xr(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):Bh(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&Ie(e,t),(t=this.cssConfig_.openicon)&&ne(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&Ie(e,t),(t=this.cssConfig_.closedicon)&&ne(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(false)}show(){this.setVisible_(true)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return false;return true}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const r=this.parseColour_(nn.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||r,t&&ne(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&de(this.rowDiv_,t);Xt(this.htmlDiv_,Gt.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_=typeof e=="string"?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:kc(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){x(this.htmlDiv_)}};nn.registrationName="category",nn.nestedPadding=19,nn.borderWidth=8,nn.defaultBackgroundColour="#57e",hs(`
.blocklyTreeRow:not(.blocklyTreeSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {
  margin: 1px 5px 1px 0;
}

.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {
  margin: 1px 0 1px 5px;
}

.blocklyTreeRow {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyTreeIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyTreeIconClosed {
  background-position: -32px -1px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {
  background-position: 0 -1px;
}

.blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: -32px -17px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: 0 -17px;
}

.blocklyTreeIconOpen {
  background-position: -16px -1px;
}

.blocklyTreeSelected>.blocklyTreeIconOpen {
  background-position: -16px -17px;
}

.blocklyTreeLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyTreeLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyTreeSelected .blocklyTreeLabel {
  color: #fff;
}
`),ye(Se.TOOLBOX_ITEM,nn.registrationName,nn);var El=class extends a_{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ne(e,t),this.htmlDiv_=e}getDiv(){return this.htmlDiv_}dispose(){x(this.htmlDiv_)}};El.registrationName="sep",hs(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),ye(Se.TOOLBOX_ITEM,El.registrationName,El);var ea=class extends nn{constructor(e,t,r){super(e,t,r),this.subcategoriesDiv_=null,this.expanded_=false,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxContents",e}parseContents_(e){const t=e.contents;let r=true;if(e.custom)this.flyoutItems_=e.custom;else if(t)for(e=0;e<t.length;e++){const a=t[e];!Eo(Se.TOOLBOX_ITEM,a.kind)||a.kind.toLowerCase()===El.registrationName&&r?(this.flyoutItems_.push(a),r=true):(this.createToolboxItem_(a),r=false)}}createToolboxItem_(e){let t=e.kind;t.toUpperCase()==="CATEGORY"&&Wh(e)&&(t=ea.registrationName),e=new(dn(Se.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),gn(this.subcategoriesDiv_,li.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ne(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");var r=this.cssConfig_.contents;for(r&&ne(t,r),r=0;r<e.length;r++){const a=e[r];a.init();const h=a.getDiv();if(t.appendChild(h),a.getClickTarget){let C;(C=a.getClickTarget())==null||C.setAttribute("id",a.getId())}}return t}setExpanded(e){this.expanded_!==e&&((this.expanded_=e)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),Xt(this.htmlDiv_,Gt.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize())}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let r=0;r<t.length;r++)t[r].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return true}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};ea.registrationName="collapsibleCategory",ye(Se.TOOLBOX_ITEM,ea.registrationName,ea);var eb=class extends gu{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=false,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout_=e.options.horizontalLayout,this.RTL=e.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return false}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),te(this.flyout_.createDom("svg"),t),this.setVisible(true),this.flyout_.init(e),this.render(this.toolboxDef_),e=e.getThemeManager(),e.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[ys.Capability.AUTOHIDEABLE,ys.Capability.DELETE_AREA,ys.Capability.DRAG_TARGET]})}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,gn(this.contentsDiv_,li.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),ne(e,"blocklyToolboxDiv"),ne(e,"blocklyNonSelectable"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return ne(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=E(e,"pointerdown",this,this.onClick_,false),this.boundEvents_.push(e),t=E(t,"keydown",this,this.onKeyDown_,false),this.boundEvents_.push(t)}onClick_(e){if(T(e)||e.target===this.HtmlDiv)k().hideChaff(false);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t),t.isSelectable()&&(this.setSelectedItem(t),t.onClick(e))),k().hideChaff(true)}m()}onKeyDown_(e){let t=false;switch(e.keyCode){case xe.DOWN:t=this.selectNext_();break;case xe.UP:t=this.selectPrevious_();break;case xe.LEFT:t=this.selectParent_();break;case xe.RIGHT:t=this.selectChild_();break;case xe.ENTER:case xe.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=true);break;default:t=false}if(!t&&this.selectedItem_){const r=this.selectedItem_;r.onKeyDown&&(t=r.onKeyDown(e))}t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=new sn({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:true}});return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?si(Se.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,true):si(Se.FLYOUTS_VERTICAL_TOOLBOX,e.options,true))(t)}render(e){this.toolboxDef_=e;for(let t=0;t<this.contents_.length;t++){const r=this.contents_[t];r&&r.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let r=0;r<e.length;r++)this.createToolboxItem_(e[r],t);this.contentsDiv_.appendChild(t)}createToolboxItem_(e,t){var r=e.kind;r.toUpperCase()==="CATEGORY"&&Wh(e)&&(r=ea.registrationName),(r=dn(Se.TOOLBOX_ITEM,r.toLowerCase()))&&(e=new r(e,this),e.init(),this.addToolboxItem_(e),(r=e.getDiv())&&t.appendChild(r),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return this.contents_}addStyle(e){e&&this.HtmlDiv&&ne(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&de(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,r=t+e.height,a=e.left;return e=a+e.width,this.toolboxPosition===et.TOP?new es(-1e7,r,-1e7,1e7):this.toolboxPosition===et.BOTTOM?new es(t,1e7,-1e7,1e7):this.toolboxPosition===et.LEFT?new es(-1e7,1e7,-1e7,e):new es(-1e7,1e7,a,1e7)}wouldDelete(e,t){return e instanceof Pi?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(true)}onDragExit(e){this.updateCursorDeleteStyle_(false)}onDrop(e){this.updateCursorDeleteStyle_(false)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(false),this.wouldDelete_=e,this.updateCursorDeleteStyle_(true))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contentMap_[e]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===et.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===et.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition===et.LEFT?e.scrollX+t.width:e.scrollX,this.toolboxPosition===et.TOP?e.scrollY+t.height:e.scrollY),j(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let e=0;e<this.contents_.length;e++){const t=this.contents_[e];t.refreshTheme&&t.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!e.isSelectable()||(this.shouldDeselectItem_(t,e)&&t!==null&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&e!==null&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent_(t,e))}shouldDeselectItem_(e,t){return e!==null&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return t!==null&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(false),Xt(this.contentsDiv_,Gt.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(true),Xt(this.contentsDiv_,Gt.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e],e.isSelectable()&&this.setSelectedItem(e))}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout_.show(t.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(e,t){const r=e&&e.getName();let a=t&&t.getName();e===t&&(a=null),e=new(Te(Xa))(r,a,this.workspace_.id),Pe(e)}selectParent_(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),true):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),true):false:false}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return false;const e=this.selectedItem_;return e.isExpanded()?this.selectNext_():e.toggleExpanded(),true}selectNext_(){if(!this.selectedItem_)return false;let e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[++e];if(t&&t.isSelectable())return this.setSelectedItem(t),true}return false}selectPrevious_(){if(!this.selectedItem_)return false;let e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[--e];if(t&&t.isSelectable())return this.setSelectedItem(t),true}return false}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)f(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),x(this.HtmlDiv)}};hs(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolboxDiv {
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxContents {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxContents:focus {
  outline: none;
}
`),ye(Se.TOOLBOX,Bn,eb);var CO={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},OO={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},kO=new Kr("zelos",CO,OO),l_={};l_.Classic=du,l_.Zelos=kO;var c_=class extends Zi{constructor(e,t,r){t=e?e.workspace.id:t,t===null&&(t=void 0),super(t),this.type=cr,this.blockId=e?e.id:void 0,this.targetType=r}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}fromJson(e){o("Blockly.Events.Click.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.targetType=e.targetType,this.blockId=e.blockId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new c_),t.targetType=e.targetType,t.blockId=e.blockId,t}},u_;(function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"})(u_||(u_={})),ye(Se.EVENT,cr,c_);var tb=class{constructor(e,t){this.bubble=e,this.workspace=t,this.dragTarget_=null,this.wouldDeleteBubble_=false,this.startXY_=this.bubble.getRelativeToSurfaceXY(),this.dragSurface_=t.getBlockDragSurface()}startBubbleDrag(){Ft()||We(true),this.workspace.setResizesEnabled(false),this.bubble.setAutoLayout(false),this.dragSurface_&&(this.bubble.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.bubble.getSvgRoot())),this.bubble.setDragging&&this.bubble.setDragging(true)}dragBubble(e,t){t=this.pixelsToWorkspaceUnits_(t),t=Oe.sum(this.startXY_,t),this.bubble.moveDuringDrag(this.dragSurface_,t),t=this.dragTarget_,this.dragTarget_=this.workspace.getDragTarget(e),e=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),e!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==t&&(t&&t.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble)),this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(e){return e&&this.workspace.getComponentManager().hasCapability(e.id,ys.Capability.DELETE_AREA)?e.wouldDelete(this.bubble,false):false}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(e,t){this.dragBubble(e,t),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?e=this.startXY_:(e=this.pixelsToWorkspaceUnits_(t),e=Oe.sum(this.startXY_,e)),this.bubble.moveTo(e.x,e.y),this.dragTarget_&&this.dragTarget_.onDrop(this.bubble),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.bubble.dispose()):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace.getBubbleCanvas()),this.bubble.setDragging&&this.bubble.setDragging(false),this.fireMoveEvent_()),this.workspace.setResizesEnabled(true),We(false)}fireMoveEvent_(){if(this.bubble instanceof Gs){const e=new(Te(Un))(this.bubble);e.setOldCoordinate(this.startXY_),e.recordNew(),Pe(e)}}pixelsToWorkspaceUnits_(e){return e=new Oe(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}},sb=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new Oe(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){U()&&U().unselect(),this.workspace.setupDragSurface()}endDrag(e){this.drag(e),this.workspace.resetDragSurface()}drag(e){if(e=Oe.sum(this.startScrollXY_,e),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(e.x,this.workspace.scrollY);else if(this.verticalScrollEnabled_)this.workspace.scroll(this.workspace.scrollX,e.y);else throw new TypeError("Invalid state.")}},wO=5,AO=6,bn=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY_=new Oe(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.hasExceededDragRadius_=false,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isMultiTouch_=this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=false,this.cachedPoints=new Map,this.startDistance_=this.previousScale_=0,this.currentDropdownOwner=this.isPinchZoomEnabled_=this.onStartWrapper_=null,this.mostRecentEvent_=e,this.currentDragDeltaXY_=new Oe(0,0),this.healStack_=!zv}dispose(){m(),Vm(),this.creatorWorkspace.clearGesture(),this.onMoveWrapper_&&f(this.onMoveWrapper_),this.onUpWrapper_&&f(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.onStartWrapper_&&f(this.onStartWrapper_)}updateFromEvent_(e){const t=new Oe(e.clientX,e.clientY);this.updateDragDelta_(t)&&(this.updateIsDragging_(),g()),this.mostRecentEvent_=e}updateDragDelta_(e){return this.currentDragDeltaXY_=Oe.difference(e,this.mouseDownXY_),this.hasExceededDragRadius_?false:this.hasExceededDragRadius_=Oe.magnitude(this.currentDragDeltaXY_)>(this.flyout_?i.config$$module$build$src$core$config.flyoutDragRadius:i.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout_(){let e;if(!this.targetBlock_||(e=this.flyout_)==null||!e.isBlockCreatable(this.targetBlock_))return false;if(!this.flyout_.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout_.isScrollable()||this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)?(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Ft()||We(true),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),true):false}updateIsDraggingBubble_(){return this.startBubble_?(this.startDraggingBubble_(),true):false}updateIsDraggingBlock_(){if(!this.targetBlock_)return false;if(this.flyout_){if(this.updateIsDraggingFromFlyout_())return this.startDraggingBlock_(),true}else if(this.targetBlock_.isMovable())return this.startDraggingBlock_(),true;return false}updateIsDraggingWorkspace_(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new sb(this.startWorkspace_),this.workspaceDragger_.startDrag())}updateIsDragging_(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=true,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()}startDraggingBlock_(){this.blockDragger_=new(si(Se.BLOCK_DRAGGER,this.creatorWorkspace.options,true))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)}startDraggingBubble_(){if(!this.startBubble_)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger_=new tb(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,v(e)?this.cancel():(this.hasStarted_=true,Pa(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Rt(),this.startWorkspace_.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=e,Hm(),this.targetBlock_&&this.targetBlock_.select(),T(e)?this.handleRightClick(e):(e.type.toLowerCase()==="pointerdown"&&e.pointerType!=="mouse"&&l(e,this),this.mouseDownXY_=new Oe(e.clientX,e.clientY),this.healStack_=e.altKey||e.ctrlKey||e.metaKey,this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.onStartWrapper_=E(document,"pointerdown",null,this.handleStart.bind(this),true),this.onMoveWrapper_=E(document,"pointermove",null,this.handleMove.bind(this),true),this.onUpWrapper_=E(document,"pointerup",null,this.handleUp.bind(this),true),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&g())}handleMove(e){this.isDragging()&&u(e)||!this.isMultiTouch()?(this.updateFromEvent_(e),this.workspaceDragger_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.bubbleDragger_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),g())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!u(e))return;if(this.updateFromEvent_(e),g(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=true,this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(e,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(e,this.currentDragDeltaXY_):this.workspaceDragger_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(e)}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=p(e);this.cachedPoints.set(t,this.getTouchPoint(e));var r=Array.from(this.cachedPoints.keys());r.length===2&&(t=this.cachedPoints.get(r[0]),r=this.cachedPoints.get(r[1]),this.startDistance_=Oe.distance(t,r),this.isMultiTouch_=true,e.preventDefault())}handleTouchMove(e){const t=p(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled_&&this.cachedPoints.size===2?this.handlePinch_(e):this.handleMove(e)}handlePinch_(e){var t=Array.from(this.cachedPoints.keys()),r=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),r=Oe.distance(r,t)/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){if(t=r-this.previousScale_,t=0<t?t*wO:t*AO,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const a=this.startWorkspace_,h=S(e,a.getParentSvg(),a.getInverseScreenCTM());a.zoom(h.x,h.y,t)}this.previousScale_=r,e.preventDefault()}handleTouchEnd(e){e=p(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale_=0)}getTouchPoint(e){return this.startWorkspace_?new Oe(e.pageX,e.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(g(),this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.workspaceDragger_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())}handleRightClick(e){this.targetBlock_?(this.bringBlockToFront_(),this.targetBlock_.workspace.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(e)):this.startBubble_?this.startBubble_.showContextMenu(e):this.startWorkspace_&&!this.flyout_&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()}handleWsStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(t),this.mostRecentEvent_=e,this.doStart(e)}fireWorkspaceClick_(e){Pe(new(Te(cr))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent_=e}handleBubbleStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent_=e}doBubbleClick_(){this.startBubble_ instanceof Gs&&(this.startBubble_.setFocus(),this.startBubble_.select())}doFieldClick_(){if(!this.startField_)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField_&&this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()}doBlockClick_(){if(this.flyout_&&this.flyout_.autoClose){if(!this.targetBlock_)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock_.isEnabled()&&(Ft()||We(true),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");const e=new(Te(cr))(this.startBlock_,this.startWorkspace_.id,"block");Pe(e)}this.bringBlockToFront_(),We(false)}doWorkspaceClick_(e){e=this.creatorWorkspace,U()&&U().unselect(),this.fireWorkspaceClick_(this.startWorkspace_||e)}bringBlockToFront_(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()}setStartField(e){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=e)}setStartBubble(e){this.startBubble_||(this.startBubble_=e)}setStartBlock(e){this.startBlock_||this.startBubble_||(this.startBlock_=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock_(e.getRootBlock()):this.setTargetBlock_(e))}setTargetBlock_(e){e.isShadow()?this.setTargetBlock_(e.getParent()):this.targetBlock_=e}setStartWorkspace_(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout_(e){this.flyout_||(this.flyout_=e)}isBubbleClick_(){return!!this.startBubble_&&!this.hasExceededDragRadius_}isBlockClick_(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()}isFieldClick_(){return(this.startField_?this.startField_.isClickable():false)&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)}isWorkspaceClick_(){return!this.startBlock_&&!this.startBubble_&&!this.startField_&&!this.hasExceededDragRadius_}isDragging(){return!!this.workspaceDragger_||!!this.blockDragger_||!!this.bubbleDragger_}hasStarted(){return this.hasStarted_}getInsertionMarkers(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]}getCurrentDragger(){let e,t;return(t=(e=this.blockDragger_)!=null?e:this.workspaceDragger_)!=null?t:this.bubbleDragger_}static inProgress(){const e=A();for(let t=0,r;r=e[t];t++)if(r.currentGesture_)return true;return false}},It=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),(t=e.keyCodes)&&0<t.length)for(let r=0;r<t.length;r++)this.addKeyMapping(t[r],e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),true):(console.warn(`Keyboard shortcut named "${e}" not found.`),false)}addKeyMapping(e,t,r){e=String(e);const a=this.keyMap.get(e);if(a&&!r)throw Error(`Shortcut named "${t}" collides with shortcuts "${a}"`);a&&r?a.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,r){const a=this.keyMap.get(e);if(!a)return r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),false;const h=a.indexOf(t);return-1<h?(a.splice(h,1),a.length===0&&this.keyMap.delete(e),true):(r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),false)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,true)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,r]of this.keyMap)e[t]=r;return e}getRegistry(){const e=Object.create(null);for(const[t,r]of this.shortcuts)e[t]=r;return nr(Object.create(null),e)}onKeyDown(e,t){var r=this.serializeKeyEvent_(t);if(r=this.getShortcutNamesByKeyCode(r),!r)return false;for(let a=0,h;h=r[a];a++){const C=this.shortcuts.get(h);let D,Y;if((D=C)==null||!D.preconditionFn||(Y=C)!=null&&Y.preconditionFn(e)){let pe,ke;if((pe=C)!=null&&pe.callback&&((ke=C)!=null&&ke.callback(e,t,C)))return true}}return false}getShortcutNamesByKeyCode(e){return this.keyMap.get(e)||[]}getKeyCodesByShortcutName(e){const t=[];for(const[r,a]of this.keyMap)-1<a.indexOf(e)&&t.push(r);return t}serializeKeyEvent_(e){let t="";for(const r in It.modifierKeys)e.getModifierState(r)&&(t!==""&&(t+="+"),t+=r);return t!==""&&e.keyCode?t=t+"+"+e.keyCode:e.keyCode&&(t=e.keyCode.toString()),t}checkModifiers_(e){for(let t=0,r;r=e[t];t++)if(!(r in It.modifierKeys))throw Error(r+" is not a valid modifier key.")}createSerializedKey(e,t){let r="";if(t){this.checkModifiers_(t);for(const a in It.modifierKeys)-1<t.indexOf(It.modifierKeys[a])&&(r!==""&&(r+="+"),r+=a)}return r!==""&&e?r=r+"+"+e:e&&(r=e.toString()),r}};It.registry=new It,function(e){e=e.modifierKeys||(e.modifierKeys={}),e[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(It||(It={}));var Tn;(function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"})(Tn||(Tn={})),$E();var Sn={};Sn.names=Tn,Sn.registerCopy=EE,Sn.registerCut=vE,Sn.registerDefaultShortcuts=$E,Sn.registerDelete=mE,Sn.registerEscape=fE,Sn.registerPaste=bE,Sn.registerRedo=SE,Sn.registerUndo=TE;var h_=class extends Zi{constructor(e,t){super(t),this.type=Ka,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}fromJson(e){o("Blockly.Events.ThemeChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.themeName=e.themeName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new h_),t.themeName=e.themeName,t}};ye(Se.EVENT,Ka,h_);var d_=class extends Zi{constructor(e,t,r,a,h){super(a),this.type=Vr,this.viewTop=e,this.viewLeft=t,this.scale=r,this.oldScale=h}toJson(){const e=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}fromJson(e){o("Blockly.Events.Viewport.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.viewTop=e.viewTop,this.viewLeft=e.viewLeft,this.scale=e.scale,this.oldScale=e.oldScale}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new d_),t.viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};ye(Se.EVENT,Vr,d_);var ta=class{constructor(e){this.connectionChecker=e,this.connections_=[]}addConnection(e,t){t=this.calculateIndexForYPos_(t),this.connections_.splice(t,0,e)}findIndexOfConnection_(e,t){if(!this.connections_.length)return-1;const r=this.calculateIndexForYPos_(t);if(r>=this.connections_.length)return-1;t=e.y;let a=r;for(;0<=a&&this.connections_[a].y===t;){if(this.connections_[a]===e)return a;a--}for(a=r;a<this.connections_.length&&this.connections_[a].y===t;){if(this.connections_[a]===e)return a;a++}return-1}calculateIndexForYPos_(e){if(!this.connections_.length)return 0;let t=0,r=this.connections_.length;for(;t<r;){const a=Math.floor((t+r)/2);if(this.connections_[a].y<e)t=a+1;else if(this.connections_[a].y>e)r=a;else{t=a;break}}return t}removeConnection(e,t){if(e=this.findIndexOfConnection_(e,t),e===-1)throw Error("Unable to find connection in connectionDB.");this.connections_.splice(e,1)}getNeighbours(e,t){function r(ke){const ft=h-a[ke].x,zt=C-a[ke].y;return Math.sqrt(ft*ft+zt*zt)<=t&&pe.push(a[ke]),zt<t}const a=this.connections_,h=e.x,C=e.y;e=0;let D=a.length-2,Y=D;for(;e<Y;)a[Y].y<C?e=Y:D=Y,Y=Math.floor((e+D)/2);const pe=[];if(D=e=Y,a.length){for(;0<=e&&r(e);)e--;do D++;while(D<a.length&&r(D))}return pe}isInYRange_(e,t,r){return Math.abs(this.connections_[e].y-t)<=r}searchForClosest(e,t,r){if(!this.connections_.length)return{connection:null,radius:t};const a=e.y,h=e.x;e.x=h+r.x,e.y=a+r.y;var C=this.calculateIndexForYPos_(e.y);r=null;let D=t,Y,pe=C-1;for(;0<=pe&&this.isInYRange_(pe,e.y,t);)Y=this.connections_[pe],this.connectionChecker.canConnect(e,Y,true,D)&&(r=Y,D=Y.distanceFrom(e)),pe--;for(;C<this.connections_.length&&this.isInYRange_(C,e.y,t);)Y=this.connections_[C],this.connectionChecker.canConnect(e,Y,true,D)&&(r=Y,D=Y.distanceFrom(e)),C++;return e.x=h,e.y=a,{connection:r,radius:D}}static init(e){const t=[];return t[Le.INPUT_VALUE]=new ta(e),t[Le.OUTPUT_VALUE]=new ta(e),t[Le.NEXT_STATEMENT]=new ta(e),t[Le.PREVIOUS_STATEMENT]=new ta(e),t}},__=class{constructor(e,t){this.pattern=e;let r;this.spacing=(r=t.spacing)!=null?r:0;let a;this.length=(a=t.length)!=null?a:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling;let h;this.snapToGrid=(h=t.snap)!=null?h:false}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(e){var t=this.spacing*e||100;this.pattern.setAttribute("width",t.toString()),this.pattern.setAttribute("height",t.toString()),t=Math.floor(this.spacing/2)+.5;let r=t-this.length/2,a=t+this.length/2;t*=e,r*=e,a*=e,this.setLineAttributes(this.line1,e,r,a,t,t),this.setLineAttributes(this.line2,e,t,t,r,a)}setLineAttributes(e,t,r,a,h,C){e&&(e.setAttribute("stroke-width",t.toString()),e.setAttribute("x1",r.toString()),e.setAttribute("y1",h.toString()),e.setAttribute("x2",a.toString()),e.setAttribute("y2",C.toString()))}moveTo(e,t){this.pattern.setAttribute("x",e.toString()),this.pattern.setAttribute("y",t.toString())}static createDom(e,t,r){e=H(Q.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},r);let a,h;if(0<((a=t.length)!=null?a:1)&&0<((h=t.spacing)!=null?h:0)){H(Q.LINE,{stroke:t.colour},e);let C;(C=t.length)!=null&&C&&H(Q.LINE,{stroke:t.colour},e)}else H(Q.LINE,{},e);return e}},Ui=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap_=null,this.variablePrefix_=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap_=null}setVariableMap(e){this.variableMap_=e}getNameForUserVariable_(e){return this.variableMap_?(e=this.variableMap_.getVariableById(e))?e.name:null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(e){e=yo(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),i.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let r=e;t===i.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable_(e))&&(r=e),e=r.toLowerCase();const a=t===i.NameType$$module$build$src$core$names.VARIABLE||t===i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"";this.db.has(t)||this.db.set(t,new Map);const h=this.db.get(t);return h.has(e)?a+h.get(e):(t=this.getDistinctName(r,t),h.set(e,t.substr(a.length)),t)}getUserNames(e){let t;return(e=(t=this.db.get(e))==null?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName_(e);let r="";for(;this.dbReverse.has(e+r)||this.reservedWords.has(e+r);)r=r?r+1:2;return e+=r,this.dbReverse.add(e),(t===i.NameType$$module$build$src$core$names.VARIABLE||t===i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"")+e}safeName_(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".indexOf(e[0])!==-1&&(e="my_"+e)):e=Ye.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}};(function(e){e=e.NameType||(e.NameType={}),e.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"})(Ui||(Ui={})),i.NameType$$module$build$src$core$names=Ui.NameType,Ui.DEVELOPER_VARIABLE_TYPE=i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,i.module$build$src$core$names={},i.module$build$src$core$names.NameType=i.NameType$$module$build$src$core$names,i.module$build$src$core$names.Names=Ui;var ib=class extends Map{constructor(e){super(),this.workspace=e}set(e,t){return this.get(e)===t?this:(super.set(e,t),Pe(new(Te(Yc))(this.workspace,t)),Ao(t)&&t.startPublishing(),this)}delete(e){const t=this.get(e);return e=super.delete(e),e&&(rr(this.workspace),Pe(new(Te(qa))(this.workspace,t)),Ao(t)&&t.stopPublishing(),e)}clear(){if(this.size){for(const e of this.keys()){const t=this.get(e);super.delete(e),Pe(new(Te(qa))(this.workspace,t))}rr(this.workspace)}}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},vl=class{constructor(e,t,r){this.workspace=e,this.parameters=[],this.returnTypes=null,this.enabled=true,this.shouldFireEvents=false,this.id=r??pi(),this.name=t}setName(e){if(e===this.name)return this;const t=this.name;return this.name=e,rr(this.workspace),this.shouldFireEvents&&Pe(new(Te(qc))(this.workspace,this,t)),this}insertParameter(e,t){return this.parameters[t]&&this.parameters[t].getId()===e.getId()?this:(this.parameters.splice(t,0,e),e.setProcedureModel(this),Ao(e)&&(this.shouldFireEvents?e.startPublishing():e.stopPublishing()),rr(this.workspace),this.shouldFireEvents&&Pe(new(Te(Qc))(this.workspace,this,e,t)),this)}deleteParameter(e){if(!this.parameters[e])return this;const t=this.parameters[e];return this.parameters.splice(e,1),rr(this.workspace),Ao(t)&&t.stopPublishing(),this.shouldFireEvents&&Pe(new(Te(eu))(this.workspace,this,t,e)),this}setReturnTypes(e){if(e&&e.length)throw Error("The built-in ProcedureModel does not support typing. You need to implement your own custom ProcedureModel.");if(!!e==!!this.returnTypes)return this;const t=this.returnTypes;return this.returnTypes=e,rr(this.workspace),this.shouldFireEvents&&Pe(new(Te(Zc))(this.workspace,this,t)),this}setEnabled(e){return e===this.enabled?this:(this.enabled=e,rr(this.workspace),this.shouldFireEvents&&Pe(new(Te(Jc))(this.workspace,this)),this)}getId(){return this.id}getName(){return this.name}getParameter(e){return this.parameters[e]}getParameters(){return[...this.parameters]}getReturnTypes(){return this.returnTypes}getEnabled(){return this.enabled}startPublishing(){this.shouldFireEvents=true;for(const e of this.parameters)Ao(e)&&e.startPublishing()}stopPublishing(){this.shouldFireEvents=false;for(const e of this.parameters)Ao(e)&&e.stopPublishing()}},sa=class{constructor(e,t,r){this.workspace=e,this.shouldFireEvents=false,this.procedureModel=null,this.id=r??pi();let a;this.variable=(a=this.workspace.getVariable(t))!=null?a:e.createVariable(t)}setName(e){if(e===this.variable.name)return this;const t=this.variable.name;let r;return this.variable=(r=this.workspace.getVariable(e))!=null?r:this.workspace.createVariable(e),rr(this.workspace),this.shouldFireEvents&&Pe(new(Te(tu))(this.workspace,this.procedureModel,this,t)),this}setTypes(e){throw Error("The built-in ParameterModel does not support typing. You need to implement your own custom ParameterModel.")}getName(){return this.variable.name}getTypes(){return[]}getId(){return this.id}getVariableModel(){return this.variable}startPublishing(){this.shouldFireEvents=true}stopPublishing(){this.shouldFireEvents=false}setProcedureModel(e){return this.procedureModel=e,this}},Eu,p_;Eu="PROCEDURE",p_="x",i.module$build$src$core$procedures={},i.module$build$src$core$procedures.CATEGORY_NAME=Eu,i.module$build$src$core$procedures.DEFAULT_ARG=p_,i.module$build$src$core$procedures.ObservableParameterModel=sa,i.module$build$src$core$procedures.ObservableProcedureMap=ib,i.module$build$src$core$procedures.ObservableProcedureModel=vl,i.module$build$src$core$procedures.allProcedures=td,i.module$build$src$core$procedures.findLegalName=RE,i.module$build$src$core$procedures.flyoutCategory=sd,i.module$build$src$core$procedures.getCallers=kE,i.module$build$src$core$procedures.getDefinition=MC,i.module$build$src$core$procedures.isNameUsed=IE,i.module$build$src$core$procedures.mutateCallers=NC,i.module$build$src$core$procedures.mutatorOpenListener=OE,i.module$build$src$core$procedures.rename=AC;var LO=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return e.type&this.FIELD}isHat(e){return e.type&this.HAT}isIcon(e){return e.type&this.ICON}isSpacer(e){return e.type&this.SPACER}isInRowSpacer(e){return e.type&this.IN_ROW_SPACER}isInput(e){return e.type&this.INPUT}isExternalInput(e){return e.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(e){return e.type&this.INLINE_INPUT}isStatementInput(e){return e.type&this.STATEMENT_INPUT}isPreviousConnection(e){return e.type&this.PREVIOUS_CONNECTION}isNextConnection(e){return e.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(e){return e.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(e){return e.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(e){return e.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(e){return e.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(e){return e.type&this.RIGHT_SQUARE_CORNER}isCorner(e){return e.type&this.CORNER}isJaggedEdge(e){return e.type&this.JAGGED_EDGE}isRow(e){return e.type&this.ROW}isBetweenRowSpacer(e){return e.type&this.BETWEEN_ROW_SPACER}isTopRow(e){return e.type&this.TOP_ROW}isBottomRow(e){return e.type&this.BOTTOM_ROW}isTopOrBottomRow(e){return e.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(e){return e.type&this.INPUT_ROW}},Z=new LO,$n=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=Z.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},bl=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=false,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=false,this.align=null,this.constants_=e,this.type=Z.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(Z.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return true}endsWithElemSpacer(){return true}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(Z.isSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(Z.isSpacer(t))return t}return null}},g_=class extends bl{constructor(e){super(e),this.hasNextConnection=false,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=Z.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return true}measure(){let e=0,t=0,r=0;for(let a=0;a<this.elements.length;a++){const h=this.elements[a];t+=h.width,Z.isSpacer(h)||(Z.isNextConnection(h)?r=Math.max(r,h.height):e=Math.max(e,h.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.descenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return false}endsWithElemSpacer(){return false}},Jr=class extends $n{constructor(e,t){super(e),this.connectionModel=t,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.type|=Z.CONNECTION}},Wn=class extends Jr{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=Z.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},vu=class extends Wn{constructor(e,t){super(e,t),this.height=0,this.type|=Z.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},Zr=class extends $n{constructor(e,t,r){super(e),this.field=t,this.parentInput=r,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=Z.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},f_=class extends $n{constructor(e){super(e),this.type|=Z.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},nb=class extends $n{constructor(e,t){super(e),this.icon=t,this.flipRtl=false,this.isVisible=t.isVisible(),this.type|=Z.ICON,e=t.getCorrectedSize(),this.height=e.height,this.width=e.width}},bi=class extends $n{constructor(e,t){super(e),this.type=this.type|Z.SPACER|Z.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},m_=class extends Wn{constructor(e,t){super(e,t),this.type|=Z.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},Tl=class extends Wn{constructor(e,t){super(e,t),this.type|=Z.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},E_=class extends bl{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=Z.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const r=this.elements[t];this.width+=r.width,Z.isInput(r)&&r instanceof Wn&&(Z.isStatementInput(r)&&r instanceof Tl?e+=r.connectedBlockWidth:Z.isExternalInput(r)&&r instanceof vu&&r.connectedBlockWidth!==0&&(e+=r.connectedBlockWidth-r.connectionWidth)),Z.isSpacer(r)||(this.height=Math.max(this.height,r.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},rb=class extends $n{constructor(e){super(e),this.type|=Z.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},ob=class extends Jr{constructor(e,t){super(e,t),this.type|=Z.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},ab=class extends Jr{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=Z.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},lb=class extends Jr{constructor(e,t){super(e,t),this.type|=Z.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Sl=class extends $n{constructor(e,t){super(e),this.type=(t&&t!=="left"?Z.RIGHT_ROUND_CORNER:Z.LEFT_ROUND_CORNER)|Z.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},v_=class extends bl{constructor(e,t,r){super(e),this.height=t,this.width=r,this.precedesStatement=this.followsStatement=false,this.widthWithConnectedBlocks=0,this.type=this.type|Z.SPACER|Z.BETWEEN_ROW_SPACER,this.elements=[new bi(this.constants_,r)]}measure(){}},$l=class extends $n{constructor(e,t){super(e),this.type=(t&&t!=="left"?Z.RIGHT_SQUARE_CORNER:Z.LEFT_SQUARE_CORNER)|Z.CORNER,this.width=this.height=this.constants_.NO_PADDING}},b_=class extends bl{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=false,this.connection=null,this.type|=Z.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,r=e.getPreviousBlock();return!!e.outputConnection||t||(r?r.getNextBlock()===e:false)}hasRightSquareCorner(e){return true}measure(){let e=0,t=0,r=0;for(let a=0;a<this.elements.length;a++){const h=this.elements[a];t+=h.width,Z.isSpacer(h)||(Z.isHat(h)&&h instanceof f_?r=Math.max(r,h.ascenderHeight):e=Math.max(e,h.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.capline=this.ascenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return false}endsWithElemSpacer(){return false}},yl=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=false,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=false,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=false,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs_=null,this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=false,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=Wt(0,0),this.FIELD_TEXT_BASELINE_CENTER=true,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const r in t)this.blockStyles[r]=this.validatedBlockStyle_(t[r]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=e.startHats!==void 0?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=jt("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.indexOf("auto_")===0?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=ko(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?ko(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?ko(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Oo("#fff",e,.6)||e}generateTertiaryColour_(e){return Oo("#fff",e,.3)||e}dispose(){this.embossFilter_&&x(this.embossFilter_),this.disabledPattern_&&x(this.disabledPattern_),this.debugFilter_&&x(this.debugFilter_),this.cssNode_=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH,r=Ba([Ge(t,e/4),Ge(2*-t,e/2),Ge(t,e/4)]);return{height:e,width:t,path:r}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=Ei("c",[Ge(30,-e),Ge(70,-e),Ge(t,0)]);return{height:e,width:t,path:r}}makePuzzleTab(){function e(C){C=C?-1:1;const D=-C;var Y=r/2;const pe=Y+2.5,ke=Y+.5,ft=Ge(-t,C*Y);return Y=Ge(t,C*Y),Ei("c",[Ge(0,C*pe),Ge(-t,D*ke),ft])+Ei("s",[Ge(t,2.5*D),Y])}const t=this.TAB_WIDTH,r=this.TAB_HEIGHT,a=e(true),h=e(false);return{type:this.SHAPES.PUZZLE,width:t,height:r,pathDown:h,pathUp:a}}makeNotch(){function e(D){return Ba([Ge(D*a,r),Ge(3*D,0),Ge(D*a,-r)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,a=(t-3)/2,h=e(1),C=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:h,pathRight:C}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=ds("a","0 0,0",e,Ge(-e,e)),r=ds("a","0 0,0",e,Ge(e,e));return{width:e,height:e,pathTop:t,pathBottom:r}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=Wt(0,e)+ds("a","0 0,1",e,Ge(e,-e)),r=ds("a","0 0,1",e,Ge(e,e)),a=ds("a","0 0,1",e,Ge(-e,-e)),h=ds("a","0 0,1",e,Ge(-e,e));return{topLeft:t,topRight:r,bottomRight:h,bottomLeft:a,rightHeight:e}}shapeFor(e){switch(e.type){case Le.INPUT_VALUE:case Le.OUTPUT_VALUE:return this.PUZZLE_TAB;case Le.PREVIOUS_STATEMENT:case Le.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,r){this.injectCSS_(t,r),this.defs_=H(Q.DEFS,{},e),e=H(Q.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs_),H(Q.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=H(Q.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),H(Q.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),H(Q.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),H(Q.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter_=e,e=H(Q.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs_),H(Q.RECT,{width:10,height:10,fill:"#aaa"},e),H(Q.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern_=e,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter_){const e=H(Q.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs_),t=H(Q.FECOMPONENTTRANSFER,{result:"outBlur"},e);H(Q.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),H(Q.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),H(Q.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter_=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode_=document.getElementById(e);const r=t.join(`
`);this.cssNode_?this.cssNode_.firstChild.textContent=r:(t=document.createElement("style"),t.id=e,e=document.createTextNode(r),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode_=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect,`,`${e} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},cb=false,Ti=class{constructor(e){this.constants=e,this.debugElements_=[],this.svgRoot_=null,this.randomColour_=""}clearElems(){for(let e=0;e<this.debugElements_.length;e++)x(this.debugElements_[e]);this.debugElements_=[]}drawSpacerRow(e,t,r){if(Ti.config.rowSpacers){var a=Math.abs(e.height),h=0>e.height;h&&(t-=a),this.debugElements_.push(H(Q.RECT,{class:"rowSpacerRect blockRenderDebug",x:r?-(e.xPos+e.width):e.xPos,y:t,width:e.width,height:a,stroke:h?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}}drawSpacerElem(e,t,r){if(Ti.config.elemSpacers){t=Math.abs(e.width);var a=0>e.width,h=a?e.xPos-t:e.xPos;r&&(h=-(h+t)),this.debugElements_.push(H(Q.RECT,{class:"elemSpacerRect blockRenderDebug",x:h,y:e.centerline-e.height/2,width:t,height:e.height,stroke:"pink",fill:a?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}}drawRenderedElem(e,t){if(Ti.config.elems){let r=e.xPos;t&&(r=-(r+e.width)),t=e.centerline-e.height/2,this.debugElements_.push(H(Q.RECT,{class:"rowRenderingRect blockRenderDebug",x:r,y:t,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),Z.isField(e)&&e instanceof Zr&&e.field instanceof i.FieldLabel$$module$build$src$core$field_label&&this.debugElements_.push(H(Q.RECT,{class:"rowRenderingRect blockRenderDebug",x:r,y:t+this.constants.FIELD_TEXT_BASELINE,width:e.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}Z.isInput(e)&&e instanceof Wn&&Ti.config.connections&&this.drawConnection(e.connectionModel)}drawConnection(e){if(Ti.config.connections){var t="",r=0,a="";e.type===Le.INPUT_VALUE?(r=4,t="magenta",a="none"):e.type===Le.OUTPUT_VALUE?(r=2,a=t="magenta"):e.type===Le.NEXT_STATEMENT?(r=4,t="goldenrod",a="none"):e.type===Le.PREVIOUS_STATEMENT&&(r=2,a=t="goldenrod"),this.debugElements_.push(H(Q.CIRCLE,{class:"blockRenderDebug",cx:e.getOffsetInBlock().x,cy:e.getOffsetInBlock().y,r,fill:a,stroke:t},this.svgRoot_))}}drawRenderedRow(e,t,r){Ti.config.rows&&(this.debugElements_.push(H(Q.RECT,{class:"elemRenderingRect blockRenderDebug",x:r?-(e.xPos+e.width):e.xPos,y:e.yPos,width:e.width,height:e.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),Z.isTopOrBottomRow(e)||Ti.config.connectedBlockBounds&&this.debugElements_.push(H(Q.RECT,{class:"connectedBlockWidth blockRenderDebug",x:r?-(e.xPos+e.widthWithConnectedBlocks):e.xPos,y:e.yPos,width:e.widthWithConnectedBlocks,height:e.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))}drawRowWithElements(e,t,r){for(let a=0;a<e.elements.length;a++){const h=e.elements[a];h?Z.isSpacer(h)?this.drawSpacerElem(h,e.height,r):this.drawRenderedElem(h,r):console.warn("A row has an undefined or null element.",e,h)}this.drawRenderedRow(e,t,r)}drawBoundingBox(e){if(Ti.config.blockBounds){var t=e.RTL?-e.width:0;this.debugElements_.push(H(Q.RECT,{class:"blockBoundingBox blockRenderDebug",x:t,y:0,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),Ti.config.connectedBlockBounds&&(t=e.RTL?-e.widthWithChildren:0,this.debugElements_.push(H(Q.RECT,{class:"blockRenderDebug",x:t,y:0,width:e.widthWithChildren,height:e.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))}}drawDebug(e,t){this.clearElems(),this.svgRoot_=e.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);let r=0;for(let a=0;a<t.rows.length;a++){const h=t.rows[a];Z.isBetweenRowSpacer(h)?this.drawSpacerRow(h,r,t.RTL):this.drawRowWithElements(h,r,t.RTL),r+=h.height}e.previousConnection&&this.drawConnection(e.previousConnection),e.nextConnection&&this.drawConnection(e.nextConnection),e.outputConnection&&this.drawConnection(e.outputConnection),t.rightSide&&this.drawRenderedElem(t.rightSide,t.RTL),this.drawBoundingBox(t),this.drawRender(e.pathObject.svgPath)}drawRender(e){Ti.config.render&&(e.setAttribute("filter","url(#"+this.constants.debugFilterId+")"),setTimeout(function(){e.setAttribute("filter","")},100))}};Ti.config={rowSpacers:true,elemSpacers:true,rows:true,elems:true,connections:true,blockBounds:true,connectedBlockBounds:true,render:true};var Rl=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){if(this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),xc()){let e;(e=this.block_.renderingDebugger)==null||e.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}hideHiddenIcons_(){for(let e=0,t;t=this.info_.hiddenIcons[e];e++){let r;(r=t.icon.iconGroup_)==null||r.setAttribute("display","none")}}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=Wt(e.xPos,this.info_.startY);for(let r=0,a;a=t[r];r++)Z.isLeftRoundedCorner(a)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:Z.isRightRoundedCorner(a)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:Z.isPreviousConnection(a)&&a instanceof Jr?this.outlinePath_+=a.shape.pathLeft:Z.isHat(a)?this.outlinePath_+=this.constants_.START_HAT.path:Z.isSpacer(a)&&(this.outlinePath_+=Ne("h",a.width));this.outlinePath_+=Ne("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+Ne("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const r=wE(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=Ne("H",t.xPos+t.width)+r+Ne("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var r=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+Ne("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var a=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=Ne("H",r)+t+Ne("v",a)+this.constants_.INSIDE_CORNERS.pathBottom+Ne("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=Ne("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let r=0,a="";for(let h=t.length-1,C;C=t[h];h--)Z.isNextConnection(C)&&C instanceof Jr?a+=C.shape.pathRight:Z.isLeftSquareCorner(C)?a+=Ne("H",e.xPos):Z.isLeftRoundedCorner(C)?a+=this.constants_.OUTSIDE_CORNERS.bottomLeft:Z.isRightRoundedCorner(C)?(a+=this.constants_.OUTSIDE_CORNERS.bottomRight,r=this.constants_.OUTSIDE_CORNERS.rightHeight):Z.isSpacer(C)&&(a+=Ne("h",-1*C.width));this.outlinePath_+=Ne("V",e.baseline-r),this.outlinePath_+=a}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=wE(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=Ne("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e=0,t;t=this.info_.rows[e];e++)for(let r=0,a;a=t.elements[r];r++)Z.isInlineInput(a)?this.drawInlineInput_(a):(Z.isIcon(a)||Z.isField(a))&&this.layoutField_(a)}layoutField_(e){const t=Z.isField(e)?e.field.getSvgRoot():e.icon.iconGroup_,r=e.centerline-e.height/2;let a=e.xPos,h="";this.info_.RTL&&(a=-(a+e.width),e.flipRtl&&(a+=e.width,h="scale(-1 1)")),Z.isIcon(e)?(t.setAttribute("display","block"),t.setAttribute("transform","translate("+a+","+r+")"),e.icon.computeIconLocation()):t.setAttribute("transform","translate("+a+","+r+")"+h),this.info_.isInsertionMarker&&t.setAttribute("display","none")}drawInlineInput_(e){const t=e.width,r=e.height,a=e.connectionOffsetY,h=e.connectionHeight+a;this.inlinePath_+=Fs(e.xPos+e.connectionWidth,e.centerline-r/2)+Ne("v",a)+e.shape.pathDown+Ne("v",r-h)+Ne("h",t-e.connectionWidth)+Ne("v",-r)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-r:r,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}},ia=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new ab(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new b_(this.constants_),this.bottomRow=new g_(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new E_(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let r=0,a;a=t[r];r++){const h=new nb(this.constants_,a);this.isCollapsed&&a.collapseHidden?this.hiddenIcons.push(h):e.elements.push(h)}t=void 0;for(let r=0,a;a=this.block_.inputList[r];r++)if(a.isVisible()){this.shouldStartNewRow_(a,t)&&(this.rows.push(e),e=new E_(this.constants_),this.inputRows.push(e));for(let h=0,C;C=a.fieldRow[h];h++)e.elements.push(new Zr(this.constants_,C,a));this.addInput_(a,e),t=a}this.isCollapsed&&(e.hasJaggedEdge=true,e.elements.push(new rb(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let r=this.topRow.hasLeftSquareCorner(this.block_)?$l:Sl;this.topRow.elements.push(new r(this.constants_)),t?(e=new f_(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=true,this.topRow.connection=new lb(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0].type===rt.STATEMENT&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,r=this.topRow.hasRightSquareCorner(this.block_)?$l:Sl,this.topRow.elements.push(new r(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===rt.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new $l(this.constants_)):this.bottomRow.elements.push(new Sl(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new ob(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new $l(this.constants_,"right")):this.bottomRow.elements.push(new Sl(this.constants_,"right"))}addInput_(e,t){this.isInline&&e.type===rt.VALUE?(t.elements.push(new m_(this.constants_,e)),t.hasInlineInput=true):e.type===rt.STATEMENT?(t.elements.push(new Tl(this.constants_,e)),t.hasStatement=true):e.type===rt.VALUE?(t.elements.push(new vu(this.constants_,e)),t.hasExternalInput=true):e.type===rt.DUMMY&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=true),t.align===null&&(t.align=e.align)}shouldStartNewRow_(e,t){return t?e.type===rt.STATEMENT||t.type===rt.STATEMENT?true:e.type===rt.VALUE||e.type===rt.DUMMY?!this.isInline:false:false}addElemSpacing_(){for(let e=0,t;t=this.rows[e];e++){const r=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new bi(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let a=0;a<r.length-1;a++){t.elements.push(r[a]);const h=this.getInRowSpacing_(r[a],r[a+1]);t.elements.push(new bi(this.constants_,h))}t.elements.push(r[r.length-1]),t.endsWithElemSpacer()&&t.elements.push(new bi(this.constants_,this.getInRowSpacing_(r[r.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&Z.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&Z.isInput(e)&&!t){if(Z.isExternalInput(e))return this.constants_.NO_PADDING;if(Z.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Z.isStatementInput(e))return this.constants_.NO_PADDING}return e&&Z.isLeftSquareCorner(e)&&t&&(Z.isPreviousConnection(t)||Z.isNextConnection(t))?t.notchOffset:e&&Z.isLeftRoundedCorner(e)&&t&&(Z.isPreviousConnection(t)||Z.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,r=0;for(let h=0,C;C=this.rows[h];h++){if(C.measure(),t=Math.max(t,C.width),C.hasStatement){var a=C.getLastInput();let D,Y;a=C.width-((Y=(D=a)==null?void 0:D.width)!=null?Y:0),e=Math.max(e,a)}r=Math.max(r,C.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let h=0,C;C=this.rows[h];h++)C.hasStatement&&(C.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,r),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t=0,r;r=this.rows[t];t++)if(r.hasStatement)this.alignStatementRow_(r);else{var e=r.width;e=this.getDesiredRowWidth_(r)-e,0<e&&this.addAlignmentPadding_(r,e),Z.isTopOrBottomRow(r)&&(r.widthWithConnectedBlocks=r.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const r=e.getFirstSpacer(),a=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===i.Align$$module$build$src$core$input.LEFT&&a)a.width+=t;else if(e.align===i.Align$$module$build$src$core$input.CENTRE&&r&&a)r.width+=t/2,a.width+=t/2;else if(e.align===i.Align$$module$build$src$core$input.RIGHT&&r)r.width+=t;else if(a)a.width+=t;else return;e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var r=e.width-t.width,a=this.statementEdge;r=a-r,0<r&&this.addAlignmentPadding_(e,r),r=e.width,a=this.getDesiredRowWidth_(e),t.width+=a-r,t.height=Math.max(t.height,e.height),e.width+=a-r,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var r=this.getSpacerRowHeight_(e,t);const a=this.getSpacerRowWidth_(e,t);return r=new v_(this.constants_,r,a),e.hasStatement&&(r.followsStatement=true),t.hasStatement&&(r.precedesStatement=true),r}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return Z.isSpacer(t)?e.yPos+t.height/2:Z.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,Z.isNextConnection(t)?e+t.height/2:e-t.height/2):Z.isTopRow(e)?Z.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let r=0,a;a=e.elements[r];r++)Z.isSpacer(a)&&(a.height=e.height),a.xPos=t,a.centerline=this.getElemCenterline_(e,a),t+=a.width}finalize_(){let e=0,t=0;for(let r=0,a;a=this.rows[r];r++)a.yPos=t,a.xPos=this.startX,t+=a.height,e=Math.max(e,a.widthWithConnectedBlocks),this.recordElemPositions_(a);if(this.outputConnection&&this.block_.nextConnection){const r=this.block_.nextConnection.targetBlock();r&&(e=Math.max(e,r.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}},T_=class extends Zi{constructor(e,t,r,a){let h=e?e.workspace.id:void 0;a&&a.getType()===ge.types.WORKSPACE&&(h=a.getLocation().id),super(h),this.type=za,this.blockId=e==null?void 0:e.id,this.oldNode=r||void 0,this.newNode=a,this.isCursor=t}toJson(){const e=super.toJson();if(this.isCursor===void 0)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e}fromJson(e){o("Blockly.Events.MarkerMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isCursor=e.isCursor,this.blockId=e.blockId,this.oldNode=e.oldNode,this.newNode=e.newNode}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new T_),t.isCursor=e.isCursor,t.blockId=e.blockId,t.oldNode=e.oldNode,t.newNode=e.newNode,t}};ye(Se.EVENT,za,T_);var NO="blocklyCursor",MO="blocklyMarker",DO=.75,S_=class{constructor(e,t,r){this.workspace=e,this.marker=r,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent_=null,this.constants_=t,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=r.colour||e}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return this.marker.type==="cursor"}createDom(){const e=this.isCursor()?NO:MO;return this.svgGroup_=H(Q.G,{class:e}),this.createDomInternal_(),this.svgGroup_}setParent_(e){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent_=e}draw(e,t){if(t){this.constants_=this.workspace.getRenderer().getConstants();var r=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||r,this.applyColour_(t),this.showAtLocation_(t),this.fireMarkerEvent_(e,t),e=this.currentMarkerSvg.childNodes[0],e!==void 0&&e.beginElement&&e.beginElement()}else this.hide()}showAtLocation_(e){const t=e.getLocation().type;e.getType()===ge.types.BLOCK?this.showWithBlock_(e):e.getType()===ge.types.OUTPUT?this.showWithOutput_(e):t===Le.INPUT_VALUE?this.showWithInput_(e):t===Le.NEXT_STATEMENT?this.showWithNext_(e):e.getType()===ge.types.PREVIOUS?this.showWithPrevious_(e):e.getType()===ge.types.FIELD?this.showWithField_(e):e.getType()===ge.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()===ge.types.STACK&&this.showWithStack_(e)}showWithBlockPrevOutput_(e){e=e.getSourceBlock();const t=e.width;var r=e.height,a=r*DO;const h=this.constants_.CURSOR_BLOCK_PADDING;e.previousConnection?(r=this.constants_.shapeFor(e.previousConnection),this.positionPrevious_(t,h,a,r)):e.outputConnection?(a=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(t,r,a)):this.positionBlock_(t,h,a),this.setParent_(e),this.showCurrent_()}showWithBlock_(e){this.showWithBlockPrevOutput_(e)}showWithPrevious_(e){this.showWithBlockPrevOutput_(e)}showWithOutput_(e){this.showWithBlockPrevOutput_(e)}showWithCoordinates_(e){var t=e.getWsCoordinate();e=t.x,t=t.y,this.workspace.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,t,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(e){e=e.getLocation();const t=e.getSize().width,r=e.getSize().height;this.positionRect_(0,0,t,r),this.setParent_(e),this.showCurrent_()}showWithInput_(e){e=e.getLocation();const t=e.getSourceBlock();this.positionInput_(e),this.setParent_(t),this.showCurrent_()}showWithNext_(e){var t=e.getLocation();e=t.getSourceBlock();let r=0;t=t.getOffsetInBlock().y;const a=e.getHeightWidth().width;this.workspace.RTL&&(r=-a),this.positionLine_(r,t,a),this.setParent_(e),this.showCurrent_()}showWithStack_(e){e=e.getLocation();var t=e.getHeightWidth();const r=t.width+this.constants_.CURSOR_STACK_PADDING;t=t.height+this.constants_.CURSOR_STACK_PADDING;const a=-this.constants_.CURSOR_STACK_PADDING/2,h=-this.constants_.CURSOR_STACK_PADDING/2;let C=a;this.workspace.RTL&&(C=-(r+a)),this.positionRect_(C,h,r,t),this.setParent_(e),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(e,t,r){if(e=Wt(-t,r)+Ne("V",-t)+Ne("H",e+2*t)+Ne("V",r),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(e){const t=e.getOffsetInBlock().x,r=e.getOffsetInBlock().y;e=Fs(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+t+","+r+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(e,t,r){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${e}`),this.markerSvgLine_.setAttribute("y",`${t}`),this.markerSvgLine_.setAttribute("width",`${r}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(e,t,r){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");e=Wt(e,0)+Ne("h",-(e-r.width))+Ne("v",this.constants_.TAB_OFFSET_FROM_TOP)+r.pathDown+Ne("V",t)+Ne("H",e),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(e,t,r,a){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");e=Wt(-t,r)+Ne("V",-t)+Ne("H",this.constants_.NOTCH_OFFSET_LEFT)+a.pathLeft+Ne("H",e+2*t)+Ne("V",r),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(e,t,r,a){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${e}`),this.markerSvgRect_.setAttribute("y",`${t}`),this.markerSvgRect_.setAttribute("width",`${r}`),this.markerSvgRect_.setAttribute("height",`${a}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl_(e){e.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent_(e,t){const r=t.getSourceBlock();e=new(Te(za))(r,this.isCursor(),e,t),Pe(e)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=H(Q.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=H(Q.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=H(Q.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=H(Q.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=H(Q.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){const e=this.getBlinkProperties_();H(Q.ANIMATE,e,this.markerSvgLine_),H(Q.ANIMATE,e,this.markerInput_),H(Q.ANIMATE,Object.assign({},e,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(e){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(e=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",e),this.markerInput_.firstElementChild.setAttribute("values",e),this.markerBlock_.firstElementChild.setAttribute("values",e))}dispose(){this.svgGroup_&&x(this.svgGroup_)}},bu=class{constructor(e,t,r){this.markerSvg=this.cursorSvg=null,this.constants=r,this.style=t,this.svgRoot=e,this.svgPath=H(Q.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?ne(this.svgRoot,e):de(this.svgRoot,e))}updateHighlighted(e){e?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}},ub="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",Si=class{constructor(e){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=false,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,P(e),this.topBlock=e,this.workspace=e.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections()}dispose(){this.availableConnections.length=0,Jt();try{this.firstMarker&&this.firstMarker.dispose(),this.lastMarker&&this.lastMarker.dispose()}finally{Zt()}}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){Jt(),this.hidePreview(),Zt();var{local:e,closest:t}=this.activeCandidate;if(e.connect(t),this.topBlock.rendered){const r=e.isSuperior()?t:e;aE(r.getSourceBlock()),this.topBlock.getRootBlock().bringToFront()}}}update(e,t){const r=this.getCandidate(e);((this.wouldDeleteBlock=this.shouldDelete(!!r,t))||this.shouldUpdatePreviews(r,e))&&(Jt(),this.maybeHidePreview(r),this.maybeShowPreview(r),Zt())}createMarkerBlock(e){var t=e.type;Jt();let r;try{if(r=this.workspace.newBlock(t),r.setInsertionMarker(true),e.saveExtraState){var a=e.saveExtraState();a&&r.loadExtraState&&r.loadExtraState(a)}else if(e.mutationToDom){const h=e.mutationToDom();h&&r.domToMutation&&r.domToMutation(h)}for(t=0;t<e.inputList.length;t++){const h=e.inputList[t];if(h.name===ul)continue;const C=r.inputList[t];if(!C)throw Error(ub.replace("%1","an input"));for(a=0;a<h.fieldRow.length;a++){const D=h.fieldRow[a],Y=C.fieldRow[a];if(!Y)throw Error(ub.replace("%1","a field"));Y.setValue(D.getValue())}}r.setCollapsed(e.isCollapsed()),r.setInputsInline(e.getInputsInline()),r.initSvg(),r.getSvgRoot().setAttribute("visibility","hidden")}finally{Zt()}return r}initAvailableConnections(){const e=this.topBlock.getConnections_(false),t=this.topBlock.lastConnectionInStack(true);if(t&&t!==this.topBlock.nextConnection){if(e.push(t),this.lastOnStack=t,this.lastMarker){Jt();try{this.lastMarker.dispose()}finally{Zt()}}this.lastMarker=this.createMarkerBlock(t.getSourceBlock())}return e}shouldUpdatePreviews(e,t){if(!e)return!!this.activeCandidate;if(!this.activeCandidate)return true;const{local:r,closest:a}=this.activeCandidate;if(a===e.closest&&r===e.local)return false;const h=r.x+t.x-a.x;return t=r.y+t.y-a.y,e.radius<Math.sqrt(h*h+t*t)-i.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(e){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let t=this.getStartRadius(),r=null;for(let a=0;a<this.availableConnections.length;a++){const h=this.availableConnections[a],C=h.closest(t,e);C.connection&&(r={closest:C.connection,local:h,radius:C.radius},t=C.radius)}return r}getStartRadius(){return this.activeCandidate?i.config$$module$build$src$core$config.connectingSnapRadius:i.config$$module$build$src$core$config.snapRadius}shouldDelete(e,t){return t&&this.workspace.getComponentManager().hasCapability(t.id,ys.Capability.DELETE_AREA)?t.wouldDelete(this.topBlock,e):false}maybeShowPreview(e){if(!this.wouldDeleteBlock&&e){var t=e.closest,r;t===((r=this.activeCandidate)==null?void 0:r.closest)||t.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=e,this.showPreview(this.activeCandidate))}}showPreview(e){const t=this.workspace.getRenderer();switch(t.getConnectionPreviewMethod(e.closest,e.local,this.topBlock)){case Si.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(e);break;case Si.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(e);break;case Si.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(e)}t.shouldHighlightConnection(e.closest)&&e.closest.highlight()}maybeHidePreview(e){if(!e)this.hidePreview();else if(this.activeCandidate){const t=this.activeCandidate.local!==e.local;(this.activeCandidate.closest!==e.closest||t||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let e;const t=(e=this.activeCandidate)==null?void 0:e.closest;t&&t.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(t)&&t.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(e){const{local:t,closest:r}=e;let a=(e=this.lastOnStack&&t===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!a)throw Error("Cannot show the insertion marker because there is no insertion marker block");let h;try{h=a.getMatchingConnection(t.getSourceBlock(),t)}catch{if(this.firstMarker=this.createMarkerBlock(this.topBlock),a=e?this.lastMarker:this.firstMarker,!a)throw Error("Cannot show the insertion marker because there is no insertion marker block");h=a.getMatchingConnection(t.getSourceBlock(),t)}if(!h)throw Error("Cannot show the insertion marker because there is no associated connection");if(h===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");a.render(),a.rendered=true,a.getSvgRoot().setAttribute("visibility","visible"),h&&r&&a.positionNearConnection(h,r),r&&h.connect(r),this.markerConnection=h}hideInsertionMarker(){if(this.markerConnection){var e=this.markerConnection,t=e.getSourceBlock(),r=t.previousConnection,a=t.outputConnection,h=e===t.nextConnection;if(a=e.type===Le.INPUT_VALUE&&!(a&&a.targetConnection),h&&(!r||!r.targetConnection)||a?e.targetBlock().unplug(false):e.type!==Le.NEXT_STATEMENT||h?t.unplug(true):((h=e.targetConnection)&&h.getSourceBlock().unplug(false),r=r?r.targetConnection:null,t.unplug(true),r&&h&&r.connect(h)),e.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(e=t.getSvgRoot())&&e.setAttribute("visibility","hidden")}}showInsertionInputOutline(e){e=e.closest,this.highlightedBlock=e.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(e,true)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,false),this.highlightedBlock=null}}showReplacementFade(e){if(this.fadedBlock=e.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(true)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(false),this.fadedBlock=null)}getInsertionMarkers(){const e=[];return this.firstMarker&&e.push(this.firstMarker),this.lastMarker&&e.push(this.lastMarker),e}};(function(e){e=e.PREVIEW_TYPE||(e.PREVIEW_TYPE={}),e[e.INSERTION_MARKER=0]="INSERTION_MARKER",e[e.INPUT_OUTLINE=1]="INPUT_OUTLINE",e[e.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"})(Si||(Si={})),Si.PREVIEW_TYPE;var Il=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName())}refreshDom(e,t){const r=this.getConstants();r.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=r.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new yl}makeRenderInfo_(e){return new ia(this,e)}makeDrawer_(e,t){return new Rl(e,t)}makeDebugger_(){return new Ti(this.getConstants())}makeMarkerDrawer(e,t){return new S_(e,this.getConstants(),t)}makePathObject(e,t){return new bu(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return true}orphanCanConnectAtEnd(e,t,r){return!!St.getConnectionForOrphanedConnection(e,r===Le.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}getConnectionPreviewMethod(e,t,r){return t.type===Le.OUTPUT_VALUE||t.type===Le.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(r,e.targetBlock(),t.type)?Si.PREVIEW_TYPE.INSERTION_MARKER:Si.PREVIEW_TYPE.REPLACEMENT_FADE:Si.PREVIEW_TYPE.INSERTION_MARKER}render(e){xc()&&!e.renderingDebugger&&(e.renderingDebugger=this.makeDebugger_());const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},yt={};yt.BottomRow=g_,yt.Connection=Jr,yt.ConstantProvider=yl,yt.Debug=Ti,yt.Drawer=Rl,yt.ExternalValueInput=vu,yt.Field=Zr,yt.Hat=f_,yt.Icon=nb,yt.InRowSpacer=bi,yt.InlineInput=m_,yt.InputConnection=Wn,yt.InputRow=E_,yt.JaggedEdge=rb,yt.MarkerSvg=S_,yt.Measurable=$n,yt.NextConnection=ob,yt.OutputConnection=ab,yt.PathObject=bu,yt.PreviousConnection=lb,yt.RenderInfo=ia,yt.Renderer=Il,yt.RoundCorner=Sl,yt.Row=bl,yt.SpacerRow=v_,yt.SquareCorner=$l,yt.StatementInput=Tl,yt.TopRow=b_,yt.Types=Z,yt.init=AE,yt.register=Fa,yt.stopDebugger=BC,yt.unregister=xC;var hb=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&de(e,t),(t=this.theme.getClassName())&&ne(e,t));for(let r=0,a;a=this.subscribedWorkspaces_[r];r++)a.refreshTheme();for(const[r,a]of this.componentDB)for(const h of a){e=h.element,t=h.propertyName;const C=this.theme&&this.theme.getComponentStyle(r);e.style[t]=C||""}for(const r of this.subscribedWorkspaces_)r.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces_.push(e)}unsubscribeWorkspace(e){if(!ii(this.subscribedWorkspaces_,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,r){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:r}),t=this.theme&&this.theme.getComponentStyle(t),e.style[r]=t||""}unsubscribe(e){if(e)for(const[t,r]of this.componentDB){for(let a=r.length-1;0<=a;a--)r[a].element===e&&r.splice(a,1);r.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces_=this.theme=this.owner_=null,this.componentDB.clear()}},$_="VARIABLE_DYNAMIC",_r={};_r.CATEGORY_NAME=$_,_r.flyoutCategory=id,_r.flyoutCategoryBlocks=DE,_r.onCreateVariableButtonClick_Colour=ME,_r.onCreateVariableButtonClick_Number=NE,_r.onCreateVariableButtonClick_String=LE;var db=class{canConnect(e,t,r,a){return this.canConnectWithReason(e,t,r,a)===St.CAN_CONNECT}canConnectWithReason(e,t,r,a){const h=this.doSafetyChecks(e,t);return h!==St.CAN_CONNECT?h:this.doTypeChecks(e,t)?r&&!this.doDragChecks(e,t,a||0)?St.REASON_DRAG_CHECKS_FAILED:St.CAN_CONNECT:St.REASON_CHECKS_FAILED}getErrorMessage(e,t,r){switch(e){case St.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case St.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case St.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case St.REASON_TARGET_NULL:return"Target connection is null.";case St.REASON_CHECKS_FAILED:return"Connection checks failed. "+(t+" expected "+t.getCheck()+", found "+r.getCheck());case St.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case St.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case St.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return St.REASON_TARGET_NULL;let r,a,h;return e.isSuperior()?(r=e.getSourceBlock(),a=t.getSourceBlock(),h=t):(a=e.getSourceBlock(),r=t.getSourceBlock(),h=e,e=t),r===a?St.REASON_SELF_CONNECTION:h.type!==Yr[e.type]?St.REASON_WRONG_TYPE:r.workspace!==a.workspace?St.REASON_DIFFERENT_WORKSPACES:r.isShadow()&&!a.isShadow()?St.REASON_SHADOW_PARENT:h.type===Le.OUTPUT_VALUE&&a.previousConnection&&a.previousConnection.isConnected()||h.type===Le.PREVIOUS_STATEMENT&&a.outputConnection&&a.outputConnection.isConnected()?St.REASON_PREVIOUS_AND_OUTPUT:St.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return true;for(let r=0;r<e.length;r++)if(t.indexOf(e[r])!==-1)return true;return false}doDragChecks(e,t,r){if(e.distanceFrom(t)>r||t.getSourceBlock().isInsertionMarker())return false;switch(t.type){case Le.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case Le.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return false;break;case Le.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return false;break;case Le.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection)return false;break;default:return false}return Ur.indexOf(t)===-1}canConnectToPrevious_(e,t){return e.targetConnection||Ur.indexOf(t)!==-1?false:t.targetConnection?(e=t.targetBlock(),e.isInsertionMarker()?!e.getPreviousBlock():false):true}};ye(Se.CONNECTION_CHECKER,Bn,db);var y_=class extends Ja{constructor(e){super(e),this.type=Po,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}fromJson(e){o("Blockly.Events.VarDelete.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.varType=e.varType,this.varName=e.varName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new y_),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.deleteVariableById(this.varId):t.createVariable(this.varName,this.varType,this.varId)}};ye(Se.EVENT,Po,y_);var R_=class extends Ja{constructor(e,t){super(e),this.type=Va,e&&(this.oldName=e.name,this.newName=typeof t>"u"?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}fromJson(e){o("Blockly.Events.VarRename.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldName=e.oldName,this.newName=e.newName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new R_),t.oldName=e.oldName,t.newName=e.newName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");e?t.renameVariableById(this.varId,this.newName):t.renameVariableById(this.varId,this.oldName)}};ye(Se.EVENT,Va,R_);var I_=class{constructor(e){this.workspace=e,this.variableMap=new Map}clear(){this.variableMap.clear()}renameVariable(e,t){if(e.name!==t){var r=this.getVariable(t,e.type),a=this.workspace.getAllBlocks(false);We(true);try{r&&r.getId()!==e.getId()?this.renameVariableWithConflict_(e,t,r,a):this.renameVariableAndUses_(e,t,a)}finally{We(false)}}}renameVariableById(e,t){const r=this.getVariableById(e);if(!r)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(r,t)}renameVariableAndUses_(e,t,r){for(Pe(new(Te(Va))(e,t)),e.name=t,t=0;t<r.length;t++)r[t].updateVarName(e)}renameVariableWithConflict_(e,t,r,a){const h=e.type;for(t!==r.name&&this.renameVariableAndUses_(r,t,a),t=0;t<a.length;t++)a[t].renameVarById(e.getId(),r.getId());Pe(new(Te(Po))(e)),ii(this.variableMap.get(h),e)}createVariable(e,t,r){var a=this.getVariable(e,t);if(a){if(r&&a.getId()!==r)throw Error('Variable "'+e+'" is already in use and its id is "'+a.getId()+'" which conflicts with the passed in id, "'+r+'".');return a}if(r&&this.getVariableById(r))throw Error('Variable id, "'+r+'", is already in use.');return a=r||pi(),t=t||"",a=new Za(this.workspace,e,t,a),e=this.variableMap.get(t)||[],e.push(a),this.variableMap.delete(t),this.variableMap.set(t,e),Pe(new(Te(Hr))(a)),a}deleteVariable(e){const t=e.getId(),r=this.variableMap.get(e.type);if(r){for(let a=0;a<r.length;a++)if(r[a].getId()===t){r.splice(a,1),Pe(new(Te(Po))(e));break}}}deleteVariableById(e){const t=this.getVariableById(e);if(t){var r=t.name;const a=this.getVariableUsesById(e);for(let h=0,C;C=a[h];h++)if(C.type==="procedures_defnoreturn"||C.type==="procedures_defreturn"){e=String(C.getFieldValue("NAME")),r=Ye.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",r).replace("%2",e),Lr(r);return}1<a.length?(r=Ye.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(a.length)).replace("%2",r),Aa(r,h=>{h&&t&&this.deleteVariableInternal(t,a)})):this.deleteVariableInternal(t,a)}else console.warn("Can't delete non-existent variable: "+e)}deleteVariableInternal(e,t){const r=Ft();r||We(true);try{for(let a=0;a<t.length;a++)t[a].dispose(true);this.deleteVariable(e)}finally{r||We(false)}}getVariable(e,t){if(t=this.variableMap.get(t||"")){for(let r=0,a;a=t[r];r++)if(Ui.equals(a.name,e))return a}return null}getVariableById(e){for(const[,t]of this.variableMap)for(const r of t)if(r.getId()===e)return r;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?e.slice():[]}getVariableTypes(e){const t=new Set(this.variableMap.keys());if(e&&e.getPotentialVariableMap())for(const r of e.getPotentialVariableMap().variableMap.keys())t.add(r);return t.has("")||t.add(""),Array.from(t.values())}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(t);return e}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(e=>e.name)}getVariableUsesById(e){const t=[],r=this.workspace.getAllBlocks(false);for(let a=0;a<r.length;a++){const h=r[a].getVarModels();if(h)for(let C=0;C<h.length;C++)h[C].getId()===e&&t.push(r[a])}return t}},zn=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=false,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new ib(this),this.potentialVariableMap=null,this.id=pi(),L(this),this.options=e||new sn({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(si(Se.CONNECTION_CHECKER,this.options,true))(this),this.variableMap=new I_(this)}dispose(){this.listeners.length=0,this.clear(),I(this)}sortObjects_(e,t){return e=e.getRelativeToSurfaceXY(),t=t.getRelativeToSurfaceXY(),e.y+zn.prototype.sortObjects_.offset*e.x-(t.y+zn.prototype.sortObjects_.offset*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!ii(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e){const t=[].concat(this.topBlocks);return e&&1<t.length&&(this.sortObjects_.offset=Math.sin(Ve(zn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){ii(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&(this.sortObjects_.offset=Math.sin(Ve(zn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e.filter(function(r){return!r.isInsertionMarker()})):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!ii(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e){const t=[].concat(this.topComments);return e&&1<t.length&&(this.sortObjects_.offset=Math.sin(Ve(zn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t}getAllBlocks(e){if(e){var t=this.getTopBlocks(true);e=[];for(let r=0;r<t.length;r++)e.push(...t[r].getDescendants(true))}else for(e=this.getTopBlocks(false),t=0;t<e.length;t++)e.push(...e[t].getChildren(false));return e.filter(function(r){return!r.isInsertionMarker()})}clear(){this.isClearing=true;try{const e=Ft();for(e||We(true);this.topBlocks.length;)this.topBlocks[0].dispose(false);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();e||We(false),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=false}}renameVariableById(e,t){this.variableMap.renameVariableById(e,t)}createVariable(e,t,r){return this.variableMap.createVariable(e,t,r)}getVariableUsesById(e){return this.variableMap.getVariableUsesById(e)}deleteVariableById(e){this.variableMap.deleteVariableById(e)}getVariable(e,t){return this.variableMap.getVariable(e,t)}getVariableById(e){return this.variableMap.getVariableById(e)}getVariablesOfType(e){return this.variableMap.getVariablesOfType(e)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(false).length}remainingCapacityOfType(e){return this.options.maxInstances?(this.options.maxInstances[e]!==void 0?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,false).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return true;let t=0;for(const r in e){if(e[r]>this.remainingCapacityOfType(r))return false;t+=e[r]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,r=e?this.undoStack_:this.redoStack_;const a=t.pop();if(a){for(var h=[a];t.length&&a.group&&a.group===t[t.length-1].group;)h.push(t.pop());for(t=0;t<h.length;t++)r.push(h[t]);h=bo(h,e),Ps(false);try{for(r=0;r<h.length;r++)h[r].run(e)}finally{Ps(true)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,Ni()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){ii(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return(t=this.commentDB.get(e))!=null?t:null}allInputsFilled(e){const t=this.getTopBlocks(false);for(let r=0;r<t.length;r++)if(!t[r].allInputsFilled(e))return false;return true}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new I_(this)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}static getById(e){return O(e)}static getAll(){return A()}};zn.SCAN_ANGLE=3;var xO=100,_b=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound_=null}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var r=new globalThis.Audio}catch{return}for(let h=0;h<e.length;h++){const C=e[h],D=C.match(/\.(\w+)$/);if(D&&r.canPlayType("audio/"+D[1])){var a=new globalThis.Audio(C);break}}a&&this.sounds.set(t,a)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(t!==void 0?t.then(e.pause).catch(function(){}):e.pause(),Lo||lv)break}}play(e,t){var r=this.sounds.get(e);r?(e=new Date,this.lastSound_!==null&&e.getTime()-this.lastSound_.getTime()<xO||(this.lastSound_=e,r=Lo||Vc?r:r.cloneNode(),r.volume=t===void 0?1:t,r.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}},pb=class{constructor(e){this.workspace=e,this.id="zoomControls",this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=this.onZoomOutWrapper=this.onZoomInWrapper=this.onZoomResetWrapper=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=false}createDom(){this.svgGroup=H(Q.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[ys.Capability.POSITIONABLE]}),this.initialized=true}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&x(this.svgGroup),this.onZoomResetWrapper&&f(this.onZoomResetWrapper),this.onZoomInWrapper&&f(this.onZoomInWrapper),this.onZoomOutWrapper&&f(this.onZoomOutWrapper)}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new es(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var r=Qh(this.workspace,e),a=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(a+=this.LARGE_SPACING+this.HEIGHT),e=Zh(r,new $s(this.WIDTH,a),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),r=r.vertical,t=ed(e,this.MARGIN_VERTICAL,r===Vn.TOP?dr.DOWN:dr.UP,t),r===Vn.TOP){var h=this.SMALL_SPACING+this.HEIGHT,C;(C=this.zoomInGroup)==null||C.setAttribute("transform","translate(0, "+h+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(h+this.LARGE_SPACING+this.HEIGHT)+")")}else{C=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let Y;(Y=this.zoomInGroup)==null||Y.setAttribute("transform","translate(0, "+C+")"),C=C+this.SMALL_SPACING+this.HEIGHT,(h=this.zoomOutGroup)==null||h.setAttribute("transform","translate(0, "+C+")")}this.top=t.top,this.left=t.left;var D;(D=this.svgGroup)==null||D.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=H(Q.G,{class:"blocklyZoom"},this.svgGroup);const t=H(Q.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);H(Q.RECT,{width:32,height:32},t),H(Q.IMAGE,{width:Ys.width,height:Ys.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(oi,"xlink:href",this.workspace.options.pathToMedia+Ys.url),this.onZoomOutWrapper=E(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1))}createZoomInSvg(e){this.zoomInGroup=H(Q.G,{class:"blocklyZoom"},this.svgGroup);const t=H(Q.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);H(Q.RECT,{width:32,height:32},t),H(Q.IMAGE,{width:Ys.width,height:Ys.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(oi,"xlink:href",this.workspace.options.pathToMedia+Ys.url),this.onZoomInWrapper=E(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),m(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=H(Q.G,{class:"blocklyZoom"},this.svgGroup);const t=H(Q.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);H(Q.RECT,{width:32,height:32},t),H(Q.IMAGE,{width:Ys.width,height:Ys.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(oi,"xlink:href",this.workspace.options.pathToMedia+Ys.url),this.onZoomResetWrapper=E(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),m(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(Te(cr))(null,this.workspace.id,"zoom_controls");Pe(e)}};hs(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var BO=20,rn=class extends zn{constructor(e,t,r){super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=true,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.workspaceDragSurface=this.blockDragSurface=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.isDragSurfaceActive=false,this.inverseScreenCTM=this.targetWorkspace=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=null,this.inverseScreenCTMDirty=true,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=false,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=null,this.metricsManager=new(si(Se.METRICS_MANAGER,e,true))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||rn.setTopLevelWorkspaceMetrics_,this.componentManager=new ys,this.connectionDBList=ta.init(this.connectionChecker),t&&(this.blockDragSurface=t),r&&(this.workspaceDragSurface=r),this.useWorkspaceDragSurface=!!this.workspaceDragSurface,this.audioManager=new _b(e.parentWorkspace),this.grid=this.options.gridPattern?new __(this.options.gridPattern,e.gridOptions):null,this.markerManager=new Qa(this),i.module$build$src$core$variables&&Na&&this.registerToolboxCategoryCallback(nu,Na),_r&&id&&this.registerToolboxCategoryCallback($_,id),i.module$build$src$core$procedures&&sd&&(this.registerToolboxCategoryCallback(Eu,sd),this.addChangeListener(OE)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new hb(this,this.options.theme||du),this.themeManager_.subscribeWorkspace(this);let a;this.renderer=AE(this.options.renderer||"geras",this.getTheme(),(a=this.options.rendererOverrides)!=null?a:void 0),this.cachedParentSvgSize=new $s(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(e){this.markerManager.setCursorSvg(e)}setMarkerSvg(e){this.markerManager.setMarkerSvg(e)}getMarker(e){return this.markerManager?this.markerManager.getMarker(e):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=du),this.themeManager_.setTheme(e)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(false).filter(function(t){return!!t.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(true);const e=new(Te(Ka))(this.getTheme().name,this.id);Pe(e)}updateBlockStyles_(e){for(let t=0,r;r=e[t];t++){const a=r.getStyleName();if(a){const h=r;h.setStyle(a),h.mutator&&h.mutator.updateBlockStyle()}}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=false)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=true}isVisible(){return this.isVisible_}getSvgXY(e){let t=0,r=0,a=1;(ce(this.getCanvas(),e)||ce(this.getBubbleCanvas(),e))&&(a=this.scale);do{const h=mi(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(a=1),t+=h.x*a,r+=h.y*a,e=e.parentNode}while(e&&e!==this.getParentSvg());return new Oe(t,r)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new $s(e.width,e.height)}getOriginOffsetInPixels(){return Tc(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getBlockCanvas(){return this.svgBlockCanvas_}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e){return this.svgGroup_=H(Q.G,{class:"blocklyWorkspace"}),e&&(this.svgBackground_=H(Q.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),e==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=H(Q.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=H(Q.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(E(this.svgGroup_,"pointerdown",this,this.onMouseDown_,false),document.body.addEventListener("wheel",function(){}),E(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(si(Se.TOOLBOX,this.options,true))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=si(Se.CURSOR,this.options))&&this.markerManager.setCursor(new e),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=false,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&x(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&x(e.parentNode)}this.resizeHandlerWrapper&&(f(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null)}addTrashcan(){this.trashcan=rn.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.svgBlockCanvas_)}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new pb(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}addFlyout(e){const t=new sn({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:true}});return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(si(Se.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,true))(t):new(si(Se.FLYOUTS_VERTICAL_TOOLBOX,this.options,true))(t),this.flyout.autoClose=false,this.flyout.getWorkspace().setVisible(true),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(ys.Capability.POSITIONABLE,true),t=this.getMetricsManager().getUiMetrics(),r=[];for(let a=0,h;h=e[a];a++){h.position(t,r);const C=h.getBoundingRectangle();C&&r.push(C)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const e=Lh();Oe.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations_())}getCanvas(){return this.svgBlockCanvas_}setCachedParentSvgSize(e,t){const r=this.getParentSvg();e!=null&&(this.cachedParentSvgSize.width=e,r.setAttribute("data-cached-width",e.toString())),t!=null&&(this.cachedParentSvgSize.height=t,r.setAttribute("data-cached-height",t.toString()))}getBubbleCanvas(){return this.svgBubbleCanvas_}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if(e.tagName==="svg"){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(ls()){var e=this.scale,t=-this.scrollY,r=-this.scrollX;if(!(e===this.oldScale&&1>Math.abs(t-this.oldTop)&&1>Math.abs(r-this.oldLeft))){var a=new(Te(Vr))(t,r,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=r,Pe(a)}}}translate(e,t){if(this.useWorkspaceDragSurface&&this.isDragSurfaceActive){var r;(r=this.workspaceDragSurface)==null||r.translateSurface(e,t)}else r="translate("+e+","+t+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",r),this.svgBubbleCanvas_.setAttribute("transform",r);this.blockDragSurface&&this.blockDragSurface.translateAndScaleGroup(e,t,this.scale),this.grid&&this.grid.moveTo(e,t),this.maybeFireViewportChangeEvent()}resetDragSurface(){if(this.useWorkspaceDragSurface){this.isDragSurfaceActive=false;var e=this.workspaceDragSurface.getSurfaceTranslation();this.workspaceDragSurface.clearAndHide(this.svgGroup_),e="translate("+e.x+","+e.y+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",e),this.svgBubbleCanvas_.setAttribute("transform",e)}}setupDragSurface(){if(this.useWorkspaceDragSurface&&!this.isDragSurfaceActive){this.isDragSurfaceActive=true;var e=this.svgBlockCanvas_.previousSibling,t,r=parseInt((t=this.getParentSvg().getAttribute("width"))!=null?t:"0"),a;t=parseInt((a=this.getParentSvg().getAttribute("height"))!=null?a:"0"),a=mi(this.getCanvas()),this.workspaceDragSurface.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),e,r,t,this.scale),this.workspaceDragSurface.translateSurface(a.x,a.y)}}getBlockDragSurface(){return this.blockDragSurface}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){if(this.isVisible_=e,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox_&&this.toolbox_.setVisible(e),e){e=this.getAllBlocks(false);for(let t=e.length-1;0<=t;t--)e[t].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else this.hideChaff(true)}render(){for(var e=this.getAllBlocks(false),t=e.length-1;0<=t;t--)e[t].render(false);if(this.currentGesture_)for(e=this.currentGesture_.getInsertionMarkers(),t=0;t<e.length;t++)e[t].render(false);this.markerManager.updateMarkers()}highlightBlock(e,t){if(t===void 0){for(let r=0,a;a=this.highlightedBlocks[r];r++)a.setHighlighted(false);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=t===void 0||t)?this.highlightedBlocks.indexOf(e)===-1&&this.highlightedBlocks.push(e):ii(this.highlightedBlocks,e),e.setHighlighted(t))}paste(e){if(!this.rendered||!e.type&&!e.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const t=Ft();return t||We(true),e=e.type?this.pasteBlock_(null,e):e.tagName.toLowerCase()==="comment"?this.pasteWorkspaceComment_(e):this.pasteBlock_(e,null),We(t),e}pasteBlock_(e,t){Jt();let r;try{let a=0,h=0;if(e){r=Co(e,this);let C;a=parseInt((C=e.getAttribute("x"))!=null?C:"0"),this.RTL&&(a=-a);let D;h=parseInt((D=e.getAttribute("y"))!=null?D:"0")}else t&&(r=Br(t,this),a=t.x||10,this.RTL&&(a=this.getWidth()-a),h=t.y||10);if(!isNaN(a)&&!isNaN(h)){let C;do{C=false;const D=this.getAllBlocks(false);for(let Y=0,pe;pe=D[Y];Y++){const ke=pe.getRelativeToSurfaceXY();if(1>=Math.abs(a-ke.x)&&1>=Math.abs(h-ke.y)){C=true;break}}if(!C){const Y=r.getConnections_(false);for(let pe=0,ke;ke=Y[pe];pe++)if(ke.closest(i.config$$module$build$src$core$config.snapRadius,new Oe(a,h)).connection){C=true;break}}C&&(a=this.RTL?a-i.config$$module$build$src$core$config.snapRadius:a+i.config$$module$build$src$core$config.snapRadius,h+=2*i.config$$module$build$src$core$config.snapRadius)}while(C);r.moveTo(new Oe(a,h))}}finally{Zt()}return ls()&&!r.isShadow()&&Pe(new(Te(ws))(r)),r.select(),r}pasteWorkspaceComment_(e){Jt();let t;try{t=Gs.fromXmlRendered(e,this);let r,a=parseInt((r=e.getAttribute("x"))!=null?r:"0"),h,C=parseInt((h=e.getAttribute("y"))!=null?h:"0");isNaN(a)||isNaN(C)||(this.RTL&&(a=-a),t.moveBy(a+50,C+50))}finally{Zt()}return ls()&&vn.fireCreateEvent(t),t.select(),t}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox_&&e.toolbox_.getFlyout()&&e.toolbox_.refreshSelection()}renameVariableById(e,t){super.renameVariableById(e,t),this.refreshToolboxSelection()}deleteVariableById(e){super.deleteVariableById(e),this.refreshToolboxSelection()}createVariable(e,t,r){return e=super.createVariable(e,t,r),this.refreshToolboxSelection(),e}recordDragTargets(){const e=this.componentManager.getComponents(ys.Capability.DRAG_TARGET,true);this.dragTargetAreas=[];for(let t=0,r;r=e[t];t++){const a=r.getClientRect();a&&this.dragTargetAreas.push({component:r,clientRect:a})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t=0,r;r=this.dragTargetAreas[t];t++)if(r.clientRect.contains(e.clientX,e.clientY))return r.component;return null}onMouseDown_(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){e=S(e,this.getParentSvg(),this.getInverseScreenCTM()),e.x/=this.scale,e.y/=this.scale,this.dragDeltaXY=Oe.difference(t,e)}moveDrag(e){return e=S(e,this.getParentSvg(),this.getInverseScreenCTM()),e.x/=this.scale,e.y/=this.scale,Oe.sum(this.dragDeltaXY,e)}isDragging(){return this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel_(e){if(bn.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,r=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||r){var a=R(e);if(_d)var h=e.metaKey;t&&(e.ctrlKey||h||!r)?(a=-a.y/50,t=S(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,a)):(t=this.scrollX-a.x,r=this.scrollY-a.y,e.shiftKey&&!a.x&&(t=this.scrollX-a.y,r=this.scrollY),this.scroll(t,r)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new es(0,0,0,0);const t=e[0].getBoundingRectangle();for(let a=1;a<e.length;a++){var r=e[a];r.isInsertionMarker&&r.isInsertionMarker()||(r=r.getBoundingRectangle(),r.top<t.top&&(t.top=r.top),r.bottom>t.bottom&&(t.bottom=r.bottom),r.left<t.left&&(t.left=r.left),r.right>t.right&&(t.right=r.right))}return t}cleanUp(){this.setResizesEnabled(false),We(true);const e=this.getTopBlocks(true);let t=0;for(let r=0,a;a=e[r];r++){if(!a.isMovable())continue;const h=a.getRelativeToSurfaceXY();a.moveBy(-h.x,t-h.y),a.snapToGrid(),t=a.getRelativeToSurfaceXY().y+a.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}We(false),this.setResizesEnabled(true)}showContextMenu(e){if(!this.options.readOnly&&!this.isFlyout){var t=$t.registry.getContextMenuOptions($t.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(t,e),Mc(e,t,this.RTL)}}updateToolbox(e){if(e=Oc(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Vh(e)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox_.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(B(this),this.setBrowserFocus())}setBrowserFocus(){document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:true})}catch{try{this.getParentSvg().parentElement.setActive()}catch{this.getParentSvg().parentElement.focus({preventScroll:true})}}}zoom(e,t,r){r=Math.pow(this.options.zoomOptions.scaleSpeed,r);const a=this.scale*r;if(this.scale!==a){a>this.options.zoomOptions.maxScale?r=this.options.zoomOptions.maxScale/this.scale:a<this.options.zoomOptions.minScale&&(r=this.options.zoomOptions.minScale/this.scale);var h=this.getCanvas().getCTM(),C=this.getParentSvg().createSVGPoint();C.x=e,C.y=t,C=C.matrixTransform(h.inverse()),e=C.x,t=C.y,h=h.translate(e*(1-r),t*(1-r)).scale(r),this.scrollX=h.e,this.scrollY=h.f,this.setScale(a)}}zoomCenter(e){var t=this.getMetrics();let r;this.flyout?(r=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(r=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(r,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var r=this.getBlocksBoundingBox(),a=2*BO,h=r.right-r.left+a;if(r=r.bottom-r.top+a,h){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),r+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),h+=this.flyout.getWidth()/this.scale)),t/=h,e/=r,Jt();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{Zt()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){ne(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),ne(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}endCanvasTransition(){de(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),de(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,r=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,r=-r-e.scrollTop,this.scroll(t,r)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e){if(this.isMovable()){if(e=e?this.getBlockById(e):null){var t=e.getRelativeToSurfaceXY(),r=e.getHeightWidth(),a=this.scale;e=(t.x+(this.RTL?-1:1)*r.width/2)*a,t=(t.y+r.height/2)*a,r=this.getMetrics(),this.scroll(-(e-r.viewWidth/2),-(t-r.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(false),(e=this.getFlyout(false))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(e,t){this.hideChaff(true);const r=this.getMetrics();e=Math.min(e,-r.scrollLeft),t=Math.min(t,-r.scrollTop);const a=r.scrollTop+Math.max(0,r.scrollHeight-r.viewHeight);e=Math.max(e,-(r.scrollLeft+Math.max(0,r.scrollWidth-r.viewWidth))),t=Math.max(t,-a),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+r.scrollLeft),-(t+r.scrollTop),false),e+=r.absoluteLeft,t+=r.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e){return super.getAllBlocks(e)}getTopBlocks(e){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){ii(this.topBoundedElements,e)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(false),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(true)}registerButtonCallback(e,t){if(typeof t!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return(t=this.flyoutButtonCallbacks.get(e))!=null?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if(typeof t!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){const t=e.type==="pointerdown",r=this.currentGesture_;return r?t&&r.hasStarted()?(console.warn("Tried to start the same gesture twice."),r.cancel(),null):r:t?this.currentGesture_=new bn(e,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e){Dr(),pn(),Ot();const t=!!e;this.getComponentManager().getComponents(ys.Capability.AUTOHIDEABLE,true).forEach(r=>r.autoHide(t))}static setTopLevelWorkspaceMetrics_(e){const t=this.getMetrics();typeof e.x=="number"&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),typeof e.y=="number"&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}},C_={};C_.load=FC,C_.save=UC;var gb=class{constructor(){this.priority=Uv}save(e){const t=[];for(const r of e.getAllVariables())e={name:r.name,id:r.getId()},r.type&&(e.type=r.type),t.push(e);return t.length?t:null}load(e,t){for(const r of e)t.createVariable(r.name,r.type,r.id)}clear(e){e.getVariableMap().clear()}};Yh("variables",new gb);var fb={};fb.VariableSerializer=gb;var mb=class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=Fv}save(e){return e.getProcedureMap().getProcedures().map(t=>nd(t))}load(e,t){const r=t.getProcedureMap();for(const a of e)r.add(od(this.procedureModelClass,this.parameterModelClass,a,t))}clear(e){e.getProcedureMap().clear()}},PO=new mb(vl,sa),Qr={};Qr.ProcedureSerializer=mb,Qr.loadParameter=ad,Qr.loadProcedure=od,Qr.observableProcedureSerializer=PO,Qr.saveParameter=rd,Qr.saveProcedure=nd;var UO={blocks:cl,exceptions:Ko,priorities:_u,procedures:Qr,registry:Xd,variables:fb,workspaces:C_},Eb=class extends yl{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=true,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=true,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter_=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter_&&x(this.selectedGlowFilter_),this.replacementGlowFilter_&&x(this.replacementGlowFilter_)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=Ei("c",[Ge(25,-e),Ge(71,-e),Ge(t,0)]);return{height:e,width:t,path:r}}makeHexagonal(){function e(r,a,h){var C=r/2;return C=C>t?t:C,h=h?-1:1,r=(a?-1:1)*r/2,Nn(-h*C,r)+Nn(h*C,r)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:true,width(r){return r/=2,r>t?t:r},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,false,false)},pathUp(r){return e(r,true,false)},pathRightDown(r){return e(r,false,true)},pathRightUp(r){return e(r,false,true)}}}makeRounded(){function e(a,h,C){const D=a>r?a-r:0;return a=(a>r?r:a)/2,ds("a","0 0,1",a,Ge((h?-1:1)*a,(h?-1:1)*a))+Ne("v",(C?1:-1)*D)+ds("a","0 0,1",a,Ge((h?1:-1)*a,(h?-1:1)*a))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=2*t;return{type:this.SHAPES.ROUND,isDynamic:true,width(a){return a/=2,a>t?t:a},height(a){return a},connectionOffsetY(a){return a/2},connectionOffsetX(a){return-a},pathDown(a){return e(a,false,false)},pathUp(a){return e(a,true,false)},pathRightDown(a){return e(a,false,true)},pathRightUp(a){return e(a,false,true)}}}makeSquared(){function e(r,a,h){return r-=2*t,ds("a","0 0,1",t,Ge((a?-1:1)*t,(a?-1:1)*t))+Ne("v",(h?1:-1)*r)+ds("a","0 0,1",t,Ge((a?1:-1)*t,(a?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:true,width(r){return t},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,false,false)},pathUp(r){return e(r,true,false)},pathRightDown(r){return e(r,false,true)},pathRightUp(r){return e(r,false,true)}}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case Le.INPUT_VALUE:case Le.OUTPUT_VALUE:if(e=e.getSourceBlock().getOutputShape(),e!==null)switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.indexOf("Boolean")!==-1?this.HEXAGONAL:t&&t.indexOf("Number")!==-1?this.ROUNDED:(t&&t.indexOf("String"),this.ROUNDED);case Le.PREVIOUS_STATEMENT:case Le.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(ke){return Ei("c",[Ge(ke*h/2,0),Ge(ke*h*3/4,D/2),Ge(ke*h,D)])+Ba([Ge(ke*h,C)])+Ei("c",[Ge(ke*h/4,D/2),Ge(ke*h/2,D),Ge(ke*h,D)])+Ne("h",ke*a)+Ei("c",[Ge(ke*h/2,0),Ge(ke*h*3/4,-(D/2)),Ge(ke*h,-D)])+Ba([Ge(ke*h,-C)])+Ei("c",[Ge(ke*h/4,-(D/2)),Ge(ke*h/2,-D),Ge(ke*h,-D)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,a=t/3,h=a/3,C=r/2,D=C/2,Y=e(1),pe=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:Y,pathRight:pe}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=ds("a","0 0,0",e,Ge(-e,e)),r=ds("a","0 0,1",e,Ge(-e,e)),a=ds("a","0 0,0",e,Ge(e,e)),h=ds("a","0 0,1",e,Ge(e,e));return{width:e,height:e,pathTop:t,pathBottom:a,rightWidth:e,rightHeight:e,pathTopRight:r,pathBottomRight:h}}generateSecondaryColour_(e){return Oo("#000",e,.15)||e}generateTertiaryColour_(e){return Oo("#000",e,.25)||e}createDom(e,t,r){super.createDom(e,t,r),e=H(Q.DEFS,{},e),t=H(Q.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),H(Q.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),r=H(Q.FECOMPONENTTRANSFER,{result:"outBlur"},t),H(Q.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),H(Q.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),H(Q.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter_=t,e=H(Q.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),H(Q.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=H(Q.FECOMPONENTTRANSFER,{result:"outBlur"},e),H(Q.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),H(Q.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),H(Q.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),H(Q.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter_=e}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text,`,`${e} .blocklyNonEditableText>g>text,`,`${e} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .goog-menuitem,`,`${e}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},vb=class extends Rl{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;if(e.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),e.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&e.flipRTL(),xc()){let t,r;(t=this.block_)==null||(r=t.renderingDebugger)==null||r.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(0>=e.height))if(Z.isSpacer(e)&&(e.precedesStatement||e.followsStatement)){var t=this.constants_.INSIDE_CORNERS.rightHeight;t=e.height-(e.precedesStatement?t:0),this.outlinePath_+=(e.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<t?Ne("V",e.yPos+t):"")+(e.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=Ne("V",e.yPos+e.height)}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=Wt(e.xPos,this.info_.startY),this.outlinePath_+=Ne("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=Ne("V",e.baseline),this.outlinePath_+=Ne("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;if(!e.connectedBlock&&!this.info_.isInsertionMarker){var r=e.width-2*e.connectionWidth;e=Fs(e.xPos+e.connectionWidth,e.centerline-e.height/2)+Ne("h",r)+e.shape.pathRightDown(e.height)+Ne("h",-r)+e.shape.pathUp(e.height)+"z",this.block_.pathObject.setOutlinePath(t,e)}}drawStatementInput_(e){var t=e.getLastInput();const r=t.xPos+t.notchOffset+t.shape.width,a=t.shape.pathRight+Ne("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,h=e.height-2*this.constants_.INSIDE_CORNERS.height;t=this.constants_.INSIDE_CORNERS.pathBottom+Ne("h",t.notchOffset-this.constants_.INSIDE_CORNERS.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=Ne("H",r)+a+Ne("v",h)+t+Ne("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}};i.FieldImage$$module$build$src$core$field_image=class extends pt{constructor(e,t,r,a,h,C,D){if(super(pt.SKIP_SETUP),this.imageElement_=this.clickHandler_=null,this.flipRtl_=this.isDirty_=this.EDITABLE=false,this.altText_="",r=Number(Qt(r)),t=Number(Qt(t)),isNaN(r)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(0>=r||0>=t)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new $s(t,r+i.FieldImage$$module$build$src$core$field_image.Y_PADDING),this.imageHeight_=r,typeof h=="function"&&(this.clickHandler_=h),e!==pt.SKIP_SETUP&&(D?this.configure_(D):(this.flipRtl_=!!C,this.altText_=Qt(a)||""),this.setValue(Qt(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl_=e.flipRtl),e.alt&&(this.altText_=Qt(e.alt))}initView(){this.imageElement_=H(Q.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(oi,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return typeof e!="string"?null:e}doValueUpdate_(e){this.value_=e,this.imageElement_&&this.imageElement_.setAttributeNS(oi,"xlink:href",String(this.value_))}getFlipRtl(){return this.flipRtl_}setAlt(e){e!==this.altText_&&(this.altText_=e||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))}showEditor_(){this.clickHandler_&&this.clickHandler_(this)}setOnClickHandler(e){this.clickHandler_=e}getText_(){return this.altText_}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}},i.FieldImage$$module$build$src$core$field_image.Y_PADDING=1,xi("field_image",i.FieldImage$$module$build$src$core$field_image),i.FieldImage$$module$build$src$core$field_image.prototype.DEFAULT_VALUE="",i.FieldImage$$module$build$src$core$field_image;var Cl=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.spellcheck_=true,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=false,this.onKeyInputWrapper_=this.onKeyDownWrapper_=null,this.fullBlockClickTarget_=false,this.workspace_=null,this.SERIALIZABLE=true,this.CURSOR="text",e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.spellcheck!==void 0&&(this.spellcheck_=e.spellcheck)}initView(){const e=this.getSourceBlock();if(!e)throw new ps;if(this.getConstants().FULL_BLOCK_FIELDS){let t=0,r=0;for(let a=0,h;h=e.inputList[a];a++){for(let C=0;h.fieldRow[C];C++)t++;h.connection&&r++}this.fullBlockClickTarget_=1>=t&&e.outputConnection&&!r}else this.fullBlockClickTarget_=false;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()}doClassValidation_(e){return e==null?null:String(e)}doValueInvalid_(e){this.isBeingEdited_&&(this.isDirty_=true,this.isTextValid_=false,e=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&ls()&&Pe(new(Te(Ts))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=true,this.value_=e}applyColour(){if(this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS){var e=this.sourceBlock_;this.borderRect_?this.borderRect_.setAttribute("stroke",e.style.colourTertiary):e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)}}render_(){if(super.render_(),this.isBeingEdited_){this.resizeEditor_();const e=this.htmlInput_;this.isTextValid_?(de(e,"blocklyInvalidInput"),Xt(e,Gt.INVALID,false)):(ne(e,"blocklyInvalidInput"),Xt(e,Gt.INVALID,true))}}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t){this.workspace_=this.sourceBlock_.workspace,e=t||false,!e&&this.workspace_.options.modalInputs&&(pd||Vc||Lo)?this.showPromptEditor_():this.showInlineEditor_(e)}showPromptEditor_(){La(Ye.CHANGE_VALUE_TITLE,this.getText(),e=>{e!==null&&this.setValue(this.getValueFromEditorText_(e))})}showInlineEditor_(e){const t=this.getSourceBlock();if(!t)throw new ps;Fh(this,t.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=true,e||(this.htmlInput_.focus({preventScroll:true}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new ps;We(true);const t=wo();var r=this.getClickTarget_();if(!r)throw Error("A click target has not been set.");ne(r,"editing"),r=document.createElement("input"),r.className="blocklyHtmlInput",r.setAttribute("spellcheck",this.spellcheck_);const a=this.workspace_.getScale();var h=this.getConstants().FIELD_TEXT_FONTSIZE*a+"pt";return t.style.fontSize=h,r.style.fontSize=h,h=Cl.BORDERRADIUS*a+"px",this.fullBlockClickTarget_&&(h=this.getScaledBBox(),h=(h.bottom-h.top)/2+"px",e=e.getParent()?e.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,r.style.border=1*a+"px solid "+e,t.style.borderRadius=h,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*a+"px")),r.style.borderRadius=h,t.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",this.value_),this.resizeEditor_(),this.bindInputEvents_(r),r}widgetDispose_(){this.isBeingEdited_=false,this.isTextValid_=true,this.forceRerender(),this.onFinishEditing_(this.value_),We(false),this.unbindInputEvents_();var e=wo().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,e=this.getClickTarget_(),!e)throw Error("A click target has not been set.");de(e,"editing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper_=E(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=E(e,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(f(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(f(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(e){e.keyCode===xe.ENTER?(pn(),Ot()):e.keyCode===xe.ESC?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value")),pn(),Ot()):e.keyCode===xe.TAB&&(pn(),Ot(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())}onHtmlInputChange_(e){this.setValue(this.getValueFromEditorText_(this.htmlInput_.value))}setEditorValue_(e){this.isDirty_=true,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e)}resizeEditor_(){var e=this.getSourceBlock();if(!e)throw new ps;const t=wo(),r=this.getScaledBBox();t.style.width=r.right-r.left+"px",t.style.height=r.bottom-r.top+"px",e=new Oe(e.RTL?r.right-t.offsetWidth:r.left,r.top),t.style.left=e.x+"px",t.style.top=e.y+"px"}isTabNavigable(){return true}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return String(e)}getValueFromEditorText_(e){return e}};Cl.BORDERRADIUS=4,i.FieldTextInput$$module$build$src$core$field_textinput=class extends Cl{constructor(e,t,r){super(e,t,r)}static fromJson(e){return new this(Qt(e.text),void 0,e)}},xi("field_input",i.FieldTextInput$$module$build$src$core$field_textinput),i.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",i.FieldTextInput$$module$build$src$core$field_textinput;var bb=class extends g_{constructor(e){super(e)}endsWithElemSpacer(){return false}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Tb=class extends Tl{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=false,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=true)}}},Sb=class extends $n{constructor(e){super(e),this.width=this.height=0,this.type|=Z.getType("RIGHT_CONNECTION")}},$b=class extends b_{constructor(e){super(e)}endsWithElemSpacer(){return false}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},yb=class extends ia{constructor(e,t){super(e,t),this.isInline=true,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new $b(this.constants_),this.bottomRow=new bb(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new Sb(this.constants_):null,this.rightAlignedDummyInputs_=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return t?e.type===rt.STATEMENT||t.type===rt.STATEMENT?true:e.type===rt.VALUE||e.type===rt.DUMMY?!this.isInline||this.isMultiRow:false:false}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&Z.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&Z.isLeftRoundedCorner(e)&&t&&(Z.isPreviousConnection(t)||Z.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&Z.isLeftSquareCorner(e)&&t&&Z.isHat(t)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(Z.isTopRow(e)&&Z.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const r=Z.isInputRow(e)&&e.hasStatement,a=Z.isInputRow(t)&&t.hasStatement;return a||r?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),a&&r?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):Z.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):Z.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const r=this.width-this.startX;return Z.isInputRow(e)&&e.hasStatement||Z.isInputRow(t)&&t.hasStatement?Math.max(r,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):r}getElemCenterline_(e,t){if(e.hasStatement&&!Z.isSpacer(t)&&!Z.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(Z.isInlineInput(t)&&t instanceof Wn){const r=t.connectedBlock;if(r&&r.outputConnection&&r.nextConnection)return e.yPos+r.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if(e.type===rt.DUMMY&&t.hasDummyInput&&t.align===i.Align$$module$build$src$core$input.LEFT&&e.align===i.Align$$module$build$src$core$input.RIGHT)this.rightAlignedDummyInputs_.set(t,e);else if(e.type===rt.STATEMENT){t.elements.push(new Tb(this.constants_,e)),t.hasStatement=true,t.align===null&&(t.align=e.align);return}super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs_.get(e)){let r;for(let a=0;a<e.elements.length;a++){const h=e.elements[a];if(Z.isSpacer(h)&&(r=h),Z.isField(h)&&h instanceof Zr&&h.parentInput===this.rightAlignedDummyInputs_.get(e))break}if(r){r.width+=t,e.width+=t;return}}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let h=2;h<this.rows.length-1;h+=2){var r=this.rows[h-1];const C=this.rows[h];var a=this.rows[h+1];if(r=h===2?!!this.topRow.hasPreviousConnection:!!r.followsStatement,a=h+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!a.precedesStatement,Z.isInputRow(C)&&C.hasStatement){C.measure();let D,Y;t=C.width-((Y=(D=C.getLastInput())==null?void 0:D.width)!=null?Y:0)+e}else if(r&&(h===2||a)&&Z.isInputRow(C)&&!C.hasStatement){a=C.xPos,r=null;for(let D=0;D<C.elements.length;D++){const Y=C.elements[D];Z.isSpacer(Y)&&(r=Y),r&&(Z.isField(Y)||Z.isInput(Y))&&a<t&&!(Z.isField(Y)&&Y instanceof Zr&&(Y.field instanceof i.FieldLabel$$module$build$src$core$field_label||Y.field instanceof i.FieldImage$$module$build$src$core$field_image))&&(r.width+=t-a),a+=Y.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,r=0;r<this.rows.length;r++){const a=this.rows[r];a.yPos=t,t+=a.height}this.height=t,r=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(r),r=e.width(r),this.outputConnection.height=t,this.outputConnection.width=r,this.outputConnection.startX=r,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(r),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=r,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=r,this.width+=r+e,this.widthWithChildren+=r+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var r=this.rows[t];if(!Z.isInputRow(r))continue;e=r.elements[r.elements.length-2];let a=this.getNegativeSpacing_(r.elements[1]),h=this.getNegativeSpacing_(e);e=a+h;const C=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<C&&(e=this.width-C,a=e/2,h=e/2),r.elements.unshift(new bi(this.constants_,-a)),r.elements.push(new bi(this.constants_,-h))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)r=this.rows[t],Z.isTopOrBottomRow(r)&&(r.elements[1].width-=e),r.width-=e,r.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var r=this.outputConnection.shape.type;const a=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)switch(r){case a.SHAPES.ROUND:return r=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=this.height/2>r?r:this.height/2,t-r*(1-Math.sin(Math.acos((r-this.constants_.SMALL_PADDING)/r)));default:return 0}if(Z.isInlineInput(e)&&e instanceof Wn){const h=e.connectedBlock;return e=h?h.pathObject.outputShapeType:e.shape.type,e==null||h&&h.outputConnection&&(h.statementInputCount||h.nextConnection)||r===a.SHAPES.HEXAGONAL&&r!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][e]}return Z.isField(e)&&e instanceof Zr?r===a.SHAPES.ROUND&&e.field instanceof i.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*a.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][0]:Z.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let a=2;a<this.rows.length-1;a+=2){const h=this.rows[a-1],C=this.rows[a],D=this.rows[a+1];var e=a===2,t=a+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!D.precedesStatement;if(e?this.topRow.hasPreviousConnection:h.followsStatement){var r=C.elements[1];if(r=C.elements.length===3&&r instanceof Zr&&(r.field instanceof i.FieldLabel$$module$build$src$core$field_label||r.field instanceof i.FieldImage$$module$build$src$core$field_image),!e&&r)h.height-=this.constants_.SMALL_PADDING,D.height-=this.constants_.SMALL_PADDING,C.height-=this.constants_.MEDIUM_PADDING;else if(!e&&!t)h.height+=this.constants_.SMALL_PADDING;else if(t){for(e=false,t=0;t<C.elements.length;t++)if(r=C.elements[t],r instanceof Wn&&Z.isInlineInput(r)&&r.connectedBlock&&!r.connectedBlock.isShadow()&&40<=r.connectedBlock.getHeightWidth().height){e=true;break}e&&(h.height-=this.constants_.SMALL_PADDING,D.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},Rb=class extends S_{constructor(e,t,r){super(e,t,r),this.markerCircle_=null}showWithInputOutput_(e){const t=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle_(e.x,e.y),this.setParent_(t),this.showCurrent_()}showWithOutput_(e){this.showWithInputOutput_(e)}showWithInput_(e){this.showWithInputOutput_(e)}showWithBlock_(e){e=e.getLocation();const t=e.getHeightWidth();this.positionRect_(0,0,t.width,t.height),this.setParent_(e),this.showCurrent_()}positionCircle_(e,t){let r;(r=this.markerCircle_)==null||r.setAttribute("cx",e.toString());let a;(a=this.markerCircle_)==null||a.setAttribute("cy",t.toString()),this.currentMarkerSvg=this.markerCircle_}hide(){super.hide(),this.markerCircle_&&(this.markerCircle_.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle_=H(Q.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){const e=this.getBlinkProperties_();H(Q.ANIMATE,e,this.markerCircle_)}return this.markerSvg_}applyColour_(e){super.applyColour_(e);let t;(t=this.markerCircle_)==null||t.setAttribute("fill",this.colour_);let r;if((r=this.markerCircle_)==null||r.setAttribute("stroke",this.colour_),this.isCursor()){e=this.colour_+";transparent;transparent;";let a;(a=this.markerCircle_)==null||a.firstElementChild.setAttribute("values",e)}}},Ib=class extends bu{constructor(e,t,r){super(e,t,r),this.svgPathSelected_=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=r}setPath(e){super.setPath(e),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.style.colourTertiary);for(const r of this.outlines.values())r.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(true),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath_(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath_(e);this.remainingOutlines.clear()}setOutlinePath(e,t){e=this.getOutlinePath_(e),e.setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath_(e){return this.outlines.has(e)||this.outlines.set(e,H(Q.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath_(e){let t,r;(t=this.outlines.get(e))==null||(r=t.parentNode)==null||r.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Cb=class extends Il{constructor(e){super(e)}makeConstants_(){return new Eb}makeRenderInfo_(e){return new yb(this,e)}makeDrawer_(e,t){return new vb(e,t)}makeMarkerDrawer(e,t){return new Rb(e,this.getConstants(),t)}makePathObject(e,t){return new Ib(e,t,this.getConstants())}getConstants(){return this.constants_}shouldHighlightConnection(e){return e.type!==Le.INPUT_VALUE&&e.type!==Le.OUTPUT_VALUE}getConnectionPreviewMethod(e,t,r){return t.type===Le.OUTPUT_VALUE?e.isConnected()?Si.PREVIEW_TYPE.REPLACEMENT_FADE:Si.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(e,t,r)}};Fa("zelos",Cb);var on={};on.BottomRow=bb,on.ConstantProvider=Eb,on.Drawer=vb,on.MarkerSvg=Rb,on.PathObject=Ib,on.RenderInfo=yb,on.Renderer=Cb,on.RightConnectionShape=Sb,on.StatementInput=Tb,on.TopRow=$b;var Ob=class extends ia{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=false;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=true;break}for(t=0;t<this.rows.length;t++){const a=this.rows[t];var r=a.elements;if(a.elements=[],a.startsWithElemSpacer()&&a.elements.push(new bi(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let h=0;h<r.length-1;h++){a.elements.push(r[h]);const C=this.getInRowSpacing_(r[h],r[h+1]);a.elements.push(new bi(this.constants_,C))}a.elements.push(r[r.length-1]),a.endsWithElemSpacer()&&(r=this.getInRowSpacing_(r[r.length-1],null),e&&a.hasDummyInput&&(r+=this.constants_.TAB_WIDTH),a.elements.push(new bi(this.constants_,r)))}}}getInRowSpacing_(e,t){if(!e)return t&&Z.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&Z.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&Z.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Z.isInput(e)&&!t)return Z.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:Z.isIcon(e)?2*this.constants_.LARGE_PADDING+1:Z.isHat(e)?this.constants_.NO_PADDING:Z.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:Z.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:Z.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Z.isInput(e)&&!t){if(Z.isExternalInput(e))return this.constants_.NO_PADDING;if(Z.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Z.isStatementInput(e))return this.constants_.NO_PADDING}if(!Z.isInput(e)&&t&&Z.isInput(t)){if(Z.isField(e)&&e.isEditable){if(Z.isInlineInput(t)||Z.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(Z.isInlineInput(t)||Z.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(Z.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Z.isIcon(e)&&t&&!Z.isInput(t))return this.constants_.LARGE_PADDING;if(Z.isInlineInput(e)&&t&&Z.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Z.isLeftSquareCorner(e)&&t){if(Z.isHat(t))return this.constants_.NO_PADDING;if(Z.isPreviousConnection(t)||Z.isNextConnection(t))return t.notchOffset}return Z.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:Z.isField(e)&&t&&Z.isField(t)&&e.isEditable===t.isEditable||t&&Z.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return Z.isTopRow(e)&&Z.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Z.isTopRow(e)||Z.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(Z.isSpacer(t))return e.yPos+t.height/2;if(Z.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,Z.isNextConnection(t)?e+t.height/2:e-t.height/2;if(Z.isTopRow(e))return Z.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return r=Z.isField(t)&&e.hasStatement?r+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):r+e.height/2}finalize_(){let e=0,t=0;for(var r=0;r<this.rows.length;r++){const h=this.rows[r];h.yPos=t,h.xPos=this.startX,t+=h.height,e=Math.max(e,h.widthWithConnectedBlocks);var a=t-this.topRow.ascenderHeight;h===this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(a=this.constants_.MIN_BLOCK_HEIGHT-a,this.bottomRow.height+=a,t+=a),this.recordElemPositions_(h)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},kb=class extends Il{constructor(e){super(e)}makeRenderInfo_(e){return new Ob(this,e)}};Fa("thrasos",kb);var O_={};O_.RenderInfo=Ob,O_.Renderer=kb;var wb=class extends yl{constructor(){super()}},Ab=class extends Rl{constructor(e,t){super(e,t)}},Lb=class extends ia{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}},Nb=class extends Il{constructor(e){super(e)}makeConstants_(){return new wb}makeRenderInfo_(e){return new Lb(this,e)}makeDrawer_(e,t){return new Ab(e,t)}};Fa("minimalist",Nb);var Ol={};Ol.ConstantProvider=wb,Ol.Drawer=Ab,Ol.RenderInfo=Lb,Ol.Renderer=Nb;var Mb=class extends yl{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=false,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},Db=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(e){this.steps_+=Wt(e.xPos,this.info_.startY);for(let t=0,r;r=e.elements[t];t++)Z.isLeftSquareCorner(r)?this.steps_+=this.highlightConstants_.START_POINT:Z.isLeftRoundedCorner(r)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):Z.isPreviousConnection(r)?this.steps_+=this.notchPaths_.pathLeft:Z.isHat(r)?this.steps_+=this.startPaths_.path(this.RTL_):Z.isSpacer(r)&&r.width!==0&&(this.steps_+=Ne("H",r.xPos+r.width-this.highlightOffset_));this.steps_+=Ne("H",e.xPos+e.width-this.highlightOffset_)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+Ne("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset_))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const r=e.height-t.connectionHeight;this.steps_+=Fs(t.xPos+t.width-this.highlightOffset_,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+Ne("v",r)}else this.steps_+=Fs(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const r=e.height-2*this.insideCornerPaths_.height;this.steps_+=Fs(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+Ne("v",r)+this.insideCornerPaths_.pathBottom(this.RTL_)+Nn(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Fs(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Nn(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset_;e instanceof v_&&e.followsStatement&&(this.steps_+=Ne("H",t)),this.RTL_&&(this.steps_+=Ne("H",t),e.height>this.highlightOffset_&&(this.steps_+=Ne("V",e.yPos+e.height-this.highlightOffset_)))}drawBottomRow(e){if(this.RTL_)this.steps_+=Ne("V",e.baseline-this.highlightOffset_);else{const t=this.info_.bottomRow.elements[0];Z.isLeftSquareCorner(t)?this.steps_+=Fs(e.xPos+this.highlightOffset_,e.baseline-this.highlightOffset_):Z.isLeftRoundedCorner(t)&&(this.steps_+=Fs(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=Fs(this.info_.startX,e):(this.steps_+=Fs(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=Ne("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,Z.isLeftRoundedCorner(e.elements[0])?this.steps_+=Ne("V",this.outsideCornerPaths_.height):this.steps_+=Ne("V",e.capline+this.highlightOffset_))}drawInlineInput(e){const t=this.highlightOffset_,r=e.xPos+e.connectionWidth;var a=e.centerline-e.height/2;const h=e.width-e.connectionWidth,C=a+t;this.RTL_?(a=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=Fs(r-t,C)+Ne("v",a)+this.puzzleTabPaths_.pathDown(this.RTL_)+Ne("v",e)+Ne("h",h)):this.inlineSteps_+=Fs(e.xPos+e.width+t,C)+Ne("v",e.height)+Ne("h",-h)+Fs(r,a+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},xb=class extends Rl{constructor(e,t){super(e,t),this.highlighter_=new Db(t)}draw(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();const e=this.block_.pathObject;if(e.setPath(this.outlinePath_+`
`+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),xc()){let t,r;(t=this.block_)==null||(r=t.renderingDebugger)==null||r.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=Ne("H",e.xPos+e.width)+Ne("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;r=this.info_.RTL?-1*r:r+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(r,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-r:r)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},Bb=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=Wt(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e+t)-t,a=Wt(r,r)+ds("a","0 0,0",e,Ge(-r-t,e-r)),h=ds("a","0 0,0",e+t,Ge(e+t,e+t)),C=Wt(r,-r)+ds("a","0 0,0",e+t,Ge(e-r,r+t));return{width:e+t,height:e,pathTop(D){return D?a:""},pathBottom(D){return D?h:C}}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e-t)+t,a=Wt(r,r)+ds("a","0 0,1",e-t,Ge(e-r,-r+t)),h=Wt(t,e)+ds("a","0 0,1",e-t,Ge(e,-e+t)),C=-r,D=Wt(r,C)+ds("a","0 0,1",e-t,Ge(-r+t,-C-e));return{height:e,topLeft(Y){return Y?a:h},bottomLeft(){return D}}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,r=Wt(-2,-t+3.4)+Nn(-.45*e,-2.1),a=Ne("v",2.5)+Wt(.97*-e,2.5)+Ei("q",[Ge(.05*-e,10),Ge(.3*e,9.5)])+Wt(.67*e,-1.9)+Ne("v",2.5),h=Ne("v",-1.5)+Wt(-.92*e,-.5)+Ei("q",[Ge(-.19*e,-5.5),Ge(0,-11)])+Wt(.92*e,1),C=Wt(-5,t-.7)+Nn(.46*e,-2.1);return{width:e,height:t,pathUp(D){return D?r:h},pathDown(D){return D?a:C}}}makeNotch(){return{pathLeft:Ne("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:Nn(5.1,2.6)+Wt(-10.2,6.8)+Nn(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=Wt(25,-8.7)+Ei("c",[Ge(29.7,-6.2),Ge(57.2,-.5),Ge(75,8.7)]),r=Ei("c",[Ge(17.8,-9.2),Ge(45.3,-14.9),Ge(75,-8.7)])+Fs(100.5,e+.5);return{path(a){return a?t:r}}}},Pb=class extends m_{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Ub=class extends Tl{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},Fb=class extends ia{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===rt.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e.type===rt.VALUE?(t.elements.push(new Pb(this.constants_,e)),t.hasInlineInput=true):e.type===rt.STATEMENT?(t.elements.push(new Ub(this.constants_,e)),t.hasStatement=true):e.type===rt.VALUE?(t.elements.push(new vu(this.constants_,e)),t.hasExternalInput=true):e.type===rt.DUMMY&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=true),this.isInline||t.align!==null||(t.align=e.align)}addElemSpacing_(){let e=false;for(let r=0,a;a=this.rows[r];r++)a.hasExternalInput&&(e=true);for(let r=0,a;a=this.rows[r];r++){var t=a.elements;if(a.elements=[],a.startsWithElemSpacer()&&a.elements.push(new bi(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let h=0;h<t.length-1;h++){a.elements.push(t[h]);const C=this.getInRowSpacing_(t[h],t[h+1]);a.elements.push(new bi(this.constants_,C))}a.elements.push(t[t.length-1]),a.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&a.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),a.elements.push(new bi(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&Z.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&Z.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&Z.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Z.isInput(e)&&(!t||Z.isStatementInput(t)))return Z.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:Z.isIcon(e)?2*this.constants_.LARGE_PADDING+1:Z.isHat(e)?this.constants_.NO_PADDING:Z.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:Z.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:Z.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Z.isInput(e)&&!t){if(Z.isExternalInput(e))return this.constants_.NO_PADDING;if(Z.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Z.isStatementInput(e))return this.constants_.NO_PADDING}if(!Z.isInput(e)&&t&&Z.isInput(t)){if(Z.isField(e)&&e.isEditable){if(Z.isInlineInput(t)||Z.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(Z.isInlineInput(t)||Z.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(Z.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Z.isIcon(e)&&t&&!Z.isInput(t))return this.constants_.LARGE_PADDING;if(Z.isInlineInput(e)&&t&&Z.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Z.isLeftSquareCorner(e)&&t){if(Z.isHat(t))return this.constants_.NO_PADDING;if(Z.isPreviousConnection(t))return t.notchOffset;if(Z.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(Z.isLeftRoundedCorner(e)&&t){if(Z.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(Z.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return Z.isField(e)&&t&&Z.isField(t)&&e.isEditable===t.isEditable||t&&Z.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return Z.isTopRow(e)&&Z.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Z.isTopRow(e)||Z.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(Z.isSpacer(t))return e.yPos+t.height/2;if(Z.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,Z.isNextConnection(t)?e+t.height/2:e-t.height/2;if(Z.isTopRow(e))return Z.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return Z.isField(t)||Z.isIcon(t)?(r+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(r+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):r=Z.isInlineInput(t)?r+t.height/2:r+e.height/2,r}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,r=null;for(let a=this.rows.length-1,h;h=this.rows[a];a--)t.set(h,e),Z.isInputRow(h)&&(h.hasStatement&&this.alignStatementRow_(h),r&&r.hasStatement&&h.width<r.width?t.set(h,r.width):e=h.width,r=h);e=0;for(let a=0,h;h=this.rows[a];a++)h.hasStatement?e=this.getDesiredRowWidth_(h):Z.isSpacer(h)?h.width=Math.max(e,t.get(h)):(r=h.width,e=Math.max(e,t.get(h))-r,0<e&&this.addAlignmentPadding_(h,e),e=h.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let a=0,h;h=this.rows[a];a++){h.yPos=t,h.xPos=this.startX,t+=h.height,e=Math.max(e,h.widthWithConnectedBlocks);var r=t-this.topRow.ascenderHeight;h===this.bottomRow&&r<this.constants_.MIN_BLOCK_HEIGHT&&(r=this.constants_.MIN_BLOCK_HEIGHT-r,this.bottomRow.height+=r,t+=r),this.recordElemPositions_(h)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},Gb=class extends bu{constructor(e,t,r){super(e,t,r),this.constants=r,this.colourDark="#000000",this.svgPathDark=H(Q.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=H(Q.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Oo("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},Hb=class extends Il{constructor(e){super(e),this.highlightConstants_=null}init(e,t){super.init(e,t),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()}refreshDom(e,t){super.refreshDom(e,t),this.getHighlightConstants().init()}makeConstants_(){return new Mb}makeRenderInfo_(e){return new Fb(this,e)}makeDrawer_(e,t){return new xb(e,t)}makePathObject(e,t){return new Gb(e,t,this.getConstants())}makeHighlightConstants_(){return new Bb(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants_)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants_}};Fa("geras",Hb);var yn={};yn.ConstantProvider=Mb,yn.Drawer=xb,yn.HighlightConstantProvider=Bb,yn.Highlighter=Db,yn.InlineInput=Pb,yn.PathObject=Gb,yn.RenderInfo=Fb,yn.Renderer=Hb,yn.StatementInput=Ub;var Vb=class{constructor(e){this.container=e,this.previousSibling=null,this.createDom()}createDom(){this.SVG||(this.SVG=H(Q.SVG,{xmlns:Mo,"xmlns:html":Yi,"xmlns:xlink":oi,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"}),this.container.appendChild(this.SVG))}translateSurface(e,t){e=Math.round(e),t=Math.round(t),this.SVG.style.display="block",ae(this.SVG,"translate3d("+e+"px, "+t+"px, 0)")}getSurfaceTranslation(){return mi(this.SVG)}clearAndHide(e){if(!e)throw Error("Couldn't clear and hide the drag surface: missing new surface.");const t=this.SVG.childNodes[0],r=this.SVG.childNodes[1];if(!t||!r||!t.classList.contains("blocklyBlockCanvas")&&r.classList.contains("blocklyBubbleCanvas"))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(this.previousSibling!==null?te(t,this.previousSibling):e.insertBefore(t,e.firstChild),te(r,t),this.SVG.style.display="none",this.SVG.childNodes.length)throw Error("Drag surface was not cleared.");ae(this.SVG,""),this.previousSibling=null}setContentsAndShow(e,t,r,a,h,C){if(this.SVG.childNodes.length)throw Error("Already dragging a block.");this.previousSibling=r,e.setAttribute("transform","translate(0, 0) scale("+C+")"),t.setAttribute("transform","translate(0, 0) scale("+C+")"),this.SVG.setAttribute("width",String(a)),this.SVG.setAttribute("height",String(h)),this.SVG.appendChild(e),this.SVG.appendChild(t),this.SVG.style.display="block"}},Wb=class{constructor(e){this.container=e,this.scale=1,this.surfaceXY=new Oe(0,0),this.childSurfaceXY=new Oe(0,0),this.svg=H(Q.SVG,{xmlns:Mo,"xmlns:html":Yi,"xmlns:xlink":oi,version:"1.1",class:"blocklyBlockDragSurface"},this.container),this.dragGroup=H(Q.G,{},this.svg)}createDom(){o("BlockDragSurfaceSvg createDom","June 2022","June 2023")}setBlocksAndShow(e){if(this.dragGroup.childNodes.length)throw Error("Already dragging a block.");this.dragGroup.appendChild(e),this.svg.style.display="block",this.surfaceXY=new Oe(0,0)}translateAndScaleGroup(e,t,r){this.scale=r,e=Math.round(e),t=Math.round(t),this.childSurfaceXY.x=e,this.childSurfaceXY.y=t,this.dragGroup.setAttribute("transform","translate("+e+","+t+") scale("+r+")")}translateSurfaceInternal_(){const e=Math.round(this.surfaceXY.x),t=Math.round(this.surfaceXY.y);this.svg.style.display="block",ae(this.svg,"translate3d("+e+"px, "+t+"px, 0)")}translateBy(e,t){this.surfaceXY=new Oe(this.surfaceXY.x+e,this.surfaceXY.y+t),this.translateSurfaceInternal_()}translateSurface(e,t){this.surfaceXY=new Oe(e*this.scale,t*this.scale),this.translateSurfaceInternal_()}getSurfaceTranslation(){const e=mi(this.svg);return new Oe(e.x/this.scale,e.y/this.scale)}getGroup(){return this.dragGroup}getSvgRoot(){return this.svg}getCurrentBlock(){return this.dragGroup.firstChild}getWsTranslation(){return this.childSurfaceXY.clone()}clearAndHide(e){const t=this.getCurrentBlock();if(t&&(e?e.appendChild(t):this.dragGroup.removeChild(t)),this.svg.style.display="none",this.dragGroup.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY=new Oe(0,0)}},Tu={};Tu.bumpIntoBounds=Bc,Tu.bumpIntoBoundsHandler=xE,Tu.bumpTopObjectsIntoBounds=ld;var k_=class{constructor(e,t,r,a,h){this.workspace=e,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,t=t===void 0?true:t,r=r===void 0?true:r;const C=t&&r;t&&(this.hScroll=new Kt(e,true,C,a,h)),r&&(this.vScroll=new Kt(e,false,C,a,h)),C&&(this.corner_=H(Q.RECT,{height:Kt.scrollbarThickness,width:Kt.scrollbarThickness,class:"blocklyScrollbarBackground"}),te(this.corner_,e.getBubbleCanvas()))}dispose(){x(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=false,r=false;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===e.viewWidth&&this.oldHostMetrics_.viewHeight===e.viewHeight&&this.oldHostMetrics_.absoluteTop===e.absoluteTop&&this.oldHostMetrics_.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===e.scrollWidth&&this.oldHostMetrics_.viewLeft===e.viewLeft&&this.oldHostMetrics_.scrollLeft===e.scrollLeft||(t=true),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===e.scrollHeight&&this.oldHostMetrics_.viewTop===e.viewTop&&this.oldHostMetrics_.scrollTop===e.scrollTop||(r=true)):r=t=true,t||r){try{Jt(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&r&&this.vScroll.resize(e)}finally{Zt()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==e.viewWidth||this.oldHostMetrics_.absoluteLeft!==e.absoluteLeft){let a;(a=this.corner_)==null||a.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==e.viewHeight||this.oldHostMetrics_.absoluteTop!==e.absoluteTop){let a;(a=this.corner_)==null||a.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,r){this.hScroll&&this.hScroll.set(e,false),this.vScroll&&this.vScroll.set(t,false),(r||r===void 0)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,true)}setY(e){this.vScroll&&this.vScroll.set(e,true)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=false;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},zb=false;i.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=k());var t=[];this.init(e),e=e.getTopBlocks(true);for(let r=0,a;a=e[r];r++){let h=this.blockToCode(a);Array.isArray(h)&&(h=h[0]),h&&(a.outputConnection&&(h=this.scrubNakedValue(h),this.STATEMENT_PREFIX&&!a.suppressPrefixSuffix&&(h=this.injectId(this.STATEMENT_PREFIX,a)+h),this.STATEMENT_SUFFIX&&!a.suppressPrefixSuffix&&(h+=this.injectId(this.STATEMENT_SUFFIX,a))),t.push(h))}return t=t.join(`
`),t=this.finish(t),t=t.replace(/^\s+\n/,""),t=t.replace(/\n\s+$/,`
`),t=t.replace(/[ \t]+\n/g,`
`)}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,`
`+t)}allNestedComments(e){const t=[];e=e.getDescendants(true);for(let r=0;r<e.length;r++){const a=e[r].getCommentText();a&&t.push(a)}return t.length&&t.push(""),t.join(`
`)}blockToCode(e,t){if(this.isInitialized===false&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(false)[0]);var r=this[e.type];if(typeof r!="function")throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+e.type+'".');if(r=r.call(e,e),Array.isArray(r)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,r[0],t),r[1]]}if(typeof r=="string")return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(r=this.injectId(this.STATEMENT_PREFIX,e)+r),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(r+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,r,t);if(r===null)return"";throw SyntaxError("Invalid code generated: "+r)}valueToCode(e,t,r){if(isNaN(r))throw TypeError("Expecting valid order from block: "+e.type);var a=e.getInputTargetBlock(t);if(!a||(t=this.blockToCode(a),t===""))return"";if(!Array.isArray(t))throw TypeError("Expecting tuple from value block: "+a.type);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+a.type);if(!e)return"";a=false;var h=Math.floor(r);const C=Math.floor(t);if(h<=C&&(h!==C||h!==0&&h!==99)){for(a=true,h=0;h<this.ORDER_OVERRIDES.length;h++)if(this.ORDER_OVERRIDES[h][0]===r&&this.ORDER_OVERRIDES[h][1]===t){a=false;break}}return a&&(e="("+e+")"),e}statementToCode(e,t){if(e=e.getInputTargetBlock(t),t=this.blockToCode(e),typeof t!="string")throw TypeError("Expecting code from statement block: "+(e&&e.type));return t&&(t=this.prefixLines(t,this.INDENT)),t}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const r=this.nameDB_.getDistinctName(e,i.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[e]=r,Array.isArray(t)&&(t=t.join(`
`)),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,r);let a;for(;a!==t;)a=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,r){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},Object.defineProperties(i.CodeGenerator$$module$build$src$core$generator.prototype,{variableDB_:{get(){return o("variableDB_","version 9","version 10","nameDB_"),this.nameDB_},set(e){o("variableDB_","version 9","version 10","nameDB_"),this.nameDB_=e}}}),i.CodeGenerator$$module$build$src$core$generator;var na=class{constructor(e,t,r,a){this.workspace=e,this.targetWorkspace=t,this.isLabel_=a,this.onMouseUpWrapper_=null,this.height=this.width=0,this.svgText_=this.svgGroup_=null,this.text_=r.text,this.position_=new Oe(0,0),this.callbackKey_=r.callbackKey||r.callbackkey,this.cssClass_=r["web-class"]||null,this.info=r}createDom(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass_&&(e+=" "+this.cssClass_),this.svgGroup_=H(Q.G,{class:e},this.workspace.getCanvas());let t;this.isLabel_||(t=H(Q.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_)),e=H(Q.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);const r=H(Q.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);var a=Qt(this.text_);this.workspace.RTL&&(a+="‏"),r.textContent=a,this.isLabel_&&(this.svgText_=r,this.workspace.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));const h=kt(r,"fontSize"),C=kt(r,"fontWeight"),D=kt(r,"fontFamily");if(this.width=Ut(r,h,C,D),a=jt(a,h,C,D),this.height=a.height,!this.isLabel_){this.width+=2*na.TEXT_MARGIN_X,this.height+=2*na.TEXT_MARGIN_Y;let Y;(Y=t)==null||Y.setAttribute("width",this.width.toString());let pe;(pe=t)==null||pe.setAttribute("height",this.height.toString())}return e.setAttribute("width",this.width.toString()),e.setAttribute("height",this.height.toString()),r.setAttribute("x",(this.width/2).toString()),r.setAttribute("y",(this.height/2-a.height/2+a.baseline).toString()),this.updateTransform_(),this.onMouseUpWrapper_=E(this.svgGroup_,"pointerup",this,this.onMouseUp_),this.svgGroup_}show(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")}updateTransform_(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")}moveTo(e,t){this.position_.x=e,this.position_.y=t,this.updateTransform_()}isLabel(){return this.isLabel_}getPosition(){return this.position_}getButtonText(){return this.text_}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper_&&f(this.onMouseUpWrapper_),this.svgGroup_&&x(this.svgGroup_),this.svgText_&&this.workspace.getThemeManager().unsubscribe(this.svgText_)}onMouseUp_(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace.getButtonCallback(this.callbackKey_)?this.isLabel_||(e=this.targetWorkspace.getButtonCallback(this.callbackKey_))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)}};na.TEXT_MARGIN_X=5,na.TEXT_MARGIN_Y=2,hs(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var w_=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,r=0;return e&&(t=e.getWidth(),r=e.getHeight()),new $s(t,r)}getFlyoutMetrics(e){return e=this.getDimensionsPx_(this.workspace_.getFlyout(e)),{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0;const t=this.getToolboxMetrics(),r=this.getFlyoutMetrics(true),a=!!this.workspace_.getToolbox(),h=!!this.workspace_.getFlyout(true);var C=a?t.position:r.position,D=C===et.LEFT;return C=C===et.TOP,a&&D?e=t.width:h&&D&&(e=r.width),D=0,a&&C?D=t.height:h&&C&&(D=r.height),{top:D,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),r=this.getToolboxMetrics(),a=this.getFlyoutMetrics(true),h=this.workspace_.getToolbox()?r.position:a.position;return this.workspace_.getToolbox()?h===et.TOP||h===et.BOTTOM?t.height-=r.height:(h===et.LEFT||h===et.RIGHT)&&(t.width-=r.width):this.workspace_.getFlyout(true)&&(h===et.TOP||h===et.BOTTOM?t.height-=a.height:(h===et.LEFT||h===et.RIGHT)&&(t.width-=a.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),r=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(false);const a={};return r||(a.top=e.top,a.bottom=e.top+e.height),t||(a.left=e.left,a.right=e.left+e.width),a}getPaddedContent_(e,t){const r=t.top+t.height,a=t.left+t.width,h=e.width;e=e.height;const C=h/2,D=e/2;return{top:Math.min(t.top-D,r-e),bottom:Math.max(r+D,t.top+e),left:Math.min(t.left-C,a-h),right:Math.max(a+C,t.left+h)}}getScrollMetrics(e,t,r){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(false);var a=r||this.getContentMetrics();r=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,a),a=r.top!==void 0?r.top:t.top;const h=r.left!==void 0?r.left:t.left;return{top:a/e,left:h/e,width:((r.right!==void 0?r.right:t.right)-h)/e,height:((r.bottom!==void 0?r.bottom:t.bottom)-a)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(true),r=this.getSvgMetrics(),a=this.getAbsoluteMetrics(),h=this.getViewMetrics(),C=this.getContentMetrics(),D=this.getScrollMetrics(false,h,C);return{contentHeight:C.height,contentWidth:C.width,contentTop:C.top,contentLeft:C.left,scrollHeight:D.height,scrollWidth:D.width,scrollTop:D.top,scrollLeft:D.left,viewHeight:h.height,viewWidth:h.width,viewTop:h.top,viewLeft:h.left,absoluteTop:a.top,absoluteLeft:a.left,svgHeight:r.height,svgWidth:r.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};ye(Se.METRICS_MANAGER,Bn,w_);var jb=class extends w_{constructor(e,t){super(e),this.flyout_=t}getBoundingBox_(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch{e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox_();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,r){return t=r||this.getContentMetrics(),r=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*r)/e,width:(t.width+t.left+r)/e,top:0,left:0}}},ra;(function(e){e.BLOCK="block",e.BUTTON="button"})(ra||(ra={}));var Su=class extends gu{constructor(e){super(),this.horizontalLayout=false,this.eventWrappers_=[],this.filterWrapper_=this.reflowWrapper_=null,this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.recycledBlocks_=[],this.autoClose=true,this.isVisible_=false,this.containerVisible_=true,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new rn(e),this.workspace_.setMetricsManager(new jb(this.workspace_,this)),this.workspace_.internalIsFlyout=true,this.workspace_.setVisible(this.isVisible_),this.id=pi(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=H(e,{class:"blocklyFlyout",style:"display: none"}),this.svgBackground_=H(Q.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new k_(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,E(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,E(this.svgBackground_,"pointerdown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:1,capabilities:[ys.Capability.DELETE_AREA,ys.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),f(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&(x(this.svgGroup_),this.svgGroup_=null),this.svgBackground_=null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}isVisible(){return this.isVisible_}setVisible(e){const t=e!==this.isVisible();this.isVisible_=e,t&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())}setContainerVisible(e){const t=e!==this.containerVisible_;this.containerVisible_=e,t&&this.updateDisplay_()}updateDisplay_(){let e;e=this.containerVisible_?this.isVisible():false,this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none");let t;(t=this.workspace_.scrollbar)==null||t.setContainerVisible(e)}positionAt_(e,t,r,a){let h;(h=this.svgGroup_)==null||h.setAttribute("width",e.toString());let C;(C=this.svgGroup_)==null||C.setAttribute("height",t.toString()),this.workspace_.setCachedParentSvgSize(e,t);let D;if(((D=this.svgGroup_)==null?void 0:D.tagName)==="svg")ae(this.svgGroup_,"translate("+r+"px,"+a+"px)");else{let Y;(Y=this.svgGroup_)==null||Y.setAttribute("transform","translate("+r+","+a+")")}(e=this.workspace_.scrollbar)&&(e.setOrigin(r,a),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(false);for(let e=0,t;t=this.listeners_[e];e++)f(t);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}}show(e){this.workspace_.setResizesEnabled(false),this.hide(),this.clearOldBlocks_(),typeof e=="string"&&(e=this.getDynamicCategoryContents_(e)),this.setVisible(true),e=kc(e),e=this.createFlyoutInfo_(e),this.layout_(e.contents,e.gaps),this.listeners_.push(E(this.svgBackground_,"pointerover",this,function(){const t=this.workspace_.getTopBlocks(false);for(let r=0,a;a=t[r];r++)a.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(true),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_),this.emptyRecycledBlocks_()}createFlyoutInfo_(e){const t=[],r=[];this.permanentlyDisabled_.length=0;const a=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(let C=0,D;D=e[C];C++){if("custom"in D){var h=this.getDynamicCategoryContents_(D.custom);h=kc(h),e.splice.apply(e,[C,1,...h]),D=e[C]}switch(D.kind.toUpperCase()){case"BLOCK":h=D;const Y=this.createFlyoutBlock_(h);t.push({type:ra.BLOCK,block:Y}),this.addBlockGap_(h,r,a);break;case"SEP":this.addSeparatorGap_(D,r,a);break;case"LABEL":h=this.createButton_(D,true),t.push({type:ra.BUTTON,button:h}),r.push(a);break;case"BUTTON":h=this.createButton_(D,false),t.push({type:ra.BUTTON,button:h}),r.push(a)}}return{contents:t,gaps:r}}getDynamicCategoryContents_(e){if(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e),typeof e!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}createButton_(e,t){return new na(this.workspace_,this.targetWorkspace,e,t)}createFlyoutBlock_(e){let t;return e.blockxml?(e=typeof e.blockxml=="string"?js(e.blockxml):e.blockxml,(t=this.getRecycledBlock_(e.getAttribute("type")))||(t=Co(e,this.workspace_))):(t=this.getRecycledBlock_(e.type),t||(e.enabled===void 0&&(e.enabled=e.disabled!=="true"&&e.disabled!==true),t=Br(e,this.workspace_))),t.isEnabled()||this.permanentlyDisabled_.push(t),t}getRecycledBlock_(e){let t=-1;for(let r=0;r<this.recycledBlocks_.length;r++)if(this.recycledBlocks_[r].type===e){t=r;break}return t===-1?void 0:this.recycledBlocks_.splice(t,1)[0]}addBlockGap_(e,t,r){let a;e.gap?a=parseInt(e.gap.toString()):e.blockxml&&(e=typeof e.blockxml=="string"?js(e.blockxml):e.blockxml,a=parseInt(e.getAttribute("gap"))),t.push(!a||isNaN(a)?r:a)}addSeparatorGap_(e,t,r){e=parseInt(e.gap.toString()),!isNaN(e)&&0<t.length?t[t.length-1]=e:t.push(r)}clearOldBlocks_(){var e=this.workspace_.getTopBlocks(false);for(let r=0,a;a=e[r];r++)this.blockIsRecyclable_(a)?this.recycleBlock_(a):a.dispose(false,false);for(e=0;e<this.mats_.length;e++){const r=this.mats_[e];r&&(Rc(r),x(r))}this.mats_.length=0;for(let r=0,a;a=this.buttons_[r];r++)a.dispose();this.buttons_.length=0;let t;(t=this.workspace_.getPotentialVariableMap())==null||t.clear()}emptyRecycledBlocks_(){for(let e=0;e<this.recycledBlocks_.length;e++)this.recycledBlocks_[e].dispose();this.recycledBlocks_=[]}blockIsRecyclable_(e){return false}recycleBlock_(e){const t=e.getRelativeToSurfaceXY();e.moveBy(-t.x,-t.y),this.recycledBlocks_.push(e)}addBlockListeners_(e,t,r){this.listeners_.push(E(e,"pointerdown",null,this.blockMouseDown_(t))),this.listeners_.push(E(r,"pointerdown",null,this.blockMouseDown_(t))),this.listeners_.push(y(e,"pointerenter",t,t.addSelect)),this.listeners_.push(y(e,"pointerleave",t,t.removeSelect)),this.listeners_.push(y(r,"pointerenter",t,t.addSelect)),this.listeners_.push(y(r,"pointerleave",t,t.removeSelect))}blockMouseDown_(e){return t=>{const r=this.targetWorkspace.getGesture(t);r&&(r.setStartBlock(e),r.handleFlyoutStart(t,this))}}onMouseDown_(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()}createBlock(e){let t=null;Jt();var r=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(false);try{t=this.placeNewBlock_(e)}finally{Zt()}if(this.targetWorkspace.hideChaff(),e=ms(this.targetWorkspace,r),ls()){for(We(true),r=0;r<e.length;r++){const a=e[r];Pe(new(Te(Hr))(a))}Pe(new(Te(ws))(t))}return this.autoClose?this.hide():this.filterForCapacity_(),t}initFlyoutButton_(e,t,r){const a=e.createDom();e.moveTo(t,r),e.show(),this.listeners_.push(E(a,"pointerdown",this,this.onMouseDown_)),this.buttons_.push(e)}createRect_(e,t,r,a,h){return t=H(Q.RECT,{"fill-opacity":0,x:t,y:r,height:a.height,width:a.width}),t.tooltip=e,yc(t),this.workspace_.getCanvas().insertBefore(t,e.getSvgRoot()),this.rectMap_.set(e,t),this.mats_[h]=t}moveRectToBlock_(e,t){const r=t.getHeightWidth();e.setAttribute("width",r.width.toString()),e.setAttribute("height",r.height.toString()),t=t.getRelativeToSurfaceXY(),e.setAttribute("y",t.y.toString()),e.setAttribute("x",(this.RTL?t.x-r.width:t.x).toString())}filterForCapacity_(){const e=this.workspace_.getTopBlocks(false);for(let t=0,r;r=e[t];t++)if(this.permanentlyDisabled_.indexOf(r)===-1){const a=this.targetWorkspace.isCapacityAvailable(K(r));for(;r;)r.setEnabled(a),r=r.getNextBlock()}}reflow(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():false}placeNewBlock_(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered.");const r=Mn(e);return t.setResizesEnabled(false),t=Br(r,t),this.positionNewBlock_(e,t),t}positionNewBlock_(e,t){const r=this.targetWorkspace;var a=r.getOriginOffsetInPixels(),h=this.workspace_.getOriginOffsetInPixels();e=e.getRelativeToSurfaceXY(),e.scale(this.workspace_.scale),h=Oe.sum(h,e),a=Oe.difference(h,a),a.scale(1/r.scale),t.moveTo(new Oe(a.x,a.y))}};Su.FlyoutItemType=ra;var A_=class extends Su{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),a=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.y=="number"&&(this.workspace_.scrollY=-(r.top+(r.height-a.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===et.LEFT?e.width:r.width-this.width_:this.toolboxPosition_===et.LEFT?0:r.width:this.toolboxPosition_===et.LEFT?0:r.width+t.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath_(e,t){const r=this.toolboxPosition_===et.RIGHT;var a=e+this.CORNER_RADIUS;a=["M "+(r?a:0)+",0"],a.push("h",r?-e:e),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("v",Math.max(0,t)),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("h",r?e:-e),a.push("z"),this.svgBackground_.setAttribute("d",a.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setY(0)}wheel_(e){var t=R(e);if(t.y){const r=this.workspace_.getMetricsManager(),a=r.getScrollMetrics();t=r.getViewMetrics().top-a.top+t.y;let h;(h=this.workspace_.scrollbar)==null||h.setY(t),pn(),Ot()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;var r=this.MARGIN;const a=this.RTL?r:r+this.tabWidth_;for(let Y=0,pe;pe=e[Y];Y++)if(pe.type==="block"){var h=pe.block,C=h.getDescendants(false);for(let ft=0,zt;zt=C[ft];ft++)zt.isInFlyout=true;h.render(),C=h.getSvgRoot();const ke=h.getHeightWidth();var D=h.outputConnection?a-this.tabWidth_:a;h.moveBy(D,r),D=this.createRect_(h,this.RTL?D-ke.width:D,r,ke,Y),this.addBlockListeners_(C,h,D),r+=ke.height+t[Y]}else pe.type==="button"&&(h=pe.button,this.initFlyoutButton_(h,a,r),r+=h.height+t[Y])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===et.LEFT?new es(-1e9,1e9,-1e9,t+e.width):new es(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;var t=this.workspace_.getTopBlocks(false);for(let a=0,h;h=t[a];a++){var r=h.getHeightWidth().width;h.outputConnection&&(r-=this.tabWidth_),e=Math.max(e,r)}for(let a=0,h;h=this.buttons_[a];a++)e=Math.max(e,h.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=Kt.scrollbarThickness,this.width_!==e){for(let a=0,h;h=t[a];a++){if(this.RTL){r=h.getRelativeToSurfaceXY().x;let C=e/this.workspace_.scale-this.MARGIN;h.outputConnection||(C-=this.tabWidth_),h.moveBy(C-r,0)}this.rectMap_.has(h)&&this.moveRectToBlock_(this.rectMap_.get(h),h)}if(this.RTL)for(let a=0,h;h=this.buttons_[a];a++)t=h.getPosition().y,h.moveTo(e/this.workspace_.scale-h.width-this.MARGIN-this.tabWidth_,t);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==et.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.recordDragTargets()}}};A_.registryName="verticalFlyout",ye(Se.FLYOUTS_VERTICAL_TOOLBOX,Bn,A_);var Xb=class extends Su{constructor(e){super(e),this.horizontalLayout=true}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),a=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.x=="number"&&(this.workspace_.scrollX=-(r.left+(r.width-a.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();e=e.getToolboxMetrics();const a=this.toolboxPosition_===et.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?a?e.height:r.height-this.height_:a?0:r.height:a?0:r.height+t.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath_(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath_(e,t){const r=this.toolboxPosition_===et.TOP,a=["M 0,"+(r?0:this.CORNER_RADIUS)];r?(a.push("h",e+2*this.CORNER_RADIUS),a.push("v",t),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("h",-e),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),a.push("h",e),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("v",t),a.push("h",-e-2*this.CORNER_RADIUS)),a.push("z"),this.svgBackground_.setAttribute("d",a.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setX(this.RTL?1/0:0)}wheel_(e){var t=R(e);if(t=t.x||t.y){const r=this.workspace_.getMetricsManager(),a=r.getScrollMetrics();t=r.getViewMetrics().left-a.left+t;let h;(h=this.workspace_.scrollbar)==null||h.setX(t),pn(),Ot()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;const r=this.MARGIN;let a=r+this.tabWidth_;this.RTL&&(e=e.reverse());for(let Y=0,pe;pe=e[Y];Y++)if(pe.type==="block"){var h=pe.block,C=h.getDescendants(false);for(let ft=0,zt;zt=C[ft];ft++)zt.isInFlyout=true;h.render(),C=h.getSvgRoot();const ke=h.getHeightWidth();var D=h.outputConnection?this.tabWidth_:0;D=this.RTL?a+ke.width:a-D,h.moveBy(D,r),D=this.createRect_(h,D,r,ke,Y),a+=ke.width+t[Y],this.addBlockListeners_(C,h,D)}else pe.type==="button"&&(h=pe.button,this.initFlyoutButton_(h,a,r),a+=h.width+t[Y])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===et.TOP?new es(-1e9,t+e.height,-1e9,1e9):new es(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;const t=this.workspace_.getTopBlocks(false);for(let a=0,h;h=t[a];a++)e=Math.max(e,h.getHeightWidth().height);const r=this.buttons_;for(let a=0,h;h=r[a];a++)e=Math.max(e,h.height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=Kt.scrollbarThickness,this.height_!==e){for(let a=0,h;h=t[a];a++)this.rectMap_.has(h)&&this.moveRectToBlock_(this.rectMap_.get(h),h);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==et.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.recordDragTargets()}}};ye(Se.FLYOUTS_HORIZONTAL_TOOLBOX,Bn,Xb);var kl=class extends tn{constructor(e,t,r,a,h){super(pt.SKIP_SETUP),this.defaultType_="",this.variableTypes=[],this.variable_=null,this.SERIALIZABLE=true,this.menuGenerator_=kl.dropdownCreate,this.defaultVariableName=typeof e=="string"?e:"",this.size_=new $s(0,0),e!==pt.SKIP_SETUP&&(h?this.configure_(h):this.setTypes_(r,a),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes_(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new ps;this.variable_||(e=Fe(e.workspace,null,this.defaultVariableName,this.defaultType_),this.doValueUpdate_(e.getId()))}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new ps;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||e.type!=="variables_get")}fromXml(e){var t=this.getSourceBlock();if(!t)throw new ps;const r=e.getAttribute("id"),a=e.textContent,h=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=Fe(t.workspace,r,a,h),h!==null&&h!==t.type)throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.type+", and does not match variable field that references it: "+Di(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable_.getId(),e.textContent=this.variable_.name,this.variable_.type&&e.setAttribute("variabletype",this.variable_.type),e}saveState(e){var t=this.saveLegacyState(kl);return t!==null||(this.initModel(),t={id:this.variable_.getId()},e&&(t.name=this.variable_.name,t.type=this.variable_.type)),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new ps;this.loadLegacyState(kl,e)||(e=Fe(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable_?this.variable_.getId():null}getText(){return this.variable_?this.variable_.name:""}getVariable(){return this.variable_}getValidator(){return this.variable_?this.validator_:null}doClassValidation_(e){if(e===null)return null;var t=this.getSourceBlock();if(!t)throw new ps;return t=lt(t.workspace,e),t?(t=t.type,this.typeIsAllowed_(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new ps;this.variable_=lt(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed_(e){const t=this.getVariableTypes_();if(!t)return true;for(let r=0;r<t.length;r++)if(e===t[r])return true;return false}getVariableTypes_(){var e=this.variableTypes;if(e===null&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(e=e||[""],e.length===0)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e}setTypes_(e,t){if(t=t||"",e==null)e=null;else if(Array.isArray(e)){let r=false;for(let a=0;a<e.length;a++)e[a]===t&&(r=true);if(!r)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType_=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===e_){Nr(this.sourceBlock_.workspace,this.variable_);return}if(e===t_){this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId());return}}this.setValue(e)}referencesVariables(){return true}static fromJson(e){return new this(Qt(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var r=this.getVariableTypes_(),a=0;a<r.length;a++){const h=this.sourceBlock_.workspace.getVariablesOfType(r[a]);t=t.concat(h)}for(t.sort(Za.compareByName),r=[],a=0;a<t.length;a++)r[a]=[t[a].name,t[a].getId()];return r.push([Ye.RENAME_VARIABLE,e_]),Ye.DELETE_VARIABLE&&r.push([Ye.DELETE_VARIABLE.replace("%1",e),t_]),r}};xi("field_variable",kl);var L_=class extends Cl{constructor(e,t,r,a,h,C){super(pt.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,this.SERIALIZABLE=true,this.spellcheck_=false,e!==pt.SKIP_SETUP&&(C?this.configure_(C):this.setConstraints(t,r,a),this.setValue(e),h&&this.setValidator(h))}configure_(e){super.configure_(e),this.setMinInternal_(e.min),this.setMaxInternal_(e.max),this.setPrecisionInternal_(e.precision)}setConstraints(e,t,r){this.setMinInternal_(e),this.setMaxInternal_(t),this.setPrecisionInternal_(r),this.setValue(this.getValue())}setMin(e){this.setMinInternal_(e),this.setValue(this.getValue())}setMinInternal_(e){e==null?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal_(e),this.setValue(this.getValue())}setMaxInternal_(e){e==null?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal_(e),this.setValue(this.getValue())}setPrecisionInternal_(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.indexOf("e")!==-1&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const r=t.indexOf(".");this.decimalPlaces_=r===-1?e?0:null:t.length-r-1}getPrecision(){return this.precision_}doClassValidation_(e){return e===null||(e=String(e),e=e.replace(/O/ig,"0"),e=e.replace(/,/g,""),e=e.replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),this.decimalPlaces_!==null&&(e=Number(e.toFixed(this.decimalPlaces_))),e)}widgetCreate_(){const e=super.widgetCreate_();return-1/0<this.min_&&Xt(e,Gt.VALUEMIN,this.min_),1/0>this.max_&&Xt(e,Gt.VALUEMAX,this.max_),e}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};xi("field_number",L_),L_.prototype.DEFAULT_VALUE=0;var N_=class extends i.FieldTextInput$$module$build$src$core$field_textinput{constructor(e,t,r){super(pt.SKIP_SETUP),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=false,e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.maxLines&&this.setMaxLines(e.maxLines)}toXml(e){return e.textContent=this.getValue().replace(/\n/g,"&#10;"),e}fromXml(e){this.setValue(e.textContent.replace(/&#10;/g,`
`))}saveState(){const e=this.saveLegacyState(N_);return e!==null?e:this.getValue()}loadState(e){this.loadLegacyState(pt,e)||this.setValue(e)}initView(){this.createBorderRect_(),this.textGroup_=H(Q.G,{class:"blocklyEditableText"},this.fieldGroup_)}getDisplayText_(){const e=this.getSourceBlock();if(!e)throw new ps;let t=this.getText();if(!t)return pt.NBSP;const r=t.split(`
`);t="";const a=this.isOverflowedY_?this.maxLines_:r.length;for(let h=0;h<a;h++){let C=r[h];C.length>this.maxDisplayLength?C=C.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&h===a-1&&(C=C.substring(0,C.length-3)+"..."),C=C.replace(/\s/g,pt.NBSP),t+=C,h!==a-1&&(t+=`
`)}return e.RTL&&(t+="‏"),t}doValueUpdate_(e){super.doValueUpdate_(e),this.isOverflowedY_=this.value_.split(`
`).length>this.maxLines_}render_(){var e=this.getSourceBlock();if(!e)throw new ps;for(var t;t=this.textGroup_.firstChild;)this.textGroup_.removeChild(t);t=this.getDisplayText_().split(`
`);let r=0;for(let a=0;a<t.length;a++){const h=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;H(Q.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:r+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(t[a])),r+=h}this.isBeingEdited_&&(t=this.htmlInput_,this.isOverflowedY_?ne(t,"blocklyHtmlTextAreaInputOverflowedY"):de(t,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(e.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),e=this.htmlInput_,this.isTextValid_?(de(e,"blocklyInvalidInput"),Xt(e,Gt.INVALID,false)):(ne(e,"blocklyInvalidInput"),Xt(e,Gt.INVALID,true)))}updateSize_(){var e=this.textGroup_.childNodes;const t=this.getConstants().FIELD_TEXT_FONTSIZE,r=this.getConstants().FIELD_TEXT_FONTWEIGHT,a=this.getConstants().FIELD_TEXT_FONTFAMILY;let h=0,C=0;for(var D=0;D<e.length;D++){var Y=bt(e[D],t,r,a);Y>h&&(h=Y),C+=this.getConstants().FIELD_TEXT_HEIGHT+(0<D?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){for(e=this.value_.split(`
`),D=H(Q.TEXT,{class:"blocklyText blocklyMultilineText"}),Y=0;Y<e.length;Y++){e[Y].length>this.maxDisplayLength&&(e[Y]=e[Y].substring(0,this.maxDisplayLength)),D.textContent=e[Y];const pe=bt(D,t,r,a);pe>h&&(h=pe)}h+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(C+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,h+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",h),this.borderRect_.setAttribute("height",C)),this.size_.width=h,this.size_.height=C,this.positionBorderRect_()}showEditor_(e,t){super.showEditor_(e,t),this.forceRerender()}widgetCreate_(){const e=wo(),t=this.workspace_.getScale(),r=document.createElement("textarea");r.className="blocklyHtmlInput blocklyHtmlTextAreaInput",r.setAttribute("spellcheck",this.spellcheck_);var a=this.getConstants().FIELD_TEXT_FONTSIZE*t+"pt";e.style.fontSize=a,r.style.fontSize=a,r.style.borderRadius=i.FieldTextInput$$module$build$src$core$field_textinput.BORDERRADIUS*t+"px",a=this.getConstants().FIELD_BORDER_RECT_X_PADDING*t;const h=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*t/2;return r.style.padding=h+"px "+a+"px "+h+"px "+a+"px",a=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,r.style.lineHeight=a*t+"px",e.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",this.value_),r.setAttribute("data-old-value",""),dd?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(r),r}setMaxLines(e){typeof e=="number"&&0<e&&e!==this.maxLines_&&(this.maxLines_=e,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(e){e.keyCode!==xe.ENTER&&super.onHtmlInputKeyDown_(e)}static fromJson(e){return new this(Qt(e.text),void 0,e)}};hs(`
.blocklyHtmlTextAreaInput {
  font-family: monospace;
  resize: none;
  overflow: hidden;
  height: 100%;
  text-align: left;
}

.blocklyHtmlTextAreaInputOverflowedY {
  overflow-y: scroll;
}
`),xi("field_multilinetext",N_);var Kb=class extends i.FieldLabel$$module$build$src$core$field_label{constructor(e,t,r){super(String(e??""),t,r),this.EDITABLE=false,this.SERIALIZABLE=true}static fromJson(e){return new this(Qt(e.text),void 0,e)}};xi("field_label_serializable",Kb);var $i=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null,this.SERIALIZABLE=true,this.CURSOR="default",this.isDirty_=false,this.titles_=this.colours_=null,this.columns_=0,e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.colourOptions&&(this.colours_=e.colourOptions),e.colourTitles&&(this.titles_=e.colourTitles),e.columns&&(this.columns_=e.columns)}initView(){this.size_=new $s(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof Pi&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()):(this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1")}applyColour(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof Pi&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())}doClassValidation_(e){return typeof e!="string"?null:xr(e)}doValueUpdate_(e){this.value_=e,this.borderRect_?this.borderRect_.style.fill=e:this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_ instanceof Pi&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",e),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))}getText(){let e=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(e)&&(e="#"+e[1]+e[3]+e[5]),e}setColours(e,t){return this.colours_=e,t&&(this.titles_=t),this}setColumns(e){return this.columns_=e,this}showEditor_(){this.dropdownCreate_(),Li().appendChild(this.picker_),J(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:true})}onClick_(e){e=(e=e.target)&&e.getAttribute("data-colour"),e!==null&&(this.setValue(e),Qe(this))}onKeyDown_(e){var t=false;e.keyCode===xe.UP?(this.moveHighlightBy_(0,-1),t=true):e.keyCode===xe.DOWN?(this.moveHighlightBy_(0,1),t=true):e.keyCode===xe.LEFT?(this.moveHighlightBy_(-1,0),t=true):e.keyCode===xe.RIGHT?(this.moveHighlightBy_(1,0),t=true):e.keyCode===xe.ENTER&&((t=this.getHighlighted_())&&(t=t&&t.getAttribute("data-colour"),t!==null&&this.setValue(t)),Ot(),t=true),t&&e.stopPropagation()}moveHighlightBy_(e,t){if(this.highlightedIndex_){var r=this.colours_||$i.COLOURS,a=this.columns_||$i.COLUMNS,h=this.highlightedIndex_%a,C=Math.floor(this.highlightedIndex_/a);h+=e,C+=t,0>e?0>h&&0<C?(h=a-1,C--):0>h&&(h=0):0<e?h>a-1&&C<Math.floor(r.length/a)-1?(h=0,C++):h>a-1&&h--:0>t?0>C&&(C=0):0<t&&C>Math.floor(r.length/a)-1&&(C=Math.floor(r.length/a)-1),this.setHighlightedCell_(this.picker_.childNodes[C].childNodes[h],C*a+h)}}onMouseMove_(e){const t=(e=e.target)&&Number(e.getAttribute("data-index"));t!==null&&t!==this.highlightedIndex_&&this.setHighlightedCell_(e,t)}onMouseEnter_(){this.picker_.focus({preventScroll:true})}onMouseLeave_(){this.picker_.blur();const e=this.getHighlighted_();e&&de(e,"blocklyColourHighlighted")}getHighlighted_(){if(!this.highlightedIndex_)return null;const e=this.columns_||$i.COLUMNS,t=this.picker_.childNodes[Math.floor(this.highlightedIndex_/e)];return t?t.childNodes[this.highlightedIndex_%e]:null}setHighlightedCell_(e,t){const r=this.getHighlighted_();r&&de(r,"blocklyColourHighlighted"),ne(e,"blocklyColourHighlighted"),this.highlightedIndex_=t,Xt(this.picker_,Gt.ACTIVEDESCENDANT,e.getAttribute("id"))}dropdownCreate_(){const e=this.columns_||$i.COLUMNS,t=this.colours_||$i.COLOURS,r=this.titles_||$i.TITLES,a=this.getValue(),h=document.createElement("table");h.className="blocklyColourTable",h.tabIndex=0,h.dir="ltr",gn(h,li.GRID),Xt(h,Gt.EXPANDED,true),Xt(h,Gt.ROWCOUNT,Math.floor(t.length/e)),Xt(h,Gt.COLCOUNT,e);let C;for(let D=0;D<t.length;D++){D%e===0&&(C=document.createElement("tr"),gn(C,li.ROW),h.appendChild(C));const Y=document.createElement("td");C.appendChild(Y),Y.setAttribute("data-colour",t[D]),Y.title=r[D]||t[D],Y.id=Ar(),Y.setAttribute("data-index",D),gn(Y,li.GRIDCELL),Xt(Y,Gt.LABEL,t[D]),Xt(Y,Gt.SELECTED,t[D]===a),Y.style.backgroundColor=t[D],t[D]===a&&(Y.className="blocklyColourSelected",this.highlightedIndex_=D)}this.onClickWrapper_=E(h,"pointerdown",this,this.onClick_,true),this.onMouseMoveWrapper_=E(h,"pointermove",this,this.onMouseMove_,true),this.onMouseEnterWrapper_=E(h,"pointerenter",this,this.onMouseEnter_,true),this.onMouseLeaveWrapper_=E(h,"pointerleave",this,this.onMouseLeave_,true),this.onKeyDownWrapper_=E(h,"keydown",this,this.onKeyDown_),this.picker_=h}dropdownDispose_(){this.onClickWrapper_&&(f(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(f(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(f(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(f(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(f(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null}static fromJson(e){return new this(e.colour,void 0,e)}};$i.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),$i.TITLES=[],$i.COLUMNS=7,$i.prototype.DEFAULT_VALUE=$i.COLOURS[0],hs(`
.blocklyColourTable {
  border-collapse: collapse;
  display: block;
  outline: none;
  padding: 1px;
}

.blocklyColourTable>tr>td {
  border: .5px solid #888;
  box-sizing: border-box;
  cursor: pointer;
  display: inline-block;
  height: 20px;
  padding: 0;
  width: 20px;
}

.blocklyColourTable>tr>td.blocklyColourHighlighted {
  border-color: #eee;
  box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);
  position: relative;
}

.blocklyColourSelected, .blocklyColourSelected:hover {
  border-color: #eee !important;
  outline: 1px solid #333;
  position: relative;
}
`),xi("field_colour",$i),i.FieldCheckbox$$module$build$src$core$field_checkbox=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.SERIALIZABLE=true,this.CURSOR="default",this.checkChar_=i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR,e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar_=e.checkCharacter)}saveState(){const e=this.saveLegacyState(i.FieldCheckbox$$module$build$src$core$field_checkbox);return e!==null?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();ne(e,"blocklyCheckbox"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar_}setCheckCharacter(e){this.checkChar_=e||i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return e===true||e==="TRUE"?"TRUE":e===false||e==="FALSE"?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool_(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(e){return typeof e=="string"?e==="TRUE":!!e}static fromJson(e){return new this(e.checked,void 0,e)}},i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR="✓",xi("field_checkbox",i.FieldCheckbox$$module$build$src$core$field_checkbox),i.FieldCheckbox$$module$build$src$core$field_checkbox.prototype.DEFAULT_VALUE=false,i.FieldCheckbox$$module$build$src$core$field_checkbox;var ut=class extends Cl{constructor(e,t,r){super(pt.SKIP_SETUP),this.clockwise_=ut.CLOCKWISE,this.offset_=ut.OFFSET,this.wrap_=ut.WRAP,this.round_=ut.ROUND,this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.symbol_=this.line_=this.gauge_=this.editor_=null,this.SERIALIZABLE=true,e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){switch(super.configure_(e),e.mode){case $u.COMPASS:this.clockwise_=true,this.offset_=90;break;case $u.PROTRACTOR:this.clockwise_=false,this.offset_=0}e.clockwise&&(this.clockwise_=e.clockwise),e.offset&&(this.offset_=e.offset),e.wrap&&(this.wrap_=e.wrap),e.round&&(this.round_=e.round)}initView(){super.initView(),this.symbol_=H(Q.TSPAN,{}),this.symbol_.appendChild(document.createTextNode("°")),this.getTextElement().appendChild(this.symbol_)}render_(){super.render_(),this.updateGraph_()}showEditor_(e){super.showEditor_(e,pd||Vc||Lo),this.dropdownCreate_(),Li().appendChild(this.editor_),this.sourceBlock_ instanceof Pi&&N(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),J(this,this.dropdownDispose_.bind(this)),this.updateGraph_()}dropdownCreate_(){const e=H(Q.SVG,{xmlns:Mo,"xmlns:html":Yi,"xmlns:xlink":oi,version:"1.1",height:2*ut.HALF+"px",width:2*ut.HALF+"px",style:"touch-action: none"}),t=H(Q.CIRCLE,{cx:ut.HALF,cy:ut.HALF,r:ut.RADIUS,class:"blocklyAngleCircle"},e);this.gauge_=H(Q.PATH,{class:"blocklyAngleGauge"},e),this.line_=H(Q.LINE,{x1:ut.HALF,y1:ut.HALF,class:"blocklyAngleLine"},e);for(let r=0;360>r;r+=15)H(Q.LINE,{x1:ut.HALF+ut.RADIUS,y1:ut.HALF,x2:ut.HALF+ut.RADIUS-(r%45===0?10:5),y2:ut.HALF,class:"blocklyAngleMarks",transform:"rotate("+r+","+ut.HALF+","+ut.HALF+")"},e);this.clickWrapper_=E(e,"click",this,this.hide_),this.clickSurfaceWrapper_=E(t,"pointerdown",this,this.onMouseMove_,true),this.moveSurfaceWrapper_=E(t,"pointermove",this,this.onMouseMove_,true),this.editor_=e}dropdownDispose_(){this.clickWrapper_&&(f(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(f(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(f(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null}hide_(){Qe(this),pn()}onMouseMove_(e){var t=this.gauge_.ownerSVGElement.getBoundingClientRect();const r=e.clientX-t.left-ut.HALF;e=e.clientY-t.top-ut.HALF,t=Math.atan(-e/r),isNaN(t)||(t=Ss(t),0>r?t+=180:0<e&&(t+=360),t=this.clockwise_?this.offset_+360-t:360-(this.offset_-t),this.displayMouseOrKeyboardValue_(t))}displayMouseOrKeyboardValue_(e){this.round_&&(e=Math.round(e/this.round_)*this.round_),e=this.wrapValue_(e),e!==this.value_&&this.setEditorValue_(e)}updateGraph_(){if(this.gauge_){var e=Number(this.getText())+this.offset_,t=Ve(e%360);e=["M ",ut.HALF,",",ut.HALF];var r=ut.HALF,a=ut.HALF;if(!isNaN(t)){const h=Number(this.clockwise_),C=Ve(this.offset_),D=Math.cos(C)*ut.RADIUS,Y=Math.sin(C)*-ut.RADIUS;h&&(t=2*C-t),r+=Math.cos(t)*ut.RADIUS,a-=Math.sin(t)*ut.RADIUS,t=Math.abs(Math.floor((t-C)/Math.PI)%2),h&&(t=1-t),e.push(" l ",D,",",Y," A ",ut.RADIUS,",",ut.RADIUS," 0 ",t," ",h," ",r,",",a," z")}this.gauge_.setAttribute("d",e.join("")),this.line_.setAttribute("x2",r),this.line_.setAttribute("y2",a)}}onHtmlInputKeyDown_(e){super.onHtmlInputKeyDown_(e);var t=this.getSourceBlock();if(!t)throw new ps;let r;e.keyCode===xe.LEFT?r=t.RTL?1:-1:e.keyCode===xe.RIGHT?r=t.RTL?-1:1:e.keyCode===xe.DOWN?r=-1:e.keyCode===xe.UP&&(r=1),r&&(t=this.getValue(),this.displayMouseOrKeyboardValue_(t+r*this.round_),e.preventDefault(),e.stopPropagation())}doClassValidation_(e){return e=Number(e),isNaN(e)||!isFinite(e)?null:this.wrapValue_(e)}wrapValue_(e){return e%=360,0>e&&(e+=360),e>this.wrap_&&(e-=360),e}static fromJson(e){return new this(e.angle,void 0,e)}};ut.ROUND=15,ut.HALF=50,ut.CLOCKWISE=false,ut.OFFSET=0,ut.WRAP=360,ut.RADIUS=ut.HALF-1,hs(`
.blocklyAngleCircle {
  stroke: #444;
  stroke-width: 1;
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyAngleMarks {
  stroke: #444;
  stroke-width: 1;
}

.blocklyAngleGauge {
  fill: #f88;
  fill-opacity: .8;
  pointer-events: none;
}

.blocklyAngleLine {
  stroke: #f00;
  stroke-width: 2;
  stroke-linecap: round;
  pointer-events: none;
}
`),xi("field_angle",ut),ut.prototype.DEFAULT_VALUE=0;var $u;(function(e){e.COMPASS="compass",e.PROTRACTOR="protractor"})($u||($u={}));var M_=class extends Vo{constructor(e){super(e),this.type=Xs,e&&(e.isShadow()&&(this.recordUndo=false),e=this.currentLocation_(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.recordUndo||(e.recordUndo=this.recordUndo),e}fromJson(e){if(o("Blockly.Events.BlockMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldParentId=e.oldParentId,this.oldInputName=e.oldInputName,e.oldCoordinate){var t=e.oldCoordinate.split(",");this.oldCoordinate=new Oe(Number(t[0]),Number(t[1]))}this.newParentId=e.newParentId,this.newInputName=e.newInputName,e.newCoordinate&&(t=e.newCoordinate.split(","),this.newCoordinate=new Oe(Number(t[0]),Number(t[1]))),e.recordUndo!==void 0&&(this.recordUndo=e.recordUndo)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new M_),t.oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(r=e.oldCoordinate.split(","),t.oldCoordinate=new Oe(Number(r[0]),Number(r[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(r=e.newCoordinate.split(","),t.newCoordinate=new Oe(Number(r[0]),Number(r[1]))),e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation_();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}currentLocation_(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const r=t.getParent();return r?(e.parentId=r.id,(t=r.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&Oe.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var r=t.getBlockById(this.blockId);if(r){var a=e?this.newParentId:this.oldParentId,h=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,a){var C=t.getBlockById(a);if(!C){console.warn("Can't connect to non-existent block: "+a);return}}if(r.getParent()&&r.unplug(),e)h=r.getRelativeToSurfaceXY(),r.moveBy(e.x-h.x,e.y-h.y);else{t=r.outputConnection,(!t||r.previousConnection&&r.previousConnection.isConnected())&&(t=r.previousConnection);let D;r=t.type,h?(r=C.getInput(h))&&(D=r.connection):r===Le.PREVIOUS_STATEMENT&&(D=C.nextConnection),D?t.connect(D):console.warn("Can't connect to non-existent input: "+h)}}else console.warn("Can't move non-existent block: "+this.blockId)}};ye(Se.EVENT,Xs,M_);var pr=class extends jr{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=Ft(),this.recordUndo=Us())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}fromJson(e){o("Blockly.Events.CommentBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.commentId=e.commentId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new pr),t.commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){var r=e.getEventWorkspace_();if(t){if(t=_t("xml"),!e.xml)throw Error("Ecountered a comment event without proper xml");t.appendChild(e.xml),Da(t,r)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(r=r.getCommentById(e.commentId))?r.dispose():console.warn("Can't uncreate non-existent comment: "+e.commentId)}}},D_=class extends pr{constructor(e,t,r){super(e),this.type=Ya,e&&(this.oldContents_=typeof t>"u"?"":t,this.newContents_=typeof r>"u"?"":r)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}fromJson(e){o("Blockly.Events.CommentChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldContents_=e.oldContents,this.newContents_=e.newContents}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new D_),t.oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var r=e?this.newContents_:this.oldContents_;if(!r)throw Error(e?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");t.setContent(r)}else console.warn("Can't change non-existent comment: "+this.commentId)}};ye(Se.EVENT,Ya,D_);var x_=class extends pr{constructor(e){super(e),this.type=Wr,e&&(this.xml=e.toXmlWithXY())}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=Di(this.xml),e}fromJson(e){o("Blockly.Events.CommentCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.xml=js(e.xml)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new x_),t.xml=js(e.xml),t}run(e){pr.CommentCreateDeleteHelper(this,e)}};ye(Se.EVENT,Wr,x_);var B_=class extends pr{constructor(e){super(e),this.type=Fo,e&&(this.xml=e.toXmlWithXY())}run(e){pr.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=Di(this.xml),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new B_),t.xml=js(e.xml),t}};ye(Se.EVENT,Fo,B_);var P_=class extends pr{constructor(e){super(e),this.type=Un,e&&(this.comment_=e,this.oldCoordinate_=e.getXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getXY()}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}fromJson(e){o("Blockly.Events.CommentMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e);let t=e.oldCoordinate.split(",");this.oldCoordinate_=new Oe(Number(t[0]),Number(t[1])),t=e.newCoordinate.split(","),this.newCoordinate_=new Oe(Number(t[0]),Number(t[1]))}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new P_),r=e.oldCoordinate.split(","),t.oldCoordinate_=new Oe(Number(r[0]),Number(r[1])),r=e.newCoordinate.split(","),t.newCoordinate_=new Oe(Number(r[0]),Number(r[1])),t}isNull(){return Oe.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(e=e?this.newCoordinate_:this.oldCoordinate_,!e)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var r=t.getXY();t.moveBy(e.x-r.x,e.y-r.y)}else console.warn("Can't move non-existent comment: "+this.commentId)}};ye(Se.EVENT,Un,P_);var eo=class extends jr{constructor(e,t){super(),this.model=t,this.isBlank=false,this.workspaceId=e.id}toJson(){const e=super.toJson();return e.procedureId=this.model.getId(),e}},U_=class extends eo{constructor(e,t,r){super(e,t),this.oldTypes=r,this.type=Zc,this.newTypes=t.getReturnTypes()}run(e){const t=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!t)throw Error("Cannot change the type of a procedure that does not exist in the procedure map");e?t.setReturnTypes(this.newTypes):t.setReturnTypes(this.oldTypes)}toJson(){const e=super.toJson();return e.oldTypes=this.oldTypes,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure change return event because the target procedure does not exist");return new U_(t,r,e.oldTypes)}};ye(Se.EVENT,Zc,U_);var F_=class extends eo{constructor(e,t){super(e,t),this.type=Yc}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap(),a=r.get(this.model.getId());e?a||r.add(new vl(t,this.model.getName(),this.model.getId())):a&&r.delete(this.model.getId())}toJson(){const e=super.toJson();return e.model=nd(this.model),e}static fromJson(e,t){return new F_(t,od(vl,sa,e.model,t))}};ye(Se.EVENT,Yc,F_);var G_=class extends eo{constructor(e,t){super(e,t),this.type=qa}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap(),a=r.get(this.model.getId());e?a&&r.delete(this.model.getId()):a||r.add(new vl(t,this.model.getName(),this.model.getId()))}toJson(){return super.toJson()}static fromJson(e,t){if(e=t.getProcedureMap().get(e.procedureId),!e)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");return new G_(t,e)}};ye(Se.EVENT,qa,G_);var H_=class extends eo{constructor(e,t){super(e,t),this.type=Jc,this.oldState=!t.getEnabled(),this.newState=t.getEnabled()}run(e){const t=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!t)throw Error("Cannot change the enabled state of a procedure that does not exist in the procedure map");e?t.setEnabled(this.newState):t.setEnabled(this.oldState)}toJson(){return super.toJson()}static fromJson(e,t){if(e=t.getProcedureMap().get(e.procedureId),!e)throw Error("Cannot deserialize procedure enable event because the target procedure does not exist");return new H_(t,e)}};ye(Se.EVENT,Jc,H_);var V_=class extends eo{constructor(e,t,r){super(e,t),this.oldName=r,this.type=qc,this.newName=t.getName()}run(e){const t=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!t)throw Error("Cannot change the type of a procedure that does not exist in the procedure map");e?t.setName(this.newName):t.setName(this.oldName)}toJson(){const e=super.toJson();return e.oldName=this.oldName,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure rename event because the target procedure does not exist");return new V_(t,r,e.oldName)}};ye(Se.EVENT,qc,V_);var yu=class extends eo{constructor(e,t,r){super(e,t),this.parameter=r}toJson(){const e=super.toJson();return e.parameterId=this.model.getId(),e}},W_=class extends yu{constructor(e,t,r,a){super(e,t,r),this.index=a,this.type=Qc}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap().get(this.model.getId());if(!r)throw Error("Cannot add a parameter to a procedure that does not exist in the procedure map");const a=r.getParameter(this.index);e?this.parameterMatches(a)||r.insertParameter(new sa(t,this.parameter.getName(),this.parameter.getId()),this.index):this.parameterMatches(a)&&r.deleteParameter(this.index)}parameterMatches(e){return e&&e.getId()===this.parameter.getId()}toJson(){const e=super.toJson();return e.parameter=rd(this.parameter),e.index=this.index,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize parameter create event because the target procedure does not exist");return new W_(t,r,ad(sa,e.parameter,t),e.index)}};ye(Se.EVENT,Qc,W_);var z_=class extends yu{constructor(e,t,r,a){super(e,t,r),this.index=a,this.type=eu}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap().get(this.model.getId());if(!r)throw Error("Cannot add a parameter to a procedure that does not exist in the procedure map");const a=r.getParameter(this.index);e?this.parameterMatches(a)&&r.deleteParameter(this.index):this.parameterMatches(a)||r.insertParameter(new sa(t,this.parameter.getName(),this.parameter.getId()),this.index)}parameterMatches(e){return e&&e.getId()===this.parameter.getId()}toJson(){const e=super.toJson();return e.index=this.index,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");const a=r.getParameter(e.index);return new z_(t,r,a,e.index)}};ye(Se.EVENT,eu,z_);var j_=class extends yu{constructor(e,t,r,a){super(e,t,r),this.oldName=a,this.type=tu,this.newName=r.getName()}run(e){const t=BE(this.getEventWorkspace_(),this.model.getId(),this.parameter.getId());if(!t)throw Error("Cannot rename a parameter that does not exist in the procedure map");e?t.setName(this.newName):t.setName(this.oldName)}toJson(){const e=super.toJson();return e.oldName=this.oldName,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");const a=BE(t,e.procedureId,e.parameterId);if(!a)throw Error("Cannot deserialize parameter rename event because the target parameter does not exist");return new j_(t,r,a,e.oldName)}};ye(Se.EVENT,tu,j_);var X_=class extends Zi{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=Uo,e&&(this.blockId=e.id,this.isStart=t,this.blocks=r)}toJson(){const e=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}fromJson(e){o("Blockly.Events.BlockDrag.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isStart=e.isStart,this.blockId=e.blockId,this.blocks=e.blocks}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new X_),t.isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};ye(Se.EVENT,Uo,X_);var Yb=class extends Zi{constructor(e,t,r,a){super(e?e.workspace.id:void 0),this.type=Wa,this.blockId=e?e.id:null,this.element=typeof t>"u"?"":t,this.oldValue=typeof r>"u"?"":r,this.newValue=typeof a>"u"?"":a}toJson(){const e=super.toJson();return e.element=this.element,this.newValue!==void 0&&(e.newValue=this.newValue),this.blockId&&(e.blockId=this.blockId),e}fromJson(e){super.fromJson(e),this.element=e.element,this.newValue=e.newValue,this.blockId=e.blockId}};ye(Se.EVENT,Wa,Yb);var qb=class extends jr{constructor(e){super(),this.isBlank=true,this.recordUndo=false,this.type=Go,this.isBlank=!!e,e&&(this.workspaceId=e.id)}toJson(){const e=super.toJson();if(!this.workspaceId)throw Error("The workspace ID is undefined. Either pass a workspace to the constructor, or call fromJson");return e.workspaceId=this.workspaceId,e}fromJson(e){super.fromJson(e),this.workspaceId=e.workspaceId}};ye(Se.EVENT,Go,qb),i.module$build$src$core$events$events={},i.module$build$src$core$events$events.Abstract=jr,i.module$build$src$core$events$events.BLOCK_CHANGE=Ts,i.module$build$src$core$events$events.BLOCK_CREATE=ws,i.module$build$src$core$events$events.BLOCK_DELETE=En,i.module$build$src$core$events$events.BLOCK_DRAG=Uo,i.module$build$src$core$events$events.BLOCK_MOVE=Xs,i.module$build$src$core$events$events.BUBBLE_OPEN=Pn,i.module$build$src$core$events$events.BUMP_EVENTS=yd,i.module$build$src$core$events$events.BlockBase=Vo,i.module$build$src$core$events$events.BlockChange=Xr,i.module$build$src$core$events$events.BlockCreate=Kd,i.module$build$src$core$events$events.BlockDelete=Yd,i.module$build$src$core$events$events.BlockDrag=X_,i.module$build$src$core$events$events.BlockMove=M_,i.module$build$src$core$events$events.BubbleOpen=Hd,i.module$build$src$core$events$events.BubbleType=Vd,i.module$build$src$core$events$events.CHANGE=Ts,i.module$build$src$core$events$events.CLICK=cr,i.module$build$src$core$events$events.COMMENT_CHANGE=Ya,i.module$build$src$core$events$events.COMMENT_CREATE=Wr,i.module$build$src$core$events$events.COMMENT_DELETE=Fo,i.module$build$src$core$events$events.COMMENT_MOVE=Un,i.module$build$src$core$events$events.CREATE=ws,i.module$build$src$core$events$events.Click=c_,i.module$build$src$core$events$events.ClickTarget=u_,i.module$build$src$core$events$events.CommentBase=pr,i.module$build$src$core$events$events.CommentChange=D_,i.module$build$src$core$events$events.CommentCreate=x_,i.module$build$src$core$events$events.CommentDelete=B_,i.module$build$src$core$events$events.CommentMove=P_,i.module$build$src$core$events$events.DELETE=En,i.module$build$src$core$events$events.FINISHED_LOADING=Go,i.module$build$src$core$events$events.FinishedLoading=qb,i.module$build$src$core$events$events.MARKER_MOVE=za,i.module$build$src$core$events$events.MOVE=Xs,i.module$build$src$core$events$events.MarkerMove=T_,i.module$build$src$core$events$events.ProcedureBase=eo,i.module$build$src$core$events$events.ProcedureChangeReturn=U_,i.module$build$src$core$events$events.ProcedureCreate=F_,i.module$build$src$core$events$events.ProcedureDelete=G_,i.module$build$src$core$events$events.ProcedureEnable=H_,i.module$build$src$core$events$events.ProcedureParameterBase=yu,i.module$build$src$core$events$events.ProcedureParameterCreate=W_,i.module$build$src$core$events$events.ProcedureParameterDelete=z_,i.module$build$src$core$events$events.ProcedureParameterRename=j_,i.module$build$src$core$events$events.ProcedureRename=V_,i.module$build$src$core$events$events.SELECTED=lr,i.module$build$src$core$events$events.Selected=wd,i.module$build$src$core$events$events.THEME_CHANGE=Ka,i.module$build$src$core$events$events.TOOLBOX_ITEM_SELECT=Xa,i.module$build$src$core$events$events.TRASHCAN_OPEN=ja,i.module$build$src$core$events$events.ThemeChange=h_,i.module$build$src$core$events$events.ToolboxItemSelect=o_,i.module$build$src$core$events$events.TrashcanOpen=jd,i.module$build$src$core$events$events.UI=Wa,i.module$build$src$core$events$events.Ui=Yb,i.module$build$src$core$events$events.UiBase=Zi,i.module$build$src$core$events$events.VAR_CREATE=Hr,i.module$build$src$core$events$events.VAR_DELETE=Po,i.module$build$src$core$events$events.VAR_RENAME=Va,i.module$build$src$core$events$events.VIEWPORT_CHANGE=Vr,i.module$build$src$core$events$events.VarBase=Ja,i.module$build$src$core$events$events.VarCreate=Od,i.module$build$src$core$events$events.VarDelete=y_,i.module$build$src$core$events$events.VarRename=R_,i.module$build$src$core$events$events.ViewportChange=d_,i.module$build$src$core$events$events.clearPendingUndo=Ni,i.module$build$src$core$events$events.disable=Jt,i.module$build$src$core$events$events.disableOrphans=Nt,i.module$build$src$core$events$events.enable=Zt,i.module$build$src$core$events$events.filter=bo,i.module$build$src$core$events$events.fire=Pe,i.module$build$src$core$events$events.fromJson=Re,i.module$build$src$core$events$events.get=Te,i.module$build$src$core$events$events.getDescendantIds=So,i.module$build$src$core$events$events.getGroup=Ft,i.module$build$src$core$events$events.getRecordUndo=Us,i.module$build$src$core$events$events.isEnabled=ls,i.module$build$src$core$events$events.setGroup=We,i.module$build$src$core$events$events.setRecordUndo=Ps,QE();var qs={};qs.registerCleanup=FE,qs.registerCollapse=HE,qs.registerCollapseExpandBlock=YE,qs.registerComment=XE,qs.registerDefaultOptions=QE,qs.registerDelete=JE,qs.registerDeleteAll=zE,qs.registerDisable=qE,qs.registerDuplicate=jE,qs.registerExpand=VE,qs.registerHelp=ZE,qs.registerInline=KE,qs.registerRedo=UE,qs.registerUndo=PE;var Jb=class{constructor(e,t){this.dragTarget_=null,this.wouldDeleteBlock_=false,this.draggingBlock_=e,this.draggedConnectionManager_=new Si(this.draggingBlock_),this.workspace_=t,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=JC(e)}dispose(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()}startDrag(e,t){Ft()||We(true),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),De(),this.workspace_.setResizesEnabled(false),Pa(),this.shouldDisconnect_(t)&&this.disconnectBlock_(t,e),this.draggingBlock_.setDragging(true),this.draggingBlock_.moveToDragSurface()}shouldDisconnect_(e){return!!(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(e,t){this.draggingBlock_.unplug(e),e=this.pixelsToWorkspaceUnits_(t),e=Oe.sum(this.startXY_,e),this.draggingBlock_.translate(e.x,e.y),cE(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()}fireDragStartEvent_(){const e=new(Te(Uo))(this.draggingBlock_,true,this.draggingBlock_.getDescendants(false));Pe(e)}drag(e,t){t=this.pixelsToWorkspaceUnits_(t);var r=Oe.sum(this.startXY_,t);this.draggingBlock_.moveDuringDrag(r),this.dragIcons_(t),r=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(e),this.draggedConnectionManager_.update(t,this.dragTarget_),e=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock,e!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==r&&(r&&r.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)}endDrag(e,t){this.drag(e,t),this.dragIconData_=[],this.fireDragEndEvent_(),$e(),Pa(),e=null,this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)?t=this.startXY_:(t=this.getNewLocationAfterDrag_(t),e=t.delta,t=t.newLocation),this.draggingBlock_.moveOffDragSurface(t),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(false),e?this.updateBlockAfterMove_(e):Bc(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(true),this.draggingBlock_)),this.workspace_.setResizesEnabled(true),We(false)}getNewLocationAfterDrag_(e){e=this.pixelsToWorkspaceUnits_(e);const t=Oe.sum(this.startXY_,e);return{delta:e,newLocation:t}}maybeDeleteBlock_(){return this.wouldDeleteBlock_?(this.fireMoveEvent_(),this.draggingBlock_.dispose(false,true),Ur.length=0,true):false}updateBlockAfterMove_(e){this.draggingBlock_.moveConnections(e.x,e.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()}fireDragEndEvent_(){const e=new(Te(Uo))(this.draggingBlock_,false,this.draggingBlock_.getDescendants(false));Pe(e)}updateToolboxStyle_(e){const t=this.workspace_.getToolbox();if(t){const r=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";e&&typeof t.removeStyle=="function"?t.removeStyle(r):e||typeof t.addStyle!="function"||t.addStyle(r)}}fireMoveEvent_(){const e=new(Te(Xs))(this.draggingBlock_);e.oldCoordinate=this.startXY_,e.recordNew(),Pe(e)}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(e){return e=new Oe(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e}dragIcons_(e){for(let t=0;t<this.dragIconData_.length;t++){const r=this.dragIconData_[t];r.icon.setIconLocation(Oe.sum(r.location,e))}}getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]}};ye(Se.BLOCK_DRAGGER,Bn,Jb);var FO="9.2.1",GO=i.Align$$module$build$src$core$input.LEFT,HO=i.Align$$module$build$src$core$input.CENTRE,VO=i.Align$$module$build$src$core$input.RIGHT,WO=Le.INPUT_VALUE,zO=Le.OUTPUT_VALUE,jO=Le.NEXT_STATEMENT,XO=Le.PREVIOUS_STATEMENT,KO=rt.DUMMY,YO=et.TOP,qO=et.BOTTOM,JO=et.LEFT,ZO=et.RIGHT;zn.prototype.newBlock=function(e,t){return new qo(this,e,t)},rn.prototype.newBlock=function(e,t){return new Pi(this,e,t)},rn.newTrashcan=function(e){return new qv(e)},Gs.prototype.showContextMenu=function(e){if(!this.workspace.options.readOnly){var t=[];this.isDeletable()&&this.isMovable()&&(t.push(gE(this)),t.push(pE(this))),Mc(e,t,this.RTL)}},i.Mutator$$module$build$src$core$mutator.prototype.newWorkspaceSvg=function(e){return new rn(e)},Ui.prototype.populateProcedures=function(e){e=td(e),e=e[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],Ui.NameType.PROCEDURE)};var QO=Le,re={};return re.ALIGN_CENTRE=HO,re.ALIGN_LEFT=GO,re.ALIGN_RIGHT=VO,re.ASTNode=ge,re.BasicCursor=ml,re.Block=qo,re.BlockDragSurfaceSvg=Wb,re.BlockDragger=Jb,re.BlockSvg=Pi,re.Blocks=ri,re.Bubble=it,re.BubbleDragger=tb,re.COLLAPSED_FIELD_NAME=hl,re.COLLAPSED_INPUT_NAME=ul,re.COLLAPSE_CHARS=Wv,re.CodeGenerator=i.CodeGenerator$$module$build$src$core$generator,re.CollapsibleToolboxCategory=ea,re.Comment=Vv,re.ComponentManager=ys,re.Connection=St,re.ConnectionChecker=db,re.ConnectionDB=ta,re.ConnectionType=Le,re.ContextMenu=i.module$build$src$core$contextmenu,re.ContextMenuItems=qs,re.ContextMenuRegistry=$t,re.Css=Nd,re.Cursor=s_,re.DELETE_VARIABLE_ID=t_,re.DRAG_STACK=zv,re.DUMMY_INPUT=KO,re.DeleteArea=gu,re.DragTarget=Yv,re.DropDownDiv=is,re.Events=i.module$build$src$core$events$events,re.Extensions=i.module$build$src$core$extensions,re.Field=pt,re.FieldAngle=ut,re.FieldCheckbox=i.FieldCheckbox$$module$build$src$core$field_checkbox,re.FieldColour=$i,re.FieldDropdown=tn,re.FieldImage=i.FieldImage$$module$build$src$core$field_image,re.FieldLabel=i.FieldLabel$$module$build$src$core$field_label,re.FieldLabelSerializable=Kb,re.FieldMultilineInput=N_,re.FieldNumber=L_,re.FieldTextInput=i.FieldTextInput$$module$build$src$core$field_textinput,re.FieldVariable=kl,re.Flyout=Su,re.FlyoutButton=na,re.FlyoutMetricsManager=jb,re.Generator=i.CodeGenerator$$module$build$src$core$generator,re.Gesture=bn,re.Grid=__,re.HorizontalFlyout=Xb,re.INPUT_VALUE=WO,re.Icon=hu,re.Input=Yo,re.InsertionMarkerManager=Si,re.Marker=jv,re.MarkerManager=Qa,re.Menu=Fd,re.MenuItem=Gd,re.MetricsManager=w_,re.Msg=Ye,re.Mutator=i.Mutator$$module$build$src$core$mutator,re.NEXT_STATEMENT=jO,re.Names=Ui,re.OPPOSITE_TYPE=Yr,re.OUTPUT_VALUE=zO,re.Options=sn,re.PREVIOUS_STATEMENT=XO,re.PROCEDURE_CATEGORY_NAME=Eu,re.Procedures=i.module$build$src$core$procedures,re.RENAME_VARIABLE_ID=e_,re.RenderedConnection=Ks,re.Scrollbar=Kt,re.ScrollbarPair=k_,re.ShortcutItems=Sn,re.ShortcutRegistry=It,re.TOOLBOX_AT_BOTTOM=qO,re.TOOLBOX_AT_LEFT=JO,re.TOOLBOX_AT_RIGHT=ZO,re.TOOLBOX_AT_TOP=YO,re.TabNavigateCursor=Xv,re.Theme=Kr,re.ThemeManager=hb,re.Themes=l_,re.Toolbox=eb,re.ToolboxCategory=nn,re.ToolboxItem=a_,re.ToolboxSeparator=El,re.Tooltip=ns,re.Touch=vi,re.TouchGesture=bn,re.Trashcan=qv,re.VARIABLE_CATEGORY_NAME=nu,re.VARIABLE_DYNAMIC_CATEGORY_NAME=$_,re.VERSION=FO,re.VariableMap=I_,re.VariableModel=Za,re.Variables=i.module$build$src$core$variables,re.VariablesDynamic=_r,re.VerticalFlyout=A_,re.Warning=Kv,re.WidgetDiv=en,re.Workspace=zn,re.WorkspaceAudio=_b,re.WorkspaceComment=vn,re.WorkspaceCommentSvg=Gs,re.WorkspaceDragSurfaceSvg=Vb,re.WorkspaceDragger=sb,re.WorkspaceSvg=rn,re.Xml=i.module$build$src$core$xml,re.ZoomControls=pb,re.bindEventWithChecks_=aO,re.bindEvent_=rO,re.blockAnimations=_l,re.blockRendering=yt,re.browserEvents=xn,re.bumpObjects=Tu,re.clipboard=pl,re.common=i.module$build$src$core$common,re.config=i.config$$module$build$src$core$config,re.connectionTypes=QO,re.constants=qd,re.copy=eO,re.defineBlocksWithJsonArray=M,re.dialog=ai,re.duplicate=sO,re.fieldRegistry=nl,re.geras=yn,re.getMainWorkspace=k,re.getSelected=U,re.hideChaff=ZC,re.hueToHex=nO,re.inject=HC,re.inputTypes=rt,re.isNumber=iO,re.minimalist=Ol,re.paste=tO,re.procedures=i.module$build$src$core$procedures,re.registry=Ji,re.resizeSvgContents=QC,re.serialization=UO,re.setLocale=Cd,re.setParentContainer=W,re.svgResize=j,re.thrasos=O_,re.uiPosition=qr,re.unbindEvent_=oO,re.utils=gt,re.zelos=on,i.module$build$src$core$contextmenu,i.module$build$src$core$events$events,i.module$build$src$core$msg,i.module$build$src$core$common,Object.defineProperties(re,{alert:{set:function(e){bs.warn("Blockly.alert","December 2021","December 2022"),ai.setAlert(e)},get:function(){return bs.warn("Blockly.alert","December 2021","December 2022","Blockly.dialog.alert()"),ai.alert}},confirm:{set:function(e){bs.warn("Blockly.confirm","December 2021","December 2022"),ai.setConfirm(e)},get:function(){return bs.warn("Blockly.confirm","December 2021","December 2022","Blockly.dialog.confirm()"),ai.confirm}},mainWorkspace:{set:function(e){bs.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace"),i.module$build$src$core$common.setMainWorkspace(e)},get:function(){return bs.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace"),i.module$build$src$core$common.getMainWorkspace()}},prompt:{set:function(e){bs.warn("Blockly.prompt","December 2021","December 2022"),ai.setPrompt(e)},get:function(){return bs.warn("Blockly.prompt","December 2021","December 2022","Blockly.dialog.prompt()"),ai.prompt}},selected:{get:function(){return bs.warn("Blockly.selected","version 9","version 10","Blockly.getSelected"),i.module$build$src$core$common.getSelected()},set:function(e){bs.warn("Blockly.selected","version 9","version 10","Blockly.getSelected"),i.module$build$src$core$common.setSelected(e)}},HSV_SATURATION:{get:function(){return Hs.getHsvSaturation()},set:function(e){Hs.setHsvSaturation(e)}},HSV_VALUE:{get:function(){return Hs.getHsvValue()},set:function(e){Hs.setHsvValue(e)}}}),Object.defineProperties(i.module$build$src$core$contextmenu,{currentBlock:{get:function(){return bs.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.getCurrentBlock()"),i.module$build$src$core$contextmenu.getCurrentBlock()},set:function(e){bs.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.setCurrentBlock(block)"),i.module$build$src$core$contextmenu.setCurrentBlock(e)}}}),Object.defineProperties(i.module$build$src$core$events$events,{recordUndo:{get:function(){return bs.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.getRecordUndo()"),Ze.getRecordUndo()},set:function(e){bs.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.setRecordUndo()"),Ze.setRecordUndo(e)}}}),Object.defineProperties(ns,{visible:{get:function(){return bs.warn("Blockly.Tooltip.visible","September 2021","September 2022","Blockly.Tooltip.isVisible()"),ns.isVisible()}},DIV:{get:function(){return bs.warn("Blockly.Tooltip.DIV","September 2021","September 2022","Blockly.Tooltip.getDiv()"),ns.getDiv()}}}),Object.defineProperties(en,{DIV:{get:function(){return bs.warn("Blockly.WidgetDiv.DIV","September 2021","September 2022","Blockly.WidgetDiv.getDiv()"),en.getDiv()}}}),"Blockly"in globalThis||(globalThis.Blockly={Msg:i.module$build$src$core$msg}),re.__namespace__=i,re})}(Tp)),Tp.exports}var vS;function KD(){return vS||(vS=1,function(s,n){(function(i,o){s.exports=o(lm())})(ki,function(i){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(bp)),bp.exports}var bS;function q0(){return bS||(bS=1,function(s,n){(function(i,o){s.exports=o(KD())})(ki,function(i){return i})}(vp)),vp.exports}var Sp={exports:{}},TS;function YD(){return TS||(TS=1,function(s,n){(function(i,o){s.exports=o(lm())})(ki,function(i){var o=i.__namespace__,l={};o.module$build$src$core$variables,o.module$build$src$core$utils$string,o.CodeGenerator$$module$build$src$core$generator,o.module$build$src$core$input_types.inputTypes,o.module$build$src$core$names.Names,o.NameType$$module$build$src$core$names,l.javascriptGenerator=new o.CodeGenerator$$module$build$src$core$generator("JavaScript"),l.javascriptGenerator.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(",")),l.javascriptGenerator.ORDER_ATOMIC=0,l.javascriptGenerator.ORDER_NEW=1.1,l.javascriptGenerator.ORDER_MEMBER=1.2,l.javascriptGenerator.ORDER_FUNCTION_CALL=2,l.javascriptGenerator.ORDER_INCREMENT=3,l.javascriptGenerator.ORDER_DECREMENT=3,l.javascriptGenerator.ORDER_BITWISE_NOT=4.1,l.javascriptGenerator.ORDER_UNARY_PLUS=4.2,l.javascriptGenerator.ORDER_UNARY_NEGATION=4.3,l.javascriptGenerator.ORDER_LOGICAL_NOT=4.4,l.javascriptGenerator.ORDER_TYPEOF=4.5,l.javascriptGenerator.ORDER_VOID=4.6,l.javascriptGenerator.ORDER_DELETE=4.7,l.javascriptGenerator.ORDER_AWAIT=4.8,l.javascriptGenerator.ORDER_EXPONENTIATION=5,l.javascriptGenerator.ORDER_MULTIPLICATION=5.1,l.javascriptGenerator.ORDER_DIVISION=5.2,l.javascriptGenerator.ORDER_MODULUS=5.3,l.javascriptGenerator.ORDER_SUBTRACTION=6.1,l.javascriptGenerator.ORDER_ADDITION=6.2,l.javascriptGenerator.ORDER_BITWISE_SHIFT=7,l.javascriptGenerator.ORDER_RELATIONAL=8,l.javascriptGenerator.ORDER_IN=8,l.javascriptGenerator.ORDER_INSTANCEOF=8,l.javascriptGenerator.ORDER_EQUALITY=9,l.javascriptGenerator.ORDER_BITWISE_AND=10,l.javascriptGenerator.ORDER_BITWISE_XOR=11,l.javascriptGenerator.ORDER_BITWISE_OR=12,l.javascriptGenerator.ORDER_LOGICAL_AND=13,l.javascriptGenerator.ORDER_LOGICAL_OR=14,l.javascriptGenerator.ORDER_CONDITIONAL=15,l.javascriptGenerator.ORDER_ASSIGNMENT=16,l.javascriptGenerator.ORDER_YIELD=17,l.javascriptGenerator.ORDER_COMMA=18,l.javascriptGenerator.ORDER_NONE=99,l.javascriptGenerator.ORDER_OVERRIDES=[[l.javascriptGenerator.ORDER_FUNCTION_CALL,l.javascriptGenerator.ORDER_MEMBER],[l.javascriptGenerator.ORDER_FUNCTION_CALL,l.javascriptGenerator.ORDER_FUNCTION_CALL],[l.javascriptGenerator.ORDER_MEMBER,l.javascriptGenerator.ORDER_MEMBER],[l.javascriptGenerator.ORDER_MEMBER,l.javascriptGenerator.ORDER_FUNCTION_CALL],[l.javascriptGenerator.ORDER_LOGICAL_NOT,l.javascriptGenerator.ORDER_LOGICAL_NOT],[l.javascriptGenerator.ORDER_MULTIPLICATION,l.javascriptGenerator.ORDER_MULTIPLICATION],[l.javascriptGenerator.ORDER_ADDITION,l.javascriptGenerator.ORDER_ADDITION],[l.javascriptGenerator.ORDER_LOGICAL_AND,l.javascriptGenerator.ORDER_LOGICAL_AND],[l.javascriptGenerator.ORDER_LOGICAL_OR,l.javascriptGenerator.ORDER_LOGICAL_OR]],l.javascriptGenerator.isInitialized=false,l.javascriptGenerator.init=function(c){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new o.module$build$src$core$names.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(c.getVariableMap()),this.nameDB_.populateVariables(c),this.nameDB_.populateProcedures(c);const d=[];var _=o.module$build$src$core$variables.allDeveloperVariables(c);for(let b=0;b<_.length;b++)d.push(this.nameDB_.getName(_[b],o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(c=o.module$build$src$core$variables.allUsedVarModels(c),_=0;_<c.length;_++)d.push(this.nameDB_.getName(c[_].getId(),o.NameType$$module$build$src$core$names.VARIABLE));d.length&&(this.definitions_.variables="var "+d.join(", ")+";"),this.isInitialized=true},l.javascriptGenerator.finish=function(c){const d=Object.values(this.definitions_);return c=Object.getPrototypeOf(this).finish.call(this,c),this.isInitialized=false,this.nameDB_.reset(),d.join(`

`)+`


`+c},l.javascriptGenerator.scrubNakedValue=function(c){return c+`;
`},l.javascriptGenerator.quote_=function(c){return c=c.replace(/\\/g,"\\\\").replace(/\n/g,`\\
`).replace(/'/g,"\\'"),"'"+c+"'"},l.javascriptGenerator.multiline_quote_=function(c){return c.split(/\n/g).map(this.quote_).join(` + '\\n' +
`)},l.javascriptGenerator.scrub_=function(c,d,_){let b="";if(!c.outputConnection||!c.outputConnection.targetConnection){var $=c.getCommentText();$&&($=o.module$build$src$core$utils$string.wrap($,this.COMMENT_WRAP-3),b+=this.prefixLines($+`
`,"// "));for(let E=0;E<c.inputList.length;E++)c.inputList[E].type===o.module$build$src$core$input_types.inputTypes.VALUE&&($=c.inputList[E].connection.targetBlock())&&($=this.allNestedComments($))&&(b+=this.prefixLines($,"// "))}return c=c.nextConnection&&c.nextConnection.targetBlock(),_=_?"":this.blockToCode(c),b+d+_},l.javascriptGenerator.getAdjusted=function(c,d,_,b,$){_=_||0,$=$||this.ORDER_NONE,c.workspace.options.oneBasedIndex&&_--;const E=c.workspace.options.oneBasedIndex?"1":"0";let y,f=$;return 0<_?y=f=this.ORDER_ADDITION:0>_?y=f=this.ORDER_SUBTRACTION:b&&(y=f=this.ORDER_UNARY_NEGATION),c=this.valueToCode(c,d,f)||E,o.module$build$src$core$utils$string.isNumber(c)?(c=Number(c)+_,b&&(c=-c)):(0<_?c=c+" + "+_:0>_&&(c=c+" - "+-_),b&&(c=_?"-("+c+")":"-"+c),y=Math.floor(y),$=Math.floor($),y&&$>=y&&(c="("+c+")")),c},o.NameType$$module$build$src$core$names,l.javascriptGenerator.variables_get=function(c){return[l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE),l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.variables_set=function(c){const d=l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0";return l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE)+" = "+d+`;
`},l.javascriptGenerator.variables_get_dynamic=l.javascriptGenerator.variables_get,l.javascriptGenerator.variables_set_dynamic=l.javascriptGenerator.variables_set,o.NameType$$module$build$src$core$names;var g=/^\s*'([^']|\\')*'\s*$/,m=function(c){return g.test(c)?[c,l.javascriptGenerator.ORDER_ATOMIC]:["String("+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},u=function(c,d,_){return d==="FIRST"?"0":d==="FROM_END"?c+".length - 1 - "+_:d==="LAST"?c+".length - 1":_};l.javascriptGenerator.text=function(c){return[l.javascriptGenerator.quote_(c.getFieldValue("TEXT")),l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.text_multiline=function(c){c=l.javascriptGenerator.multiline_quote_(c.getFieldValue("TEXT"));const d=c.indexOf("+")!==-1?l.javascriptGenerator.ORDER_ADDITION:l.javascriptGenerator.ORDER_ATOMIC;return[c,d]},l.javascriptGenerator.text_join=function(c){switch(c.itemCount_){case 0:return["''",l.javascriptGenerator.ORDER_ATOMIC];case 1:return c=l.javascriptGenerator.valueToCode(c,"ADD0",l.javascriptGenerator.ORDER_NONE)||"''",m(c);case 2:var d=l.javascriptGenerator.valueToCode(c,"ADD0",l.javascriptGenerator.ORDER_NONE)||"''";return c=l.javascriptGenerator.valueToCode(c,"ADD1",l.javascriptGenerator.ORDER_NONE)||"''",[m(d)[0]+" + "+m(c)[0],l.javascriptGenerator.ORDER_ADDITION];default:d=Array(c.itemCount_);for(let _=0;_<c.itemCount_;_++)d[_]=l.javascriptGenerator.valueToCode(c,"ADD"+_,l.javascriptGenerator.ORDER_NONE)||"''";return["["+d.join(",")+"].join('')",l.javascriptGenerator.ORDER_FUNCTION_CALL]}},l.javascriptGenerator.text_append=function(c){const d=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE);return c=l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''",d+" += "+m(c)[0]+`;
`},l.javascriptGenerator.text_length=function(c){return[(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"''")+".length",l.javascriptGenerator.ORDER_MEMBER]},l.javascriptGenerator.text_isEmpty=function(c){return["!"+(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"''")+".length",l.javascriptGenerator.ORDER_LOGICAL_NOT]},l.javascriptGenerator.text_indexOf=function(c){var d=c.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf";const _=l.javascriptGenerator.valueToCode(c,"FIND",l.javascriptGenerator.ORDER_NONE)||"''";return d=(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"''")+"."+d+"("+_+")",c.workspace.options.oneBasedIndex?[d+" + 1",l.javascriptGenerator.ORDER_ADDITION]:[d,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_charAt=function(c){const d=c.getFieldValue("WHERE")||"FROM_START",_=l.javascriptGenerator.valueToCode(c,"VALUE",d==="RANDOM"?l.javascriptGenerator.ORDER_NONE:l.javascriptGenerator.ORDER_MEMBER)||"''";switch(d){case"FIRST":return[_+".charAt(0)",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"LAST":return[_+".slice(-1)",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"FROM_START":return c=l.javascriptGenerator.getAdjusted(c,"AT"),[_+".charAt("+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"FROM_END":return c=l.javascriptGenerator.getAdjusted(c,"AT",1,true),[_+".slice("+c+").charAt(0)",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"RANDOM":return[l.javascriptGenerator.provideFunction_("textRandomLetter",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(text) {
  var x = Math.floor(Math.random() * text.length);
  return text[x];
}
`)+"("+_+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},l.javascriptGenerator.text_getSubstring=function(c){var d=c.getFieldValue("WHERE1"),_=c.getFieldValue("WHERE2"),b=d!=="FROM_END"&&d!=="LAST"&&_!=="FROM_END"&&_!=="LAST",$=l.javascriptGenerator.valueToCode(c,"STRING",b?l.javascriptGenerator.ORDER_MEMBER:l.javascriptGenerator.ORDER_NONE)||"''";if(d==="FIRST"&&_==="LAST")return[$,l.javascriptGenerator.ORDER_NONE];if($.match(/^'?\w+'?$/)||b){switch(d){case"FROM_START":d=l.javascriptGenerator.getAdjusted(c,"AT1");break;case"FROM_END":d=l.javascriptGenerator.getAdjusted(c,"AT1",1,false,l.javascriptGenerator.ORDER_SUBTRACTION),d=$+".length - "+d;break;case"FIRST":d="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(_){case"FROM_START":_=l.javascriptGenerator.getAdjusted(c,"AT2",1);break;case"FROM_END":_=l.javascriptGenerator.getAdjusted(c,"AT2",0,false,l.javascriptGenerator.ORDER_SUBTRACTION),_=$+".length - "+_;break;case"LAST":_=$+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}$=$+".slice("+d+", "+_+")"}else{b=l.javascriptGenerator.getAdjusted(c,"AT1"),c=l.javascriptGenerator.getAdjusted(c,"AT2");const E={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};$=l.javascriptGenerator.provideFunction_("subsequence"+E[d]+E[_],`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(sequence${d==="FROM_END"||d==="FROM_START"?", at1":""}${_==="FROM_END"||_==="FROM_START"?", at2":""}) {
  var start = ${u("sequence",d,"at1")};
  var end = ${u("sequence",_,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+$+(d==="FROM_END"||d==="FROM_START"?", "+b:"")+(_==="FROM_END"||_==="FROM_START"?", "+c:"")+")"}return[$,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_changeCase=function(c){const d={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[c.getFieldValue("CASE")];return c=l.javascriptGenerator.valueToCode(c,"TEXT",d?l.javascriptGenerator.ORDER_MEMBER:l.javascriptGenerator.ORDER_NONE)||"''",[d?c+d:l.javascriptGenerator.provideFunction_("textToTitleCase",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(str) {
  return str.replace(/\\S+/g,
      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});
}
`)+"("+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_trim=function(c){const d={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[c.getFieldValue("MODE")];return[(l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_MEMBER)||"''")+d,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_print=function(c){return"window.alert("+(l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''")+`);
`},l.javascriptGenerator.text_prompt_ext=function(c){let d="window.prompt("+(c.getField("TEXT")?l.javascriptGenerator.quote_(c.getFieldValue("TEXT")):l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''")+")";return c.getFieldValue("TYPE")==="NUMBER"&&(d="Number("+d+")"),[d,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_prompt=l.javascriptGenerator.text_prompt_ext,l.javascriptGenerator.text_count=function(c){const d=l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''";return c=l.javascriptGenerator.valueToCode(c,"SUB",l.javascriptGenerator.ORDER_NONE)||"''",[l.javascriptGenerator.provideFunction_("textCount",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {
  if (needle.length === 0) {
    return haystack.length + 1;
  } else {
    return haystack.split(needle).length - 1;
  }
}
`)+"("+d+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_replace=function(c){const d=l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''",_=l.javascriptGenerator.valueToCode(c,"FROM",l.javascriptGenerator.ORDER_NONE)||"''";return c=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_NONE)||"''",[l.javascriptGenerator.provideFunction_("textReplace",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {
  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')
                 .replace(/\\x08/g, '\\\\x08');
  return haystack.replace(new RegExp(needle, 'g'), replacement);
}
`)+"("+d+", "+_+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_reverse=function(c){return[(l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_MEMBER)||"''")+".split('').reverse().join('')",l.javascriptGenerator.ORDER_FUNCTION_CALL]},o.NameType$$module$build$src$core$names,l.javascriptGenerator.procedures_defreturn=function(c){const d=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("NAME"),o.NameType$$module$build$src$core$names.PROCEDURE);var _="";l.javascriptGenerator.STATEMENT_PREFIX&&(_+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,c)),l.javascriptGenerator.STATEMENT_SUFFIX&&(_+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c)),_&&(_=l.javascriptGenerator.prefixLines(_,l.javascriptGenerator.INDENT));let b="";l.javascriptGenerator.INFINITE_LOOP_TRAP&&(b=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.INFINITE_LOOP_TRAP,c),l.javascriptGenerator.INDENT));const $=l.javascriptGenerator.statementToCode(c,"STACK");let E=l.javascriptGenerator.valueToCode(c,"RETURN",l.javascriptGenerator.ORDER_NONE)||"",y="";$&&E&&(y=_),E&&(E=l.javascriptGenerator.INDENT+"return "+E+`;
`);const f=[],v=c.getVars();for(let T=0;T<v.length;T++)f[T]=l.javascriptGenerator.nameDB_.getName(v[T],o.NameType$$module$build$src$core$names.VARIABLE);return _="function "+d+"("+f.join(", ")+`) {
`+_+b+$+y+E+"}",_=l.javascriptGenerator.scrub_(c,_),l.javascriptGenerator.definitions_["%"+d]=_,null},l.javascriptGenerator.procedures_defnoreturn=l.javascriptGenerator.procedures_defreturn,l.javascriptGenerator.procedures_callreturn=function(c){const d=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("NAME"),o.NameType$$module$build$src$core$names.PROCEDURE),_=[],b=c.getVars();for(let $=0;$<b.length;$++)_[$]=l.javascriptGenerator.valueToCode(c,"ARG"+$,l.javascriptGenerator.ORDER_NONE)||"null";return[d+"("+_.join(", ")+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.procedures_callnoreturn=function(c){return l.javascriptGenerator.procedures_callreturn(c)[0]+`;
`},l.javascriptGenerator.procedures_ifreturn=function(c){let d="if ("+(l.javascriptGenerator.valueToCode(c,"CONDITION",l.javascriptGenerator.ORDER_NONE)||"false")+`) {
`;return l.javascriptGenerator.STATEMENT_SUFFIX&&(d+=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c),l.javascriptGenerator.INDENT)),c.hasReturnValue_?(c=l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_NONE)||"null",d+=l.javascriptGenerator.INDENT+"return "+c+`;
`):d+=l.javascriptGenerator.INDENT+`return;
`,d+`}
`},o.NameType$$module$build$src$core$names,l.javascriptGenerator.math_number=function(c){return c=Number(c.getFieldValue("NUM")),[c,0<=c?l.javascriptGenerator.ORDER_ATOMIC:l.javascriptGenerator.ORDER_UNARY_NEGATION]},l.javascriptGenerator.math_arithmetic=function(c){var d={ADD:[" + ",l.javascriptGenerator.ORDER_ADDITION],MINUS:[" - ",l.javascriptGenerator.ORDER_SUBTRACTION],MULTIPLY:[" * ",l.javascriptGenerator.ORDER_MULTIPLICATION],DIVIDE:[" / ",l.javascriptGenerator.ORDER_DIVISION],POWER:[null,l.javascriptGenerator.ORDER_NONE]}[c.getFieldValue("OP")];const _=d[0];d=d[1];const b=l.javascriptGenerator.valueToCode(c,"A",d)||"0";return c=l.javascriptGenerator.valueToCode(c,"B",d)||"0",_?[b+_+c,d]:["Math.pow("+b+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_single=function(c){const d=c.getFieldValue("OP");let _;if(d==="NEG")return c=l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_UNARY_NEGATION)||"0",c[0]==="-"&&(c=" "+c),["-"+c,l.javascriptGenerator.ORDER_UNARY_NEGATION];switch(c=d==="SIN"||d==="COS"||d==="TAN"?l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_DIVISION)||"0":l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_NONE)||"0",d){case"ABS":_="Math.abs("+c+")";break;case"ROOT":_="Math.sqrt("+c+")";break;case"LN":_="Math.log("+c+")";break;case"EXP":_="Math.exp("+c+")";break;case"POW10":_="Math.pow(10,"+c+")";break;case"ROUND":_="Math.round("+c+")";break;case"ROUNDUP":_="Math.ceil("+c+")";break;case"ROUNDDOWN":_="Math.floor("+c+")";break;case"SIN":_="Math.sin("+c+" / 180 * Math.PI)";break;case"COS":_="Math.cos("+c+" / 180 * Math.PI)";break;case"TAN":_="Math.tan("+c+" / 180 * Math.PI)"}if(_)return[_,l.javascriptGenerator.ORDER_FUNCTION_CALL];switch(d){case"LOG10":_="Math.log("+c+") / Math.log(10)";break;case"ASIN":_="Math.asin("+c+") / Math.PI * 180";break;case"ACOS":_="Math.acos("+c+") / Math.PI * 180";break;case"ATAN":_="Math.atan("+c+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+d)}return[_,l.javascriptGenerator.ORDER_DIVISION]},l.javascriptGenerator.math_constant=function(c){return{PI:["Math.PI",l.javascriptGenerator.ORDER_MEMBER],E:["Math.E",l.javascriptGenerator.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",l.javascriptGenerator.ORDER_DIVISION],SQRT2:["Math.SQRT2",l.javascriptGenerator.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",l.javascriptGenerator.ORDER_MEMBER],INFINITY:["Infinity",l.javascriptGenerator.ORDER_ATOMIC]}[c.getFieldValue("CONSTANT")]},l.javascriptGenerator.math_number_property=function(c){var d={EVEN:[" % 2 === 0",l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],ODD:[" % 2 === 1",l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],WHOLE:[" % 1 === 0",l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],POSITIVE:[" > 0",l.javascriptGenerator.ORDER_RELATIONAL,l.javascriptGenerator.ORDER_RELATIONAL],NEGATIVE:[" < 0",l.javascriptGenerator.ORDER_RELATIONAL,l.javascriptGenerator.ORDER_RELATIONAL],DIVISIBLE_BY:[null,l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],PRIME:[null,l.javascriptGenerator.ORDER_NONE,l.javascriptGenerator.ORDER_FUNCTION_CALL]};const _=c.getFieldValue("PROPERTY"),[b,$,E]=d[_];return d=l.javascriptGenerator.valueToCode(c,"NUMBER_TO_CHECK",$)||"0",_==="PRIME"?c=l.javascriptGenerator.provideFunction_("mathIsPrime",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(n) {
  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  if (n == 2 || n == 3) {
    return true;
  }
  // False if n is NaN, negative, is 1, or not whole.
  // And false if n is divisible by 2 or 3.
  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {
    return false;
  }
  // Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {
    if (n % (x - 1) === 0 || n % (x + 1) === 0) {
      return false;
    }
  }
  return true;
}
`)+"("+d+")":_==="DIVISIBLE_BY"?(c=l.javascriptGenerator.valueToCode(c,"DIVISOR",l.javascriptGenerator.ORDER_MODULUS)||"0",c=d+" % "+c+" === 0"):c=d+b,[c,E]},l.javascriptGenerator.math_change=function(c){const d=l.javascriptGenerator.valueToCode(c,"DELTA",l.javascriptGenerator.ORDER_ADDITION)||"0";return c=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE),c+" = (typeof "+c+" === 'number' ? "+c+" : 0) + "+d+`;
`},l.javascriptGenerator.math_round=l.javascriptGenerator.math_single,l.javascriptGenerator.math_trig=l.javascriptGenerator.math_single,l.javascriptGenerator.math_on_list=function(c){var d=c.getFieldValue("OP");switch(d){case"SUM":c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_MEMBER)||"[]",c+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c="Math.min.apply(null, "+c+")";break;case"MAX":c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c="Math.max.apply(null, "+c+")";break;case"AVERAGE":d=l.javascriptGenerator.provideFunction_("mathMean",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=d+"("+c+")";break;case"MEDIAN":d=l.javascriptGenerator.provideFunction_("mathMedian",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  var localList = myList.filter(function (x) {return typeof x === 'number';});
  if (!localList.length) return null;
  localList.sort(function(a, b) {return b - a;});
  if (localList.length % 2 === 0) {
    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;
  } else {
    return localList[(localList.length - 1) / 2];
  }
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=d+"("+c+")";break;case"MODE":d=l.javascriptGenerator.provideFunction_("mathModes",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(values) {
  var modes = [];
  var counts = [];
  var maxCount = 0;
  for (var i = 0; i < values.length; i++) {
    var value = values[i];
    var found = false;
    var thisCount;
    for (var j = 0; j < counts.length; j++) {
      if (counts[j][0] === value) {
        thisCount = ++counts[j][1];
        found = true;
        break;
      }
    }
    if (!found) {
      counts.push([value, 1]);
      thisCount = 1;
    }
    maxCount = Math.max(thisCount, maxCount);
  }
  for (var j = 0; j < counts.length; j++) {
    if (counts[j][1] === maxCount) {
        modes.push(counts[j][0]);
    }
  }
  return modes;
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=d+"("+c+")";break;case"STD_DEV":d=l.javascriptGenerator.provideFunction_("mathStandardDeviation",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(numbers) {
  var n = numbers.length;
  if (!n) return null;
  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;
  var variance = 0;
  for (var j = 0; j < n; j++) {
    variance += Math.pow(numbers[j] - mean, 2);
  }
  variance = variance / n;
  return Math.sqrt(variance);
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=d+"("+c+")";break;case"RANDOM":d=l.javascriptGenerator.provideFunction_("mathRandomList",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(list) {
  var x = Math.floor(Math.random() * list.length);
  return list[x];
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=d+"("+c+")";break;default:throw Error("Unknown operator: "+d)}return[c,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_modulo=function(c){const d=l.javascriptGenerator.valueToCode(c,"DIVIDEND",l.javascriptGenerator.ORDER_MODULUS)||"0";return c=l.javascriptGenerator.valueToCode(c,"DIVISOR",l.javascriptGenerator.ORDER_MODULUS)||"0",[d+" % "+c,l.javascriptGenerator.ORDER_MODULUS]},l.javascriptGenerator.math_constrain=function(c){const d=l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_NONE)||"0",_=l.javascriptGenerator.valueToCode(c,"LOW",l.javascriptGenerator.ORDER_NONE)||"0";return c=l.javascriptGenerator.valueToCode(c,"HIGH",l.javascriptGenerator.ORDER_NONE)||"Infinity",["Math.min(Math.max("+d+", "+_+"), "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_random_int=function(c){const d=l.javascriptGenerator.valueToCode(c,"FROM",l.javascriptGenerator.ORDER_NONE)||"0";return c=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_NONE)||"0",[l.javascriptGenerator.provideFunction_("mathRandomInt",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(a, b) {
  if (a > b) {
    // Swap a and b to ensure a is smaller.
    var c = a;
    a = b;
    b = c;
  }
  return Math.floor(Math.random() * (b - a + 1) + a);
}
`)+"("+d+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_random_float=function(c){return["Math.random()",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_atan2=function(c){const d=l.javascriptGenerator.valueToCode(c,"X",l.javascriptGenerator.ORDER_NONE)||"0";return["Math.atan2("+(l.javascriptGenerator.valueToCode(c,"Y",l.javascriptGenerator.ORDER_NONE)||"0")+", "+d+") / Math.PI * 180",l.javascriptGenerator.ORDER_DIVISION]},o.module$build$src$core$utils$string,o.NameType$$module$build$src$core$names,l.javascriptGenerator.controls_repeat_ext=function(c){let d;d=c.getField("TIMES")?String(Number(c.getFieldValue("TIMES"))):l.javascriptGenerator.valueToCode(c,"TIMES",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0";let _=l.javascriptGenerator.statementToCode(c,"DO");_=l.javascriptGenerator.addLoopTrap(_,c),c="";const b=l.javascriptGenerator.nameDB_.getDistinctName("count",o.NameType$$module$build$src$core$names.VARIABLE);let $=d;return d.match(/^\w+$/)||o.module$build$src$core$utils$string.isNumber(d)||($=l.javascriptGenerator.nameDB_.getDistinctName("repeat_end",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+$+" = "+d+`;
`),c+("for (var "+b+" = 0; "+b+" < "+$+"; "+b+`++) {
`+_+`}
`)},l.javascriptGenerator.controls_repeat=l.javascriptGenerator.controls_repeat_ext,l.javascriptGenerator.controls_whileUntil=function(c){const d=c.getFieldValue("MODE")==="UNTIL";let _=l.javascriptGenerator.valueToCode(c,"BOOL",d?l.javascriptGenerator.ORDER_LOGICAL_NOT:l.javascriptGenerator.ORDER_NONE)||"false",b=l.javascriptGenerator.statementToCode(c,"DO");return b=l.javascriptGenerator.addLoopTrap(b,c),d&&(_="!"+_),"while ("+_+`) {
`+b+`}
`},l.javascriptGenerator.controls_for=function(c){var d=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE),_=l.javascriptGenerator.valueToCode(c,"FROM",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0",b=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0";const $=l.javascriptGenerator.valueToCode(c,"BY",l.javascriptGenerator.ORDER_ASSIGNMENT)||"1";let E=l.javascriptGenerator.statementToCode(c,"DO");if(E=l.javascriptGenerator.addLoopTrap(E,c),o.module$build$src$core$utils$string.isNumber(_)&&o.module$build$src$core$utils$string.isNumber(b)&&o.module$build$src$core$utils$string.isNumber($)){var y=Number(_)<=Number(b);c="for ("+d+" = "+_+"; "+d+(y?" <= ":" >= ")+b+"; "+d,d=Math.abs(Number($)),c=d===1?c+(y?"++":"--"):c+((y?" += ":" -= ")+d),c+=`) {
`+E+`}
`}else c="",y=_,_.match(/^\w+$/)||o.module$build$src$core$utils$string.isNumber(_)||(y=l.javascriptGenerator.nameDB_.getDistinctName(d+"_start",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+y+" = "+_+`;
`),_=b,b.match(/^\w+$/)||o.module$build$src$core$utils$string.isNumber(b)||(_=l.javascriptGenerator.nameDB_.getDistinctName(d+"_end",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+_+" = "+b+`;
`),b=l.javascriptGenerator.nameDB_.getDistinctName(d+"_inc",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+b+" = ",c=o.module$build$src$core$utils$string.isNumber($)?c+(Math.abs($)+`;
`):c+("Math.abs("+$+`);
`),c+="if ("+y+" > "+_+`) {
`,c+=l.javascriptGenerator.INDENT+b+" = -"+b+`;
`,c=c+`}
for (`+(d+" = "+y+"; "+b+" >= 0 ? "+d+" <= "+_+" : "+d+" >= "+_+"; "+d+" += "+b+`) {
`+E+`}
`);return c},l.javascriptGenerator.controls_forEach=function(c){const d=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE);var _=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_ASSIGNMENT)||"[]";let b=l.javascriptGenerator.statementToCode(c,"DO");b=l.javascriptGenerator.addLoopTrap(b,c),c="";let $=_;return _.match(/^\w+$/)||($=l.javascriptGenerator.nameDB_.getDistinctName(d+"_list",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+$+" = "+_+`;
`),_=l.javascriptGenerator.nameDB_.getDistinctName(d+"_index",o.NameType$$module$build$src$core$names.VARIABLE),b=l.javascriptGenerator.INDENT+d+" = "+$+"["+_+`];
`+b,c+("for (var "+_+" in "+$+`) {
`+b+`}
`)},l.javascriptGenerator.controls_flow_statements=function(c){let d="";if(l.javascriptGenerator.STATEMENT_PREFIX&&(d+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,c)),l.javascriptGenerator.STATEMENT_SUFFIX&&(d+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c)),l.javascriptGenerator.STATEMENT_PREFIX){const _=c.getSurroundLoop();_&&!_.suppressPrefixSuffix&&(d+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,_))}switch(c.getFieldValue("FLOW")){case"BREAK":return d+`break;
`;case"CONTINUE":return d+`continue;
`}throw Error("Unknown flow statement.")},l.javascriptGenerator.controls_if=function(c){var d=0;let _="";l.javascriptGenerator.STATEMENT_PREFIX&&(_+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,c));do{const b=l.javascriptGenerator.valueToCode(c,"IF"+d,l.javascriptGenerator.ORDER_NONE)||"false";let $=l.javascriptGenerator.statementToCode(c,"DO"+d);l.javascriptGenerator.STATEMENT_SUFFIX&&($=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c),l.javascriptGenerator.INDENT)+$),_+=(0<d?" else ":"")+"if ("+b+`) {
`+$+"}",d++}while(c.getInput("IF"+d));return(c.getInput("ELSE")||l.javascriptGenerator.STATEMENT_SUFFIX)&&(d=l.javascriptGenerator.statementToCode(c,"ELSE"),l.javascriptGenerator.STATEMENT_SUFFIX&&(d=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c),l.javascriptGenerator.INDENT)+d),_+=` else {
`+d+"}"),_+`
`},l.javascriptGenerator.controls_ifelse=l.javascriptGenerator.controls_if,l.javascriptGenerator.logic_compare=function(c){const d={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[c.getFieldValue("OP")],_=d==="=="||d==="!="?l.javascriptGenerator.ORDER_EQUALITY:l.javascriptGenerator.ORDER_RELATIONAL,b=l.javascriptGenerator.valueToCode(c,"A",_)||"0";return c=l.javascriptGenerator.valueToCode(c,"B",_)||"0",[b+" "+d+" "+c,_]},l.javascriptGenerator.logic_operation=function(c){const d=c.getFieldValue("OP")==="AND"?"&&":"||",_=d==="&&"?l.javascriptGenerator.ORDER_LOGICAL_AND:l.javascriptGenerator.ORDER_LOGICAL_OR;let b=l.javascriptGenerator.valueToCode(c,"A",_);if(c=l.javascriptGenerator.valueToCode(c,"B",_),b||c){const $=d==="&&"?"true":"false";b||(b=$),c||(c=$)}else c=b="false";return[b+" "+d+" "+c,_]},l.javascriptGenerator.logic_negate=function(c){const d=l.javascriptGenerator.ORDER_LOGICAL_NOT;return["!"+(l.javascriptGenerator.valueToCode(c,"BOOL",d)||"true"),d]},l.javascriptGenerator.logic_boolean=function(c){return[c.getFieldValue("BOOL")==="TRUE"?"true":"false",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.logic_null=function(c){return["null",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.logic_ternary=function(c){const d=l.javascriptGenerator.valueToCode(c,"IF",l.javascriptGenerator.ORDER_CONDITIONAL)||"false",_=l.javascriptGenerator.valueToCode(c,"THEN",l.javascriptGenerator.ORDER_CONDITIONAL)||"null";return c=l.javascriptGenerator.valueToCode(c,"ELSE",l.javascriptGenerator.ORDER_CONDITIONAL)||"null",[d+" ? "+_+" : "+c,l.javascriptGenerator.ORDER_CONDITIONAL]},o.NameType$$module$build$src$core$names,l.javascriptGenerator.lists_create_empty=function(c){return["[]",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.lists_create_with=function(c){const d=Array(c.itemCount_);for(let _=0;_<c.itemCount_;_++)d[_]=l.javascriptGenerator.valueToCode(c,"ADD"+_,l.javascriptGenerator.ORDER_NONE)||"null";return["["+d.join(", ")+"]",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.lists_repeat=function(c){const d=l.javascriptGenerator.provideFunction_("listsRepeat",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(value, n) {
  var array = [];
  for (var i = 0; i < n; i++) {
    array[i] = value;
  }
  return array;
}
`),_=l.javascriptGenerator.valueToCode(c,"ITEM",l.javascriptGenerator.ORDER_NONE)||"null";return c=l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_NONE)||"0",[d+"("+_+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_length=function(c){return[(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"[]")+".length",l.javascriptGenerator.ORDER_MEMBER]},l.javascriptGenerator.lists_isEmpty=function(c){return["!"+(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"[]")+".length",l.javascriptGenerator.ORDER_LOGICAL_NOT]},l.javascriptGenerator.lists_indexOf=function(c){var d=c.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf";const _=l.javascriptGenerator.valueToCode(c,"FIND",l.javascriptGenerator.ORDER_NONE)||"''";return d=(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"[]")+"."+d+"("+_+")",c.workspace.options.oneBasedIndex?[d+" + 1",l.javascriptGenerator.ORDER_ADDITION]:[d,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_getIndex=function(c){const d=c.getFieldValue("MODE")||"GET",_=c.getFieldValue("WHERE")||"FROM_START";var b=l.javascriptGenerator.valueToCode(c,"VALUE",_==="RANDOM"?l.javascriptGenerator.ORDER_NONE:l.javascriptGenerator.ORDER_MEMBER)||"[]";switch(_){case"FIRST":if(d==="GET")return[b+"[0]",l.javascriptGenerator.ORDER_MEMBER];if(d==="GET_REMOVE")return[b+".shift()",l.javascriptGenerator.ORDER_MEMBER];if(d==="REMOVE")return b+`.shift();
`;break;case"LAST":if(d==="GET")return[b+".slice(-1)[0]",l.javascriptGenerator.ORDER_MEMBER];if(d==="GET_REMOVE")return[b+".pop()",l.javascriptGenerator.ORDER_MEMBER];if(d==="REMOVE")return b+`.pop();
`;break;case"FROM_START":if(c=l.javascriptGenerator.getAdjusted(c,"AT"),d==="GET")return[b+"["+c+"]",l.javascriptGenerator.ORDER_MEMBER];if(d==="GET_REMOVE")return[b+".splice("+c+", 1)[0]",l.javascriptGenerator.ORDER_FUNCTION_CALL];if(d==="REMOVE")return b+".splice("+c+`, 1);
`;break;case"FROM_END":if(c=l.javascriptGenerator.getAdjusted(c,"AT",1,true),d==="GET")return[b+".slice("+c+")[0]",l.javascriptGenerator.ORDER_FUNCTION_CALL];if(d==="GET_REMOVE")return[b+".splice("+c+", 1)[0]",l.javascriptGenerator.ORDER_FUNCTION_CALL];if(d==="REMOVE")return b+".splice("+c+", 1);";break;case"RANDOM":if(b=l.javascriptGenerator.provideFunction_("listsGetRandomItem",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {
  var x = Math.floor(Math.random() * list.length);
  if (remove) {
    return list.splice(x, 1)[0];
  } else {
    return list[x];
  }
}
`)+"("+b+", "+(d!=="GET")+")",d==="GET"||d==="GET_REMOVE")return[b,l.javascriptGenerator.ORDER_FUNCTION_CALL];if(d==="REMOVE")return b+`;
`}throw Error("Unhandled combination (lists_getIndex).")},l.javascriptGenerator.lists_setIndex=function(c){function d(){if(_.match(/^\w+$/))return"";const y=l.javascriptGenerator.nameDB_.getDistinctName("tmpList",o.NameType$$module$build$src$core$names.VARIABLE),f="var "+y+" = "+_+`;
`;return _=y,f}let _=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_MEMBER)||"[]";const b=c.getFieldValue("MODE")||"GET";var $=c.getFieldValue("WHERE")||"FROM_START";const E=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_ASSIGNMENT)||"null";switch($){case"FIRST":if(b==="SET")return _+"[0] = "+E+`;
`;if(b==="INSERT")return _+".unshift("+E+`);
`;break;case"LAST":if(b==="SET")return d()+(_+"["+_+".length - 1] = "+E+`;
`);if(b==="INSERT")return _+".push("+E+`);
`;break;case"FROM_START":if(c=l.javascriptGenerator.getAdjusted(c,"AT"),b==="SET")return _+"["+c+"] = "+E+`;
`;if(b==="INSERT")return _+".splice("+c+", 0, "+E+`);
`;break;case"FROM_END":if(c=l.javascriptGenerator.getAdjusted(c,"AT",1,false,l.javascriptGenerator.ORDER_SUBTRACTION),$=d(),b==="SET")return $+(_+"["+_+".length - "+c+"] = "+E+`;
`);if(b==="INSERT")return $+(_+".splice("+_+".length - "+c+", 0, "+E+`);
`);break;case"RANDOM":if(c=d(),$=l.javascriptGenerator.nameDB_.getDistinctName("tmpX",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+$+" = Math.floor(Math.random() * "+_+`.length);
`,b==="SET")return c+(_+"["+$+"] = "+E+`;
`);if(b==="INSERT")return c+(_+".splice("+$+", 0, "+E+`);
`)}throw Error("Unhandled combination (lists_setIndex).")};var p=function(c,d,_){return d==="FIRST"?"0":d==="FROM_END"?c+".length - 1 - "+_:d==="LAST"?c+".length - 1":_};return l.javascriptGenerator.lists_getSublist=function(c){var d=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_MEMBER)||"[]",_=c.getFieldValue("WHERE1"),b=c.getFieldValue("WHERE2");if(_==="FIRST"&&b==="LAST")d+=".slice(0)";else if(d.match(/^\w+$/)||_!=="FROM_END"&&b==="FROM_START"){switch(_){case"FROM_START":_=l.javascriptGenerator.getAdjusted(c,"AT1");break;case"FROM_END":_=l.javascriptGenerator.getAdjusted(c,"AT1",1,false,l.javascriptGenerator.ORDER_SUBTRACTION),_=d+".length - "+_;break;case"FIRST":_="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(b){case"FROM_START":b=l.javascriptGenerator.getAdjusted(c,"AT2",1);break;case"FROM_END":b=l.javascriptGenerator.getAdjusted(c,"AT2",0,false,l.javascriptGenerator.ORDER_SUBTRACTION),b=d+".length - "+b;break;case"LAST":b=d+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}d=d+".slice("+_+", "+b+")"}else{const $=l.javascriptGenerator.getAdjusted(c,"AT1");c=l.javascriptGenerator.getAdjusted(c,"AT2");const E={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};d=l.javascriptGenerator.provideFunction_("subsequence"+E[_]+E[b],`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(sequence${_==="FROM_END"||_==="FROM_START"?", at1":""}${b==="FROM_END"||b==="FROM_START"?", at2":""}) {
  var start = ${p("sequence",_,"at1")};
  var end = ${p("sequence",b,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+d+(_==="FROM_END"||_==="FROM_START"?", "+$:"")+(b==="FROM_END"||b==="FROM_START"?", "+c:"")+")"}return[d,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_sort=function(c){const d=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_FUNCTION_CALL)||"[]",_=c.getFieldValue("DIRECTION")==="1"?1:-1;c=c.getFieldValue("TYPE");const b=l.javascriptGenerator.provideFunction_("listsGetSortCompare",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {
  var compareFuncs = {
    'NUMERIC': function(a, b) {
        return Number(a) - Number(b); },
    'TEXT': function(a, b) {
        return a.toString() > b.toString() ? 1 : -1; },
    'IGNORE_CASE': function(a, b) {
        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },
  };
  var compare = compareFuncs[type];
  return function(a, b) { return compare(a, b) * direction; };
}
      `);return[d+".slice().sort("+b+'("'+c+'", '+_+"))",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_split=function(c){let d=l.javascriptGenerator.valueToCode(c,"INPUT",l.javascriptGenerator.ORDER_MEMBER);const _=l.javascriptGenerator.valueToCode(c,"DELIM",l.javascriptGenerator.ORDER_NONE)||"''";if(c=c.getFieldValue("MODE"),c==="SPLIT")d||(d="''"),c="split";else if(c==="JOIN")d||(d="[]"),c="join";else throw Error("Unknown mode: "+c);return[d+"."+c+"("+_+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_reverse=function(c){return[(l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.colour_picker=function(c){return[l.javascriptGenerator.quote_(c.getFieldValue("COLOUR")),l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.colour_random=function(c){return[l.javascriptGenerator.provideFunction_("colourRandom",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}() {
  var num = Math.floor(Math.random() * Math.pow(2, 24));
  return '#' + ('00000' + num.toString(16)).substr(-6);
}
`)+"()",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.colour_rgb=function(c){const d=l.javascriptGenerator.valueToCode(c,"RED",l.javascriptGenerator.ORDER_NONE)||0,_=l.javascriptGenerator.valueToCode(c,"GREEN",l.javascriptGenerator.ORDER_NONE)||0;return c=l.javascriptGenerator.valueToCode(c,"BLUE",l.javascriptGenerator.ORDER_NONE)||0,[l.javascriptGenerator.provideFunction_("colourRgb",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {
  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;
  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;
  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+d+", "+_+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.colour_blend=function(c){const d=l.javascriptGenerator.valueToCode(c,"COLOUR1",l.javascriptGenerator.ORDER_NONE)||"'#000000'",_=l.javascriptGenerator.valueToCode(c,"COLOUR2",l.javascriptGenerator.ORDER_NONE)||"'#000000'";return c=l.javascriptGenerator.valueToCode(c,"RATIO",l.javascriptGenerator.ORDER_NONE)||.5,[l.javascriptGenerator.provideFunction_("colourBlend",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {
  ratio = Math.max(Math.min(Number(ratio), 1), 0);
  var r1 = parseInt(c1.substring(1, 3), 16);
  var g1 = parseInt(c1.substring(3, 5), 16);
  var b1 = parseInt(c1.substring(5, 7), 16);
  var r2 = parseInt(c2.substring(1, 3), 16);
  var g2 = parseInt(c2.substring(3, 5), 16);
  var b2 = parseInt(c2.substring(5, 7), 16);
  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);
  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);
  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);
  r = ('0' + (r || 0).toString(16)).slice(-2);
  g = ('0' + (g || 0).toString(16)).slice(-2);
  b = ('0' + (b || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+d+", "+_+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.__namespace__=o,l})}(Sp)),Sp.exports}var SS;function J0(){return SS||(SS=1,function(s,n){(function(i,o){s.exports=o(q0(),YD())})(ki,function(i,o){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return o})}(Ep)),Ep.exports}var se=J0(),qD=Object.defineProperty,ct=(s,n)=>qD(s,"name",{value:n,configurable:true});function JD(){}ct(JD,"noop");function ah(s){return s==null}ct(ah,"isNullable");function ZD(s){return s&&typeof s=="object"&&!Array.isArray(s)}ct(ZD,"isPlainObject");function QD(s,n){return Object.fromEntries(Object.entries(s).filter(([i,o])=>n(i,o)))}ct(QD,"filterKeys");function Z0(s,n){return Object.fromEntries(Object.entries(s).map(([i,o])=>[i,n(o,i)]))}ct(Z0,"mapValues");function ex(s,n,i){if(!n)return{...s};const o={};for(const l of n)(i||s[l]!==void 0)&&(o[l]=s[l]);return o}ct(ex,"pick");function tx(s,n){if(!n)return{...s};const i={...s};for(const o of n)Reflect.deleteProperty(i,o);return i}ct(tx,"omit");function sx(s,n,i){return Object.defineProperty(s,n,{writable:true,value:i,enumerable:false})}ct(sx,"defineProperty");function ix(s,n){return n.every(i=>s.includes(i))}ct(ix,"contain");function nx(s,n){return s.filter(i=>n.includes(i))}ct(nx,"intersection");function rx(s,n){return s.filter(i=>!n.includes(i))}ct(rx,"difference");function ox(s,n){return Array.from(new Set([...s,...n]))}ct(ox,"union");function cm(s){return[...new Set(s)]}ct(cm,"deduplicate");function ax(s,n){const i=s.indexOf(n);return i>=0?(s.splice(i,1),true):false}ct(ax,"remove");function lx(s){return Array.isArray(s)?s:ah(s)?[]:[s]}ct(lx,"makeArray");function Or(s,n){return arguments.length===1?i=>Or(s,i):s in globalThis&&n instanceof globalThis[s]||Object.prototype.toString.call(n).slice(8,-1)===s}ct(Or,"is");function dc(s){return Or("ArrayBuffer",s)||Or("SharedArrayBuffer",s)}ct(dc,"isArrayBufferLike");function Q0(s){return dc(s)||ArrayBuffer.isView(s)}ct(Q0,"isArrayBufferSource");var _a;(s=>{s.is=dc,s.isSource=Q0;function n(m){return ArrayBuffer.isView(m)?m.buffer.slice(m.byteOffset,m.byteOffset+m.byteLength):m}s.fromSource=n,ct(n,"fromSource");function i(m){if(typeof Buffer<"u")return Buffer.from(m).toString("base64");let u="";const p=new Uint8Array(m);for(let c=0;c<p.byteLength;c++)u+=String.fromCharCode(p[c]);return btoa(u)}s.toBase64=i,ct(i,"toBase64");function o(m){return typeof Buffer<"u"?n(Buffer.from(m,"base64")):Uint8Array.from(atob(m),u=>u.charCodeAt(0))}s.fromBase64=o,ct(o,"fromBase64");function l(m){return typeof Buffer<"u"?Buffer.from(m).toString("hex"):Array.from(new Uint8Array(m),u=>u.toString(16).padStart(2,"0")).join("")}s.toHex=l,ct(l,"toHex");function g(m){if(typeof Buffer<"u")return n(Buffer.from(m,"hex"));const u=m.length%2===0?m:m.slice(0,m.length-1),p=[];for(let c=0;c<u.length;c+=2)p.push(parseInt(`${u[c]}${u[c+1]}`,16));return Uint8Array.from(p).buffer}s.fromHex=g,ct(g,"fromHex")})(_a||(_a={}));_a.fromBase64;_a.toBase64;_a.fromHex;_a.toHex;function If(s){return!s||typeof s!="object"?s:Array.isArray(s)?s.map(If):Or("Date",s)?new Date(s.valueOf()):Or("RegExp",s)?new RegExp(s.source,s.flags):dc(s)?s.slice(0):ArrayBuffer.isView(s)?s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength):Z0(s,If)}ct(If,"clone");function Cf(s,n,i){if(s===n||!i&&ah(s)&&ah(n))return true;if(typeof s!=typeof n||typeof s!="object"||!s||!n)return false;function o(l,g){return l(s)?l(n)?g(s,n):false:l(n)?false:void 0}return ct(o,"check"),o(Array.isArray,(l,g)=>l.length===g.length&&l.every((m,u)=>Cf(m,g[u])))??o(Or("Date"),(l,g)=>l.valueOf()===g.valueOf())??o(Or("RegExp"),(l,g)=>l.source===g.source&&l.flags===g.flags)??o(dc,(l,g)=>{if(l.byteLength!==g.byteLength)return false;const m=new Uint8Array(l),u=new Uint8Array(g);for(let p=0;p<m.length;p++)if(m[p]!==u[p])return false;return true})??Object.keys({...s,...n}).every(l=>Cf(s[l],n[l],i))}ct(Cf,"deepEqual");function cx(s){return s.charAt(0).toUpperCase()+s.slice(1)}ct(cx,"capitalize");function um(s){return s.charAt(0).toLowerCase()+s.slice(1)}ct(um,"uncapitalize");function ux(s){return s.replace(/[_-][a-z]/g,n=>n.slice(1).toUpperCase())}ct(ux,"camelCase");function hx(s){return um(s).replace(/_/g,"-").replace(/.[A-Z]+/g,n=>n[0]+"-"+n.slice(1).toLowerCase())}ct(hx,"paramCase");function dx(s){return um(s).replace(/-/g,"_").replace(/.[A-Z]+/g,n=>n[0]+"_"+n.slice(1).toLowerCase())}ct(dx,"snakeCase");function eR(s){return s.replace(/\/$/,"")}ct(eR,"trimSlash");function _x(s){return s.startsWith("/")||(s="/"+s),eR(s)}ct(_x,"sanitize");var $S;(s=>{s.millisecond=1,s.second=1e3,s.minute=s.second*60,s.hour=s.minute*60,s.day=s.hour*24,s.week=s.day*7;let n=new Date().getTimezoneOffset();function i($){n=$}s.setTimezoneOffset=i,ct(i,"setTimezoneOffset");function o(){return n}s.getTimezoneOffset=o,ct(o,"getTimezoneOffset");function l($=new Date,E){return typeof $=="number"&&($=new Date($)),E===void 0&&(E=n),Math.floor(($.valueOf()/s.minute-E)/1440)}s.getDateNumber=l,ct(l,"getDateNumber");function g($,E){const y=new Date($*s.day);return E===void 0&&(E=n),new Date(+y+E*s.minute)}s.fromDateNumber=g,ct(g,"fromDateNumber");const m=/\d+(?:\.\d+)?/.source,u=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map($=>`(${m}${$})?`).join("")}$`);function p($){const E=u.exec($);return E?(parseFloat(E[1])*s.week||0)+(parseFloat(E[2])*s.day||0)+(parseFloat(E[3])*s.hour||0)+(parseFloat(E[4])*s.minute||0)+(parseFloat(E[5])*s.second||0):0}s.parseTime=p,ct(p,"parseTime");function c($){const E=p($);return E?$=Date.now()+E:/^\d{1,2}(:\d{1,2}){1,2}$/.test($)?$=`${new Date().toLocaleDateString()}-${$}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test($)&&($=`${new Date().getFullYear()}-${$}`),$?new Date($):new Date}s.parseDate=c,ct(c,"parseDate");function d($){const E=Math.abs($);return E>=s.day-s.hour/2?Math.round($/s.day)+"d":E>=s.hour-s.minute/2?Math.round($/s.hour)+"h":E>=s.minute-s.second/2?Math.round($/s.minute)+"m":E>=s.second?Math.round($/s.second)+"s":$+"ms"}s.format=d,ct(d,"format");function _($,E=2){return $.toString().padStart(E,"0")}s.toDigits=_,ct(_,"toDigits");function b($,E=new Date){return $.replace("yyyy",E.getFullYear().toString()).replace("yy",E.getFullYear().toString().slice(2)).replace("MM",_(E.getMonth()+1)).replace("dd",_(E.getDate())).replace("hh",_(E.getHours())).replace("mm",_(E.getMinutes())).replace("ss",_(E.getSeconds())).replace("SSS",_(E.getMilliseconds(),3))}s.template=b,ct(b,"template")})($S||($S={}));const px='export const inject = {required: ["puppeteer"]}',gx=`ctx.database.extend("blockly_key_value",{\r
    key: "string",\r
    value: "string",\r
},{\r
  primary: "key"\r
})\r
`,fx=`const logger = ctx.logger("{{name}}")\r
`,mx=`const plugin_id = "{{plugin_id}}"\r
`,Ex=`function getFiles(dir, extensions, files_){\r
    const fs = require('fs');\r
    const path = require('path');\r
    files_ = files_ || [];\r
    let files = fs.readdirSync(dir);\r
    for (let i in files){\r
        let name = dir + '/' + files[i];\r
        if (fs.statSync(name).isDirectory()){\r
            getFiles(name, extensions, files_);\r
        } else {\r
            let ext = path.extname(name);\r
            if(extensions.includes(ext)) {\r
                files_.push(name);\r
            }\r
        }\r
    }\r
    return files_;\r
}\r
`,vx=`function fetchDataFromUrl(url) {\r
    const http = require('http');\r
    const fs = require('fs');\r
    const urlModule = require('url');\r
    return new Promise((resolve, reject) => {\r
        const parsedUrl = urlModule.parse(url);\r
        if (parsedUrl.protocol.startsWith('http')) {\r
            const protocol = parsedUrl.protocol === 'https:' ? require('https') : require('http');\r
            protocol.get(url, (res) => {\r
                const data = [];\r
                res.on('data', (chunk) => {\r
                    data.push(chunk);\r
                });\r
                res.on('end', () => {\r
                    resolve(Buffer.concat(data));\r
                }).on('error', (err) => {\r
                    console.error(err.message);\r
                    reject(err);\r
                });\r
            });\r
        } else if (parsedUrl.protocol === 'file:') {\r
            fs.readFile(parsedUrl.path, (err, data) => {\r
                if (err) {\r
                    console.error(err.message);\r
                    reject(err);\r
                } else {\r
                    resolve(data);\r
                }\r
            });\r
        } else {\r
            reject(new Error(\`Unsupported protocol: \${parsedUrl.protocol}\`));\r
        }\r
    });\r
}\r
`,bx=`function x_MD5(x_MD5) { \r
    const crypto = require('crypto');   \r
    const hash = crypto.createHash('md5');     \r
    hash.update(x_MD5);     \r
    return hash.digest('hex'); \r
}`,Tx={key_value_initialize:gx,logger_initialize:fx,plugin_id:mx,test:Ex,pptr:px,fetchDataFromUrl:vx,MD5:bx};function Sx(s,n="",i=[],o=""){return[...Object.entries(s)].map(([g,m])=>`import { ${m.join(", ")} } from "${g}"
`).join("")+XD.replace(/\{\{name}}/g,n.replace(/"/g,'\\"').replace(/\\/g,"\\\\")).replace(/\{\{apply}}/g,o.split(`
`).map(g=>"  "+g).join(`
`))}function $x(s){const n=s.split(`
`),i=[],o=[];let l;(m=>{m[m.Import=0]="Import",m[m.Export=1]="Export",m[m.Other=2]="Other"})(l||(l={}));for(const m of n){const u=m.trimLeft(),p=u.startsWith("import")?0:u.startsWith("export const")?1:2;p===0||p===1?i.push(u):o.push(m)}return i.sort((m,u)=>m.startsWith("import")&&u.startsWith("export const")?0:m.startsWith("import")?-1:u.startsWith("import")?1:0),i.concat(o).join(`
`)}function yx(s,n,i){let o={};const l=i.getAllBlocks(false);l.filter(u=>u.imports).map(u=>u.imports).forEach(u=>{[...Object.entries(u)].forEach(([p,c])=>{o[p]||(o[p]=[]),o[p]=cm([...o[p],...c])})});const g=[];l.filter(u=>u.template).map(u=>u.template).forEach(u=>{u.forEach(p=>{g.includes(p)||g.push(p)})});let m=Sx(o,s,[],g.map(u=>Tx[u]+`
`).map(u=>u.replace("{{name}}",s).replace("{{plugin_id}}",n)).join("")+se.javascriptGenerator.workspaceToCode(i));return $x(m)}var xu={exports:{}},$p,yS;function Eh(){if(yS)return $p;yS=1;const s="2.0.0",n=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,o=16,l=n-6;return $p={MAX_LENGTH:n,MAX_SAFE_COMPONENT_LENGTH:o,MAX_SAFE_BUILD_LENGTH:l,MAX_SAFE_INTEGER:i,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:s,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},$p}var yp,RS;function vh(){return RS||(RS=1,yp=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{}),yp}var IS;function _c(){return IS||(IS=1,function(s,n){const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:o,MAX_LENGTH:l}=Eh(),g=vh();n=s.exports={};const m=n.re=[],u=n.safeRe=[],p=n.src=[],c=n.t={};let d=0;const _="[a-zA-Z0-9-]",b=[["\\s",1],["\\d",l],[_,o]],$=y=>{for(const[f,v]of b)y=y.split(`${f}*`).join(`${f}{0,${v}}`).split(`${f}+`).join(`${f}{1,${v}}`);return y},E=(y,f,v)=>{const T=$(f),S=d++;g(y,S,f),c[y]=S,p[S]=f,m[S]=new RegExp(f,v?"g":void 0),u[S]=new RegExp(T,v?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*"),E("NUMERICIDENTIFIERLOOSE","\\d+"),E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${_}*`),E("MAINVERSION",`(${p[c.NUMERICIDENTIFIER]})\\.(${p[c.NUMERICIDENTIFIER]})\\.(${p[c.NUMERICIDENTIFIER]})`),E("MAINVERSIONLOOSE",`(${p[c.NUMERICIDENTIFIERLOOSE]})\\.(${p[c.NUMERICIDENTIFIERLOOSE]})\\.(${p[c.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASEIDENTIFIER",`(?:${p[c.NUMERICIDENTIFIER]}|${p[c.NONNUMERICIDENTIFIER]})`),E("PRERELEASEIDENTIFIERLOOSE",`(?:${p[c.NUMERICIDENTIFIERLOOSE]}|${p[c.NONNUMERICIDENTIFIER]})`),E("PRERELEASE",`(?:-(${p[c.PRERELEASEIDENTIFIER]}(?:\\.${p[c.PRERELEASEIDENTIFIER]})*))`),E("PRERELEASELOOSE",`(?:-?(${p[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${p[c.PRERELEASEIDENTIFIERLOOSE]})*))`),E("BUILDIDENTIFIER",`${_}+`),E("BUILD",`(?:\\+(${p[c.BUILDIDENTIFIER]}(?:\\.${p[c.BUILDIDENTIFIER]})*))`),E("FULLPLAIN",`v?${p[c.MAINVERSION]}${p[c.PRERELEASE]}?${p[c.BUILD]}?`),E("FULL",`^${p[c.FULLPLAIN]}$`),E("LOOSEPLAIN",`[v=\\s]*${p[c.MAINVERSIONLOOSE]}${p[c.PRERELEASELOOSE]}?${p[c.BUILD]}?`),E("LOOSE",`^${p[c.LOOSEPLAIN]}$`),E("GTLT","((?:<|>)?=?)"),E("XRANGEIDENTIFIERLOOSE",`${p[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),E("XRANGEIDENTIFIER",`${p[c.NUMERICIDENTIFIER]}|x|X|\\*`),E("XRANGEPLAIN",`[v=\\s]*(${p[c.XRANGEIDENTIFIER]})(?:\\.(${p[c.XRANGEIDENTIFIER]})(?:\\.(${p[c.XRANGEIDENTIFIER]})(?:${p[c.PRERELEASE]})?${p[c.BUILD]}?)?)?`),E("XRANGEPLAINLOOSE",`[v=\\s]*(${p[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${p[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${p[c.XRANGEIDENTIFIERLOOSE]})(?:${p[c.PRERELEASELOOSE]})?${p[c.BUILD]}?)?)?`),E("XRANGE",`^${p[c.GTLT]}\\s*${p[c.XRANGEPLAIN]}$`),E("XRANGELOOSE",`^${p[c.GTLT]}\\s*${p[c.XRANGEPLAINLOOSE]}$`),E("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),E("COERCE",`${p[c.COERCEPLAIN]}(?:$|[^\\d])`),E("COERCEFULL",p[c.COERCEPLAIN]+`(?:${p[c.PRERELEASE]})?(?:${p[c.BUILD]})?(?:$|[^\\d])`),E("COERCERTL",p[c.COERCE],true),E("COERCERTLFULL",p[c.COERCEFULL],true),E("LONETILDE","(?:~>?)"),E("TILDETRIM",`(\\s*)${p[c.LONETILDE]}\\s+`,true),n.tildeTrimReplace="$1~",E("TILDE",`^${p[c.LONETILDE]}${p[c.XRANGEPLAIN]}$`),E("TILDELOOSE",`^${p[c.LONETILDE]}${p[c.XRANGEPLAINLOOSE]}$`),E("LONECARET","(?:\\^)"),E("CARETTRIM",`(\\s*)${p[c.LONECARET]}\\s+`,true),n.caretTrimReplace="$1^",E("CARET",`^${p[c.LONECARET]}${p[c.XRANGEPLAIN]}$`),E("CARETLOOSE",`^${p[c.LONECARET]}${p[c.XRANGEPLAINLOOSE]}$`),E("COMPARATORLOOSE",`^${p[c.GTLT]}\\s*(${p[c.LOOSEPLAIN]})$|^$`),E("COMPARATOR",`^${p[c.GTLT]}\\s*(${p[c.FULLPLAIN]})$|^$`),E("COMPARATORTRIM",`(\\s*)${p[c.GTLT]}\\s*(${p[c.LOOSEPLAIN]}|${p[c.XRANGEPLAIN]})`,true),n.comparatorTrimReplace="$1$2$3",E("HYPHENRANGE",`^\\s*(${p[c.XRANGEPLAIN]})\\s+-\\s+(${p[c.XRANGEPLAIN]})\\s*$`),E("HYPHENRANGELOOSE",`^\\s*(${p[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${p[c.XRANGEPLAINLOOSE]})\\s*$`),E("STAR","(<|>)?=?\\s*\\*"),E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(xu,xu.exports)),xu.exports}var Rp,CS;function hm(){if(CS)return Rp;CS=1;const s=Object.freeze({loose:true}),n=Object.freeze({});return Rp=o=>o?typeof o!="object"?s:o:n,Rp}var Ip,OS;function tR(){if(OS)return Ip;OS=1;const s=/^[0-9]+$/,n=(o,l)=>{const g=s.test(o),m=s.test(l);return g&&m&&(o=+o,l=+l),o===l?0:g&&!m?-1:m&&!g?1:o<l?-1:1};return Ip={compareIdentifiers:n,rcompareIdentifiers:(o,l)=>n(l,o)},Ip}var Cp,kS;function ti(){if(kS)return Cp;kS=1;const s=vh(),{MAX_LENGTH:n,MAX_SAFE_INTEGER:i}=Eh(),{safeRe:o,t:l}=_c(),g=hm(),{compareIdentifiers:m}=tR();class u{constructor(c,d){if(d=g(d),c instanceof u){if(c.loose===!!d.loose&&c.includePrerelease===!!d.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof c}".`);if(c.length>n)throw new TypeError(`version is longer than ${n} characters`);s("SemVer",c,d),this.options=d,this.loose=!!d.loose,this.includePrerelease=!!d.includePrerelease;const _=c.trim().match(d.loose?o[l.LOOSE]:o[l.FULL]);if(!_)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+_[1],this.minor=+_[2],this.patch=+_[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");_[4]?this.prerelease=_[4].split(".").map(b=>{if(/^[0-9]+$/.test(b)){const $=+b;if($>=0&&$<i)return $}return b}):this.prerelease=[],this.build=_[5]?_[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(s("SemVer.compare",this.version,this.options,c),!(c instanceof u)){if(typeof c=="string"&&c===this.version)return 0;c=new u(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof u||(c=new u(c,this.options)),m(this.major,c.major)||m(this.minor,c.minor)||m(this.patch,c.patch)}comparePre(c){if(c instanceof u||(c=new u(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let d=0;do{const _=this.prerelease[d],b=c.prerelease[d];if(s("prerelease compare",d,_,b),_===void 0&&b===void 0)return 0;if(b===void 0)return 1;if(_===void 0)return-1;if(_===b)continue;return m(_,b)}while(++d)}compareBuild(c){c instanceof u||(c=new u(c,this.options));let d=0;do{const _=this.build[d],b=c.build[d];if(s("build compare",d,_,b),_===void 0&&b===void 0)return 0;if(b===void 0)return 1;if(_===void 0)return-1;if(_===b)continue;return m(_,b)}while(++d)}inc(c,d,_){switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",d,_);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",d,_);break;case"prepatch":this.prerelease.length=0,this.inc("patch",d,_),this.inc("pre",d,_);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",d,_),this.inc("pre",d,_);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const b=Number(_)?1:0;if(!d&&_===false)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[b];else{let $=this.prerelease.length;for(;--$>=0;)typeof this.prerelease[$]=="number"&&(this.prerelease[$]++,$=-2);if($===-1){if(d===this.prerelease.join(".")&&_===false)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(b)}}if(d){let $=[d,b];_===false&&($=[d]),m(this.prerelease[0],d)===0?isNaN(this.prerelease[1])&&(this.prerelease=$):this.prerelease=$}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Cp=u,Cp}var Op,wS;function Oa(){if(wS)return Op;wS=1;const s=ti();return Op=(i,o,l=false)=>{if(i instanceof s)return i;try{return new s(i,o)}catch(g){if(!l)return null;throw g}},Op}var kp,AS;function Rx(){if(AS)return kp;AS=1;const s=Oa();return kp=(i,o)=>{const l=s(i,o);return l?l.version:null},kp}var wp,LS;function Ix(){if(LS)return wp;LS=1;const s=Oa();return wp=(i,o)=>{const l=s(i.trim().replace(/^[=v]+/,""),o);return l?l.version:null},wp}var Ap,NS;function Cx(){if(NS)return Ap;NS=1;const s=ti();return Ap=(i,o,l,g,m)=>{typeof l=="string"&&(m=g,g=l,l=void 0);try{return new s(i instanceof s?i.version:i,l).inc(o,g,m).version}catch{return null}},Ap}var Lp,MS;function Ox(){if(MS)return Lp;MS=1;const s=Oa();return Lp=(i,o)=>{const l=s(i,null,true),g=s(o,null,true),m=l.compare(g);if(m===0)return null;const u=m>0,p=u?l:g,c=u?g:l,d=!!p.prerelease.length;if(!!c.prerelease.length&&!d)return!c.patch&&!c.minor?"major":p.patch?"patch":p.minor?"minor":"major";const b=d?"pre":"";return l.major!==g.major?b+"major":l.minor!==g.minor?b+"minor":l.patch!==g.patch?b+"patch":"prerelease"},Lp}var Np,DS;function kx(){if(DS)return Np;DS=1;const s=ti();return Np=(i,o)=>new s(i,o).major,Np}var Mp,xS;function wx(){if(xS)return Mp;xS=1;const s=ti();return Mp=(i,o)=>new s(i,o).minor,Mp}var Dp,BS;function Ax(){if(BS)return Dp;BS=1;const s=ti();return Dp=(i,o)=>new s(i,o).patch,Dp}var xp,PS;function Lx(){if(PS)return xp;PS=1;const s=Oa();return xp=(i,o)=>{const l=s(i,o);return l&&l.prerelease.length?l.prerelease:null},xp}var Bp,US;function un(){if(US)return Bp;US=1;const s=ti();return Bp=(i,o,l)=>new s(i,l).compare(new s(o,l)),Bp}var Pp,FS;function Nx(){if(FS)return Pp;FS=1;const s=un();return Pp=(i,o,l)=>s(o,i,l),Pp}var Up,GS;function Mx(){if(GS)return Up;GS=1;const s=un();return Up=(i,o)=>s(i,o,true),Up}var Fp,HS;function dm(){if(HS)return Fp;HS=1;const s=ti();return Fp=(i,o,l)=>{const g=new s(i,l),m=new s(o,l);return g.compare(m)||g.compareBuild(m)},Fp}var Gp,VS;function Dx(){if(VS)return Gp;VS=1;const s=dm();return Gp=(i,o)=>i.sort((l,g)=>s(l,g,o)),Gp}var Hp,WS;function xx(){if(WS)return Hp;WS=1;const s=dm();return Hp=(i,o)=>i.sort((l,g)=>s(g,l,o)),Hp}var Vp,zS;function bh(){if(zS)return Vp;zS=1;const s=un();return Vp=(i,o,l)=>s(i,o,l)>0,Vp}var Wp,jS;function _m(){if(jS)return Wp;jS=1;const s=un();return Wp=(i,o,l)=>s(i,o,l)<0,Wp}var zp,XS;function sR(){if(XS)return zp;XS=1;const s=un();return zp=(i,o,l)=>s(i,o,l)===0,zp}var jp,KS;function iR(){if(KS)return jp;KS=1;const s=un();return jp=(i,o,l)=>s(i,o,l)!==0,jp}var Xp,YS;function pm(){if(YS)return Xp;YS=1;const s=un();return Xp=(i,o,l)=>s(i,o,l)>=0,Xp}var Kp,qS;function gm(){if(qS)return Kp;qS=1;const s=un();return Kp=(i,o,l)=>s(i,o,l)<=0,Kp}var Yp,JS;function nR(){if(JS)return Yp;JS=1;const s=sR(),n=iR(),i=bh(),o=pm(),l=_m(),g=gm();return Yp=(u,p,c,d)=>{switch(p){case"===":return typeof u=="object"&&(u=u.version),typeof c=="object"&&(c=c.version),u===c;case"!==":return typeof u=="object"&&(u=u.version),typeof c=="object"&&(c=c.version),u!==c;case"":case"=":case"==":return s(u,c,d);case"!=":return n(u,c,d);case">":return i(u,c,d);case">=":return o(u,c,d);case"<":return l(u,c,d);case"<=":return g(u,c,d);default:throw new TypeError(`Invalid operator: ${p}`)}},Yp}var qp,ZS;function Bx(){if(ZS)return qp;ZS=1;const s=ti(),n=Oa(),{safeRe:i,t:o}=_c();return qp=(g,m)=>{if(g instanceof s)return g;if(typeof g=="number"&&(g=String(g)),typeof g!="string")return null;m=m||{};let u=null;if(!m.rtl)u=g.match(m.includePrerelease?i[o.COERCEFULL]:i[o.COERCE]);else{const $=m.includePrerelease?i[o.COERCERTLFULL]:i[o.COERCERTL];let E;for(;(E=$.exec(g))&&(!u||u.index+u[0].length!==g.length);)(!u||E.index+E[0].length!==u.index+u[0].length)&&(u=E),$.lastIndex=E.index+E[1].length+E[2].length;$.lastIndex=-1}if(u===null)return null;const p=u[2],c=u[3]||"0",d=u[4]||"0",_=m.includePrerelease&&u[5]?`-${u[5]}`:"",b=m.includePrerelease&&u[6]?`+${u[6]}`:"";return n(`${p}.${c}.${d}${_}${b}`,m)},qp}var Jp,QS;function Px(){if(QS)return Jp;QS=1;class s{constructor(){this.max=1e3,this.map=new Map}get(i){const o=this.map.get(i);if(o!==void 0)return this.map.delete(i),this.map.set(i,o),o}delete(i){return this.map.delete(i)}set(i,o){if(!this.delete(i)&&o!==void 0){if(this.map.size>=this.max){const g=this.map.keys().next().value;this.delete(g)}this.map.set(i,o)}return this}}return Jp=s,Jp}var Zp,e$;function hn(){if(e$)return Zp;e$=1;const s=/\s+/g;class n{constructor(j,K){if(K=l(K),j instanceof n)return j.loose===!!K.loose&&j.includePrerelease===!!K.includePrerelease?j:new n(j.raw,K);if(j instanceof g)return this.raw=j.value,this.set=[[j]],this.formatted=void 0,this;if(this.options=K,this.loose=!!K.loose,this.includePrerelease=!!K.includePrerelease,this.raw=j.trim().replace(s," "),this.set=this.raw.split("||").map(ee=>this.parseRange(ee.trim())).filter(ee=>ee.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const ee=this.set[0];if(this.set=this.set.filter(M=>!y(M[0])),this.set.length===0)this.set=[ee];else if(this.set.length>1){for(const M of this.set)if(M.length===1&&f(M[0])){this.set=[M];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let j=0;j<this.set.length;j++){j>0&&(this.formatted+="||");const K=this.set[j];for(let ee=0;ee<K.length;ee++)ee>0&&(this.formatted+=" "),this.formatted+=K[ee].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(j){const ee=((this.options.includePrerelease&&$)|(this.options.loose&&E))+":"+j,M=o.get(ee);if(M)return M;const F=this.options.loose,V=F?p[c.HYPHENRANGELOOSE]:p[c.HYPHENRANGE];j=j.replace(V,P(this.options.includePrerelease)),m("hyphen replace",j),j=j.replace(p[c.COMPARATORTRIM],d),m("comparator trim",j),j=j.replace(p[c.TILDETRIM],_),m("tilde trim",j),j=j.replace(p[c.CARETTRIM],b),m("caret trim",j);let X=j.split(" ").map(de=>T(de,this.options)).join(" ").split(/\s+/).map(de=>U(de,this.options));F&&(X=X.filter(de=>(m("loose invalid filter",de,this.options),!!de.match(p[c.COMPARATORLOOSE])))),m("range list",X);const H=new Map,ne=X.map(de=>new g(de,this.options));for(const de of ne){if(y(de))return[de];H.set(de.value,de)}H.size>1&&H.has("")&&H.delete("");const Ie=[...H.values()];return o.set(ee,Ie),Ie}intersects(j,K){if(!(j instanceof n))throw new TypeError("a Range is required");return this.set.some(ee=>v(ee,K)&&j.set.some(M=>v(M,K)&&ee.every(F=>M.every(V=>F.intersects(V,K)))))}test(j){if(!j)return false;if(typeof j=="string")try{j=new u(j,this.options)}catch{return false}for(let K=0;K<this.set.length;K++)if(z(this.set[K],j,this.options))return true;return false}}Zp=n;const i=Px(),o=new i,l=hm(),g=Th(),m=vh(),u=ti(),{safeRe:p,t:c,comparatorTrimReplace:d,tildeTrimReplace:_,caretTrimReplace:b}=_c(),{FLAG_INCLUDE_PRERELEASE:$,FLAG_LOOSE:E}=Eh(),y=W=>W.value==="<0.0.0-0",f=W=>W.value==="",v=(W,j)=>{let K=true;const ee=W.slice();let M=ee.pop();for(;K&&ee.length;)K=ee.every(F=>M.intersects(F,j)),M=ee.pop();return K},T=(W,j)=>(m("comp",W,j),W=A(W,j),m("caret",W),W=R(W,j),m("tildes",W),W=I(W,j),m("xrange",W),W=B(W,j),m("stars",W),W),S=W=>!W||W.toLowerCase()==="x"||W==="*",R=(W,j)=>W.trim().split(/\s+/).map(K=>O(K,j)).join(" "),O=(W,j)=>{const K=j.loose?p[c.TILDELOOSE]:p[c.TILDE];return W.replace(K,(ee,M,F,V,X)=>{m("tilde",W,ee,M,F,V,X);let H;return S(M)?H="":S(F)?H=`>=${M}.0.0 <${+M+1}.0.0-0`:S(V)?H=`>=${M}.${F}.0 <${M}.${+F+1}.0-0`:X?(m("replaceTilde pr",X),H=`>=${M}.${F}.${V}-${X} <${M}.${+F+1}.0-0`):H=`>=${M}.${F}.${V} <${M}.${+F+1}.0-0`,m("tilde return",H),H})},A=(W,j)=>W.trim().split(/\s+/).map(K=>L(K,j)).join(" "),L=(W,j)=>{m("caret",W,j);const K=j.loose?p[c.CARETLOOSE]:p[c.CARET],ee=j.includePrerelease?"-0":"";return W.replace(K,(M,F,V,X,H)=>{m("caret",W,M,F,V,X,H);let ne;return S(F)?ne="":S(V)?ne=`>=${F}.0.0${ee} <${+F+1}.0.0-0`:S(X)?F==="0"?ne=`>=${F}.${V}.0${ee} <${F}.${+V+1}.0-0`:ne=`>=${F}.${V}.0${ee} <${+F+1}.0.0-0`:H?(m("replaceCaret pr",H),F==="0"?V==="0"?ne=`>=${F}.${V}.${X}-${H} <${F}.${V}.${+X+1}-0`:ne=`>=${F}.${V}.${X}-${H} <${F}.${+V+1}.0-0`:ne=`>=${F}.${V}.${X}-${H} <${+F+1}.0.0-0`):(m("no pr"),F==="0"?V==="0"?ne=`>=${F}.${V}.${X}${ee} <${F}.${V}.${+X+1}-0`:ne=`>=${F}.${V}.${X}${ee} <${F}.${+V+1}.0-0`:ne=`>=${F}.${V}.${X} <${+F+1}.0.0-0`),m("caret return",ne),ne})},I=(W,j)=>(m("replaceXRanges",W,j),W.split(/\s+/).map(K=>k(K,j)).join(" ")),k=(W,j)=>{W=W.trim();const K=j.loose?p[c.XRANGELOOSE]:p[c.XRANGE];return W.replace(K,(ee,M,F,V,X,H)=>{m("xRange",W,ee,M,F,V,X,H);const ne=S(F),Ie=ne||S(V),de=Ie||S(X),ot=de;return M==="="&&ot&&(M=""),H=j.includePrerelease?"-0":"",ne?M===">"||M==="<"?ee="<0.0.0-0":ee="*":M&&ot?(Ie&&(V=0),X=0,M===">"?(M=">=",Ie?(F=+F+1,V=0,X=0):(V=+V+1,X=0)):M==="<="&&(M="<",Ie?F=+F+1:V=+V+1),M==="<"&&(H="-0"),ee=`${M+F}.${V}.${X}${H}`):Ie?ee=`>=${F}.0.0${H} <${+F+1}.0.0-0`:de&&(ee=`>=${F}.${V}.0${H} <${F}.${+V+1}.0-0`),m("xRange return",ee),ee})},B=(W,j)=>(m("replaceStars",W,j),W.trim().replace(p[c.STAR],"")),U=(W,j)=>(m("replaceGTE0",W,j),W.trim().replace(p[j.includePrerelease?c.GTE0PRE:c.GTE0],"")),P=W=>(j,K,ee,M,F,V,X,H,ne,Ie,de,ot)=>(S(ee)?K="":S(M)?K=`>=${ee}.0.0${W?"-0":""}`:S(F)?K=`>=${ee}.${M}.0${W?"-0":""}`:V?K=`>=${K}`:K=`>=${K}${W?"-0":""}`,S(ne)?H="":S(Ie)?H=`<${+ne+1}.0.0-0`:S(de)?H=`<${ne}.${+Ie+1}.0-0`:ot?H=`<=${ne}.${Ie}.${de}-${ot}`:W?H=`<${ne}.${Ie}.${+de+1}-0`:H=`<=${H}`,`${K} ${H}`.trim()),z=(W,j,K)=>{for(let ee=0;ee<W.length;ee++)if(!W[ee].test(j))return false;if(j.prerelease.length&&!K.includePrerelease){for(let ee=0;ee<W.length;ee++)if(m(W[ee].semver),W[ee].semver!==g.ANY&&W[ee].semver.prerelease.length>0){const M=W[ee].semver;if(M.major===j.major&&M.minor===j.minor&&M.patch===j.patch)return true}return false}return true};return Zp}var Qp,t$;function Th(){if(t$)return Qp;t$=1;const s=Symbol("SemVer ANY");class n{static get ANY(){return s}constructor(d,_){if(_=i(_),d instanceof n){if(d.loose===!!_.loose)return d;d=d.value}d=d.trim().split(/\s+/).join(" "),m("comparator",d,_),this.options=_,this.loose=!!_.loose,this.parse(d),this.semver===s?this.value="":this.value=this.operator+this.semver.version,m("comp",this)}parse(d){const _=this.options.loose?o[l.COMPARATORLOOSE]:o[l.COMPARATOR],b=d.match(_);if(!b)throw new TypeError(`Invalid comparator: ${d}`);this.operator=b[1]!==void 0?b[1]:"",this.operator==="="&&(this.operator=""),b[2]?this.semver=new u(b[2],this.options.loose):this.semver=s}toString(){return this.value}test(d){if(m("Comparator.test",d,this.options.loose),this.semver===s||d===s)return true;if(typeof d=="string")try{d=new u(d,this.options)}catch{return false}return g(d,this.operator,this.semver,this.options)}intersects(d,_){if(!(d instanceof n))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?true:new p(d.value,_).test(this.value):d.operator===""?d.value===""?true:new p(this.value,_).test(d.semver):(_=i(_),_.includePrerelease&&(this.value==="<0.0.0-0"||d.value==="<0.0.0-0")||!_.includePrerelease&&(this.value.startsWith("<0.0.0")||d.value.startsWith("<0.0.0"))?false:!!(this.operator.startsWith(">")&&d.operator.startsWith(">")||this.operator.startsWith("<")&&d.operator.startsWith("<")||this.semver.version===d.semver.version&&this.operator.includes("=")&&d.operator.includes("=")||g(this.semver,"<",d.semver,_)&&this.operator.startsWith(">")&&d.operator.startsWith("<")||g(this.semver,">",d.semver,_)&&this.operator.startsWith("<")&&d.operator.startsWith(">")))}}Qp=n;const i=hm(),{safeRe:o,t:l}=_c(),g=nR(),m=vh(),u=ti(),p=hn();return Qp}var eg,s$;function Sh(){if(s$)return eg;s$=1;const s=hn();return eg=(i,o,l)=>{try{o=new s(o,l)}catch{return false}return o.test(i)},eg}var tg,i$;function Ux(){if(i$)return tg;i$=1;const s=hn();return tg=(i,o)=>new s(i,o).set.map(l=>l.map(g=>g.value).join(" ").trim().split(" ")),tg}var sg,n$;function Fx(){if(n$)return sg;n$=1;const s=ti(),n=hn();return sg=(o,l,g)=>{let m=null,u=null,p=null;try{p=new n(l,g)}catch{return null}return o.forEach(c=>{p.test(c)&&(!m||u.compare(c)===-1)&&(m=c,u=new s(m,g))}),m},sg}var ig,r$;function Gx(){if(r$)return ig;r$=1;const s=ti(),n=hn();return ig=(o,l,g)=>{let m=null,u=null,p=null;try{p=new n(l,g)}catch{return null}return o.forEach(c=>{p.test(c)&&(!m||u.compare(c)===1)&&(m=c,u=new s(m,g))}),m},ig}var ng,o$;function Hx(){if(o$)return ng;o$=1;const s=ti(),n=hn(),i=bh();return ng=(l,g)=>{l=new n(l,g);let m=new s("0.0.0");if(l.test(m)||(m=new s("0.0.0-0"),l.test(m)))return m;m=null;for(let u=0;u<l.set.length;++u){const p=l.set[u];let c=null;p.forEach(d=>{const _=new s(d.semver.version);switch(d.operator){case">":_.prerelease.length===0?_.patch++:_.prerelease.push(0),_.raw=_.format();case"":case">=":(!c||i(_,c))&&(c=_);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${d.operator}`)}}),c&&(!m||i(m,c))&&(m=c)}return m&&l.test(m)?m:null},ng}var rg,a$;function Vx(){if(a$)return rg;a$=1;const s=hn();return rg=(i,o)=>{try{return new s(i,o).range||"*"}catch{return null}},rg}var og,l$;function fm(){if(l$)return og;l$=1;const s=ti(),n=Th(),{ANY:i}=n,o=hn(),l=Sh(),g=bh(),m=_m(),u=gm(),p=pm();return og=(d,_,b,$)=>{d=new s(d,$),_=new o(_,$);let E,y,f,v,T;switch(b){case">":E=g,y=u,f=m,v=">",T=">=";break;case"<":E=m,y=p,f=g,v="<",T="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(l(d,_,$))return false;for(let S=0;S<_.set.length;++S){const R=_.set[S];let O=null,A=null;if(R.forEach(L=>{L.semver===i&&(L=new n(">=0.0.0")),O=O||L,A=A||L,E(L.semver,O.semver,$)?O=L:f(L.semver,A.semver,$)&&(A=L)}),O.operator===v||O.operator===T||(!A.operator||A.operator===v)&&y(d,A.semver))return false;if(A.operator===T&&f(d,A.semver))return false}return true},og}var ag,c$;function Wx(){if(c$)return ag;c$=1;const s=fm();return ag=(i,o,l)=>s(i,o,">",l),ag}var lg,u$;function zx(){if(u$)return lg;u$=1;const s=fm();return lg=(i,o,l)=>s(i,o,"<",l),lg}var cg,h$;function jx(){if(h$)return cg;h$=1;const s=hn();return cg=(i,o,l)=>(i=new s(i,l),o=new s(o,l),i.intersects(o,l)),cg}var ug,d$;function Xx(){if(d$)return ug;d$=1;const s=Sh(),n=un();return ug=(i,o,l)=>{const g=[];let m=null,u=null;const p=i.sort((b,$)=>n(b,$,l));for(const b of p)s(b,o,l)?(u=b,m||(m=b)):(u&&g.push([m,u]),u=null,m=null);m&&g.push([m,null]);const c=[];for(const[b,$]of g)b===$?c.push(b):!$&&b===p[0]?c.push("*"):$?b===p[0]?c.push(`<=${$}`):c.push(`${b} - ${$}`):c.push(`>=${b}`);const d=c.join(" || "),_=typeof o.raw=="string"?o.raw:String(o);return d.length<_.length?d:o},ug}var hg,_$;function Kx(){if(_$)return hg;_$=1;const s=hn(),n=Th(),{ANY:i}=n,o=Sh(),l=un(),g=(_,b,$={})=>{if(_===b)return true;_=new s(_,$),b=new s(b,$);let E=false;e:for(const y of _.set){for(const f of b.set){const v=p(y,f,$);if(E=E||v!==null,v)continue e}if(E)return false}return true},m=[new n(">=0.0.0-0")],u=[new n(">=0.0.0")],p=(_,b,$)=>{if(_===b)return true;if(_.length===1&&_[0].semver===i){if(b.length===1&&b[0].semver===i)return true;$.includePrerelease?_=m:_=u}if(b.length===1&&b[0].semver===i){if($.includePrerelease)return true;b=u}const E=new Set;let y,f;for(const I of _)I.operator===">"||I.operator===">="?y=c(y,I,$):I.operator==="<"||I.operator==="<="?f=d(f,I,$):E.add(I.semver);if(E.size>1)return null;let v;if(y&&f){if(v=l(y.semver,f.semver,$),v>0)return null;if(v===0&&(y.operator!==">="||f.operator!=="<="))return null}for(const I of E){if(y&&!o(I,String(y),$)||f&&!o(I,String(f),$))return null;for(const k of b)if(!o(I,String(k),$))return false;return true}let T,S,R,O,A=f&&!$.includePrerelease&&f.semver.prerelease.length?f.semver:false,L=y&&!$.includePrerelease&&y.semver.prerelease.length?y.semver:false;A&&A.prerelease.length===1&&f.operator==="<"&&A.prerelease[0]===0&&(A=false);for(const I of b){if(O=O||I.operator===">"||I.operator===">=",R=R||I.operator==="<"||I.operator==="<=",y){if(L&&I.semver.prerelease&&I.semver.prerelease.length&&I.semver.major===L.major&&I.semver.minor===L.minor&&I.semver.patch===L.patch&&(L=false),I.operator===">"||I.operator===">="){if(T=c(y,I,$),T===I&&T!==y)return false}else if(y.operator===">="&&!o(y.semver,String(I),$))return false}if(f){if(A&&I.semver.prerelease&&I.semver.prerelease.length&&I.semver.major===A.major&&I.semver.minor===A.minor&&I.semver.patch===A.patch&&(A=false),I.operator==="<"||I.operator==="<="){if(S=d(f,I,$),S===I&&S!==f)return false}else if(f.operator==="<="&&!o(f.semver,String(I),$))return false}if(!I.operator&&(f||y)&&v!==0)return false}return!(y&&R&&!f&&v!==0||f&&O&&!y&&v!==0||L||A)},c=(_,b,$)=>{if(!_)return b;const E=l(_.semver,b.semver,$);return E>0?_:E<0||b.operator===">"&&_.operator===">="?b:_},d=(_,b,$)=>{if(!_)return b;const E=l(_.semver,b.semver,$);return E<0?_:E>0||b.operator==="<"&&_.operator==="<="?b:_};return hg=g,hg}var dg,p$;function Yx(){if(p$)return dg;p$=1;const s=_c(),n=Eh(),i=ti(),o=tR(),l=Oa(),g=Rx(),m=Ix(),u=Cx(),p=Ox(),c=kx(),d=wx(),_=Ax(),b=Lx(),$=un(),E=Nx(),y=Mx(),f=dm(),v=Dx(),T=xx(),S=bh(),R=_m(),O=sR(),A=iR(),L=pm(),I=gm(),k=nR(),B=Bx(),U=Th(),P=hn(),z=Sh(),W=Ux(),j=Fx(),K=Gx(),ee=Hx(),M=Vx(),F=fm(),V=Wx(),X=zx(),H=jx(),ne=Xx(),Ie=Kx();return dg={parse:l,valid:g,clean:m,inc:u,diff:p,major:c,minor:d,patch:_,prerelease:b,compare:$,rcompare:E,compareLoose:y,compareBuild:f,sort:v,rsort:T,gt:S,lt:R,eq:O,neq:A,gte:L,lte:I,cmp:k,coerce:B,Comparator:U,Range:P,satisfies:z,toComparators:W,maxSatisfying:j,minSatisfying:K,minVersion:ee,validRange:M,outside:F,gtr:V,ltr:X,intersects:H,simplifyRange:ne,subset:Ie,SemVer:i,re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:n.SEMVER_SPEC_VERSION,RELEASE_TYPES:n.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers},dg}var _g=Yx();const qx=async()=>(await wn("create-blockly-block")).toString(),rR=async(s,n)=>{s!=null&&await wn("save-blockly-block",s,{body:n.save()})};async function Jx(s,n,i,o,l){if(s==null)return;l.info("正在开始编译.......");let g;try{g=yx(n,i,o.getWorkspaceSvg())}catch(m){l.error("编译时发生错误: "+m.toString()),console.error(m);return}return l.info("正在上传......"),await wn("save-blockly-block",s,{code:g}),l.success("上传成功"),g}async function Zx(s){s!=null&&await wn("set-blockly-block-state",s,true)}async function Qx(s){s!=null&&await wn("set-blockly-block-state",s,false)}async function eB(s,n){s!=null&&await wn("rename-blockly-block",s,n)}async function tB(s){s!=null&&await wn("delete-blockly-block",s)}async function sB(s,n,i,o){if(s!=null)return zD(n,i,o.save())}async function iB(s,n){if(s.length==0)return;const i=jD(s);if(console.info(i),!i)return;if(i.version!=Y0){Nl.alert(`无法读取该插件: 该插件的API Major版本(${i.version})不兼容当前版本`);return}if(i.plugin_version&&_g.cmp(i.plugin_version,">",Rf)&&await Nl.confirm(`该插件是由更高版本(${i.plugin_version})的Blockly插件导出的，可能无法正常导入或执行异常。建议升级您的Blockly版本到最新版本`,"提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"})=="cancel"||i.plugin_version&&_g.major(i.plugin_version)!=_g.major(Rf)&&await Nl.confirm(`该插件是由不同主版本(${i.plugin_version})的Blockly插件导出的，可能无法正常导入或执行异常。`,"提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"})=="cancel"||!n&&(i!=null&&i.uuid)&&Jn.blockly.filter(l=>l.uuid==i.uuid).length>0&&await Nl.confirm("检测到该插件已存在，是否覆盖？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})=="cancel")return;const o=await wn("create-blockly-block",n?void 0:i.uuid);return await wn("save-blockly-block",o,{body:i.body,name:i.name}),o.toString()}const nB={class:"create",style:{display:"flex","flex-direction":"row-reverse","padding-right":"10px","padding-top":"10px",height:"48px"}},rB={class:"list",style:{height:"60%"}},oB={style:{height:"40%",padding:"10px"}},aB={key:0},lB=Xe({__name:"index",props:["blocks","workspace","dialog","current","panel","logger"],emits:["update:dialog","update:current"],setup(s,{emit:n}){const i=s,o=n,{panel:l,blocks:g}=i,m=_e({get:()=>i.current,set:$=>o("update:current",$)}),u=_e({get:()=>i.dialog,set:$=>o("update:dialog",$)}),p=async()=>{if(await rR(m.value,i.workspace),m.value==null)return;const $=Jn.blockly.find(y=>y.id==m.value),E=await Jx(m.value,$.name,$.uuid,i.workspace,i.logger.logger);E&&(l.code=E)};async function c(){const $=prompt("输入重命名的插件名词","未命名Koishi插件");$!=null&&await eB(m.value,$)}async function d(){m.value!=null&&await Nl.confirm("确定删除当前插件?")==="confirm"&&await tB(m.value)}async function _(){if(m.value==null)return;const $=Jn.blockly.find(y=>y.id==m.value),E=await sB(m.value,$.name,$.uuid,i.workspace);E&&(u.value.export=E)}async function b(){o("update:current",await qx())}return($,E)=>{const y=ht("el-popover"),f=ht("el-scrollbar"),v=ht("k-button");return oe(),be(Pt,null,[he("div",nB,[Me(y,{placement:"bottom",trigger:"hover",content:"新建插件"},{reference:je(()=>[he("i",{onClick:b,style:{cursor:"pointer","padding-right":"20px"}},[Me(iM)])]),_:1}),Me(y,{placement:"bottom",trigger:"hover",content:"导入代码"},{reference:je(()=>[he("i",{onClick:E[0]||(E[0]=T=>u.value.import=true),style:{cursor:"pointer","padding-right":"20px"}},[Me(QN)])]),_:1}),E[8]||(E[8]=he("div",{style:{"flex-grow":"1"}},null,-1)),E[9]||(E[9]=he("div",{style:{"font-size":"18px","font-weight":"bold","margin-left":"19px"}}," 插件列表 ",-1))]),he("div",rB,[Me(f,null,{default:je(()=>[Me($k,{data:Object.fromEntries(ue(Jn).blockly.map(T=>[T.id,T])),modelValue:m.value,"onUpdate:modelValue":E[1]||(E[1]=T=>m.value=T)},null,8,["data","modelValue"])]),_:1})]),he("div",oB,[m.value?(oe(),be("div",aB,[E[16]||(E[16]=he("h3",null,"操作",-1)),Me(v,{onClick:E[2]||(E[2]=T=>p())},{default:je(()=>E[10]||(E[10]=[xt("编译插件")])),_:1}),E[17]||(E[17]=he("br",null,null,-1)),Me(v,{onClick:E[3]||(E[3]=()=>ue(Zx)(m.value))},{default:je(()=>E[11]||(E[11]=[xt("启用插件")])),_:1}),Me(v,{onClick:E[4]||(E[4]=()=>ue(Qx)(m.value))},{default:je(()=>E[12]||(E[12]=[xt("禁用插件")])),_:1}),E[18]||(E[18]=he("br",null,null,-1)),Me(v,{onClick:E[5]||(E[5]=T=>c())},{default:je(()=>E[13]||(E[13]=[xt("重命名插件")])),_:1}),Me(v,{onClick:E[6]||(E[6]=T=>d())},{default:je(()=>E[14]||(E[14]=[xt("删除插件")])),_:1}),E[19]||(E[19]=he("br",null,null,-1)),Me(v,{onClick:E[7]||(E[7]=T=>_())},{default:je(()=>E[15]||(E[15]=[xt("导出插件")])),_:1})])):qe("v-if",true)])],64)}}});var pg={exports:{}},gg={exports:{}},fg={exports:{}},g$;function cB(){return g$||(g$=1,function(s,n){(function(i,o){s.exports=o()})(ki,function(){var i=i||{Msg:Object.create(null)};return i.Msg.ADD_COMMENT="Add Comment",i.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",i.Msg.CHANGE_VALUE_TITLE="Change value:",i.Msg.CLEAN_UP="Clean up Blocks",i.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",i.Msg.COLLAPSE_ALL="Collapse Blocks",i.Msg.COLLAPSE_BLOCK="Collapse Block",i.Msg.COLOUR_BLEND_COLOUR1="colour 1",i.Msg.COLOUR_BLEND_COLOUR2="colour 2",i.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",i.Msg.COLOUR_BLEND_RATIO="ratio",i.Msg.COLOUR_BLEND_TITLE="blend",i.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",i.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",i.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",i.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",i.Msg.COLOUR_RANDOM_TITLE="random colour",i.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",i.Msg.COLOUR_RGB_BLUE="blue",i.Msg.COLOUR_RGB_GREEN="green",i.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",i.Msg.COLOUR_RGB_RED="red",i.Msg.COLOUR_RGB_TITLE="colour with",i.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",i.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",i.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",i.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",i.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",i.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",i.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",i.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",i.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",i.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",i.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",i.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",i.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",i.Msg.CONTROLS_IF_MSG_ELSE="else",i.Msg.CONTROLS_IF_MSG_ELSEIF="else if",i.Msg.CONTROLS_IF_MSG_IF="if",i.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",i.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",i.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",i.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",i.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",i.Msg.CONTROLS_REPEAT_INPUT_DO="do",i.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",i.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",i.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",i.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",i.Msg.DELETE_BLOCK="Delete Block",i.Msg.DELETE_VARIABLE="Delete the '%1' variable",i.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",i.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",i.Msg.DIALOG_CANCEL="Cancel",i.Msg.DIALOG_OK="OK",i.Msg.DISABLE_BLOCK="Disable Block",i.Msg.DUPLICATE_BLOCK="Duplicate",i.Msg.DUPLICATE_COMMENT="Duplicate Comment",i.Msg.ENABLE_BLOCK="Enable Block",i.Msg.EXPAND_ALL="Expand Blocks",i.Msg.EXPAND_BLOCK="Expand Block",i.Msg.EXTERNAL_INPUTS="External Inputs",i.Msg.HELP="Help",i.Msg.INLINE_INPUTS="Inline Inputs",i.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",i.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",i.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",i.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",i.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",i.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",i.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",i.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",i.Msg.LISTS_GET_INDEX_FIRST="first",i.Msg.LISTS_GET_INDEX_FROM_END="# from end",i.Msg.LISTS_GET_INDEX_FROM_START="#",i.Msg.LISTS_GET_INDEX_GET="get",i.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",i.Msg.LISTS_GET_INDEX_LAST="last",i.Msg.LISTS_GET_INDEX_RANDOM="random",i.Msg.LISTS_GET_INDEX_REMOVE="remove",i.Msg.LISTS_GET_INDEX_TAIL="",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",i.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",i.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",i.Msg.LISTS_GET_SUBLIST_END_LAST="to last",i.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",i.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",i.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",i.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",i.Msg.LISTS_GET_SUBLIST_TAIL="",i.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",i.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",i.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",i.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",i.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",i.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",i.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",i.Msg.LISTS_INLIST="in list",i.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",i.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",i.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",i.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",i.Msg.LISTS_LENGTH_TITLE="length of %1",i.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",i.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",i.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",i.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",i.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",i.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",i.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",i.Msg.LISTS_SET_INDEX_INPUT_TO="as",i.Msg.LISTS_SET_INDEX_INSERT="insert at",i.Msg.LISTS_SET_INDEX_SET="set",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",i.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",i.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",i.Msg.LISTS_SORT_ORDER_DESCENDING="descending",i.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",i.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",i.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",i.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",i.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",i.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",i.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",i.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",i.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",i.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",i.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",i.Msg.LOGIC_BOOLEAN_FALSE="false",i.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",i.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",i.Msg.LOGIC_BOOLEAN_TRUE="true",i.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",i.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",i.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",i.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",i.Msg.LOGIC_NEGATE_TITLE="not %1",i.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",i.Msg.LOGIC_NULL="null",i.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",i.Msg.LOGIC_NULL_TOOLTIP="Returns null.",i.Msg.LOGIC_OPERATION_AND="and",i.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",i.Msg.LOGIC_OPERATION_OR="or",i.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",i.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",i.Msg.LOGIC_TERNARY_CONDITION="test",i.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",i.Msg.LOGIC_TERNARY_IF_FALSE="if false",i.Msg.LOGIC_TERNARY_IF_TRUE="if true",i.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",i.Msg.MATH_ADDITION_SYMBOL="+",i.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",i.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",i.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",i.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",i.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",i.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",i.Msg.MATH_CHANGE_TITLE="change %1 by %2",i.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",i.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",i.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…), or ∞ (infinity).",i.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",i.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",i.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",i.Msg.MATH_DIVISION_SYMBOL="÷",i.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",i.Msg.MATH_IS_EVEN="is even",i.Msg.MATH_IS_NEGATIVE="is negative",i.Msg.MATH_IS_ODD="is odd",i.Msg.MATH_IS_POSITIVE="is positive",i.Msg.MATH_IS_PRIME="is prime",i.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",i.Msg.MATH_IS_WHOLE="is whole",i.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",i.Msg.MATH_MODULO_TITLE="remainder of %1 ÷ %2",i.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",i.Msg.MATH_MULTIPLICATION_SYMBOL="×",i.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",i.Msg.MATH_NUMBER_TOOLTIP="A number.",i.Msg.MATH_ONLIST_HELPURL="",i.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",i.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",i.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",i.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",i.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",i.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",i.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",i.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",i.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",i.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",i.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",i.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",i.Msg.MATH_POWER_SYMBOL="^",i.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",i.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",i.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",i.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",i.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",i.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",i.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",i.Msg.MATH_ROUND_OPERATOR_ROUND="round",i.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",i.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",i.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",i.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",i.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",i.Msg.MATH_SINGLE_OP_ROOT="square root",i.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",i.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",i.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",i.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",i.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",i.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",i.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",i.Msg.MATH_SUBTRACTION_SYMBOL="-",i.Msg.MATH_TRIG_ACOS="acos",i.Msg.MATH_TRIG_ASIN="asin",i.Msg.MATH_TRIG_ATAN="atan",i.Msg.MATH_TRIG_COS="cos",i.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",i.Msg.MATH_TRIG_SIN="sin",i.Msg.MATH_TRIG_TAN="tan",i.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",i.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",i.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",i.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",i.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",i.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",i.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",i.Msg.NEW_NUMBER_VARIABLE="Create number variable...",i.Msg.NEW_STRING_VARIABLE="Create string variable...",i.Msg.NEW_VARIABLE="Create variable...",i.Msg.NEW_VARIABLE_TITLE="New variable name:",i.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",i.Msg.ORDINAL_NUMBER_SUFFIX="",i.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",i.Msg.PROCEDURES_BEFORE_PARAMS="with:",i.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",i.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",i.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",i.Msg.PROCEDURES_CREATE_DO="Create '%1'",i.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",i.Msg.PROCEDURES_DEFNORETURN_DO="",i.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",i.Msg.PROCEDURES_DEFNORETURN_TITLE="to",i.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",i.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_DEFRETURN_RETURN="return",i.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",i.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",i.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",i.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",i.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",i.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",i.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",i.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",i.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",i.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",i.Msg.REDO="Redo",i.Msg.REMOVE_COMMENT="Remove Comment",i.Msg.RENAME_VARIABLE="Rename variable...",i.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",i.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_APPEND_TITLE="to %1 append text %2",i.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",i.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",i.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",i.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",i.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",i.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",i.Msg.TEXT_CHARAT_FIRST="get first letter",i.Msg.TEXT_CHARAT_FROM_END="get letter # from end",i.Msg.TEXT_CHARAT_FROM_START="get letter #",i.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",i.Msg.TEXT_CHARAT_LAST="get last letter",i.Msg.TEXT_CHARAT_RANDOM="get random letter",i.Msg.TEXT_CHARAT_TAIL="",i.Msg.TEXT_CHARAT_TITLE="in text %1 %2",i.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",i.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",i.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",i.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",i.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",i.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",i.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",i.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",i.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",i.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",i.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",i.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",i.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",i.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",i.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",i.Msg.TEXT_GET_SUBSTRING_TAIL="",i.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",i.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",i.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",i.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",i.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",i.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",i.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",i.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",i.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",i.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",i.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",i.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",i.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_LENGTH_TITLE="length of %1",i.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",i.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",i.Msg.TEXT_PRINT_TITLE="print %1",i.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",i.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",i.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",i.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",i.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",i.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",i.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",i.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",i.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",i.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",i.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",i.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",i.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",i.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",i.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",i.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",i.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",i.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",i.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",i.Msg.TODAY="Today",i.Msg.UNDO="Undo",i.Msg.UNNAMED_KEY="unnamed",i.Msg.VARIABLES_DEFAULT_NAME="item",i.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",i.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",i.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",i.Msg.VARIABLES_SET="set %1 to %2",i.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",i.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",i.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",i.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",i.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",i.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",i.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",i.Msg.CONTROLS_FOREACH_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_FOR_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=i.Msg.CONTROLS_IF_MSG_ELSEIF,i.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=i.Msg.CONTROLS_IF_MSG_ELSE,i.Msg.CONTROLS_IF_IF_TITLE_IF=i.Msg.CONTROLS_IF_MSG_IF,i.Msg.CONTROLS_IF_MSG_THEN=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.LISTS_CREATE_WITH_ITEM_TITLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.LISTS_GET_INDEX_HELPURL=i.Msg.LISTS_INDEX_OF_HELPURL,i.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.MATH_CHANGE_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.PROCEDURES_DEFRETURN_COMMENT=i.Msg.PROCEDURES_DEFNORETURN_COMMENT,i.Msg.PROCEDURES_DEFRETURN_DO=i.Msg.PROCEDURES_DEFNORETURN_DO,i.Msg.PROCEDURES_DEFRETURN_PROCEDURE=i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,i.Msg.PROCEDURES_DEFRETURN_TITLE=i.Msg.PROCEDURES_DEFNORETURN_TITLE,i.Msg.TEXT_APPEND_VARIABLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.MATH_HUE="230",i.Msg.LOOPS_HUE="120",i.Msg.LISTS_HUE="260",i.Msg.LOGIC_HUE="210",i.Msg.VARIABLES_HUE="330",i.Msg.TEXTS_HUE="160",i.Msg.PROCEDURES_HUE="290",i.Msg.COLOUR_HUE="20",i.Msg.VARIABLES_DYNAMIC_HUE="310",i.Msg})}(fg)),fg.exports}var mg={exports:{}},Eg={exports:{}},f$;function uB(){return f$||(f$=1,function(s,n){(function(i,o){s.exports=o(lm())})(ki,function(i){var o=i.__namespace__,l={};o.module$build$src$core$contextmenu,o.module$build$src$core$extensions,o.module$build$src$core$variables,o.module$build$src$core$utils$xml;var g=o.module$build$src$core$msg.Msg,m=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,u=o.module$build$src$core$common.defineBlocks;l.blocks=m([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]);var p={customContextMenu:function(N){if(this.isInFlyout)(this.type==="variables_get_dynamic"||this.type==="variables_get_reporter_dynamic")&&(G={text:g.RENAME_VARIABLE,enabled:true,callback:c(this)},le=this.getField("VAR").getText(),le={text:g.DELETE_VARIABLE.replace("%1",le),enabled:true,callback:d(this)},N.unshift(G),N.unshift(le));else{var G=this.getFieldValue("VAR"),J=this.workspace.getVariableById(G).type;if(this.type==="variables_get_dynamic"){G="variables_set_dynamic";var ie=g.VARIABLES_GET_CREATE_SET}else G="variables_get_dynamic",ie=g.VARIABLES_SET_CREATE_GET;var le={enabled:0<this.workspace.remainingCapacity()};const at=this.getField("VAR").getText();le.text=ie.replace("%1",at),ie=o.module$build$src$core$utils$xml.createElement("field"),ie.setAttribute("name","VAR"),ie.setAttribute("variabletype",J),ie.appendChild(o.module$build$src$core$utils$xml.createTextNode(at)),J=o.module$build$src$core$utils$xml.createElement("block"),J.setAttribute("type",G),J.appendChild(ie),le.callback=o.module$build$src$core$contextmenu.callbackFactory(this,J),N.push(le)}},onchange:function(N){N=this.getFieldValue("VAR"),N=o.module$build$src$core$variables.getVariable(this.workspace,N),this.type==="variables_get_dynamic"?this.outputConnection.setCheck(N.type):this.getInput("VALUE").connection.setCheck(N.type)}},c=function(N){return function(){const G=N.workspace,J=N.getField("VAR").getVariable();o.module$build$src$core$variables.renameVariable(G,J)}},d=function(N){return function(){const G=N.workspace,J=N.getField("VAR").getVariable();G.deleteVariableById(J.getId()),G.refreshToolboxSelection()}};o.module$build$src$core$extensions.registerMixin("contextMenu_variableDynamicSetterGetter",p),u(l.blocks);var _={};o.module$build$src$core$contextmenu,o.module$build$src$core$extensions,o.module$build$src$core$variables,o.module$build$src$core$utils$xml;var b=o.module$build$src$core$msg.Msg,$=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,E=o.module$build$src$core$common.defineBlocks;_.blocks=$([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]);var y={customContextMenu:function(N){if(this.isInFlyout)(this.type==="variables_get"||this.type==="variables_get_reporter")&&(G={text:b.RENAME_VARIABLE,enabled:true,callback:f(this)},ie=this.getField("VAR").getText(),ie={text:b.DELETE_VARIABLE.replace("%1",ie),enabled:true,callback:v(this)},N.unshift(G),N.unshift(ie));else{if(this.type==="variables_get")var G="variables_set",J=b.VARIABLES_GET_CREATE_SET;else G="variables_get",J=b.VARIABLES_SET_CREATE_GET;var ie={enabled:0<this.workspace.remainingCapacity()},le=this.getField("VAR").getText();ie.text=J.replace("%1",le),J=o.module$build$src$core$utils$xml.createElement("field"),J.setAttribute("name","VAR"),J.appendChild(o.module$build$src$core$utils$xml.createTextNode(le)),le=o.module$build$src$core$utils$xml.createElement("block"),le.setAttribute("type",G),le.appendChild(J),ie.callback=o.module$build$src$core$contextmenu.callbackFactory(this,le),N.push(ie)}}},f=function(N){return function(){const G=N.workspace,J=N.getField("VAR").getVariable();o.module$build$src$core$variables.renameVariable(G,J)}},v=function(N){return function(){const G=N.workspace,J=N.getField("VAR").getVariable();G.deleteVariableById(J.getId()),G.refreshToolboxSelection()}};o.module$build$src$core$extensions.registerMixin("contextMenu_variableSetterGetter",y),E(_.blocks);var T={};o.module$build$src$core$extensions;var S=o.module$build$src$core$msg.Msg;o.module$build$src$core$utils$xml,o.Align$$module$build$src$core$input,o.module$build$src$core$connection_type.ConnectionType;var R=o.module$build$src$core$field_dropdown.FieldDropdown;o.FieldImage$$module$build$src$core$field_image,o.FieldTextInput$$module$build$src$core$field_textinput,o.Mutator$$module$build$src$core$mutator;var O=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,A=o.module$build$src$core$common.defineBlocks;T.blocks=O([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"¶"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:false},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:false},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:true,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:true,mutator:"text_charAt_mutator"}]),T.blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[S.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[S.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[S.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[S.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[S.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[S.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(S.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(S.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),S.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(S.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(true),this.setOutput(true,"String"),this.updateAt_(1,true),this.updateAt_(2,true),this.setTooltip(S.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");var G=this.getInput("AT1").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at1",G),G=this.getInput("AT2").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE,N.setAttribute("at2",G),N},domToMutation:function(N){const G=N.getAttribute("at1")==="true";N=N.getAttribute("at2")==="true",this.updateAt_(1,G),this.updateAt_(2,N)},updateAt_:function(N,G){this.removeInput("AT"+N),this.removeInput("ORDINAL"+N,true),G?(this.appendValueInput("AT"+N).setCheck("Number"),S.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+N).appendField(S.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+N),N===2&&S.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",true),this.appendDummyInput("TAIL").appendField(S.TEXT_GET_SUBSTRING_TAIL));const J=new R(this["WHERE_OPTIONS_"+N],function(ie){const le=ie==="FROM_START"||ie==="FROM_END";if(le!==G){const at=this.getSourceBlock();return at.updateAt_(N,le),at.setFieldValue(ie,"WHERE"+N),null}});this.getInput("AT"+N).appendField(J,"WHERE"+N),N===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},T.blocks.text_changeCase={init:function(){const N=[[S.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[S.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[S.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(S.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new R(N),"CASE"),this.setOutput(true,"String"),this.setTooltip(S.TEXT_CHANGECASE_TOOLTIP)}},T.blocks.text_trim={init:function(){const N=[[S.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[S.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[S.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(S.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new R(N),"MODE"),this.setOutput(true,"String"),this.setTooltip(S.TEXT_TRIM_TOOLTIP)}},T.blocks.text_print={init:function(){this.jsonInit({message0:S.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:S.TEXT_PRINT_TOOLTIP,helpUrl:S.TEXT_PRINT_HELPURL})}};var L={updateType_:function(N){this.outputConnection.setCheck(N==="NUMBER"?"Number":"String")},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("type",this.getFieldValue("TYPE")),N},domToMutation:function(N){this.updateType_(N.getAttribute("type"))}};T.blocks.text_prompt_ext=Object.assign({},L,{init:function(){var N=[[S.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[S.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(S.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");const G=this;N=new R(N,function(J){G.updateType_(J)}),this.appendValueInput("TEXT").appendField(N,"TYPE"),this.setOutput(true,"String"),this.setTooltip(function(){return G.getFieldValue("TYPE")==="TEXT"?S.TEXT_PROMPT_TOOLTIP_TEXT:S.TEXT_PROMPT_TOOLTIP_NUMBER})}}),T.blocks.text_prompt=Object.assign({},L,{init:function(){this.mixin(I);var N=[[S.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[S.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];const G=this;this.setHelpUrl(S.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),N=new R(N,function(J){G.updateType_(J)}),this.appendDummyInput().appendField(N,"TYPE").appendField(this.newQuote_(true)).appendField(new o.FieldTextInput$$module$build$src$core$field_textinput(""),"TEXT").appendField(this.newQuote_(false)),this.setOutput(true,"String"),this.setTooltip(function(){return G.getFieldValue("TYPE")==="TEXT"?S.TEXT_PROMPT_TOOLTIP_TEXT:S.TEXT_PROMPT_TOOLTIP_NUMBER})}}),T.blocks.text_count={init:function(){this.jsonInit({message0:S.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:true,style:"text_blocks",tooltip:S.TEXT_COUNT_TOOLTIP,helpUrl:S.TEXT_COUNT_HELPURL})}},T.blocks.text_replace={init:function(){this.jsonInit({message0:S.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:true,style:"text_blocks",tooltip:S.TEXT_REPLACE_TOOLTIP,helpUrl:S.TEXT_REPLACE_HELPURL})}},T.blocks.text_reverse={init:function(){this.jsonInit({message0:S.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:true,style:"text_blocks",tooltip:S.TEXT_REVERSE_TOOLTIP,helpUrl:S.TEXT_REVERSE_HELPURL})}};var I={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(N){for(let G=0,J;J=this.inputList[G];G++)for(let ie=0,le;le=J.fieldRow[ie];ie++)if(N===le.name){J.insertFieldAt(ie,this.newQuote_(true)),J.insertFieldAt(ie+2,this.newQuote_(false));return}console.warn('field named "'+N+'" not found in '+this.toDevString())},newQuote_:function(N){return N=this.RTL?!N:N,new o.FieldImage$$module$build$src$core$field_image(N?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,N?"“":"”")}},k=function(){this.mixin(I),this.quoteField_("TEXT")},B={mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("items",this.itemCount_),N},domToMutation:function(N){this.itemCount_=parseInt(N.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(N){this.itemCount_=N.itemCount,this.updateShape_()},decompose:function(N){const G=N.newBlock("text_create_join_container");G.initSvg();let J=G.getInput("STACK").connection;for(let ie=0;ie<this.itemCount_;ie++){const le=N.newBlock("text_create_join_item");le.initSvg(),J.connect(le.previousConnection),J=le.nextConnection}return G},compose:function(N){var G=N.getInputTargetBlock("STACK");for(N=[];G;)G.isInsertionMarker()||N.push(G.valueConnection_),G=G.getNextBlock();for(G=0;G<this.itemCount_;G++){const J=this.getInput("ADD"+G).connection.targetConnection;J&&N.indexOf(J)===-1&&J.disconnect()}for(this.itemCount_=N.length,this.updateShape_(),G=0;G<this.itemCount_;G++)o.Mutator$$module$build$src$core$mutator.reconnect(N[G],this,"ADD"+G)},saveConnections:function(N){N=N.getInputTargetBlock("STACK");let G=0;for(;N;){if(N.isInsertionMarker()){N=N.getNextBlock();continue}const J=this.getInput("ADD"+G);N.valueConnection_=J&&J.connection.targetConnection,N=N.getNextBlock(),G++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(true)).appendField(this.newQuote_(false));for(var N=0;N<this.itemCount_;N++)if(!this.getInput("ADD"+N)){const G=this.appendValueInput("ADD"+N).setAlign(o.Align$$module$build$src$core$input.RIGHT);N===0&&G.appendField(S.TEXT_JOIN_TITLE_CREATEWITH)}for(N=this.itemCount_;this.getInput("ADD"+N);N++)this.removeInput("ADD"+N)}},U=function(){this.mixin(I),this.itemCount_=2,this.updateShape_(),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["text_create_join_item"],this))};o.module$build$src$core$extensions.register("text_append_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var P=function(){const N=this;this.setTooltip(function(){return S.TEXT_INDEXOF_TOOLTIP.replace("%1",N.workspace.options.oneBasedIndex?"0":"-1")})},z={mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("at",!!this.isAt_),N},domToMutation:function(N){N=N.getAttribute("at")!=="false",this.updateAt_(N)},updateAt_:function(N){this.removeInput("AT",true),this.removeInput("ORDINAL",true),N&&(this.appendValueInput("AT").setCheck("Number"),S.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(S.ORDINAL_NUMBER_SUFFIX)),S.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",true),this.appendDummyInput("TAIL").appendField(S.TEXT_CHARAT_TAIL)),this.isAt_=N}},W=function(){this.getField("WHERE").setValidator(function(G){G=G==="FROM_START"||G==="FROM_END",G!==this.isAt_&&this.getSourceBlock().updateAt_(G)}),this.updateAt_(true);const N=this;this.setTooltip(function(){var G=N.getFieldValue("WHERE");let J=S.TEXT_CHARAT_TOOLTIP;return(G==="FROM_START"||G==="FROM_END")&&(G=G==="FROM_START"?S.LISTS_INDEX_FROM_START_TOOLTIP:S.LISTS_INDEX_FROM_END_TOOLTIP)&&(J+="  "+G.replace("%1",N.workspace.options.oneBasedIndex?"#1":"#0")),J})};o.module$build$src$core$extensions.register("text_indexOf_tooltip",P),o.module$build$src$core$extensions.register("text_quotes",k),o.module$build$src$core$extensions.registerMutator("text_join_mutator",B,U),o.module$build$src$core$extensions.registerMutator("text_charAt_mutator",z,W),A(T.blocks);var j={};o.module$build$src$core$contextmenu,o.module$build$src$core$events$events,o.module$build$src$core$procedures,o.module$build$src$core$variables,o.module$build$src$core$xml,o.module$build$src$core$utils$xml,o.Align$$module$build$src$core$input,o.config$$module$build$src$core$config,o.FieldCheckbox$$module$build$src$core$field_checkbox,o.FieldLabel$$module$build$src$core$field_label,o.FieldTextInput$$module$build$src$core$field_textinput;var K=o.module$build$src$core$msg.Msg;o.Mutator$$module$build$src$core$mutator,o.module$build$src$core$names.Names;var ee=o.module$build$src$core$common.defineBlocks;j.blocks={};var M={setStatements_:function(N){this.hasStatements_!==N&&(N?(this.appendStatementInput("STACK").appendField(K.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",true),this.hasStatements_=N)},updateParams_:function(){let N="";this.arguments_.length&&(N=K.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),o.module$build$src$core$events$events.disable();try{this.setFieldValue(N,"PARAMS")}finally{o.module$build$src$core$events$events.enable()}},mutationToDom:function(N){const G=o.module$build$src$core$utils$xml.createElement("mutation");N&&G.setAttribute("name",this.getFieldValue("NAME"));for(let J=0;J<this.argumentVarModels_.length;J++){const ie=o.module$build$src$core$utils$xml.createElement("arg"),le=this.argumentVarModels_[J];ie.setAttribute("name",le.name),ie.setAttribute("varid",le.getId()),N&&this.paramIds_&&ie.setAttribute("paramId",this.paramIds_[J]),G.appendChild(ie)}return this.hasStatements_||G.setAttribute("statements","false"),G},domToMutation:function(N){this.arguments_=[],this.argumentVarModels_=[];for(let J=0,ie;ie=N.childNodes[J];J++)if(ie.nodeName.toLowerCase()==="arg"){const le=ie.getAttribute("name");var G=ie.getAttribute("varid")||ie.getAttribute("varId");this.arguments_.push(le),G=o.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,G,le,""),G!==null?this.argumentVarModels_.push(G):console.log(`Failed to create a variable named "${le}", ignoring.`)}this.updateParams_(),o.module$build$src$core$procedures.mutateCallers(this),this.setStatements_(N.getAttribute("statements")!=="false")},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const N=Object.create(null);if(this.argumentVarModels_.length){N.params=[];for(let G=0;G<this.argumentVarModels_.length;G++)N.params.push({name:this.argumentVarModels_[G].name,id:this.argumentVarModels_[G].getId()})}return this.hasStatements_||(N.hasStatements=false),N},loadExtraState:function(N){if(this.arguments_=[],this.argumentVarModels_=[],N.params)for(let J=0;J<N.params.length;J++){var G=N.params[J];G=o.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,G.id,G.name,""),this.arguments_.push(G.name),this.argumentVarModels_.push(G)}this.updateParams_(),o.module$build$src$core$procedures.mutateCallers(this),this.setStatements_(N.hasStatements!==false)},decompose:function(N){const G=o.module$build$src$core$utils$xml.createElement("block");G.setAttribute("type","procedures_mutatorcontainer");var J=o.module$build$src$core$utils$xml.createElement("statement");J.setAttribute("name","STACK"),G.appendChild(J);for(let le=0;le<this.arguments_.length;le++){const at=o.module$build$src$core$utils$xml.createElement("block");at.setAttribute("type","procedures_mutatorarg");var ie=o.module$build$src$core$utils$xml.createElement("field");ie.setAttribute("name","NAME");const Xi=o.module$build$src$core$utils$xml.createTextNode(this.arguments_[le]);ie.appendChild(Xi),at.appendChild(ie),ie=o.module$build$src$core$utils$xml.createElement("next"),at.appendChild(ie),J.appendChild(at),J=ie}return N=o.module$build$src$core$xml.domToBlock(G,N),this.type==="procedures_defreturn"?N.setFieldValue(this.hasStatements_,"STATEMENTS"):N.removeInput("STATEMENT_INPUT"),o.module$build$src$core$procedures.mutateCallers(this),N},compose:function(N){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let G=N.getInputTargetBlock("STACK");for(;G&&!G.isInsertionMarker();){var J=G.getFieldValue("NAME");this.arguments_.push(J),J=this.workspace.getVariable(J,""),this.argumentVarModels_.push(J),this.paramIds_.push(G.id),G=G.nextConnection&&G.nextConnection.targetBlock()}this.updateParams_(),o.module$build$src$core$procedures.mutateCallers(this),N=N.getFieldValue("STATEMENTS"),N!==null&&(N=N==="TRUE",this.hasStatements_!==N)&&(N?(this.setStatements_(true),o.Mutator$$module$build$src$core$mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(N=this.getInput("STACK").connection,(this.statementConnection_=N.targetConnection)&&(N=N.targetBlock(),N.unplug(),N.bumpNeighbours()),this.setStatements_(false)))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(N,G){var J=this.workspace.getVariableById(N);if(J.type===""){J=J.name,G=this.workspace.getVariableById(G);var ie=false;for(let le=0;le<this.argumentVarModels_.length;le++)this.argumentVarModels_[le].getId()===N&&(this.arguments_[le]=G.name,this.argumentVarModels_[le]=G,ie=true);ie&&(this.displayRenamedVar_(J,G.name),o.module$build$src$core$procedures.mutateCallers(this))}},updateVarName:function(N){const G=N.name;let J=false,ie;for(let le=0;le<this.argumentVarModels_.length;le++)this.argumentVarModels_[le].getId()===N.getId()&&(ie=this.arguments_[le],this.arguments_[le]=G,J=true);J&&(this.displayRenamedVar_(ie,G),o.module$build$src$core$procedures.mutateCallers(this))},displayRenamedVar_:function(N,G){if(this.updateParams_(),this.mutator&&this.mutator.isVisible()){const J=this.mutator.workspace_.getAllBlocks(false);for(let ie=0,le;le=J[ie];ie++)le.type==="procedures_mutatorarg"&&o.module$build$src$core$names.Names.equals(N,le.getFieldValue("NAME"))&&le.setFieldValue(G,"NAME")}},customContextMenu:function(N){if(!this.isInFlyout){var G={enabled:true},J=this.getFieldValue("NAME");G.text=K.PROCEDURES_CREATE_DO.replace("%1",J);var ie=o.module$build$src$core$utils$xml.createElement("mutation");for(ie.setAttribute("name",J),J=0;J<this.arguments_.length;J++){var le=o.module$build$src$core$utils$xml.createElement("arg");le.setAttribute("name",this.arguments_[J]),ie.appendChild(le)}if(J=o.module$build$src$core$utils$xml.createElement("block"),J.setAttribute("type",this.callType_),J.appendChild(ie),G.callback=o.module$build$src$core$contextmenu.callbackFactory(this,J),N.push(G),!this.isCollapsed())for(G=0;G<this.argumentVarModels_.length;G++)ie={enabled:true},J=this.argumentVarModels_[G],ie.text=K.VARIABLES_SET_CREATE_GET.replace("%1",J.name),J=o.module$build$src$core$variables.generateVariableFieldDom(J),le=o.module$build$src$core$utils$xml.createElement("block"),le.setAttribute("type","variables_get"),le.appendChild(J),ie.callback=o.module$build$src$core$contextmenu.callbackFactory(this,le),N.push(ie)}}};j.blocks.procedures_defnoreturn=Object.assign({},M,{init:function(){var N=o.module$build$src$core$procedures.findLegalName("",this);N=new o.FieldTextInput$$module$build$src$core$field_textinput(N,o.module$build$src$core$procedures.rename),N.setSpellcheck(false),this.appendDummyInput().appendField(K.PROCEDURES_DEFNORETURN_TITLE).appendField(N,"NAME").appendField("","PARAMS"),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&K.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(K.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(K.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(K.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(true),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,false]},callType_:"procedures_callnoreturn"}),j.blocks.procedures_defreturn=Object.assign({},M,{init:function(){var N=o.module$build$src$core$procedures.findLegalName("",this);N=new o.FieldTextInput$$module$build$src$core$field_textinput(N,o.module$build$src$core$procedures.rename),N.setSpellcheck(false),this.appendDummyInput().appendField(K.PROCEDURES_DEFRETURN_TITLE).appendField(N,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(o.Align$$module$build$src$core$input.RIGHT).appendField(K.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&K.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(K.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(K.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(K.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(true),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,true]},callType_:"procedures_callreturn"}),j.blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(K.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(K.PROCEDURES_ALLOW_STATEMENTS).appendField(new o.FieldCheckbox$$module$build$src$core$field_checkbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(K.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=false}},j.blocks.procedures_mutatorarg={init:function(){const N=new o.FieldTextInput$$module$build$src$core$field_textinput(o.module$build$src$core$procedures.DEFAULT_ARG,this.validator_);N.oldShowEditorFn_=N.showEditor_,N.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(K.PROCEDURES_MUTATORARG_TITLE).appendField(N,"NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setStyle("procedure_blocks"),this.setTooltip(K.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=false,N.onFinishEditing_=this.deleteIntermediateVars_,N.createdVariables_=[],N.onFinishEditing_("x")},validator_:function(N){var G=this.getSourceBlock();const J=o.Mutator$$module$build$src$core$mutator.findParentWs(G.workspace);if(N=N.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),!N)return null;const ie=(G.workspace.targetWorkspace||G.workspace).getAllBlocks(false),le=N.toLowerCase();for(let at=0;at<ie.length;at++){if(ie[at].id===this.getSourceBlock().id)continue;const Xi=ie[at].getFieldValue("NAME");if(Xi&&Xi.toLowerCase()===le)return null}return G.isInFlyout||((G=J.getVariable(N,""))&&G.name!==N&&J.renameVariableById(G.getId(),N),G||(G=J.createVariable(N,""))&&this.createdVariables_&&this.createdVariables_.push(G)),N},deleteIntermediateVars_:function(N){const G=o.Mutator$$module$build$src$core$mutator.findParentWs(this.getSourceBlock().workspace);if(G)for(let J=0;J<this.createdVariables_.length;J++){const ie=this.createdVariables_[J];ie.name!==N&&G.deleteVariableById(ie.getId())}}};var F={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(N,G){o.module$build$src$core$names.Names.equals(N,this.getProcedureCall())&&(this.setFieldValue(G,"NAME"),this.setTooltip((this.outputConnection?K.PROCEDURES_CALLRETURN_TOOLTIP:K.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",G)))},setProcedureParameters_:function(N,G){var J=o.module$build$src$core$procedures.getDefinition(this.getProcedureCall(),this.workspace),ie=J&&J.mutator&&J.mutator.isVisible();if(ie?this.setCollapsed(false):(this.quarkConnections_={},this.quarkIds_=null),N.join(`
`)===this.arguments_.join(`
`))this.quarkIds_=G;else{if(G.length!==N.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),J=this.rendered,this.rendered=false;for(let at=0;at<this.arguments_.length;at++){var le=this.getInput("ARG"+at);le&&(le=le.connection.targetConnection,this.quarkConnections_[this.quarkIds_[at]]=le,ie&&le&&G.indexOf(this.quarkIds_[at])===-1&&(le.disconnect(),le.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(N),this.argumentVarModels_=[],N=0;N<this.arguments_.length;N++)ie=o.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[N],""),this.argumentVarModels_.push(ie);if(this.updateShape_(),this.quarkIds_=G)for(G=0;G<this.arguments_.length;G++)N=this.quarkIds_[G],N in this.quarkConnections_&&(o.Mutator$$module$build$src$core$mutator.reconnect(this.quarkConnections_[N],this,"ARG"+G)||delete this.quarkConnections_[N]);(this.rendered=J)&&this.render()}},updateShape_:function(){for(var N=0;N<this.arguments_.length;N++){var G=this.getField("ARGNAME"+N);if(G){o.module$build$src$core$events$events.disable();try{G.setValue(this.arguments_[N])}finally{o.module$build$src$core$events$events.enable()}}else G=new o.FieldLabel$$module$build$src$core$field_label(this.arguments_[N]),this.appendValueInput("ARG"+N).setAlign(o.Align$$module$build$src$core$input.RIGHT).appendField(G,"ARGNAME"+N).init()}for(N=this.arguments_.length;this.getInput("ARG"+N);N++)this.removeInput("ARG"+N);(N=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(N.appendField(K.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),N.init()):this.getField("WITH")&&N.removeField("WITH"))},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");N.setAttribute("name",this.getProcedureCall());for(let G=0;G<this.arguments_.length;G++){const J=o.module$build$src$core$utils$xml.createElement("arg");J.setAttribute("name",this.arguments_[G]),N.appendChild(J)}return N},domToMutation:function(N){var G=N.getAttribute("name");this.renameProcedure(this.getProcedureCall(),G),G=[];const J=[];for(let ie=0,le;le=N.childNodes[ie];ie++)le.nodeName.toLowerCase()==="arg"&&(G.push(le.getAttribute("name")),J.push(le.getAttribute("paramId")));this.setProcedureParameters_(G,J)},saveExtraState:function(){const N=Object.create(null);return N.name=this.getProcedureCall(),this.arguments_.length&&(N.params=this.arguments_),N},loadExtraState:function(N){if(this.renameProcedure(this.getProcedureCall(),N.name),N=N.params){const G=[];G.length=N.length,G.fill(null),this.setProcedureParameters_(N,G)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(N){if(this.workspace&&!this.workspace.isFlyout&&N.recordUndo)if(N.type===o.module$build$src$core$events$events.BLOCK_CREATE&&N.ids.indexOf(this.id)!==-1){var G=this.getProcedureCall();if(G=o.module$build$src$core$procedures.getDefinition(G,this.workspace),!G||G.type===this.defType_&&JSON.stringify(G.getVars())===JSON.stringify(this.arguments_)||(G=null),!G){o.module$build$src$core$events$events.setGroup(N.group),N=o.module$build$src$core$utils$xml.createElement("xml"),G=o.module$build$src$core$utils$xml.createElement("block"),G.setAttribute("type",this.defType_);var J=this.getRelativeToSurfaceXY(),ie=J.y+2*o.config$$module$build$src$core$config.snapRadius;G.setAttribute("x",J.x+o.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)),G.setAttribute("y",ie),J=this.mutationToDom(),G.appendChild(J),J=o.module$build$src$core$utils$xml.createElement("field"),J.setAttribute("name","NAME"),ie=this.getProcedureCall();const le=o.module$build$src$core$procedures.findLegalName(ie,this);ie!==le&&this.renameProcedure(ie,le),J.appendChild(o.module$build$src$core$utils$xml.createTextNode(ie)),G.appendChild(J),N.appendChild(G),o.module$build$src$core$xml.domToWorkspace(N,this.workspace),o.module$build$src$core$events$events.setGroup(false)}}else N.type===o.module$build$src$core$events$events.BLOCK_DELETE?(G=this.getProcedureCall(),o.module$build$src$core$procedures.getDefinition(G,this.workspace)||(o.module$build$src$core$events$events.setGroup(N.group),this.dispose(true),o.module$build$src$core$events$events.setGroup(false))):N.type===o.module$build$src$core$events$events.CHANGE&&N.element==="disabled"&&(G=this.getProcedureCall(),(G=o.module$build$src$core$procedures.getDefinition(G,this.workspace))&&G.id===N.blockId&&((G=o.module$build$src$core$events$events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),o.module$build$src$core$events$events.setGroup(N.group),N.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(false)):this.setEnabled(this.previousEnabledState_),o.module$build$src$core$events$events.setGroup(G)))},customContextMenu:function(N){if(this.workspace.isMovable()){var G={enabled:true};G.text=K.PROCEDURES_HIGHLIGHT_DEF;var J=this.getProcedureCall(),ie=this.workspace;G.callback=function(){const le=o.module$build$src$core$procedures.getDefinition(J,ie);le&&(ie.centerOnBlock(le.id),le.select())},N.push(G)}}};j.blocks.procedures_callnoreturn=Object.assign({},F,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setStyle("procedure_blocks"),this.setHelpUrl(K.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=true},defType_:"procedures_defnoreturn"}),j.blocks.procedures_callreturn=Object.assign({},F,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(true),this.setStyle("procedure_blocks"),this.setHelpUrl(K.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=true},defType_:"procedures_defreturn"}),j.blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(K.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(K.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(true),this.setPreviousStatement(true),this.setNextStatement(true),this.setStyle("procedure_blocks"),this.setTooltip(K.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(K.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=true},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("value",Number(this.hasReturnValue_)),N},domToMutation:function(N){this.hasReturnValue_=N.getAttribute("value")==="1",this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(K.PROCEDURES_DEFRETURN_RETURN))},onchange:function(N){if(!(this.workspace.isDragging&&this.workspace.isDragging()||N.type!==o.module$build$src$core$events$events.BLOCK_MOVE)){var G=false,J=this;do{if(this.FUNCTION_TYPES.indexOf(J.type)!==-1){G=true;break}J=J.getSurroundParent()}while(J);G?(J.type==="procedures_defnoreturn"&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(K.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=false):J.type!=="procedures_defreturn"||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(K.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=true),this.setWarningText(null)):this.setWarningText(K.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||(J=o.module$build$src$core$events$events.getGroup(),o.module$build$src$core$events$events.setGroup(N.group),this.setEnabled(G),o.module$build$src$core$events$events.setGroup(J))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},ee(j.blocks);var V={};o.module$build$src$core$extensions,o.module$build$src$core$field_dropdown,o.module$build$src$core$utils$xml;var X=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,H=o.module$build$src$core$common.defineBlocks;V.blocks=X([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["π","PI"],["e","E"],["φ","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(½)","SQRT1_2"],["∞","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:true,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);var ne={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};o.module$build$src$core$extensions.register("math_op_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("OP",ne));var Ie={mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation"),G=this.getFieldValue("PROPERTY")==="DIVISIBLE_BY";return N.setAttribute("divisor_input",G),N},domToMutation:function(N){N=N.getAttribute("divisor_input")==="true",this.updateShape_(N)},updateShape_:function(N){const G=this.getInput("DIVISOR");N?G||this.appendValueInput("DIVISOR").setCheck("Number"):G&&this.removeInput("DIVISOR")}},de=function(){this.getField("PROPERTY").setValidator(function(N){N=N==="DIVISIBLE_BY",this.getSourceBlock().updateShape_(N)})};o.module$build$src$core$extensions.registerMutator("math_is_divisibleby_mutator",Ie,de),o.module$build$src$core$extensions.register("math_change_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var ot={updateType_:function(N){N==="MODE"?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("op",this.getFieldValue("OP")),N},domToMutation:function(N){this.updateType_(N.getAttribute("op"))}},x=function(){this.getField("OP").setValidator(function(N){this.updateType_(N)}.bind(this))};o.module$build$src$core$extensions.registerMutator("math_modes_of_list_mutator",ot,x),H(V.blocks);var te={};o.module$build$src$core$contextmenu,o.module$build$src$core$events$events,o.module$build$src$core$extensions,o.module$build$src$core$variables,o.module$build$src$core$utils$xml;var ce=o.module$build$src$core$msg.Msg,ae=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,De=o.module$build$src$core$common.defineBlocks;te.blocks=ae([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:true,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:true,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);var $e={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};o.module$build$src$core$extensions.register("controls_whileUntil_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("MODE",$e));var st={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};o.module$build$src$core$extensions.register("controls_flow_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("FLOW",st));var bt={customContextMenu:function(N){if(!this.isInFlyout){var G=this.getField("VAR").getVariable(),J=G.name;if(!this.isCollapsed()&&J!==null){const ie={enabled:true};ie.text=ce.VARIABLES_SET_CREATE_GET.replace("%1",J),G=o.module$build$src$core$variables.generateVariableFieldDom(G),J=o.module$build$src$core$utils$xml.createElement("block"),J.setAttribute("type","variables_get"),J.appendChild(G),ie.callback=o.module$build$src$core$contextmenu.callbackFactory(this,J),N.push(ie)}}}};o.module$build$src$core$extensions.registerMixin("contextMenu_newGetVariableBlock",bt),o.module$build$src$core$extensions.register("controls_for_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),o.module$build$src$core$extensions.register("controls_forEach_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),te.loopTypes=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]);var Ut={getSurroundLoop:function(){let N=this;do{if(te.loopTypes.has(N.type))return N;N=N.getSurroundParent()}while(N);return null},onchange:function(N){if(this.workspace.isDragging&&!this.workspace.isDragging()&&N.type===o.module$build$src$core$events$events.BLOCK_MOVE){var G=this.getSurroundLoop(this);if(this.setWarningText(G?null:ce.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){const J=o.module$build$src$core$events$events.getGroup();o.module$build$src$core$events$events.setGroup(N.group),this.setEnabled(G),o.module$build$src$core$events$events.setGroup(J)}}}};o.module$build$src$core$extensions.registerMixin("controls_flow_in_loop_check",Ut),De(te.blocks);var jt={};o.module$build$src$core$events$events,o.module$build$src$core$extensions,o.module$build$src$core$utils$xml;var Ve=o.module$build$src$core$msg.Msg;o.Mutator$$module$build$src$core$mutator;var Ss=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,Cs=o.module$build$src$core$common.defineBlocks;jt.blocks=Ss([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:true,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:true,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["≠","NEQ"],["‏<","LT"],["‏≤","LTE"],["‏>","GT"],["‏≥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:true,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:true,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:false,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:false,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:false,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);var Os={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};o.module$build$src$core$extensions.register("logic_op_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("OP",Os));var zs={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const N=o.module$build$src$core$utils$xml.createElement("mutation");return this.elseifCount_&&N.setAttribute("elseif",this.elseifCount_),this.elseCount_&&N.setAttribute("else",1),N},domToMutation:function(N){this.elseifCount_=parseInt(N.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(N.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const N=Object.create(null);return this.elseifCount_&&(N.elseIfCount=this.elseifCount_),this.elseCount_&&(N.hasElse=true),N},loadExtraState:function(N){this.elseifCount_=N.elseIfCount||0,this.elseCount_=N.hasElse?1:0,this.updateShape_()},decompose:function(N){const G=N.newBlock("controls_if_if");G.initSvg();let J=G.nextConnection;for(let ie=1;ie<=this.elseifCount_;ie++){const le=N.newBlock("controls_if_elseif");le.initSvg(),J.connect(le.previousConnection),J=le.nextConnection}return this.elseCount_&&(N=N.newBlock("controls_if_else"),N.initSvg(),J.connect(N.previousConnection)),G},compose:function(N){N=N.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const G=[null],J=[null];let ie=null;for(;N;){if(!N.isInsertionMarker())switch(N.type){case"controls_if_elseif":this.elseifCount_++,G.push(N.valueConnection_),J.push(N.statementConnection_);break;case"controls_if_else":this.elseCount_++,ie=N.statementConnection_;break;default:throw TypeError("Unknown block type: "+N.type)}N=N.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(G,J,ie)},saveConnections:function(N){N=N.nextConnection.targetBlock();let G=1;for(;N;){if(!N.isInsertionMarker())switch(N.type){case"controls_if_elseif":var J=this.getInput("IF"+G);const ie=this.getInput("DO"+G);N.valueConnection_=J&&J.connection.targetConnection,N.statementConnection_=ie&&ie.connection.targetConnection,G++;break;case"controls_if_else":J=this.getInput("ELSE"),N.statementConnection_=J&&J.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+N.type)}N=N.getNextBlock()}},rebuildShape_:function(){const N=[null],G=[null];let J=null;this.getInput("ELSE")&&(J=this.getInput("ELSE").connection.targetConnection);for(let ie=1;this.getInput("IF"+ie);ie++){const le=this.getInput("IF"+ie),at=this.getInput("DO"+ie);N.push(le.connection.targetConnection),G.push(at.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(N,G,J)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var N=1;this.getInput("IF"+N);N++)this.removeInput("IF"+N),this.removeInput("DO"+N);for(N=1;N<=this.elseifCount_;N++)this.appendValueInput("IF"+N).setCheck("Boolean").appendField(Ve.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+N).appendField(Ve.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(Ve.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(N,G,J){for(let ie=1;ie<=this.elseifCount_;ie++)o.Mutator$$module$build$src$core$mutator.reconnect(N[ie],this,"IF"+ie),o.Mutator$$module$build$src$core$mutator.reconnect(G[ie],this,"DO"+ie);o.Mutator$$module$build$src$core$mutator.reconnect(J,this,"ELSE")}};o.module$build$src$core$extensions.registerMutator("controls_if_mutator",zs,null,["controls_if_elseif","controls_if_else"]);var xs=function(){this.setTooltip(function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&this.elseCount_)return Ve.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return Ve.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return Ve.CONTROLS_IF_TOOLTIP_4}else return Ve.CONTROLS_IF_TOOLTIP_1;return""}.bind(this))};o.module$build$src$core$extensions.register("controls_if_tooltip",xs);var kt={onchange:function(N){this.prevBlocks_||(this.prevBlocks_=[null,null]);var G=this.getInputTargetBlock("A");const J=this.getInputTargetBlock("B");G&&J&&!this.workspace.connectionChecker.doTypeChecks(G.outputConnection,J.outputConnection)&&(o.module$build$src$core$events$events.setGroup(N.group),N=this.prevBlocks_[0],N!==G&&(G.unplug(),!N||N.isDisposed()||N.isShadow()||this.getInput("A").connection.connect(N.outputConnection)),G=this.prevBlocks_[1],G!==J&&(J.unplug(),!G||G.isDisposed()||G.isShadow()||this.getInput("B").connection.connect(G.outputConnection)),this.bumpNeighbours(),o.module$build$src$core$events$events.setGroup(false)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},ts=function(){this.mixin(kt)};o.module$build$src$core$extensions.register("logic_compare",ts);var me={prevParentConnection_:null,onchange:function(N){const G=this.getInputTargetBlock("THEN"),J=this.getInputTargetBlock("ELSE"),ie=this.outputConnection.targetConnection;if((G||J)&&ie)for(let le=0;2>le;le++){const at=le===1?G:J;at&&!at.workspace.connectionChecker.doTypeChecks(at.outputConnection,ie)&&(o.module$build$src$core$events$events.setGroup(N.group),ie===this.prevParentConnection_?(this.unplug(),ie.getSourceBlock().bumpNeighbours()):(at.unplug(),at.bumpNeighbours()),o.module$build$src$core$events$events.setGroup(false))}this.prevParentConnection_=ie}};o.module$build$src$core$extensions.registerMixin("logic_ternary",me),Cs(jt.blocks);var He={};o.module$build$src$core$utils$xml,o.module$build$src$core$xml,o.Align$$module$build$src$core$input,o.module$build$src$core$connection_type.ConnectionType;var Dt=o.module$build$src$core$field_dropdown.FieldDropdown,ve=o.module$build$src$core$msg.Msg;o.Mutator$$module$build$src$core$mutator;var Bs=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,vs=o.module$build$src$core$common.defineBlocks;He.blocks=Bs([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:true,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),He.blocks.lists_create_with={init:function(){this.setHelpUrl(ve.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(true,"Array"),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["lists_create_with_item"],this)),this.setTooltip(ve.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("items",this.itemCount_),N},domToMutation:function(N){this.itemCount_=parseInt(N.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(N){this.itemCount_=N.itemCount,this.updateShape_()},decompose:function(N){const G=N.newBlock("lists_create_with_container");G.initSvg();let J=G.getInput("STACK").connection;for(let ie=0;ie<this.itemCount_;ie++){const le=N.newBlock("lists_create_with_item");le.initSvg(),J.connect(le.previousConnection),J=le.nextConnection}return G},compose:function(N){var G=N.getInputTargetBlock("STACK");for(N=[];G;)G.isInsertionMarker()||N.push(G.valueConnection_),G=G.getNextBlock();for(G=0;G<this.itemCount_;G++){const J=this.getInput("ADD"+G).connection.targetConnection;J&&N.indexOf(J)===-1&&J.disconnect()}for(this.itemCount_=N.length,this.updateShape_(),G=0;G<this.itemCount_;G++)o.Mutator$$module$build$src$core$mutator.reconnect(N[G],this,"ADD"+G)},saveConnections:function(N){N=N.getInputTargetBlock("STACK");let G=0;for(;N;){if(N.isInsertionMarker()){N=N.getNextBlock();continue}const J=this.getInput("ADD"+G);N.valueConnection_=J&&J.connection.targetConnection,N=N.getNextBlock(),G++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(ve.LISTS_CREATE_EMPTY_TITLE);for(var N=0;N<this.itemCount_;N++)if(!this.getInput("ADD"+N)){const G=this.appendValueInput("ADD"+N).setAlign(o.Align$$module$build$src$core$input.RIGHT);N===0&&G.appendField(ve.LISTS_CREATE_WITH_INPUT_WITH)}for(N=this.itemCount_;this.getInput("ADD"+N);N++)this.removeInput("ADD"+N)}},He.blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(ve.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(ve.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=false}},He.blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(ve.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(ve.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=false}},He.blocks.lists_indexOf={init:function(){const N=[[ve.LISTS_INDEX_OF_FIRST,"FIRST"],[ve.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(ve.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(true,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(ve.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new Dt(N),"END"),this.setInputsInline(true);const G=this;this.setTooltip(function(){return ve.LISTS_INDEX_OF_TOOLTIP.replace("%1",G.workspace.options.oneBasedIndex?"0":"-1")})}},He.blocks.lists_getIndex={init:function(){var N=[[ve.LISTS_GET_INDEX_GET,"GET"],[ve.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[ve.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[ve.LISTS_GET_INDEX_FROM_START,"FROM_START"],[ve.LISTS_GET_INDEX_FROM_END,"FROM_END"],[ve.LISTS_GET_INDEX_FIRST,"FIRST"],[ve.LISTS_GET_INDEX_LAST,"LAST"],[ve.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(ve.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),N=new Dt(N,function(J){J=J==="REMOVE",this.getSourceBlock().updateStatement_(J)}),this.appendValueInput("VALUE").setCheck("Array").appendField(ve.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(N,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),ve.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(ve.LISTS_GET_INDEX_TAIL),this.setInputsInline(true),this.setOutput(true),this.updateAt_(true);const G=this;this.setTooltip(function(){const J=G.getFieldValue("MODE"),ie=G.getFieldValue("WHERE");let le="";switch(J+" "+ie){case"GET FROM_START":case"GET FROM_END":le=ve.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":le=ve.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":le=ve.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":le=ve.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":le=ve.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":le=ve.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":le=ve.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":le=ve.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":le=ve.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":le=ve.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":le=ve.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":le=ve.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return(ie==="FROM_START"||ie==="FROM_END")&&(le+="  "+(ie==="FROM_START"?ve.LISTS_INDEX_FROM_START_TOOLTIP:ve.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",G.workspace.options.oneBasedIndex?"#1":"#0")),le})},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");N.setAttribute("statement",!this.outputConnection);const G=this.getInput("AT").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at",G),N},domToMutation:function(N){const G=N.getAttribute("statement")==="true";this.updateStatement_(G),N=N.getAttribute("at")!=="false",this.updateAt_(N)},saveExtraState:function(){return this.outputConnection?null:{isStatement:true}},loadExtraState:function(N){N.isStatement?this.updateStatement_(true):typeof N=="string"&&this.domToMutation(o.module$build$src$core$xml.textToDom(N))},updateStatement_:function(N){N!==!this.outputConnection&&(this.unplug(true,true),N?(this.setOutput(false),this.setPreviousStatement(true),this.setNextStatement(true)):(this.setPreviousStatement(false),this.setNextStatement(false),this.setOutput(true)))},updateAt_:function(N){this.removeInput("AT"),this.removeInput("ORDINAL",true),N?(this.appendValueInput("AT").setCheck("Number"),ve.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(ve.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const G=new Dt(this.WHERE_OPTIONS,function(J){const ie=J==="FROM_START"||J==="FROM_END";if(ie!==N){const le=this.getSourceBlock();return le.updateAt_(ie),le.setFieldValue(J,"WHERE"),null}});this.getInput("AT").appendField(G,"WHERE"),ve.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},He.blocks.lists_setIndex={init:function(){const N=[[ve.LISTS_SET_INDEX_SET,"SET"],[ve.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[ve.LISTS_GET_INDEX_FROM_START,"FROM_START"],[ve.LISTS_GET_INDEX_FROM_END,"FROM_END"],[ve.LISTS_GET_INDEX_FIRST,"FIRST"],[ve.LISTS_GET_INDEX_LAST,"LAST"],[ve.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(ve.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(ve.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new Dt(N),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(ve.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(true),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(ve.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(true);const G=this;this.setTooltip(function(){const J=G.getFieldValue("MODE"),ie=G.getFieldValue("WHERE");let le="";switch(J+" "+ie){case"SET FROM_START":case"SET FROM_END":le=ve.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":le=ve.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":le=ve.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":le=ve.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":le=ve.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":le=ve.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":le=ve.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":le=ve.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return(ie==="FROM_START"||ie==="FROM_END")&&(le+="  "+ve.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",G.workspace.options.oneBasedIndex?"#1":"#0")),le})},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation"),G=this.getInput("AT").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at",G),N},domToMutation:function(N){N=N.getAttribute("at")!=="false",this.updateAt_(N)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(N){this.removeInput("AT"),this.removeInput("ORDINAL",true),N?(this.appendValueInput("AT").setCheck("Number"),ve.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(ve.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const G=new Dt(this.WHERE_OPTIONS,function(J){const ie=J==="FROM_START"||J==="FROM_END";if(ie!==N){const le=this.getSourceBlock();return le.updateAt_(ie),le.setFieldValue(J,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(G,"WHERE")}},He.blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[ve.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[ve.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[ve.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[ve.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[ve.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[ve.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(ve.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(ve.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),ve.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(ve.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(true),this.setOutput(true,"Array"),this.updateAt_(1,true),this.updateAt_(2,true),this.setTooltip(ve.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");var G=this.getInput("AT1").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at1",G),G=this.getInput("AT2").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE,N.setAttribute("at2",G),N},domToMutation:function(N){const G=N.getAttribute("at1")==="true";N=N.getAttribute("at2")==="true",this.updateAt_(1,G),this.updateAt_(2,N)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(N,G){this.removeInput("AT"+N),this.removeInput("ORDINAL"+N,true),G?(this.appendValueInput("AT"+N).setCheck("Number"),ve.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+N).appendField(ve.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+N);const J=new Dt(this["WHERE_OPTIONS_"+N],function(ie){const le=ie==="FROM_START"||ie==="FROM_END";if(le!==G){const at=this.getSourceBlock();return at.updateAt_(N,le),at.setFieldValue(ie,"WHERE"+N),null}});this.getInput("AT"+N).appendField(J,"WHERE"+N),N===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),ve.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},He.blocks.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},He.blocks.lists_split={init:function(){const N=this,G=new Dt([[ve.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[ve.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(J){N.updateType_(J)});this.setHelpUrl(ve.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(G,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(ve.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(true),this.setOutput(true,"Array"),this.setTooltip(function(){const J=N.getFieldValue("MODE");if(J==="SPLIT")return ve.LISTS_SPLIT_TOOLTIP_SPLIT;if(J==="JOIN")return ve.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+J)})},updateType_:function(N){if(this.getFieldValue("MODE")!==N){const G=this.getInput("INPUT").connection;G.setShadowDom(null);const J=G.targetBlock();J&&(G.disconnect(),J.isShadow()?J.dispose():this.bumpNeighbours())}N==="SPLIT"?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("mode",this.getFieldValue("MODE")),N},domToMutation:function(N){this.updateType_(N.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},vs(He.blocks);var ks={},Rt=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,Li=o.module$build$src$core$common.defineBlocks;ks.blocks=Rt([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),Li(ks.blocks);var as={};return as.colour=ks,as.lists=He,as.logic=jt,as.loops=te,as.math=V,as.procedures=j,as.texts=T,as.variables=_,as.variablesDynamic=l,as.blocks=Object.assign({},ks.blocks,He.blocks,jt.blocks,te.blocks,V.blocks,j.blocks,_.blocks,l.blocks),as.__namespace__=o,as})}(Eg)),Eg.exports}var m$;function hB(){return m$||(m$=1,function(s,n){(function(i,o){s.exports=o(uB())})(ki,function(i){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(mg)),mg.exports}var E$;function dB(){return E$||(E$=1,function(s,n){(function(i,o){s.exports=o(q0(),cB(),hB(),J0())})(ki,function(i,o,l,g){return i.setLocale(o),i})}(gg)),gg.exports}var v$;function _B(){return v$||(v$=1,function(s,n){(function(i,o){s.exports=o(dB())})(ki,function(i){/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(pg)),pg.exports}var w=_B();const pB={class:"dialog-footer"},gB=Xe({__name:"author",props:["modelValue"],emits:["update:modelValue","callback"],setup(s,{emit:n}){const i=Ee({name:"",email:""}),o=s,l=n,g=Ee(false);function m(){if(!(!i.value.name||!i.value.email)){if(!i.value.name.match(/^[A-Za-z0-9_-]+$/)){alert("作者名称只能包含英文、数字、下划线和中划线");return}if(!i.value.email.match(/^[A-Za-z0-9_-]+@[A-Za-z0-9_\-.]+$/)){alert("作者邮箱格式不正确");return}l("update:modelValue",false),l("callback",i.value.name+"<"+i.value.email+">"),i.value.name=void 0,i.value.email=void 0}}return Ct(o,u=>{g.value=!!o.modelValue;const c=/^([A-Za-z0-9_-]+)<([A-Za-z0-9_-]+@[A-Za-z0-9_\-.]+)>$/.exec(o.modelValue);c&&(i.value.name=c[1],i.value.email=c[2])}),Ct(g,u=>{l("update:modelValue",u||void 0)}),(u,p)=>{const c=ht("el-input"),d=ht("el-button"),_=ht("el-dialog");return oe(),Je(_,{modelValue:g.value,"onUpdate:modelValue":p[4]||(p[4]=b=>g.value=b),title:"设置作者"},{footer:je(()=>[he("span",pB,[Me(d,{onClick:p[2]||(p[2]=b=>l("update:modelValue"))},{default:je(()=>p[5]||(p[5]=[xt("关闭")])),_:1}),Me(d,{type:"primary",onClick:p[3]||(p[3]=b=>m())},{default:je(()=>p[6]||(p[6]=[xt(" 确定 ")])),_:1})])]),default:je(()=>[Me(c,{modelValue:i.value.name,"onUpdate:modelValue":p[0]||(p[0]=b=>i.value.name=b),placeholder:"作者名称(请使用英文名称)"},null,8,["modelValue"]),Me(c,{modelValue:i.value.email,"onUpdate:modelValue":p[1]||(p[1]=b=>i.value.email=b),placeholder:"作者邮箱"},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),fB={style:{display:"flex","flex-flow":"column",contain:"size",overflow:"hidden",height:"100%"}},mB={style:{width:"100%",padding:"5px","padding-left":"20px",height:"25px","border-bottom":"1px solid var(--bg1)"}},EB={style:{padding:"20px"}},vB=Xe({__name:"meta",props:["current","workspace"],emits:["update:workspace","metaChange"],setup(s,{emit:n}){const i=n,o=s,l=Ee([]),g=_e(()=>Jn.blockly.find($=>{var E;return $.id.toString()===((E=o.current)==null?void 0:E.toString())})),m=Ee({author:void 0,description:"",commands:{},tables:{}});function u(){l.value=[],this.getAllBlocks(false).forEach($=>{$.type==="command"&&l.value.push($)})}try{w.serialization.registry.unregister("plugin-meta"),w.serialization.registry.register("plugin-meta",{save($){return $.meta=cf(m.value),m.value},load($,E){$&&(m.value.author=$.author,m.value.description=$.description??void 0,E.metaListener=u.bind(E),E.addChangeListener(E.metaListener),E.metaListener(),m.value.commands=$.commands??{},m.value.tables=$.tables??{},E.meta=cf(m.value))},clear($){m.value.description="",m.value.author=void 0,$.removeChangeListener($.metaListener),$.meta={}},priority:10})}catch($){console.error($)}function p($){m.value.author=$,i("metaChange")}Ct(m.value,()=>{i("metaChange")});const c=Ee(void 0);function d(){const $=prompt("请输入数据表名");$&&(m.value.tables[$]={columns:{}})}const _=_e(()=>l.value.map($=>$.getFieldValue("name"))),b=_e(()=>cm([..._.value,...Object.keys(m.value.commands)]));return($,E)=>{const y=ht("k-button"),f=ht("el-input"),v=ht("el-button"),T=ht("el-table-column"),S=ht("el-table"),R=ht("el-input-number"),O=ht("el-scrollbar");return oe(),be(Pt,null,[Me(gB,{modelValue:c.value,"onUpdate:modelValue":E[0]||(E[0]=A=>c.value=A),onCallback:p},null,8,["modelValue"]),he("div",fB,[he("div",mB,[he("button",{class:"menu-button",onClick:E[1]||(E[1]=A=>i("update:workspace","blockly"))},"退出元数据编辑")]),Me(O,{style:{flex:"auto"}},{default:je(()=>{var A;return[he("div",EB,[E[10]||(E[10]=he("h2",null,"插件基本信息",-1)),he("p",null,"插件ID:"+Bt(o.current),1),he("p",null,"插件UUID: "+Bt((A=g.value)==null?void 0:A.uuid),1),he("p",null,[xt("插件作者: "+Bt(m.value.author??"未署名"),1),Me(y,{onClick:E[2]||(E[2]=L=>c.value=m.value.author??true)},{default:je(()=>E[5]||(E[5]=[xt("修改")])),_:1})]),E[11]||(E[11]=xt(" 插件描述: ")),E[12]||(E[12]=he("br",null,null,-1)),Me(f,{type:"textarea",modelValue:m.value.description,"onUpdate:modelValue":E[3]||(E[3]=L=>m.value.description=L)},null,8,["modelValue"]),E[13]||(E[13]=he("h2",null,"数据库",-1)),Me(v,{onClick:d},{default:je(()=>E[6]||(E[6]=[xt("新建数据表")])),_:1}),Me(S,{modelValue:m.value.tables,"onUpdate:modelValue":E[4]||(E[4]=L=>m.value.tables=L)},{default:je(()=>[Me(T,{prop:"table",label:"数据表名",width:"180"}),Me(T,{prop:"columns",label:"字段",width:"180"}),Me(T,{prop:"operation",label:"操作"})]),_:1},8,["modelValue"]),E[14]||(E[14]=he("h2",null,"指令",-1)),he("div",null,[(oe(true),be(Pt,null,di(b.value,(L,I)=>(oe(),be("div",null,[he("h3",{class:tt(_.value.includes(L)?"":"disabled-title")},[xt(Bt(L)+" ",1),m.value.commands[L]?(oe(),Je(v,{key:0,onClick:k=>delete m.value.commands[L]},{default:je(()=>E[7]||(E[7]=[xt("删除")])),_:2},1032,["onClick"])):qe("v-if",true)],2),m.value.commands[L]?(oe(),be(Pt,{key:1},[Me(f,{type:"textarea",modelValue:m.value.commands[L].description,"onUpdate:modelValue":k=>m.value.commands[L].description=k},null,8,["modelValue","onUpdate:modelValue"]),E[9]||(E[9]=xt(" 最低权限等级")),Me(R,{modelValue:m.value.commands[L].authority,"onUpdate:modelValue":k=>m.value.commands[L].authority=k},null,8,["modelValue","onUpdate:modelValue"])],64)):(oe(),Je(y,{key:0,onClick:k=>m.value.commands[L]={authority:0}},{default:je(()=>E[8]||(E[8]=[xt("设置指令信息")])),_:2},1032,["onClick"]))]))),256))]),E[15]||(E[15]=he("h2",null,"存储空间",-1)),E[16]||(E[16]=xt(" 暂未支持 ")),E[17]||(E[17]=he("h2",null,"其他信息",-1)),E[18]||(E[18]=xt(" SHA256校验值: ")),Me(f,{"model-value":"96cae35ce8a9b0244178bf28e4966c2ce1b8385723a96a6b838858cdd6ca0a1e"})])]}),_:1})])],64)}}});const bB=sr(vB,[["__scopeId","data-v-7ee2c088"]]);var vg={exports:{}},b$;function TB(){return b$||(b$=1,function(s,n){(function(i,o){s.exports=o()})(ki,function(){var i=i||{Msg:Object.create(null)};return i.Msg.ADD_COMMENT="添加注释",i.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="不能删除变量“%1”，因为它是函数“%2”定义的一部分",i.Msg.CHANGE_VALUE_TITLE="更改值：",i.Msg.CLEAN_UP="整理块",i.Msg.COLLAPSED_WARNINGS_WARNING="已收起的信息块内包含警告。",i.Msg.COLLAPSE_ALL="折叠块",i.Msg.COLLAPSE_BLOCK="折叠块",i.Msg.COLOUR_BLEND_COLOUR1="颜色1",i.Msg.COLOUR_BLEND_COLOUR2="颜色2",i.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",i.Msg.COLOUR_BLEND_RATIO="比例",i.Msg.COLOUR_BLEND_TITLE="混合",i.Msg.COLOUR_BLEND_TOOLTIP="把两种颜色以一个给定的比例(0.0-1.0)进行混合。",i.Msg.COLOUR_PICKER_HELPURL="https://zh.wikipedia.org/wiki/颜色",i.Msg.COLOUR_PICKER_TOOLTIP="从调色板中选择一种颜色。",i.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",i.Msg.COLOUR_RANDOM_TITLE="随机颜色",i.Msg.COLOUR_RANDOM_TOOLTIP="随机选择一种颜色。",i.Msg.COLOUR_RGB_BLUE="蓝色",i.Msg.COLOUR_RGB_GREEN="绿色",i.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",i.Msg.COLOUR_RGB_RED="红色",i.Msg.COLOUR_RGB_TITLE="颜色",i.Msg.COLOUR_RGB_TOOLTIP="通过指定红色、绿色和蓝色的量创建一种颜色。所有的值必须在0和100之间。",i.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="跳出循环",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="继续下一轮循环",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="跳出包含它的循环。",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="跳过本轮循环的剩余部分，并继进行续下一轮循环。",i.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="警告：这个块只能在循环内使用。",i.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",i.Msg.CONTROLS_FOREACH_TITLE="遍历列表 %2 里的每一项 %1",i.Msg.CONTROLS_FOREACH_TOOLTIP="遍历列表中的每一项，将变量“%1”设为所选项，并执行一些语句。",i.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",i.Msg.CONTROLS_FOR_TITLE="变量 %1 从 %2 数到 %3 每次增加 %4",i.Msg.CONTROLS_FOR_TOOLTIP="用变量%1记录从开始数值到终止数值之间的数值，数值按指定间隔增加，并执行指定的块。",i.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="在这个if语句块中增加一个条件。",i.Msg.CONTROLS_IF_ELSE_TOOLTIP="在这个if语句块中添加一个最终的，包括所有其余情况的条件。",i.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",i.Msg.CONTROLS_IF_IF_TOOLTIP="增加、删除或重新排列各节来重新配置这个if语句块。",i.Msg.CONTROLS_IF_MSG_ELSE="否则",i.Msg.CONTROLS_IF_MSG_ELSEIF="否则如果",i.Msg.CONTROLS_IF_MSG_IF="如果",i.Msg.CONTROLS_IF_TOOLTIP_1="如果值为真，执行一些语句。",i.Msg.CONTROLS_IF_TOOLTIP_2="如果值为真，则执行第一块语句。否则，则执行第二块语句。",i.Msg.CONTROLS_IF_TOOLTIP_3="如果第一个值为真，则执行第一块的语句。否则，如果第二个值为真，则执行第二块的语句。",i.Msg.CONTROLS_IF_TOOLTIP_4="如果第一个值为真，则执行第一块对语句。否则，如果第二个值为真，则执行语句的第二块。如果没有值为真，则执行最后一块的语句。",i.Msg.CONTROLS_REPEAT_HELPURL="https://zh.wikipedia.org/wiki/For循环",i.Msg.CONTROLS_REPEAT_INPUT_DO="执行",i.Msg.CONTROLS_REPEAT_TITLE="重复 %1 次",i.Msg.CONTROLS_REPEAT_TOOLTIP="多次执行一些语句。",i.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="重复直到条件满足",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="当条件满足时重复",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="只要值为假，就一直循环执行一些语句。",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="只要值为真，就一直循环执行一些语句。",i.Msg.DELETE_ALL_BLOCKS="删除所有 %1 个块吗？",i.Msg.DELETE_BLOCK="删除块",i.Msg.DELETE_VARIABLE="删除变量“%1”",i.Msg.DELETE_VARIABLE_CONFIRMATION="要删除对变量“%2”的%1个引用吗？",i.Msg.DELETE_X_BLOCKS="删除 %1 个块",i.Msg.DIALOG_CANCEL="取消",i.Msg.DIALOG_OK="确认",i.Msg.DISABLE_BLOCK="禁用块",i.Msg.DUPLICATE_BLOCK="复制",i.Msg.DUPLICATE_COMMENT="复制注释",i.Msg.ENABLE_BLOCK="启用块",i.Msg.EXPAND_ALL="展开块",i.Msg.EXPAND_BLOCK="展开块",i.Msg.EXTERNAL_INPUTS="外部输入",i.Msg.HELP="帮助",i.Msg.INLINE_INPUTS="单行输入",i.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",i.Msg.LISTS_CREATE_EMPTY_TITLE="创建空列表",i.Msg.LISTS_CREATE_EMPTY_TOOLTIP="返回一个列表，长度为 0，不包含任何数据记录",i.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="列表",i.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="增加、删除或重新排列各部分以此重新配置这个列表块。",i.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_CREATE_WITH_INPUT_WITH="创建列表，内容：",i.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="将一个项添加到列表中。",i.Msg.LISTS_CREATE_WITH_TOOLTIP="建立一个具有任意数量项目的列表。",i.Msg.LISTS_GET_INDEX_FIRST="第一项",i.Msg.LISTS_GET_INDEX_FROM_END="倒数第#项",i.Msg.LISTS_GET_INDEX_FROM_START="#",i.Msg.LISTS_GET_INDEX_GET="取得",i.Msg.LISTS_GET_INDEX_GET_REMOVE="取得并移除",i.Msg.LISTS_GET_INDEX_LAST="最后一项",i.Msg.LISTS_GET_INDEX_RANDOM="随机的一项",i.Msg.LISTS_GET_INDEX_REMOVE="移除",i.Msg.LISTS_GET_INDEX_TAIL="",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="返回列表中的第一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="返回在列表中的指定位置的项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="返回列表中的最后一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="返回列表中的随机一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="移除并返回列表中的第一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="移除并返回列表中的指定位置的项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="移除并返回列表中的最后一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="移除并返回列表中的随机一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="移除列表中的第一项",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="移除在列表中的指定位置的项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="移除列表中的最后一项",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="删除列表中的随机一项。",i.Msg.LISTS_GET_SUBLIST_END_FROM_END="到倒数第#项",i.Msg.LISTS_GET_SUBLIST_END_FROM_START="到第#项",i.Msg.LISTS_GET_SUBLIST_END_LAST="到最后一项",i.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",i.Msg.LISTS_GET_SUBLIST_START_FIRST="获取子列表，从第一项",i.Msg.LISTS_GET_SUBLIST_START_FROM_END="获取子列表，从倒数第#项",i.Msg.LISTS_GET_SUBLIST_START_FROM_START="获取子列表，从第#项",i.Msg.LISTS_GET_SUBLIST_TAIL="",i.Msg.LISTS_GET_SUBLIST_TOOLTIP="复制列表中指定的部分。",i.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1是最后一项。",i.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1是第一项。",i.Msg.LISTS_INDEX_OF_FIRST="寻找第一次出现的项",i.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",i.Msg.LISTS_INDEX_OF_LAST="寻找最后一次出现的项",i.Msg.LISTS_INDEX_OF_TOOLTIP="返回在列表中的第一/最后一个匹配项的索引值。如果找不到项目则返回%1。",i.Msg.LISTS_INLIST="在列表中",i.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",i.Msg.LISTS_ISEMPTY_TITLE="%1是空的",i.Msg.LISTS_ISEMPTY_TOOLTIP="如果改列表为空，则返回真。",i.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",i.Msg.LISTS_LENGTH_TITLE="%1的长度",i.Msg.LISTS_LENGTH_TOOLTIP="返回列表的长度。",i.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_REPEAT_TITLE="建立列表使用项 %1 重复 %2 次",i.Msg.LISTS_REPEAT_TOOLTIP="建立包含指定重复次数的值的列表。",i.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",i.Msg.LISTS_REVERSE_MESSAGE0="倒转%1",i.Msg.LISTS_REVERSE_TOOLTIP="倒转一个列表，返回副本。",i.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",i.Msg.LISTS_SET_INDEX_INPUT_TO="值为",i.Msg.LISTS_SET_INDEX_INSERT="插入在",i.Msg.LISTS_SET_INDEX_SET="设置",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="在列表的起始处添加该项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="在列表中指定位置插入项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="在列表的末尾处添加该项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="在列表的随机位置插入该项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="设置列表中的第一项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="设置在列表中指定位置的项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="设置列表中的最后一项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="设置列表中的随机一项。",i.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",i.Msg.LISTS_SORT_ORDER_ASCENDING="升序",i.Msg.LISTS_SORT_ORDER_DESCENDING="降序",i.Msg.LISTS_SORT_TITLE="排序%1 %2 %3",i.Msg.LISTS_SORT_TOOLTIP="排序一个列表，返回副本。",i.Msg.LISTS_SORT_TYPE_IGNORECASE="按字母（忽略大小写）",i.Msg.LISTS_SORT_TYPE_NUMERIC="按数字",i.Msg.LISTS_SORT_TYPE_TEXT="按字母",i.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",i.Msg.LISTS_SPLIT_LIST_FROM_TEXT="从文本制作列表",i.Msg.LISTS_SPLIT_TEXT_FROM_LIST="将列表合并为文本",i.Msg.LISTS_SPLIT_TOOLTIP_JOIN="加入文本列表至一个文本，由分隔符分隔。",i.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="将文本按指定的分隔符拆分为文本组成的列表。",i.Msg.LISTS_SPLIT_WITH_DELIMITER="分隔符：",i.Msg.LOGIC_BOOLEAN_FALSE="假",i.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",i.Msg.LOGIC_BOOLEAN_TOOLTIP="返回真或假。",i.Msg.LOGIC_BOOLEAN_TRUE="真",i.Msg.LOGIC_COMPARE_HELPURL="https://zh.wikipedia.org/wiki/不等",i.Msg.LOGIC_COMPARE_TOOLTIP_EQ="如果两个输入结果相等，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_GT="如果第一个输入结果比第二个大，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_GTE="如果第一个输入结果大于或等于第二个输入结果，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_LT="如果第一个输入结果比第二个小，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_LTE="如果第一个输入结果小于或等于第二个输入结果，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="如果两个输入结果不相等，则返回真。",i.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",i.Msg.LOGIC_NEGATE_TITLE="非%1",i.Msg.LOGIC_NEGATE_TOOLTIP="如果输入结果为假，则返回真；如果输入结果为真，则返回假。",i.Msg.LOGIC_NULL="空",i.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",i.Msg.LOGIC_NULL_TOOLTIP="返回空值。",i.Msg.LOGIC_OPERATION_AND="并且",i.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",i.Msg.LOGIC_OPERATION_OR="或",i.Msg.LOGIC_OPERATION_TOOLTIP_AND="如果两个输入结果都为真，则返回真。",i.Msg.LOGIC_OPERATION_TOOLTIP_OR="如果至少有一个输入结果为真，则返回真。",i.Msg.LOGIC_TERNARY_CONDITION="断言",i.Msg.LOGIC_TERNARY_HELPURL="https://zh.wikipedia.org/wiki/条件运算符",i.Msg.LOGIC_TERNARY_IF_FALSE="如果为假",i.Msg.LOGIC_TERNARY_IF_TRUE="如果为真",i.Msg.LOGIC_TERNARY_TOOLTIP="检查“断言”里的条件语句。如果条件为真，则返回“如果为真”的值，否则，则返回“如果为假”的值。",i.Msg.MATH_ADDITION_SYMBOL="+",i.Msg.MATH_ARITHMETIC_HELPURL="https://zh.wikipedia.org/wiki/算术",i.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="返回两个数值的和。",i.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="返回两个数值的商。",i.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="返回两个数值的差。",i.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="返回两个数值的乘积。",i.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="返回以第一个数值为底数，以第二个数值为幂的结果。",i.Msg.MATH_ATAN2_HELPURL="https://zh.wikipedia.org/wiki/反正切2",i.Msg.MATH_ATAN2_TITLE="点(x:%1,y:%2)的方位角",i.Msg.MATH_ATAN2_TOOLTIP="返回点（X，Y）的反正切值，范围为-180到180度。",i.Msg.MATH_CHANGE_HELPURL="https://zh.wikipedia.org/wiki/加法",i.Msg.MATH_CHANGE_TITLE="将 %1 增加 %2",i.Msg.MATH_CHANGE_TOOLTIP="为变量“%1”增加一个数值。",i.Msg.MATH_CONSTANT_HELPURL="https://zh.wikipedia.org/wiki/数学常数",i.Msg.MATH_CONSTANT_TOOLTIP="返回一个常见常量：π (3.141…)、e (2.718…)、φ (1.618…)、根号2 (1.414…)、根号二分之一 (0.707…)或∞ (无穷大)。",i.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",i.Msg.MATH_CONSTRAIN_TITLE="将 %1 限制在 最低 %2 到最高 %3 之间",i.Msg.MATH_CONSTRAIN_TOOLTIP="将一个数值限制在两个指定的数值范围（含边界）之间。",i.Msg.MATH_DIVISION_SYMBOL="÷",i.Msg.MATH_IS_DIVISIBLE_BY="可被整除",i.Msg.MATH_IS_EVEN="是偶数",i.Msg.MATH_IS_NEGATIVE="是负数",i.Msg.MATH_IS_ODD="是奇数",i.Msg.MATH_IS_POSITIVE="是正数",i.Msg.MATH_IS_PRIME="是质数",i.Msg.MATH_IS_TOOLTIP="检查一个数值是否是偶数、奇数、质数、自然数、正数、负数或者是否能被某数整除。返回真或假。",i.Msg.MATH_IS_WHOLE="是整数",i.Msg.MATH_MODULO_HELPURL="https://zh.wikipedia.org/wiki/模除",i.Msg.MATH_MODULO_TITLE="取 %1 ÷ %2 的余数",i.Msg.MATH_MODULO_TOOLTIP="返回这两个数字相除后的余数。",i.Msg.MATH_MULTIPLICATION_SYMBOL="×",i.Msg.MATH_NUMBER_HELPURL="https://zh.wikipedia.org/wiki/数",i.Msg.MATH_NUMBER_TOOLTIP="一个数值。",i.Msg.MATH_ONLIST_HELPURL="",i.Msg.MATH_ONLIST_OPERATOR_AVERAGE="列表平均值",i.Msg.MATH_ONLIST_OPERATOR_MAX="列表最大值",i.Msg.MATH_ONLIST_OPERATOR_MEDIAN="列表中位数",i.Msg.MATH_ONLIST_OPERATOR_MIN="列表最小值",i.Msg.MATH_ONLIST_OPERATOR_MODE="列表中的众数",i.Msg.MATH_ONLIST_OPERATOR_RANDOM="列表中的随机一项",i.Msg.MATH_ONLIST_OPERATOR_STD_DEV="列表的标准差",i.Msg.MATH_ONLIST_OPERATOR_SUM="列表中数值的和",i.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="返回列表中的数值的平均值。",i.Msg.MATH_ONLIST_TOOLTIP_MAX="返回列表中最大值。",i.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="返回列表中数值的中位数。",i.Msg.MATH_ONLIST_TOOLTIP_MIN="返回列表中最小值。",i.Msg.MATH_ONLIST_TOOLTIP_MODE="返回列表中的出现次数最多的项的列表。",i.Msg.MATH_ONLIST_TOOLTIP_RANDOM="从列表中返回一个随机的元素。",i.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="返回列表的标准差。",i.Msg.MATH_ONLIST_TOOLTIP_SUM="返回列表中的所有数值的和。",i.Msg.MATH_POWER_SYMBOL="^",i.Msg.MATH_RANDOM_FLOAT_HELPURL="https://zh.wikipedia.org/wiki/随机数生成器",i.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="随机小数",i.Msg.MATH_RANDOM_FLOAT_TOOLTIP="返回一个从0.0（含）到1.0（不含）之间的随机数。",i.Msg.MATH_RANDOM_INT_HELPURL="https://zh.wikipedia.org/wiki/随机数生成器",i.Msg.MATH_RANDOM_INT_TITLE="从 %1 到 %2 范围内的随机整数",i.Msg.MATH_RANDOM_INT_TOOLTIP="返回一个限制在两个指定数值的范围（含边界）之间的随机整数。",i.Msg.MATH_ROUND_HELPURL="https://zh.wikipedia.org/wiki/数值修约",i.Msg.MATH_ROUND_OPERATOR_ROUND="四舍五入",i.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="向下舍入",i.Msg.MATH_ROUND_OPERATOR_ROUNDUP="向上舍入",i.Msg.MATH_ROUND_TOOLTIP="数字向上或向下舍入。",i.Msg.MATH_SINGLE_HELPURL="https://zh.wikipedia.org/wiki/平方根",i.Msg.MATH_SINGLE_OP_ABSOLUTE="绝对值",i.Msg.MATH_SINGLE_OP_ROOT="平方根",i.Msg.MATH_SINGLE_TOOLTIP_ABS="返回一个数值的绝对值。",i.Msg.MATH_SINGLE_TOOLTIP_EXP="返回e的n次幂。",i.Msg.MATH_SINGLE_TOOLTIP_LN="返回一个数值的自然对数。",i.Msg.MATH_SINGLE_TOOLTIP_LOG10="返回一个数值的以10为底的对数。",i.Msg.MATH_SINGLE_TOOLTIP_NEG="返回一个数值的相反数。",i.Msg.MATH_SINGLE_TOOLTIP_POW10="返回10的n次幂。",i.Msg.MATH_SINGLE_TOOLTIP_ROOT="返回一个数的平方根。",i.Msg.MATH_SUBTRACTION_SYMBOL="-",i.Msg.MATH_TRIG_ACOS="acos",i.Msg.MATH_TRIG_ASIN="asin",i.Msg.MATH_TRIG_ATAN="atan",i.Msg.MATH_TRIG_COS="cos",i.Msg.MATH_TRIG_HELPURL="https://zh.wikipedia.org/wiki/三角函数",i.Msg.MATH_TRIG_SIN="sin",i.Msg.MATH_TRIG_TAN="tan",i.Msg.MATH_TRIG_TOOLTIP_ACOS="返回一个数值的反余弦值。",i.Msg.MATH_TRIG_TOOLTIP_ASIN="返回一个数值的反正弦值。",i.Msg.MATH_TRIG_TOOLTIP_ATAN="返回一个数值的反正切值。",i.Msg.MATH_TRIG_TOOLTIP_COS="返回指定角度的余弦值（非弧度）。",i.Msg.MATH_TRIG_TOOLTIP_SIN="返回指定角度的正弦值（非弧度）。",i.Msg.MATH_TRIG_TOOLTIP_TAN="返回指定角度的正切值（非弧度）。",i.Msg.NEW_COLOUR_VARIABLE="创建颜色变量...",i.Msg.NEW_NUMBER_VARIABLE="创建数字变量...",i.Msg.NEW_STRING_VARIABLE="创建字符串变量...",i.Msg.NEW_VARIABLE="创建变量...",i.Msg.NEW_VARIABLE_TITLE="新变量的名称：",i.Msg.NEW_VARIABLE_TYPE_TITLE="新变量的类型：",i.Msg.ORDINAL_NUMBER_SUFFIX="",i.Msg.PROCEDURES_ALLOW_STATEMENTS="允许声明",i.Msg.PROCEDURES_BEFORE_PARAMS="与：",i.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://zh.wikipedia.org/wiki/子程序",i.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="运行用户定义的函数“%1”。",i.Msg.PROCEDURES_CALLRETURN_HELPURL="https://zh.wikipedia.org/wiki/子程序",i.Msg.PROCEDURES_CALLRETURN_TOOLTIP="运行用户定义的函数“%1”，并使用它的输出值。",i.Msg.PROCEDURES_CALL_BEFORE_PARAMS="与：",i.Msg.PROCEDURES_CREATE_DO="创建“%1”",i.Msg.PROCEDURES_DEFNORETURN_COMMENT="描述该功能...",i.Msg.PROCEDURES_DEFNORETURN_DO="",i.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://zh.wikipedia.org/wiki/子程序",i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="做点什么",i.Msg.PROCEDURES_DEFNORETURN_TITLE="至",i.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="创建一个不带输出值的函数。",i.Msg.PROCEDURES_DEFRETURN_HELPURL="https://zh.wikipedia.org/wiki/子程序",i.Msg.PROCEDURES_DEFRETURN_RETURN="返回",i.Msg.PROCEDURES_DEFRETURN_TOOLTIP="创建一个有输出值的函数。",i.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="警告：此函数具有重复参数。",i.Msg.PROCEDURES_HIGHLIGHT_DEF="突出显示函数定义",i.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",i.Msg.PROCEDURES_IFRETURN_TOOLTIP="如果值为真，则返回第二个值。",i.Msg.PROCEDURES_IFRETURN_WARNING="警告：这个块只能在函数内部使用。",i.Msg.PROCEDURES_MUTATORARG_TITLE="输入名称：",i.Msg.PROCEDURES_MUTATORARG_TOOLTIP="添加函数输入。",i.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="输入",i.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="添加、移除或重新排此函数的输入。",i.Msg.REDO="重做",i.Msg.REMOVE_COMMENT="删除注释",i.Msg.RENAME_VARIABLE="重命名变量...",i.Msg.RENAME_VARIABLE_TITLE="将所有“%1”变量重命名为:",i.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_APPEND_TITLE="在%1之后加上文本%2",i.Msg.TEXT_APPEND_TOOLTIP="将一些文本追加到变量“%1”里。",i.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",i.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="转为小写",i.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="转为首字母大写",i.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="转为大写",i.Msg.TEXT_CHANGECASE_TOOLTIP="用不同的大小写模式复制并返回这段文字。",i.Msg.TEXT_CHARAT_FIRST="获取第一个字符",i.Msg.TEXT_CHARAT_FROM_END="获取倒数第#个字符",i.Msg.TEXT_CHARAT_FROM_START="获取第#个字符",i.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",i.Msg.TEXT_CHARAT_LAST="获取最后一个字符",i.Msg.TEXT_CHARAT_RANDOM="获取随机一个字符",i.Msg.TEXT_CHARAT_TAIL="",i.Msg.TEXT_CHARAT_TITLE="在文本%1 里 %2",i.Msg.TEXT_CHARAT_TOOLTIP="返回位于指定位置的字符。",i.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",i.Msg.TEXT_COUNT_MESSAGE0="计算%1在%2里出现的次数",i.Msg.TEXT_COUNT_TOOLTIP="计算在一段文本中，某个部分文本重复出现了多少次。",i.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="将一个项添加到文本中。",i.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="拼接",i.Msg.TEXT_CREATE_JOIN_TOOLTIP="添加、移除或重新排列各节来重新配置这个文本块。",i.Msg.TEXT_GET_SUBSTRING_END_FROM_END="到倒数第#个字符",i.Msg.TEXT_GET_SUBSTRING_END_FROM_START="到第#个字符",i.Msg.TEXT_GET_SUBSTRING_END_LAST="到最后一个字符",i.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",i.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="从文本",i.Msg.TEXT_GET_SUBSTRING_START_FIRST="获取子串，从第一个字符",i.Msg.TEXT_GET_SUBSTRING_START_FROM_END="获取子串，从倒数第#个字符",i.Msg.TEXT_GET_SUBSTRING_START_FROM_START="获取子串，从第#个字符",i.Msg.TEXT_GET_SUBSTRING_TAIL="",i.Msg.TEXT_GET_SUBSTRING_TOOLTIP="返回文本中指定的一部分。",i.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",i.Msg.TEXT_INDEXOF_OPERATOR_FIRST="寻找第一次出现的文本",i.Msg.TEXT_INDEXOF_OPERATOR_LAST="寻找最后一次出现的文本",i.Msg.TEXT_INDEXOF_TITLE="在文本 %1 里 %2  %3",i.Msg.TEXT_INDEXOF_TOOLTIP="返回第一个文本段在第二个文本段中的第一/最后一个匹配项的起始位置。如果未找到，则返回%1。",i.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",i.Msg.TEXT_ISEMPTY_TITLE="%1是空的",i.Msg.TEXT_ISEMPTY_TOOLTIP="如果给定的文本为空，则返回真。",i.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",i.Msg.TEXT_JOIN_TITLE_CREATEWITH="创建文本，内容：",i.Msg.TEXT_JOIN_TOOLTIP="通过串起任意数量的项以建立一段文本。",i.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_LENGTH_TITLE="%1的长度",i.Msg.TEXT_LENGTH_TOOLTIP="返回给定文本的字母数（包括空格）。",i.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",i.Msg.TEXT_PRINT_TITLE="输出%1",i.Msg.TEXT_PRINT_TOOLTIP="输出指定的文字、数字或其他值。",i.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",i.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="要求用户输入数字。",i.Msg.TEXT_PROMPT_TOOLTIP_TEXT="要求用户输入一些文本。",i.Msg.TEXT_PROMPT_TYPE_NUMBER="要求输入数字，并显示提示消息",i.Msg.TEXT_PROMPT_TYPE_TEXT="要求输入文本，并显示提示消息",i.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",i.Msg.TEXT_REPLACE_MESSAGE0="把%3中的%1替换为%2",i.Msg.TEXT_REPLACE_TOOLTIP="在一段文本中，将出现过的某部分文本都替换掉。",i.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",i.Msg.TEXT_REVERSE_MESSAGE0="倒转文本%1",i.Msg.TEXT_REVERSE_TOOLTIP="将文本中各个字符的顺序倒转。",i.Msg.TEXT_TEXT_HELPURL="https://zh.wikipedia.org/wiki/字符串",i.Msg.TEXT_TEXT_TOOLTIP="一个字、词语或一行文本。",i.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",i.Msg.TEXT_TRIM_OPERATOR_BOTH="消除其两侧的空白",i.Msg.TEXT_TRIM_OPERATOR_LEFT="消除其左侧的空白",i.Msg.TEXT_TRIM_OPERATOR_RIGHT="消除其右侧的空白",i.Msg.TEXT_TRIM_TOOLTIP="从某一端或同时从两端删除多余的空白，并返回这段文字的一个副本。",i.Msg.TODAY="今天",i.Msg.UNDO="撤销",i.Msg.UNNAMED_KEY="未命名",i.Msg.VARIABLES_DEFAULT_NAME="项目",i.Msg.VARIABLES_GET_CREATE_SET="创建“设定%1”",i.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",i.Msg.VARIABLES_GET_TOOLTIP="返回此变量的值。",i.Msg.VARIABLES_SET="赋值 %1 为 %2",i.Msg.VARIABLES_SET_CREATE_GET="创建“获得%1”",i.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",i.Msg.VARIABLES_SET_TOOLTIP="设置此变量，以使它和输入值相等。",i.Msg.VARIABLE_ALREADY_EXISTS="名字叫“%1”的变量已经存在了。",i.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="名字叫“%1”的变量已经有了另一个类型：“%2”。",i.Msg.WORKSPACE_ARIA_LABEL="Blockly工作区",i.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="说点什么...",i.Msg.CONTROLS_FOREACH_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_FOR_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=i.Msg.CONTROLS_IF_MSG_ELSEIF,i.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=i.Msg.CONTROLS_IF_MSG_ELSE,i.Msg.CONTROLS_IF_IF_TITLE_IF=i.Msg.CONTROLS_IF_MSG_IF,i.Msg.CONTROLS_IF_MSG_THEN=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.LISTS_CREATE_WITH_ITEM_TITLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.LISTS_GET_INDEX_HELPURL=i.Msg.LISTS_INDEX_OF_HELPURL,i.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.MATH_CHANGE_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.PROCEDURES_DEFRETURN_COMMENT=i.Msg.PROCEDURES_DEFNORETURN_COMMENT,i.Msg.PROCEDURES_DEFRETURN_DO=i.Msg.PROCEDURES_DEFNORETURN_DO,i.Msg.PROCEDURES_DEFRETURN_PROCEDURE=i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,i.Msg.PROCEDURES_DEFRETURN_TITLE=i.Msg.PROCEDURES_DEFNORETURN_TITLE,i.Msg.TEXT_APPEND_VARIABLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.MATH_HUE="230",i.Msg.LOOPS_HUE="120",i.Msg.LISTS_HUE="260",i.Msg.LOGIC_HUE="210",i.Msg.VARIABLES_HUE="330",i.Msg.TEXTS_HUE="160",i.Msg.PROCEDURES_HUE="290",i.Msg.COLOUR_HUE="20",i.Msg.VARIABLES_DYNAMIC_HUE="310",i.Msg})}(vg)),vg.exports}var oR=TB();const SB=em(oR),$B=mk({__proto__:null,default:SB},[oR]),yB=`
  .blocklyFieldParameter>rect {
    fill: rgb(222, 143, 108);
    fill-opacity: 1.0;
    stroke-width: 2;
    stroke: rgb(231, 175, 150);
  }
  .blocklyFieldParameter>text {
    stroke-width: 1;
    fill: #000;
  }
  .blocklyFieldParameter:hover>rect {
    stroke-width: 2;
    stroke: rgb(231,175,150);
    fill: rgb(231,175,150);
    fill-opacity: 1.0;
  }
  /*
   * [lyn, 10/08/13] Control flydown with the getter/setter blocks.
   */
  .blocklyFieldParameterFlydown {
    fill: rgb(231,175,150);
    fill-opacity: 0.8;
  }
  /*
   * [lyn, 10/08/13] Control parameter fields with flydown procedure
   * caller block.
   */
  .blocklyFieldProcedure>rect {
    fill: rgb(215,203,218);
    fill-opacity: 1.0;
    stroke-width: 0;
    stroke: #000;
  }
  .blocklyFieldProcedure>text {
    fill: #000;
  }
  .blocklyFieldProcedure:hover>rect {
    stroke-width: 2;
    stroke: #fff;
    fill: rgb(215,203,218);
    fill-opacity: 1.0;
  }
  /*
   * [lyn, 10/08/13] Control flydown with the procedure caller block.
   */
  .blocklyFieldProcedureFlydown {
    fill: rgb(215,203,218);
    fill-opacity: 0.8;
  }
`;function RB(){w.Css.register(yB)}/**
 * @license
 * Copyright 2021 Mark Friedman
 * SPDX-License-Identifier: Apache-2.0
 */w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT="initialize global";w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME="name";w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO="to";w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_COLLAPSED_TEXT="global";w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP="Creates a global variable and gives it the value of the attached blocks.";w.Msg.LANG_VARIABLES_GLOBAL_PREFIX="global";w.Msg.LANG_VARIABLES_GET_TITLE_GET="get";w.Msg.LANG_VARIABLES_GET_COLLAPSED_TEXT="get";w.Msg.LANG_VARIABLES_GET_TOOLTIP="Returns the value of this variable.";w.Msg.LANG_VARIABLES_SET_TITLE_SET="set";w.Msg.LANG_VARIABLES_SET_TITLE_TO="to";w.Msg.LANG_VARIABLES_SET_COLLAPSED_TEXT="set";w.Msg.LANG_VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.";w.Msg.LANG_VARIABLES_VARIABLE=" variable";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT="initialize local";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME="name";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO="to";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO="in";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_COLLAPSED_TEXT="local";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP="Allows you to create variables that are only accessible in the do part of this block.";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TRANSLATED_NAME="initialize local in do";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN="in";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_COLLAPSED_TEXT="local";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP="Allows you to create variables that are only accessible in the return part of this block.";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TRANSLATED_NAME="initialize local in return";w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES="local names";w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP="";w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME="name";w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE="x";w.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE="to";w.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE="procedure";w.Msg.LANG_PROCEDURES_DEFNORETURN_DO="do";w.Msg.LANG_PROCEDURES_DEFNORETURN_COLLAPSED_PREFIX="to ";w.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP="A procedure that does not return a value.";w.Msg.LANG_PROCEDURES_DOTHENRETURN_THEN_RETURN="result";w.Msg.LANG_PROCEDURES_DOTHENRETURN_DO="do";w.Msg.LANG_PROCEDURES_DOTHENRETURN_RETURN="result";w.Msg.LANG_PROCEDURES_DOTHENRETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";w.Msg.LANG_PROCEDURES_DOTHENRETURN_COLLAPSED_TEXT="do/result";w.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE="to";w.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE="procedure";w.Msg.LANG_PROCEDURES_DEFRETURN_RETURN="result";w.Msg.LANG_PROCEDURES_DEFRETURN_COLLAPSED_PREFIX="to ";w.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP="A procedure returning a result value.";w.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING=`Warning:
This procedure has
duplicate inputs.`;w.Msg.LANG_PROCEDURES_CALLNORETURN_CALL="call ";w.Msg.LANG_PROCEDURES_CALLNORETURN_PROCEDURE="procedure";w.Msg.LANG_PROCEDURES_CALLNORETURN_COLLAPSED_PREFIX="call ";w.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP="Call a procedure with no return value.";w.Msg.LANG_PROCEDURES_CALLNORETURN_TRANSLATED_NAME="call no return";w.Msg.LANG_PROCEDURES_CALLRETURN_COLLAPSED_PREFIX="call ";w.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP="Call a procedure with a return value.";w.Msg.LANG_PROCEDURES_CALLRETURN_TRANSLATED_NAME="call return";w.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE="inputs";w.Msg.LANG_PROCEDURES_MUTATORARG_TITLE="input:";w.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF="Highlight Procedure";w.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP="";w.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP="";w.Msg.LANG_CONTROLS_FOR_INPUT_WITH="count with";w.Msg.LANG_CONTROLS_FOR_INPUT_VAR="x";w.Msg.LANG_CONTROLS_FOR_INPUT_FROM="from";w.Msg.LANG_CONTROLS_FOR_INPUT_TO="to";w.Msg.LANG_CONTROLS_FOR_INPUT_DO="do";w.Msg.LANG_CONTROLS_FOR_TOOLTIP=`Count from a start number to an end number.
For each count, set the current count number to
variable '%1', and then do some statements.`;w.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM="for each";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR="number";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_START="from";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_END="to";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP="by";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO="do";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_TEXT="for number in range";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_PREFIX="for";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_SUFFIX=" in range";w.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP="Runs the blocks in the 'do' section for each numeric value in the range from start to end, stepping the value each time.  Use the given variable name to refer to the current value.";w.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM="for each";w.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR="item";w.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST="in list";w.Msg.LANG_CONTROLS_FOREACH_INPUT_DO="do";w.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_TEXT="for item in list";w.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_PREFIX="for ";w.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_SUFFIX=" in list";w.Msg.LANG_CONTROLS_FOREACH_TOOLTIP="Runs the blocks in the 'do'  section for each item in the list.  Use the given variable name to refer to the current list item.";w.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT="for each %1 with %2 in dictionary %3";w.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_DO="do";w.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_KEY="key";w.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_VALUE="value";w.Msg.LANG_CONTROLS_FOREACH_DICT_TITLE="for each in dictionary";w.Msg.LANG_CONTROLS_FOREACH_DICT_TOOLTIP="Runs the blocks in the 'do' section for each key-value entry in the dictionary. Use the given variable names to refer to the key/value of the current dictionary item.";w.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN="Select a valid item in the drop down.";w.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION="This block cannot be in a definition";w.Msg.HORIZONTAL_PARAMETERS="Arrange Parameters Horizontally";w.Msg.VERTICAL_PARAMETERS="Arrange Parameters Vertically";w.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO="do";w.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN="result";w.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";w.Msg.LANG_CONTROLS_DO_THEN_RETURN_COLLAPSED_TEXT="do/result";w.Msg.LANG_CONTROLS_DO_THEN_RETURN_TITLE="do result";const T$=function(s,n){return!s.sourceBlock_.rendered||!n.sourceBlock_.rendered?(n.check_&&!n.check_.includes("InstantInTime")&&n.sourceBlock_.badBlock(),true):!n.check_||n.check_.includes("InstantInTime")},IB={number:{input:["Number"],output:["Number","String","Key"]},text:{input:["String"],output:["Number","String","Key"]},boolean:{input:["Boolean"],output:["Boolean","String"]},list:{input:["Array"],output:["Array","String"]},component:{input:["COMPONENT"],output:["COMPONENT","Key"]},InstantInTime:{input:["InstantInTime",T$],output:["InstantInTime",T$]},any:{input:null,output:null},dictionary:{input:["Dictionary"],output:["Dictionary","String","Array"]},pair:{input:["Pair"],output:["Pair","String","Array"]},key:{input:["Key"],output:["String","Key"]}},zu="input",ju=function(s,n){const i=IB[s][n];if(i===void 0)throw new Error("Unknown Yail type: "+s+" -- YailTypeToBlocklyType");return i},$h=function(s){return s.children!==void 0?s.children:Array.prototype.filter.call(s.childNodes,function(n){return n.nodeType==w.utils.dom.NodeType.ELEMENT_NODE})},pc=function(s){if(!s.getSvgRoot()||s.readOnly){s.hasWarning&&(s.hasWarning=false),s.hasError&&(s.hasError=false);return}s.errors||(s.errors=[]),s.warnings||(s.warnings=[]);const n=s.errors,i=s.warnings;for(let o=0;o<n.length;o++)if(n[o].func&&n[o].func.call(this,s,n[o])){s.hasError||(s.hasError=true),s.hasWarning&&(s.hasWarning=false);return}s.hasError&&(s.hasError=false);for(let o=0;o<i.length;o++)if(i[o].func&&i[o].func.call(this,s,i[o])){s.hasWarning||(s.hasWarning=true);return}s.warning&&s.setWarningText(null),s.hasWarning&&(s.hasWarning=false)},gc=function(s){if(s.getRootBlock().type==="global_declaration"){const i=w.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION;return s.setWarningText(i),true}else return false},fc=function(s,n){if(s.workspace.isDragging())return false;for(let i=0;i<n.dropDowns.length;i++){const o=s.getField(n.dropDowns[i]),l=o.menuGenerator_(),g=o.getText(),m=o.getValue();let u=false;o.updateMutation&&o.updateMutation();for(let p=0;p<l.length;p++)if(l[p][1]===m&&m!==" "){u=true,l[p][0]!==g&&o.setValue(l[p][0]);break}if(!u){const p=w.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN;return s.setWarningText(p),true}}return false},CB=Object.freeze(Object.defineProperty({__proto__:null,checkDropDownContainsValidValue:fc,checkErrors:pc,checkIsInDefinition:gc},Symbol.toStringTag,{value:"Module"})),OB=false,tc="global",aR="input",lR="local",kB="item",wB="counter",qn=" ",Of=function(s){return function(n){return""+n}},AB=function(s){return w.Msg.LANG_VARIABLES_GLOBAL_PREFIX+qn+s},cR=function(s){return s.indexOf(w.Msg.LANG_VARIABLES_GLOBAL_PREFIX+qn)===0?[w.Msg.LANG_VARIABLES_GLOBAL_PREFIX,s.substring(w.Msg.LANG_VARIABLES_GLOBAL_PREFIX.length+qn.length)]:s.indexOf(tc+qn)===0?[tc,s.substring(6+qn.length)]:["",s]},LB=function(s){return function(n){return""+n}};/**
 * @license
 * @fileoverview Drop-down chooser of variables in the current lexical scope
 *     for App Inventor.
 * @author fturbak@wellesley.com (Lyn Turbak)
 */class Et extends w.FieldDropdown{constructor(n){super(Et.dropdownCreate,Et.dropdownChange),n?this.doValueUpdate_(n):this.doValueUpdate_(w.Variables.generateUniqueName())}setValue(n){if(n&&n!==" "){const i=n.split(" ");i.length==2&&i[0]!=="global"&&(n="global "+i[1])}super.setValue(n)}}Et.prototype.doClassValidation_=function(s){return s};Et.prototype.getBlock=function(){return this.block_};Et.prototype.setBlock=function(s){this.block_=s};Et.getGlobalNames=function(s){if(w.common.getMainWorkspace()&&w.common.getMainWorkspace().getWarningHandler&&w.common.getMainWorkspace().getWarningHandler().cacheGlobalNames)return w.common.getMainWorkspace().getWarningHandler().cachedGlobalNames;const n=[];if(w.common.getMainWorkspace()){let i=[];i=w.common.getMainWorkspace().getTopBlocks();for(let o=0;o<i.length;o++){const l=i[o];l.getGlobalNames&&l!=s&&n.push(...l.getGlobalNames())}}return n};Et.prototype.getNamesInScope=function(){return Et.getNamesInScope(this.block_)};Et.getNamesInScope=function(s){let n=Et.getGlobalNames();n=Ce.sortAndRemoveDuplicates(n),n=n.map(function(o){return[AB(o),"global "+o]});const i=Et.getLexicalNamesInScope(s);return n.concat(i)};Et.getLexicalNamesInScope=function(s){let n=[];const i={};let o,l;function g(m,u,p){let c;i[m]||(i[m]=p),c=Of(i[m])(m),u.push(c)}if(l=s,l&&(o=l.getParent(),o))for(;o;)o.withLexicalVarsAndPrefix&&o.withLexicalVarsAndPrefix(l,(m,u)=>{g(m,n,u)}),l=o,o=o.getParent();return n=Ce.sortAndRemoveDuplicates(n),n.map(function(m){return[m,m]})};Et.dropdownCreate=function(){const s=this.getNamesInScope();return s.length==0?[[" "," "]]:s};Et.prototype.doValueUpdate_=function(s){Object.getPrototypeOf(w.FieldDropdown).prototype.doValueUpdate_.call(this,s);function n(o){return o.startsWith("global ")?o.replace("global ",w.Msg.LANG_VARIABLES_GLOBAL_PREFIX+" "):o}const i=this.getOptions(true,[[n(s),s]]);for(let o=0,l;l=i[o];o++)if(l[1]==this.value_){this.selectedOption_=l;break}this.forceRerender()};Et.prototype.getOptions=function(s,n){Array.isArray(s)&&(n=s);const i=n||[];return this.isOptionListDynamic()?((!this.generatedOptions_||!s)&&(this.generatedOptions_=this.menuGenerator_.call(this).concat(i),NB(this.generatedOptions_)),this.generatedOptions_.concat(i)):this.menuGenerator_};const NB=function(s){if(!Array.isArray(s))throw TypeError("FieldDropdown options must be an array.");if(!s.length)throw TypeError("FieldDropdown options must not be an empty array.");let n=false;for(let i=0;i<s.length;++i){const o=s[i];Array.isArray(o)?typeof o[1]!="string"?(n=true,console.error("Invalid option["+i+"]: Each FieldDropdown option id must be a string. Found "+o[1]+" in: ",o)):o[0]&&typeof o[0]!="string"&&typeof o[0].src!="string"&&(n=true,console.error("Invalid option["+i+"]: Each FieldDropdown option must have a string label or image description. Found"+o[0]+" in: ",o)):(n=true,console.error("Invalid option["+i+"]: Each FieldDropdown option must be an array. Found: ",o))}if(n)throw TypeError("Found invalid FieldDropdown options.")};Et.dropdownChange=function(s){if(s){this.doValueUpdate_(s);const n=this.sourceBlock_.workspace.getTopWorkspace();n.getWarningHandler&&n.getWarningHandler().checkErrors(this.sourceBlock_)}};Et.nameNotIn=function(s,n){const i=Et.prefixSuffix(s),o=i[0],l=i[1];let g=false,m=false;const u=[];for(let p=0;p<n.length;p++){const c=Et.prefixSuffix(n[p]),d=c[0],_=c[1];d===o&&(_===l&&(m=true),_===""?g=true:u.push(_))}if(m)if(g){const p=u.map(function(_,b,$){return parseInt(_,10)});p.sort(function(_,b){return _-b});let c=2,d=0;for(;d<p.length;){if(c<p[d])return o+c;c==p[d]&&c++,d++}return o+c}else return o;else return s};Et.prefixSuffix=function(s){const n=s.match(/^(.*?)(\d+)$/);return n?[n[1],n[2]]:[s,""]};Et.fromJson=function(s){const n=w.utils.replaceMessageReferences(s.name);return new Et(n)};w.fieldRegistry.register("field_lexical_variable",Et);const Ce={};Ce.renameGlobal=function(s){const n=this.value_;s=Ce.makeLegalIdentifier(s),this.sourceBlock_.getField("NAME").doValueUpdate_(s);const i=Et.getGlobalNames(this.sourceBlock_);if(s=Et.nameNotIn(s,i),this.sourceBlock_.rendered&&w.common.getMainWorkspace()){const o=w.common.getMainWorkspace().getAllBlocks();for(let l=0;l<o.length;l++){const g=o[l],m=g.renameLexicalVar;m&&m.call(g,tc+qn+n,tc+qn+s,w.Msg.LANG_VARIABLES_GLOBAL_PREFIX+qn+n,w.Msg.LANG_VARIABLES_GLOBAL_PREFIX+qn+s)}}return s};Ce.renameParam=function(s){const n=this.htmlInput_,i=this.getValue()||n&&n.defaultValue||this.getText();return s=Ce.makeLegalIdentifier(s),Ce.renameParamFromTo(this.sourceBlock_,i,s,false)};Ce.renameParamFromTo=function(s,n,i,o){return s.mustNotRenameCapturables?Ce.renameParamWithoutRenamingCapturables(s,n,i,[]):o?(Ce.renameParamRenamingCapturables(s,n,i),i):Ce.renameParamWithoutRenamingCapturables(s,n,i,[])};Ce.renameParamRenamingCapturables=function(s,n,i){if(i!==n){const o=s.declaredNames?s.declaredNames():[];if(o.indexOf(n)==-1)throw Error("LexicalVariable.renamingCapturables: oldName "+n+" is not in declarations {"+o.join(",")+"}");const l=[];Et.getNamesInScope(s).map(function(m){m[0]==m[1]?l.push(m[0]):l.push(m[0],m[1])});const g=o.concat(l);if(g.indexOf(i)!=-1)throw Error("LexicalVariable.renameParamRenamingCapturables: newName "+i+" is in existing declarations {"+g.join(",")+"}");if(s.renameBound){const m=w.Substitution.simpleSubstitution(n,i),u=new w.Substitution;s.renameBound(m,u)}else throw Error("LexicalVariable.renameParamRenamingCapturables: block "+s.type+" is not a declaration block.")}};Ce.renameFree=function(s,n){s&&(s.renameFree?s.renameFree(n):s.getChildren().map(function(i){Ce.renameFree(i,n)}))};Ce.freeVariables=function(s){let n=[];if(!s)n=new w.NameSet;else if(s.freeVariables)n=s.freeVariables();else{const i=s.getChildren().map(function(o){return Ce.freeVariables(o)});n=w.NameSet.unionAll(i)}return n};Ce.renameParamWithoutRenamingCapturables=function(s,n,i,o){if(n===i)return n;s.declaredNames&&s.declaredNames();let l="";const g=Ce.renameParamWithoutRenamingCapturablesInfo(s,n,l),m=g[0],u=g[1];let p=[];if(s.declaredNames){p=s.declaredNames();const d=p.indexOf(n);if(d!=-1&&p.splice(d,1),o.indexOf(i)!=-1){const _=p.indexOf(i);_!=-1&&p.splice(_,1)}}const c=Ce.sortAndRemoveDuplicates(u.concat(p));if(i=Et.nameNotIn(i,c),i!==n&&!(p.indexOf(n)!=-1))for(let _=0;_<m.length;_++){const b=m[_],$=b.renameLexicalVar;$&&$.call(b,Of()(n),Of()(i))}return i};Ce.renameParamWithoutRenamingCapturablesInfo=function(s,n,i){let o=[];s.blocksInScope&&(o=s.blocksInScope());const l=o.map(function(u){return Ce.referenceResult(u,n,i,[])});let g=[],m=[];for(let u=0;u<l.length;u++)g=g.concat(l[u][0]),m=m.concat(l[u][1]);return m=Ce.sortAndRemoveDuplicates(m),[g,m]};Ce.checkIdentifier=function(s){const n=s.trim().replace(/[\s\xa0]+/g,"_"),i="^[^-0-9!&%^/>=<`'\"#:;,\\\\*+.()|{}[\\] ]",o=`[^-!&%^/>=<'"#:;,\\\\*+.()|{}[\\] ]*$`,l=new RegExp(i+o);return{isLegal:n.search(l)==0,transformed:n}};Ce.makeLegalIdentifier=function(s){const n=Ce.checkIdentifier(s);return n.isLegal?n.transformed:n.transformed===""?"_":"name"};Ce.referenceResult=function(s,n,i,o){if(!s)return[[],[]];const l=s.referenceResults?s.referenceResults(n,i,o):s.getChildren().map(function(u){return Ce.referenceResult(u,n,i,o)});let g=[],m=[];for(let u=0;u<l.length;u++)g=g.concat(l[u][0]),m=m.concat(l[u][1]);return[g,m]};Ce.sortAndRemoveDuplicates=function(s){const n=s.sort(),i=[];if(s.length>=1){let o=n[0];i.push(o);for(let l=1;l<n.length;l++)n[l]!==o&&(o=n[l],i.push(o))}return i};Ce.getNextTargetBlock=function(s){return s&&s.nextConnection&&s.nextConnection.targetBlock()?s.nextConnection.targetBlock():null};Ce.stringListsEqual=function(s,n){const i=s.length,o=n.length;if(i!==o)return false;for(let l=0;l<i;l++)if(s[l]!==n[l])return false;return true};/**
 * @license
 * @fileoverview Visual blocks editor for App Inventor
 * Methods to handle serialization of the blocks workspace.
 *
 * @author sharon@google.com (Sharon Perl)
 */const MB=["",""],lh=function(s){let n=this.block.workspace.getTopWorkspace();if(!this.block.isEditable()){n=w.Drawer.flyout_.workspace_;return}const i=n.getProcedureDatabase().getProcedure(s);if(!i)return;const o=i.getFieldValue("NAME");if(o==""||o!=this.getValue())for(let l=0;this.block.getInput("ARG"+l)!=null;l++)this.block.removeInput("ARG"+l);this.doValueUpdate_(o),i&&this.block.setProcedureParameters(i.arguments_,i.paramIds_,true)},uR=function(s,n){const o=(n||w.common.getMainWorkspace()).getTopBlocks(),l=[MB];for(let g=0;g<o.length;g++){const m=o[g].getFieldValue("NAME");o[g].type=="procedures_defnoreturn"&&!s?l.push([m,m]):o[g].type=="procedures_defreturn"&&s&&l.push([m,m])}return l.length>1&&l.splice(0,1),l},DB=function(s){const n=s.workspace.getTopBlocks(false),i=[];for(let o=0;o<n.length;o++)(n[o].type==="procedures_defnoreturn"||n[o].type==="procedures_defreturn")&&n[o]!==s&&i.push(n[o]);return i},xB=function(s,n){if(n&&n===w.common.getMainWorkspace()){const i=n.getAllBlocks();for(let o=0;o<i.length;o++){const l=i[o];(l.type=="procedures_callreturn"||l.type=="procedures_callnoreturn")&&l.getFieldValue("PROCNAME")==s&&l.removeProcedureValue()}}},BB=function(s){const n=this.oldName_||this.getValue(),i=s;s=Ce.makeLegalIdentifier(s);const l=DB(this.sourceBlock_).map(function(m){return m.getFieldValue("NAME")});s=Et.nameNotIn(s,l),s!==i&&this.doValueUpdate_(s);const g=this.sourceBlock_.workspace.getAllBlocks();for(let m=0;m<g.length;m++){const u=g[m].renameProcedure;u&&u.call(g[m],n,s)}return this.oldName_=s,s};/**
 * @license
 * Copyright © 2016-2017 Massachusetts Institute of Technology. All rights
 *     reserved.
 */const wi=function(s){this.workspace_=s,this.procedures_={},this.returnProcedures_={},this.voidProcedures_={},this.length=0,this.returnProcedures=0,this.voidProcedures=0};wi.defaultValue=["","none"];wi.prototype.getNames=function(s){return uR(s,this.workspace_).map(function(n){return n[0]})};wi.prototype.getMenuItems=function(s){return uR(s,this.workspace_)};wi.prototype.getDeclarationBlocks=function(s){return w.utils.object.values(s?this.returnProcedures_:this.voidProcedures_)};wi.prototype.getDeclarationsBlocksExcept=function(s){const n=[];return w.utils.values(this.procedures_).forEach(function(i){i!==s&&n.push(i)}),n};wi.prototype.getAllDeclarationNames=function(){return w.utils.values(this.procedures_).map(function(s){return s.getFieldValue("NAME")})};wi.prototype.addProcedure=function(s,n){if(n.type!="procedures_defnoreturn"&&n.type!="procedures_defreturn")return console.warn("Attempt to addProcedure with block type "+n.type),false;const i=n.id;return i in this.procedures_?false:(this.procedures_[i]=n,this.length++,n.type=="procedures_defnoreturn"?(this.voidProcedures_[i]=n,this.voidProcedures++):(this.returnProcedures_[i]=n,this.returnProcedures++),true)};wi.prototype.removeProcedure=function(s){return s in this.procedures_&&(this.procedures_[s].type=="procedures_defnoreturn"?(delete this.voidProcedures_[s],this.voidProcedures--):(delete this.returnProcedures_[s],this.returnProcedures--),delete this.procedures_[s],this.length--),true};wi.prototype.renameProcedure=function(s,n,i){};wi.prototype.getProcedure=function(s){const n=this.procedures_[s];return n||this.getProcedureByName(s)};wi.prototype.getProcedureByName=function(s){for(const n in this.procedures_)if(this.procedures_[n].getFieldValue("NAME")===s)return this.procedures_[n]};wi.prototype.clear=function(){this.procedures_={},this.returnProcedures_={},this.voidProcedures_={},this.length=0,this.returnProcedures=0,this.voidProcedures=0};w.WorkspaceSvg.prototype.flydown_=null;w.WorkspaceSvg.prototype.getFlydown=function(){return this.flydown_};w.WorkspaceSvg.prototype.getProcedureDatabase=function(){return this.procedureDb_||(this.procedureDb_=new wi(this)),this.procedureDb_};w.WorkspaceSvg.prototype.getTopWorkspace=function(){let s=this;for(;s.targetWorkspace;)s=s.targetWorkspace;return s};w.WorkspaceSvg.prototype.getWarningHandler=function(){return CB};/**
 * @license
 * @fileoverview Field in which mouseover displays flyout-like menu of blocks
 * and mouse click edits the field name.
 * Flydowns are used in App Inventor for displaying get/set blocks for
 *     parameter names and callers for procedure declarations.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */const Ii=class Ii2 extends w.FieldTextInput{constructor(n,i,o,l){super(n,l),this.EDITABLE=i,this.displayLocation=o||Ii2.DISPLAY_RIGHT}showEditor_(){this.EDITABLE&&(Ii2.showPid_&&(clearTimeout(Ii2.showPid_),Ii2.showPid_=0,w.common.getMainWorkspace().hideChaff()),super.showEditor_())}init(n){super.init(n),w.utils.dom.removeClass(this.fieldGroup_,"blocklyEditableText"),w.utils.dom.removeClass(this.fieldGroup_,"blocklyNoNEditableText"),w.utils.dom.addClass(this.fieldGroup_,this.fieldCSSClassName),this.mouseOverWrapper_=w.browserEvents.bind(this.fieldGroup_,"mouseover",this,this.onMouseOver_),this.mouseOutWrapper_=w.browserEvents.bind(this.fieldGroup_,"mouseout",this,this.onMouseOut_)}};to(Ii,"timeout",500),to(Ii,"showPid_",0),to(Ii,"openFieldFlydown_",null),to(Ii,"DISPLAY_BELOW","BELOW"),to(Ii,"DISPLAY_RIGHT","RIGHT"),to(Ii,"DISPLAY_LOCATION",Ii.DISPLAY_BELOW);let mt=Ii;mt.prototype.fieldCSSClassName="blocklyFieldFlydownField";mt.prototype.flyoutCSSClassName="blocklyFieldFlydownFlydown";mt.prototype.onMouseOver_=function(s){!this.sourceBlock_.isInFlyout&&mt.showPid_==0&&(mt.showPid_=window.setTimeout(this.showFlydownMaker_(),mt.timeout)),s.stopPropagation()};mt.prototype.onMouseOut_=function(s){window.clearTimeout(mt.showPid_),mt.showPid_=0,s.stopPropagation()};mt.prototype.showFlydownMaker_=function(){const s=this;return function(){if(mt.showPid_!==0&&!s.getSourceBlock().workspace.isDragging()&&!this.htmlInput_)try{s.showFlydown_()}catch(n){console.error("Failed to show flydown",n)}mt.showPid_=0}};mt.prototype.showFlydown_=function(){w.common.getMainWorkspace().hideChaff();const s=w.common.getMainWorkspace().getFlydown();w.common.getMainWorkspace().getParentSvg().appendChild(s.svgGroup_);const n=s.targetWorkspace.scale;s.workspace_.setScale(n),s.setCSSClass(this.flyoutCSSClassName);const i=this.flydownBlocksXML_(),o=w.Xml.textToDom(i),l=$h(o),g=w.common.getMainWorkspace().getSvgXY(this.borderRect_),m=this.borderRect_.getBBox();this.displayLocation===mt.DISPLAY_BELOW?g.y+=m.height*n:g.x+=m.width*n,s.field_=this,s.showAt(l,g.x,g.y),mt.openFieldFlydown_=this};mt.hide=function(){window.clearTimeout(mt.showPid_);const s=w.common.getMainWorkspace().getFlydown();s&&s.hide()};function PB(s,n){const i=s.doClassValidation_(n);if(i===null)return null;i!==void 0&&(n=i);const o=s.getValidator();if(o){const l=o.call(s,n);if(l===null)return null;l!==void 0&&(n=l)}return n}mt.prototype.onHtmlInputChange_=function(s){const n=this.htmlInput_,i=n.value;if(i!==n.oldValue_){n.oldValue_=i;let o=true;this.sourceBlock_&&(o=PB(this,n.value)),o===null?w.utils.dom.addClass(n,"blocklyInvalidInput"):(w.utils.dom.removeClass(n,"blocklyInvalidInput"),this.doValueUpdate_(o))}else w.utils.userAgent.WEBKIT&&this.sourceBlock_.render();this.textContent_.nodeValue=i,this.forceRerender(),this.resizeEditor_(),w.svgResize(this.sourceBlock_.workspace)};mt.prototype.dispose=function(){mt.openFieldFlydown_==this&&mt.hide(),w.FieldTextInput.prototype.dispose.call(this)};mt.fromJson=function(s){const n=w.utils.replaceMessageReferences(s.name);return new mt(n,s.is_editable)};w.fieldRegistry.register("field_flydown",mt);/**
 * @license
 * @fileoverview Flydown is an abstract class for a flyout-like dropdown
 *     containing blocks. Unlike a regular flyout, for simplicity it does not
 *     support scrolling. Any non-abstract subclass must provide a
 *     flydownBlocksXML_ () method that returns an XML element whose children
 *     are blocks that should appear in the flyout.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */class _i extends w.VerticalFlyout{constructor(n){super(n),this.dragAngleRange_=360}}_i.prototype.previousCSSClassName_="";_i.prototype.VERTICAL_SEPARATION_FACTOR=1;_i.prototype.createDom=function(s){return this.previousCSSClassName_=s,this.svgGroup_=w.utils.dom.createSvgElement("g",{class:s},null),this.svgBackground_=w.utils.dom.createSvgElement("path",{},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.svgGroup_};_i.prototype.setCSSClass=function(s){s!==this.previousCSSClassName_&&(w.utils.dom.removeClass(this.svgGroup_,this.previousCSSClassName_),w.utils.dom.addClass(this.svgGroup_,s),this.previousCSSClassName_=s)};_i.prototype.init=function(s){w.Flyout.prototype.init.call(this,s,false),this.workspace_.setTheme(s.getTheme()),s.getComponentManager().addCapability(this.id,w.ComponentManager.Capability.AUTOHIDEABLE)};_i.prototype.position=function(){};_i.prototype.showAt=function(s,n,i){w.Events.disable();try{this.show(s)}finally{w.Events.enable()}const o=this.CORNER_RADIUS*this.workspace_.scale,l=this.width_-2*o,g=this.height_-2*o,m=["M 0,"+o];m.push("a",o,o,0,0,1,o,-o),m.push("h",l),m.push("a",o,o,0,0,1,o,o),m.push("v",g),m.push("a",o,o,0,0,1,-o,o),m.push("h",-l),m.push("a",o,o,0,0,1,-o,-o),m.push("z"),this.svgBackground_.setAttribute("d",m.join(" ")),this.svgGroup_.setAttribute("transform","translate("+n+", "+i+")")};_i.prototype.reflow=function(){this.workspace_.scale=this.targetWorkspace.scale;const s=this.workspace_.scale;let n=0,i=0;const o=this.CORNER_RADIUS*s,l=this.workspace_.getTopBlocks(false);for(let u=0,p;p=l[u];u++){const c=p.getHeightWidth();n=Math.max(n,c.width*s),i+=c.height*s}n+=2*o+this.tabWidth_*s;const g=this.workspace_.getRenderer().getConstants(),m=g.ADD_START_HATS?g.START_HAT_HEIGHT:0;if(i+=3*o+o*this.VERTICAL_SEPARATION_FACTOR*l.length+m*s/2,this.width_!=n){for(let u=0,p;p=l[u];u++){const c=p.getHeightWidth(),d=p.getRelativeToSurfaceXY();if(this.RTL){const _=n-o-s*(this.tabWidth_-d.x);p.moveBy(_,0),d.x+=_}p.flyoutRect_&&(p.flyoutRect_.setAttribute("width",c.width),p.flyoutRect_.setAttribute("height",c.height),p.flyoutRect_.setAttribute("x",this.RTL?d.x-c.width:d.x),p.flyoutRect_.setAttribute("y",d.y))}this.width_=n,this.height_=i}};_i.prototype.onMouseMove_=function(s){};_i.prototype.placeNewBlock_=function(s){const n=this.targetWorkspace,i=s.getSvgRoot();if(!i)throw Error("originBlock is not rendered.");let o=this.workspace_.scale;const l=this.workspace_.getSvgXY(i),g=l.x;l.x+=g/n.scale-g;const m=l.y;o=n.scale,l.y+=m/o-m;const u=w.Xml.blockToDom(s),p=w.Xml.domToBlock(u,n),c=p.getSvgRoot();if(!c)throw Error("block is not rendered.");const d=n.getSvgXY(c);return d.x+=n.scrollX/n.scale-n.scrollX,d.y+=n.scrollY/n.scale-n.scrollY,n.toolbox_&&!n.scrollbar&&(d.x+=n.toolbox_.getWidth()/n.scale,d.y+=n.toolbox_.getHeight()/n.scale),p.moveBy(l.x-d.x,l.y-d.y),p};_i.prototype.shouldHide=true;_i.prototype.hide=function(){this.shouldHide&&(w.Flyout.prototype.hide.call(this),mt.openFieldFlydown_=null),this.shouldHide=true};_i.prototype.autoHide=function(){this.hide()};/**
 * @license
 * @fileoverview Clickable field with flydown menu of global getter and setter
 *     blocks.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */class go extends mt{constructor(n,i){super(n,true,i,Ce.renameGlobal)}}go.prototype.fieldCSSClassName="blocklyFieldParameter";go.prototype.flyoutCSSClassName="blocklyFieldParameterFlydown";go.prototype.flydownBlocksXML_=function(){const s=w.Msg.LANG_VARIABLES_GLOBAL_PREFIX+" "+this.getText();return'<xml><block type="lexical_variable_get"><title name="VAR">'+s+'</title></block><block type="lexical_variable_set"><title name="VAR">'+s+"</title></block></xml>"};go.fromJson=function(s){const n=w.utils.replaceMessageReferences(s.name);return new go(n)};w.fieldRegistry.register("field_global_flydown",go);class pa extends w.FieldDropdown{constructor(...n){super(...n)}}pa.prototype.doClassValidation_=function(s){let n=false;const i=this.getOptions(true);for(let o=0,l;l=i[o];o++)if(l[1]===s){n=true;break}return n||this.generatedOptions_.push([s,s]),s};pa.fromJson=function(s){return new pa(s.options,void 0,s)};w.fieldRegistry.register("field_nocheck_dropdown",pa);class os extends mt{constructor(n,i,o,l){const g=function(m){if(!os.changeHandlerEnabled)return m;const u=Ce.renameParam.call(this,m);return l&&l.call(this,u),u};super(n,i,o,g)}}os.prototype.fieldCSSClassName="blocklyFieldParameter";os.prototype.flyoutCSSClassName="blocklyFieldParameterFlydown";os.changeHandlerEnabled=true;os.withChangeHanderDisabled=function(s){const n=os.changeHandlerEnabled;os.changeHandlerEnabled=false;try{s()}finally{os.changeHandlerEnabled=n}};os.prototype.flydownBlocksXML_=function(){const s=this.getText();return'<xml><block type="lexical_variable_get"><field name="VAR">'+s+'</field></block><block type="lexical_variable_set"><field name="VAR">'+s+"</field></block></xml>"};os.addHorizontalVerticalOption=function(s,n){let i=0;if(s.getParameters&&(i=s.getParameters().length),s.isCollapsed()||i<=0)return;const o={enabled:true,text:s.horizontalParameters?w.Msg.VERTICAL_PARAMETERS:w.Msg.HORIZONTAL_PARAMETERS,callback:function(){s.setParameterOrientation(!s.horizontalParameters)}};let l=0;for(let g;(g=n[l])&&g.text!=w.Msg.COLLAPSE_BLOCK;l++);n.splice(l,0,o);for(let g=0,m;m=n[g];g++)if(m.text==w.Msg.INLINE_INPUTS){n.splice(g,1);break}};os.fromJson=function(s){const n=w.utils.replaceMessageReferences(s.name);return new os(n,s.is_editable)};w.fieldRegistry.register("field_parameter_flydown",os);/**
 * @license
 * @fileoverview Specialization of Blockly's FieldTextInput to handle logic of
 *     procedure renaming.
 * @author ewpatton@mit.edu (Evan W. Patton)
 */class sc extends w.FieldTextInput{constructor(n){super(n,BB)}setValue(n){const i=this.getValue();if(this.oldName_=i,this.doValueUpdate_(n),super.setValue(n),n=this.getValue(),typeof n=="string"&&this.sourceBlock_){const o=this.sourceBlock_.workspace.getProcedureDatabase();o&&(o.getProcedure(this.sourceBlock_.id)?o.renameProcedure(this.sourceBlock_.id,i,n):o.addProcedure(n,this.sourceBlock_))}this.oldName_=void 0}}sc.fromJson=function(s){const n=w.utils.replaceMessageReferences(s.name);return new sc(n)};w.fieldRegistry.register("field_procedurename",sc);/**
 * @license
 * @fileoverview Variables blocks for Blockly, modified for MIT App Inventor.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */delete w.Blocks.global_declaration;w.Blocks.global_declaration={category:"Variables",helpUrl:w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_HELPURL,init:function(){this.setStyle("variable_blocks"),this.appendValueInput("VALUE").appendField(w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT).appendField(new go(w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME,mt.DISPLAY_BELOW),"NAME").appendField(w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO),this.setTooltip(w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP)},getVars:function(){const s=this.getField("NAME");return s?[s.getText()]:[]},getGlobalNames:function(){return this.getVars()},renameVar:function(s,n){w.Names.equals(s,this.getFieldValue("NAME"))&&this.setFieldValue(n,"NAME")}};w.Blocks.lexical_variable_get={category:"Variables",helpUrl:w.Msg.LANG_VARIABLES_GET_HELPURL,init:function(){this.setStyle("variable_blocks"),this.fieldVar_=new Et(" "),this.fieldVar_.setBlock(this),this.appendDummyInput().appendField(w.Msg.LANG_VARIABLES_GET_TITLE_GET).appendField(this.fieldVar_,"VAR"),this.setOutput(true,null),this.setTooltip(w.Msg.LANG_VARIABLES_GET_TOOLTIP),this.errors=[{func:gc},{func:fc,dropDowns:["VAR"]}],this.setOnChange(function(s){pc(this)})},referenceResults:function(s,n,i){const o=this.getChildren().map(function(_){return Ce.referenceResult(_,s,n,i)});let l=[],g=[];for(let _=0;_<o.length;_++)l=l.concat(o[_][0]),g=g.concat(o[_][1]);const m=this.getField("VAR").getText(),u=cR(m),p=u[0],c=u[1],d=i.indexOf(c)==-1;return p!==w.Msg.LANG_VARIABLES_GLOBAL_PREFIX&&(c===s&&d?(l.push(this),g=g.concat(i)):d&&!OB&&g.push(c)),[[l,g]]},getVars:function(){return[this.getFieldValue("VAR")]},renameLexicalVar:function(s,n,i,o){i===void 0?s===this.getFieldValue("VAR")&&this.setFieldValue(n,"VAR"):i&&i===this.fieldVar_.getText()&&(this.fieldVar_.getOptions(false),this.fieldVar_.setValue(n),s===n&&this.setFieldValue(n,"VAR"),this.fieldVar_.forceRerender())},renameFree:function(s){const n=w.unprefixName(this.getFieldValue("VAR"));if(n[0]!==w.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const o=n[1],l=s.apply(o);l!==o&&this.renameLexicalVar(o,l)}},freeVariables:function(){const s=w.unprefixName(this.getFieldValue("VAR"));if(s[0]!==w.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const i=s[1];return new w.NameSet([i])}else return new w.NameSet}};w.Blocks.lexical_variable_set={category:"Variables",helpUrl:w.Msg.LANG_VARIABLES_SET_HELPURL,init:function(){this.setStyle("variable_blocks"),this.fieldVar_=new Et(" "),this.fieldVar_.setBlock(this),this.appendValueInput("VALUE").appendField(w.Msg.LANG_VARIABLES_SET_TITLE_SET).appendField(this.fieldVar_,"VAR").appendField(w.Msg.LANG_VARIABLES_SET_TITLE_TO),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(w.Msg.LANG_VARIABLES_SET_TOOLTIP),this.errors=[{func:gc},{func:fc,dropDowns:["VAR"]}],this.setOnChange(function(s){pc(this)})},referenceResults:w.Blocks.lexical_variable_get.referenceResults,getVars:function(){return[this.getFieldValue("VAR")]},renameLexicalVar:w.Blocks.lexical_variable_get.renameLexicalVar,renameFree:function(s){const n=w.unprefixName(this.getFieldValue("VAR"));if(n[0]!==w.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const o=n[1],l=s.apply(o);l!==o&&this.renameLexicalVar(o,l)}this.getChildren().map(function(o){Ce.renameFree(o,s)})},freeVariables:function(){const s=this.getChildren().map(function(l){return Ce.freeVariables(l)}),n=w.NameSet.unionAll(s),i=w.unprefixName(this.getFieldValue("VAR"));if(i[0]!==w.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const l=i[1];n.insert(l)}return n}};w.Blocks.local_declaration_statement={category:"Variables",helpUrl:w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_HELPURL,bodyInputName:"STACK",init:function(){this.setStyle("variable_blocks"),this.initLocals(),this.appendStatementInput("STACK").appendField(w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP),this.lexicalVarPrefix=lR},referenceResults:function(s,n,i){const o=[];for(let c=0;this.getInput("DECL"+c);c++){let d=this.getFieldValue("VAR"+c);o.push(d)}const l=i.concat(o),g=[];for(let c=0;this.getInput("DECL"+c);c++){const d=this.getInputTargetBlock("DECL"+c);d&&g.push(d)}const m=g.map(function(c){return Ce.referenceResult(c,s,n,i)}),u=Ce.referenceResult(this.getInputTargetBlock("STACK"),s,n,l),p=Ce.referenceResult(Ce.getNextTargetBlock(this),s,n,i);return m.concat([u,p])},withLexicalVarsAndPrefix:function(s,n){if(this.getInputTargetBlock(this.bodyInputName)==s){const i=this.declaredNames();for(let o=0;o<i.length;o++)n(i[o],this.lexicalVarPrefix)}},initLocals:function(){this.setStyle("variable_blocks"),this.localNames_=[w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME],this.appendValueInput("DECL0").appendField(w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT).appendField(this.parameterFlydown(0),"VAR0").appendField(w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO).setAlign(w.ALIGN_RIGHT),this.setMutator(new w.Mutator(["local_mutatorarg"]))},onchange:function(){this.localNames_=this.declaredNames()},mutationToDom:function(){const s=document.createElement("mutation");for(let n=0;n<this.localNames_.length;n++){const i=document.createElement("localname");i.setAttribute("name",this.localNames_[n]),s.appendChild(i)}return s},domToMutation:function(s){const n=$h(s);if(n.length>0){this.localNames_=[];for(let i=0,o;o=n[i];i++)o.nodeName.toLowerCase()=="localname"&&this.localNames_.push(o.getAttribute("name"))}this.updateDeclarationInputs_(this.localNames_)},updateDeclarationInputs_:function(s,n){const i=this.inputList[this.inputList.length-1],o=this.inputList.length-1,l=this.rendered;this.rendered=false;const g=this;os.withChangeHanderDisabled(function(){for(let m=0;m<o;m++)g.removeInput("DECL"+m)}),this.inputList=[],this.localNames_=s;for(let m=0;m<s.length;m++){const u=this.appendValueInput("DECL"+m);u.appendField(w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT).appendField(this.parameterFlydown(m),"VAR"+m).appendField(w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO).setAlign(w.ALIGN_RIGHT),n&&n[m]&&u.connection.connect(n[m])}this.inputList=this.inputList.concat(i),this.rendered=l,this.rendered&&(this.initSvg(),this.render())},parameterFlydown:function(s){const n=this.localNames_[s],i=this,o=function(l){const g=i.localNames_;if(g[s]=l,i.mutator&&i.mutator.rootBlock_){const m=i.mutator.rootBlock_;let u=0,p=m.getInputTargetBlock("STACK");for(;p&&u<s;)p=p.nextConnection&&p.nextConnection.targetBlock(),u++;p&&u==s&&w.Field.prototype.setValue.call(p.getField("NAME"),l)}};return new os(n,true,mt.DISPLAY_RIGHT,o)},decompose:function(s){const n=s.newBlock("local_mutatorcontainer");n.initSvg(),n.setDefBlock(this);let i=n.getInput("STACK").connection;for(let o=0;o<this.localNames_.length;o++){const l=this.getFieldValue("VAR"+o),g=s.newBlock("local_mutatorarg");g.initSvg(),g.setFieldValue(l,"NAME"),g.oldLocation=o,i.connect(g.previousConnection),i=g.nextConnection}return n},compose:function(s){const n=[],i=[];let o=s.getInputTargetBlock("STACK");for(;o;)n.push(o.getFieldValue("NAME")),i.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();Ce.stringListsEqual(this.localNames_,n)||this.updateDeclarationInputs_(n,i)},dispose:function(...s){w.BlockSvg.prototype.dispose.apply(this,s)},saveConnections:function(s){let n=s.getInputTargetBlock("STACK"),i=0;for(;n;){const l=this.getInput("DECL"+i);n.valueConnection_=l&&l.connection.targetConnection,i++,n=n.nextConnection&&n.nextConnection.targetBlock()}const o=this.getInput(this.bodyInputName);o&&(s.bodyConnection_=o.connection.targetConnection)},getVars:function(){const s=[];for(let n=0,i;i=this.getField("VAR"+n);n++)s.push(i.getValue());return s},declaredNames:function(){return this.getVars()},declaredVariables:function(){return this.getVars()},initializerConnections:function(){const s=[];for(let n=0,i;i=this.getInput("DECL"+n);n++)s.push(i.connection&&i.connection.targetConnection);return s},blocksInScope:function(){const s=this.getInputTargetBlock(this.bodyInputName);return s&&[s]||[]},renameVar:function(s,n){this.renameVars(w.Substitution.simpleSubstitution(s,n))},renameVars:function(s){const n=this.declaredNames(),i=s.map(n);if(!Ce.stringListsEqual(i,n)){const o=this.initializerConnections();if(this.updateDeclarationInputs_(i,o),this.mutator.isVisible()){const l=this.mutator.workspace_.getAllBlocks();for(let g=0,m;m=l[g];g++)if(m.type=="procedures_mutatorarg"){const u=m.getFieldValue("NAME"),p=s.apply(u);p!==u&&m.setFieldValue(p,"NAME")}}}},renameBound:function(s,n){const i=w.Xml.domToText(this.mutationToDom()),o=this.declaredNames();for(let u=0;u<o.length;u++)Ce.renameFree(this.getInputTargetBlock("DECL"+u),n);const l=s.restrictDomain(o);this.renameVars(l);const g=n.remove(o).extend(l);Ce.renameFree(this.getInputTargetBlock(this.bodyInputName),g);const m=w.Xml.domToText(this.mutationToDom());if(w.Events.isEnabled()&&w.Events.fire(new w.Events.BlockChange(this,"mutation",null,i,m)),this.nextConnection){const u=this.nextConnection.targetBlock();Ce.renameFree(u,n)}},renameFree:function(s){const n=this.declaredNames(),i=new w.NameSet(n),o=Ce.freeVariables(this.getInputTargetBlock(this.bodyInputName));o.subtract(i);const l=o.renamed(s),g=l.intersection(i);if(g.isEmpty())this.renameBound(new w.Substitution,s);else{const m=i.union(l).toList(),u={},p=g.toList();for(let c=0,d;d=p[c];c++){const _=Et.nameNotIn(d,m);u[d]=_,m.push(_)}this.renameBound(new w.Substitution(u),s)}},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock(this.bodyInputName)),n=this.declaredNames();s.subtract(new w.NameSet(n));const i=n.length;for(let o=0;o<i;o++)s.union(Ce.freeVariables(this.getInputTargetBlock("DECL"+o)));if(this.nextConnection){const o=this.nextConnection.targetBlock();s.unite(Ce.freeVariables(o))}return s}};w.Blocks.local_declaration_expression={category:"Variables",helpUrl:w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_HELPURL,initLocals:w.Blocks.local_declaration_statement.initLocals,bodyInputName:"RETURN",init:function(){this.setStyle("variables_blocks"),this.initLocals(),this.appendValueInput("RETURN").appendField(w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN),this.setOutput(true,null),this.setTooltip(w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP)},referenceResults:function(s,n,i){const o=[];for(let p=0;this.getInput("DECL"+p);p++){let c=this.getFieldValue("VAR"+p);o.push(c)}const l=i.concat(o),g=[];for(let p=0;this.getInput("DECL"+p);p++){const c=this.getInputTargetBlock("DECL"+p);c&&g.push(c)}const m=g.map(function(p){return Ce.referenceResult(p,s,n,i)}),u=Ce.referenceResult(this.getInputTargetBlock("RETURN"),s,n,l);return m.concat([u])},withLexicalVarsAndPrefix:w.Blocks.local_declaration_statement.withLexicalVarsAndPrefix,onchange:w.Blocks.local_declaration_statement.onchange,mutationToDom:w.Blocks.local_declaration_statement.mutationToDom,domToMutation:w.Blocks.local_declaration_statement.domToMutation,updateDeclarationInputs_:w.Blocks.local_declaration_statement.updateDeclarationInputs_,parameterFlydown:w.Blocks.local_declaration_statement.parameterFlydown,blocksInScope:w.Blocks.local_declaration_statement.blocksInScope,decompose:w.Blocks.local_declaration_statement.decompose,compose:w.Blocks.local_declaration_statement.compose,dispose:w.Blocks.local_declaration_statement.dispose,saveConnections:w.Blocks.local_declaration_statement.saveConnections,getVars:w.Blocks.local_declaration_statement.getVars,declaredNames:w.Blocks.local_declaration_statement.declaredNames,declaredVariables:w.Blocks.local_declaration_statement.declaredVariables,renameVar:w.Blocks.local_declaration_statement.renameVar,renameVars:w.Blocks.local_declaration_statement.renameVars,renameBound:w.Blocks.local_declaration_statement.renameBound,renameFree:w.Blocks.local_declaration_statement.renameFree,freeVariables:w.Blocks.local_declaration_statement.freeVariables};w.Blocks.local_mutatorcontainer={init:function(){this.setStyle("variable_blocks"),this.appendDummyInput().appendField(w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES),this.appendStatementInput("STACK"),this.setTooltip(w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP),this.contextMenu=false,this.mustNotRenameCapturables=true},setDefBlock:function(s){this.defBlock_=s},getDefBlock:function(){return this.defBlock_},declaredNames:function(){const s=[];let n=this.getInputTargetBlock("STACK");for(;n;)s.push(n.getFieldValue("NAME")),n=n.nextConnection&&n.nextConnection.targetBlock();return s}};w.Blocks.local_mutatorarg={init:function(){this.setStyle("variable_blocks"),this.appendDummyInput().appendField(w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME).appendField(new w.FieldTextInput(w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE,Ce.renameParam),"NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(""),this.contextMenu=false,this.lexicalVarPrefix=lR,this.mustNotRenameCapturables=true},getContainerBlock:function(){let s=this.getParent();for(;s&&s.type!=="local_mutatorcontainer";)s=s.getParent();return this.cachedContainerBlock_=s&&s.type==="local_mutatorcontainer"&&s||null,this.cachedContainerBlock_},getDefBlock:function(){const s=this.getContainerBlock();return s&&s.getDefBlock()||null},blocksInScope:function(){const s=this.getDefBlock();return s&&s.blocksInScope()||[]},declaredNames:function(){const s=this.getContainerBlock();return s&&s.declaredNames()||[]},onchange:function(){const s=this.getFieldValue("NAME");if(s){const n=this.cachedContainerBlock_,i=this.getContainerBlock();if(!n&&i){const o=this.declaredNames(),l=o.indexOf(s);if(l!=-1&&o.indexOf(s,l+1)!=-1){const m=Et.nameNotIn(s,o);this.setFieldValue(m,"NAME")}}}}};w.Blocks.controls_forRange={category:"Control",helpUrl:w.Msg.LANG_CONTROLS_FORRANGE_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendValueInput("START").setCheck(ju("number",zu)).appendField(w.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM).appendField(new os(w.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR,true,mt.DISPLAY_BELOW),"VAR").appendField(w.Msg.LANG_CONTROLS_FORRANGE_INPUT_START).setAlign(w.ALIGN_RIGHT),this.appendValueInput("END").setCheck(ju("number",zu)).appendField(w.Msg.LANG_CONTROLS_FORRANGE_INPUT_END).setAlign(w.ALIGN_RIGHT),this.appendValueInput("STEP").setCheck(ju("number",zu)).appendField(w.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP).setAlign(w.ALIGN_RIGHT),this.appendStatementInput("DO").appendField(w.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO).setAlign(w.ALIGN_RIGHT),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(w.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP),this.lexicalVarPrefix=wB},referenceResults:function(s,n,i){let o=this.getFieldValue("VAR");const l=i.concat([o]),g=Ce.referenceResult(this.getInputTargetBlock("START"),s,n,i),m=Ce.referenceResult(this.getInputTargetBlock("END"),s,n,i),u=Ce.referenceResult(this.getInputTargetBlock("STEP"),s,n,i),p=Ce.referenceResult(this.getInputTargetBlock("DO"),s,n,l),c=Ce.referenceResult(Ce.getNextTargetBlock(this),s,n,i);return[g,m,u,p,c]},withLexicalVarsAndPrefix:function(s,n){if(this.getInputTargetBlock("DO")==s){const i=this.getFieldValue("VAR");n(i,this.lexicalVarPrefix)}},getVars:function(){return[this.getFieldValue("VAR")]},blocksInScope:function(){const s=this.getInputTargetBlock("DO");return s?[s]:[]},declaredNames:function(){return[this.getFieldValue("VAR")]},renameVar:function(s,n){w.Names.equals(s,this.getFieldValue("VAR"))&&this.setFieldValue(n,"VAR")},renameBound:function(s,n){Ce.renameFree(this.getInputTargetBlock("START"),n),Ce.renameFree(this.getInputTargetBlock("END"),n),Ce.renameFree(this.getInputTargetBlock("STEP"),n);const i=this.getFieldValue("VAR"),o=s.apply(i);if(o!==i){this.renameVar(i,o);const l=w.Substitution.simpleSubstitution(i,o),g=n.extend(l);Ce.renameFree(this.getInputTargetBlock("DO"),g)}else{const l=n.remove([i]);Ce.renameFree(this.getInputTargetBlock("DO"),l)}if(this.nextConnection){const l=this.nextConnection.targetBlock();Ce.renameFree(l,n)}},renameFree:function(s){const n=this.getFieldValue("VAR"),i=Ce.freeVariables(this.getInputTargetBlock("DO"));i.deleteName(n);const o=i.renamed(s);if(o.isMember(n)){const l=Et.nameNotIn(n,o.toList()),g=w.Substitution.simpleSubstitution(n,l);this.renameBound(g,s)}else this.renameBound(new w.Substitution,s)},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock("DO"));if(s.deleteName(this.getFieldValue("VAR")),s.unite(Ce.freeVariables(this.getInputTargetBlock("START"))),s.unite(Ce.freeVariables(this.getInputTargetBlock("END"))),s.unite(Ce.freeVariables(this.getInputTargetBlock("STEP"))),this.nextConnection){const n=this.nextConnection.targetBlock();s.unite(Ce.freeVariables(n))}return s}};delete w.Blocks.controls_for;w.Blocks.controls_for=w.Blocks.controls_forRange;w.Blocks.controls_forEach={category:"Control",helpUrl:w.Msg.LANG_CONTROLS_FOREACH_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendValueInput("LIST").setCheck(ju("list",zu)).appendField(w.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM).appendField(new os(w.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR,true,mt.DISPLAY_BELOW),"VAR").appendField(w.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST).setAlign(w.ALIGN_RIGHT),this.appendStatementInput("DO").appendField(w.Msg.LANG_CONTROLS_FOREACH_INPUT_DO),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(w.Msg.LANG_CONTROLS_FOREACH_TOOLTIP),this.lexicalVarPrefix=kB},referenceResults:function(s,n,i){let o=this.getFieldValue("VAR");const l=i.concat([o]),g=Ce.referenceResult(this.getInputTargetBlock("LIST"),s,n,i),m=Ce.referenceResult(this.getInputTargetBlock("DO"),s,n,l),u=Ce.referenceResult(Ce.getNextTargetBlock(this),s,n,i);return[g,m,u]},withLexicalVarsAndPrefix:w.Blocks.controls_forRange.withLexicalVarsAndPrefix,getVars:function(){return[this.getFieldValue("VAR")]},blocksInScope:function(){const s=this.getInputTargetBlock("DO");return s?[s]:[]},declaredNames:function(){return[this.getFieldValue("VAR")]},renameVar:function(s,n){w.Names.equals(s,this.getFieldValue("VAR"))&&this.setFieldValue(n,"VAR")},renameBound:function(s,n){Ce.renameFree(this.getInputTargetBlock("LIST"),n);const i=this.getFieldValue("VAR"),o=s.apply(i);if(o!==i){this.renameVar(i,o);const l=w.Substitution.simpleSubstitution(i,o),g=n.extend(l);Ce.renameFree(this.getInputTargetBlock("DO"),g)}else{const l=n.remove([i]);Ce.renameFree(this.getInputTargetBlock("DO"),l)}if(this.nextConnection){const l=this.nextConnection.targetBlock();Ce.renameFree(l,n)}},renameFree:function(s){const n=this.getFieldValue("VAR"),i=Ce.freeVariables(this.getInputTargetBlock("DO"));i.deleteName(n);const o=i.renamed(s);if(o.isMember(n)){const l=Et.nameNotIn(n,o.toList()),g=w.Substitution.simpleSubstitution(n,l);this.renameBound(g,s)}else this.renameBound(new w.Substitution,s)},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock("DO"));if(s.deleteName(this.getFieldValue("VAR")),s.unite(Ce.freeVariables(this.getInputTargetBlock("LIST"))),this.nextConnection){const n=this.nextConnection.targetBlock();s.unite(Ce.freeVariables(n))}return s}};w.Blocks.controls_do_then_return={category:"Control",helpUrl:w.Msg.LANG_CONTROLS_DO_THEN_RETURN_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendStatementInput("STM").appendField(w.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO),this.appendValueInput("VALUE").appendField(w.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN).setAlign(w.ALIGN_RIGHT),this.setOutput(true,null),this.setTooltip(w.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP)}};/**
 * @license
 * @fileoverview Procedure blocks for Blockly, modified for MIT App Inventor.
 * @author mckinney@mit.edu (Andrew F. McKinney)
 */w.Blocks.procedures_defnoreturn={category:"Procedures",helpUrl:w.Msg.LANG_PROCEDURES_DEFNORETURN_HELPURL,bodyInputName:"STACK",init:function(){this.setStyle("procedure_blocks");const s=w.Procedures.findLegalName(w.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE,this);this.createHeader(s),this.horizontalParameters=true,this.appendStatementInput("STACK").appendField(w.Msg.LANG_PROCEDURES_DEFNORETURN_DO),this.setMutator(new w.Mutator(["procedures_mutatorarg"])),this.setTooltip(w.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP),this.arguments_=[],this.warnings=[{name:"checkEmptySockets",sockets:["STACK"]}],this.lexicalVarPrefix=aR},createHeader:function(s){return this.appendDummyInput("HEADER").appendField(w.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE).appendField(new sc(s),"NAME")},withLexicalVarsAndPrefix:function(s,n){const i=this.declaredNames();for(let o=0;o<i.length;o++)n(i[o],this.lexicalVarPrefix)},onchange:function(){this.arguments_=this.declaredNames()},updateParams_:function(s){s&&(this.arguments_=s);let n=false;const i={};for(let c=0;c<this.arguments_.length;c++){if(i["arg_"+this.arguments_[c].toLowerCase()]){n=true;break}i["arg_"+this.arguments_[c].toLowerCase()]=true}n?this.setWarningText(w.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING):this.setWarningText(null);const o=this.getFieldValue("NAME"),l=this.inputList[this.inputList.length-1],g=this.rendered;this.rendered=false;const m=this;os.withChangeHanderDisabled(function(){m.removeInput("HEADER")});const u=this.inputList.length-1;if(u>0&&this.getInput("VAR0"))for(let d=0;d<u;d++)try{os.withChangeHanderDisabled(function(){m.removeInput("VAR"+d)})}catch(_){console.log(_)}this.inputList=[];const p=this.createHeader(o);if(this.horizontalParameters)for(let c=0;c<this.arguments_.length;c++)p.appendField(" ").appendField(this.parameterFlydown(c),"VAR"+c);else for(let c=0;c<this.arguments_.length;c++)this.appendDummyInput("VAR"+c).appendField(this.parameterFlydown(c),"VAR"+c).setAlign(w.ALIGN_RIGHT);this.inputList=this.inputList.concat(l),this.rendered=g;for(let c=0;c<this.inputList.length;c++)this.inputList[c].init();this.rendered&&this.render(),this.workspace.loadCompleted&&w.Procedures.mutateCallers(this)},parameterFlydown:function(s){const n=this.arguments_[s],i=this,o=function(l){const g=i.arguments_;if(g[s]=l,w.Procedures.mutateCallers(i),i.mutator&&i.mutator.rootBlock_){const m=i.mutator.rootBlock_;let u=0,p=m.getInputTargetBlock("STACK");for(;p&&u<s;)p=p.nextConnection&&p.nextConnection.targetBlock(),u++;p&&u==s&&p.getField("NAME").setValue(l)}};return new os(n,true,this.horizontalParameters?mt.DISPLAY_BELOW:mt.DISPLAY_RIGHT,o)},setParameterOrientation:function(s){this.getParameters().length!=0&&s!==this.horizontalParameters&&(this.horizontalParameters=s,this.updateParams_(),w.Events.isEnabled()&&w.Events.fire(new w.Events.Ui(this,"parameter_orientation",(!this.horizontalParameters).toString(),this.horizontalParameters.toString())))},mutationToDom:function(){const s=document.createElement("mutation");this.horizontalParameters||s.setAttribute("vertical_parameters","true");for(let n=0;n<this.arguments_.length;n++){const i=document.createElement("arg");i.setAttribute("name",this.arguments_[n]),s.appendChild(i)}return s},domToMutation:function(s){const n=[],i=$h(s);for(let o=0,l;l=i[o];o++)l.nodeName.toLowerCase()=="arg"&&n.push(l.getAttribute("name"));this.horizontalParameters=s.getAttribute("vertical_parameters")!=="true",this.updateParams_(n)},decompose:function(s){const n=s.newBlock("procedures_mutatorcontainer");n.initSvg(),n.setProcBlock(this),this.paramIds_=[];let i=n.getInput("STACK").connection;for(let o=0;o<this.arguments_.length;o++){const l=s.newBlock("procedures_mutatorarg");this.paramIds_.push(l.id),l.initSvg(),l.setFieldValue(this.arguments_[o],"NAME"),l.oldLocation=o,i.connect(l.previousConnection),i=l.nextConnection}return w.Procedures.mutateCallers(this),n},compose:function(s){const n=[];this.paramIds_=[];let i=s.getInputTargetBlock("STACK");for(;i;)n.push(i.getFieldValue("NAME")),this.paramIds_.push(i.id),i=i.nextConnection&&i.nextConnection.targetBlock();Ce.stringListsEqual(n,this.arguments_)||(this.updateParams_(n),w.Procedures.mutateCallers(this))},dispose:function(...s){const n=this.getFieldValue("NAME"),i=this.editable_,o=this.workspace;i&&xB(n,o),w.BlockSvg.prototype.dispose.apply(this,s);const l=o.getProcedureDatabase();i&&l&&l.removeProcedure(this.id)},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,this.bodyInputName==="RETURN"]},getVars:function(){const s=[];for(let n=0,i;i=this.getFieldValue("VAR"+n);n++)s.push(i);return s},declaredNames:function(){return this.getVars()},declaredVariables:function(){return this.getVars()},renameVar:function(s,n){this.renameVars(w.Substitution.simpleSubstitution(s,n))},renameVars:function(s){const n=this.getParameters(),i=s.map(n);if(!Ce.stringListsEqual(n,i)&&(this.updateParams_(i),this.mutator.isVisible())){const o=this.mutator.workspace_.getAllBlocks();for(let l=0,g;g=o[l];l++)if(g.type=="procedures_mutatorarg"){const m=g.getFieldValue("NAME"),u=s.apply(m);u!==m&&g.setFieldValue(u,"NAME")}}},renameBound:function(s,n){const i=s.restrictDomain(this.declaredNames());this.renameVars(i);const o=n.extend(i);Ce.renameFree(this.getInputTargetBlock(this.bodyInputName),o)},renameFree:function(s){this.freeVariables()},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock(this.bodyInputName));if(s.subtract(new w.NameSet(this.declaredNames())),s.isEmpty())return s;throw Error("Violation of invariant: procedure declaration has nonempty free variables: "+s.toString())},blocksInScope:function(){const s=this.getInputTargetBlock(this.bodyInputName);return s&&[s]||[]},customContextMenu:function(s){os.addHorizontalVerticalOption(this,s)},getParameters:function(){return this.arguments_}};w.Blocks.procedures_defreturn={category:"Procedures",helpUrl:w.Msg.PROCEDURES_DEFRETURN_HELPURL,bodyInputName:"RETURN",init:function(){this.setStyle("procedure_blocks");const s=w.Procedures.findLegalName(w.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE,this);this.createHeader(s),this.horizontalParameters=true,this.appendValueInput("RETURN").setAlign(w.ALIGN_RIGHT).appendField(w.Msg.LANG_PROCEDURES_DEFRETURN_RETURN),this.setMutator(new w.Mutator(["procedures_mutatorarg"])),this.setTooltip(w.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP),this.arguments_=[],this.warnings=[{name:"checkEmptySockets",sockets:["RETURN"]}]},createHeader:function(s){return this.appendDummyInput("HEADER").appendField(w.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE).appendField(new sc(s),"NAME")},withLexicalVarsAndPrefix:w.Blocks.procedures_defnoreturn.withLexicalVarsAndPrefix,onchange:w.Blocks.procedures_defnoreturn.onchange,updateParams_:w.Blocks.procedures_defnoreturn.updateParams_,parameterFlydown:w.Blocks.procedures_defnoreturn.parameterFlydown,setParameterOrientation:w.Blocks.procedures_defnoreturn.setParameterOrientation,mutationToDom:w.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:w.Blocks.procedures_defnoreturn.domToMutation,decompose:w.Blocks.procedures_defnoreturn.decompose,compose:w.Blocks.procedures_defnoreturn.compose,dispose:w.Blocks.procedures_defnoreturn.dispose,getProcedureDef:w.Blocks.procedures_defnoreturn.getProcedureDef,getVars:w.Blocks.procedures_defnoreturn.getVars,declaredNames:w.Blocks.procedures_defnoreturn.declaredNames,declaredVariables:w.Blocks.procedures_defnoreturn.declaredVariables,renameVar:w.Blocks.procedures_defnoreturn.renameVar,renameVars:w.Blocks.procedures_defnoreturn.renameVars,renameBound:w.Blocks.procedures_defnoreturn.renameBound,renameFree:w.Blocks.procedures_defnoreturn.renameFree,freeVariables:w.Blocks.procedures_defnoreturn.freeVariables,blocksInScope:w.Blocks.procedures_defnoreturn.blocksInScope,customContextMenu:w.Blocks.procedures_defnoreturn.customContextMenu,getParameters:w.Blocks.procedures_defnoreturn.getParameters};w.Blocks.procedures_mutatorcontainer={init:function(){this.setStyle("procedure_blocks"),this.appendDummyInput().appendField(w.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.setTooltip(w.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=false,this.mustNotRenameCapturables=true},setProcBlock:function(s){this.procBlock_=s},getProcBlock:function(){return this.procBlock_},declaredNames:function(){const s=[];let n=this.getInputTargetBlock("STACK");for(;n;)s.push(n.getFieldValue("NAME")),n=n.nextConnection&&n.nextConnection.targetBlock();return s}};w.Blocks.procedures_mutatorarg={init:function(){this.setStyle("procedure_blocks");const s=new w.FieldTextInput("x",Ce.renameParam);s.onHtmlInputChange_=function(n){const i=this.getValue();mt.prototype.onHtmlInputChange_.call(this,n);const o=this.getValue();o&&i!==o&&w.Events.isEnabled()&&w.Events.fire(new w.Events.BlockChange(this.sourceBlock_,"field",this.name,i,o))},this.appendDummyInput().appendField(w.Msg.LANG_PROCEDURES_MUTATORARG_TITLE).appendField(s,"NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(w.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=false,this.lexicalVarPrefix=aR,this.mustNotRenameCapturables=true},getContainerBlock:function(){let s=this.getParent();for(;s&&s.type!=="procedures_mutatorcontainer";)s=s.getParent();return this.cachedContainerBlock_=s&&s.type==="procedures_mutatorcontainer"&&s||null,this.cachedContainerBlock_},getProcBlock:function(){const s=this.getContainerBlock();return s&&s.getProcBlock()||null},declaredNames:function(){const s=this.getContainerBlock();return s&&s.declaredNames()||[]},blocksInScope:function(){const s=this.getProcBlock();return s&&s.blocksInScope()||[]},onchange:function(){const s=this.getFieldValue("NAME");if(s){const n=this.cachedContainerBlock_,i=this.getContainerBlock();if(!n&&i){const o=this.declaredNames(),l=o.indexOf(s);if(l!=-1&&o.indexOf(s,l+1)!=-1){const m=Et.nameNotIn(s,o);this.setFieldValue(m,"NAME")}}}}};w.Blocks.procedures_mutatorarg.validator=function(s){return s=s.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),s||null};w.Blocks.procedures_callnoreturn={category:"Procedures",helpUrl:w.Msg.LANG_PROCEDURES_CALLNORETURN_HELPURL,init:function(){this.setStyle("procedure_blocks");const s=this.workspace.getTopWorkspace().getProcedureDatabase();this.procNamesFxn=function(){const n=s.getMenuItems(false);return n.length>0?n:["",""]},this.procDropDown=new pa(this.procNamesFxn,lh),this.procDropDown.block=this,this.appendDummyInput().appendField(w.Msg.LANG_PROCEDURES_CALLNORETURN_CALL).appendField(this.procDropDown,"PROCNAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(w.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP),this.arguments_=[],this.quarkConnections_=null,this.quarkArguments_=null,this.errors=[{func:gc},{func:fc,dropDowns:["PROCNAME"]}],this.setOnChange(function(n){pc(this)}),lh.call(this.getField("PROCNAME"),this.getField("PROCNAME").getValue())},getProcedureCall:function(){return this.getFieldValue("PROCNAME")},renameProcedure:function(s,n){(!s||w.Names.equals(s,this.getFieldValue("PROCNAME")))&&(this.getField("PROCNAME").getOptions(),this.setFieldValue(n,"PROCNAME"))},setProcedureParameters:function(s,n,i){let o,l,g;if(n||(this.quarkConnections_={},this.quarkArguments_=null,n=[].concat(s)),n.length!=s.length)throw Error("Error: paramNames and paramIds must be the same length.");const m={};for(let p=0;p<s.length;p++)m[n[p]]=s[p];typeof i>"u"&&(i=null),(!this.quarkArguments_||i)&&(this.quarkConnections_={},Ce.stringListsEqual(s,this.arguments_)||i?this.quarkArguments_=n:this.quarkArguments_=[]);const u=this.rendered;for(this.rendered=false,g=0;this.getInput("ARG"+g);g++)o=this.getInput("ARG"+g),o&&(l=o.connection.targetConnection,this.quarkConnections_[this.quarkArguments_[g]]=l,this.removeInput("ARG"+g));for(this.arguments_=[].concat(s),this.quarkArguments_=n,g=0;g<this.arguments_.length;g++)if(o=this.appendValueInput("ARG"+g).setAlign(w.ALIGN_RIGHT).appendField(this.arguments_[g]),this.quarkArguments_){const p=this.quarkArguments_[g];p in this.quarkConnections_?(l=this.quarkConnections_[p],!l||l.targetConnection||l.sourceBlock_.workspace!=this.workspace?delete this.quarkConnections_[p]:o.connection.connect(l)):m[p]&&(l=this.quarkConnections_[m[p]],l&&o.connection.connect(l))}if(this.rendered=u,!!this.workspace.rendered){for(g=0;g<this.arguments_.length;g++)this.getInput("ARG"+g).init();this.rendered&&this.render()}},mutationToDom:function(){const s=document.createElement("mutation");s.setAttribute("name",this.getFieldValue("PROCNAME"));for(let n=0;this.getInput("ARG"+n);n++){const i=document.createElement("arg");i.setAttribute("name",this.getInput("ARG"+n).fieldRow[0].getText()),s.appendChild(i)}return s},domToMutation:function(s){const n=s.getAttribute("name");this.setFieldValue(n,"PROCNAME"),this.arguments_=[];const i=$h(s);for(let o=0,l;l=i[o];o++)l.nodeName.toLowerCase()=="arg"&&this.arguments_.push(l.getAttribute("name"));this.setProcedureParameters(this.arguments_,null,true)},renameVar:function(s,n){for(let i=0;i<this.arguments_.length;i++)w.Names.equals(s,this.arguments_[i])&&(this.arguments_[i]=n,this.getInput("ARG"+i).fieldRow[0].setValue(n))},procCustomContextMenu:function(s){const n={enabled:true};n.text=w.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF;const i=this.getFieldValue("PROCNAME"),o=this.workspace;n.callback=function(){const l=w.Procedures.getDefinition(i,o);l&&(l.select(),o.centerOnBlock(l.id),o.getParentSvg().parentElement.focus())},s.push(n)},removeProcedureValue:function(){for(let s=0;this.getInput("ARG"+s)!==null;s++)this.removeInput("ARG"+s);this.setFieldValue("none","PROCNAME")}};w.Blocks.procedures_callreturn={category:"Procedures",helpUrl:w.Msg.LANG_PROCEDURES_CALLRETURN_HELPURL,init:function(){this.setStyle("procedure_blocks");const s=this.workspace.getTopWorkspace().getProcedureDatabase();this.procNamesFxn=function(){const n=s.getMenuItems(true);return n.length>0?n:["",""]},this.procDropDown=new pa(this.procNamesFxn,lh),this.procDropDown.block=this,this.appendDummyInput().appendField(w.Msg.LANG_PROCEDURES_CALLRETURN_CALL).appendField(this.procDropDown,"PROCNAME"),this.setOutput(true,null),this.setTooltip(w.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP),this.arguments_=[],this.quarkConnections_=null,this.quarkArguments_=null,this.errors=[{func:gc},{func:fc,dropDowns:["PROCNAME"]}],this.setOnChange(function(n){pc(this)}),lh.call(this.getField("PROCNAME"),this.getField("PROCNAME").getValue())},getProcedureCall:w.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:w.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters:w.Blocks.procedures_callnoreturn.setProcedureParameters,mutationToDom:w.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:w.Blocks.procedures_callnoreturn.domToMutation,renameVar:w.Blocks.procedures_callnoreturn.renameVar,procCustomContextMenu:w.Blocks.procedures_callnoreturn.procCustomContextMenu,removeProcedureValue:w.Blocks.procedures_callnoreturn.removeProcedureValue};se.javascriptGenerator.controls_for=function(s){const n=se.javascriptGenerator.nameDB_.getName(s.getFieldValue("VAR"),w.VARIABLE_CATEGORY_NAME),i=se.javascriptGenerator.valueToCode(s,"START",se.javascriptGenerator.ORDER_ASSIGNMENT)||"0",o=se.javascriptGenerator.valueToCode(s,"END",se.javascriptGenerator.ORDER_ASSIGNMENT)||"0",l=se.javascriptGenerator.valueToCode(s,"STEP",se.javascriptGenerator.ORDER_ASSIGNMENT)||"1";let g=se.javascriptGenerator.statementToCode(s,"DO");g=se.javascriptGenerator.addLoopTrap(g,s);let m;if(w.utils.string.isNumber(i)&&w.utils.string.isNumber(o)&&w.utils.string.isNumber(l)){const u=Number(i)<=Number(o);m="for (let "+n+" = "+i+"; "+n+(u?" <= ":" >= ")+o+"; "+n;const p=Math.abs(Number(l));p==1?m+=u?"++":"--":m+=(u?" += ":" -= ")+p,m+=`) {
`+g+`}
`}else{m="";let u=i;!i.match(/^\w+$/)&&!w.utils.string.isNumber(i)&&(u=se.javascriptGenerator.nameDB_.getDistinctName(n+"_start",w.VARIABLE_CATEGORY_NAME),m+="let "+u+" = "+i+`;
`);let p=o;!o.match(/^\w+$/)&&!w.utils.string.isNumber(o)&&(p=se.javascriptGenerator.nameDB_.getDistinctName(n+"_end",w.VARIABLE_CATEGORY_NAME),m+="let "+p+" = "+o+`;
`);const c=se.javascriptGenerator.nameDB_.getDistinctName(n+"_inc",w.VARIABLE_CATEGORY_NAME);m+="let "+c+" = ",w.utils.string.isNumber(l)?m+=Math.abs(l)+`;
`:m+="Math.abs("+l+`);
`,m+="if ("+u+" > "+p+`) {
`,m+=se.javascriptGenerator.INDENT+c+" = -"+c+`;
`,m+=`}
`,m+="for ("+n+" = "+u+"; "+c+" >= 0 ? "+n+" <= "+p+" : "+n+" >= "+p+"; "+n+" += "+c+`) {
`+g+`}
`}return m};se.javascriptGenerator.controls_forRange=se.javascriptGenerator.controls_for;se.javascriptGenerator.controls_forEach=function(s){const n=se.javascriptGenerator.nameDB_.getName(s.getFieldValue("VAR"),w.VARIABLE_CATEGORY_NAME),i=se.javascriptGenerator.valueToCode(s,"LIST",se.javascriptGenerator.ORDER_ASSIGNMENT)||"[]";let o=se.javascriptGenerator.statementToCode(s,"DO");o=se.javascriptGenerator.addLoopTrap(o,s);let l="",g=i;i.match(/^\w+$/)||(g=se.javascriptGenerator.nameDB_.getDistinctName(n+"_list",w.VARIABLE_CATEGORY_NAME),l+="const "+g+" = "+i+`;
`);const m=se.javascriptGenerator.nameDB_.getDistinctName(n+"_index",w.VARIABLE_CATEGORY_NAME);return o=se.javascriptGenerator.INDENT+"const "+n+" = "+g+"["+m+`];
`+o,l+="for (let "+m+" in "+g+`) {
`+o+`}
`,l};se.javascriptGenerator.procedures_callreturn=function(s){const n=se.javascriptGenerator.nameDB_.getName(s.getFieldValue("PROCNAME"),w.PROCEDURE_CATEGORY_NAME),i=[],o=s.arguments_;for(let g=0;g<o.length;g++)i[g]=se.javascriptGenerator.valueToCode(s,"ARG"+g,se.javascriptGenerator.ORDER_NONE)||"null";return[n+"("+i.join(", ")+")",se.javascriptGenerator.ORDER_FUNCTION_CALL]};se.javascriptGenerator.lexical_variable_get=function(s){return[hR(s.getFieldValue("VAR")),se.javascriptGenerator.ORDER_ATOMIC]};function hR(s){const n=cR(s),i=n[0],o=n[1];return i===w.Msg.LANG_VARIABLES_GLOBAL_PREFIX||i===tc?o:LB()(o)}function dR(s,n){const i=se.javascriptGenerator.valueToCode(s,"VALUE",se.javascriptGenerator.ORDER_ASSIGNMENT)||"0";return hR(s.getFieldValue(n))+" = "+i+`;
`}se.javascriptGenerator.lexical_variable_set=function(s){return dR(s,"VAR")};se.javascriptGenerator.global_declaration=function(s){return"var "+dR(s,"NAME")};se.javascriptGenerator.local_declaration_statement=function(){let s=`{
  let `;for(let n=0;this.getFieldValue("VAR"+n);n++)s+=""+this.getFieldValue("VAR"+n),s+=" = "+(se.javascriptGenerator.valueToCode(this,"DECL"+n,se.javascriptGenerator.ORDER_NONE)||"0"),s+=", ";return s=s.slice(0,-2),s+=`;
`,s+=se.javascriptGenerator.statementToCode(this,"STACK",se.javascriptGenerator.ORDER_NONE),s+=`}
`,s};se.javascriptGenerator.local_declaration_expression=function(){return"NOT IMPLEMENTED YET"};/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */RB();function UB(s){const n=new _i(new w.Options({scrollbars:false,rtl:s.RTL,renderer:s.options.renderer,rendererOverrides:s.options.rendererOverrides}));s.flydown_=n,w.utils.dom.insertAfter(n.createDom("g"),s.svgBubbleCanvas_),n.init(s),n.autoClose=true}const FB=`<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">\r
  <category name="程序">\r
    <category name="逻辑" colour="#5b80a5">\r
      <block type="controls_if"/>\r
      <block type="logic_compare">\r
        <field name="OP">EQ</field>\r
      </block>\r
      <block type="logic_operation">\r
        <field name="OP">AND</field>\r
      </block>\r
      <block type="logic_negate"/>\r
      <block type="logic_boolean">\r
        <field name="BOOL">TRUE</field>\r
      </block>\r
      <block type="logic_null"/>\r
      <block type="logic_ternary"/>\r
      <block type="sleep">\r
        <value name="milliseconds">\r
          <shadow type="math_number">\r
            <field name="NUM">1000</field>\r
          </shadow>\r
        </value>\r
      </block>\r
    </category>\r
    <category name="循环" colour="#5ba55b">\r
      <block type="controls_repeat_ext">\r
        <value name="TIMES">\r
          <shadow type="math_number">\r
            <field name="NUM">10</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="controls_whileUntil">\r
        <field name="MODE">WHILE</field>\r
      </block>\r
      <block type="controls_for">\r
        <field name="VAR" id="s~#wpBU?bO8qfKP2Fg54">i</field>\r
        <value name="FROM">\r
          <shadow type="math_number">\r
            <field name="NUM">1</field>\r
          </shadow>\r
        </value>\r
        <value name="TO">\r
          <shadow type="math_number">\r
            <field name="NUM">10</field>\r
          </shadow>\r
        </value>\r
        <value name="BY">\r
          <shadow type="math_number">\r
            <field name="NUM">1</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="controls_forEach">\r
        <field name="VAR" id="rciFyVTbkL=@%u!{2zW#">j</field>\r
      </block>\r
      <block type="controls_flow_statements">\r
        <field name="FLOW">BREAK</field>\r
      </block>\r
    </category>\r
    <category name="数学" colour="#5b67a5">\r
      <block type="math_number">\r
        <field name="NUM">0</field>\r
      </block>\r
      <block type="to_number"/>\r
      <block type="math_arithmetic">\r
        <field name="OP">ADD</field>\r
        <value name="A">\r
          <shadow type="math_number">\r
            <field name="NUM">1</field>\r
          </shadow>\r
        </value>\r
        <value name="B">\r
          <shadow type="math_number">\r
            <field name="NUM">1</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="math_single">\r
        <field name="OP">ROOT</field>\r
        <value name="NUM">\r
          <shadow type="math_number">\r
            <field name="NUM">9</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="math_trig">\r
        <field name="OP">SIN</field>\r
        <value name="NUM">\r
          <shadow type="math_number">\r
            <field name="NUM">45</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="math_constant">\r
        <field name="CONSTANT">PI</field>\r
      </block>\r
      <block type="math_number_property">\r
        <mutation divisor_input="false"/>\r
        <field name="PROPERTY">EVEN</field>\r
        <value name="NUMBER_TO_CHECK">\r
          <shadow type="math_number">\r
            <field name="NUM">0</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="math_round">\r
        <field name="OP">ROUND</field>\r
        <value name="NUM">\r
          <shadow type="math_number">\r
            <field name="NUM">3.1</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="math_on_list">\r
        <mutation op="SUM"/>\r
        <field name="OP">SUM</field>\r
      </block>\r
      <block type="math_modulo">\r
        <value name="DIVIDEND">\r
          <shadow type="math_number">\r
            <field name="NUM">64</field>\r
          </shadow>\r
        </value>\r
        <value name="DIVISOR">\r
          <shadow type="math_number">\r
            <field name="NUM">10</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="math_constrain">\r
        <value name="VALUE">\r
          <shadow type="math_number">\r
            <field name="NUM">50</field>\r
          </shadow>\r
        </value>\r
        <value name="LOW">\r
          <shadow type="math_number">\r
            <field name="NUM">1</field>\r
          </shadow>\r
        </value>\r
        <value name="HIGH">\r
          <shadow type="math_number">\r
            <field name="NUM">100</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="math_random_int">\r
        <value name="FROM">\r
          <shadow type="math_number">\r
            <field name="NUM">1</field>\r
          </shadow>\r
        </value>\r
        <value name="TO">\r
          <shadow type="math_number">\r
            <field name="NUM">100</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="math_random_float"/>\r
    </category>\r
    <category name="文本" colour="#5ba58c">\r
      <block type="text">\r
        <field name="TEXT"/>\r
      </block>\r
      <block type="text_join">\r
        <mutation items="2"/>\r
      </block>\r
      <block type="text_append">\r
        <field name="VAR" id="ho\`IB%Dj!ZWh5[SE\`Ag^">item</field>\r
        <value name="TEXT">\r
          <shadow type="text">\r
            <field name="TEXT"/>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="text_length">\r
        <value name="VALUE">\r
          <shadow type="text">\r
            <field name="TEXT">abc</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="text_isEmpty">\r
        <value name="VALUE">\r
          <shadow type="text">\r
            <field name="TEXT"/>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="text_indexOf">\r
        <field name="END">FIRST</field>\r
        <value name="VALUE">\r
          <block type="variables_get">\r
            <field name="VAR" id="oW~/D1yIDK![r#WDIF==">text</field>\r
          </block>\r
        </value>\r
        <value name="FIND">\r
          <shadow type="text">\r
            <field name="TEXT">abc</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="text_charAt">\r
        <mutation at="true"/>\r
        <field name="WHERE">FROM_START</field>\r
        <value name="VALUE">\r
          <block type="variables_get">\r
            <field name="VAR" id="oW~/D1yIDK![r#WDIF==">text</field>\r
          </block>\r
        </value>\r
      </block>\r
      <block type="text_getSubstring">\r
        <mutation at1="true" at2="true"/>\r
        <field name="WHERE1">FROM_START</field>\r
        <field name="WHERE2">FROM_START</field>\r
        <value name="STRING">\r
          <block type="variables_get">\r
            <field name="VAR" id="oW~/D1yIDK![r#WDIF==">text</field>\r
          </block>\r
        </value>\r
      </block>\r
      <block type="text_changeCase">\r
        <field name="CASE">UPPERCASE</field>\r
        <value name="TEXT">\r
          <shadow type="text">\r
            <field name="TEXT">abc</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="text_trim">\r
        <field name="MODE">BOTH</field>\r
        <value name="TEXT">\r
          <shadow type="text">\r
            <field name="TEXT">abc</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="regular"/>\r
      <block type="template_string"/>\r
    </category>\r
    <category name="列表" colour="#745ba5">\r
      <block type="lists_create_with">\r
        <mutation items="0"/>\r
      </block>\r
      <block type="lists_create_with">\r
        <mutation items="3"/>\r
      </block>\r
      <block type="lists_repeat">\r
        <value name="NUM">\r
          <shadow type="math_number">\r
            <field name="NUM">5</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="lists_length"/>\r
      <block type="lists_isEmpty"/>\r
      <block type="lists_indexOf">\r
        <field name="END">FIRST</field>\r
        <value name="VALUE">\r
          <block type="variables_get">\r
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>\r
          </block>\r
        </value>\r
      </block>\r
      <block type="lists_getIndex">\r
        <mutation statement="false" at="true"/>\r
        <field name="MODE">GET</field>\r
        <field name="WHERE">FROM_START</field>\r
        <value name="VALUE">\r
          <block type="variables_get">\r
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>\r
          </block>\r
        </value>\r
      </block>\r
      <block type="lists_setIndex">\r
        <mutation at="true"/>\r
        <field name="MODE">SET</field>\r
        <field name="WHERE">FROM_START</field>\r
        <value name="LIST">\r
          <block type="variables_get">\r
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>\r
          </block>\r
        </value>\r
      </block>\r
      <block type="lists_getSublist">\r
        <mutation at1="true" at2="true"/>\r
        <field name="WHERE1">FROM_START</field>\r
        <field name="WHERE2">FROM_START</field>\r
        <value name="LIST">\r
          <block type="variables_get">\r
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>\r
          </block>\r
        </value>\r
      </block>\r
      <block type="lists_split">\r
        <mutation mode="SPLIT"/>\r
        <field name="MODE">SPLIT</field>\r
        <value name="DELIM">\r
          <shadow type="text">\r
            <field name="TEXT">,</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="lists_sort">\r
        <field name="TYPE">NUMERIC</field>\r
        <field name="DIRECTION">1</field>\r
      </block>\r
    </category>\r
    <category name="变量" colour="#a55b80">\r
      <block type="global_declaration"/>\r
      <block type="lexical_variable_get"/>\r
      <block type="lexical_variable_set"/>\r
      <block type="local_declaration_statement"/>\r
    </category>\r
    <category name="对象" colour="#5b80a5">\r
      <block type="Object"/>\r
      <block type="Keys"/>\r
      <block type="text_json"/>\r
    </category>\r
    <category name="颜色" colour="#a5745b">\r
      <block type="colour_picker">\r
      <field name="COLOUR">#ff0000</field>\r
     </block>\r
     <block type="colour_random"></block>\r
     <block type="colour_rgb">\r
      <value name="RED">\r
        <shadow type="math_number">\r
          <field name="NUM">100</field>\r
        </shadow>\r
      </value>\r
      <value name="GREEN">\r
        <shadow type="math_number">\r
          <field name="NUM">50</field>\r
        </shadow>\r
      </value>\r
      <value name="BLUE">\r
        <shadow type="math_number">\r
          <field name="NUM">0</field>\r
        </shadow>\r
      </value>\r
     </block>\r
     <block type="colour_blend">\r
      <value name="COLOUR1">\r
        <shadow type="colour_picker">\r
          <field name="COLOUR">#ff0000</field>\r
        </shadow>\r
      </value>\r
      <value name="COLOUR2">\r
        <shadow type="colour_picker">\r
          <field name="COLOUR">#3333ff</field>\r
        </shadow>\r
      </value>\r
      <value name="RATIO">\r
        <shadow type="math_number">\r
          <field name="NUM">0.5</field>\r
        </shadow>\r
      </value>\r
     </block>\r
    </category>\r
    <category name="函数" colour="#995ba5" custom="PROCEDURE"/>\r
  </category>\r
  <sep/>\r
  <category name="机器人">\r
    <category name="事件" colour="#5b80a5">\r
      <block type="middleware">\r
        <field name="NAME" id="j{f?,R~uQ{$}[B@0sUIA">item</field>\r
      </block>\r
      <block type="command"/>\r
      <block type="plugin_apply"/>\r
      <block type="on_message_event"/>\r
      <block type="on_guild_member_event"/>\r
      <block type="on_guild_event"/>\r
    </category>\r
    <category name="会话" colour="#5b80a5">\r
      <block type="get_argument"/>\r
      <block type="session_message"/>\r
      <block type="session_message_id"/>\r
      <block type="session_user_id"/>\r
      <block type="session_guild_id"/>\r
      <block type="session_channel_id"/>\r
      <block type="session_bot"/>\r
      <block type="session_elements"/>\r
      <block type="break_middleware"/>\r
      <block type="at_id"/>\r
      <block type="at_name"/>\r
      <block type="group_name"/>\r
      <block type="group_id"/>\r
    </category>\r
    <category name="消息" colour="#5b80a5">\r
      <block type="send_session_message"/>\r
      <block type="return_message"/>\r
      <block type="broadcast">\r
        <value name = "NAME">\r
          <shadow type="lists_create_with">\r
            <mutation items="0"/>\r
          </shadow>\r
        </value>\r
        <value name = "NAME1">\r
          <shadow type="text"/>\r
        </value>\r
      </block>\r
    </category>\r
    <category name="消息元素" colour="#5b80a5">\r
      <block type="segment_at">\r
        <value name="user">\r
          <shadow type="session_user_id"/>\r
        </value>\r
      </block>\r
      <block type="segment_image">\r
        <value name="image">\r
          <shadow type="text">\r
            <field name="TEXT">https://koishi.chat/logo.png</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="segment_audio">\r
        <value name="audio">\r
          <shadow type="text">\r
            <field name="TEXT">https://example.org/example.mp3</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="segment_video">\r
      <value name="video">\r
        <shadow type="text">\r
          <field name="TEXT">https://example.org/example.mp4</field>\r
        </shadow>\r
      </value>\r
      </block>\r
        <block type="parse_segment_list">\r
        <value name="segments">\r
          <shadow type="session_elements"/>\r
        </value>\r
      </block>\r
      <block type="current_segment"/>\r
    </category>\r
    <category name="数据" colour="#5b80a5">\r
      <block type="http_get">\r
        <value name="url">\r
          <shadow type="text">\r
            <field name="TEXT">https://koishi.chat/</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="json_path_parse"/>\r
      <block type="key_value_write">\r
        <value name="scope_id">\r
          <shadow type="plugin_id"/>\r
        </value>\r
        <value name="key">\r
          <shadow type="text">\r
            <field name="TEXT">键值对键</field>\r
          </shadow>\r
        </value>\r
\r
        <value name="value">\r
          <shadow type="text">\r
            <field name="TEXT">写入值</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="key_value_read">\r
        <value name="scope_id">\r
          <shadow type="plugin_id"/>\r
        </value>\r
        <value name="key">\r
          <shadow type="text">\r
            <field name="TEXT">键值对键</field>\r
          </shadow>\r
        </value>\r
      </block>\r
      <block type="test">\r
       <value name = "WENJAN">\r
         <shadow type="text">\r
           <field name="TEXT">C:\\</field>\r
         </shadow>\r
       </value>\r
       <value name = "NAME1">\r
         <shadow type="lists_create_with">\r
           <mutation items="0"/>\r
         </shadow>\r
       </value>\r
      </block>\r
    </category>\r
    <category name="机器人操作" colour="#5b80a5">\r
      <block type="delete_message">\r
        <value name="bot">\r
          <shadow type="session_bot"/>\r
        </value>\r
        <value name="channel_id">\r
          <shadow type="session_channel_id"/>\r
        </value>\r
        <value name="message_id">\r
          <shadow type="session_message_id"/>\r
        </value>\r
      </block>\r
      <block type="mute_user">\r
        <value name="bot">\r
          <shadow type="session_bot"/>\r
        </value>\r
        <value name="guild_id">\r
          <shadow type="session_guild_id"/>\r
        </value>\r
        <value name="user_id">\r
          <shadow type="session_user_id"/>\r
        </value>\r
        <value name="time">\r
          <shadow type="math_number">\r
            <field name="NUM">60000</field>\r
          </shadow>\r
        </value>\r
      </block>\r
    </category>\r
    <category name="调试" colour="#5b80a5">\r
      <block type="logging">\r
        <value name = "log">\r
          <shadow type="text">\r
            <field name="TEXT">Hello,world</field>\r
          </shadow>\r
        </value>\r
      </block>\r
    </category>\r
    <category name="环境" colour="#5b80a5">\r
      <block type="time_stamp"/>\r
      <block type="time_format">\r
        <value name = "date">\r
          <shadow type="time_stamp"></shadow>\r
        </value>\r
      </block>\r
      <block type="plugin_id"/>\r
    </category>\r
  </category>\r
  <sep/>\r
  <category name="绘画">\r
   <category name="canvas" colour="#5b80a5">\r
\r
   </category>\r
   <category name="html" colour="#5b80a5">\r
    <block type="pptr">\r
      <value name = "NAME">\r
        <shadow type="text">\r
          <field name="TEXT">&#60;html&#62; &#60;/html&#62;</field>\r
        </shadow>\r
      </value>\r
    </block>\r
   </category>\r
  </category>\r
  <sep/>\r
  <category name="空白块" colour="#5b80a5">\r
    <block type="null"/>\r
    <block type="null1"/>\r
    <block type="null2"/>\r
    <block type="import"/>\r
    <block type="export_const"/>\r
  </category>\r
  <category name="未分类" colour="#5b80a5">\r
    <block type="pptr">\r
      <value name = "NAME">\r
        <shadow type="text">\r
          <field name="TEXT">&#60;html&#62; &#60;/html&#62;</field>\r
        </shadow>\r
      </value>\r
    </block>\r
    <block type="zhiling">\r
      <value name = "NAME">\r
        <shadow type="text">\r
          <field name="TEXT">help</field>\r
        </shadow>\r
      </value>\r
    </block>\r
    <block type="fetchDataFromUrl">\r
      <value name = "NAME1">\r
        <shadow type="text">\r
          <field name="TEXT">https://koishi.chat/logo.png</field>\r
        </shadow>\r
      </value>\r
    </block>\r
    <block type="toString"/>\r
    <block type="MD5"/>\r
    <block type="buffer_from"/>\r
    <block type="http_post"/>\r
    <block type="session_prompt">\r
      <value name="time">\r
          <shadow type="math_number">\r
            <field name="NUM">6000</field>\r
          </shadow>\r
      </value>\r
    </block>\r
    <block  type="bot_sendmessage"/>\r
  </category>\r
</xml>\r
`,GB={type:"http_get",message0:"发送简单HTTP GET请求 %1 网址 %2 返回类型 %3",args0:[{type:"input_dummy"},{type:"input_value",name:"url"},{type:"field_dropdown",name:"response_type",options:[["默认类型",""],["JSON对象类型","json"],["文本类型","text"]]}],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function HB(s){let n=se.javascriptGenerator.valueToCode(s,"url",se.javascriptGenerator.ORDER_ATOMIC),i=s.getFieldValue("response_type");return[`await ctx.http.get(${n},{responseType:"${i}"})`,se.javascriptGenerator.ORDER_NONE]}const VB={type:"http_post",message0:"发送简单HTTP Post请求 %1 网址 %2 参数 %3 返回类型 %4",args0:[{type:"input_dummy"},{type:"input_value",name:"url"},{type:"input_value",name:"data"},{type:"field_dropdown",name:"response_type",options:[["默认类型",""],["JSON对象类型","json"],["文本类型","text"]]}],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function WB(s){let n=se.javascriptGenerator.valueToCode(s,"url",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"data",se.javascriptGenerator.ORDER_ATOMIC),o=s.getFieldValue("response_type");return[`await ctx.http.post(${n},${i},{responseType:"${o}"})`,se.javascriptGenerator.ORDER_NONE]}const zB={type:"json_path_parse",message0:"解析JSON对象 %1 JSONPath %2",args0:[{type:"input_value",name:"value"},{type:"field_input",name:"path",text:"$"}],inputsInline:false,imports:{"jsonpath-plus":["JSONPath as parseJson"]},output:null,colour:230,tooltip:"",helpUrl:""};function jB(s){let n=se.javascriptGenerator.valueToCode(s,"value",se.javascriptGenerator.ORDER_ATOMIC);return[`await parseJson({path: "${s.getFieldValue("path")}", json: ${n}})`,se.javascriptGenerator.ORDER_NONE]}const XB={type:"key_value_write",message0:"写入键值对 作用域ID %1 键 %2 值 %3",args0:[{type:"input_value",name:"scope_id"},{type:"input_value",name:"key"},{type:"input_value",name:"value",align:"RIGHT"}],template:["key_value_initialize"],inputsInline:false,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function KB(s){let n=se.javascriptGenerator.valueToCode(s,"key",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"value",se.javascriptGenerator.ORDER_ATOMIC),o=se.javascriptGenerator.valueToCode(s,"scope_id",se.javascriptGenerator.ORDER_ATOMIC);return o.length&&(o+='+"."+'),`await ctx.database.upsert('blockly_key_value',[{key:${o}${n},value:${i}}],['key'])
`}const YB={type:"key_value_read",message0:"读取键值对 作用域ID %1 键 %2",args0:[{type:"input_value",name:"scope_id"},{type:"input_value",name:"key"}],template:["key_value_initialize"],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function qB(s){let n=se.javascriptGenerator.valueToCode(s,"key",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"scope_id",se.javascriptGenerator.ORDER_ATOMIC);return i.length&&(i+='+"."+'),[`(await ctx.database.get('blockly_key_value',{key:${i}${n}}))[0]?.value`,se.javascriptGenerator.ORDER_NONE]}const JB=[GB,zB,XB,YB,VB],ZB={http_get:HB,json_path_parse:jB,key_value_write:KB,key_value_read:qB,http_post:WB},QB={type:"parameter_list",message0:"参数列表 %1",args0:[{type:"input_statement",name:"parameter_list",check:"Parameter"}],colour:230,tooltip:"",helpUrl:""},eP={type:"any_parameter",message0:"任何类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},tP={type:"string_parameter",message0:"字符串类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},sP={type:"number_parameter",message0:"数字类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},iP={type:"int_parameter",message0:"整数类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},nP={type:"boolean_parameter",message0:"布尔类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},rP={type:"posint_parameter",message0:"正整数类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},oP={type:"text_parameter",message0:"长文本类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},aP=[QB,eP,tP,sP,iP,nP,rP,oP],lP={type:"get_argument",message0:"第 %1 个参数",args0:[{type:"field_number",name:"id",value:0}],output:"String",extensions:["argument_consumer"],colour:230,tooltip:"",helpUrl:""};function cP(s){return[`args[${s.getFieldValue("id")}]`,se.javascriptGenerator.ORDER_NONE]}const uP={type:"break_middleware",message0:"终止后续逻辑执行",previousStatement:null,extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function hP(){return`return null;
`}const dP={type:"session_message",message0:"发送消息的内容",extensions:["session_consumer"],output:"String",colour:230,tooltip:"",helpUrl:""};function _P(){return["session.content",se.javascriptGenerator.ORDER_NONE]}const pP={type:"session_user_id",message0:"发送消息用户的平台用户ID",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function gP(){return["session.userId",se.javascriptGenerator.ORDER_NONE]}const fP={type:"session_bot",message0:"收到消息的机器人对象",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function mP(){return["session.bot",se.javascriptGenerator.ORDER_NONE]}const EP={type:"session_guild_id",message0:"消息来自的群组编号",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function vP(){return["session.channelId",se.javascriptGenerator.ORDER_NONE]}const bP={type:"session_channel_id",message0:"消息来自的频道编号(群号)",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function TP(){return["session.guildId",se.javascriptGenerator.ORDER_NONE]}const SP={type:"session_message_id",message0:"消息编号",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function $P(){return["session.messageId",se.javascriptGenerator.ORDER_NONE]}const yP={type:"session_elements",message0:"当前消息的消息元素列表",output:"Array",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function RP(){return["session.elements",se.javascriptGenerator.ORDER_NONE]}const IP=[lP,uP,dP,pP,bP,EP,SP,fP,yP],CP={get_argument:cP,break_middleware:hP,session_message:_P,session_user_id:gP,session_channel_id:vP,session_guild_id:TP,session_message_id:$P,session_bot:mP,session_elements:RP},OP={type:"delete_message",message0:"撤回消息 %1 机器人对象 %2 消息ID %3 频道ID %4",args0:[{type:"input_dummy"},{type:"input_value",name:"bot"},{type:"input_value",name:"message_id"},{type:"input_value",name:"channel_id"}],inputsInline:false,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function kP(s){let n=se.javascriptGenerator.valueToCode(s,"bot",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"message_id",se.javascriptGenerator.ORDER_ATOMIC),o=se.javascriptGenerator.valueToCode(s,"channel_id",se.javascriptGenerator.ORDER_ATOMIC);return`await ${n}.deleteMessage(${o},${i});
`}const wP={type:"mute_user",message0:"禁言用户 %1 机器人对象 %2 用户ID %3 群组ID %4 禁言时间(毫秒) %5",args0:[{type:"input_dummy"},{type:"input_value",name:"bot"},{type:"input_value",name:"user_id"},{type:"input_value",name:"guild_id"},{type:"input_value",name:"time"}],inputsInline:false,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function AP(s){let n=se.javascriptGenerator.valueToCode(s,"bot",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"user_id",se.javascriptGenerator.ORDER_ATOMIC),o=se.javascriptGenerator.valueToCode(s,"guild_id",se.javascriptGenerator.ORDER_ATOMIC),l=se.javascriptGenerator.valueToCode(s,"time",se.javascriptGenerator.ORDER_ATOMIC);return`await ${n}.muteGuildMember(${o},${i},${l});
`}const LP=[OP,wP],NP={delete_message:kP,mute_user:AP},MP={type:"logging",message0:"输出一个 %1 级别的日志 %2",args0:[{type:"field_dropdown",name:"level",options:[["调试","debug"],["提示","info"],["警告","warn"],["成功","success"],["错误","error"]]},{type:"input_value",name:"log"}],template:["logger_initialize"],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},DP=function(s){var n=s.getFieldValue("level"),i=se.javascriptGenerator.valueToCode(s,"log",se.javascriptGenerator.ORDER_ATOMIC);return`logger.${n}(${i});
`},xP=[MP],BP={logging:DP},PP={type:"middleware",message0:"当接受到聊天消息 %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"callback"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""};function UP(s){return`ctx.middleware(async (session,next)=>{
${se.javascriptGenerator.statementToCode(s,"callback")}  return next();
})`}const FP={type:"on_message_event",message0:"当消息 %1 %2 运行 %3",args0:[{type:"field_dropdown",name:"event_name",options:[["被删除(撤回)","message-deleted"],["消息被修改","message-updated"],["被机器人发送","send"]]},{type:"input_dummy"},{type:"input_statement",name:"listener"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""},GP={type:"on_guild_member_event",message0:"当群组成员 %1 %2 运行 %3",args0:[{type:"field_dropdown",name:"event_name",options:[["加入","guild-member-added"],["退出/踢出","guild-member-deleted"],["申请加入","guild-member-request"]]},{type:"input_dummy"},{type:"input_statement",name:"listener"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""},HP={type:"on_guild_event",message0:"当你的机器人 %1 群组 %2 运行 %3",args0:[{type:"field_dropdown",name:"event_name",options:[["加入","guild-added"],["退出/被踢出","guild-deleted"],["被邀请到一个","guild-request"]]},{type:"input_dummy"},{type:"input_statement",name:"listener"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""};function bg(s){var n=s.getFieldValue("event_name"),i=se.javascriptGenerator.statementToCode(s,"listener");return`ctx.on('${n}',async (session)=>{
${i}
})`}const VP={type:"plugin_apply",message0:"当启用插件时 %1 执行 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"apply"}],inputsInline:false,colour:230,tooltip:"",helpUrl:""};function WP(s){return se.javascriptGenerator.statementToCode(s,"apply")}const zP={type:"command",message0:"创建一个新的指令 %1 %2 调用函数 %3",args0:[{type:"field_input",name:"name",text:"指令名称"},{type:"input_dummy"},{type:"input_statement",name:"action"}],mutator:"parameter_list",extensions:["session_provider","argument_provider"],colour:230,tooltip:"",helpUrl:""};function jP(s){var p;let n=s.getFieldValue("name"),i=s.parameters??[],o=se.javascriptGenerator.statementToCode(s,"action");console.info(s.workspace.meta);let l=((p=s.workspace.meta.commands)==null?void 0:p[n])??{},g=l.description?`,\`${l.description.replace(`
`,"\\n")}\``:"";l.description&&delete l.description;let m=l&&Object.keys(l).length>0?`,${JSON.stringify(l)}`:"";return`ctx.command('${(n+" "+i.map(c=>{const{required:d,name:_,type:b}=c;return(d?"<":"[")+_+(b!="any_parameter"?":"+b.split("_")[0]:"")+(d?">":"]")}).join(" ")).trim()}'${g}${m}).action(async ({session},...args)=>{
${o}
});
`}const XP=[PP,FP,GP,HP,VP,zP],KP={middleware:UP,command:jP,plugin_apply:WP,on_message_event:bg,on_guild_member_event:bg,on_guild_event:bg},YP={type:"time_stamp",message0:"%1 时间戳",args0:[{type:"field_dropdown",name:"type",options:[["13位","13"],["11位","11"]]}],output:null,colour:230,tooltip:"",helpUrl:""};function qP(s){return[`Math.round(new Date() ${s.getFieldValue("type")==="11"?" / 1000":""})`,se.javascriptGenerator.ORDER_NONE]}const JP={type:"time_format",message0:"日期时间格式 %1 13位时间戳 %2",args0:[{type:"field_input",name:"fmt",text:"yyyy-MM-dd hh:mm:ss"},{type:"input_value",name:"date"}],output:null,imports:{koishi:["Time"]},colour:230,tooltip:"",helpUrl:""};function ZP(s){var n=se.javascriptGenerator.valueToCode(s,"date",se.javascriptGenerator.ORDER_ATOMIC),i=s.getFieldValue("fmt");return[`Time.template('${i}',new Date(${n}))`,se.javascriptGenerator.ORDER_NONE]}const QP={type:"plugin_id",message0:"当前插件ID",output:null,colour:230,tooltip:"",template:["plugin_id"],helpUrl:""};function e2(s){return["plugin_id",se.javascriptGenerator.ORDER_NONE]}const t2=[YP,JP,QP],s2={time_stamp:qP,time_format:ZP,plugin_id:e2},i2="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIiBmaWxsPSJ3aGl0ZSI+CiAgICA8cGF0aCBkPSJNMTg0IDE2MEMxOTMuNSAxNjAgMjAyLjEgMTY1LjYgMjA1LjkgMTc0LjNMMjY5LjkgMzE4LjNDMjc1LjMgMzMwLjQgMjY5LjkgMzQ0LjUgMjU3LjcgMzQ5LjlDMjQ1LjYgMzU1LjMgMjMxLjUgMzQ5LjkgMjI2LjEgMzM3LjdMMjIxLjcgMzI4SDE0Ni4zTDE0MS45IDMzNy43QzEzNi41IDM0OS45IDEyMi40IDM1NS4zIDExMC4zIDM0OS45Qzk4LjE0IDM0NC41IDkyLjY5IDMzMC40IDk4LjA3IDMxOC4zTDE2Mi4xIDE3NC4zQzE2NS45IDE2NS42IDE3NC41IDE2MCAxODQgMTYwSDE4NHpNMTY3LjYgMjgwSDIwMC40TDE4NCAyNDMuMUwxNjcuNiAyODB6TTMwNCAxODRDMzA0IDE3MC43IDMxNC43IDE2MCAzMjggMTYwSDM4MEM0MTMuMSAxNjAgNDQwIDE4Ni45IDQ0MCAyMjBDNDQwIDIyOS4yIDQzNy45IDIzNy45IDQzNC4yIDI0NS43QzQ0Ny41IDI1Ni43IDQ1NiAyNzMuNCA0NTYgMjkyQzQ1NiAzMjUuMSA0MjkuMSAzNTIgMzk2IDM1MkgzMjhDMzE0LjcgMzUyIDMwNCAzNDEuMyAzMDQgMzI4VjE4NHpNMzUyIDIwOFYyMzJIMzgwQzM4Ni42IDIzMiAzOTIgMjI2LjYgMzkyIDIyMEMzOTIgMjEzLjQgMzg2LjYgMjA4IDM4MCAyMDhIMzUyek0zNTIgMzA0SDM5NkM0MDIuNiAzMDQgNDA4IDI5OC42IDQwOCAyOTJDNDA4IDI4NS40IDQwMi42IDI4MCAzOTYgMjgwSDM1MlYzMDR6TTAgMTI4QzAgOTIuNjUgMjguNjUgNjQgNjQgNjRINTc2QzYxMS4zIDY0IDY0MCA5Mi42NSA2NDAgMTI4VjM4NEM2NDAgNDE5LjMgNjExLjMgNDQ4IDU3NiA0NDhINjRDMjguNjUgNDQ4IDAgNDE5LjMgMCAzODRWMTI4ek02NCAzODRINTc2VjEyOEg2NFYzODR6Ii8+Cjwvc3ZnPg==",n2={type:"regular",message0:"正则表达式 %1 %2",args0:[{type:"field_input",name:"regular",text:"/.*/g"},{type:"input_value",name:"str"}],output:null,colour:160,tooltip:"",helpUrl:""};function r2(s){let n=s.getFieldValue("regular"),i=se.javascriptGenerator.valueToCode(s,"str",se.javascriptGenerator.ORDER_ATOMIC),o=n==null?void 0:n.match("/(.*)/([gmiyusd]*)");return[`(${i}).match(new RegExp("${o[1]}", "${o[2]}"))`,se.javascriptGenerator.ORDER_ATOMIC]}const o2={type:"template_string",message0:"%1 模板字符串",args0:[{type:"field_image",name:"edit_template",src:i2,alt:"编辑模板",width:25,height:25}],output:null,colour:160,init(){this.loadSlotsWithTemplate=function(){this.inputList.filter(s=>s.name.startsWith("input_")).forEach(s=>this.removeInput(s.name)),this.text_template&&this.text_template.variables.forEach(s=>{this.appendValueInput(`input_${s}`).appendField(s)})},this.getField("edit_template").setOnClickHandler(async s=>{const n=s.getSourceBlock().workspace;this.text_template=await n.topLevel.openDialog("text-template",this.text_template??{variables:[]}),console.info(this.text_template),this.loadSlotsWithTemplate()}),this.saveExtraState=function(){return{template:this.text_template}},this.loadExtraState=function(s){this.text_template=s.template,this.loadSlotsWithTemplate()}}};function a2(s){if(!s.text_template)return['""',se.javascriptGenerator.ORDER_ATOMIC];const n=s.text_template.variables,i=n.map(l=>se.javascriptGenerator.valueToCode(s,`input_${l}`,se.javascriptGenerator.ORDER_ATOMIC));return[`\`${s.text_template.template.replace(/\$\{([^}]+)\}/g,(l,g)=>`\${${i[n.indexOf(g)]}}`).replaceAll(`
`,"\\n").replaceAll("`","\\`")}\``,se.javascriptGenerator.ORDER_ATOMIC]}const l2=[o2,n2],c2={regular:r2,template_string:a2},u2={type:"sleep",message0:"等待 %1 毫秒",args0:[{type:"input_value",name:"milliseconds",check:["Number"]}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function h2(s){return`await new Promise(resolve => ctx.setTimeout(resolve, ${se.javascriptGenerator.valueToCode(s,"milliseconds",se.javascriptGenerator.ORDER_ATOMIC)}));
`}const d2=[u2],_2={sleep:h2},p2={type:"send_session_message",message0:"发送消息给事件发送者 %1",args0:[{type:"input_value",name:"content",check:["Boolean","String"]}],previousStatement:null,nextStatement:null,extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function g2(s){return`await session.send(${se.javascriptGenerator.valueToCode(s,"content",se.javascriptGenerator.ORDER_ATOMIC)});
`}const f2={type:"broadcast",message0:"广播 %1 群聊列表 %2 消息内容 %3",args0:[{type:"input_dummy"},{type:"input_value",name:"NAME"},{type:"input_value",name:"NAME1",align:"RIGHT"}],previousStatement:null,nextStatement:null,colour:230,tooltip:"发送广播消息到指定群聊",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function m2(s){let n=se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"NAME1",se.javascriptGenerator.ORDER_ATOMIC);return`await session.bot.broadcast(${n}, ${i});
`}const E2={type:"return_message",message0:"终止后续逻辑并发送消息 %1",args0:[{type:"input_value",name:"content",check:["Boolean","String"]}],previousStatement:null,extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function v2(s){return`return ${se.javascriptGenerator.valueToCode(s,"content",se.javascriptGenerator.ORDER_ATOMIC)};
`}const b2={type:"bot_sendmessage",message0:"发送消息给事件发送者并返回消息id %1",args0:[{type:"input_value",name:"NAME"}],output:null,colour:230,tooltip:"",helpUrl:""};function T2(s){return[`await bot.sendMessage(session.channelId , ${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const S2={type:"session_prompt",message0:"等待输入消息 %1 等待时间 %2",args0:[{type:"input_dummy"},{type:"input_value",name:"time",align:"RIGHT"}],output:null,colour:230,tooltip:"等待用户输入，返回输入文本。若超时未输入返回未定义undefined",helpUrl:""};function $2(s){return[`await session.prompt (${se.javascriptGenerator.valueToCode(s,"time",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const y2=[p2,E2,f2,S2,b2],R2={send_session_message:g2,return_message:v2,broadcast:m2,session_prompt:$2,bot_sendmessage:T2},I2={type:"segment_at",message0:"@ %1",args0:[{type:"input_value",name:"user",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function C2(s){return[`h('at',{ id: ${se.javascriptGenerator.valueToCode(s,"user",se.javascriptGenerator.ORDER_ATOMIC)} })`,se.javascriptGenerator.ORDER_NONE]}const O2={type:"segment_image",message0:"图片 %1",args0:[{type:"input_value",name:"image",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function k2(s){return[`h('image',{ url: ${se.javascriptGenerator.valueToCode(s,"image",se.javascriptGenerator.ORDER_ATOMIC)} })`,se.javascriptGenerator.ORDER_NONE]}const w2={type:"segment_audio",message0:"语音 %1",args0:[{type:"input_value",name:"audio",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function A2(s){return[`h('audio',{ url: ${se.javascriptGenerator.valueToCode(s,"audio",se.javascriptGenerator.ORDER_ATOMIC)} })`,se.javascriptGenerator.ORDER_NONE]}const L2={type:"segment_video",message0:"视频 %1",args0:[{type:"input_value",name:"video",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function N2(s){return[`h('video',{ url: ${se.javascriptGenerator.valueToCode(s,"video",se.javascriptGenerator.ORDER_ATOMIC)} })`,se.javascriptGenerator.ORDER_NONE]}const M2={type:"parse_segment_list",message0:"解析消息元素列表 %1 对每个元素按顺序执行:",args0:[{type:"input_value",name:"segments"}],colour:230,tooltip:"",helpUrl:"",inputsInline:false,mutator:"segment_parser",previousStatement:null,nextStatement:null};function D2(s){let n=se.javascriptGenerator.valueToCode(s,"segments",se.javascriptGenerator.ORDER_ATOMIC),i=s.inputList.filter(g=>g.name.startsWith("branch_type_")).map(g=>g.name.substring(12)),o=Object.fromEntries(i.map(g=>[g,s.getFieldValue(`branch_type_${g}_selector`)])),l=Object.fromEntries(i.map(g=>[g,se.javascriptGenerator.statementToCode(s,`branch_action_${g}`,se.javascriptGenerator.ORDER_ATOMIC)]));return`for(let current_segment of ${n}){
  switch(segment.type){
    ${Object.entries(o).map(([g,m])=>`case '${m}':
      ${l[g]}
        break;`).join(`
`)}
  }
}`}const x2={type:"current_segment",message0:"当前指向的消息元素",output:null,colour:230,tooltip:""};function B2(s){return["current_segment",se.javascriptGenerator.ORDER_NONE]}const P2=[I2,O2,w2,L2,M2,x2],U2={segment_at:C2,segment_image:k2,segment_audio:A2,segment_video:N2,parse_segment_list:D2,current_segment:B2},F2={type:"to_number",message0:"转换为数字 %1",args0:[{type:"input_value",name:"value"}],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function G2(s){return[`Number(${se.javascriptGenerator.valueToCode(s,"value",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_ATOMIC]}const H2=[F2],V2={to_number:G2};class yh extends w.FieldDropdown{constructor(n){super(w.Field.SKIP_SETUP),this.targets=n,this.trace=Symbol("Dropdown Tracing"),this.menuGenerator_=yh.generateBindingMenu,n.forEach(i=>{this.traceReactive(i)}),n.addWatcher((i,o,l)=>{l==="add"?this.traceReactive(o):this.detachReactive(o)})}static generateBindingMenu(){return Array.from(this.targets).map(n=>[n.value,n.identifier])}traceReactive(n){n[this.trace]||(n[this.trace]=n.addWatcher(i=>{this.value_==n.identifier&&(this.value_=n.identifier,this.doValueUpdate_(n.identifier),this.forceRerender())}))}detachReactive(n){n[this.trace]&&(n.removeWatcher(n[this.trace]),this.value_==n.identifier&&(this.value_=void 0,this.forceRerender()),delete n[this.trace])}dispose(){this.targets.forEach(n=>{this.detachReactive(n)}),super.dispose()}getDisplayText_(){var n;return((n=this.menuGenerator_().find(i=>i[1]==this.value_))==null?void 0:n[0])??""}doClassValidation_(n){return n}getOptions(n){return this.menuGenerator_().length==0?[]:super.getOptions(n)}}class W2{constructor(n,i){this.value=n,this.identifier=i,this.watcher=new Set}set(n){this.value=n,this.watcher.forEach(i=>i(n))}addWatcher(n){return this.watcher.add(n),n}removeWatcher(n){this.watcher.delete(n)}}class z2 extends Set{constructor(){super(),this.watcher=new Set}add(n){return this.watcher.forEach(i=>i(this,n,"add")),super.add(n)}delete(n){return this.watcher.forEach(i=>i(this,n,"remove")),super.delete(n)}addWatcher(n){this.watcher.add(n)}removeWatcher(n){this.watcher.delete(n)}}const j2={type:"type_root",message0:"类型 %1",args0:[{type:"input_value",name:"type",check:"Type"}],colour:"#ce4bc9",tooltip:"",helpUrl:""},X2={type:"type_definition",message0:"定义类型 %1 %2",args0:[{type:"field_input",name:"name",text:"类型名称"},{type:"input_value",name:"type",check:"Type"}],colour:"#ce4bc9",tooltip:"",helpUrl:"",init(){if(!this.workspace.typings)return;this.type_value=new W2(this.getFieldValue("name"),this.id),this.workspace.typings.add(this.type_value),this.onchange=()=>{this.type_value.set(this.getFieldValue("name"))};const s=this.dispose;this.dispose=n=>{this.workspace.typings.delete(this.type_value),s.bind(this)(n)}}},K2={type:"type_any",message0:"任意类型",output:"Type",colour:"#ce4bc9",tooltip:""},Y2={type:"type_never",message0:"永远不会出现的类型",output:"Type",colour:"#ce4bc9",tooltip:""},q2={type:"type_string",message0:"字符串",output:"Type",colour:"#ce4bc9",tooltip:""},J2={type:"type_number",message0:"数字",output:"Type",colour:"#ce4bc9",tooltip:""},Z2={type:"type_boolean",message0:"布尔值",output:"Type",colour:"#ce4bc9",tooltip:""},Q2={type:"type_array",message0:"由%1组成的数组",args0:[{type:"input_value",name:"type",check:"Type"}],output:"Type",colour:"#ce4bc9"},eU={type:"type_union_root",message0:"联合类型 %1",args0:[{type:"input_statement",name:"types",check:"Type"}]},tU={type:"type_union_entity",message0:"项目",previousStatement:"Type",nextStatement:"Type",colour:160},sU={type:"type_union",output:"Type",message0:"联合类型",args0:[],init(){this.updateShape_()},mutator:"union_mutator",colour:"#ce4bc9"},iU={type:"type_object_root",message0:"对象 %1",args0:[{type:"input_statement",name:"properties",check:"Type"}],colour:"#ce4bc9",tooltip:"",helpUrl:""},nU={type:"type_object_entity",message0:"属性 %1",args0:[{type:"field_input",name:"name",text:"属性名称"}],previousStatement:"Type",nextStatement:"Type",colour:160},rU={type:"type_object",message0:"对象",output:"Type",colour:"#ce4bc9",tooltip:"",helpUrl:"",mutator:"object_mutator"},oU={type:"type_getter",message0:"类型",output:"Type",colour:"#ce4bc9",tooltip:"",helpUrl:"",init(){let s;this.workspace.typings&&(s=new yh(this.workspace.typings),this.inputList[0].appendField(s,"type"))}},aU=[j2,K2,Y2,q2,J2,Z2,Q2,eU,tU,sU,X2,iU,nU,rU,oU],lU={type:"null",message0:"%1",args0:[{type:"field_input",name:"NAME",text:"空白"}],colour:230,tooltip:"啊，没有提示",helpUrl:""};function cU(s){return`${s.getFieldValue("NAME")};
`}const uU={type:"null1",message0:"%1",args0:[{type:"field_input",name:"NAME",text:"空白"}],previousStatement:null,nextStatement:null,colour:230,tooltip:"啊，没有提示",helpUrl:""};function hU(s){return`${s.getFieldValue("NAME")};
`}const dU={type:"null2",message0:"%1",args0:[{type:"field_input",name:"NAME",text:"空白"}],output:null,colour:230,tooltip:"",helpUrl:""};function _U(s){return[`${s.getFieldValue("NAME")}`,se.javascriptGenerator.ORDER_NONE]}const pU=[lU,uU,dU],gU={null:cU,null1:hU,null2:_U},fU={type:"import",message0:'import { %1 } from " %2 "',args0:[{type:"field_input",name:"NAME",text:"a"},{type:"field_input",name:"NAME1",text:"b"}],colour:330,tooltip:"",helpUrl:""};function mU(s){let n=s.getFieldValue("NAME"),i=s.getFieldValue("NAME1");return`import {${n}} from "${i}"`}const EU={type:"export_const",message0:"export const %1 = %2 ",args0:[{type:"field_input",name:"NAME",text:"inject"},{type:"field_input",name:"NAME1",text:"{}"}],colour:330,tooltip:"",helpUrl:""};function vU(s){let n=s.getFieldValue("NAME"),i=s.getFieldValue("NAME1");return`export const ${n} = ${i}`}const bU=[fU,EU],TU={import:mU,export_const:vU},SU={type:"at_id",message0:"解析消息，获取第一个@的id",output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function $U(s){return["session.elements.filter((element) => element.type == 'at')?.[0].attrs.id",se.javascriptGenerator.ORDER_NONE]}const yU={type:"at_name",message0:"解析消息，获取第一个@的昵称",output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function RU(s){return["session.elements.filter((element) => element.type == 'at')?.[0].attrs.name",se.javascriptGenerator.ORDER_NONE]}const IU={type:"group_name",message0:"获取群聊名称",output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function CU(s){return["session.event.guild.name",se.javascriptGenerator.ORDER_NONE]}const OU={type:"group_id",message0:"获取群聊id",output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function kU(s){return["session.event.guild.id",se.javascriptGenerator.ORDER_NONE]}const wU=[SU,yU,IU,OU],AU={at_id:$U,at_name:RU,group_name:CU,group_id:kU},LU={type:"pptr",message0:"渲染html %1",args0:[{type:"input_value",name:"NAME"}],output:null,imports:{"koishi-plugin-puppeteer":[]},injects:{required:["puppeteer"]},template:["pptr"],colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6244"};function NU(s){return[`await ctx.puppeteer.render (${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const MU=[LU],DU={pptr:NU},xU={type:"test",message0:"返回文件列表     输入路经 %1 文件后缀列表 %2",args0:[{type:"input_value",name:"WENJAN"},{type:"input_value",name:"NAME1"}],inputsInline:false,output:null,template:["test"],colour:225,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function BU(s){let n=se.javascriptGenerator.valueToCode(s,"WENJAN",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"NAME1",se.javascriptGenerator.ORDER_ATOMIC);return[`getFiles(${n}, ${i})`,se.javascriptGenerator.ORDER_NONE]}const PU={type:"MD5",message0:"MD5加密 %1",args0:[{type:"input_value",name:"NAME"}],output:null,template:["MD5"],colour:225,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function UU(s){return[`x_MD5${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)}`,se.javascriptGenerator.ORDER_NONE]}const FU={type:"toString",message0:"转换为 %1 编码 %2",args0:[{type:"field_dropdown",name:"NAME",options:[["utf8","utf8"],["ascii","ascii"],["latin1","latin1"],["hex","hex"],["base64","base64"]]},{type:"input_value",name:"NAME1"}],output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function GU(s){let n=s.getFieldValue("NAME");return[`${se.javascriptGenerator.valueToCode(s,"NAME1",se.javascriptGenerator.ORDER_ATOMIC)}.toString('${n}')`,se.javascriptGenerator.ORDER_NONE]}const HU={type:"fetchDataFromUrl",message0:"文件读取 %1",args0:[{type:"input_value",name:"NAME1",check:"String"}],output:null,template:["fetchDataFromUrl"],colour:225,tooltip:"读取文件，支持http/https/file协议",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function VU(s){return[`await fetchDataFromUrl(${se.javascriptGenerator.valueToCode(s,"NAME1",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const WU={type:"buffer_from",message0:"创建Buffer对象 %1 编码 %2",args0:[{type:"field_dropdown",name:"NAME1",options:[["utf8","utf8"],["ascii","ascii"],["latin1","latin1"],["hex","hex"],["base64","base64"]]},{type:"input_value",name:"NAME",check:"String"}],output:"Object",colour:230,tooltip:"",helpUrl:""};function zU(s){let n=s.getFieldValue("NAME1");return[`Buffer.from(${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)}, '${n}')`,se.javascriptGenerator.ORDER_NONE]}const jU=[xU,PU,FU,HU,WU],XU={test:BU,MD5:UU,toString:GU,fetchDataFromUrl:VU,buffer_from:zU},KU={type:"zhiling",message0:"调用指令%1",args0:[{type:"input_value",name:"NAME"}],output:null,colour:230,tooltip:"调用指令",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function YU(s){return[`session.execute(${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const qU=[KU],JU={zhiling:YU},ZU={type:"Object",message0:"{ %1 %2 }",args0:[{type:"input_dummy"},{type:"input_statement",name:"action"}],output:null,colour:230,tooltip:"",helpUrl:""};function QU(s){return[`{
${se.javascriptGenerator.statementToCode(s,"action")}
}`,se.javascriptGenerator.ORDER_ATOMIC]}const eF={type:"Keys",message0:"%1 : %2",args0:[{type:"field_input",name:"NAME1",text:"键"},{type:"input_value",name:"NAME"}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function tF(s){let n=s.getFieldValue("NAME1"),i=se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC);return`"${n}":${i},
`}const sF={type:"text_json",message0:"%1 %2",args0:[{type:"field_dropdown",name:"NAME1",options:[["文本转换为json对象","parse"],["json对象转换为文本","stringify"]]},{type:"input_value",name:"NAME"}],output:null,colour:230,tooltip:"",helpUrl:""};function iF(s){let n=s.getFieldValue("NAME1"),i=se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC);return[`JSON.${n}(${i})
`,se.javascriptGenerator.ORDER_ATOMIC]}const nF=[ZU,eF,sF],rF={Object:QU,Keys:tF,text_json:iF},oF=[...d2,...l2,...XP,...IP,...y2,...P2,...JB,...LP,...xP,...t2,...aP,...H2,...aU,...pU,...bU,...wU,...MU,...jU,...qU,...nF],aF=Object.assign({},_2,c2,KP,CP,R2,U2,ZB,NP,BP,s2,V2,gU,TU,AU,DU,XU,JU,rF);function lF(){ga("parameter_list"),w.Extensions.registerMutator("parameter_list",{decompose:function(s){let n=s.newBlock("parameter_list");n.initSvg(),Array.isArray(this.parameters)||(this.parameters=[]);var i=n.getInput("parameter_list").connection;return this.parameters.forEach(o=>{let l=s.newBlock(o.type);l.setFieldValue(o.name,"name"),l.setFieldValue(o.required?"TRUE":"FALSE","required"),l.initSvg(),i.connect(l.previousConnection),i=l.nextConnection}),n},compose:function(s){const n=s.getChildren();if(console.info(n),!n.length||n.length<=0){this.parameters=[];return}const i=[];let o=n[0];for(;o;){console.info(o,o.type);const l=o.getFieldValue("name"),g=o.getFieldValue("required").toLowerCase()==="true",m=o.type;i.push({name:l,required:g,type:m}),o=o.getNextBlock()}this.parameters=i},saveExtraState:function(){return{parameters:this.parameters}},loadExtraState:function(s){this.parameters=s.parameters}},void 0,["any_parameter","string_parameter","number_parameter","boolean_parameter","int_parameter","posint_parameter","text_parameter"])}const cF=["session","argument","segment_item"];function uF(){cF.forEach(s=>{hF(s),dF(s)})}function hF(s){ga(s+"_consumer"),w.Extensions.register(s+"_consumer",function(){this.scope||(this.scope={}),this.scope.consumes||(this.scope.consumes=[]),this.scope.consumes.includes(s)||this.scope.consumes.push(s)})}function dF(s){ga(s+"_provider"),w.Extensions.register(s+"_provider",function(){this.scope||(this.scope={}),this.scope.provides||(this.scope.provides=[]),this.scope.provides.includes(s)||this.scope.provides.push(s)})}function _F(){ga("union_mutator"),w.Extensions.registerMutator("union_mutator",{updateShape_:function(){this.inputList.filter(s=>s.name.startsWith("TYPE_")).filter(s=>parseInt(s.name.split("_")[1])<this.itemCount_).forEach(s=>this.removeInput(s.name));for(let s=0;s<this.itemCount_;s++)if(!this.getInput("TYPE_"+s)){const n=this.appendValueInput("TYPE_"+s);n.align=w.ALIGN_RIGHT,s==0?n.appendField("类型"):n.appendField("或")}},decompose:function(s){const n=s.newBlock("type_union_root");n.initSvg();let i=n.getInput("types").connection;for(let o=0;o<this.itemCount_;o++){const l=s.newBlock("type_union_entity");l.initSvg(),i.connect(l.previousConnection),i=l.nextConnection}return n},compose:function(s){this.itemCount_=0;let n=s.getInputTargetBlock("types");for(;n;)this.itemCount_++,n=n.nextConnection&&n.nextConnection.targetBlock();this.updateShape_()},saveExtraState:function(s){return{itemCount:this.itemCount_}},loadExtraState:function(s){this.itemCount_=s.itemCount,this.updateShape_()}},void 0,["type_union_entity"]),ga("object_mutator"),w.Extensions.registerMutator("object_mutator",{updateShape_:function(){var s;(s=this.properties_)==null||s.forEach((n,i)=>{if(!this.getInput("PROPERTY_"+n)){const o=this.appendValueInput("PROPERTY_"+n);o.align=w.ALIGN_RIGHT,o.appendField(n)}}),this.inputList.filter(n=>n.name.startsWith("PROPERTY_")).filter(n=>!this.properties_.includes(n.name.split("_")[1])).forEach(n=>this.removeInput(n.name))},decompose:function(s){var o;const n=s.newBlock("type_object_root");n.initSvg();let i=n.getInput("properties").connection;return(o=this.properties_)==null||o.forEach(l=>{const g=s.newBlock("type_object_entity");g.initSvg(),g.setFieldValue(l,"name"),i.connect(g.previousConnection),i=g.nextConnection}),n},compose:function(s){const n=[];let i=s.getInputTargetBlock("properties");for(;i;)n.push(i.getFieldValue("name")),i=i.nextConnection&&i.nextConnection.targetBlock();this.properties_=n,this.updateShape_()},saveExtraState:function(s){return{properties:this.properties_}},loadExtraState:function(s){this.properties_=s.properties,this.updateShape_()}},void 0,["type_object_entity"])}function pF(){ga("segment_parser"),w.Extensions.registerMutator("segment_parser",{decompose:function(s){let n=s.newBlock("parse_segment_root");n.initSvg();let i=n.getInput("types").connection;return this.inputList.filter(l=>l.name.startsWith("branch_type_")).forEach(l=>{const g=this.getFieldValue(l.name+"_selector");let m=s.newBlock("segment_type");m.setFieldValue(g,"type"),m.initSvg(),i.connect(m.previousConnection),i=m.nextConnection}),n},compose:function(s){this.inputList.filter(l=>l.name.startsWith("branch_type_")||l.name.startsWith("branch_action_")).forEach(l=>this.removeInput(l.name));const n=s.getChildren();if(!n.length||n.length<=0)return;let i=n[0],o=0;for(;i;)this.addBlockInput(i.getFieldValue("type"),o),i=i.getNextBlock(),o++},saveExtraState:function(){const s=this.inputList.filter(n=>n.name.startsWith("branch_type_")).map(n=>this.getFieldValue(n.name+"_selector"));return console.info(s),s},loadExtraState:function(s){s==null||s.forEach((n,i)=>this.addBlockInput(n,i)),console.info(s)},addBlockInput(s,n){if(this.inputList.some(l=>l.name=="branch_type_"+n))return;const i=this.appendDummyInput("branch_type_"+n);i.appendField("如果消息元素是"),i.appendField(new w.FieldDropdown([["at消息","at"],["引用回复","quote"],["图片","image"]]),"branch_type_"+n+"_selector"),this.setFieldValue(s,"branch_type_"+n+"_selector"),this.appendStatementInput("branch_action_"+n).appendField("则运行")}},void 0,["segment_type"]),w.defineBlocksWithJsonArray([{type:"segment_type",message0:"消息段类型 %1",args0:[{type:"field_dropdown",name:"type",options:[["at消息","at"],["引用回复","quote"],["图片","image"]]}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"parse_segment_root",message0:"要解析的消息段类型 %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"types"}],colour:230,tooltip:"",helpUrl:""}])}function ga(s){w.Extensions.isRegistered(s)&&w.Extensions.unregister(s)}function gF(){lF(),uF(),_F(),pF()}function fF(s){if(!(s.type==="move"||s.type==="create"))return;const n=s;if(!n.workspaceId||!n.blockId)return;const i=n.getEventWorkspace_();if(!i)return;let o=i.getBlockById(n.blockId);w.Events.disableOrphans(s),kf(o)}function kf(s){if(!s)return;const n=[].concat(s.getChildren(false));if(n&&n.forEach(g=>{kf(g)}),!s||!s.scope||!s.scope.consumes)return;const i=new Map((Array.isArray(s.scope.consumes)?s.scope.consumes:[s.scope.consumes]).map(g=>[g,true]));s.setWarningText(null);let o=s;for(;o=o.getParent();){if(!o.scope||!o.scope.provides)continue;(Array.isArray(o.scope.provides)?o.scope.provides:[o.scope.provides]).forEach(m=>{i.delete(m)})}i.size&&(s.setEnabled(false),s.setWarningText("The consumer should be placed in the variable scope of the provider:"+Array.from(i.keys()).join(",")));const l=s.getNextBlock();l&&kf(l)}function mF(s){(s.type==="create"||s.type==="move"||s.type==="delete"||s.type==="change")&&this.autoSave()}w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT="初始化全局变量";w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME="变量名称";w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO="为";w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_COLLAPSED_TEXT="全局变量";w.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP="创建一个全局变量并赋值";w.Msg.LANG_VARIABLES_GLOBAL_PREFIX="[全局变量]";w.Msg.LANG_VARIABLES_GET_TITLE_GET="读取变量";w.Msg.LANG_VARIABLES_GET_COLLAPSED_TEXT="设置变量";w.Msg.LANG_VARIABLES_GET_TOOLTIP="返回变量的值";w.Msg.LANG_VARIABLES_SET_TITLE_SET="设置变量";w.Msg.LANG_VARIABLES_SET_TITLE_TO="为";w.Msg.LANG_VARIABLES_SET_COLLAPSED_TEXT="设置";w.Msg.LANG_VARIABLES_SET_TOOLTIP="设置变量";w.Msg.LANG_VARIABLES_VARIABLE=" 变量";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT="初始化局部变量";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME="局部变量1";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO="为";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO="作用域";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_COLLAPSED_TEXT="局部变量";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP="Allows you to create variables that are only accessible in the do part of this block.";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TRANSLATED_NAME="initialize local in do";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN="in";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_COLLAPSED_TEXT="local";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP="Allows you to create variables that are only accessible in the return part of this block.";w.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TRANSLATED_NAME="initialize local in return";w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES="local names";w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP="";w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME="name";w.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE="x";w.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE="to";w.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE="procedure";w.Msg.LANG_PROCEDURES_DEFNORETURN_DO="do";w.Msg.LANG_PROCEDURES_DEFNORETURN_COLLAPSED_PREFIX="to ";w.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP="A procedure that does not return a value.";w.Msg.LANG_PROCEDURES_DOTHENRETURN_THEN_RETURN="result";w.Msg.LANG_PROCEDURES_DOTHENRETURN_DO="do";w.Msg.LANG_PROCEDURES_DOTHENRETURN_RETURN="result";w.Msg.LANG_PROCEDURES_DOTHENRETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";w.Msg.LANG_PROCEDURES_DOTHENRETURN_COLLAPSED_TEXT="do/result";w.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE="to";w.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE="procedure";w.Msg.LANG_PROCEDURES_DEFRETURN_RETURN="result";w.Msg.LANG_PROCEDURES_DEFRETURN_COLLAPSED_PREFIX="to ";w.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP="A procedure returning a result value.";w.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING=`Warning:
This procedure has
duplicate inputs.`;w.Msg.LANG_PROCEDURES_CALLNORETURN_CALL="call ";w.Msg.LANG_PROCEDURES_CALLNORETURN_PROCEDURE="procedure";w.Msg.LANG_PROCEDURES_CALLNORETURN_COLLAPSED_PREFIX="call ";w.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP="Call a procedure with no return value.";w.Msg.LANG_PROCEDURES_CALLNORETURN_TRANSLATED_NAME="call no return";w.Msg.LANG_PROCEDURES_CALLRETURN_COLLAPSED_PREFIX="call ";w.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP="Call a procedure with a return value.";w.Msg.LANG_PROCEDURES_CALLRETURN_TRANSLATED_NAME="call return";w.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE="inputs";w.Msg.LANG_PROCEDURES_MUTATORARG_TITLE="input:";w.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF="Highlight Procedure";w.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP="";w.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP="";w.Msg.LANG_CONTROLS_FOR_INPUT_WITH="count with";w.Msg.LANG_CONTROLS_FOR_INPUT_VAR="x";w.Msg.LANG_CONTROLS_FOR_INPUT_FROM="from";w.Msg.LANG_CONTROLS_FOR_INPUT_TO="to";w.Msg.LANG_CONTROLS_FOR_INPUT_DO="do";w.Msg.LANG_CONTROLS_FOR_TOOLTIP=`Count from a start number to an end number.
For each count, set the current count number to
variable '%1', and then do some statements.`;w.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM="变量";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR="number";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_START="从";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_END="数到";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP="每次增加";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO="执行";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_TEXT="for number in range";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_PREFIX="for";w.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_SUFFIX=" in range";w.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP='让变量"i"记录开始数到结束数之间指定间隔的值，并执行一些语句';w.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM="遍历列表里的每一项";w.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR="item";w.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST="列表";w.Msg.LANG_CONTROLS_FOREACH_INPUT_DO="执行";w.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_TEXT="for item in list";w.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_PREFIX="for ";w.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_SUFFIX=" in list";w.Msg.LANG_CONTROLS_FOREACH_TOOLTIP='遍历列表中的每一项，将变量"j"设为所选项，并执行一些语句';w.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT="for each %1 with %2 in dictionary %3";w.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_DO="do";w.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_KEY="key";w.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_VALUE="value";w.Msg.LANG_CONTROLS_FOREACH_DICT_TITLE="for each in dictionary";w.Msg.LANG_CONTROLS_FOREACH_DICT_TOOLTIP="Runs the blocks in the 'do' section for each key-value entry in the dictionary. Use the given variable names to refer to the key/value of the current dictionary item.";w.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN="Select a valid item in the drop down.";w.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION="This block cannot be in a definition";w.Msg.HORIZONTAL_PARAMETERS="Arrange Parameters Horizontally";w.Msg.VERTICAL_PARAMETERS="Arrange Parameters Vertically";w.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO="do";w.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN="result";w.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";w.Msg["LANG_CONTROLS_DO_THEN_ RETURN_COLLAPSED_TEXT"]="do/result";w.Msg.LANG_CONTROLS_DO_THEN_RETURN_TITLE="do result";function EF(s){w.Blocks[s.type]={init:function(){var n;this.jsonInit(s),this.imports=s.imports,this.template=s.template,(n=s.args0)==null||n.forEach(i=>{if(i.type==="input_value"){if(!i.input_type)return;const o=this.getInput(i.name);o&&(o.input_type=i.input_type)}}),s.init&&s.init.apply(this)}}}function vF(s){s.forEach(EF)}function bF(){if(!Jn.blockly_vendors)return[];const s=Object.values(Jn.blockly_vendors);return s.forEach(n=>{w.defineBlocksWithJsonArray(n.blocks.map(i=>i.definition))}),console.info(s.map(n=>n.blocks).flat(10).map(n=>n.definition).map(n=>n.type).map(n=>({kind:"block",type:n}))),s.map(n=>n.blocks).flat(10).map(n=>n.definition).map(n=>n.type).map(n=>({kind:"block",type:n}))}const TF=Xe({__name:"variable",props:["modelValue"],emits:["update:modelValue","tag-click","tag-removed"],setup(s,{emit:n}){const i=s,o=n,l=_e({get:()=>i.modelValue??[],set:$=>o("update:modelValue",$)}),g=Ee(""),m=l,u=Ee(false),p=Ee(),c=$=>{m.value.splice(m.value.indexOf($),1),o("tag-removed")},d=()=>{u.value=true,rs(()=>{p.value.input.focus()})},_=()=>{g.value&&m.value.push(g.value),u.value=false,g.value=""};function b($){o("tag-click",$)}return($,E)=>{const y=ht("el-tag"),f=ht("el-button");return oe(),be(Pt,null,[(oe(true),be(Pt,null,di(ue(m),v=>(oe(),Je(y,{key:v,color:"orange",closable:"","disable-transitions":false,onClose:T=>c(v),onClick:T=>b(v),style:{cursor:"pointer"}},{default:je(()=>[xt(Bt(v),1)]),_:2},1032,["onClose","onClick"]))),128)),u.value?(oe(),Je(ue(c0),{key:0,ref_key:"InputRef",ref:p,modelValue:g.value,"onUpdate:modelValue":E[0]||(E[0]=v=>g.value=v),class:"ml-1 w-20",size:"small",onKeyup:io(_,["enter"]),onBlur:_},null,8,["modelValue"])):(oe(),Je(f,{key:1,class:"button-new-tag ml-1",size:"small",onClick:d},{default:je(()=>E[1]||(E[1]=[xt(" + New Tag ")])),_:1}))],64)}}}),SF=Xe({__name:"text-template",props:["current","modelValue"],emits:["update:current","update:modelValue"],setup(s,{emit:n}){const i=s,o=n,l=_e({get:()=>i.current=="text-template",set:$=>o("update:current",$?"text-template":void 0)}),g=_e({get:()=>i.modelValue,set:$=>o("update:modelValue",$)}),m=Ee(null);function u($,E=0){if($.nodeType==Node.TEXT_NODE)return[$.textContent];if($.nodeType==Node.ELEMENT_NODE){const y=$;if(y.className.includes("sp-tag"))return["${"+y.innerText+"}"];if(y.tagName=="DIV"){if(E++>=5)return;let f=[];return y.childNodes.forEach(v=>{f.push(u(v,E))}),[`
`,f.join("")]}}return[]}function p(){const $=m.value.innerHTML.replaceAll(/<!(-)+([^>]*)(-)+>/g,""),E=document.createElement("div");E.innerHTML=$;let y=[];E.childNodes.forEach(f=>{y.push(...u(f))}),g.value.template=y.join(""),d()}Ws(()=>{const $=Ct(m,E=>{E!=null&&($(),m.value.addEventListener("input",()=>{p()}))})}),Ct(l,$=>{$&&rs(()=>{console.info(g),m.value.innerHTML=(g.value.template??"").replaceAll(/\$\{([^}]+)}/g,"<span class='sp-tag' contenteditable='false'>$1</span>").split(`
`).map(E=>E.trim()).filter(E=>E.length>0).map(E=>"<div>"+E+"</div>").join("")})});let c=null;function d(){m.value&&m.value.contains(window.getSelection().focusNode)&&(c=window.getSelection().getRangeAt(0))}function _($){const E=document.createElement("span");E.className="sp-tag",E.contentEditable="false",E.innerText=$,c.insertNode(E),p()}function b(){const $=g.value.variables;if(!m)return;m.value.querySelectorAll(".sp-tag").forEach(y=>{y.tagName=="SPAN"&&(console.info(y.innerHTML),$.includes(y.innerHTML)||y.remove())}),p()}return console.info(_),($,E)=>{const y=ht("el-scrollbar"),f=ht("el-col"),v=ht("el-row"),T=ht("el-dialog");return oe(),Je(T,{modelValue:l.value,"onUpdate:modelValue":E[1]||(E[1]=S=>l.value=S),title:"编辑字符串模板"},{default:je(()=>[Me(v,null,{default:je(()=>[Me(f,{span:16},{default:je(()=>[Me(y,{height:"200px",style:{border:"1px lightgray solid","border-radius":"5px"},class:"editor-context"},{default:je(()=>[he("div",{contenteditable:"true",style:{"min-height":"200px"},class:"editor-content",ref_key:"inputModel",ref:m,onClick:d},null,512)]),_:1})]),_:1}),Me(f,{span:8},{default:je(()=>[Me(TF,{modelValue:g.value.variables,"onUpdate:modelValue":E[0]||(E[0]=S=>g.value.variables=S),onTagClick:_,onTagRemoved:b},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});class S${constructor(n){this.block=n,this.cached_consuming=new Map,this.providing=[],this.consuming=[],this.consume_reload_callbacks=new Map}using(n,i){return this.consume_reload_callbacks.set(n,i),setTimeout(()=>this.addConsume(n),0),()=>{this.consume_reload_callbacks.delete(n),this.removeConsume(n)}}removeFromParent(n){n.block_state.removeChildren(this.block)}removeChildren(n){let i=[];n.block_state.cached_consuming.forEach((o,l)=>{o.forEach(g=>{this.removeCachedConsumeInternal(l,g)&&i.push(l)})}),i.forEach(o=>{var l;(l=this.block.getParent())==null||l.block_state.removeCachedConsume(o,n.id)})}removeCachedConsume(n,i){var o;this.removeCachedConsumeInternal(n,i)&&((o=this.block.getParent())==null||o.block_state.removeCachedConsume(n,i))}removeCachedConsumeInternal(n,i){var l;if(this.providing.includes(n)&&((l=this.block.workspace.getBlockById(i))==null||l.block_state.notifyConsumeReload(n)),!this.cached_consuming.has(n))return false;const o=this.cached_consuming.get(n);return o.delete(i),o.size<=0?(this.cached_consuming.delete(n),true):false}addConsume(n){this.consuming.includes(n)||(this.consuming.push(n),this.addCachedConsume(n,this.block.id))}removeConsume(n){this.consuming.includes(n)&&(this.consuming.splice(this.consuming.indexOf(n),1),this.removeCachedConsume(n,this.block.id))}addCachedConsume(n,i){var o,l;this.providing.includes(n)&&((o=this.block.workspace.getBlockById(i))==null||o.block_state.notifyConsumeReload(n)),this.cached_consuming.has(n)||this.cached_consuming.set(n,new Set),this.cached_consuming.get(n).add(i),(l=this.block.getParent())==null||l.block_state.addCachedConsume(n,i)}notifyConsumeReload(n){this.consume_reload_callbacks.has(n)&&this.consume_reload_callbacks.get(n)()}recoverCachedConsume(){this.cached_consuming.forEach((n,i)=>{n.forEach(o=>{var l;(l=this.block.getParent())==null||l.block_state.addCachedConsume(i,o)})})}}function $F(s){s.addChangeListener(n=>{if(n.type=="finished_loading"){s.getAllBlocks(false).forEach(g=>{g.block_state||(g.block_state=new S$(g))});return}if(!(n.type==="move"||n.type==="create"))return;const i=n,o=i.getEventWorkspace_().getBlockById(i.blockId);if(!o||(o.block_state||(o.block_state=new S$(o)),i.type!="move"))return;let l=i;l.oldParentId&&o.block_state.removeFromParent(o.workspace.getBlockById(l.oldParentId)),l.newParentId&&o.block_state.recoverCachedConsume()})}function wf(s,n){if(!n)return s.newBlock("type_any");switch(n.getTypeName()){case"string":return s.newBlock("type_string");case"number":return s.newBlock("type_number");case"boolean":return s.newBlock("type_boolean");case"array":const i=s.newBlock("type_array"),o=wf(s,n.getPrototype());return o.initSvg(),i.getInput("type").connection.connect(o.outputConnection),i;case"union":const l=s.newBlock("type_union"),g=n.getPrototype();l.itemCount_=g.length,l.initSvg(),l.updateShape_();for(let m=0;m<g.length;m++){const u=wf(s,g[m]);u.initSvg(),l.getInput("TYPE_"+m).connection.connect(u.outputConnection)}return l;default:return s.newBlock("type_any")}}const{dom:Bu,Svg:Pu,Coordinate:yF}=w.utils;function _R(s){s.setMovable(false),s.setEditable(false),s.setDeletable(false),s.getChildren(false).forEach(_R)}function pR(s){s.render(),s.getChildren(false).forEach(pR)}class RF extends w.Icon{constructor(){super(...arguments),this.workspaceWidth=0,this.workspaceHeight=0}drawIcon_(n){Bu.createSvgElement(Pu.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},n);const i=Bu.createSvgElement(Pu.G,{transform:"scale(0.024,0.024)translate(45,60)"},n);Bu.createSvgElement(Pu.PATH,{class:"blocklyIconSymbol",d:"M118.6 80c-11.5 0-21.4 7.9-24 19.1L57 260.3c20.5-6.2 48.3-12.3 78.7-12.3c32.3 0 61.8 6.9 82.8 13.5c10.6 3.3 19.3 6.7 25.4 9.2c3.1 1.3 5.5 2.4 7.3 3.2c.9 .4 1.6 .7 2.1 1l.6 .3 .2 .1 .1 0 0 0 0 0s0 0-6.3 12.7h0l6.3-12.7c5.8 2.9 10.4 7.3 13.5 12.7h40.6c3.1-5.3 7.7-9.8 13.5-12.7l6.3 12.7h0c-6.3-12.7-6.3-12.7-6.3-12.7l0 0 0 0 .1 0 .2-.1 .6-.3c.5-.2 1.2-.6 2.1-1c1.8-.8 4.2-1.9 7.3-3.2c6.1-2.6 14.8-5.9 25.4-9.2c21-6.6 50.4-13.5 82.8-13.5c30.4 0 58.2 6.1 78.7 12.3L481.4 99.1c-2.6-11.2-12.6-19.1-24-19.1c-3.1 0-6.2 .6-9.2 1.8L416.9 94.3c-12.3 4.9-26.3-1.1-31.2-13.4s1.1-26.3 13.4-31.2l31.3-12.5c8.6-3.4 17.7-5.2 27-5.2c33.8 0 63.1 23.3 70.8 56.2l43.9 188c1.7 7.3 2.9 14.7 3.5 22.1c.3 1.9 .5 3.8 .5 5.7v6.7V352v16c0 61.9-50.1 112-112 112H419.7c-59.4 0-108.5-46.4-111.8-105.8L306.6 352H269.4l-1.2 22.2C264.9 433.6 215.8 480 156.3 480H112C50.1 480 0 429.9 0 368V352 310.7 304c0-1.9 .2-3.8 .5-5.7c.6-7.4 1.8-14.8 3.5-22.1l43.9-188C55.5 55.3 84.8 32 118.6 32c9.2 0 18.4 1.8 27 5.2l31.3 12.5c12.3 4.9 18.3 18.9 13.4 31.2s-18.9 18.3-31.2 13.4L127.8 81.8c-2.9-1.2-6-1.8-9.2-1.8zM64 325.4V368c0 26.5 21.5 48 48 48h44.3c25.5 0 46.5-19.9 47.9-45.3l2.5-45.6c-2.3-.8-4.9-1.7-7.5-2.5c-17.2-5.4-39.9-10.5-63.6-10.5c-23.7 0-46.2 5.1-63.2 10.5c-3.1 1-5.9 1.9-8.5 2.9zM512 368V325.4c-2.6-.9-5.5-1.9-8.5-2.9c-17-5.4-39.5-10.5-63.2-10.5c-23.7 0-46.4 5.1-63.6 10.5c-2.7 .8-5.2 1.7-7.5 2.5l2.5 45.6c1.4 25.4 22.5 45.3 47.9 45.3H464c26.5 0 48-21.5 48-48z"},i)}createDisplay(){this.svgDialog=Bu.createSvgElement(Pu.SVG,{x:w.Bubble.BORDER_WIDTH,y:w.Bubble.BORDER_WIDTH});const n=this.getBlock(),i=new w.Options({disable:true,media:n.workspace.options.pathToMedia,rtl:n.RTL,horizontalLayout:false,renderer:n.workspace.options.renderer,rendererOverrides:n.workspace.options.rendererOverrides});this.display_workspace_=new w.WorkspaceSvg(i);const o=this.display_workspace_.createDom("blocklyMutatorBackground");return this.svgDialog.appendChild(o),this.svgDialog}setVisible(n){if(console.info("BP0"),n!=this.isVisible())if(n){const i=this.getBlock();console.info(this.iconXY_),this.bubble_=new w.Bubble(i.workspace,this.createDisplay(),i.pathObject.svgPath,this.iconXY_,null,null);const o=this.display_workspace_;this.bubble_.setSvgId(i.id),this.bubble_.registerMoveEvent(this.onBubbleMove.bind(this)),o.options.languageTree,o.getFlyout(),this.resizeBubble(),this.applyColour();const l=this.display_workspace_.newBlock("type_root");if(l.initSvg(),l.moveTo(new yF(10,10)),this.display_workspace_.addTopBlock(l),this.getBlock().getOutputType){const g=wf(this.display_workspace_,this.getBlock().getOutputType());g&&(g.initSvg(),l.getInput("type").connection.connect(g.outputConnection),g.render())}else{const g=this.display_workspace_.newBlock("type_any");g.initSvg(),l.getInput("type").connection.connect(g.outputConnection),g.render()}pR(l),_R(l),this.display_workspace_.scrollCenter(),this.resizeBubble()}else this.display_workspace_.getTopBlocks(false).forEach(i=>{this.display_workspace_.removeTopBlock(i)}),this.svgDialog=null,this.display_workspace_.dispose(),this.display_workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceWidth=0,this.workspaceHeight=0}resizeBubble(){if(!this.display_workspace_)return;const n=2*w.Bubble.BORDER_WIDTH,i=this.display_workspace_.getCanvas(),o=i.getBBox();let l=o.width+o.x,g=o.height+n*3;const m=this.display_workspace_.getFlyout();if(m){const p=m.getWorkspace().getMetricsManager().getScrollMetrics();g=Math.max(g,p.height+20),l+=m.getWidth()}const u=this.getBlock().RTL;u&&(l=-o.x),l+=n*3,(Math.abs(this.workspaceWidth-l)>n||Math.abs(this.workspaceHeight-g)>n)&&(this.workspaceWidth=l,this.workspaceHeight=g,this.bubble_.setBubbleSize(l+n,g+n),this.svgDialog.setAttribute("width",`${l}`),this.svgDialog.setAttribute("height",`${g}`),this.display_workspace_.setCachedParentSvgSize(l,g)),u&&i.setAttribute("transform",`translate(${this.workspaceWidth}, 0)`),this.display_workspace_.resize()}onBubbleMove(){var n;(n=this.display_workspace_)==null||n.recordDragTargets()}}class IF{constructor(n){this.block=n}}function CF(s){s.typings=new z2,Object.keys(w.Blocks).forEach(n=>{const i=w.Blocks[n].init;n.startsWith("type_")||(w.Blocks[n].init=function(){if(i.call(this),this.type_manager=new IF(this),!this.outputConnection)return;const o=new RF(this),l=this.getIcons.bind(this);this.getIcons=()=>[...l(),o]})})}const $$=Symbol("injected");function Ll(s,n){if(s[$$])return s;const i=s.init;s[$$]=true,s.init=function(...o){i.apply(this,o),n.input&&Object.entries(n.input).forEach(([l,g])=>{const m=this.getInput(l);m&&(m.input_type=g)}),n.output&&(this.getOutputType=n.output.bind(this))}}function OF(){Ll(w.Blocks.text,{output:()=>new Tg}),Ll(w.Blocks.send_session_message,{input:{content:new Af([new Tg,new y$("Segment")])}}),Ll(w.Blocks.segment_at,{input:{user:new Af([new Tg])},output:()=>new y$("Segment")}),Ll(w.Blocks.lists_create_with,{output:function(){return new wF(LF(this.inputList.map(s=>s.name).filter(s=>s).map(s=>{var n;return(n=this.getInput(s).connection)==null?void 0:n.targetBlock()}).filter(s=>s).map(s=>{var n;return((n=s.getOutputType)==null?void 0:n.call(s))??new AF})))}}),Ll(w.Blocks.math_number,{output:()=>new kF})}class Rh{constructor(...n){this.prototype=void 0,n.length&&(this.prototype=n[0])}getPrototype(){return this.prototype}}class gR extends Rh{canWriteTo(n){var i;return this.equalsTo(n)||((i=n.canWriteBy)==null?void 0:i.call(n,this))}equalsTo(n){return n.getTypeName()==this.getTypeName()}}class Tg extends gR{getTypeName(){return"string"}}class kF extends gR{getTypeName(){return"number"}}class fR extends Rh{}class wF extends fR{getTypeName(){return"array"}canWriteTo(n){var i;return this.equalsTo(n)||((i=n.canWriteBy)==null?void 0:i.call(n,this))}equalsTo(n){return n.getTypeName()==this.getTypeName()&&this.getPrototype().equalsTo(n.getPrototype())}}class Af extends fR{getTypeName(){return"union"}canWriteTo(n){for(const i of this.prototype)if(!i.canWriteTo(n))return false;return true}equalsTo(n){if(n.getTypeName()!=this.getTypeName())return false;const i=n.getPrototype();if(i.length!=this.prototype.length)return false;for(const o of this.prototype){let l=i.findIndex(g=>g.equalsTo(o));if(l==-1)return false;i.splice(l,1)}return true}canWriteBy(n){return this.prototype.some(i=>n.canWriteTo(i))}}class y$ extends Rh{getTypeName(){return"class"}canWriteTo(n){var i;return this.equalsTo(n)||((i=n.canWriteBy)==null?void 0:i.call(n,this))}equalsTo(n){return n.getTypeName()==this.getTypeName()&&this.prototype==n.getPrototype()}}class AF extends Rh{getTypeName(){return"any"}canWriteTo(n){return true}canWriteBy(n){return true}equalsTo(n){return n.getTypeName()==this.getTypeName()}}function LF(s){return!Array.isArray(s)||s.length<=1?s[0]:new Af(s)}class NF extends w.ConnectionChecker{constructor(n){super(),this.workspace=n}doTypeChecks(n,i){var u,p;if(!(n.type==1||i.type==1))return super.doTypeChecks(n,i);const o=n.type==1?n:i,g=(p=(u=(n.type==1?i:n).getSourceBlock()).getOutputType)==null?void 0:p.call(u),m=o.getParentInput().input_type;return!g||!m?super.doTypeChecks(n,i):super.doTypeChecks(n,i)&&g.canWriteTo(m)}}const MF={style:{height:"100%",flex:"auto","margin-bottom":"35px"}},DF={style:{width:"100%",padding:"5px",height:"25px","border-bottom":"1px solid var(--bg1)",display:"flex","flex-direction":"row-reverse"}},xF=Xe({__name:"blockly",props:{modelValue:Object,workspace:String},emits:["update:modelValue","update:workspace"],setup(s,{expose:n,emit:i}){const o=Ee(null);let l=s,g=Ee(null),m=Ee(null);cn(l,"modelValue"),w.setLocale($B),vF(oF),gF(),OF(),Object.entries(aF).forEach(([c,d])=>{se.javascriptGenerator[c]=d});let u=null,p={autoSave:()=>{}};return w.VerticalFlyout.prototype.getFlyoutScale=()=>1,Ws(()=>{rs(()=>{u=w.inject(o.value,{toolbox:FB,media:"/static/blockly/",grid:{spacing:20,length:1,colour:"#888",snap:false},zoom:{controls:true,wheel:true,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2},plugins:{connectionChecker:NF}}),window.addEventListener("resize",()=>{w.svgResize(u)}),u.registerToolboxCategoryCallback("VENDOR_UNCATEGORIZED",bF),u.addChangeListener(fF),u.addChangeListener(mF.bind(p)),$F(u),CF(u),w.fieldRegistry.register("binding",yh),UB(u),u.topLevel={openDialog(c,d){return g.value=c,m.value=d,new Promise(_=>{const b=Ct(g,()=>{b(),_(cf(m.value))})})}}})}),n({save(){return w.svgResize(u),w.serialization.workspaces.save(u)},load(c){return w.svgResize(u),w.serialization.workspaces.load(c,u)},setAutoSaveListener(c){p.autoSave=c},updateSize(){w.svgResize(u)},getWorkspaceSvg(){return u}}),(c,d)=>(oe(),be("div",MF,[Me(SF,{modelValue:ue(m),"onUpdate:modelValue":d[0]||(d[0]=_=>Hl(m)?m.value=_:m=_),current:ue(g),"onUpdate:current":d[1]||(d[1]=_=>Hl(g)?g.value=_:g=_)},null,8,["modelValue","current"]),he("div",DF,[he("button",{class:"menu-button",onClick:d[2]||(d[2]=_=>c.$emit("update:workspace","meta"))},"编辑插件元数据")]),he("div",{style:{height:"100%",flex:"auto"},ref_key:"blockly_workspace",ref:o},null,512)]))}});const BF=sr(xF,[["__scopeId","data-v-7579502b"]]);var Sg={exports:{}},R$;function PF(){return R$||(R$=1,function(s,n){(function(i,o){s.exports=o()})(self,()=>(()=>{var i={4567:function(m,u,p){var c=this&&this.__decorate||function(S,R,O,A){var L,I=arguments.length,k=I<3?R:A===null?A=Object.getOwnPropertyDescriptor(R,O):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(S,R,O,A);else for(var B=S.length-1;B>=0;B--)(L=S[B])&&(k=(I<3?L(k):I>3?L(R,O,k):L(R,O))||k);return I>3&&k&&Object.defineProperty(R,O,k),k},d=this&&this.__param||function(S,R){return function(O,A){R(O,A,S)}};Object.defineProperty(u,"__esModule",{value:true}),u.AccessibilityManager=void 0;const _=p(9042),b=p(6114),$=p(9924),E=p(844),y=p(5596),f=p(4725),v=p(3656);let T=u.AccessibilityManager=class extends E.Disposable{constructor(S,R){super(),this._terminal=S,this._renderService=R,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let O=0;O<this._terminal.rows;O++)this._rowElements[O]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[O]);if(this._topBoundaryFocusListener=O=>this._handleBoundaryFocus(O,0),this._bottomBoundaryFocusListener=O=>this._handleBoundaryFocus(O,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new $.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(O=>this._handleResize(O.rows))),this.register(this._terminal.onRender(O=>this._refreshRows(O.start,O.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(O=>this._handleChar(O))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(O=>this._handleTab(O))),this.register(this._terminal.onKey(O=>this._handleKey(O.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new y.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,v.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,E.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(S){for(let R=0;R<S;R++)this._handleChar(" ")}_handleChar(S){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==S&&(this._charsToAnnounce+=S):this._charsToAnnounce+=S,S===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=_.tooMuchOutput)),b.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,b.isMac&&this._liveRegion.remove()}_handleKey(S){this._clearLiveRegion(),/\p{Control}/u.test(S)||this._charsToConsume.push(S)}_refreshRows(S,R){this._liveRegionDebouncer.refresh(S,R,this._terminal.rows)}_renderRows(S,R){const O=this._terminal.buffer,A=O.lines.length.toString();for(let L=S;L<=R;L++){const I=O.translateBufferLineToString(O.ydisp+L,true),k=(O.ydisp+L+1).toString(),B=this._rowElements[L];B&&(I.length===0?B.innerText=" ":B.textContent=I,B.setAttribute("aria-posinset",k),B.setAttribute("aria-setsize",A))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(S,R){const O=S.target,A=this._rowElements[R===0?1:this._rowElements.length-2];if(O.getAttribute("aria-posinset")===(R===0?"1":`${this._terminal.buffer.lines.length}`)||S.relatedTarget!==A)return;let L,I;if(R===0?(L=O,I=this._rowElements.pop(),this._rowContainer.removeChild(I)):(L=this._rowElements.shift(),I=O,this._rowContainer.removeChild(L)),L.removeEventListener("focus",this._topBoundaryFocusListener),I.removeEventListener("focus",this._bottomBoundaryFocusListener),R===0){const k=this._createAccessibilityTreeNode();this._rowElements.unshift(k),this._rowContainer.insertAdjacentElement("afterbegin",k)}else{const k=this._createAccessibilityTreeNode();this._rowElements.push(k),this._rowContainer.appendChild(k)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(R===0?-1:1),this._rowElements[R===0?1:this._rowElements.length-2].focus(),S.preventDefault(),S.stopImmediatePropagation()}_handleResize(S){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let R=this._rowContainer.children.length;R<this._terminal.rows;R++)this._rowElements[R]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[R]);for(;this._rowElements.length>S;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const S=document.createElement("div");return S.setAttribute("role","listitem"),S.tabIndex=-1,this._refreshRowDimensions(S),S}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let S=0;S<this._terminal.rows;S++)this._refreshRowDimensions(this._rowElements[S])}}_refreshRowDimensions(S){S.style.height=`${this._renderService.dimensions.css.cell.height}px`}};u.AccessibilityManager=T=c([d(1,f.IRenderService)],T)},3614:(m,u)=>{function p(b){return b.replace(/\r?\n/g,"\r")}function c(b,$){return $?"\x1B[200~"+b+"\x1B[201~":b}function d(b,$,E,y){b=c(b=p(b),E.decPrivateModes.bracketedPasteMode&&y.rawOptions.ignoreBracketedPasteMode!==true),E.triggerDataEvent(b,true),$.value=""}function _(b,$,E){const y=E.getBoundingClientRect(),f=b.clientX-y.left-10,v=b.clientY-y.top-10;$.style.width="20px",$.style.height="20px",$.style.left=`${f}px`,$.style.top=`${v}px`,$.style.zIndex="1000",$.focus()}Object.defineProperty(u,"__esModule",{value:true}),u.rightClickHandler=u.moveTextAreaUnderMouseCursor=u.paste=u.handlePasteEvent=u.copyHandler=u.bracketTextForPaste=u.prepareTextForTerminal=void 0,u.prepareTextForTerminal=p,u.bracketTextForPaste=c,u.copyHandler=function(b,$){b.clipboardData&&b.clipboardData.setData("text/plain",$.selectionText),b.preventDefault()},u.handlePasteEvent=function(b,$,E,y){b.stopPropagation(),b.clipboardData&&d(b.clipboardData.getData("text/plain"),$,E,y)},u.paste=d,u.moveTextAreaUnderMouseCursor=_,u.rightClickHandler=function(b,$,E,y,f){_(b,$,E),f&&y.rightClickSelect(b),$.value=y.selectionText,$.select()}},7239:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ColorContrastCache=void 0;const c=p(1505);u.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(d,_,b){this._css.set(d,_,b)}getCss(d,_){return this._css.get(d,_)}setColor(d,_,b){this._color.set(d,_,b)}getColor(d,_){return this._color.get(d,_)}clear(){this._color.clear(),this._css.clear()}}},3656:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.addDisposableDomListener=void 0,u.addDisposableDomListener=function(p,c,d,_){p.addEventListener(c,d,_);let b=false;return{dispose:()=>{b||(b=true,p.removeEventListener(c,d,_))}}}},6465:function(m,u,p){var c=this&&this.__decorate||function(f,v,T,S){var R,O=arguments.length,A=O<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,T):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(f,v,T,S);else for(var L=f.length-1;L>=0;L--)(R=f[L])&&(A=(O<3?R(A):O>3?R(v,T,A):R(v,T))||A);return O>3&&A&&Object.defineProperty(v,T,A),A},d=this&&this.__param||function(f,v){return function(T,S){v(T,S,f)}};Object.defineProperty(u,"__esModule",{value:true}),u.Linkifier2=void 0;const _=p(3656),b=p(8460),$=p(844),E=p(2585);let y=u.Linkifier2=class extends $.Disposable{get currentLink(){return this._currentLink}constructor(f){super(),this._bufferService=f,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=true,this._wasResized=false,this._activeLine=-1,this._onShowLinkUnderline=this.register(new b.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new b.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,$.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,$.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=true}))}registerLinkProvider(f){return this._linkProviders.push(f),{dispose:()=>{const v=this._linkProviders.indexOf(f);v!==-1&&this._linkProviders.splice(v,1)}}}attachToDom(f,v,T){this._element=f,this._mouseService=v,this._renderService=T,this.register((0,_.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=true,this._clearCurrentLink()})),this.register((0,_.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,_.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,_.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(f){if(this._lastMouseEvent=f,!this._element||!this._mouseService)return;const v=this._positionFromMouseEvent(f,this._element,this._mouseService);if(!v)return;this._isMouseOut=false;const T=f.composedPath();for(let S=0;S<T.length;S++){const R=T[S];if(R.classList.contains("xterm"))break;if(R.classList.contains("xterm-hover"))return}this._lastBufferCell&&v.x===this._lastBufferCell.x&&v.y===this._lastBufferCell.y||(this._handleHover(v),this._lastBufferCell=v)}_handleHover(f){if(this._activeLine!==f.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(f,false),void(this._wasResized=false);this._currentLink&&this._linkAtPosition(this._currentLink.link,f)||(this._clearCurrentLink(),this._askForLink(f,true))}_askForLink(f,v){var T,S;this._activeProviderReplies&&v||((T=this._activeProviderReplies)===null||T===void 0||T.forEach(O=>{O==null||O.forEach(A=>{A.link.dispose&&A.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=f.y);let R=false;for(const[O,A]of this._linkProviders.entries())v?!((S=this._activeProviderReplies)===null||S===void 0)&&S.get(O)&&(R=this._checkLinkProviderResult(O,f,R)):A.provideLinks(f.y,L=>{var I,k;if(this._isMouseOut)return;const B=L==null?void 0:L.map(U=>({link:U}));(I=this._activeProviderReplies)===null||I===void 0||I.set(O,B),R=this._checkLinkProviderResult(O,f,R),((k=this._activeProviderReplies)===null||k===void 0?void 0:k.size)===this._linkProviders.length&&this._removeIntersectingLinks(f.y,this._activeProviderReplies)})}_removeIntersectingLinks(f,v){const T=new Set;for(let S=0;S<v.size;S++){const R=v.get(S);if(R)for(let O=0;O<R.length;O++){const A=R[O],L=A.link.range.start.y<f?0:A.link.range.start.x,I=A.link.range.end.y>f?this._bufferService.cols:A.link.range.end.x;for(let k=L;k<=I;k++){if(T.has(k)){R.splice(O--,1);break}T.add(k)}}}}_checkLinkProviderResult(f,v,T){var S;if(!this._activeProviderReplies)return T;const R=this._activeProviderReplies.get(f);let O=false;for(let A=0;A<f;A++)this._activeProviderReplies.has(A)&&!this._activeProviderReplies.get(A)||(O=true);if(!O&&R){const A=R.find(L=>this._linkAtPosition(L.link,v));A&&(T=true,this._handleNewLink(A))}if(this._activeProviderReplies.size===this._linkProviders.length&&!T)for(let A=0;A<this._activeProviderReplies.size;A++){const L=(S=this._activeProviderReplies.get(A))===null||S===void 0?void 0:S.find(I=>this._linkAtPosition(I.link,v));if(L){T=true,this._handleNewLink(L);break}}return T}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(f){if(!this._element||!this._mouseService||!this._currentLink)return;const v=this._positionFromMouseEvent(f,this._element,this._mouseService);v&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,v)&&this._currentLink.link.activate(f,this._currentLink.link.text)}_clearCurrentLink(f,v){this._element&&this._currentLink&&this._lastMouseEvent&&(!f||!v||this._currentLink.link.range.start.y>=f&&this._currentLink.link.range.end.y<=v)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,$.disposeArray)(this._linkCacheDisposables))}_handleNewLink(f){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const v=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);v&&this._linkAtPosition(f.link,v)&&(this._currentLink=f,this._currentLink.state={decorations:{underline:f.link.decorations===void 0||f.link.decorations.underline,pointerCursor:f.link.decorations===void 0||f.link.decorations.pointerCursor},isHovered:true},this._linkHover(this._element,f.link,this._lastMouseEvent),f.link.decorations={},Object.defineProperties(f.link.decorations,{pointerCursor:{get:()=>{var T,S;return(S=(T=this._currentLink)===null||T===void 0?void 0:T.state)===null||S===void 0?void 0:S.decorations.pointerCursor},set:T=>{var S,R;!((S=this._currentLink)===null||S===void 0)&&S.state&&this._currentLink.state.decorations.pointerCursor!==T&&(this._currentLink.state.decorations.pointerCursor=T,this._currentLink.state.isHovered&&((R=this._element)===null||R===void 0||R.classList.toggle("xterm-cursor-pointer",T)))}},underline:{get:()=>{var T,S;return(S=(T=this._currentLink)===null||T===void 0?void 0:T.state)===null||S===void 0?void 0:S.decorations.underline},set:T=>{var S,R,O;!((S=this._currentLink)===null||S===void 0)&&S.state&&((O=(R=this._currentLink)===null||R===void 0?void 0:R.state)===null||O===void 0?void 0:O.decorations.underline)!==T&&(this._currentLink.state.decorations.underline=T,this._currentLink.state.isHovered&&this._fireUnderlineEvent(f.link,T))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(T=>{if(!this._currentLink)return;const S=T.start===0?0:T.start+1+this._bufferService.buffer.ydisp,R=this._bufferService.buffer.ydisp+1+T.end;if(this._currentLink.link.range.start.y>=S&&this._currentLink.link.range.end.y<=R&&(this._clearCurrentLink(S,R),this._lastMouseEvent&&this._element)){const O=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);O&&this._askForLink(O,false)}})))}_linkHover(f,v,T){var S;!((S=this._currentLink)===null||S===void 0)&&S.state&&(this._currentLink.state.isHovered=true,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(v,true),this._currentLink.state.decorations.pointerCursor&&f.classList.add("xterm-cursor-pointer")),v.hover&&v.hover(T,v.text)}_fireUnderlineEvent(f,v){const T=f.range,S=this._bufferService.buffer.ydisp,R=this._createLinkUnderlineEvent(T.start.x-1,T.start.y-S-1,T.end.x,T.end.y-S-1,void 0);(v?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(R)}_linkLeave(f,v,T){var S;!((S=this._currentLink)===null||S===void 0)&&S.state&&(this._currentLink.state.isHovered=false,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(v,false),this._currentLink.state.decorations.pointerCursor&&f.classList.remove("xterm-cursor-pointer")),v.leave&&v.leave(T,v.text)}_linkAtPosition(f,v){const T=f.range.start.y*this._bufferService.cols+f.range.start.x,S=f.range.end.y*this._bufferService.cols+f.range.end.x,R=v.y*this._bufferService.cols+v.x;return T<=R&&R<=S}_positionFromMouseEvent(f,v,T){const S=T.getCoords(f,v,this._bufferService.cols,this._bufferService.rows);if(S)return{x:S[0],y:S[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(f,v,T,S,R){return{x1:f,y1:v,x2:T,y2:S,cols:this._bufferService.cols,fg:R}}};u.Linkifier2=y=c([d(0,E.IBufferService)],y)},9042:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.tooMuchOutput=u.promptLabel=void 0,u.promptLabel="Terminal input",u.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(m,u,p){var c=this&&this.__decorate||function(y,f,v,T){var S,R=arguments.length,O=R<3?f:T===null?T=Object.getOwnPropertyDescriptor(f,v):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,f,v,T);else for(var A=y.length-1;A>=0;A--)(S=y[A])&&(O=(R<3?S(O):R>3?S(f,v,O):S(f,v))||O);return R>3&&O&&Object.defineProperty(f,v,O),O},d=this&&this.__param||function(y,f){return function(v,T){f(v,T,y)}};Object.defineProperty(u,"__esModule",{value:true}),u.OscLinkProvider=void 0;const _=p(511),b=p(2585);let $=u.OscLinkProvider=class{constructor(y,f,v){this._bufferService=y,this._optionsService=f,this._oscLinkService=v}provideLinks(y,f){var v;const T=this._bufferService.buffer.lines.get(y-1);if(!T)return void f(void 0);const S=[],R=this._optionsService.rawOptions.linkHandler,O=new _.CellData,A=T.getTrimmedLength();let L=-1,I=-1,k=false;for(let B=0;B<A;B++)if(I!==-1||T.hasContent(B)){if(T.loadCell(B,O),O.hasExtendedAttrs()&&O.extended.urlId){if(I===-1){I=B,L=O.extended.urlId;continue}k=O.extended.urlId!==L}else I!==-1&&(k=true);if(k||I!==-1&&B===A-1){const U=(v=this._oscLinkService.getLinkData(L))===null||v===void 0?void 0:v.uri;if(U){const P={start:{x:I+1,y},end:{x:B+(k||B!==A-1?0:1),y}};let z=false;if(!(R!=null&&R.allowNonHttpProtocols))try{const W=new URL(U);["http:","https:"].includes(W.protocol)||(z=true)}catch{z=true}z||S.push({text:U,range:P,activate:(W,j)=>R?R.activate(W,j,P):E(0,j),hover:(W,j)=>{var K;return(K=R==null?void 0:R.hover)===null||K===void 0?void 0:K.call(R,W,j,P)},leave:(W,j)=>{var K;return(K=R==null?void 0:R.leave)===null||K===void 0?void 0:K.call(R,W,j,P)}})}k=false,O.hasExtendedAttrs()&&O.extended.urlId?(I=B,L=O.extended.urlId):(I=-1,L=-1)}}f(S)}};function E(y,f){if(confirm(`Do you want to navigate to ${f}?

WARNING: This link could potentially be dangerous`)){const v=window.open();if(v){try{v.opener=null}catch{}v.location.href=f}else console.warn("Opening link blocked as opener could not be cleared")}}u.OscLinkProvider=$=c([d(0,b.IBufferService),d(1,b.IOptionsService),d(2,b.IOscLinkService)],$)},6193:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.RenderDebouncer=void 0,u.RenderDebouncer=class{constructor(p,c){this._parentWindow=p,this._renderCallback=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(p){return this._refreshCallbacks.push(p),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(p,c,d){this._rowCount=d,p=p!==void 0?p:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,p):p,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const p=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(p,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const p of this._refreshCallbacks)p(0);this._refreshCallbacks=[]}}},5596:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ScreenDprMonitor=void 0;const c=p(844);class d extends c.Disposable{constructor(b){super(),this._parentWindow=b,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,c.toDisposable)(()=>{this.clearListener()}))}setListener(b){this._listener&&this.clearListener(),this._listener=b,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var b;this._outerListener&&((b=this._resolutionMediaMatchList)===null||b===void 0||b.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}u.ScreenDprMonitor=d},3236:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Terminal=void 0;const c=p(3614),d=p(3656),_=p(6465),b=p(9042),$=p(3730),E=p(1680),y=p(3107),f=p(5744),v=p(2950),T=p(1296),S=p(428),R=p(4269),O=p(5114),A=p(8934),L=p(3230),I=p(9312),k=p(4725),B=p(6731),U=p(8055),P=p(8969),z=p(8460),W=p(844),j=p(6114),K=p(8437),ee=p(2584),M=p(7399),F=p(5941),V=p(9074),X=p(2585),H=p(5435),ne=p(4567),Ie=typeof window<"u"?window.document:null;class de extends P.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(x={}){super(x),this.browser=j,this._keyDownHandled=false,this._keyDownSeen=false,this._keyPressHandled=false,this._unprocessedDeadKey=false,this._accessibilityManager=this.register(new W.MutableDisposable),this._onCursorMove=this.register(new z.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new z.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new z.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new z.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new z.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new z.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new z.EventEmitter),this._onBlur=this.register(new z.EventEmitter),this._onA11yCharEmitter=this.register(new z.EventEmitter),this._onA11yTabEmitter=this.register(new z.EventEmitter),this._onWillOpen=this.register(new z.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(_.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance($.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(V.DecorationService),this._instantiationService.setService(X.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((te,ce)=>this.refresh(te,ce))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(te=>this._reportWindowsOptions(te))),this.register(this._inputHandler.onColor(te=>this._handleColorEvent(te))),this.register((0,z.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,z.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,z.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,z.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(te=>this._afterResize(te.cols,te.rows))),this.register((0,W.toDisposable)(()=>{var te,ce;this._customKeyEventHandler=void 0,(ce=(te=this.element)===null||te===void 0?void 0:te.parentNode)===null||ce===void 0||ce.removeChild(this.element)}))}_handleColorEvent(x){if(this._themeService)for(const te of x){let ce,ae="";switch(te.index){case 256:ce="foreground",ae="10";break;case 257:ce="background",ae="11";break;case 258:ce="cursor",ae="12";break;default:ce="ansi",ae="4;"+te.index}switch(te.type){case 0:const De=U.color.toColorRGB(ce==="ansi"?this._themeService.colors.ansi[te.index]:this._themeService.colors[ce]);this.coreService.triggerDataEvent(`${ee.C0.ESC}]${ae};${(0,F.toRgbString)(De)}${ee.C1_ESCAPED.ST}`);break;case 1:if(ce==="ansi")this._themeService.modifyColors($e=>$e.ansi[te.index]=U.rgba.toColor(...te.color));else{const $e=ce;this._themeService.modifyColors(st=>st[$e]=U.rgba.toColor(...te.color))}break;case 2:this._themeService.restoreColor(te.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:true})}_handleScreenReaderModeOptionChange(x){x?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(ne.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(x){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(ee.C0.ESC+"[I"),this.updateCursorStyle(x),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var x;return(x=this.textarea)===null||x===void 0?void 0:x.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(ee.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const x=this.buffer.ybase+this.buffer.y,te=this.buffer.lines.get(x);if(!te)return;const ce=Math.min(this.buffer.x,this.cols-1),ae=this._renderService.dimensions.css.cell.height,De=te.getWidth(ce),$e=this._renderService.dimensions.css.cell.width*De,st=this.buffer.y*this._renderService.dimensions.css.cell.height,bt=ce*this._renderService.dimensions.css.cell.width;this.textarea.style.left=bt+"px",this.textarea.style.top=st+"px",this.textarea.style.width=$e+"px",this.textarea.style.height=ae+"px",this.textarea.style.lineHeight=ae+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,d.addDisposableDomListener)(this.element,"copy",te=>{this.hasSelection()&&(0,c.copyHandler)(te,this._selectionService)}));const x=te=>(0,c.handlePasteEvent)(te,this.textarea,this.coreService,this.optionsService);this.register((0,d.addDisposableDomListener)(this.textarea,"paste",x)),this.register((0,d.addDisposableDomListener)(this.element,"paste",x)),j.isFirefox?this.register((0,d.addDisposableDomListener)(this.element,"mousedown",te=>{te.button===2&&(0,c.rightClickHandler)(te,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,d.addDisposableDomListener)(this.element,"contextmenu",te=>{(0,c.rightClickHandler)(te,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),j.isLinux&&this.register((0,d.addDisposableDomListener)(this.element,"auxclick",te=>{te.button===1&&(0,c.moveTextAreaUnderMouseCursor)(te,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,d.addDisposableDomListener)(this.textarea,"keyup",x=>this._keyUp(x),true)),this.register((0,d.addDisposableDomListener)(this.textarea,"keydown",x=>this._keyDown(x),true)),this.register((0,d.addDisposableDomListener)(this.textarea,"keypress",x=>this._keyPress(x),true)),this.register((0,d.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,d.addDisposableDomListener)(this.textarea,"compositionupdate",x=>this._compositionHelper.compositionupdate(x))),this.register((0,d.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,d.addDisposableDomListener)(this.textarea,"input",x=>this._inputEvent(x),true)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(x){var te;if(!x)throw new Error("Terminal requires a parent element.");x.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=x.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),x.appendChild(this.element);const ce=Ie.createDocumentFragment();this._viewportElement=Ie.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),ce.appendChild(this._viewportElement),this._viewportScrollArea=Ie.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=Ie.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=Ie.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),ce.appendChild(this.screenElement),this.textarea=Ie.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",b.promptLabel),j.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(O.CoreBrowserService,this.textarea,(te=this._document.defaultView)!==null&&te!==void 0?te:window),this._instantiationService.setService(k.ICoreBrowserService,this._coreBrowserService),this.register((0,d.addDisposableDomListener)(this.textarea,"focus",ae=>this._handleTextAreaFocus(ae))),this.register((0,d.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(S.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(k.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(B.ThemeService),this._instantiationService.setService(k.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(R.CharacterJoinerService),this._instantiationService.setService(k.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(L.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(k.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(ae=>this._onRender.fire(ae))),this.onResize(ae=>this._renderService.resize(ae.cols,ae.rows)),this._compositionView=Ie.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(v.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(ce);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(A.MouseService),this._instantiationService.setService(k.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(E.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(ae=>this.scrollLines(ae.amount,ae.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(I.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(k.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(ae=>this.scrollLines(ae.amount,ae.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(ae=>this._renderService.handleSelectionChanged(ae.start,ae.end,ae.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(ae=>{this.textarea.value=ae,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(ae=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,d.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(y.BufferDecorationRenderer,this.screenElement)),this.register((0,d.addDisposableDomListener)(this.element,"mousedown",ae=>this._selectionService.handleMouseDown(ae))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(ne.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",ae=>this._handleScreenReaderModeOptionChange(ae))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(f.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",ae=>{!this._overviewRulerRenderer&&ae&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(f.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(T.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const x=this,te=this.element;function ce($e){const st=x._mouseService.getMouseReportCoords($e,x.screenElement);if(!st)return false;let bt,Ut;switch($e.overrideType||$e.type){case"mousemove":Ut=32,$e.buttons===void 0?(bt=3,$e.button!==void 0&&(bt=$e.button<3?$e.button:3)):bt=1&$e.buttons?0:4&$e.buttons?1:2&$e.buttons?2:3;break;case"mouseup":Ut=0,bt=$e.button<3?$e.button:3;break;case"mousedown":Ut=1,bt=$e.button<3?$e.button:3;break;case"wheel":if(x.viewport.getLinesScrolled($e)===0)return false;Ut=$e.deltaY<0?0:1,bt=4;break;default:return false}return!(Ut===void 0||bt===void 0||bt>4)&&x.coreMouseService.triggerMouseEvent({col:st.col,row:st.row,x:st.x,y:st.y,button:bt,action:Ut,ctrl:$e.ctrlKey,alt:$e.altKey,shift:$e.shiftKey})}const ae={mouseup:null,wheel:null,mousedrag:null,mousemove:null},De={mouseup:$e=>(ce($e),$e.buttons||(this._document.removeEventListener("mouseup",ae.mouseup),ae.mousedrag&&this._document.removeEventListener("mousemove",ae.mousedrag)),this.cancel($e)),wheel:$e=>(ce($e),this.cancel($e,true)),mousedrag:$e=>{$e.buttons&&ce($e)},mousemove:$e=>{$e.buttons||ce($e)}};this.register(this.coreMouseService.onProtocolChange($e=>{$e?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents($e)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&$e?ae.mousemove||(te.addEventListener("mousemove",De.mousemove),ae.mousemove=De.mousemove):(te.removeEventListener("mousemove",ae.mousemove),ae.mousemove=null),16&$e?ae.wheel||(te.addEventListener("wheel",De.wheel,{passive:false}),ae.wheel=De.wheel):(te.removeEventListener("wheel",ae.wheel),ae.wheel=null),2&$e?ae.mouseup||(te.addEventListener("mouseup",De.mouseup),ae.mouseup=De.mouseup):(this._document.removeEventListener("mouseup",ae.mouseup),te.removeEventListener("mouseup",ae.mouseup),ae.mouseup=null),4&$e?ae.mousedrag||(ae.mousedrag=De.mousedrag):(this._document.removeEventListener("mousemove",ae.mousedrag),ae.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,d.addDisposableDomListener)(te,"mousedown",$e=>{if($e.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection($e))return ce($e),ae.mouseup&&this._document.addEventListener("mouseup",ae.mouseup),ae.mousedrag&&this._document.addEventListener("mousemove",ae.mousedrag),this.cancel($e)})),this.register((0,d.addDisposableDomListener)(te,"wheel",$e=>{if(!ae.wheel){if(!this.buffer.hasScrollback){const st=this.viewport.getLinesScrolled($e);if(st===0)return;const bt=ee.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+($e.deltaY<0?"A":"B");let Ut="";for(let jt=0;jt<Math.abs(st);jt++)Ut+=bt;return this.coreService.triggerDataEvent(Ut,true),this.cancel($e,true)}return this.viewport.handleWheel($e)?this.cancel($e):void 0}},{passive:false})),this.register((0,d.addDisposableDomListener)(te,"touchstart",$e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart($e),this.cancel($e)},{passive:true})),this.register((0,d.addDisposableDomListener)(te,"touchmove",$e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove($e)?void 0:this.cancel($e)},{passive:false}))}refresh(x,te){var ce;(ce=this._renderService)===null||ce===void 0||ce.refreshRows(x,te)}updateCursorStyle(x){var te;!((te=this._selectionService)===null||te===void 0)&&te.shouldColumnSelect(x)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=true,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(x,te,ce=0){var ae;ce===1?(super.scrollLines(x,te,ce),this.refresh(0,this.rows-1)):(ae=this.viewport)===null||ae===void 0||ae.scrollLines(x)}paste(x){(0,c.paste)(x,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(x){this._customKeyEventHandler=x}registerLinkProvider(x){return this.linkifier2.registerLinkProvider(x)}registerCharacterJoiner(x){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const te=this._characterJoinerService.register(x);return this.refresh(0,this.rows-1),te}deregisterCharacterJoiner(x){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(x)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(x){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+x)}registerDecoration(x){return this._decorationService.registerDecoration(x)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(x,te,ce){this._selectionService.setSelection(x,te,ce)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var x;(x=this._selectionService)===null||x===void 0||x.clearSelection()}selectAll(){var x;(x=this._selectionService)===null||x===void 0||x.selectAll()}selectLines(x,te){var ce;(ce=this._selectionService)===null||ce===void 0||ce.selectLines(x,te)}_keyDown(x){if(this._keyDownHandled=false,this._keyDownSeen=true,this._customKeyEventHandler&&this._customKeyEventHandler(x)===false)return false;const te=this.browser.isMac&&this.options.macOptionIsMeta&&x.altKey;if(!te&&!this._compositionHelper.keydown(x))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),false;te||x.key!=="Dead"&&x.key!=="AltGraph"||(this._unprocessedDeadKey=true);const ce=(0,M.evaluateKeyboardEvent)(x,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(x),ce.type===3||ce.type===2){const ae=this.rows-1;return this.scrollLines(ce.type===2?-ae:ae),this.cancel(x,true)}return ce.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,x)||(ce.cancel&&this.cancel(x,true),!ce.key||!!(x.key&&!x.ctrlKey&&!x.altKey&&!x.metaKey&&x.key.length===1&&x.key.charCodeAt(0)>=65&&x.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=false,true):(ce.key!==ee.C0.ETX&&ce.key!==ee.C0.CR||(this.textarea.value=""),this._onKey.fire({key:ce.key,domEvent:x}),this._showCursor(),this.coreService.triggerDataEvent(ce.key,true),!this.optionsService.rawOptions.screenReaderMode||x.altKey||x.ctrlKey?this.cancel(x,true):void(this._keyDownHandled=true))))}_isThirdLevelShift(x,te){const ce=x.isMac&&!this.options.macOptionIsMeta&&te.altKey&&!te.ctrlKey&&!te.metaKey||x.isWindows&&te.altKey&&te.ctrlKey&&!te.metaKey||x.isWindows&&te.getModifierState("AltGraph");return te.type==="keypress"?ce:ce&&(!te.keyCode||te.keyCode>47)}_keyUp(x){this._keyDownSeen=false,this._customKeyEventHandler&&this._customKeyEventHandler(x)===false||(function(te){return te.keyCode===16||te.keyCode===17||te.keyCode===18}(x)||this.focus(),this.updateCursorStyle(x),this._keyPressHandled=false)}_keyPress(x){let te;if(this._keyPressHandled=false,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(x)===false)return false;if(this.cancel(x),x.charCode)te=x.charCode;else if(x.which===null||x.which===void 0)te=x.keyCode;else{if(x.which===0||x.charCode===0)return false;te=x.which}return!(!te||(x.altKey||x.ctrlKey||x.metaKey)&&!this._isThirdLevelShift(this.browser,x)||(te=String.fromCharCode(te),this._onKey.fire({key:te,domEvent:x}),this._showCursor(),this.coreService.triggerDataEvent(te,true),this._keyPressHandled=true,this._unprocessedDeadKey=false,0))}_inputEvent(x){if(x.data&&x.inputType==="insertText"&&(!x.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return false;this._unprocessedDeadKey=false;const te=x.data;return this.coreService.triggerDataEvent(te,true),this.cancel(x),true}return false}resize(x,te){x!==this.cols||te!==this.rows?super.resize(x,te):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(x,te){var ce,ae;(ce=this._charSizeService)===null||ce===void 0||ce.measure(),(ae=this.viewport)===null||ae===void 0||ae.syncScrollArea(true)}clear(){var x;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let te=1;te<this.rows;te++)this.buffer.lines.push(this.buffer.getBlankLine(K.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(x=this.viewport)===null||x===void 0||x.reset(),this.refresh(0,this.rows-1)}}reset(){var x,te;this.options.rows=this.rows,this.options.cols=this.cols;const ce=this._customKeyEventHandler;this._setup(),super.reset(),(x=this._selectionService)===null||x===void 0||x.reset(),this._decorationService.reset(),(te=this.viewport)===null||te===void 0||te.reset(),this._customKeyEventHandler=ce,this.refresh(0,this.rows-1)}clearTextureAtlas(){var x;(x=this._renderService)===null||x===void 0||x.clearTextureAtlas()}_reportFocus(){var x;!((x=this.element)===null||x===void 0)&&x.classList.contains("focus")?this.coreService.triggerDataEvent(ee.C0.ESC+"[I"):this.coreService.triggerDataEvent(ee.C0.ESC+"[O")}_reportWindowsOptions(x){if(this._renderService)switch(x){case H.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const te=this._renderService.dimensions.css.canvas.width.toFixed(0),ce=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${ee.C0.ESC}[4;${ce};${te}t`);break;case H.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const ae=this._renderService.dimensions.css.cell.width.toFixed(0),De=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${ee.C0.ESC}[6;${De};${ae}t`)}}cancel(x,te){if(this.options.cancelEvents||te)return x.preventDefault(),x.stopPropagation(),false}}u.Terminal=de},9924:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.TimeBasedDebouncer=void 0,u.TimeBasedDebouncer=class{constructor(p,c=1e3){this._renderCallback=p,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=false}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(p,c,d){this._rowCount=d,p=p!==void 0?p:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,p):p,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;const _=Date.now();if(_-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=_,this._innerRefresh();else if(!this._additionalRefreshRequested){const b=_-this._lastRefreshMs,$=this._debounceThresholdMS-b;this._additionalRefreshRequested=true,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=false,this._refreshTimeoutID=void 0},$)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const p=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(p,c)}}},1680:function(m,u,p){var c=this&&this.__decorate||function(v,T,S,R){var O,A=arguments.length,L=A<3?T:R===null?R=Object.getOwnPropertyDescriptor(T,S):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(v,T,S,R);else for(var I=v.length-1;I>=0;I--)(O=v[I])&&(L=(A<3?O(L):A>3?O(T,S,L):O(T,S))||L);return A>3&&L&&Object.defineProperty(T,S,L),L},d=this&&this.__param||function(v,T){return function(S,R){T(S,R,v)}};Object.defineProperty(u,"__esModule",{value:true}),u.Viewport=void 0;const _=p(3656),b=p(4725),$=p(8460),E=p(844),y=p(2585);let f=u.Viewport=class extends E.Disposable{constructor(v,T,S,R,O,A,L,I){super(),this._viewportElement=v,this._scrollArea=T,this._bufferService=S,this._optionsService=R,this._charSizeService=O,this._renderService=A,this._coreBrowserService=L,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=false,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new $.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,_.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(k=>this._activeBuffer=k.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(k=>this._renderDimensions=k)),this._handleThemeChange(I.colors),this.register(I.onChangeColors(k=>this._handleThemeChange(k))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(v){this._viewportElement.style.backgroundColor=v.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(v){if(v)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const T=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==T&&(this._lastRecordedBufferHeight=T,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const v=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==v&&(this._ignoreNextScrollEvent=true,this._viewportElement.scrollTop=v),this._refreshAnimationFrame=null}syncScrollArea(v=false){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(v);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(v)}_handleScroll(v){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=false,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:true});const T=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:T,suppressScrollEvent:true})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const v=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(v*(this._smoothScrollState.target-this._smoothScrollState.origin)),v<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(v,T){const S=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(T<0&&this._viewportElement.scrollTop!==0||T>0&&S<this._lastRecordedBufferHeight)||(v.cancelable&&v.preventDefault(),false)}handleWheel(v){const T=this._getPixelsScrolled(v);return T!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+T:this._smoothScrollState.target+=T,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=T,this._bubbleScroll(v,T))}scrollLines(v){if(v!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const T=v*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+T,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:v,suppressScrollEvent:false})}_getPixelsScrolled(v){if(v.deltaY===0||v.shiftKey)return 0;let T=this._applyScrollModifier(v.deltaY,v);return v.deltaMode===WheelEvent.DOM_DELTA_LINE?T*=this._currentRowHeight:v.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(T*=this._currentRowHeight*this._bufferService.rows),T}getBufferElements(v,T){var S;let R,O="";const A=[],L=T??this._bufferService.buffer.lines.length,I=this._bufferService.buffer.lines;for(let k=v;k<L;k++){const B=I.get(k);if(!B)continue;const U=(S=I.get(k+1))===null||S===void 0?void 0:S.isWrapped;if(O+=B.translateToString(!U),!U||k===I.length-1){const P=document.createElement("div");P.textContent=O,A.push(P),O.length>0&&(R=P),O=""}}return{bufferElements:A,cursorElement:R}}getLinesScrolled(v){if(v.deltaY===0||v.shiftKey)return 0;let T=this._applyScrollModifier(v.deltaY,v);return v.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(T/=this._currentRowHeight+0,this._wheelPartialScroll+=T,T=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):v.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(T*=this._bufferService.rows),T}_applyScrollModifier(v,T){const S=this._optionsService.rawOptions.fastScrollModifier;return S==="alt"&&T.altKey||S==="ctrl"&&T.ctrlKey||S==="shift"&&T.shiftKey?v*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:v*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(v){this._lastTouchY=v.touches[0].pageY}handleTouchMove(v){const T=this._lastTouchY-v.touches[0].pageY;return this._lastTouchY=v.touches[0].pageY,T!==0&&(this._viewportElement.scrollTop+=T,this._bubbleScroll(v,T))}};u.Viewport=f=c([d(2,y.IBufferService),d(3,y.IOptionsService),d(4,b.ICharSizeService),d(5,b.IRenderService),d(6,b.ICoreBrowserService),d(7,b.IThemeService)],f)},3107:function(m,u,p){var c=this&&this.__decorate||function(f,v,T,S){var R,O=arguments.length,A=O<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,T):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(f,v,T,S);else for(var L=f.length-1;L>=0;L--)(R=f[L])&&(A=(O<3?R(A):O>3?R(v,T,A):R(v,T))||A);return O>3&&A&&Object.defineProperty(v,T,A),A},d=this&&this.__param||function(f,v){return function(T,S){v(T,S,f)}};Object.defineProperty(u,"__esModule",{value:true}),u.BufferDecorationRenderer=void 0;const _=p(3656),b=p(4725),$=p(844),E=p(2585);let y=u.BufferDecorationRenderer=class extends $.Disposable{constructor(f,v,T,S){super(),this._screenElement=f,this._bufferService=v,this._decorationService=T,this._renderService=S,this._decorationElements=new Map,this._altBufferIsActive=false,this._dimensionsChanged=false,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=true,this._queueRefresh()})),this.register((0,_.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(R=>this._removeDecoration(R))),this.register((0,$.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const f of this._decorationService.decorations)this._renderDecoration(f);this._dimensionsChanged=false}_renderDecoration(f){this._refreshStyle(f),this._dimensionsChanged&&this._refreshXPosition(f)}_createElement(f){var v,T;const S=document.createElement("div");S.classList.add("xterm-decoration"),S.classList.toggle("xterm-decoration-top-layer",((v=f==null?void 0:f.options)===null||v===void 0?void 0:v.layer)==="top"),S.style.width=`${Math.round((f.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,S.style.height=(f.options.height||1)*this._renderService.dimensions.css.cell.height+"px",S.style.top=(f.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",S.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const R=(T=f.options.x)!==null&&T!==void 0?T:0;return R&&R>this._bufferService.cols&&(S.style.display="none"),this._refreshXPosition(f,S),S}_refreshStyle(f){const v=f.marker.line-this._bufferService.buffers.active.ydisp;if(v<0||v>=this._bufferService.rows)f.element&&(f.element.style.display="none",f.onRenderEmitter.fire(f.element));else{let T=this._decorationElements.get(f);T||(T=this._createElement(f),f.element=T,this._decorationElements.set(f,T),this._container.appendChild(T),f.onDispose(()=>{this._decorationElements.delete(f),T.remove()})),T.style.top=v*this._renderService.dimensions.css.cell.height+"px",T.style.display=this._altBufferIsActive?"none":"block",f.onRenderEmitter.fire(T)}}_refreshXPosition(f,v=f.element){var T;if(!v)return;const S=(T=f.options.x)!==null&&T!==void 0?T:0;(f.options.anchor||"left")==="right"?v.style.right=S?S*this._renderService.dimensions.css.cell.width+"px":"":v.style.left=S?S*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(f){var v;(v=this._decorationElements.get(f))===null||v===void 0||v.remove(),this._decorationElements.delete(f),f.dispose()}};u.BufferDecorationRenderer=y=c([d(1,E.IBufferService),d(2,E.IDecorationService),d(3,b.IRenderService)],y)},5871:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ColorZoneStore=void 0,u.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(p){if(p.options.overviewRulerOptions){for(const c of this._zones)if(c.color===p.options.overviewRulerOptions.color&&c.position===p.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,p.marker.line))return;if(this._lineAdjacentToZone(c,p.marker.line,p.options.overviewRulerOptions.position))return void this._addLineToZone(c,p.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=p.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=p.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=p.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=p.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:p.options.overviewRulerOptions.color,position:p.options.overviewRulerOptions.position,startBufferLine:p.marker.line,endBufferLine:p.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(p){this._linePadding=p}_lineIntersectsZone(p,c){return c>=p.startBufferLine&&c<=p.endBufferLine}_lineAdjacentToZone(p,c,d){return c>=p.startBufferLine-this._linePadding[d||"full"]&&c<=p.endBufferLine+this._linePadding[d||"full"]}_addLineToZone(p,c){p.startBufferLine=Math.min(p.startBufferLine,c),p.endBufferLine=Math.max(p.endBufferLine,c)}}},5744:function(m,u,p){var c=this&&this.__decorate||function(R,O,A,L){var I,k=arguments.length,B=k<3?O:L===null?L=Object.getOwnPropertyDescriptor(O,A):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(R,O,A,L);else for(var U=R.length-1;U>=0;U--)(I=R[U])&&(B=(k<3?I(B):k>3?I(O,A,B):I(O,A))||B);return k>3&&B&&Object.defineProperty(O,A,B),B},d=this&&this.__param||function(R,O){return function(A,L){O(A,L,R)}};Object.defineProperty(u,"__esModule",{value:true}),u.OverviewRulerRenderer=void 0;const _=p(5871),b=p(3656),$=p(4725),E=p(844),y=p(2585),f={full:0,left:0,center:0,right:0},v={full:0,left:0,center:0,right:0},T={full:0,left:0,center:0,right:0};let S=u.OverviewRulerRenderer=class extends E.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(R,O,A,L,I,k,B){var U;super(),this._viewportElement=R,this._screenElement=O,this._bufferService=A,this._decorationService=L,this._renderService=I,this._optionsService=k,this._coreBrowseService=B,this._colorZoneStore=new _.ColorZoneStore,this._shouldUpdateDimensions=true,this._shouldUpdateAnchor=true,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(U=this._viewportElement.parentElement)===null||U===void 0||U.insertBefore(this._canvas,this._viewportElement);const P=this._canvas.getContext("2d");if(!P)throw new Error("Ctx cannot be null");this._ctx=P,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,E.toDisposable)(()=>{var z;(z=this._canvas)===null||z===void 0||z.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,true))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,true)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(true),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(true))),this.register((0,b.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(true))),this._queueRefresh(true)}_refreshDrawConstants(){const R=Math.floor(this._canvas.width/3),O=Math.ceil(this._canvas.width/3);v.full=this._canvas.width,v.left=R,v.center=O,v.right=R,this._refreshDrawHeightConstants(),T.full=0,T.left=0,T.center=v.left,T.right=v.left+v.center}_refreshDrawHeightConstants(){f.full=Math.round(2*this._coreBrowseService.dpr);const R=this._canvas.height/this._bufferService.buffer.lines.length,O=Math.round(Math.max(Math.min(R,12),6)*this._coreBrowseService.dpr);f.left=O,f.center=O,f.right=O}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const O of this._decorationService.decorations)this._colorZoneStore.addDecoration(O);this._ctx.lineWidth=1;const R=this._colorZoneStore.zones;for(const O of R)O.position!=="full"&&this._renderColorZone(O);for(const O of R)O.position==="full"&&this._renderColorZone(O);this._shouldUpdateDimensions=false,this._shouldUpdateAnchor=false}_renderColorZone(R){this._ctx.fillStyle=R.color,this._ctx.fillRect(T[R.position||"full"],Math.round((this._canvas.height-1)*(R.startBufferLine/this._bufferService.buffers.active.lines.length)-f[R.position||"full"]/2),v[R.position||"full"],Math.round((this._canvas.height-1)*((R.endBufferLine-R.startBufferLine)/this._bufferService.buffers.active.lines.length)+f[R.position||"full"]))}_queueRefresh(R,O){this._shouldUpdateDimensions=R||this._shouldUpdateDimensions,this._shouldUpdateAnchor=O||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};u.OverviewRulerRenderer=S=c([d(2,y.IBufferService),d(3,y.IDecorationService),d(4,$.IRenderService),d(5,y.IOptionsService),d(6,$.ICoreBrowserService)],S)},2950:function(m,u,p){var c=this&&this.__decorate||function(y,f,v,T){var S,R=arguments.length,O=R<3?f:T===null?T=Object.getOwnPropertyDescriptor(f,v):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,f,v,T);else for(var A=y.length-1;A>=0;A--)(S=y[A])&&(O=(R<3?S(O):R>3?S(f,v,O):S(f,v))||O);return R>3&&O&&Object.defineProperty(f,v,O),O},d=this&&this.__param||function(y,f){return function(v,T){f(v,T,y)}};Object.defineProperty(u,"__esModule",{value:true}),u.CompositionHelper=void 0;const _=p(4725),b=p(2585),$=p(2584);let E=u.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(y,f,v,T,S,R){this._textarea=y,this._compositionView=f,this._bufferService=v,this._optionsService=T,this._coreService=S,this._renderService=R,this._isComposing=false,this._isSendingComposition=false,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=true,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(y){this._compositionView.textContent=y.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(true)}keydown(y){if(this._isComposing||this._isSendingComposition){if(y.keyCode===229||y.keyCode===16||y.keyCode===17||y.keyCode===18)return false;this._finalizeComposition(false)}return y.keyCode!==229||(this._handleAnyTextareaChanges(),false)}_finalizeComposition(y){if(this._compositionView.classList.remove("active"),this._isComposing=false,y){const f={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=true,setTimeout(()=>{if(this._isSendingComposition){let v;this._isSendingComposition=false,f.start+=this._dataAlreadySent.length,v=this._isComposing?this._textarea.value.substring(f.start,f.end):this._textarea.value.substring(f.start),v.length>0&&this._coreService.triggerDataEvent(v,true)}},0)}else{this._isSendingComposition=false;const f=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(f,true)}}_handleAnyTextareaChanges(){const y=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const f=this._textarea.value,v=f.replace(y,"");this._dataAlreadySent=v,f.length>y.length?this._coreService.triggerDataEvent(v,true):f.length<y.length?this._coreService.triggerDataEvent(`${$.C0.DEL}`,true):f.length===y.length&&f!==y&&this._coreService.triggerDataEvent(f,true)}},0)}updateCompositionElements(y){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const f=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),v=this._renderService.dimensions.css.cell.height,T=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,S=f*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=S+"px",this._compositionView.style.top=T+"px",this._compositionView.style.height=v+"px",this._compositionView.style.lineHeight=v+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const R=this._compositionView.getBoundingClientRect();this._textarea.style.left=S+"px",this._textarea.style.top=T+"px",this._textarea.style.width=Math.max(R.width,1)+"px",this._textarea.style.height=Math.max(R.height,1)+"px",this._textarea.style.lineHeight=R.height+"px"}y||setTimeout(()=>this.updateCompositionElements(true),0)}}};u.CompositionHelper=E=c([d(2,b.IBufferService),d(3,b.IOptionsService),d(4,b.ICoreService),d(5,_.IRenderService)],E)},9806:(m,u)=>{function p(c,d,_){const b=_.getBoundingClientRect(),$=c.getComputedStyle(_),E=parseInt($.getPropertyValue("padding-left")),y=parseInt($.getPropertyValue("padding-top"));return[d.clientX-b.left-E,d.clientY-b.top-y]}Object.defineProperty(u,"__esModule",{value:true}),u.getCoords=u.getCoordsRelativeToElement=void 0,u.getCoordsRelativeToElement=p,u.getCoords=function(c,d,_,b,$,E,y,f,v){if(!E)return;const T=p(c,d,_);return T?(T[0]=Math.ceil((T[0]+(v?y/2:0))/y),T[1]=Math.ceil(T[1]/f),T[0]=Math.min(Math.max(T[0],1),b+(v?1:0)),T[1]=Math.min(Math.max(T[1],1),$),T):void 0}},9504:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.moveToCellSequence=void 0;const c=p(2584);function d(f,v,T,S){const R=f-_(f,T),O=v-_(v,T),A=Math.abs(R-O)-function(L,I,k){let B=0;const U=L-_(L,k),P=I-_(I,k);for(let z=0;z<Math.abs(U-P);z++){const W=b(L,I)==="A"?-1:1,j=k.buffer.lines.get(U+W*z);j!=null&&j.isWrapped&&B++}return B}(f,v,T);return y(A,E(b(f,v),S))}function _(f,v){let T=0,S=v.buffer.lines.get(f),R=S==null?void 0:S.isWrapped;for(;R&&f>=0&&f<v.rows;)T++,S=v.buffer.lines.get(--f),R=S==null?void 0:S.isWrapped;return T}function b(f,v){return f>v?"A":"B"}function $(f,v,T,S,R,O){let A=f,L=v,I="";for(;A!==T||L!==S;)A+=R?1:-1,R&&A>O.cols-1?(I+=O.buffer.translateBufferLineToString(L,false,f,A),A=0,f=0,L++):!R&&A<0&&(I+=O.buffer.translateBufferLineToString(L,false,0,f+1),A=O.cols-1,f=A,L--);return I+O.buffer.translateBufferLineToString(L,false,f,A)}function E(f,v){const T=v?"O":"[";return c.C0.ESC+T+f}function y(f,v){f=Math.floor(f);let T="";for(let S=0;S<f;S++)T+=v;return T}u.moveToCellSequence=function(f,v,T,S){const R=T.buffer.x,O=T.buffer.y;if(!T.buffer.hasScrollback)return function(I,k,B,U,P,z){return d(k,U,P,z).length===0?"":y($(I,k,I,k-_(k,P),false,P).length,E("D",z))}(R,O,0,v,T,S)+d(O,v,T,S)+function(I,k,B,U,P,z){let W;W=d(k,U,P,z).length>0?U-_(U,P):k;const j=U,K=function(ee,M,F,V,X,H){let ne;return ne=d(F,V,X,H).length>0?V-_(V,X):M,ee<F&&ne<=V||ee>=F&&ne<V?"C":"D"}(I,k,B,U,P,z);return y($(I,W,B,j,K==="C",P).length,E(K,z))}(R,O,f,v,T,S);let A;if(O===v)return A=R>f?"D":"C",y(Math.abs(R-f),E(A,S));A=O>v?"D":"C";const L=Math.abs(O-v);return y(function(I,k){return k.cols-I}(O>v?f:R,T)+(L-1)*T.cols+1+((O>v?R:f)-1),E(A,S))}},1296:function(m,u,p){var c=this&&this.__decorate||function(P,z,W,j){var K,ee=arguments.length,M=ee<3?z:j===null?j=Object.getOwnPropertyDescriptor(z,W):j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(P,z,W,j);else for(var F=P.length-1;F>=0;F--)(K=P[F])&&(M=(ee<3?K(M):ee>3?K(z,W,M):K(z,W))||M);return ee>3&&M&&Object.defineProperty(z,W,M),M},d=this&&this.__param||function(P,z){return function(W,j){z(W,j,P)}};Object.defineProperty(u,"__esModule",{value:true}),u.DomRenderer=void 0;const _=p(3787),b=p(2550),$=p(2223),E=p(6171),y=p(4725),f=p(8055),v=p(8460),T=p(844),S=p(2585),R="xterm-dom-renderer-owner-",O="xterm-rows",A="xterm-fg-",L="xterm-bg-",I="xterm-focus",k="xterm-selection";let B=1,U=u.DomRenderer=class extends T.Disposable{constructor(P,z,W,j,K,ee,M,F,V,X){super(),this._element=P,this._screenElement=z,this._viewportElement=W,this._linkifier2=j,this._charSizeService=ee,this._optionsService=M,this._bufferService=F,this._coreBrowserService=V,this._themeService=X,this._terminalClass=B++,this._rowElements=[],this.onRequestRedraw=this.register(new v.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(O),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(k),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,E.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(H=>this._injectCss(H))),this._injectCss(this._themeService.colors),this._rowFactory=K.createInstance(_.DomRendererRowFactory,document),this._element.classList.add(R+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(H=>this._handleLinkHover(H))),this.register(this._linkifier2.onHideLinkUnderline(H=>this._handleLinkLeave(H))),this.register((0,T.toDisposable)(()=>{this._element.classList.remove(R+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new b.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const P=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*P,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*P),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/P),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/P),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const W of this._rowElements)W.style.width=`${this.dimensions.css.canvas.width}px`,W.style.height=`${this.dimensions.css.cell.height}px`,W.style.lineHeight=`${this.dimensions.css.cell.height}px`,W.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const z=`${this._terminalSelector} .${O} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=z,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(P){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let z=`${this._terminalSelector} .${O} { color: ${P.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;z+=`${this._terminalSelector} .${O} .xterm-dim { color: ${f.color.multiplyOpacity(P.foreground,.5).css};}`,z+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,z+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",z+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${P.cursor.css};  color: ${P.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${P.cursor.css}; }}`,z+=`${this._terminalSelector} .${O}.${I} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${O}.${I} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${O} .xterm-cursor.xterm-cursor-block { background-color: ${P.cursor.css}; color: ${P.cursorAccent.css};}${this._terminalSelector} .${O} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${P.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${O} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${P.cursor.css} inset;}${this._terminalSelector} .${O} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${P.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,z+=`${this._terminalSelector} .${k} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${k} div { position: absolute; background-color: ${P.selectionBackgroundOpaque.css};}${this._terminalSelector} .${k} div { position: absolute; background-color: ${P.selectionInactiveBackgroundOpaque.css};}`;for(const[W,j]of P.ansi.entries())z+=`${this._terminalSelector} .${A}${W} { color: ${j.css}; }${this._terminalSelector} .${A}${W}.xterm-dim { color: ${f.color.multiplyOpacity(j,.5).css}; }${this._terminalSelector} .${L}${W} { background-color: ${j.css}; }`;z+=`${this._terminalSelector} .${A}${$.INVERTED_DEFAULT_COLOR} { color: ${f.color.opaque(P.background).css}; }${this._terminalSelector} .${A}${$.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${f.color.multiplyOpacity(f.color.opaque(P.background),.5).css}; }${this._terminalSelector} .${L}${$.INVERTED_DEFAULT_COLOR} { background-color: ${P.foreground.css}; }`,this._themeStyleElement.textContent=z}_setDefaultSpacing(){const P=this.dimensions.css.cell.width-this._widthCache.get("W",false,false);this._rowContainer.style.letterSpacing=`${P}px`,this._rowFactory.defaultSpacing=P}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(P,z){for(let W=this._rowElements.length;W<=z;W++){const j=document.createElement("div");this._rowContainer.appendChild(j),this._rowElements.push(j)}for(;this._rowElements.length>z;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(P,z){this._refreshRowElements(P,z),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(I)}handleFocus(){this._rowContainer.classList.add(I),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(P,z,W){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(P,z,W),this.renderRows(0,this._bufferService.rows-1),!P||!z)return;const j=P[1]-this._bufferService.buffer.ydisp,K=z[1]-this._bufferService.buffer.ydisp,ee=Math.max(j,0),M=Math.min(K,this._bufferService.rows-1);if(ee>=this._bufferService.rows||M<0)return;const F=document.createDocumentFragment();if(W){const V=P[0]>z[0];F.appendChild(this._createSelectionElement(ee,V?z[0]:P[0],V?P[0]:z[0],M-ee+1))}else{const V=j===ee?P[0]:0,X=ee===K?z[0]:this._bufferService.cols;F.appendChild(this._createSelectionElement(ee,V,X));const H=M-ee-1;if(F.appendChild(this._createSelectionElement(ee+1,0,this._bufferService.cols,H)),ee!==M){const ne=K===M?z[0]:this._bufferService.cols;F.appendChild(this._createSelectionElement(M,0,ne))}}this._selectionContainer.appendChild(F)}_createSelectionElement(P,z,W,j=1){const K=document.createElement("div");return K.style.height=j*this.dimensions.css.cell.height+"px",K.style.top=P*this.dimensions.css.cell.height+"px",K.style.left=z*this.dimensions.css.cell.width+"px",K.style.width=this.dimensions.css.cell.width*(W-z)+"px",K}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const P of this._rowElements)P.replaceChildren()}renderRows(P,z){const W=this._bufferService.buffer,j=W.ybase+W.y,K=Math.min(W.x,this._bufferService.cols-1),ee=this._optionsService.rawOptions.cursorBlink,M=this._optionsService.rawOptions.cursorStyle,F=this._optionsService.rawOptions.cursorInactiveStyle;for(let V=P;V<=z;V++){const X=V+W.ydisp,H=this._rowElements[V],ne=W.lines.get(X);if(!H||!ne)break;H.replaceChildren(...this._rowFactory.createRow(ne,X,X===j,M,F,K,ee,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${R}${this._terminalClass}`}_handleLinkHover(P){this._setCellUnderline(P.x1,P.x2,P.y1,P.y2,P.cols,true)}_handleLinkLeave(P){this._setCellUnderline(P.x1,P.x2,P.y1,P.y2,P.cols,false)}_setCellUnderline(P,z,W,j,K,ee){W<0&&(P=0),j<0&&(z=0);const M=this._bufferService.rows-1;W=Math.max(Math.min(W,M),0),j=Math.max(Math.min(j,M),0),K=Math.min(K,this._bufferService.cols);const F=this._bufferService.buffer,V=F.ybase+F.y,X=Math.min(F.x,K-1),H=this._optionsService.rawOptions.cursorBlink,ne=this._optionsService.rawOptions.cursorStyle,Ie=this._optionsService.rawOptions.cursorInactiveStyle;for(let de=W;de<=j;++de){const ot=de+F.ydisp,x=this._rowElements[de],te=F.lines.get(ot);if(!x||!te)break;x.replaceChildren(...this._rowFactory.createRow(te,ot,ot===V,ne,Ie,X,H,this.dimensions.css.cell.width,this._widthCache,ee?de===W?P:0:-1,ee?(de===j?z:K)-1:-1))}}};u.DomRenderer=U=c([d(4,S.IInstantiationService),d(5,y.ICharSizeService),d(6,S.IOptionsService),d(7,S.IBufferService),d(8,y.ICoreBrowserService),d(9,y.IThemeService)],U)},3787:function(m,u,p){var c=this&&this.__decorate||function(A,L,I,k){var B,U=arguments.length,P=U<3?L:k===null?k=Object.getOwnPropertyDescriptor(L,I):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(A,L,I,k);else for(var z=A.length-1;z>=0;z--)(B=A[z])&&(P=(U<3?B(P):U>3?B(L,I,P):B(L,I))||P);return U>3&&P&&Object.defineProperty(L,I,P),P},d=this&&this.__param||function(A,L){return function(I,k){L(I,k,A)}};Object.defineProperty(u,"__esModule",{value:true}),u.DomRendererRowFactory=void 0;const _=p(2223),b=p(643),$=p(511),E=p(2585),y=p(8055),f=p(4725),v=p(4269),T=p(6171),S=p(3734);let R=u.DomRendererRowFactory=class{constructor(A,L,I,k,B,U,P){this._document=A,this._characterJoinerService=L,this._optionsService=I,this._coreBrowserService=k,this._coreService=B,this._decorationService=U,this._themeService=P,this._workCell=new $.CellData,this._columnSelectMode=false,this.defaultSpacing=0}handleSelectionChanged(A,L,I){this._selectionStart=A,this._selectionEnd=L,this._columnSelectMode=I}createRow(A,L,I,k,B,U,P,z,W,j,K){const ee=[],M=this._characterJoinerService.getJoinedCharacters(L),F=this._themeService.colors;let V,X=A.getNoBgTrimmedLength();I&&X<U+1&&(X=U+1);let H=0,ne="",Ie=0,de=0,ot=0,x=false,te=0,ce=false,ae=0;const De=[],$e=j!==-1&&K!==-1;for(let st=0;st<X;st++){A.loadCell(st,this._workCell);let bt=this._workCell.getWidth();if(bt===0)continue;let Ut=false,jt=st,Ve=this._workCell;if(M.length>0&&st===M[0][0]){Ut=true;const Rt=M.shift();Ve=new v.JoinedCellData(this._workCell,A.translateToString(true,Rt[0],Rt[1]),Rt[1]-Rt[0]),jt=Rt[1]-1,bt=Ve.getWidth()}const Ss=this._isCellInSelection(st,L),Cs=I&&st===U,Os=$e&&st>=j&&st<=K;let zs=false;this._decorationService.forEachDecorationAtCell(st,L,void 0,Rt=>{zs=true});let xs=Ve.getChars()||b.WHITESPACE_CELL_CHAR;if(xs===" "&&(Ve.isUnderline()||Ve.isOverline())&&(xs=" "),ae=bt*z-W.get(xs,Ve.isBold(),Ve.isItalic()),V){if(H&&(Ss&&ce||!Ss&&!ce&&Ve.bg===Ie)&&(Ss&&ce&&F.selectionForeground||Ve.fg===de)&&Ve.extended.ext===ot&&Os===x&&ae===te&&!Cs&&!Ut&&!zs){ne+=xs,H++;continue}H&&(V.textContent=ne),V=this._document.createElement("span"),H=0,ne=""}else V=this._document.createElement("span");if(Ie=Ve.bg,de=Ve.fg,ot=Ve.extended.ext,x=Os,te=ae,ce=Ss,Ut&&U>=st&&U<=jt&&(U=st),!this._coreService.isCursorHidden&&Cs){if(De.push("xterm-cursor"),this._coreBrowserService.isFocused)P&&De.push("xterm-cursor-blink"),De.push(k==="bar"?"xterm-cursor-bar":k==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(B)switch(B){case"outline":De.push("xterm-cursor-outline");break;case"block":De.push("xterm-cursor-block");break;case"bar":De.push("xterm-cursor-bar");break;case"underline":De.push("xterm-cursor-underline")}}if(Ve.isBold()&&De.push("xterm-bold"),Ve.isItalic()&&De.push("xterm-italic"),Ve.isDim()&&De.push("xterm-dim"),ne=Ve.isInvisible()?b.WHITESPACE_CELL_CHAR:Ve.getChars()||b.WHITESPACE_CELL_CHAR,Ve.isUnderline()&&(De.push(`xterm-underline-${Ve.extended.underlineStyle}`),ne===" "&&(ne=" "),!Ve.isUnderlineColorDefault()))if(Ve.isUnderlineColorRGB())V.style.textDecorationColor=`rgb(${S.AttributeData.toColorRGB(Ve.getUnderlineColor()).join(",")})`;else{let Rt=Ve.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Ve.isBold()&&Rt<8&&(Rt+=8),V.style.textDecorationColor=F.ansi[Rt].css}Ve.isOverline()&&(De.push("xterm-overline"),ne===" "&&(ne=" ")),Ve.isStrikethrough()&&De.push("xterm-strikethrough"),Os&&(V.style.textDecoration="underline");let kt=Ve.getFgColor(),ts=Ve.getFgColorMode(),me=Ve.getBgColor(),He=Ve.getBgColorMode();const Dt=!!Ve.isInverse();if(Dt){const Rt=kt;kt=me,me=Rt;const Li=ts;ts=He,He=Li}let ve,Bs,vs,ks=false;switch(this._decorationService.forEachDecorationAtCell(st,L,void 0,Rt=>{Rt.options.layer!=="top"&&ks||(Rt.backgroundColorRGB&&(He=50331648,me=Rt.backgroundColorRGB.rgba>>8&16777215,ve=Rt.backgroundColorRGB),Rt.foregroundColorRGB&&(ts=50331648,kt=Rt.foregroundColorRGB.rgba>>8&16777215,Bs=Rt.foregroundColorRGB),ks=Rt.options.layer==="top")}),!ks&&Ss&&(ve=this._coreBrowserService.isFocused?F.selectionBackgroundOpaque:F.selectionInactiveBackgroundOpaque,me=ve.rgba>>8&16777215,He=50331648,ks=true,F.selectionForeground&&(ts=50331648,kt=F.selectionForeground.rgba>>8&16777215,Bs=F.selectionForeground)),ks&&De.push("xterm-decoration-top"),He){case 16777216:case 33554432:vs=F.ansi[me],De.push(`xterm-bg-${me}`);break;case 50331648:vs=y.rgba.toColor(me>>16,me>>8&255,255&me),this._addStyle(V,`background-color:#${O((me>>>0).toString(16),"0",6)}`);break;default:Dt?(vs=F.foreground,De.push(`xterm-bg-${_.INVERTED_DEFAULT_COLOR}`)):vs=F.background}switch(ve||Ve.isDim()&&(ve=y.color.multiplyOpacity(vs,.5)),ts){case 16777216:case 33554432:Ve.isBold()&&kt<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(kt+=8),this._applyMinimumContrast(V,vs,F.ansi[kt],Ve,ve,void 0)||De.push(`xterm-fg-${kt}`);break;case 50331648:const Rt=y.rgba.toColor(kt>>16&255,kt>>8&255,255&kt);this._applyMinimumContrast(V,vs,Rt,Ve,ve,Bs)||this._addStyle(V,`color:#${O(kt.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(V,vs,F.foreground,Ve,ve,void 0)||Dt&&De.push(`xterm-fg-${_.INVERTED_DEFAULT_COLOR}`)}De.length&&(V.className=De.join(" "),De.length=0),Cs||Ut||zs?V.textContent=ne:H++,ae!==this.defaultSpacing&&(V.style.letterSpacing=`${ae}px`),ee.push(V),st=jt}return V&&H&&(V.textContent=ne),ee}_applyMinimumContrast(A,L,I,k,B,U){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,T.excludeFromContrastRatioDemands)(k.getCode()))return false;const P=this._getContrastCache(k);let z;if(B||U||(z=P.getColor(L.rgba,I.rgba)),z===void 0){const W=this._optionsService.rawOptions.minimumContrastRatio/(k.isDim()?2:1);z=y.color.ensureContrastRatio(B||L,U||I,W),P.setColor((B||L).rgba,(U||I).rgba,z??null)}return!!z&&(this._addStyle(A,`color:${z.css}`),true)}_getContrastCache(A){return A.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(A,L){A.setAttribute("style",`${A.getAttribute("style")||""}${L};`)}_isCellInSelection(A,L){const I=this._selectionStart,k=this._selectionEnd;return!(!I||!k)&&(this._columnSelectMode?I[0]<=k[0]?A>=I[0]&&L>=I[1]&&A<k[0]&&L<=k[1]:A<I[0]&&L>=I[1]&&A>=k[0]&&L<=k[1]:L>I[1]&&L<k[1]||I[1]===k[1]&&L===I[1]&&A>=I[0]&&A<k[0]||I[1]<k[1]&&L===k[1]&&A<k[0]||I[1]<k[1]&&L===I[1]&&A>=I[0])}};function O(A,L,I){for(;A.length<I;)A=L+A;return A}u.DomRendererRowFactory=R=c([d(1,f.ICharacterJoinerService),d(2,E.IOptionsService),d(3,f.ICoreBrowserService),d(4,E.ICoreService),d(5,E.IDecorationService),d(6,f.IThemeService)],R)},2550:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.WidthCache=void 0,u.WidthCache=class{constructor(p){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=p.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const c=p.createElement("span"),d=p.createElement("span");d.style.fontWeight="bold";const _=p.createElement("span");_.style.fontStyle="italic";const b=p.createElement("span");b.style.fontWeight="bold",b.style.fontStyle="italic",this._measureElements=[c,d,_,b],this._container.appendChild(c),this._container.appendChild(d),this._container.appendChild(_),this._container.appendChild(b),p.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(p,c,d,_){p===this._font&&c===this._fontSize&&d===this._weight&&_===this._weightBold||(this._font=p,this._fontSize=c,this._weight=d,this._weightBold=_,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${d}`,this._measureElements[1].style.fontWeight=`${_}`,this._measureElements[2].style.fontWeight=`${d}`,this._measureElements[3].style.fontWeight=`${_}`,this.clear())}get(p,c,d){let _=0;if(!c&&!d&&p.length===1&&(_=p.charCodeAt(0))<256)return this._flat[_]!==-9999?this._flat[_]:this._flat[_]=this._measure(p,0);let b=p;c&&(b+="B"),d&&(b+="I");let $=this._holey.get(b);if($===void 0){let E=0;c&&(E|=1),d&&(E|=2),$=this._measure(p,E),this._holey.set(b,$)}return $}_measure(p,c){const d=this._measureElements[c];return d.textContent=p.repeat(32),d.offsetWidth/32}}},2223:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.TEXT_BASELINE=u.DIM_OPACITY=u.INVERTED_DEFAULT_COLOR=void 0;const c=p(6114);u.INVERTED_DEFAULT_COLOR=257,u.DIM_OPACITY=.5,u.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(m,u)=>{function p(c){return 57508<=c&&c<=57558}Object.defineProperty(u,"__esModule",{value:true}),u.createRenderDimensions=u.excludeFromContrastRatioDemands=u.isRestrictedPowerlineGlyph=u.isPowerlineGlyph=u.throwIfFalsy=void 0,u.throwIfFalsy=function(c){if(!c)throw new Error("value must not be falsy");return c},u.isPowerlineGlyph=p,u.isRestrictedPowerlineGlyph=function(c){return 57520<=c&&c<=57527},u.excludeFromContrastRatioDemands=function(c){return p(c)||function(d){return 9472<=d&&d<=9631}(c)},u.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.SelectionModel=void 0,u.SelectionModel=class{constructor(p){this._bufferService=p,this.isSelectAllActive=false,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=false,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const p=this.selectionStart[0]+this.selectionStartLength;return p>this._bufferService.cols?p%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(p/this._bufferService.cols)-1]:[p%this._bufferService.cols,this.selectionStart[1]+Math.floor(p/this._bufferService.cols)]:[p,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const p=this.selectionStart[0]+this.selectionStartLength;return p>this._bufferService.cols?[p%this._bufferService.cols,this.selectionStart[1]+Math.floor(p/this._bufferService.cols)]:[Math.max(p,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const p=this.selectionStart,c=this.selectionEnd;return!(!p||!c)&&(p[1]>c[1]||p[1]===c[1]&&p[0]>c[0])}handleTrim(p){return this.selectionStart&&(this.selectionStart[1]-=p),this.selectionEnd&&(this.selectionEnd[1]-=p),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),true):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),false)}}},428:function(m,u,p){var c=this&&this.__decorate||function(f,v,T,S){var R,O=arguments.length,A=O<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,T):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(f,v,T,S);else for(var L=f.length-1;L>=0;L--)(R=f[L])&&(A=(O<3?R(A):O>3?R(v,T,A):R(v,T))||A);return O>3&&A&&Object.defineProperty(v,T,A),A},d=this&&this.__param||function(f,v){return function(T,S){v(T,S,f)}};Object.defineProperty(u,"__esModule",{value:true}),u.CharSizeService=void 0;const _=p(2585),b=p(8460),$=p(844);let E=u.CharSizeService=class extends $.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(f,v,T){super(),this._optionsService=T,this.width=0,this.height=0,this._onCharSizeChange=this.register(new b.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new y(f,v,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const f=this._measureStrategy.measure();f.width===this.width&&f.height===this.height||(this.width=f.width,this.height=f.height,this._onCharSizeChange.fire())}};u.CharSizeService=E=c([d(2,_.IOptionsService)],E);class y{constructor(v,T,S){this._document=v,this._parentElement=T,this._optionsService=S,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const v={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return v.width!==0&&v.height!==0&&(this._result.width=v.width/32,this._result.height=Math.ceil(v.height)),this._result}}},4269:function(m,u,p){var c=this&&this.__decorate||function(v,T,S,R){var O,A=arguments.length,L=A<3?T:R===null?R=Object.getOwnPropertyDescriptor(T,S):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(v,T,S,R);else for(var I=v.length-1;I>=0;I--)(O=v[I])&&(L=(A<3?O(L):A>3?O(T,S,L):O(T,S))||L);return A>3&&L&&Object.defineProperty(T,S,L),L},d=this&&this.__param||function(v,T){return function(S,R){T(S,R,v)}};Object.defineProperty(u,"__esModule",{value:true}),u.CharacterJoinerService=u.JoinedCellData=void 0;const _=p(3734),b=p(643),$=p(511),E=p(2585);class y extends _.AttributeData{constructor(T,S,R){super(),this.content=0,this.combinedData="",this.fg=T.fg,this.bg=T.bg,this.combinedData=S,this._width=R}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(T){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}u.JoinedCellData=y;let f=u.CharacterJoinerService=class mR{constructor(T){this._bufferService=T,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new $.CellData}register(T){const S={id:this._nextCharacterJoinerId++,handler:T};return this._characterJoiners.push(S),S.id}deregister(T){for(let S=0;S<this._characterJoiners.length;S++)if(this._characterJoiners[S].id===T)return this._characterJoiners.splice(S,1),true;return false}getJoinedCharacters(T){if(this._characterJoiners.length===0)return[];const S=this._bufferService.buffer.lines.get(T);if(!S||S.length===0)return[];const R=[],O=S.translateToString(true);let A=0,L=0,I=0,k=S.getFg(0),B=S.getBg(0);for(let U=0;U<S.getTrimmedLength();U++)if(S.loadCell(U,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==k||this._workCell.bg!==B){if(U-A>1){const P=this._getJoinedRanges(O,I,L,S,A);for(let z=0;z<P.length;z++)R.push(P[z])}A=U,I=L,k=this._workCell.fg,B=this._workCell.bg}L+=this._workCell.getChars().length||b.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-A>1){const U=this._getJoinedRanges(O,I,L,S,A);for(let P=0;P<U.length;P++)R.push(U[P])}return R}_getJoinedRanges(T,S,R,O,A){const L=T.substring(S,R);let I=[];try{I=this._characterJoiners[0].handler(L)}catch(k){console.error(k)}for(let k=1;k<this._characterJoiners.length;k++)try{const B=this._characterJoiners[k].handler(L);for(let U=0;U<B.length;U++)mR._mergeRanges(I,B[U])}catch(B){console.error(B)}return this._stringRangesToCellRanges(I,O,A),I}_stringRangesToCellRanges(T,S,R){let O=0,A=false,L=0,I=T[O];if(I){for(let k=R;k<this._bufferService.cols;k++){const B=S.getWidth(k),U=S.getString(k).length||b.WHITESPACE_CELL_CHAR.length;if(B!==0){if(!A&&I[0]<=L&&(I[0]=k,A=true),I[1]<=L){if(I[1]=k,I=T[++O],!I)break;I[0]<=L?(I[0]=k,A=true):A=false}L+=U}}I&&(I[1]=this._bufferService.cols)}}static _mergeRanges(T,S){let R=false;for(let O=0;O<T.length;O++){const A=T[O];if(R){if(S[1]<=A[0])return T[O-1][1]=S[1],T;if(S[1]<=A[1])return T[O-1][1]=Math.max(S[1],A[1]),T.splice(O,1),T;T.splice(O,1),O--}else{if(S[1]<=A[0])return T.splice(O,0,S),T;if(S[1]<=A[1])return A[0]=Math.min(S[0],A[0]),T;S[0]<A[1]&&(A[0]=Math.min(S[0],A[0]),R=true)}}return R?T[T.length-1][1]=S[1]:T.push(S),T}};u.CharacterJoinerService=f=c([d(0,E.IBufferService)],f)},5114:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CoreBrowserService=void 0,u.CoreBrowserService=class{constructor(p,c){this._textarea=p,this.window=c,this._isFocused=false,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=true),this._textarea.addEventListener("blur",()=>this._isFocused=false)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(m,u,p){var c=this&&this.__decorate||function(E,y,f,v){var T,S=arguments.length,R=S<3?y:v===null?v=Object.getOwnPropertyDescriptor(y,f):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(E,y,f,v);else for(var O=E.length-1;O>=0;O--)(T=E[O])&&(R=(S<3?T(R):S>3?T(y,f,R):T(y,f))||R);return S>3&&R&&Object.defineProperty(y,f,R),R},d=this&&this.__param||function(E,y){return function(f,v){y(f,v,E)}};Object.defineProperty(u,"__esModule",{value:true}),u.MouseService=void 0;const _=p(4725),b=p(9806);let $=u.MouseService=class{constructor(E,y){this._renderService=E,this._charSizeService=y}getCoords(E,y,f,v,T){return(0,b.getCoords)(window,E,y,f,v,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,T)}getMouseReportCoords(E,y){const f=(0,b.getCoordsRelativeToElement)(window,E,y);if(this._charSizeService.hasValidSize)return f[0]=Math.min(Math.max(f[0],0),this._renderService.dimensions.css.canvas.width-1),f[1]=Math.min(Math.max(f[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(f[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(f[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(f[0]),y:Math.floor(f[1])}}};u.MouseService=$=c([d(0,_.IRenderService),d(1,_.ICharSizeService)],$)},3230:function(m,u,p){var c=this&&this.__decorate||function(R,O,A,L){var I,k=arguments.length,B=k<3?O:L===null?L=Object.getOwnPropertyDescriptor(O,A):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(R,O,A,L);else for(var U=R.length-1;U>=0;U--)(I=R[U])&&(B=(k<3?I(B):k>3?I(O,A,B):I(O,A))||B);return k>3&&B&&Object.defineProperty(O,A,B),B},d=this&&this.__param||function(R,O){return function(A,L){O(A,L,R)}};Object.defineProperty(u,"__esModule",{value:true}),u.RenderService=void 0;const _=p(3656),b=p(6193),$=p(5596),E=p(4725),y=p(8460),f=p(844),v=p(7226),T=p(2585);let S=u.RenderService=class extends f.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(R,O,A,L,I,k,B,U){if(super(),this._rowCount=R,this._charSizeService=L,this._renderer=this.register(new f.MutableDisposable),this._pausedResizeTask=new v.DebouncedIdleTask,this._isPaused=false,this._needsFullRefresh=false,this._isNextRenderRedrawOnly=true,this._needsSelectionRefresh=false,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:false},this._onDimensionsChange=this.register(new y.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new y.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new y.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new y.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new b.RenderDebouncer(B.window,(P,z)=>this._renderRows(P,z)),this.register(this._renderDebouncer),this._screenDprMonitor=new $.ScreenDprMonitor(B.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(k.onResize(()=>this._fullRefresh())),this.register(k.buffers.onBufferActivate(()=>{var P;return(P=this._renderer.value)===null||P===void 0?void 0:P.clear()})),this.register(A.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(I.onDecorationRegistered(()=>this._fullRefresh())),this.register(I.onDecorationRemoved(()=>this._fullRefresh())),this.register(A.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(k.cols,k.rows),this._fullRefresh()})),this.register(A.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(k.buffer.y,k.buffer.y,true))),this.register((0,_.addDisposableDomListener)(B.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(U.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in B.window){const P=new B.window.IntersectionObserver(z=>this._handleIntersectionChange(z[z.length-1]),{threshold:0});P.observe(O),this.register({dispose:()=>P.disconnect()})}}_handleIntersectionChange(R){this._isPaused=R.isIntersecting===void 0?R.intersectionRatio===0:!R.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=false)}refreshRows(R,O,A=false){this._isPaused?this._needsFullRefresh=true:(A||(this._isNextRenderRedrawOnly=false),this._renderDebouncer.refresh(R,O,this._rowCount))}_renderRows(R,O){this._renderer.value&&(R=Math.min(R,this._rowCount-1),O=Math.min(O,this._rowCount-1),this._renderer.value.renderRows(R,O),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=false),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:R,end:O}),this._onRender.fire({start:R,end:O}),this._isNextRenderRedrawOnly=true)}resize(R,O){this._rowCount=O,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(R){this._renderer.value=R,this._renderer.value.onRequestRedraw(O=>this.refreshRows(O.start,O.end,true)),this._needsSelectionRefresh=true,this._fullRefresh()}addRefreshCallback(R){return this._renderDebouncer.addRefreshCallback(R)}_fullRefresh(){this._isPaused?this._needsFullRefresh=true:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var R,O;this._renderer.value&&((O=(R=this._renderer.value).clearTextureAtlas)===null||O===void 0||O.call(R),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(R,O){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(R,O)):this._renderer.value.handleResize(R,O),this._fullRefresh())}handleCharSizeChanged(){var R;(R=this._renderer.value)===null||R===void 0||R.handleCharSizeChanged()}handleBlur(){var R;(R=this._renderer.value)===null||R===void 0||R.handleBlur()}handleFocus(){var R;(R=this._renderer.value)===null||R===void 0||R.handleFocus()}handleSelectionChanged(R,O,A){var L;this._selectionState.start=R,this._selectionState.end=O,this._selectionState.columnSelectMode=A,(L=this._renderer.value)===null||L===void 0||L.handleSelectionChanged(R,O,A)}handleCursorMove(){var R;(R=this._renderer.value)===null||R===void 0||R.handleCursorMove()}clear(){var R;(R=this._renderer.value)===null||R===void 0||R.clear()}};u.RenderService=S=c([d(2,T.IOptionsService),d(3,E.ICharSizeService),d(4,T.IDecorationService),d(5,T.IBufferService),d(6,E.ICoreBrowserService),d(7,E.IThemeService)],S)},9312:function(m,u,p){var c=this&&this.__decorate||function(I,k,B,U){var P,z=arguments.length,W=z<3?k:U===null?U=Object.getOwnPropertyDescriptor(k,B):U;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(I,k,B,U);else for(var j=I.length-1;j>=0;j--)(P=I[j])&&(W=(z<3?P(W):z>3?P(k,B,W):P(k,B))||W);return z>3&&W&&Object.defineProperty(k,B,W),W},d=this&&this.__param||function(I,k){return function(B,U){k(B,U,I)}};Object.defineProperty(u,"__esModule",{value:true}),u.SelectionService=void 0;const _=p(9806),b=p(9504),$=p(456),E=p(4725),y=p(8460),f=p(844),v=p(6114),T=p(4841),S=p(511),R=p(2585),O=String.fromCharCode(160),A=new RegExp(O,"g");let L=u.SelectionService=class extends f.Disposable{constructor(I,k,B,U,P,z,W,j,K){super(),this._element=I,this._screenElement=k,this._linkifier=B,this._bufferService=U,this._coreService=P,this._mouseService=z,this._optionsService=W,this._renderService=j,this._coreBrowserService=K,this._dragScrollAmount=0,this._enabled=true,this._workCell=new S.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=false,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new y.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new y.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new y.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new y.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=ee=>this._handleMouseMove(ee),this._mouseUpListener=ee=>this._handleMouseUp(ee),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(ee=>this._handleTrim(ee)),this.register(this._bufferService.buffers.onBufferActivate(ee=>this._handleBufferActivate(ee))),this.enable(),this._model=new $.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,f.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=false}enable(){this._enabled=true}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const I=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;return!(!I||!k||I[0]===k[0]&&I[1]===k[1])}get selectionText(){const I=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;if(!I||!k)return"";const B=this._bufferService.buffer,U=[];if(this._activeSelectionMode===3){if(I[0]===k[0])return"";const P=I[0]<k[0]?I[0]:k[0],z=I[0]<k[0]?k[0]:I[0];for(let W=I[1];W<=k[1];W++){const j=B.translateBufferLineToString(W,true,P,z);U.push(j)}}else{const P=I[1]===k[1]?k[0]:void 0;U.push(B.translateBufferLineToString(I[1],true,I[0],P));for(let z=I[1]+1;z<=k[1]-1;z++){const W=B.lines.get(z),j=B.translateBufferLineToString(z,true);W!=null&&W.isWrapped?U[U.length-1]+=j:U.push(j)}if(I[1]!==k[1]){const z=B.lines.get(k[1]),W=B.translateBufferLineToString(k[1],true,0,k[0]);z&&z.isWrapped?U[U.length-1]+=W:U.push(W)}}return U.map(P=>P.replace(A," ")).join(v.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(I){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),v.isLinux&&I&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(I){const k=this._getMouseBufferCoords(I),B=this._model.finalSelectionStart,U=this._model.finalSelectionEnd;return!!(B&&U&&k)&&this._areCoordsInSelection(k,B,U)}isCellInSelection(I,k){const B=this._model.finalSelectionStart,U=this._model.finalSelectionEnd;return!(!B||!U)&&this._areCoordsInSelection([I,k],B,U)}_areCoordsInSelection(I,k,B){return I[1]>k[1]&&I[1]<B[1]||k[1]===B[1]&&I[1]===k[1]&&I[0]>=k[0]&&I[0]<B[0]||k[1]<B[1]&&I[1]===B[1]&&I[0]<B[0]||k[1]<B[1]&&I[1]===k[1]&&I[0]>=k[0]}_selectWordAtCursor(I,k){var B,U;const P=(U=(B=this._linkifier.currentLink)===null||B===void 0?void 0:B.link)===null||U===void 0?void 0:U.range;if(P)return this._model.selectionStart=[P.start.x-1,P.start.y-1],this._model.selectionStartLength=(0,T.getRangeLength)(P,this._bufferService.cols),this._model.selectionEnd=void 0,true;const z=this._getMouseBufferCoords(I);return!!z&&(this._selectWordAt(z,k),this._model.selectionEnd=void 0,true)}selectAll(){this._model.isSelectAllActive=true,this.refresh(),this._onSelectionChange.fire()}selectLines(I,k){this._model.clearSelection(),I=Math.max(I,0),k=Math.min(k,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,I],this._model.selectionEnd=[this._bufferService.cols,k],this.refresh(),this._onSelectionChange.fire()}_handleTrim(I){this._model.handleTrim(I)&&this.refresh()}_getMouseBufferCoords(I){const k=this._mouseService.getCoords(I,this._screenElement,this._bufferService.cols,this._bufferService.rows,true);if(k)return k[0]--,k[1]--,k[1]+=this._bufferService.buffer.ydisp,k}_getMouseEventScrollAmount(I){let k=(0,_.getCoordsRelativeToElement)(this._coreBrowserService.window,I,this._screenElement)[1];const B=this._renderService.dimensions.css.canvas.height;return k>=0&&k<=B?0:(k>B&&(k-=B),k=Math.min(Math.max(k,-50),50),k/=50,k/Math.abs(k)+Math.round(14*k))}shouldForceSelection(I){return v.isMac?I.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:I.shiftKey}handleMouseDown(I){if(this._mouseDownTimeStamp=I.timeStamp,(I.button!==2||!this.hasSelection)&&I.button===0){if(!this._enabled){if(!this.shouldForceSelection(I))return;I.stopPropagation()}I.preventDefault(),this._dragScrollAmount=0,this._enabled&&I.shiftKey?this._handleIncrementalClick(I):I.detail===1?this._handleSingleClick(I):I.detail===2?this._handleDoubleClick(I):I.detail===3&&this._handleTripleClick(I),this._addMouseDownListeners(),this.refresh(true)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(I){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(I))}_handleSingleClick(I){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=false,this._activeSelectionMode=this.shouldColumnSelect(I)?3:0,this._model.selectionStart=this._getMouseBufferCoords(I),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const k=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);k&&k.length!==this._model.selectionStart[0]&&k.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(I){this._selectWordAtCursor(I,true)&&(this._activeSelectionMode=1)}_handleTripleClick(I){const k=this._getMouseBufferCoords(I);k&&(this._activeSelectionMode=2,this._selectLineAt(k[1]))}shouldColumnSelect(I){return I.altKey&&!(v.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(I){if(I.stopImmediatePropagation(),!this._model.selectionStart)return;const k=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(I),!this._model.selectionEnd)return void this.refresh(true);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(I),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const B=this._bufferService.buffer;if(this._model.selectionEnd[1]<B.lines.length){const U=B.lines.get(this._model.selectionEnd[1]);U&&U.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}k&&k[0]===this._model.selectionEnd[0]&&k[1]===this._model.selectionEnd[1]||this.refresh(true)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:false});const I=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(I.ydisp+this._bufferService.rows,I.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=I.ydisp),this.refresh()}}_handleMouseUp(I){const k=I.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&k<500&&I.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const B=this._mouseService.getCoords(I,this._element,this._bufferService.cols,this._bufferService.rows,false);if(B&&B[0]!==void 0&&B[1]!==void 0){const U=(0,b.moveToCellSequence)(B[0]-1,B[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(U,true)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const I=this._model.finalSelectionStart,k=this._model.finalSelectionEnd,B=!(!I||!k||I[0]===k[0]&&I[1]===k[1]);B?I&&k&&(this._oldSelectionStart&&this._oldSelectionEnd&&I[0]===this._oldSelectionStart[0]&&I[1]===this._oldSelectionStart[1]&&k[0]===this._oldSelectionEnd[0]&&k[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(I,k,B)):this._oldHasSelection&&this._fireOnSelectionChange(I,k,B)}_fireOnSelectionChange(I,k,B){this._oldSelectionStart=I,this._oldSelectionEnd=k,this._oldHasSelection=B,this._onSelectionChange.fire()}_handleBufferActivate(I){this.clearSelection(),this._trimListener.dispose(),this._trimListener=I.activeBuffer.lines.onTrim(k=>this._handleTrim(k))}_convertViewportColToCharacterIndex(I,k){let B=k;for(let U=0;k>=U;U++){const P=I.loadCell(U,this._workCell).getChars().length;this._workCell.getWidth()===0?B--:P>1&&k!==U&&(B+=P-1)}return B}setSelection(I,k,B){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[I,k],this._model.selectionStartLength=B,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(I){this._isClickInSelection(I)||(this._selectWordAtCursor(I,false)&&this.refresh(true),this._fireEventIfSelectionChanged())}_getWordAt(I,k,B=true,U=true){if(I[0]>=this._bufferService.cols)return;const P=this._bufferService.buffer,z=P.lines.get(I[1]);if(!z)return;const W=P.translateBufferLineToString(I[1],false);let j=this._convertViewportColToCharacterIndex(z,I[0]),K=j;const ee=I[0]-j;let M=0,F=0,V=0,X=0;if(W.charAt(j)===" "){for(;j>0&&W.charAt(j-1)===" ";)j--;for(;K<W.length&&W.charAt(K+1)===" ";)K++}else{let Ie=I[0],de=I[0];z.getWidth(Ie)===0&&(M++,Ie--),z.getWidth(de)===2&&(F++,de++);const ot=z.getString(de).length;for(ot>1&&(X+=ot-1,K+=ot-1);Ie>0&&j>0&&!this._isCharWordSeparator(z.loadCell(Ie-1,this._workCell));){z.loadCell(Ie-1,this._workCell);const x=this._workCell.getChars().length;this._workCell.getWidth()===0?(M++,Ie--):x>1&&(V+=x-1,j-=x-1),j--,Ie--}for(;de<z.length&&K+1<W.length&&!this._isCharWordSeparator(z.loadCell(de+1,this._workCell));){z.loadCell(de+1,this._workCell);const x=this._workCell.getChars().length;this._workCell.getWidth()===2?(F++,de++):x>1&&(X+=x-1,K+=x-1),K++,de++}}K++;let H=j+ee-M+V,ne=Math.min(this._bufferService.cols,K-j+M+F-V-X);if(k||W.slice(j,K).trim()!==""){if(B&&H===0&&z.getCodePoint(0)!==32){const Ie=P.lines.get(I[1]-1);if(Ie&&z.isWrapped&&Ie.getCodePoint(this._bufferService.cols-1)!==32){const de=this._getWordAt([this._bufferService.cols-1,I[1]-1],false,true,false);if(de){const ot=this._bufferService.cols-de.start;H-=ot,ne+=ot}}}if(U&&H+ne===this._bufferService.cols&&z.getCodePoint(this._bufferService.cols-1)!==32){const Ie=P.lines.get(I[1]+1);if(Ie!=null&&Ie.isWrapped&&Ie.getCodePoint(0)!==32){const de=this._getWordAt([0,I[1]+1],false,false,true);de&&(ne+=de.length)}}return{start:H,length:ne}}}_selectWordAt(I,k){const B=this._getWordAt(I,k);if(B){for(;B.start<0;)B.start+=this._bufferService.cols,I[1]--;this._model.selectionStart=[B.start,I[1]],this._model.selectionStartLength=B.length}}_selectToWordAt(I){const k=this._getWordAt(I,true);if(k){let B=I[1];for(;k.start<0;)k.start+=this._bufferService.cols,B--;if(!this._model.areSelectionValuesReversed())for(;k.start+k.length>this._bufferService.cols;)k.length-=this._bufferService.cols,B++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?k.start:k.start+k.length,B]}}_isCharWordSeparator(I){return I.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(I.getChars())>=0}_selectLineAt(I){const k=this._bufferService.buffer.getWrappedRangeForLine(I),B={start:{x:0,y:k.first},end:{x:this._bufferService.cols-1,y:k.last}};this._model.selectionStart=[0,k.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,T.getRangeLength)(B,this._bufferService.cols)}};u.SelectionService=L=c([d(3,R.IBufferService),d(4,R.ICoreService),d(5,E.IMouseService),d(6,R.IOptionsService),d(7,E.IRenderService),d(8,E.ICoreBrowserService)],L)},4725:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.IThemeService=u.ICharacterJoinerService=u.ISelectionService=u.IRenderService=u.IMouseService=u.ICoreBrowserService=u.ICharSizeService=void 0;const c=p(8343);u.ICharSizeService=(0,c.createDecorator)("CharSizeService"),u.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),u.IMouseService=(0,c.createDecorator)("MouseService"),u.IRenderService=(0,c.createDecorator)("RenderService"),u.ISelectionService=(0,c.createDecorator)("SelectionService"),u.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),u.IThemeService=(0,c.createDecorator)("ThemeService")},6731:function(m,u,p){var c=this&&this.__decorate||function(L,I,k,B){var U,P=arguments.length,z=P<3?I:B===null?B=Object.getOwnPropertyDescriptor(I,k):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")z=Reflect.decorate(L,I,k,B);else for(var W=L.length-1;W>=0;W--)(U=L[W])&&(z=(P<3?U(z):P>3?U(I,k,z):U(I,k))||z);return P>3&&z&&Object.defineProperty(I,k,z),z},d=this&&this.__param||function(L,I){return function(k,B){I(k,B,L)}};Object.defineProperty(u,"__esModule",{value:true}),u.ThemeService=u.DEFAULT_ANSI_COLORS=void 0;const _=p(7239),b=p(8055),$=p(8460),E=p(844),y=p(2585),f=b.css.toColor("#ffffff"),v=b.css.toColor("#000000"),T=b.css.toColor("#ffffff"),S=b.css.toColor("#000000"),R={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};u.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const L=[b.css.toColor("#2e3436"),b.css.toColor("#cc0000"),b.css.toColor("#4e9a06"),b.css.toColor("#c4a000"),b.css.toColor("#3465a4"),b.css.toColor("#75507b"),b.css.toColor("#06989a"),b.css.toColor("#d3d7cf"),b.css.toColor("#555753"),b.css.toColor("#ef2929"),b.css.toColor("#8ae234"),b.css.toColor("#fce94f"),b.css.toColor("#729fcf"),b.css.toColor("#ad7fa8"),b.css.toColor("#34e2e2"),b.css.toColor("#eeeeec")],I=[0,95,135,175,215,255];for(let k=0;k<216;k++){const B=I[k/36%6|0],U=I[k/6%6|0],P=I[k%6];L.push({css:b.channels.toCss(B,U,P),rgba:b.channels.toRgba(B,U,P)})}for(let k=0;k<24;k++){const B=8+10*k;L.push({css:b.channels.toCss(B,B,B),rgba:b.channels.toRgba(B,B,B)})}return L})());let O=u.ThemeService=class extends E.Disposable{get colors(){return this._colors}constructor(L){super(),this._optionsService=L,this._contrastCache=new _.ColorContrastCache,this._halfContrastCache=new _.ColorContrastCache,this._onChangeColors=this.register(new $.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:f,background:v,cursor:T,cursorAccent:S,selectionForeground:void 0,selectionBackgroundTransparent:R,selectionBackgroundOpaque:b.color.blend(v,R),selectionInactiveBackgroundTransparent:R,selectionInactiveBackgroundOpaque:b.color.blend(v,R),ansi:u.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(L={}){const I=this._colors;if(I.foreground=A(L.foreground,f),I.background=A(L.background,v),I.cursor=A(L.cursor,T),I.cursorAccent=A(L.cursorAccent,S),I.selectionBackgroundTransparent=A(L.selectionBackground,R),I.selectionBackgroundOpaque=b.color.blend(I.background,I.selectionBackgroundTransparent),I.selectionInactiveBackgroundTransparent=A(L.selectionInactiveBackground,I.selectionBackgroundTransparent),I.selectionInactiveBackgroundOpaque=b.color.blend(I.background,I.selectionInactiveBackgroundTransparent),I.selectionForeground=L.selectionForeground?A(L.selectionForeground,b.NULL_COLOR):void 0,I.selectionForeground===b.NULL_COLOR&&(I.selectionForeground=void 0),b.color.isOpaque(I.selectionBackgroundTransparent)&&(I.selectionBackgroundTransparent=b.color.opacity(I.selectionBackgroundTransparent,.3)),b.color.isOpaque(I.selectionInactiveBackgroundTransparent)&&(I.selectionInactiveBackgroundTransparent=b.color.opacity(I.selectionInactiveBackgroundTransparent,.3)),I.ansi=u.DEFAULT_ANSI_COLORS.slice(),I.ansi[0]=A(L.black,u.DEFAULT_ANSI_COLORS[0]),I.ansi[1]=A(L.red,u.DEFAULT_ANSI_COLORS[1]),I.ansi[2]=A(L.green,u.DEFAULT_ANSI_COLORS[2]),I.ansi[3]=A(L.yellow,u.DEFAULT_ANSI_COLORS[3]),I.ansi[4]=A(L.blue,u.DEFAULT_ANSI_COLORS[4]),I.ansi[5]=A(L.magenta,u.DEFAULT_ANSI_COLORS[5]),I.ansi[6]=A(L.cyan,u.DEFAULT_ANSI_COLORS[6]),I.ansi[7]=A(L.white,u.DEFAULT_ANSI_COLORS[7]),I.ansi[8]=A(L.brightBlack,u.DEFAULT_ANSI_COLORS[8]),I.ansi[9]=A(L.brightRed,u.DEFAULT_ANSI_COLORS[9]),I.ansi[10]=A(L.brightGreen,u.DEFAULT_ANSI_COLORS[10]),I.ansi[11]=A(L.brightYellow,u.DEFAULT_ANSI_COLORS[11]),I.ansi[12]=A(L.brightBlue,u.DEFAULT_ANSI_COLORS[12]),I.ansi[13]=A(L.brightMagenta,u.DEFAULT_ANSI_COLORS[13]),I.ansi[14]=A(L.brightCyan,u.DEFAULT_ANSI_COLORS[14]),I.ansi[15]=A(L.brightWhite,u.DEFAULT_ANSI_COLORS[15]),L.extendedAnsi){const k=Math.min(I.ansi.length-16,L.extendedAnsi.length);for(let B=0;B<k;B++)I.ansi[B+16]=A(L.extendedAnsi[B],u.DEFAULT_ANSI_COLORS[B+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(L){this._restoreColor(L),this._onChangeColors.fire(this.colors)}_restoreColor(L){if(L!==void 0)switch(L){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[L]=this._restoreColors.ansi[L]}else for(let I=0;I<this._restoreColors.ansi.length;++I)this._colors.ansi[I]=this._restoreColors.ansi[I]}modifyColors(L){L(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function A(L,I){if(L!==void 0)try{return b.css.toColor(L)}catch{}return I}u.ThemeService=O=c([d(0,y.IOptionsService)],O)},6349:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CircularList=void 0;const c=p(8460),d=p(844);class _ extends d.Disposable{constructor($){super(),this._maxLength=$,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength($){if(this._maxLength===$)return;const E=new Array($);for(let y=0;y<Math.min($,this.length);y++)E[y]=this._array[this._getCyclicIndex(y)];this._array=E,this._maxLength=$,this._startIndex=0}get length(){return this._length}set length($){if($>this._length)for(let E=this._length;E<$;E++)this._array[E]=void 0;this._length=$}get($){return this._array[this._getCyclicIndex($)]}set($,E){this._array[this._getCyclicIndex($)]=E}push($){this._array[this._getCyclicIndex(this._length)]=$,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice($,E,...y){if(E){for(let f=$;f<this._length-E;f++)this._array[this._getCyclicIndex(f)]=this._array[this._getCyclicIndex(f+E)];this._length-=E,this.onDeleteEmitter.fire({index:$,amount:E})}for(let f=this._length-1;f>=$;f--)this._array[this._getCyclicIndex(f+y.length)]=this._array[this._getCyclicIndex(f)];for(let f=0;f<y.length;f++)this._array[this._getCyclicIndex($+f)]=y[f];if(y.length&&this.onInsertEmitter.fire({index:$,amount:y.length}),this._length+y.length>this._maxLength){const f=this._length+y.length-this._maxLength;this._startIndex+=f,this._length=this._maxLength,this.onTrimEmitter.fire(f)}else this._length+=y.length}trimStart($){$>this._length&&($=this._length),this._startIndex+=$,this._length-=$,this.onTrimEmitter.fire($)}shiftElements($,E,y){if(!(E<=0)){if($<0||$>=this._length)throw new Error("start argument out of range");if($+y<0)throw new Error("Cannot shift elements in list beyond index 0");if(y>0){for(let v=E-1;v>=0;v--)this.set($+v+y,this.get($+v));const f=$+E+y-this._length;if(f>0)for(this._length+=f;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let f=0;f<E;f++)this.set($+f+y,this.get($+f))}}_getCyclicIndex($){return(this._startIndex+$)%this._maxLength}}u.CircularList=_},1439:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.clone=void 0,u.clone=function p(c,d=5){if(typeof c!="object")return c;const _=Array.isArray(c)?[]:{};for(const b in c)_[b]=d<=1?c[b]:c[b]&&p(c[b],d-1);return _}},8055:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.contrastRatio=u.toPaddedHex=u.rgba=u.rgb=u.css=u.color=u.channels=u.NULL_COLOR=void 0;const c=p(6114);let d=0,_=0,b=0,$=0;var E,y,f,v,T;function S(O){const A=O.toString(16);return A.length<2?"0"+A:A}function R(O,A){return O<A?(A+.05)/(O+.05):(O+.05)/(A+.05)}u.NULL_COLOR={css:"#00000000",rgba:0},function(O){O.toCss=function(A,L,I,k){return k!==void 0?`#${S(A)}${S(L)}${S(I)}${S(k)}`:`#${S(A)}${S(L)}${S(I)}`},O.toRgba=function(A,L,I,k=255){return(A<<24|L<<16|I<<8|k)>>>0}}(E||(u.channels=E={})),function(O){function A(L,I){return $=Math.round(255*I),[d,_,b]=T.toChannels(L.rgba),{css:E.toCss(d,_,b,$),rgba:E.toRgba(d,_,b,$)}}O.blend=function(L,I){if($=(255&I.rgba)/255,$===1)return{css:I.css,rgba:I.rgba};const k=I.rgba>>24&255,B=I.rgba>>16&255,U=I.rgba>>8&255,P=L.rgba>>24&255,z=L.rgba>>16&255,W=L.rgba>>8&255;return d=P+Math.round((k-P)*$),_=z+Math.round((B-z)*$),b=W+Math.round((U-W)*$),{css:E.toCss(d,_,b),rgba:E.toRgba(d,_,b)}},O.isOpaque=function(L){return(255&L.rgba)==255},O.ensureContrastRatio=function(L,I,k){const B=T.ensureContrastRatio(L.rgba,I.rgba,k);if(B)return T.toColor(B>>24&255,B>>16&255,B>>8&255)},O.opaque=function(L){const I=(255|L.rgba)>>>0;return[d,_,b]=T.toChannels(I),{css:E.toCss(d,_,b),rgba:I}},O.opacity=A,O.multiplyOpacity=function(L,I){return $=255&L.rgba,A(L,$*I/255)},O.toColorRGB=function(L){return[L.rgba>>24&255,L.rgba>>16&255,L.rgba>>8&255]}}(y||(u.color=y={})),function(O){let A,L;if(!c.isNode){const I=document.createElement("canvas");I.width=1,I.height=1;const k=I.getContext("2d",{willReadFrequently:true});k&&(A=k,A.globalCompositeOperation="copy",L=A.createLinearGradient(0,0,1,1))}O.toColor=function(I){if(I.match(/#[\da-f]{3,8}/i))switch(I.length){case 4:return d=parseInt(I.slice(1,2).repeat(2),16),_=parseInt(I.slice(2,3).repeat(2),16),b=parseInt(I.slice(3,4).repeat(2),16),T.toColor(d,_,b);case 5:return d=parseInt(I.slice(1,2).repeat(2),16),_=parseInt(I.slice(2,3).repeat(2),16),b=parseInt(I.slice(3,4).repeat(2),16),$=parseInt(I.slice(4,5).repeat(2),16),T.toColor(d,_,b,$);case 7:return{css:I,rgba:(parseInt(I.slice(1),16)<<8|255)>>>0};case 9:return{css:I,rgba:parseInt(I.slice(1),16)>>>0}}const k=I.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(k)return d=parseInt(k[1]),_=parseInt(k[2]),b=parseInt(k[3]),$=Math.round(255*(k[5]===void 0?1:parseFloat(k[5]))),T.toColor(d,_,b,$);if(!A||!L)throw new Error("css.toColor: Unsupported css format");if(A.fillStyle=L,A.fillStyle=I,typeof A.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(A.fillRect(0,0,1,1),[d,_,b,$]=A.getImageData(0,0,1,1).data,$!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:E.toRgba(d,_,b,$),css:I}}}(f||(u.css=f={})),function(O){function A(L,I,k){const B=L/255,U=I/255,P=k/255;return .2126*(B<=.03928?B/12.92:Math.pow((B+.055)/1.055,2.4))+.7152*(U<=.03928?U/12.92:Math.pow((U+.055)/1.055,2.4))+.0722*(P<=.03928?P/12.92:Math.pow((P+.055)/1.055,2.4))}O.relativeLuminance=function(L){return A(L>>16&255,L>>8&255,255&L)},O.relativeLuminance2=A}(v||(u.rgb=v={})),function(O){function A(I,k,B){const U=I>>24&255,P=I>>16&255,z=I>>8&255;let W=k>>24&255,j=k>>16&255,K=k>>8&255,ee=R(v.relativeLuminance2(W,j,K),v.relativeLuminance2(U,P,z));for(;ee<B&&(W>0||j>0||K>0);)W-=Math.max(0,Math.ceil(.1*W)),j-=Math.max(0,Math.ceil(.1*j)),K-=Math.max(0,Math.ceil(.1*K)),ee=R(v.relativeLuminance2(W,j,K),v.relativeLuminance2(U,P,z));return(W<<24|j<<16|K<<8|255)>>>0}function L(I,k,B){const U=I>>24&255,P=I>>16&255,z=I>>8&255;let W=k>>24&255,j=k>>16&255,K=k>>8&255,ee=R(v.relativeLuminance2(W,j,K),v.relativeLuminance2(U,P,z));for(;ee<B&&(W<255||j<255||K<255);)W=Math.min(255,W+Math.ceil(.1*(255-W))),j=Math.min(255,j+Math.ceil(.1*(255-j))),K=Math.min(255,K+Math.ceil(.1*(255-K))),ee=R(v.relativeLuminance2(W,j,K),v.relativeLuminance2(U,P,z));return(W<<24|j<<16|K<<8|255)>>>0}O.ensureContrastRatio=function(I,k,B){const U=v.relativeLuminance(I>>8),P=v.relativeLuminance(k>>8);if(R(U,P)<B){if(P<U){const j=A(I,k,B),K=R(U,v.relativeLuminance(j>>8));if(K<B){const ee=L(I,k,B);return K>R(U,v.relativeLuminance(ee>>8))?j:ee}return j}const z=L(I,k,B),W=R(U,v.relativeLuminance(z>>8));if(W<B){const j=A(I,k,B);return W>R(U,v.relativeLuminance(j>>8))?z:j}return z}},O.reduceLuminance=A,O.increaseLuminance=L,O.toChannels=function(I){return[I>>24&255,I>>16&255,I>>8&255,255&I]},O.toColor=function(I,k,B,U){return{css:E.toCss(I,k,B,U),rgba:E.toRgba(I,k,B,U)}}}(T||(u.rgba=T={})),u.toPaddedHex=S,u.contrastRatio=R},8969:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CoreTerminal=void 0;const c=p(844),d=p(2585),_=p(4348),b=p(7866),$=p(744),E=p(7302),y=p(6975),f=p(8460),v=p(1753),T=p(1480),S=p(7994),R=p(9282),O=p(5435),A=p(5981),L=p(2660);let I=false;class k extends c.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new f.EventEmitter),this._onScroll.event(U=>{var P;(P=this._onScrollApi)===null||P===void 0||P.fire(U.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(U){for(const P in U)this.optionsService.options[P]=U[P]}constructor(U){super(),this._windowsWrappingHeuristics=this.register(new c.MutableDisposable),this._onBinary=this.register(new f.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new f.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new f.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new f.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new f.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new f.EventEmitter),this._instantiationService=new _.InstantiationService,this.optionsService=this.register(new E.OptionsService(U)),this._instantiationService.setService(d.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance($.BufferService)),this._instantiationService.setService(d.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(b.LogService)),this._instantiationService.setService(d.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(y.CoreService)),this._instantiationService.setService(d.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(v.CoreMouseService)),this._instantiationService.setService(d.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(T.UnicodeService)),this._instantiationService.setService(d.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(S.CharsetService),this._instantiationService.setService(d.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(L.OscLinkService),this._instantiationService.setService(d.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new O.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,f.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,f.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,f.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,f.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(P=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(P=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new A.WriteBuffer((P,z)=>this._inputHandler.parse(P,z))),this.register((0,f.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(U,P){this._writeBuffer.write(U,P)}writeSync(U,P){this._logService.logLevel<=d.LogLevelEnum.WARN&&!I&&(this._logService.warn("writeSync is unreliable and will be removed soon."),I=true),this._writeBuffer.writeSync(U,P)}resize(U,P){isNaN(U)||isNaN(P)||(U=Math.max(U,$.MINIMUM_COLS),P=Math.max(P,$.MINIMUM_ROWS),this._bufferService.resize(U,P))}scroll(U,P=false){this._bufferService.scroll(U,P)}scrollLines(U,P,z){this._bufferService.scrollLines(U,P,z)}scrollPages(U){this.scrollLines(U*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(U){const P=U-this._bufferService.buffer.ydisp;P!==0&&this.scrollLines(P)}registerEscHandler(U,P){return this._inputHandler.registerEscHandler(U,P)}registerDcsHandler(U,P){return this._inputHandler.registerDcsHandler(U,P)}registerCsiHandler(U,P){return this._inputHandler.registerCsiHandler(U,P)}registerOscHandler(U,P){return this._inputHandler.registerOscHandler(U,P)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let U=false;const P=this.optionsService.rawOptions.windowsPty;P&&P.buildNumber!==void 0&&P.buildNumber!==void 0?U=P.backend==="conpty"&&P.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(U=true),U?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const U=[];U.push(this.onLineFeed(R.updateWindowsModeWrappedState.bind(null,this._bufferService))),U.push(this.registerCsiHandler({final:"H"},()=>((0,R.updateWindowsModeWrappedState)(this._bufferService),false))),this._windowsWrappingHeuristics.value=(0,c.toDisposable)(()=>{for(const P of U)P.dispose()})}}}u.CoreTerminal=k},8460:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.forwardEvent=u.EventEmitter=void 0,u.EventEmitter=class{constructor(){this._listeners=[],this._disposed=false}get event(){return this._event||(this._event=p=>(this._listeners.push(p),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===p)return void this._listeners.splice(c,1)}}})),this._event}fire(p,c){const d=[];for(let _=0;_<this._listeners.length;_++)d.push(this._listeners[_]);for(let _=0;_<d.length;_++)d[_].call(void 0,p,c)}dispose(){this.clearListeners(),this._disposed=true}clearListeners(){this._listeners&&(this._listeners.length=0)}},u.forwardEvent=function(p,c){return p(d=>c.fire(d))}},5435:function(m,u,p){var c=this&&this.__decorate||function(ee,M,F,V){var X,H=arguments.length,ne=H<3?M:V===null?V=Object.getOwnPropertyDescriptor(M,F):V;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ne=Reflect.decorate(ee,M,F,V);else for(var Ie=ee.length-1;Ie>=0;Ie--)(X=ee[Ie])&&(ne=(H<3?X(ne):H>3?X(M,F,ne):X(M,F))||ne);return H>3&&ne&&Object.defineProperty(M,F,ne),ne},d=this&&this.__param||function(ee,M){return function(F,V){M(F,V,ee)}};Object.defineProperty(u,"__esModule",{value:true}),u.InputHandler=u.WindowsOptionsReportType=void 0;const _=p(2584),b=p(7116),$=p(2015),E=p(844),y=p(482),f=p(8437),v=p(8460),T=p(643),S=p(511),R=p(3734),O=p(2585),A=p(6242),L=p(6351),I=p(5941),k={"(":0,")":1,"*":2,"+":3,"-":1,".":2},B=131072;function U(ee,M){if(ee>24)return M.setWinLines||false;switch(ee){case 1:return!!M.restoreWin;case 2:return!!M.minimizeWin;case 3:return!!M.setWinPosition;case 4:return!!M.setWinSizePixels;case 5:return!!M.raiseWin;case 6:return!!M.lowerWin;case 7:return!!M.refreshWin;case 8:return!!M.setWinSizeChars;case 9:return!!M.maximizeWin;case 10:return!!M.fullscreenWin;case 11:return!!M.getWinState;case 13:return!!M.getWinPosition;case 14:return!!M.getWinSizePixels;case 15:return!!M.getScreenSizePixels;case 16:return!!M.getCellSizePixels;case 18:return!!M.getWinSizeChars;case 19:return!!M.getScreenSizeChars;case 20:return!!M.getIconTitle;case 21:return!!M.getWinTitle;case 22:return!!M.pushTitle;case 23:return!!M.popTitle;case 24:return!!M.setWinLines}return false}var P;(function(ee){ee[ee.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",ee[ee.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(P||(u.WindowsOptionsReportType=P={}));let z=0;class W extends E.Disposable{getAttrData(){return this._curAttrData}constructor(M,F,V,X,H,ne,Ie,de,ot=new $.EscapeSequenceParser){super(),this._bufferService=M,this._charsetService=F,this._coreService=V,this._logService=X,this._optionsService=H,this._oscLinkService=ne,this._coreMouseService=Ie,this._unicodeService=de,this._parser=ot,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new y.StringToUtf32,this._utf8Decoder=new y.Utf8ToUtf32,this._workCell=new S.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=f.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new v.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new v.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new v.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new v.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new v.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new v.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new v.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new v.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new v.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new v.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new v.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new v.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new v.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:false,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new j(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(x=>this._activeBuffer=x.activeBuffer)),this._parser.setCsiHandlerFallback((x,te)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(x),params:te.toArray()})}),this._parser.setEscHandlerFallback(x=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(x)})}),this._parser.setExecuteHandlerFallback(x=>{this._logService.debug("Unknown EXECUTE code: ",{code:x})}),this._parser.setOscHandlerFallback((x,te,ce)=>{this._logService.debug("Unknown OSC code: ",{identifier:x,action:te,data:ce})}),this._parser.setDcsHandlerFallback((x,te,ce)=>{te==="HOOK"&&(ce=ce.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(x),action:te,payload:ce})}),this._parser.setPrintHandler((x,te,ce)=>this.print(x,te,ce)),this._parser.registerCsiHandler({final:"@"},x=>this.insertChars(x)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},x=>this.scrollLeft(x)),this._parser.registerCsiHandler({final:"A"},x=>this.cursorUp(x)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},x=>this.scrollRight(x)),this._parser.registerCsiHandler({final:"B"},x=>this.cursorDown(x)),this._parser.registerCsiHandler({final:"C"},x=>this.cursorForward(x)),this._parser.registerCsiHandler({final:"D"},x=>this.cursorBackward(x)),this._parser.registerCsiHandler({final:"E"},x=>this.cursorNextLine(x)),this._parser.registerCsiHandler({final:"F"},x=>this.cursorPrecedingLine(x)),this._parser.registerCsiHandler({final:"G"},x=>this.cursorCharAbsolute(x)),this._parser.registerCsiHandler({final:"H"},x=>this.cursorPosition(x)),this._parser.registerCsiHandler({final:"I"},x=>this.cursorForwardTab(x)),this._parser.registerCsiHandler({final:"J"},x=>this.eraseInDisplay(x,false)),this._parser.registerCsiHandler({prefix:"?",final:"J"},x=>this.eraseInDisplay(x,true)),this._parser.registerCsiHandler({final:"K"},x=>this.eraseInLine(x,false)),this._parser.registerCsiHandler({prefix:"?",final:"K"},x=>this.eraseInLine(x,true)),this._parser.registerCsiHandler({final:"L"},x=>this.insertLines(x)),this._parser.registerCsiHandler({final:"M"},x=>this.deleteLines(x)),this._parser.registerCsiHandler({final:"P"},x=>this.deleteChars(x)),this._parser.registerCsiHandler({final:"S"},x=>this.scrollUp(x)),this._parser.registerCsiHandler({final:"T"},x=>this.scrollDown(x)),this._parser.registerCsiHandler({final:"X"},x=>this.eraseChars(x)),this._parser.registerCsiHandler({final:"Z"},x=>this.cursorBackwardTab(x)),this._parser.registerCsiHandler({final:"`"},x=>this.charPosAbsolute(x)),this._parser.registerCsiHandler({final:"a"},x=>this.hPositionRelative(x)),this._parser.registerCsiHandler({final:"b"},x=>this.repeatPrecedingCharacter(x)),this._parser.registerCsiHandler({final:"c"},x=>this.sendDeviceAttributesPrimary(x)),this._parser.registerCsiHandler({prefix:">",final:"c"},x=>this.sendDeviceAttributesSecondary(x)),this._parser.registerCsiHandler({final:"d"},x=>this.linePosAbsolute(x)),this._parser.registerCsiHandler({final:"e"},x=>this.vPositionRelative(x)),this._parser.registerCsiHandler({final:"f"},x=>this.hVPosition(x)),this._parser.registerCsiHandler({final:"g"},x=>this.tabClear(x)),this._parser.registerCsiHandler({final:"h"},x=>this.setMode(x)),this._parser.registerCsiHandler({prefix:"?",final:"h"},x=>this.setModePrivate(x)),this._parser.registerCsiHandler({final:"l"},x=>this.resetMode(x)),this._parser.registerCsiHandler({prefix:"?",final:"l"},x=>this.resetModePrivate(x)),this._parser.registerCsiHandler({final:"m"},x=>this.charAttributes(x)),this._parser.registerCsiHandler({final:"n"},x=>this.deviceStatus(x)),this._parser.registerCsiHandler({prefix:"?",final:"n"},x=>this.deviceStatusPrivate(x)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},x=>this.softReset(x)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},x=>this.setCursorStyle(x)),this._parser.registerCsiHandler({final:"r"},x=>this.setScrollRegion(x)),this._parser.registerCsiHandler({final:"s"},x=>this.saveCursor(x)),this._parser.registerCsiHandler({final:"t"},x=>this.windowOptions(x)),this._parser.registerCsiHandler({final:"u"},x=>this.restoreCursor(x)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},x=>this.insertColumns(x)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},x=>this.deleteColumns(x)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},x=>this.selectProtected(x)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},x=>this.requestMode(x,true)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},x=>this.requestMode(x,false)),this._parser.setExecuteHandler(_.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(_.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(_.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(_.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(_.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(_.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(_.C1.IND,()=>this.index()),this._parser.setExecuteHandler(_.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(_.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new A.OscHandler(x=>(this.setTitle(x),this.setIconName(x),true))),this._parser.registerOscHandler(1,new A.OscHandler(x=>this.setIconName(x))),this._parser.registerOscHandler(2,new A.OscHandler(x=>this.setTitle(x))),this._parser.registerOscHandler(4,new A.OscHandler(x=>this.setOrReportIndexedColor(x))),this._parser.registerOscHandler(8,new A.OscHandler(x=>this.setHyperlink(x))),this._parser.registerOscHandler(10,new A.OscHandler(x=>this.setOrReportFgColor(x))),this._parser.registerOscHandler(11,new A.OscHandler(x=>this.setOrReportBgColor(x))),this._parser.registerOscHandler(12,new A.OscHandler(x=>this.setOrReportCursorColor(x))),this._parser.registerOscHandler(104,new A.OscHandler(x=>this.restoreIndexedColor(x))),this._parser.registerOscHandler(110,new A.OscHandler(x=>this.restoreFgColor(x))),this._parser.registerOscHandler(111,new A.OscHandler(x=>this.restoreBgColor(x))),this._parser.registerOscHandler(112,new A.OscHandler(x=>this.restoreCursorColor(x))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const x in b.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:x},()=>this.selectCharset("("+x)),this._parser.registerEscHandler({intermediates:")",final:x},()=>this.selectCharset(")"+x)),this._parser.registerEscHandler({intermediates:"*",final:x},()=>this.selectCharset("*"+x)),this._parser.registerEscHandler({intermediates:"+",final:x},()=>this.selectCharset("+"+x)),this._parser.registerEscHandler({intermediates:"-",final:x},()=>this.selectCharset("-"+x)),this._parser.registerEscHandler({intermediates:".",final:x},()=>this.selectCharset("."+x)),this._parser.registerEscHandler({intermediates:"/",final:x},()=>this.selectCharset("/"+x));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(x=>(this._logService.error("Parsing error: ",x),x)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new L.DcsHandler((x,te)=>this.requestStatusString(x,te)))}_preserveStack(M,F,V,X){this._parseStack.paused=true,this._parseStack.cursorStartX=M,this._parseStack.cursorStartY=F,this._parseStack.decodedLength=V,this._parseStack.position=X}_logSlowResolvingAsync(M){this._logService.logLevel<=O.LogLevelEnum.WARN&&Promise.race([M,new Promise((F,V)=>setTimeout(()=>V("#SLOW_TIMEOUT"),5e3))]).catch(F=>{if(F!=="#SLOW_TIMEOUT")throw F;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(M,F){let V,X=this._activeBuffer.x,H=this._activeBuffer.y,ne=0;const Ie=this._parseStack.paused;if(Ie){if(V=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,F))return this._logSlowResolvingAsync(V),V;X=this._parseStack.cursorStartX,H=this._parseStack.cursorStartY,this._parseStack.paused=false,M.length>B&&(ne=this._parseStack.position+B)}if(this._logService.logLevel<=O.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof M=="string"?` "${M}"`:` "${Array.prototype.map.call(M,de=>String.fromCharCode(de)).join("")}"`),typeof M=="string"?M.split("").map(de=>de.charCodeAt(0)):M),this._parseBuffer.length<M.length&&this._parseBuffer.length<B&&(this._parseBuffer=new Uint32Array(Math.min(M.length,B))),Ie||this._dirtyRowTracker.clearRange(),M.length>B)for(let de=ne;de<M.length;de+=B){const ot=de+B<M.length?de+B:M.length,x=typeof M=="string"?this._stringDecoder.decode(M.substring(de,ot),this._parseBuffer):this._utf8Decoder.decode(M.subarray(de,ot),this._parseBuffer);if(V=this._parser.parse(this._parseBuffer,x))return this._preserveStack(X,H,x,de),this._logSlowResolvingAsync(V),V}else if(!Ie){const de=typeof M=="string"?this._stringDecoder.decode(M,this._parseBuffer):this._utf8Decoder.decode(M,this._parseBuffer);if(V=this._parser.parse(this._parseBuffer,de))return this._preserveStack(X,H,de,0),this._logSlowResolvingAsync(V),V}this._activeBuffer.x===X&&this._activeBuffer.y===H||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(M,F,V){let X,H;const ne=this._charsetService.charset,Ie=this._optionsService.rawOptions.screenReaderMode,de=this._bufferService.cols,ot=this._coreService.decPrivateModes.wraparound,x=this._coreService.modes.insertMode,te=this._curAttrData;let ce=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&V-F>0&&ce.getWidth(this._activeBuffer.x-1)===2&&ce.setCellFromCodePoint(this._activeBuffer.x-1,0,1,te.fg,te.bg,te.extended);for(let ae=F;ae<V;++ae){if(X=M[ae],H=this._unicodeService.wcwidth(X),X<127&&ne){const De=ne[String.fromCharCode(X)];De&&(X=De.charCodeAt(0))}if(Ie&&this._onA11yChar.fire((0,y.stringFromCodePoint)(X)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),H||!this._activeBuffer.x){if(this._activeBuffer.x+H-1>=de){if(ot){for(;this._activeBuffer.x<de;)ce.setCellFromCodePoint(this._activeBuffer.x++,0,1,te.fg,te.bg,te.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),true)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=true),ce=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=de-1,H===2)continue}if(x&&(ce.insertCells(this._activeBuffer.x,H,this._activeBuffer.getNullCell(te),te),ce.getWidth(de-1)===2&&ce.setCellFromCodePoint(de-1,T.NULL_CELL_CODE,T.NULL_CELL_WIDTH,te.fg,te.bg,te.extended)),ce.setCellFromCodePoint(this._activeBuffer.x++,X,H,te.fg,te.bg,te.extended),H>0)for(;--H;)ce.setCellFromCodePoint(this._activeBuffer.x++,0,0,te.fg,te.bg,te.extended)}else ce.getWidth(this._activeBuffer.x-1)?ce.addCodepointToCell(this._activeBuffer.x-1,X):ce.addCodepointToCell(this._activeBuffer.x-2,X)}V-F>0&&(ce.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<de&&V-F>0&&ce.getWidth(this._activeBuffer.x)===0&&!ce.hasContent(this._activeBuffer.x)&&ce.setCellFromCodePoint(this._activeBuffer.x,0,1,te.fg,te.bg,te.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(M,F){return M.final!=="t"||M.prefix||M.intermediates?this._parser.registerCsiHandler(M,F):this._parser.registerCsiHandler(M,V=>!U(V.params[0],this._optionsService.rawOptions.windowOptions)||F(V))}registerDcsHandler(M,F){return this._parser.registerDcsHandler(M,new L.DcsHandler(F))}registerEscHandler(M,F){return this._parser.registerEscHandler(M,F)}registerOscHandler(M,F){return this._parser.registerOscHandler(M,new A.OscHandler(F))}bell(){return this._onRequestBell.fire(),true}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=false,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),true}carriageReturn(){return this._activeBuffer.x=0,true}backspace(){var M;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,true;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||M===void 0)&&M.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=false,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);F.hasWidth(this._activeBuffer.x)&&!F.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),true}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return true;const M=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-M),true}shiftOut(){return this._charsetService.setgLevel(1),true}shiftIn(){return this._charsetService.setgLevel(0),true}_restrictCursor(M=this._bufferService.cols-1){this._activeBuffer.x=Math.min(M,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(M,F){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=M,this._activeBuffer.y=this._activeBuffer.scrollTop+F):(this._activeBuffer.x=M,this._activeBuffer.y=F),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(M,F){this._restrictCursor(),this._setCursor(this._activeBuffer.x+M,this._activeBuffer.y+F)}cursorUp(M){const F=this._activeBuffer.y-this._activeBuffer.scrollTop;return F>=0?this._moveCursor(0,-Math.min(F,M.params[0]||1)):this._moveCursor(0,-(M.params[0]||1)),true}cursorDown(M){const F=this._activeBuffer.scrollBottom-this._activeBuffer.y;return F>=0?this._moveCursor(0,Math.min(F,M.params[0]||1)):this._moveCursor(0,M.params[0]||1),true}cursorForward(M){return this._moveCursor(M.params[0]||1,0),true}cursorBackward(M){return this._moveCursor(-(M.params[0]||1),0),true}cursorNextLine(M){return this.cursorDown(M),this._activeBuffer.x=0,true}cursorPrecedingLine(M){return this.cursorUp(M),this._activeBuffer.x=0,true}cursorCharAbsolute(M){return this._setCursor((M.params[0]||1)-1,this._activeBuffer.y),true}cursorPosition(M){return this._setCursor(M.length>=2?(M.params[1]||1)-1:0,(M.params[0]||1)-1),true}charPosAbsolute(M){return this._setCursor((M.params[0]||1)-1,this._activeBuffer.y),true}hPositionRelative(M){return this._moveCursor(M.params[0]||1,0),true}linePosAbsolute(M){return this._setCursor(this._activeBuffer.x,(M.params[0]||1)-1),true}vPositionRelative(M){return this._moveCursor(0,M.params[0]||1),true}hVPosition(M){return this.cursorPosition(M),true}tabClear(M){const F=M.params[0];return F===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:F===3&&(this._activeBuffer.tabs={}),true}cursorForwardTab(M){if(this._activeBuffer.x>=this._bufferService.cols)return true;let F=M.params[0]||1;for(;F--;)this._activeBuffer.x=this._activeBuffer.nextStop();return true}cursorBackwardTab(M){if(this._activeBuffer.x>=this._bufferService.cols)return true;let F=M.params[0]||1;for(;F--;)this._activeBuffer.x=this._activeBuffer.prevStop();return true}selectProtected(M){const F=M.params[0];return F===1&&(this._curAttrData.bg|=536870912),F!==2&&F!==0||(this._curAttrData.bg&=-536870913),true}_eraseInBufferLine(M,F,V,X=false,H=false){const ne=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);ne.replaceCells(F,V,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),H),X&&(ne.isWrapped=false)}_resetBufferLine(M,F=false){const V=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);V&&(V.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),F),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+M),V.isWrapped=false)}eraseInDisplay(M,F=false){let V;switch(this._restrictCursor(this._bufferService.cols),M.params[0]){case 0:for(V=this._activeBuffer.y,this._dirtyRowTracker.markDirty(V),this._eraseInBufferLine(V++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,F);V<this._bufferService.rows;V++)this._resetBufferLine(V,F);this._dirtyRowTracker.markDirty(V);break;case 1:for(V=this._activeBuffer.y,this._dirtyRowTracker.markDirty(V),this._eraseInBufferLine(V,0,this._activeBuffer.x+1,true,F),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(V+1).isWrapped=false);V--;)this._resetBufferLine(V,F);this._dirtyRowTracker.markDirty(0);break;case 2:for(V=this._bufferService.rows,this._dirtyRowTracker.markDirty(V-1);V--;)this._resetBufferLine(V,F);this._dirtyRowTracker.markDirty(0);break;case 3:const X=this._activeBuffer.lines.length-this._bufferService.rows;X>0&&(this._activeBuffer.lines.trimStart(X),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-X,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-X,0),this._onScroll.fire(0))}return true}eraseInLine(M,F=false){switch(this._restrictCursor(this._bufferService.cols),M.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,F);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,false,F);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,true,F)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),true}insertLines(M){this._restrictCursor();let F=M.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const V=this._activeBuffer.ybase+this._activeBuffer.y,X=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-X+1;for(;F--;)this._activeBuffer.lines.splice(H-1,1),this._activeBuffer.lines.splice(V,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,true}deleteLines(M){this._restrictCursor();let F=M.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const V=this._activeBuffer.ybase+this._activeBuffer.y;let X;for(X=this._bufferService.rows-1-this._activeBuffer.scrollBottom,X=this._bufferService.rows-1+this._activeBuffer.ybase-X;F--;)this._activeBuffer.lines.splice(V,1),this._activeBuffer.lines.splice(X,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,true}insertChars(M){this._restrictCursor();const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.insertCells(this._activeBuffer.x,M.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),true}deleteChars(M){this._restrictCursor();const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.deleteCells(this._activeBuffer.x,M.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),true}scrollUp(M){let F=M.params[0]||1;for(;F--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}scrollDown(M){let F=M.params[0]||1;for(;F--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(f.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}scrollLeft(M){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const F=M.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);X.deleteCells(0,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),X.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}scrollRight(M){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const F=M.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);X.insertCells(0,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),X.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}insertColumns(M){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const F=M.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);X.insertCells(this._activeBuffer.x,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),X.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}deleteColumns(M){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const F=M.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const X=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);X.deleteCells(this._activeBuffer.x,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),X.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}eraseChars(M){this._restrictCursor();const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(M.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),true}repeatPrecedingCharacter(M){if(!this._parser.precedingCodepoint)return true;const F=M.params[0]||1,V=new Uint32Array(F);for(let X=0;X<F;++X)V[X]=this._parser.precedingCodepoint;return this.print(V,0,V.length),true}sendDeviceAttributesPrimary(M){return M.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(_.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(_.C0.ESC+"[?6c")),true}sendDeviceAttributesSecondary(M){return M.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(_.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(_.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(M.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(_.C0.ESC+"[>83;40003;0c")),true}_is(M){return(this._optionsService.rawOptions.termName+"").indexOf(M)===0}setMode(M){for(let F=0;F<M.length;F++)switch(M.params[F]){case 4:this._coreService.modes.insertMode=true;break;case 20:this._optionsService.options.convertEol=true}return true}setModePrivate(M){for(let F=0;F<M.length;F++)switch(M.params[F]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=true;break;case 2:this._charsetService.setgCharset(0,b.DEFAULT_CHARSET),this._charsetService.setgCharset(1,b.DEFAULT_CHARSET),this._charsetService.setgCharset(2,b.DEFAULT_CHARSET),this._charsetService.setgCharset(3,b.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=true,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=true;break;case 12:this._optionsService.options.cursorBlink=true;break;case 45:this._coreService.decPrivateModes.reverseWraparound=true;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=true,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=true,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=false;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=true,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=true}return true}resetMode(M){for(let F=0;F<M.length;F++)switch(M.params[F]){case 4:this._coreService.modes.insertMode=false;break;case 20:this._optionsService.options.convertEol=false}return true}resetModePrivate(M){for(let F=0;F<M.length;F++)switch(M.params[F]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=false;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=false,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=false;break;case 12:this._optionsService.options.cursorBlink=false;break;case 45:this._coreService.decPrivateModes.reverseWraparound=false;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=false,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=false;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=true;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),M.params[F]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=true,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=false}return true}requestMode(M,F){const V=this._coreService.decPrivateModes,{activeProtocol:X,activeEncoding:H}=this._coreMouseService,ne=this._coreService,{buffers:Ie,cols:de}=this._bufferService,{active:ot,alt:x}=Ie,te=this._optionsService.rawOptions,ce=st=>st?1:2,ae=M.params[0];return De=ae,$e=F?ae===2?4:ae===4?ce(ne.modes.insertMode):ae===12?3:ae===20?ce(te.convertEol):0:ae===1?ce(V.applicationCursorKeys):ae===3?te.windowOptions.setWinLines?de===80?2:de===132?1:0:0:ae===6?ce(V.origin):ae===7?ce(V.wraparound):ae===8?3:ae===9?ce(X==="X10"):ae===12?ce(te.cursorBlink):ae===25?ce(!ne.isCursorHidden):ae===45?ce(V.reverseWraparound):ae===66?ce(V.applicationKeypad):ae===67?4:ae===1e3?ce(X==="VT200"):ae===1002?ce(X==="DRAG"):ae===1003?ce(X==="ANY"):ae===1004?ce(V.sendFocus):ae===1005?4:ae===1006?ce(H==="SGR"):ae===1015?4:ae===1016?ce(H==="SGR_PIXELS"):ae===1048?1:ae===47||ae===1047||ae===1049?ce(ot===x):ae===2004?ce(V.bracketedPasteMode):0,ne.triggerDataEvent(`${_.C0.ESC}[${F?"":"?"}${De};${$e}$y`),true;var De,$e}_updateAttrColor(M,F,V,X,H){return F===2?(M|=50331648,M&=-16777216,M|=R.AttributeData.fromColorRGB([V,X,H])):F===5&&(M&=-50331904,M|=33554432|255&V),M}_extractColor(M,F,V){const X=[0,0,-1,0,0,0];let H=0,ne=0;do{if(X[ne+H]=M.params[F+ne],M.hasSubParams(F+ne)){const Ie=M.getSubParams(F+ne);let de=0;do X[1]===5&&(H=1),X[ne+de+1+H]=Ie[de];while(++de<Ie.length&&de+ne+1+H<X.length);break}if(X[1]===5&&ne+H>=2||X[1]===2&&ne+H>=5)break;X[1]&&(H=1)}while(++ne+F<M.length&&ne+H<X.length);for(let Ie=2;Ie<X.length;++Ie)X[Ie]===-1&&(X[Ie]=0);switch(X[0]){case 38:V.fg=this._updateAttrColor(V.fg,X[1],X[3],X[4],X[5]);break;case 48:V.bg=this._updateAttrColor(V.bg,X[1],X[3],X[4],X[5]);break;case 58:V.extended=V.extended.clone(),V.extended.underlineColor=this._updateAttrColor(V.extended.underlineColor,X[1],X[3],X[4],X[5])}return ne}_processUnderline(M,F){F.extended=F.extended.clone(),(!~M||M>5)&&(M=1),F.extended.underlineStyle=M,F.fg|=268435456,M===0&&(F.fg&=-268435457),F.updateExtended()}_processSGR0(M){M.fg=f.DEFAULT_ATTR_DATA.fg,M.bg=f.DEFAULT_ATTR_DATA.bg,M.extended=M.extended.clone(),M.extended.underlineStyle=0,M.extended.underlineColor&=-67108864,M.updateExtended()}charAttributes(M){if(M.length===1&&M.params[0]===0)return this._processSGR0(this._curAttrData),true;const F=M.length;let V;const X=this._curAttrData;for(let H=0;H<F;H++)V=M.params[H],V>=30&&V<=37?(X.fg&=-50331904,X.fg|=16777216|V-30):V>=40&&V<=47?(X.bg&=-50331904,X.bg|=16777216|V-40):V>=90&&V<=97?(X.fg&=-50331904,X.fg|=16777224|V-90):V>=100&&V<=107?(X.bg&=-50331904,X.bg|=16777224|V-100):V===0?this._processSGR0(X):V===1?X.fg|=134217728:V===3?X.bg|=67108864:V===4?(X.fg|=268435456,this._processUnderline(M.hasSubParams(H)?M.getSubParams(H)[0]:1,X)):V===5?X.fg|=536870912:V===7?X.fg|=67108864:V===8?X.fg|=1073741824:V===9?X.fg|=2147483648:V===2?X.bg|=134217728:V===21?this._processUnderline(2,X):V===22?(X.fg&=-134217729,X.bg&=-134217729):V===23?X.bg&=-67108865:V===24?(X.fg&=-268435457,this._processUnderline(0,X)):V===25?X.fg&=-536870913:V===27?X.fg&=-67108865:V===28?X.fg&=-1073741825:V===29?X.fg&=2147483647:V===39?(X.fg&=-67108864,X.fg|=16777215&f.DEFAULT_ATTR_DATA.fg):V===49?(X.bg&=-67108864,X.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):V===38||V===48||V===58?H+=this._extractColor(M,H,X):V===53?X.bg|=1073741824:V===55?X.bg&=-1073741825:V===59?(X.extended=X.extended.clone(),X.extended.underlineColor=-1,X.updateExtended()):V===100?(X.fg&=-67108864,X.fg|=16777215&f.DEFAULT_ATTR_DATA.fg,X.bg&=-67108864,X.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",V);return true}deviceStatus(M){switch(M.params[0]){case 5:this._coreService.triggerDataEvent(`${_.C0.ESC}[0n`);break;case 6:const F=this._activeBuffer.y+1,V=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_.C0.ESC}[${F};${V}R`)}return true}deviceStatusPrivate(M){if(M.params[0]===6){const F=this._activeBuffer.y+1,V=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_.C0.ESC}[?${F};${V}R`)}return true}softReset(M){return this._coreService.isCursorHidden=false,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=false,true}setCursorStyle(M){const F=M.params[0]||1;switch(F){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const V=F%2==1;return this._optionsService.options.cursorBlink=V,true}setScrollRegion(M){const F=M.params[0]||1;let V;return(M.length<2||(V=M.params[1])>this._bufferService.rows||V===0)&&(V=this._bufferService.rows),V>F&&(this._activeBuffer.scrollTop=F-1,this._activeBuffer.scrollBottom=V-1,this._setCursor(0,0)),true}windowOptions(M){if(!U(M.params[0],this._optionsService.rawOptions.windowOptions))return true;const F=M.length>1?M.params[1]:0;switch(M.params[0]){case 14:F!==2&&this._onRequestWindowsOptionsReport.fire(P.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(P.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${_.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:F!==0&&F!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),F!==0&&F!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:F!==0&&F!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),F!==0&&F!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return true}saveCursor(M){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,true}restoreCursor(M){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),true}setTitle(M){return this._windowTitle=M,this._onTitleChange.fire(M),true}setIconName(M){return this._iconName=M,true}setOrReportIndexedColor(M){const F=[],V=M.split(";");for(;V.length>1;){const X=V.shift(),H=V.shift();if(/^\d+$/.exec(X)){const ne=parseInt(X);if(K(ne))if(H==="?")F.push({type:0,index:ne});else{const Ie=(0,I.parseColor)(H);Ie&&F.push({type:1,index:ne,color:Ie})}}}return F.length&&this._onColor.fire(F),true}setHyperlink(M){const F=M.split(";");return!(F.length<2)&&(F[1]?this._createHyperlink(F[0],F[1]):!F[0]&&this._finishHyperlink())}_createHyperlink(M,F){this._getCurrentLinkId()&&this._finishHyperlink();const V=M.split(":");let X;const H=V.findIndex(ne=>ne.startsWith("id="));return H!==-1&&(X=V[H].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:X,uri:F}),this._curAttrData.updateExtended(),true}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),true}_setOrReportSpecialColor(M,F){const V=M.split(";");for(let X=0;X<V.length&&!(F>=this._specialColors.length);++X,++F)if(V[X]==="?")this._onColor.fire([{type:0,index:this._specialColors[F]}]);else{const H=(0,I.parseColor)(V[X]);H&&this._onColor.fire([{type:1,index:this._specialColors[F],color:H}])}return true}setOrReportFgColor(M){return this._setOrReportSpecialColor(M,0)}setOrReportBgColor(M){return this._setOrReportSpecialColor(M,1)}setOrReportCursorColor(M){return this._setOrReportSpecialColor(M,2)}restoreIndexedColor(M){if(!M)return this._onColor.fire([{type:2}]),true;const F=[],V=M.split(";");for(let X=0;X<V.length;++X)if(/^\d+$/.exec(V[X])){const H=parseInt(V[X]);K(H)&&F.push({type:2,index:H})}return F.length&&this._onColor.fire(F),true}restoreFgColor(M){return this._onColor.fire([{type:2,index:256}]),true}restoreBgColor(M){return this._onColor.fire([{type:2,index:257}]),true}restoreCursorColor(M){return this._onColor.fire([{type:2,index:258}]),true}nextLine(){return this._activeBuffer.x=0,this.index(),true}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=true,this._onRequestSyncScrollBar.fire(),true}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=false,this._onRequestSyncScrollBar.fire(),true}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,b.DEFAULT_CHARSET),true}selectCharset(M){return M.length!==2?(this.selectDefaultCharset(),true):(M[0]==="/"||this._charsetService.setgCharset(k[M[0]],b.CHARSETS[M[1]]||b.DEFAULT_CHARSET),true)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),true}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=true,true}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const M=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,M,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return true}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),true}reset(){this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=f.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(M){return this._charsetService.setgLevel(M),true}screenAlignmentPattern(){const M=new S.CellData;M.content=4194304|"E".charCodeAt(0),M.fg=this._curAttrData.fg,M.bg=this._curAttrData.bg,this._setCursor(0,0);for(let F=0;F<this._bufferService.rows;++F){const V=this._activeBuffer.ybase+this._activeBuffer.y+F,X=this._activeBuffer.lines.get(V);X&&(X.fill(M),X.isWrapped=false)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),true}requestStatusString(M,F){const V=this._bufferService.buffer,X=this._optionsService.rawOptions;return(H=>(this._coreService.triggerDataEvent(`${_.C0.ESC}${H}${_.C0.ESC}\\`),true))(M==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:M==='"p'?'P1$r61;1"p':M==="r"?`P1$r${V.scrollTop+1};${V.scrollBottom+1}r`:M==="m"?"P1$r0m":M===" q"?`P1$r${{block:2,underline:4,bar:6}[X.cursorStyle]-(X.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(M,F){this._dirtyRowTracker.markRangeDirty(M,F)}}u.InputHandler=W;let j=class{constructor(ee){this._bufferService=ee,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(ee){ee<this.start?this.start=ee:ee>this.end&&(this.end=ee)}markRangeDirty(ee,M){ee>M&&(z=ee,ee=M,M=z),ee<this.start&&(this.start=ee),M>this.end&&(this.end=M)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function K(ee){return 0<=ee&&ee<256}j=c([d(0,O.IBufferService)],j)},844:(m,u)=>{function p(c){for(const d of c)d.dispose();c.length=0}Object.defineProperty(u,"__esModule",{value:true}),u.getDisposeArrayDisposable=u.disposeArray=u.toDisposable=u.MutableDisposable=u.Disposable=void 0,u.Disposable=class{constructor(){this._disposables=[],this._isDisposed=false}dispose(){this._isDisposed=true;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const d=this._disposables.indexOf(c);d!==-1&&this._disposables.splice(d,1)}},u.MutableDisposable=class{constructor(){this._isDisposed=false}get value(){return this._isDisposed?void 0:this._value}set value(c){var d;this._isDisposed||c===this._value||((d=this._value)===null||d===void 0||d.dispose(),this._value=c)}clear(){this.value=void 0}dispose(){var c;this._isDisposed=true,(c=this._value)===null||c===void 0||c.dispose(),this._value=void 0}},u.toDisposable=function(c){return{dispose:c}},u.disposeArray=p,u.getDisposeArrayDisposable=function(c){return{dispose:()=>p(c)}}},1505:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.FourKeyMap=u.TwoKeyMap=void 0;class p{constructor(){this._data={}}set(d,_,b){this._data[d]||(this._data[d]={}),this._data[d][_]=b}get(d,_){return this._data[d]?this._data[d][_]:void 0}clear(){this._data={}}}u.TwoKeyMap=p,u.FourKeyMap=class{constructor(){this._data=new p}set(c,d,_,b,$){this._data.get(c,d)||this._data.set(c,d,new p),this._data.get(c,d).set(_,b,$)}get(c,d,_,b){var $;return($=this._data.get(c,d))===null||$===void 0?void 0:$.get(_,b)}clear(){this._data.clear()}}},6114:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.isChromeOS=u.isLinux=u.isWindows=u.isIphone=u.isIpad=u.isMac=u.getSafariVersion=u.isSafari=u.isLegacyEdge=u.isFirefox=u.isNode=void 0,u.isNode=typeof navigator>"u";const p=u.isNode?"node":navigator.userAgent,c=u.isNode?"node":navigator.platform;u.isFirefox=p.includes("Firefox"),u.isLegacyEdge=p.includes("Edge"),u.isSafari=/^((?!chrome|android).)*safari/i.test(p),u.getSafariVersion=function(){if(!u.isSafari)return 0;const d=p.match(/Version\/(\d+)/);return d===null||d.length<2?0:parseInt(d[1])},u.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),u.isIpad=c==="iPad",u.isIphone=c==="iPhone",u.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),u.isLinux=c.indexOf("Linux")>=0,u.isChromeOS=/\bCrOS\b/.test(p)},6106:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.SortedList=void 0;let p=0;u.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(p=this._search(this._getKey(c)),this._array.splice(p,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return false;const d=this._getKey(c);if(d===void 0||(p=this._search(d),p===-1)||this._getKey(this._array[p])!==d)return false;do if(this._array[p]===c)return this._array.splice(p,1),true;while(++p<this._array.length&&this._getKey(this._array[p])===d);return false}*getKeyIterator(c){if(this._array.length!==0&&(p=this._search(c),!(p<0||p>=this._array.length)&&this._getKey(this._array[p])===c))do yield this._array[p];while(++p<this._array.length&&this._getKey(this._array[p])===c)}forEachByKey(c,d){if(this._array.length!==0&&(p=this._search(c),!(p<0||p>=this._array.length)&&this._getKey(this._array[p])===c))do d(this._array[p]);while(++p<this._array.length&&this._getKey(this._array[p])===c)}values(){return[...this._array].values()}_search(c){let d=0,_=this._array.length-1;for(;_>=d;){let b=d+_>>1;const $=this._getKey(this._array[b]);if($>c)_=b-1;else{if(!($<c)){for(;b>0&&this._getKey(this._array[b-1])===c;)b--;return b}d=b+1}}return d}}},7226:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DebouncedIdleTask=u.IdleTaskQueue=u.PriorityTaskQueue=void 0;const c=p(6114);class d{constructor(){this._tasks=[],this._i=0}enqueue($){this._tasks.push($),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process($){this._idleCallback=void 0;let E=0,y=0,f=$.timeRemaining(),v=0;for(;this._i<this._tasks.length;){if(E=Date.now(),this._tasks[this._i]()||this._i++,E=Math.max(1,Date.now()-E),y=Math.max(E,y),v=$.timeRemaining(),1.5*y>v)return f-E<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(f-E))}ms`),void this._start();f=v}this.clear()}}class _ extends d{_requestCallback($){return setTimeout(()=>$(this._createDeadline(16)))}_cancelCallback($){clearTimeout($)}_createDeadline($){const E=Date.now()+$;return{timeRemaining:()=>Math.max(0,E-Date.now())}}}u.PriorityTaskQueue=_,u.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends d{_requestCallback(b){return requestIdleCallback(b)}_cancelCallback(b){cancelIdleCallback(b)}}:_,u.DebouncedIdleTask=class{constructor(){this._queue=new u.IdleTaskQueue}set(b){this._queue.clear(),this._queue.enqueue(b)}flush(){this._queue.flush()}}},9282:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.updateWindowsModeWrappedState=void 0;const c=p(643);u.updateWindowsModeWrappedState=function(d){const _=d.buffer.lines.get(d.buffer.ybase+d.buffer.y-1),b=_==null?void 0:_.get(d.cols-1),$=d.buffer.lines.get(d.buffer.ybase+d.buffer.y);$&&b&&($.isWrapped=b[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&b[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ExtendedAttrs=u.AttributeData=void 0;class p{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(_){return[_>>>16&255,_>>>8&255,255&_]}static fromColorRGB(_){return(255&_[0])<<16|(255&_[1])<<8|255&_[2]}clone(){const _=new p;return _.fg=this.fg,_.bg=this.bg,_.extended=this.extended.clone(),_}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}u.AttributeData=p;class c{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(_){this._ext=_}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(_){this._ext&=-469762049,this._ext|=_<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(_){this._ext&=-67108864,this._ext|=67108863&_}get urlId(){return this._urlId}set urlId(_){this._urlId=_}constructor(_=0,b=0){this._ext=0,this._urlId=0,this._ext=_,this._urlId=b}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}u.ExtendedAttrs=c},9092:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Buffer=u.MAX_BUFFER_SIZE=void 0;const c=p(6349),d=p(7226),_=p(3734),b=p(8437),$=p(4634),E=p(511),y=p(643),f=p(4863),v=p(7116);u.MAX_BUFFER_SIZE=4294967295,u.Buffer=class{constructor(T,S,R){this._hasScrollback=T,this._optionsService=S,this._bufferService=R,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=b.DEFAULT_ATTR_DATA.clone(),this.savedCharset=v.DEFAULT_CHARSET,this.markers=[],this._nullCell=E.CellData.fromCharData([0,y.NULL_CELL_CHAR,y.NULL_CELL_WIDTH,y.NULL_CELL_CODE]),this._whitespaceCell=E.CellData.fromCharData([0,y.WHITESPACE_CELL_CHAR,y.WHITESPACE_CELL_WIDTH,y.WHITESPACE_CELL_CODE]),this._isClearing=false,this._memoryCleanupQueue=new d.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(T){return T?(this._nullCell.fg=T.fg,this._nullCell.bg=T.bg,this._nullCell.extended=T.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new _.ExtendedAttrs),this._nullCell}getWhitespaceCell(T){return T?(this._whitespaceCell.fg=T.fg,this._whitespaceCell.bg=T.bg,this._whitespaceCell.extended=T.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new _.ExtendedAttrs),this._whitespaceCell}getBlankLine(T,S){return new b.BufferLine(this._bufferService.cols,this.getNullCell(T),S)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const T=this.ybase+this.y-this.ydisp;return T>=0&&T<this._rows}_getCorrectBufferLength(T){if(!this._hasScrollback)return T;const S=T+this._optionsService.rawOptions.scrollback;return S>u.MAX_BUFFER_SIZE?u.MAX_BUFFER_SIZE:S}fillViewportRows(T){if(this.lines.length===0){T===void 0&&(T=b.DEFAULT_ATTR_DATA);let S=this._rows;for(;S--;)this.lines.push(this.getBlankLine(T))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(T,S){const R=this.getNullCell(b.DEFAULT_ATTR_DATA);let O=0;const A=this._getCorrectBufferLength(S);if(A>this.lines.maxLength&&(this.lines.maxLength=A),this.lines.length>0){if(this._cols<T)for(let I=0;I<this.lines.length;I++)O+=+this.lines.get(I).resize(T,R);let L=0;if(this._rows<S)for(let I=this._rows;I<S;I++)this.lines.length<S+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new b.BufferLine(T,R)):this.ybase>0&&this.lines.length<=this.ybase+this.y+L+1?(this.ybase--,L++,this.ydisp>0&&this.ydisp--):this.lines.push(new b.BufferLine(T,R)));else for(let I=this._rows;I>S;I--)this.lines.length>S+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(A<this.lines.maxLength){const I=this.lines.length-A;I>0&&(this.lines.trimStart(I),this.ybase=Math.max(this.ybase-I,0),this.ydisp=Math.max(this.ydisp-I,0),this.savedY=Math.max(this.savedY-I,0)),this.lines.maxLength=A}this.x=Math.min(this.x,T-1),this.y=Math.min(this.y,S-1),L&&(this.y+=L),this.savedX=Math.min(this.savedX,T-1),this.scrollTop=0}if(this.scrollBottom=S-1,this._isReflowEnabled&&(this._reflow(T,S),this._cols>T))for(let L=0;L<this.lines.length;L++)O+=+this.lines.get(L).resize(T,R);this._cols=T,this._rows=S,this._memoryCleanupQueue.clear(),O>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let T=true;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,T=false);let S=0;for(;this._memoryCleanupPosition<this.lines.length;)if(S+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),S>100)return true;return T}get _isReflowEnabled(){const T=this._optionsService.rawOptions.windowsPty;return T&&T.buildNumber?this._hasScrollback&&T.backend==="conpty"&&T.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(T,S){this._cols!==T&&(T>this._cols?this._reflowLarger(T,S):this._reflowSmaller(T,S))}_reflowLarger(T,S){const R=(0,$.reflowLargerGetLinesToRemove)(this.lines,this._cols,T,this.ybase+this.y,this.getNullCell(b.DEFAULT_ATTR_DATA));if(R.length>0){const O=(0,$.reflowLargerCreateNewLayout)(this.lines,R);(0,$.reflowLargerApplyNewLayout)(this.lines,O.layout),this._reflowLargerAdjustViewport(T,S,O.countRemoved)}}_reflowLargerAdjustViewport(T,S,R){const O=this.getNullCell(b.DEFAULT_ATTR_DATA);let A=R;for(;A-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<S&&this.lines.push(new b.BufferLine(T,O))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-R,0)}_reflowSmaller(T,S){const R=this.getNullCell(b.DEFAULT_ATTR_DATA),O=[];let A=0;for(let L=this.lines.length-1;L>=0;L--){let I=this.lines.get(L);if(!I||!I.isWrapped&&I.getTrimmedLength()<=T)continue;const k=[I];for(;I.isWrapped&&L>0;)I=this.lines.get(--L),k.unshift(I);const B=this.ybase+this.y;if(B>=L&&B<L+k.length)continue;const U=k[k.length-1].getTrimmedLength(),P=(0,$.reflowSmallerGetNewLineLengths)(k,this._cols,T),z=P.length-k.length;let W;W=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+z):Math.max(0,this.lines.length-this.lines.maxLength+z);const j=[];for(let X=0;X<z;X++){const H=this.getBlankLine(b.DEFAULT_ATTR_DATA,true);j.push(H)}j.length>0&&(O.push({start:L+k.length+A,newLines:j}),A+=j.length),k.push(...j);let K=P.length-1,ee=P[K];ee===0&&(K--,ee=P[K]);let M=k.length-z-1,F=U;for(;M>=0;){const X=Math.min(F,ee);if(k[K]===void 0)break;if(k[K].copyCellsFrom(k[M],F-X,ee-X,X,true),ee-=X,ee===0&&(K--,ee=P[K]),F-=X,F===0){M--;const H=Math.max(M,0);F=(0,$.getWrappedLineTrimmedLength)(k,H,this._cols)}}for(let X=0;X<k.length;X++)P[X]<T&&k[X].setCell(P[X],R);let V=z-W;for(;V-- >0;)this.ybase===0?this.y<S-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+A)-S&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+z,this.ybase+S-1)}if(O.length>0){const L=[],I=[];for(let K=0;K<this.lines.length;K++)I.push(this.lines.get(K));const k=this.lines.length;let B=k-1,U=0,P=O[U];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+A);let z=0;for(let K=Math.min(this.lines.maxLength-1,k+A-1);K>=0;K--)if(P&&P.start>B+z){for(let ee=P.newLines.length-1;ee>=0;ee--)this.lines.set(K--,P.newLines[ee]);K++,L.push({index:B+1,amount:P.newLines.length}),z+=P.newLines.length,P=O[++U]}else this.lines.set(K,I[B--]);let W=0;for(let K=L.length-1;K>=0;K--)L[K].index+=W,this.lines.onInsertEmitter.fire(L[K]),W+=L[K].amount;const j=Math.max(0,k+A-this.lines.maxLength);j>0&&this.lines.onTrimEmitter.fire(j)}}translateBufferLineToString(T,S,R=0,O){const A=this.lines.get(T);return A?A.translateToString(S,R,O):""}getWrappedRangeForLine(T){let S=T,R=T;for(;S>0&&this.lines.get(S).isWrapped;)S--;for(;R+1<this.lines.length&&this.lines.get(R+1).isWrapped;)R++;return{first:S,last:R}}setupTabStops(T){for(T!=null?this.tabs[T]||(T=this.prevStop(T)):(this.tabs={},T=0);T<this._cols;T+=this._optionsService.rawOptions.tabStopWidth)this.tabs[T]=true}prevStop(T){for(T==null&&(T=this.x);!this.tabs[--T]&&T>0;);return T>=this._cols?this._cols-1:T<0?0:T}nextStop(T){for(T==null&&(T=this.x);!this.tabs[++T]&&T<this._cols;);return T>=this._cols?this._cols-1:T<0?0:T}clearMarkers(T){this._isClearing=true;for(let S=0;S<this.markers.length;S++)this.markers[S].line===T&&(this.markers[S].dispose(),this.markers.splice(S--,1));this._isClearing=false}clearAllMarkers(){this._isClearing=true;for(let T=0;T<this.markers.length;T++)this.markers[T].dispose(),this.markers.splice(T--,1);this._isClearing=false}addMarker(T){const S=new f.Marker(T);return this.markers.push(S),S.register(this.lines.onTrim(R=>{S.line-=R,S.line<0&&S.dispose()})),S.register(this.lines.onInsert(R=>{S.line>=R.index&&(S.line+=R.amount)})),S.register(this.lines.onDelete(R=>{S.line>=R.index&&S.line<R.index+R.amount&&S.dispose(),S.line>R.index&&(S.line-=R.amount)})),S.register(S.onDispose(()=>this._removeMarker(S))),S}_removeMarker(T){this._isClearing||this.markers.splice(this.markers.indexOf(T),1)}}},8437:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferLine=u.DEFAULT_ATTR_DATA=void 0;const c=p(3734),d=p(511),_=p(643),b=p(482);u.DEFAULT_ATTR_DATA=Object.freeze(new c.AttributeData);let $=0;class E{constructor(f,v,T=false){this.isWrapped=T,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*f);const S=v||d.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]);for(let R=0;R<f;++R)this.setCell(R,S);this.length=f}get(f){const v=this._data[3*f+0],T=2097151&v;return[this._data[3*f+1],2097152&v?this._combined[f]:T?(0,b.stringFromCodePoint)(T):"",v>>22,2097152&v?this._combined[f].charCodeAt(this._combined[f].length-1):T]}set(f,v){this._data[3*f+1]=v[_.CHAR_DATA_ATTR_INDEX],v[_.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[f]=v[1],this._data[3*f+0]=2097152|f|v[_.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*f+0]=v[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[_.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(f){return this._data[3*f+0]>>22}hasWidth(f){return 12582912&this._data[3*f+0]}getFg(f){return this._data[3*f+1]}getBg(f){return this._data[3*f+2]}hasContent(f){return 4194303&this._data[3*f+0]}getCodePoint(f){const v=this._data[3*f+0];return 2097152&v?this._combined[f].charCodeAt(this._combined[f].length-1):2097151&v}isCombined(f){return 2097152&this._data[3*f+0]}getString(f){const v=this._data[3*f+0];return 2097152&v?this._combined[f]:2097151&v?(0,b.stringFromCodePoint)(2097151&v):""}isProtected(f){return 536870912&this._data[3*f+2]}loadCell(f,v){return $=3*f,v.content=this._data[$+0],v.fg=this._data[$+1],v.bg=this._data[$+2],2097152&v.content&&(v.combinedData=this._combined[f]),268435456&v.bg&&(v.extended=this._extendedAttrs[f]),v}setCell(f,v){2097152&v.content&&(this._combined[f]=v.combinedData),268435456&v.bg&&(this._extendedAttrs[f]=v.extended),this._data[3*f+0]=v.content,this._data[3*f+1]=v.fg,this._data[3*f+2]=v.bg}setCellFromCodePoint(f,v,T,S,R,O){268435456&R&&(this._extendedAttrs[f]=O),this._data[3*f+0]=v|T<<22,this._data[3*f+1]=S,this._data[3*f+2]=R}addCodepointToCell(f,v){let T=this._data[3*f+0];2097152&T?this._combined[f]+=(0,b.stringFromCodePoint)(v):(2097151&T?(this._combined[f]=(0,b.stringFromCodePoint)(2097151&T)+(0,b.stringFromCodePoint)(v),T&=-2097152,T|=2097152):T=v|4194304,this._data[3*f+0]=T)}insertCells(f,v,T,S){if((f%=this.length)&&this.getWidth(f-1)===2&&this.setCellFromCodePoint(f-1,0,1,(S==null?void 0:S.fg)||0,(S==null?void 0:S.bg)||0,(S==null?void 0:S.extended)||new c.ExtendedAttrs),v<this.length-f){const R=new d.CellData;for(let O=this.length-f-v-1;O>=0;--O)this.setCell(f+v+O,this.loadCell(f+O,R));for(let O=0;O<v;++O)this.setCell(f+O,T)}else for(let R=f;R<this.length;++R)this.setCell(R,T);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(S==null?void 0:S.fg)||0,(S==null?void 0:S.bg)||0,(S==null?void 0:S.extended)||new c.ExtendedAttrs)}deleteCells(f,v,T,S){if(f%=this.length,v<this.length-f){const R=new d.CellData;for(let O=0;O<this.length-f-v;++O)this.setCell(f+O,this.loadCell(f+v+O,R));for(let O=this.length-v;O<this.length;++O)this.setCell(O,T)}else for(let R=f;R<this.length;++R)this.setCell(R,T);f&&this.getWidth(f-1)===2&&this.setCellFromCodePoint(f-1,0,1,(S==null?void 0:S.fg)||0,(S==null?void 0:S.bg)||0,(S==null?void 0:S.extended)||new c.ExtendedAttrs),this.getWidth(f)!==0||this.hasContent(f)||this.setCellFromCodePoint(f,0,1,(S==null?void 0:S.fg)||0,(S==null?void 0:S.bg)||0,(S==null?void 0:S.extended)||new c.ExtendedAttrs)}replaceCells(f,v,T,S,R=false){if(R)for(f&&this.getWidth(f-1)===2&&!this.isProtected(f-1)&&this.setCellFromCodePoint(f-1,0,1,(S==null?void 0:S.fg)||0,(S==null?void 0:S.bg)||0,(S==null?void 0:S.extended)||new c.ExtendedAttrs),v<this.length&&this.getWidth(v-1)===2&&!this.isProtected(v)&&this.setCellFromCodePoint(v,0,1,(S==null?void 0:S.fg)||0,(S==null?void 0:S.bg)||0,(S==null?void 0:S.extended)||new c.ExtendedAttrs);f<v&&f<this.length;)this.isProtected(f)||this.setCell(f,T),f++;else for(f&&this.getWidth(f-1)===2&&this.setCellFromCodePoint(f-1,0,1,(S==null?void 0:S.fg)||0,(S==null?void 0:S.bg)||0,(S==null?void 0:S.extended)||new c.ExtendedAttrs),v<this.length&&this.getWidth(v-1)===2&&this.setCellFromCodePoint(v,0,1,(S==null?void 0:S.fg)||0,(S==null?void 0:S.bg)||0,(S==null?void 0:S.extended)||new c.ExtendedAttrs);f<v&&f<this.length;)this.setCell(f++,T)}resize(f,v){if(f===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const T=3*f;if(f>this.length){if(this._data.buffer.byteLength>=4*T)this._data=new Uint32Array(this._data.buffer,0,T);else{const S=new Uint32Array(T);S.set(this._data),this._data=S}for(let S=this.length;S<f;++S)this.setCell(S,v)}else{this._data=this._data.subarray(0,T);const S=Object.keys(this._combined);for(let O=0;O<S.length;O++){const A=parseInt(S[O],10);A>=f&&delete this._combined[A]}const R=Object.keys(this._extendedAttrs);for(let O=0;O<R.length;O++){const A=parseInt(R[O],10);A>=f&&delete this._extendedAttrs[A]}}return this.length=f,4*T*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const f=new Uint32Array(this._data.length);return f.set(this._data),this._data=f,1}return 0}fill(f,v=false){if(v)for(let T=0;T<this.length;++T)this.isProtected(T)||this.setCell(T,f);else{this._combined={},this._extendedAttrs={};for(let T=0;T<this.length;++T)this.setCell(T,f)}}copyFrom(f){this.length!==f.length?this._data=new Uint32Array(f._data):this._data.set(f._data),this.length=f.length,this._combined={};for(const v in f._combined)this._combined[v]=f._combined[v];this._extendedAttrs={};for(const v in f._extendedAttrs)this._extendedAttrs[v]=f._extendedAttrs[v];this.isWrapped=f.isWrapped}clone(){const f=new E(0);f._data=new Uint32Array(this._data),f.length=this.length;for(const v in this._combined)f._combined[v]=this._combined[v];for(const v in this._extendedAttrs)f._extendedAttrs[v]=this._extendedAttrs[v];return f.isWrapped=this.isWrapped,f}getTrimmedLength(){for(let f=this.length-1;f>=0;--f)if(4194303&this._data[3*f+0])return f+(this._data[3*f+0]>>22);return 0}getNoBgTrimmedLength(){for(let f=this.length-1;f>=0;--f)if(4194303&this._data[3*f+0]||50331648&this._data[3*f+2])return f+(this._data[3*f+0]>>22);return 0}copyCellsFrom(f,v,T,S,R){const O=f._data;if(R)for(let L=S-1;L>=0;L--){for(let I=0;I<3;I++)this._data[3*(T+L)+I]=O[3*(v+L)+I];268435456&O[3*(v+L)+2]&&(this._extendedAttrs[T+L]=f._extendedAttrs[v+L])}else for(let L=0;L<S;L++){for(let I=0;I<3;I++)this._data[3*(T+L)+I]=O[3*(v+L)+I];268435456&O[3*(v+L)+2]&&(this._extendedAttrs[T+L]=f._extendedAttrs[v+L])}const A=Object.keys(f._combined);for(let L=0;L<A.length;L++){const I=parseInt(A[L],10);I>=v&&(this._combined[I-v+T]=f._combined[I])}}translateToString(f=false,v=0,T=this.length){f&&(T=Math.min(T,this.getTrimmedLength()));let S="";for(;v<T;){const R=this._data[3*v+0],O=2097151&R;S+=2097152&R?this._combined[v]:O?(0,b.stringFromCodePoint)(O):_.WHITESPACE_CELL_CHAR,v+=R>>22||1}return S}}u.BufferLine=E},4841:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.getRangeLength=void 0,u.getRangeLength=function(p,c){if(p.start.y>p.end.y)throw new Error(`Buffer range end (${p.end.x}, ${p.end.y}) cannot be before start (${p.start.x}, ${p.start.y})`);return c*(p.end.y-p.start.y)+(p.end.x-p.start.x+1)}},4634:(m,u)=>{function p(c,d,_){if(d===c.length-1)return c[d].getTrimmedLength();const b=!c[d].hasContent(_-1)&&c[d].getWidth(_-1)===1,$=c[d+1].getWidth(0)===2;return b&&$?_-1:_}Object.defineProperty(u,"__esModule",{value:true}),u.getWrappedLineTrimmedLength=u.reflowSmallerGetNewLineLengths=u.reflowLargerApplyNewLayout=u.reflowLargerCreateNewLayout=u.reflowLargerGetLinesToRemove=void 0,u.reflowLargerGetLinesToRemove=function(c,d,_,b,$){const E=[];for(let y=0;y<c.length-1;y++){let f=y,v=c.get(++f);if(!v.isWrapped)continue;const T=[c.get(y)];for(;f<c.length&&v.isWrapped;)T.push(v),v=c.get(++f);if(b>=y&&b<f){y+=T.length-1;continue}let S=0,R=p(T,S,d),O=1,A=0;for(;O<T.length;){const I=p(T,O,d),k=I-A,B=_-R,U=Math.min(k,B);T[S].copyCellsFrom(T[O],A,R,U,false),R+=U,R===_&&(S++,R=0),A+=U,A===I&&(O++,A=0),R===0&&S!==0&&T[S-1].getWidth(_-1)===2&&(T[S].copyCellsFrom(T[S-1],_-1,R++,1,false),T[S-1].setCell(_-1,$))}T[S].replaceCells(R,_,$);let L=0;for(let I=T.length-1;I>0&&(I>S||T[I].getTrimmedLength()===0);I--)L++;L>0&&(E.push(y+T.length-L),E.push(L)),y+=T.length-1}return E},u.reflowLargerCreateNewLayout=function(c,d){const _=[];let b=0,$=d[b],E=0;for(let y=0;y<c.length;y++)if($===y){const f=d[++b];c.onDeleteEmitter.fire({index:y-E,amount:f}),y+=f-1,E+=f,$=d[++b]}else _.push(y);return{layout:_,countRemoved:E}},u.reflowLargerApplyNewLayout=function(c,d){const _=[];for(let b=0;b<d.length;b++)_.push(c.get(d[b]));for(let b=0;b<_.length;b++)c.set(b,_[b]);c.length=d.length},u.reflowSmallerGetNewLineLengths=function(c,d,_){const b=[],$=c.map((v,T)=>p(c,T,d)).reduce((v,T)=>v+T);let E=0,y=0,f=0;for(;f<$;){if($-f<_){b.push($-f);break}E+=_;const v=p(c,y,d);E>v&&(E-=v,y++);const T=c[y].getWidth(E-1)===2;T&&E--;const S=T?_-1:_;b.push(S),f+=S}return b},u.getWrappedLineTrimmedLength=p},5295:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferSet=void 0;const c=p(8460),d=p(844),_=p(9092);class b extends d.Disposable{constructor(E,y){super(),this._optionsService=E,this._bufferService=y,this._onBufferActivate=this.register(new c.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new _.Buffer(true,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new _.Buffer(false,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(E){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(E),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(E,y){this._normal.resize(E,y),this._alt.resize(E,y),this.setupTabStops(E)}setupTabStops(E){this._normal.setupTabStops(E),this._alt.setupTabStops(E)}}u.BufferSet=b},511:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CellData=void 0;const c=p(482),d=p(643),_=p(3734);class b extends _.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new _.ExtendedAttrs,this.combinedData=""}static fromCharData(E){const y=new b;return y.setFromCharData(E),y}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(E){this.fg=E[d.CHAR_DATA_ATTR_INDEX],this.bg=0;let y=false;if(E[d.CHAR_DATA_CHAR_INDEX].length>2)y=true;else if(E[d.CHAR_DATA_CHAR_INDEX].length===2){const f=E[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=f&&f<=56319){const v=E[d.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=v&&v<=57343?this.content=1024*(f-55296)+v-56320+65536|E[d.CHAR_DATA_WIDTH_INDEX]<<22:y=true}else y=true}else this.content=E[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|E[d.CHAR_DATA_WIDTH_INDEX]<<22;y&&(this.combinedData=E[d.CHAR_DATA_CHAR_INDEX],this.content=2097152|E[d.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}u.CellData=b},643:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.WHITESPACE_CELL_CODE=u.WHITESPACE_CELL_WIDTH=u.WHITESPACE_CELL_CHAR=u.NULL_CELL_CODE=u.NULL_CELL_WIDTH=u.NULL_CELL_CHAR=u.CHAR_DATA_CODE_INDEX=u.CHAR_DATA_WIDTH_INDEX=u.CHAR_DATA_CHAR_INDEX=u.CHAR_DATA_ATTR_INDEX=u.DEFAULT_EXT=u.DEFAULT_ATTR=u.DEFAULT_COLOR=void 0,u.DEFAULT_COLOR=0,u.DEFAULT_ATTR=256|u.DEFAULT_COLOR<<9,u.DEFAULT_EXT=0,u.CHAR_DATA_ATTR_INDEX=0,u.CHAR_DATA_CHAR_INDEX=1,u.CHAR_DATA_WIDTH_INDEX=2,u.CHAR_DATA_CODE_INDEX=3,u.NULL_CELL_CHAR="",u.NULL_CELL_WIDTH=1,u.NULL_CELL_CODE=0,u.WHITESPACE_CELL_CHAR=" ",u.WHITESPACE_CELL_WIDTH=1,u.WHITESPACE_CELL_CODE=32},4863:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Marker=void 0;const c=p(8460),d=p(844);class _{get id(){return this._id}constructor($){this.line=$,this.isDisposed=false,this._disposables=[],this._id=_._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=true,this.line=-1,this._onDispose.fire(),(0,d.disposeArray)(this._disposables),this._disposables.length=0)}register($){return this._disposables.push($),$}}u.Marker=_,_._nextId=1},7116:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DEFAULT_CHARSET=u.CHARSETS=void 0,u.CHARSETS={},u.DEFAULT_CHARSET=u.CHARSETS.B,u.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},u.CHARSETS.A={"#":"£"},u.CHARSETS.B=void 0,u.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},u.CHARSETS.C=u.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},u.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},u.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},u.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},u.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},u.CHARSETS.E=u.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},u.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},u.CHARSETS.H=u.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},u.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(m,u)=>{var p,c,d;Object.defineProperty(u,"__esModule",{value:true}),u.C1_ESCAPED=u.C1=u.C0=void 0,function(_){_.NUL="\0",_.SOH="",_.STX="",_.ETX="",_.EOT="",_.ENQ="",_.ACK="",_.BEL="\x07",_.BS="\b",_.HT="	",_.LF=`
`,_.VT="\v",_.FF="\f",_.CR="\r",_.SO="",_.SI="",_.DLE="",_.DC1="",_.DC2="",_.DC3="",_.DC4="",_.NAK="",_.SYN="",_.ETB="",_.CAN="",_.EM="",_.SUB="",_.ESC="\x1B",_.FS="",_.GS="",_.RS="",_.US="",_.SP=" ",_.DEL=""}(p||(u.C0=p={})),function(_){_.PAD="",_.HOP="",_.BPH="",_.NBH="",_.IND="",_.NEL="",_.SSA="",_.ESA="",_.HTS="",_.HTJ="",_.VTS="",_.PLD="",_.PLU="",_.RI="",_.SS2="",_.SS3="",_.DCS="",_.PU1="",_.PU2="",_.STS="",_.CCH="",_.MW="",_.SPA="",_.EPA="",_.SOS="",_.SGCI="",_.SCI="",_.CSI="",_.ST="",_.OSC="",_.PM="",_.APC=""}(c||(u.C1=c={})),function(_){_.ST=`${p.ESC}\\`}(d||(u.C1_ESCAPED=d={}))},7399:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.evaluateKeyboardEvent=void 0;const c=p(2584),d={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};u.evaluateKeyboardEvent=function(_,b,$,E){const y={type:0,cancel:false,key:void 0},f=(_.shiftKey?1:0)|(_.altKey?2:0)|(_.ctrlKey?4:0)|(_.metaKey?8:0);switch(_.keyCode){case 0:_.key==="UIKeyInputUpArrow"?y.key=b?c.C0.ESC+"OA":c.C0.ESC+"[A":_.key==="UIKeyInputLeftArrow"?y.key=b?c.C0.ESC+"OD":c.C0.ESC+"[D":_.key==="UIKeyInputRightArrow"?y.key=b?c.C0.ESC+"OC":c.C0.ESC+"[C":_.key==="UIKeyInputDownArrow"&&(y.key=b?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:if(_.altKey){y.key=c.C0.ESC+c.C0.DEL;break}y.key=c.C0.DEL;break;case 9:if(_.shiftKey){y.key=c.C0.ESC+"[Z";break}y.key=c.C0.HT,y.cancel=true;break;case 13:y.key=_.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,y.cancel=true;break;case 27:y.key=c.C0.ESC,_.altKey&&(y.key=c.C0.ESC+c.C0.ESC),y.cancel=true;break;case 37:if(_.metaKey)break;f?(y.key=c.C0.ESC+"[1;"+(f+1)+"D",y.key===c.C0.ESC+"[1;3D"&&(y.key=c.C0.ESC+($?"b":"[1;5D"))):y.key=b?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(_.metaKey)break;f?(y.key=c.C0.ESC+"[1;"+(f+1)+"C",y.key===c.C0.ESC+"[1;3C"&&(y.key=c.C0.ESC+($?"f":"[1;5C"))):y.key=b?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(_.metaKey)break;f?(y.key=c.C0.ESC+"[1;"+(f+1)+"A",$||y.key!==c.C0.ESC+"[1;3A"||(y.key=c.C0.ESC+"[1;5A")):y.key=b?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(_.metaKey)break;f?(y.key=c.C0.ESC+"[1;"+(f+1)+"B",$||y.key!==c.C0.ESC+"[1;3B"||(y.key=c.C0.ESC+"[1;5B")):y.key=b?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:_.shiftKey||_.ctrlKey||(y.key=c.C0.ESC+"[2~");break;case 46:y.key=f?c.C0.ESC+"[3;"+(f+1)+"~":c.C0.ESC+"[3~";break;case 36:y.key=f?c.C0.ESC+"[1;"+(f+1)+"H":b?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:y.key=f?c.C0.ESC+"[1;"+(f+1)+"F":b?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:_.shiftKey?y.type=2:_.ctrlKey?y.key=c.C0.ESC+"[5;"+(f+1)+"~":y.key=c.C0.ESC+"[5~";break;case 34:_.shiftKey?y.type=3:_.ctrlKey?y.key=c.C0.ESC+"[6;"+(f+1)+"~":y.key=c.C0.ESC+"[6~";break;case 112:y.key=f?c.C0.ESC+"[1;"+(f+1)+"P":c.C0.ESC+"OP";break;case 113:y.key=f?c.C0.ESC+"[1;"+(f+1)+"Q":c.C0.ESC+"OQ";break;case 114:y.key=f?c.C0.ESC+"[1;"+(f+1)+"R":c.C0.ESC+"OR";break;case 115:y.key=f?c.C0.ESC+"[1;"+(f+1)+"S":c.C0.ESC+"OS";break;case 116:y.key=f?c.C0.ESC+"[15;"+(f+1)+"~":c.C0.ESC+"[15~";break;case 117:y.key=f?c.C0.ESC+"[17;"+(f+1)+"~":c.C0.ESC+"[17~";break;case 118:y.key=f?c.C0.ESC+"[18;"+(f+1)+"~":c.C0.ESC+"[18~";break;case 119:y.key=f?c.C0.ESC+"[19;"+(f+1)+"~":c.C0.ESC+"[19~";break;case 120:y.key=f?c.C0.ESC+"[20;"+(f+1)+"~":c.C0.ESC+"[20~";break;case 121:y.key=f?c.C0.ESC+"[21;"+(f+1)+"~":c.C0.ESC+"[21~";break;case 122:y.key=f?c.C0.ESC+"[23;"+(f+1)+"~":c.C0.ESC+"[23~";break;case 123:y.key=f?c.C0.ESC+"[24;"+(f+1)+"~":c.C0.ESC+"[24~";break;default:if(!_.ctrlKey||_.shiftKey||_.altKey||_.metaKey)if($&&!E||!_.altKey||_.metaKey)!$||_.altKey||_.ctrlKey||_.shiftKey||!_.metaKey?_.key&&!_.ctrlKey&&!_.altKey&&!_.metaKey&&_.keyCode>=48&&_.key.length===1?y.key=_.key:_.key&&_.ctrlKey&&(_.key==="_"&&(y.key=c.C0.US),_.key==="@"&&(y.key=c.C0.NUL)):_.keyCode===65&&(y.type=1);else{const v=d[_.keyCode],T=v==null?void 0:v[_.shiftKey?1:0];if(T)y.key=c.C0.ESC+T;else if(_.keyCode>=65&&_.keyCode<=90){const S=_.ctrlKey?_.keyCode-64:_.keyCode+32;let R=String.fromCharCode(S);_.shiftKey&&(R=R.toUpperCase()),y.key=c.C0.ESC+R}else if(_.keyCode===32)y.key=c.C0.ESC+(_.ctrlKey?c.C0.NUL:" ");else if(_.key==="Dead"&&_.code.startsWith("Key")){let S=_.code.slice(3,4);_.shiftKey||(S=S.toLowerCase()),y.key=c.C0.ESC+S,y.cancel=true}}else _.keyCode>=65&&_.keyCode<=90?y.key=String.fromCharCode(_.keyCode-64):_.keyCode===32?y.key=c.C0.NUL:_.keyCode>=51&&_.keyCode<=55?y.key=String.fromCharCode(_.keyCode-51+27):_.keyCode===56?y.key=c.C0.DEL:_.keyCode===219?y.key=c.C0.ESC:_.keyCode===220?y.key=c.C0.FS:_.keyCode===221&&(y.key=c.C0.GS)}return y}},482:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Utf8ToUtf32=u.StringToUtf32=u.utf32ToString=u.stringFromCodePoint=void 0,u.stringFromCodePoint=function(p){return p>65535?(p-=65536,String.fromCharCode(55296+(p>>10))+String.fromCharCode(p%1024+56320)):String.fromCharCode(p)},u.utf32ToString=function(p,c=0,d=p.length){let _="";for(let b=c;b<d;++b){let $=p[b];$>65535?($-=65536,_+=String.fromCharCode(55296+($>>10))+String.fromCharCode($%1024+56320)):_+=String.fromCharCode($)}return _},u.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(p,c){const d=p.length;if(!d)return 0;let _=0,b=0;if(this._interim){const $=p.charCodeAt(b++);56320<=$&&$<=57343?c[_++]=1024*(this._interim-55296)+$-56320+65536:(c[_++]=this._interim,c[_++]=$),this._interim=0}for(let $=b;$<d;++$){const E=p.charCodeAt($);if(55296<=E&&E<=56319){if(++$>=d)return this._interim=E,_;const y=p.charCodeAt($);56320<=y&&y<=57343?c[_++]=1024*(E-55296)+y-56320+65536:(c[_++]=E,c[_++]=y)}else E!==65279&&(c[_++]=E)}return _}},u.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(p,c){const d=p.length;if(!d)return 0;let _,b,$,E,y=0,f=0,v=0;if(this.interim[0]){let R=false,O=this.interim[0];O&=(224&O)==192?31:(240&O)==224?15:7;let A,L=0;for(;(A=63&this.interim[++L])&&L<4;)O<<=6,O|=A;const I=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,k=I-L;for(;v<k;){if(v>=d)return 0;if(A=p[v++],(192&A)!=128){v--,R=true;break}this.interim[L++]=A,O<<=6,O|=63&A}R||(I===2?O<128?v--:c[y++]=O:I===3?O<2048||O>=55296&&O<=57343||O===65279||(c[y++]=O):O<65536||O>1114111||(c[y++]=O)),this.interim.fill(0)}const T=d-4;let S=v;for(;S<d;){for(;!(!(S<T)||128&(_=p[S])||128&(b=p[S+1])||128&($=p[S+2])||128&(E=p[S+3]));)c[y++]=_,c[y++]=b,c[y++]=$,c[y++]=E,S+=4;if(_=p[S++],_<128)c[y++]=_;else if((224&_)==192){if(S>=d)return this.interim[0]=_,y;if(b=p[S++],(192&b)!=128){S--;continue}if(f=(31&_)<<6|63&b,f<128){S--;continue}c[y++]=f}else if((240&_)==224){if(S>=d)return this.interim[0]=_,y;if(b=p[S++],(192&b)!=128){S--;continue}if(S>=d)return this.interim[0]=_,this.interim[1]=b,y;if($=p[S++],(192&$)!=128){S--;continue}if(f=(15&_)<<12|(63&b)<<6|63&$,f<2048||f>=55296&&f<=57343||f===65279)continue;c[y++]=f}else if((248&_)==240){if(S>=d)return this.interim[0]=_,y;if(b=p[S++],(192&b)!=128){S--;continue}if(S>=d)return this.interim[0]=_,this.interim[1]=b,y;if($=p[S++],(192&$)!=128){S--;continue}if(S>=d)return this.interim[0]=_,this.interim[1]=b,this.interim[2]=$,y;if(E=p[S++],(192&E)!=128){S--;continue}if(f=(7&_)<<18|(63&b)<<12|(63&$)<<6|63&E,f<65536||f>1114111)continue;c[y++]=f}}return y}}},225:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.UnicodeV6=void 0;const p=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],c=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let d;u.UnicodeV6=class{constructor(){if(this.version="6",!d){d=new Uint8Array(65536),d.fill(1),d[0]=0,d.fill(0,1,32),d.fill(0,127,160),d.fill(2,4352,4448),d[9001]=2,d[9002]=2,d.fill(2,11904,42192),d[12351]=1,d.fill(2,44032,55204),d.fill(2,63744,64256),d.fill(2,65040,65050),d.fill(2,65072,65136),d.fill(2,65280,65377),d.fill(2,65504,65511);for(let _=0;_<p.length;++_)d.fill(0,p[_][0],p[_][1]+1)}}wcwidth(_){return _<32?0:_<127?1:_<65536?d[_]:function(b,$){let E,y=0,f=$.length-1;if(b<$[0][0]||b>$[f][1])return false;for(;f>=y;)if(E=y+f>>1,b>$[E][1])y=E+1;else{if(!(b<$[E][0]))return true;f=E-1}return false}(_,c)?0:_>=131072&&_<=196605||_>=196608&&_<=262141?2:1}}},5981:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.WriteBuffer=void 0;const c=p(8460),d=p(844);class _ extends d.Disposable{constructor($){super(),this._action=$,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=false,this._syncCalls=0,this._didUserInput=false,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=true}writeSync($,E){if(E!==void 0&&this._syncCalls>E)return void(this._syncCalls=0);if(this._pendingData+=$.length,this._writeBuffer.push($),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let y;for(this._isSyncWriting=true;y=this._writeBuffer.shift();){this._action(y);const f=this._callbacks.shift();f&&f()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=false,this._syncCalls=0}write($,E){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=false,this._pendingData+=$.length,this._writeBuffer.push($),this._callbacks.push(E),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=$.length,this._writeBuffer.push($),this._callbacks.push(E)}_innerWrite($=0,E=true){const y=$||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const f=this._writeBuffer[this._bufferOffset],v=this._action(f,E);if(v){const S=R=>Date.now()-y>=12?setTimeout(()=>this._innerWrite(0,R)):this._innerWrite(y,R);return void v.catch(R=>(queueMicrotask(()=>{throw R}),Promise.resolve(false))).then(S)}const T=this._callbacks[this._bufferOffset];if(T&&T(),this._bufferOffset++,this._pendingData-=f.length,Date.now()-y>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}u.WriteBuffer=_},5941:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.toRgbString=u.parseColor=void 0;const p=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function d(_,b){const $=_.toString(16),E=$.length<2?"0"+$:$;switch(b){case 4:return $[0];case 8:return E;case 12:return(E+E).slice(0,3);default:return E+E}}u.parseColor=function(_){if(!_)return;let b=_.toLowerCase();if(b.indexOf("rgb:")===0){b=b.slice(4);const $=p.exec(b);if($){const E=$[1]?15:$[4]?255:$[7]?4095:65535;return[Math.round(parseInt($[1]||$[4]||$[7]||$[10],16)/E*255),Math.round(parseInt($[2]||$[5]||$[8]||$[11],16)/E*255),Math.round(parseInt($[3]||$[6]||$[9]||$[12],16)/E*255)]}}else if(b.indexOf("#")===0&&(b=b.slice(1),c.exec(b)&&[3,6,9,12].includes(b.length))){const $=b.length/3,E=[0,0,0];for(let y=0;y<3;++y){const f=parseInt(b.slice($*y,$*y+$),16);E[y]=$===1?f<<4:$===2?f:$===3?f>>4:f>>8}return E}},u.toRgbString=function(_,b=16){const[$,E,y]=_;return`rgb:${d($,b)}/${d(E,b)}/${d(y,b)}`}},5770:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.PAYLOAD_LIMIT=void 0,u.PAYLOAD_LIMIT=1e7},6351:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DcsHandler=u.DcsParser=void 0;const c=p(482),d=p(8742),_=p(5770),b=[];u.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=b,this._ident=0,this._handlerFb=()=>{},this._stack={paused:false,loopPosition:0,fallThrough:false}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=b}registerHandler(E,y){this._handlers[E]===void 0&&(this._handlers[E]=[]);const f=this._handlers[E];return f.push(y),{dispose:()=>{const v=f.indexOf(y);v!==-1&&f.splice(v,1)}}}clearHandler(E){this._handlers[E]&&delete this._handlers[E]}setHandlerFallback(E){this._handlerFb=E}reset(){if(this._active.length)for(let E=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;E>=0;--E)this._active[E].unhook(false);this._stack.paused=false,this._active=b,this._ident=0}hook(E,y){if(this.reset(),this._ident=E,this._active=this._handlers[E]||b,this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].hook(y);else this._handlerFb(this._ident,"HOOK",y)}put(E,y,f){if(this._active.length)for(let v=this._active.length-1;v>=0;v--)this._active[v].put(E,y,f);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(E,y,f))}unhook(E,y=true){if(this._active.length){let f=false,v=this._active.length-1,T=false;if(this._stack.paused&&(v=this._stack.loopPosition-1,f=y,T=this._stack.fallThrough,this._stack.paused=false),!T&&f===false){for(;v>=0&&(f=this._active[v].unhook(E),f!==true);v--)if(f instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=v,this._stack.fallThrough=false,f;v--}for(;v>=0;v--)if(f=this._active[v].unhook(false),f instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=v,this._stack.fallThrough=true,f}else this._handlerFb(this._ident,"UNHOOK",E);this._active=b,this._ident=0}};const $=new d.Params;$.addParam(0),u.DcsHandler=class{constructor(E){this._handler=E,this._data="",this._params=$,this._hitLimit=false}hook(E){this._params=E.length>1||E.params[0]?E.clone():$,this._data="",this._hitLimit=false}put(E,y,f){this._hitLimit||(this._data+=(0,c.utf32ToString)(E,y,f),this._data.length>_.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=true))}unhook(E){let y=false;if(this._hitLimit)y=false;else if(E&&(y=this._handler(this._data,this._params),y instanceof Promise))return y.then(f=>(this._params=$,this._data="",this._hitLimit=false,f));return this._params=$,this._data="",this._hitLimit=false,y}}},2015:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.EscapeSequenceParser=u.VT500_TRANSITION_TABLE=u.TransitionTable=void 0;const c=p(844),d=p(8742),_=p(6242),b=p(6351);class ${constructor(v){this.table=new Uint8Array(v)}setDefault(v,T){this.table.fill(v<<4|T)}add(v,T,S,R){this.table[T<<8|v]=S<<4|R}addMany(v,T,S,R){for(let O=0;O<v.length;O++)this.table[T<<8|v[O]]=S<<4|R}}u.TransitionTable=$;const E=160;u.VT500_TRANSITION_TABLE=function(){const f=new $(4095),v=Array.apply(null,Array(256)).map((L,I)=>I),T=(L,I)=>v.slice(L,I),S=T(32,127),R=T(0,24);R.push(25),R.push.apply(R,T(28,32));const O=T(0,14);let A;for(A in f.setDefault(1,0),f.addMany(S,0,2,0),O)f.addMany([24,26,153,154],A,3,0),f.addMany(T(128,144),A,3,0),f.addMany(T(144,152),A,3,0),f.add(156,A,0,0),f.add(27,A,11,1),f.add(157,A,4,8),f.addMany([152,158,159],A,0,7),f.add(155,A,11,3),f.add(144,A,11,9);return f.addMany(R,0,3,0),f.addMany(R,1,3,1),f.add(127,1,0,1),f.addMany(R,8,0,8),f.addMany(R,3,3,3),f.add(127,3,0,3),f.addMany(R,4,3,4),f.add(127,4,0,4),f.addMany(R,6,3,6),f.addMany(R,5,3,5),f.add(127,5,0,5),f.addMany(R,2,3,2),f.add(127,2,0,2),f.add(93,1,4,8),f.addMany(S,8,5,8),f.add(127,8,5,8),f.addMany([156,27,24,26,7],8,6,0),f.addMany(T(28,32),8,0,8),f.addMany([88,94,95],1,0,7),f.addMany(S,7,0,7),f.addMany(R,7,0,7),f.add(156,7,0,0),f.add(127,7,0,7),f.add(91,1,11,3),f.addMany(T(64,127),3,7,0),f.addMany(T(48,60),3,8,4),f.addMany([60,61,62,63],3,9,4),f.addMany(T(48,60),4,8,4),f.addMany(T(64,127),4,7,0),f.addMany([60,61,62,63],4,0,6),f.addMany(T(32,64),6,0,6),f.add(127,6,0,6),f.addMany(T(64,127),6,0,0),f.addMany(T(32,48),3,9,5),f.addMany(T(32,48),5,9,5),f.addMany(T(48,64),5,0,6),f.addMany(T(64,127),5,7,0),f.addMany(T(32,48),4,9,5),f.addMany(T(32,48),1,9,2),f.addMany(T(32,48),2,9,2),f.addMany(T(48,127),2,10,0),f.addMany(T(48,80),1,10,0),f.addMany(T(81,88),1,10,0),f.addMany([89,90,92],1,10,0),f.addMany(T(96,127),1,10,0),f.add(80,1,11,9),f.addMany(R,9,0,9),f.add(127,9,0,9),f.addMany(T(28,32),9,0,9),f.addMany(T(32,48),9,9,12),f.addMany(T(48,60),9,8,10),f.addMany([60,61,62,63],9,9,10),f.addMany(R,11,0,11),f.addMany(T(32,128),11,0,11),f.addMany(T(28,32),11,0,11),f.addMany(R,10,0,10),f.add(127,10,0,10),f.addMany(T(28,32),10,0,10),f.addMany(T(48,60),10,8,10),f.addMany([60,61,62,63],10,0,11),f.addMany(T(32,48),10,9,12),f.addMany(R,12,0,12),f.add(127,12,0,12),f.addMany(T(28,32),12,0,12),f.addMany(T(32,48),12,9,12),f.addMany(T(48,64),12,0,11),f.addMany(T(64,127),12,12,13),f.addMany(T(64,127),10,12,13),f.addMany(T(64,127),9,12,13),f.addMany(R,13,13,13),f.addMany(S,13,13,13),f.add(127,13,0,13),f.addMany([27,156,24,26],13,14,0),f.add(E,0,2,0),f.add(E,8,5,8),f.add(E,6,0,6),f.add(E,11,0,11),f.add(E,13,13,13),f}();class y extends c.Disposable{constructor(v=u.VT500_TRANSITION_TABLE){super(),this._transitions=v,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new d.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(T,S,R)=>{},this._executeHandlerFb=T=>{},this._csiHandlerFb=(T,S)=>{},this._escHandlerFb=T=>{},this._errorHandlerFb=T=>T,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new _.OscParser),this._dcsParser=this.register(new b.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>true)}_identifier(v,T=[64,126]){let S=0;if(v.prefix){if(v.prefix.length>1)throw new Error("only one byte as prefix supported");if(S=v.prefix.charCodeAt(0),S&&60>S||S>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(v.intermediates){if(v.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let O=0;O<v.intermediates.length;++O){const A=v.intermediates.charCodeAt(O);if(32>A||A>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");S<<=8,S|=A}}if(v.final.length!==1)throw new Error("final must be a single byte");const R=v.final.charCodeAt(0);if(T[0]>R||R>T[1])throw new Error(`final must be in range ${T[0]} .. ${T[1]}`);return S<<=8,S|=R,S}identToString(v){const T=[];for(;v;)T.push(String.fromCharCode(255&v)),v>>=8;return T.reverse().join("")}setPrintHandler(v){this._printHandler=v}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(v,T){const S=this._identifier(v,[48,126]);this._escHandlers[S]===void 0&&(this._escHandlers[S]=[]);const R=this._escHandlers[S];return R.push(T),{dispose:()=>{const O=R.indexOf(T);O!==-1&&R.splice(O,1)}}}clearEscHandler(v){this._escHandlers[this._identifier(v,[48,126])]&&delete this._escHandlers[this._identifier(v,[48,126])]}setEscHandlerFallback(v){this._escHandlerFb=v}setExecuteHandler(v,T){this._executeHandlers[v.charCodeAt(0)]=T}clearExecuteHandler(v){this._executeHandlers[v.charCodeAt(0)]&&delete this._executeHandlers[v.charCodeAt(0)]}setExecuteHandlerFallback(v){this._executeHandlerFb=v}registerCsiHandler(v,T){const S=this._identifier(v);this._csiHandlers[S]===void 0&&(this._csiHandlers[S]=[]);const R=this._csiHandlers[S];return R.push(T),{dispose:()=>{const O=R.indexOf(T);O!==-1&&R.splice(O,1)}}}clearCsiHandler(v){this._csiHandlers[this._identifier(v)]&&delete this._csiHandlers[this._identifier(v)]}setCsiHandlerFallback(v){this._csiHandlerFb=v}registerDcsHandler(v,T){return this._dcsParser.registerHandler(this._identifier(v),T)}clearDcsHandler(v){this._dcsParser.clearHandler(this._identifier(v))}setDcsHandlerFallback(v){this._dcsParser.setHandlerFallback(v)}registerOscHandler(v,T){return this._oscParser.registerHandler(v,T)}clearOscHandler(v){this._oscParser.clearHandler(v)}setOscHandlerFallback(v){this._oscParser.setHandlerFallback(v)}setErrorHandler(v){this._errorHandler=v}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(v,T,S,R,O){this._parseStack.state=v,this._parseStack.handlers=T,this._parseStack.handlerPos=S,this._parseStack.transition=R,this._parseStack.chunkPos=O}parse(v,T,S){let R,O=0,A=0,L=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,L=this._parseStack.chunkPos+1;else{if(S===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const I=this._parseStack.handlers;let k=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(S===false&&k>-1){for(;k>=0&&(R=I[k](this._params),R!==true);k--)if(R instanceof Promise)return this._parseStack.handlerPos=k,R}this._parseStack.handlers=[];break;case 4:if(S===false&&k>-1){for(;k>=0&&(R=I[k](),R!==true);k--)if(R instanceof Promise)return this._parseStack.handlerPos=k,R}this._parseStack.handlers=[];break;case 6:if(O=v[this._parseStack.chunkPos],R=this._dcsParser.unhook(O!==24&&O!==26,S),R)return R;O===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(O=v[this._parseStack.chunkPos],R=this._oscParser.end(O!==24&&O!==26,S),R)return R;O===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,L=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let I=L;I<T;++I){switch(O=v[I],A=this._transitions.table[this.currentState<<8|(O<160?O:E)],A>>4){case 2:for(let z=I+1;;++z){if(z>=T||(O=v[z])<32||O>126&&O<E){this._printHandler(v,I,z),I=z-1;break}if(++z>=T||(O=v[z])<32||O>126&&O<E){this._printHandler(v,I,z),I=z-1;break}if(++z>=T||(O=v[z])<32||O>126&&O<E){this._printHandler(v,I,z),I=z-1;break}if(++z>=T||(O=v[z])<32||O>126&&O<E){this._printHandler(v,I,z),I=z-1;break}}break;case 3:this._executeHandlers[O]?this._executeHandlers[O]():this._executeHandlerFb(O),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:I,code:O,currentState:this.currentState,collect:this._collect,params:this._params,abort:false}).abort)return;break;case 7:const k=this._csiHandlers[this._collect<<8|O];let B=k?k.length-1:-1;for(;B>=0&&(R=k[B](this._params),R!==true);B--)if(R instanceof Promise)return this._preserveStack(3,k,B,A,I),R;B<0&&this._csiHandlerFb(this._collect<<8|O,this._params),this.precedingCodepoint=0;break;case 8:do switch(O){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(O-48)}while(++I<T&&(O=v[I])>47&&O<60);I--;break;case 9:this._collect<<=8,this._collect|=O;break;case 10:const U=this._escHandlers[this._collect<<8|O];let P=U?U.length-1:-1;for(;P>=0&&(R=U[P](),R!==true);P--)if(R instanceof Promise)return this._preserveStack(4,U,P,A,I),R;P<0&&this._escHandlerFb(this._collect<<8|O),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|O,this._params);break;case 13:for(let z=I+1;;++z)if(z>=T||(O=v[z])===24||O===26||O===27||O>127&&O<E){this._dcsParser.put(v,I,z),I=z-1;break}break;case 14:if(R=this._dcsParser.unhook(O!==24&&O!==26),R)return this._preserveStack(6,[],0,A,I),R;O===27&&(A|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let z=I+1;;z++)if(z>=T||(O=v[z])<32||O>127&&O<E){this._oscParser.put(v,I,z),I=z-1;break}break;case 6:if(R=this._oscParser.end(O!==24&&O!==26),R)return this._preserveStack(5,[],0,A,I),R;O===27&&(A|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&A}}}u.EscapeSequenceParser=y},6242:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.OscHandler=u.OscParser=void 0;const c=p(5770),d=p(482),_=[];u.OscParser=class{constructor(){this._state=0,this._active=_,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:false,loopPosition:0,fallThrough:false}}registerHandler(b,$){this._handlers[b]===void 0&&(this._handlers[b]=[]);const E=this._handlers[b];return E.push($),{dispose:()=>{const y=E.indexOf($);y!==-1&&E.splice(y,1)}}}clearHandler(b){this._handlers[b]&&delete this._handlers[b]}setHandlerFallback(b){this._handlerFb=b}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=_}reset(){if(this._state===2)for(let b=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;b>=0;--b)this._active[b].end(false);this._stack.paused=false,this._active=_,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||_,this._active.length)for(let b=this._active.length-1;b>=0;b--)this._active[b].start();else this._handlerFb(this._id,"START")}_put(b,$,E){if(this._active.length)for(let y=this._active.length-1;y>=0;y--)this._active[y].put(b,$,E);else this._handlerFb(this._id,"PUT",(0,d.utf32ToString)(b,$,E))}start(){this.reset(),this._state=1}put(b,$,E){if(this._state!==3){if(this._state===1)for(;$<E;){const y=b[$++];if(y===59){this._state=2,this._start();break}if(y<48||57<y)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+y-48}this._state===2&&E-$>0&&this._put(b,$,E)}}end(b,$=true){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let E=false,y=this._active.length-1,f=false;if(this._stack.paused&&(y=this._stack.loopPosition-1,E=$,f=this._stack.fallThrough,this._stack.paused=false),!f&&E===false){for(;y>=0&&(E=this._active[y].end(b),E!==true);y--)if(E instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=y,this._stack.fallThrough=false,E;y--}for(;y>=0;y--)if(E=this._active[y].end(false),E instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=y,this._stack.fallThrough=true,E}else this._handlerFb(this._id,"END",b);this._active=_,this._id=-1,this._state=0}}},u.OscHandler=class{constructor(b){this._handler=b,this._data="",this._hitLimit=false}start(){this._data="",this._hitLimit=false}put(b,$,E){this._hitLimit||(this._data+=(0,d.utf32ToString)(b,$,E),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=true))}end(b){let $=false;if(this._hitLimit)$=false;else if(b&&($=this._handler(this._data),$ instanceof Promise))return $.then(E=>(this._data="",this._hitLimit=false,E));return this._data="",this._hitLimit=false,$}}},8742:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Params=void 0;const p=2147483647;class c{static fromArray(_){const b=new c;if(!_.length)return b;for(let $=Array.isArray(_[0])?1:0;$<_.length;++$){const E=_[$];if(Array.isArray(E))for(let y=0;y<E.length;++y)b.addSubParam(E[y]);else b.addParam(E)}return b}constructor(_=32,b=32){if(this.maxLength=_,this.maxSubParamsLength=b,b>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(_),this.length=0,this._subParams=new Int32Array(b),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(_),this._rejectDigits=false,this._rejectSubDigits=false,this._digitIsSub=false}clone(){const _=new c(this.maxLength,this.maxSubParamsLength);return _.params.set(this.params),_.length=this.length,_._subParams.set(this._subParams),_._subParamsLength=this._subParamsLength,_._subParamsIdx.set(this._subParamsIdx),_._rejectDigits=this._rejectDigits,_._rejectSubDigits=this._rejectSubDigits,_._digitIsSub=this._digitIsSub,_}toArray(){const _=[];for(let b=0;b<this.length;++b){_.push(this.params[b]);const $=this._subParamsIdx[b]>>8,E=255&this._subParamsIdx[b];E-$>0&&_.push(Array.prototype.slice.call(this._subParams,$,E))}return _}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=false,this._rejectSubDigits=false,this._digitIsSub=false}addParam(_){if(this._digitIsSub=false,this.length>=this.maxLength)this._rejectDigits=true;else{if(_<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=_>p?p:_}}addSubParam(_){if(this._digitIsSub=true,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=true;else{if(_<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=_>p?p:_,this._subParamsIdx[this.length-1]++}}hasSubParams(_){return(255&this._subParamsIdx[_])-(this._subParamsIdx[_]>>8)>0}getSubParams(_){const b=this._subParamsIdx[_]>>8,$=255&this._subParamsIdx[_];return $-b>0?this._subParams.subarray(b,$):null}getSubParamsAll(){const _={};for(let b=0;b<this.length;++b){const $=this._subParamsIdx[b]>>8,E=255&this._subParamsIdx[b];E-$>0&&(_[b]=this._subParams.slice($,E))}return _}addDigit(_){let b;if(this._rejectDigits||!(b=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const $=this._digitIsSub?this._subParams:this.params,E=$[b-1];$[b-1]=~E?Math.min(10*E+_,p):_}}u.Params=c},5741:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.AddonManager=void 0,u.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let p=this._addons.length-1;p>=0;p--)this._addons[p].instance.dispose()}loadAddon(p,c){const d={instance:c,dispose:c.dispose,isDisposed:false};this._addons.push(d),c.dispose=()=>this._wrappedAddonDispose(d),c.activate(p)}_wrappedAddonDispose(p){if(p.isDisposed)return;let c=-1;for(let d=0;d<this._addons.length;d++)if(this._addons[d]===p){c=d;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");p.isDisposed=true,p.dispose.apply(p.instance),this._addons.splice(c,1)}}},8771:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferApiView=void 0;const c=p(3785),d=p(511);u.BufferApiView=class{constructor(_,b){this._buffer=_,this.type=b}init(_){return this._buffer=_,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(_){const b=this._buffer.lines.get(_);if(b)return new c.BufferLineApiView(b)}getNullCell(){return new d.CellData}}},3785:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferLineApiView=void 0;const c=p(511);u.BufferLineApiView=class{constructor(d){this._line=d}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(d,_){if(!(d<0||d>=this._line.length))return _?(this._line.loadCell(d,_),_):this._line.loadCell(d,new c.CellData)}translateToString(d,_,b){return this._line.translateToString(d,_,b)}}},8285:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferNamespaceApi=void 0;const c=p(8771),d=p(8460),_=p(844);class b extends _.Disposable{constructor(E){super(),this._core=E,this._onBufferChange=this.register(new d.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}u.BufferNamespaceApi=b},7975:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ParserApi=void 0,u.ParserApi=class{constructor(p){this._core=p}registerCsiHandler(p,c){return this._core.registerCsiHandler(p,d=>c(d.toArray()))}addCsiHandler(p,c){return this.registerCsiHandler(p,c)}registerDcsHandler(p,c){return this._core.registerDcsHandler(p,(d,_)=>c(d,_.toArray()))}addDcsHandler(p,c){return this.registerDcsHandler(p,c)}registerEscHandler(p,c){return this._core.registerEscHandler(p,c)}addEscHandler(p,c){return this.registerEscHandler(p,c)}registerOscHandler(p,c){return this._core.registerOscHandler(p,c)}addOscHandler(p,c){return this.registerOscHandler(p,c)}}},7090:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.UnicodeApi=void 0,u.UnicodeApi=class{constructor(p){this._core=p}register(p){this._core.unicodeService.register(p)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(p){this._core.unicodeService.activeVersion=p}}},744:function(m,u,p){var c=this&&this.__decorate||function(f,v,T,S){var R,O=arguments.length,A=O<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,T):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(f,v,T,S);else for(var L=f.length-1;L>=0;L--)(R=f[L])&&(A=(O<3?R(A):O>3?R(v,T,A):R(v,T))||A);return O>3&&A&&Object.defineProperty(v,T,A),A},d=this&&this.__param||function(f,v){return function(T,S){v(T,S,f)}};Object.defineProperty(u,"__esModule",{value:true}),u.BufferService=u.MINIMUM_ROWS=u.MINIMUM_COLS=void 0;const _=p(8460),b=p(844),$=p(5295),E=p(2585);u.MINIMUM_COLS=2,u.MINIMUM_ROWS=1;let y=u.BufferService=class extends b.Disposable{get buffer(){return this.buffers.active}constructor(f){super(),this.isUserScrolling=false,this._onResize=this.register(new _.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new _.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(f.rawOptions.cols||0,u.MINIMUM_COLS),this.rows=Math.max(f.rawOptions.rows||0,u.MINIMUM_ROWS),this.buffers=this.register(new $.BufferSet(f,this))}resize(f,v){this.cols=f,this.rows=v,this.buffers.resize(f,v),this._onResize.fire({cols:f,rows:v})}reset(){this.buffers.reset(),this.isUserScrolling=false}scroll(f,v=false){const T=this.buffer;let S;S=this._cachedBlankLine,S&&S.length===this.cols&&S.getFg(0)===f.fg&&S.getBg(0)===f.bg||(S=T.getBlankLine(f,v),this._cachedBlankLine=S),S.isWrapped=v;const R=T.ybase+T.scrollTop,O=T.ybase+T.scrollBottom;if(T.scrollTop===0){const A=T.lines.isFull;O===T.lines.length-1?A?T.lines.recycle().copyFrom(S):T.lines.push(S.clone()):T.lines.splice(O+1,0,S.clone()),A?this.isUserScrolling&&(T.ydisp=Math.max(T.ydisp-1,0)):(T.ybase++,this.isUserScrolling||T.ydisp++)}else{const A=O-R+1;T.lines.shiftElements(R+1,A-1,-1),T.lines.set(O,S.clone())}this.isUserScrolling||(T.ydisp=T.ybase),this._onScroll.fire(T.ydisp)}scrollLines(f,v,T){const S=this.buffer;if(f<0){if(S.ydisp===0)return;this.isUserScrolling=true}else f+S.ydisp>=S.ybase&&(this.isUserScrolling=false);const R=S.ydisp;S.ydisp=Math.max(Math.min(S.ydisp+f,S.ybase),0),R!==S.ydisp&&(v||this._onScroll.fire(S.ydisp))}};u.BufferService=y=c([d(0,E.IOptionsService)],y)},7994:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CharsetService=void 0,u.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(p){this.glevel=p,this.charset=this._charsets[p]}setgCharset(p,c){this._charsets[p]=c,this.glevel===p&&(this.charset=c)}}},1753:function(m,u,p){var c=this&&this.__decorate||function(S,R,O,A){var L,I=arguments.length,k=I<3?R:A===null?A=Object.getOwnPropertyDescriptor(R,O):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(S,R,O,A);else for(var B=S.length-1;B>=0;B--)(L=S[B])&&(k=(I<3?L(k):I>3?L(R,O,k):L(R,O))||k);return I>3&&k&&Object.defineProperty(R,O,k),k},d=this&&this.__param||function(S,R){return function(O,A){R(O,A,S)}};Object.defineProperty(u,"__esModule",{value:true}),u.CoreMouseService=void 0;const _=p(2585),b=p(8460),$=p(844),E={NONE:{events:0,restrict:()=>false},X10:{events:1,restrict:S=>S.button!==4&&S.action===1&&(S.ctrl=false,S.alt=false,S.shift=false,true)},VT200:{events:19,restrict:S=>S.action!==32},DRAG:{events:23,restrict:S=>S.action!==32||S.button!==3},ANY:{events:31,restrict:S=>true}};function y(S,R){let O=(S.ctrl?16:0)|(S.shift?4:0)|(S.alt?8:0);return S.button===4?(O|=64,O|=S.action):(O|=3&S.button,4&S.button&&(O|=64),8&S.button&&(O|=128),S.action===32?O|=32:S.action!==0||R||(O|=3)),O}const f=String.fromCharCode,v={DEFAULT:S=>{const R=[y(S,false)+32,S.col+32,S.row+32];return R[0]>255||R[1]>255||R[2]>255?"":`\x1B[M${f(R[0])}${f(R[1])}${f(R[2])}`},SGR:S=>{const R=S.action===0&&S.button!==4?"m":"M";return`\x1B[<${y(S,true)};${S.col};${S.row}${R}`},SGR_PIXELS:S=>{const R=S.action===0&&S.button!==4?"m":"M";return`\x1B[<${y(S,true)};${S.x};${S.y}${R}`}};let T=u.CoreMouseService=class extends $.Disposable{constructor(S,R){super(),this._bufferService=S,this._coreService=R,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new b.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const O of Object.keys(E))this.addProtocol(O,E[O]);for(const O of Object.keys(v))this.addEncoding(O,v[O]);this.reset()}addProtocol(S,R){this._protocols[S]=R}addEncoding(S,R){this._encodings[S]=R}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(S){if(!this._protocols[S])throw new Error(`unknown protocol "${S}"`);this._activeProtocol=S,this._onProtocolChange.fire(this._protocols[S].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(S){if(!this._encodings[S])throw new Error(`unknown encoding "${S}"`);this._activeEncoding=S}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(S){if(S.col<0||S.col>=this._bufferService.cols||S.row<0||S.row>=this._bufferService.rows||S.button===4&&S.action===32||S.button===3&&S.action!==32||S.button!==4&&(S.action===2||S.action===3)||(S.col++,S.row++,S.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,S,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(S))return false;const R=this._encodings[this._activeEncoding](S);return R&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(R):this._coreService.triggerDataEvent(R,true)),this._lastEvent=S,true}explainEvents(S){return{down:!!(1&S),up:!!(2&S),drag:!!(4&S),move:!!(8&S),wheel:!!(16&S)}}_equalEvents(S,R,O){if(O){if(S.x!==R.x||S.y!==R.y)return false}else if(S.col!==R.col||S.row!==R.row)return false;return S.button===R.button&&S.action===R.action&&S.ctrl===R.ctrl&&S.alt===R.alt&&S.shift===R.shift}};u.CoreMouseService=T=c([d(0,_.IBufferService),d(1,_.ICoreService)],T)},6975:function(m,u,p){var c=this&&this.__decorate||function(T,S,R,O){var A,L=arguments.length,I=L<3?S:O===null?O=Object.getOwnPropertyDescriptor(S,R):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(T,S,R,O);else for(var k=T.length-1;k>=0;k--)(A=T[k])&&(I=(L<3?A(I):L>3?A(S,R,I):A(S,R))||I);return L>3&&I&&Object.defineProperty(S,R,I),I},d=this&&this.__param||function(T,S){return function(R,O){S(R,O,T)}};Object.defineProperty(u,"__esModule",{value:true}),u.CoreService=void 0;const _=p(1439),b=p(8460),$=p(844),E=p(2585),y=Object.freeze({insertMode:false}),f=Object.freeze({applicationCursorKeys:false,applicationKeypad:false,bracketedPasteMode:false,origin:false,reverseWraparound:false,sendFocus:false,wraparound:true});let v=u.CoreService=class extends $.Disposable{constructor(T,S,R){super(),this._bufferService=T,this._logService=S,this._optionsService=R,this.isCursorInitialized=false,this.isCursorHidden=false,this._onData=this.register(new b.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new b.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new b.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new b.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,_.clone)(y),this.decPrivateModes=(0,_.clone)(f)}reset(){this.modes=(0,_.clone)(y),this.decPrivateModes=(0,_.clone)(f)}triggerDataEvent(T,S=false){if(this._optionsService.rawOptions.disableStdin)return;const R=this._bufferService.buffer;S&&this._optionsService.rawOptions.scrollOnUserInput&&R.ybase!==R.ydisp&&this._onRequestScrollToBottom.fire(),S&&this._onUserInput.fire(),this._logService.debug(`sending data "${T}"`,()=>T.split("").map(O=>O.charCodeAt(0))),this._onData.fire(T)}triggerBinaryEvent(T){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${T}"`,()=>T.split("").map(S=>S.charCodeAt(0))),this._onBinary.fire(T))}};u.CoreService=v=c([d(0,E.IBufferService),d(1,E.ILogService),d(2,E.IOptionsService)],v)},9074:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DecorationService=void 0;const c=p(8055),d=p(8460),_=p(844),b=p(6106);let $=0,E=0;class y extends _.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new b.SortedList(T=>T==null?void 0:T.marker.line),this._onDecorationRegistered=this.register(new d.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new d.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,_.toDisposable)(()=>this.reset()))}registerDecoration(T){if(T.marker.isDisposed)return;const S=new f(T);if(S){const R=S.marker.onDispose(()=>S.dispose());S.onDispose(()=>{S&&(this._decorations.delete(S)&&this._onDecorationRemoved.fire(S),R.dispose())}),this._decorations.insert(S),this._onDecorationRegistered.fire(S)}return S}reset(){for(const T of this._decorations.values())T.dispose();this._decorations.clear()}*getDecorationsAtCell(T,S,R){var O,A,L;let I=0,k=0;for(const B of this._decorations.getKeyIterator(S))I=(O=B.options.x)!==null&&O!==void 0?O:0,k=I+((A=B.options.width)!==null&&A!==void 0?A:1),T>=I&&T<k&&(!R||((L=B.options.layer)!==null&&L!==void 0?L:"bottom")===R)&&(yield B)}forEachDecorationAtCell(T,S,R,O){this._decorations.forEachByKey(S,A=>{var L,I,k;$=(L=A.options.x)!==null&&L!==void 0?L:0,E=$+((I=A.options.width)!==null&&I!==void 0?I:1),T>=$&&T<E&&(!R||((k=A.options.layer)!==null&&k!==void 0?k:"bottom")===R)&&O(A)})}}u.DecorationService=y;class f extends _.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(T){super(),this.options=T,this.onRenderEmitter=this.register(new d.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new d.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=T.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.InstantiationService=u.ServiceCollection=void 0;const c=p(2585),d=p(8343);class _{constructor(...$){this._entries=new Map;for(const[E,y]of $)this.set(E,y)}set($,E){const y=this._entries.get($);return this._entries.set($,E),y}forEach($){for(const[E,y]of this._entries.entries())$(E,y)}has($){return this._entries.has($)}get($){return this._entries.get($)}}u.ServiceCollection=_,u.InstantiationService=class{constructor(){this._services=new _,this._services.set(c.IInstantiationService,this)}setService(b,$){this._services.set(b,$)}getService(b){return this._services.get(b)}createInstance(b,...$){const E=(0,d.getServiceDependencies)(b).sort((v,T)=>v.index-T.index),y=[];for(const v of E){const T=this._services.get(v.id);if(!T)throw new Error(`[createInstance] ${b.name} depends on UNKNOWN service ${v.id}.`);y.push(T)}const f=E.length>0?E[0].index:$.length;if($.length!==f)throw new Error(`[createInstance] First service dependency of ${b.name} at position ${f+1} conflicts with ${$.length} static arguments`);return new b(...$,...y)}}},7866:function(m,u,p){var c=this&&this.__decorate||function(f,v,T,S){var R,O=arguments.length,A=O<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,T):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(f,v,T,S);else for(var L=f.length-1;L>=0;L--)(R=f[L])&&(A=(O<3?R(A):O>3?R(v,T,A):R(v,T))||A);return O>3&&A&&Object.defineProperty(v,T,A),A},d=this&&this.__param||function(f,v){return function(T,S){v(T,S,f)}};Object.defineProperty(u,"__esModule",{value:true}),u.traceCall=u.setTraceLogger=u.LogService=void 0;const _=p(844),b=p(2585),$={trace:b.LogLevelEnum.TRACE,debug:b.LogLevelEnum.DEBUG,info:b.LogLevelEnum.INFO,warn:b.LogLevelEnum.WARN,error:b.LogLevelEnum.ERROR,off:b.LogLevelEnum.OFF};let E,y=u.LogService=class extends _.Disposable{get logLevel(){return this._logLevel}constructor(f){super(),this._optionsService=f,this._logLevel=b.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),E=this}_updateLogLevel(){this._logLevel=$[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(f){for(let v=0;v<f.length;v++)typeof f[v]=="function"&&(f[v]=f[v]())}_log(f,v,T){this._evalLazyOptionalParams(T),f.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+v,...T)}trace(f,...v){var T,S;this._logLevel<=b.LogLevelEnum.TRACE&&this._log((S=(T=this._optionsService.options.logger)===null||T===void 0?void 0:T.trace.bind(this._optionsService.options.logger))!==null&&S!==void 0?S:console.log,f,v)}debug(f,...v){var T,S;this._logLevel<=b.LogLevelEnum.DEBUG&&this._log((S=(T=this._optionsService.options.logger)===null||T===void 0?void 0:T.debug.bind(this._optionsService.options.logger))!==null&&S!==void 0?S:console.log,f,v)}info(f,...v){var T,S;this._logLevel<=b.LogLevelEnum.INFO&&this._log((S=(T=this._optionsService.options.logger)===null||T===void 0?void 0:T.info.bind(this._optionsService.options.logger))!==null&&S!==void 0?S:console.info,f,v)}warn(f,...v){var T,S;this._logLevel<=b.LogLevelEnum.WARN&&this._log((S=(T=this._optionsService.options.logger)===null||T===void 0?void 0:T.warn.bind(this._optionsService.options.logger))!==null&&S!==void 0?S:console.warn,f,v)}error(f,...v){var T,S;this._logLevel<=b.LogLevelEnum.ERROR&&this._log((S=(T=this._optionsService.options.logger)===null||T===void 0?void 0:T.error.bind(this._optionsService.options.logger))!==null&&S!==void 0?S:console.error,f,v)}};u.LogService=y=c([d(0,b.IOptionsService)],y),u.setTraceLogger=function(f){E=f},u.traceCall=function(f,v,T){if(typeof T.value!="function")throw new Error("not supported");const S=T.value;T.value=function(...R){if(E.logLevel!==b.LogLevelEnum.TRACE)return S.apply(this,R);E.trace(`GlyphRenderer#${S.name}(${R.map(A=>JSON.stringify(A)).join(", ")})`);const O=S.apply(this,R);return E.trace(`GlyphRenderer#${S.name} return`,O),O}}},7302:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.OptionsService=u.DEFAULT_OPTIONS=void 0;const c=p(8460),d=p(844),_=p(6114);u.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:false,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:true,drawBoldTextInBrightColors:true,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:false,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:true,scrollSensitivity:1,screenReaderMode:false,smoothScrollDuration:0,macOptionIsMeta:false,macOptionClickForcesSelection:false,minimumContrastRatio:1,disableStdin:false,allowProposedApi:false,allowTransparency:false,tabStopWidth:8,theme:{},rightClickSelectsWord:_.isMac,windowOptions:{},windowsMode:false,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:true,convertEol:false,termName:"xterm",cancelEvents:false,overviewRulerWidth:0};const b=["normal","bold","100","200","300","400","500","600","700","800","900"];class $ extends d.Disposable{constructor(y){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;const f=Object.assign({},u.DEFAULT_OPTIONS);for(const v in y)if(v in f)try{const T=y[v];f[v]=this._sanitizeAndValidateOption(v,T)}catch(T){console.error(T)}this.rawOptions=f,this.options=Object.assign({},f),this._setupOptions()}onSpecificOptionChange(y,f){return this.onOptionChange(v=>{v===y&&f(this.rawOptions[y])})}onMultipleOptionChange(y,f){return this.onOptionChange(v=>{y.indexOf(v)!==-1&&f()})}_setupOptions(){const y=v=>{if(!(v in u.DEFAULT_OPTIONS))throw new Error(`No option with key "${v}"`);return this.rawOptions[v]},f=(v,T)=>{if(!(v in u.DEFAULT_OPTIONS))throw new Error(`No option with key "${v}"`);T=this._sanitizeAndValidateOption(v,T),this.rawOptions[v]!==T&&(this.rawOptions[v]=T,this._onOptionChange.fire(v))};for(const v in this.rawOptions){const T={get:y.bind(this,v),set:f.bind(this,v)};Object.defineProperty(this.options,v,T)}}_sanitizeAndValidateOption(y,f){switch(y){case"cursorStyle":if(f||(f=u.DEFAULT_OPTIONS[y]),!function(v){return v==="block"||v==="underline"||v==="bar"}(f))throw new Error(`"${f}" is not a valid value for ${y}`);break;case"wordSeparator":f||(f=u.DEFAULT_OPTIONS[y]);break;case"fontWeight":case"fontWeightBold":if(typeof f=="number"&&1<=f&&f<=1e3)break;f=b.includes(f)?f:u.DEFAULT_OPTIONS[y];break;case"cursorWidth":f=Math.floor(f);case"lineHeight":case"tabStopWidth":if(f<1)throw new Error(`${y} cannot be less than 1, value: ${f}`);break;case"minimumContrastRatio":f=Math.max(1,Math.min(21,Math.round(10*f)/10));break;case"scrollback":if((f=Math.min(f,4294967295))<0)throw new Error(`${y} cannot be less than 0, value: ${f}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(f<=0)throw new Error(`${y} cannot be less than or equal to 0, value: ${f}`);break;case"rows":case"cols":if(!f&&f!==0)throw new Error(`${y} must be numeric, value: ${f}`);break;case"windowsPty":f=f??{}}return f}}u.OptionsService=$},2660:function(m,u,p){var c=this&&this.__decorate||function($,E,y,f){var v,T=arguments.length,S=T<3?E:f===null?f=Object.getOwnPropertyDescriptor(E,y):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate($,E,y,f);else for(var R=$.length-1;R>=0;R--)(v=$[R])&&(S=(T<3?v(S):T>3?v(E,y,S):v(E,y))||S);return T>3&&S&&Object.defineProperty(E,y,S),S},d=this&&this.__param||function($,E){return function(y,f){E(y,f,$)}};Object.defineProperty(u,"__esModule",{value:true}),u.OscLinkService=void 0;const _=p(2585);let b=u.OscLinkService=class{constructor($){this._bufferService=$,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink($){const E=this._bufferService.buffer;if($.id===void 0){const R=E.addMarker(E.ybase+E.y),O={data:$,id:this._nextId++,lines:[R]};return R.onDispose(()=>this._removeMarkerFromLink(O,R)),this._dataByLinkId.set(O.id,O),O.id}const y=$,f=this._getEntryIdKey(y),v=this._entriesWithId.get(f);if(v)return this.addLineToLink(v.id,E.ybase+E.y),v.id;const T=E.addMarker(E.ybase+E.y),S={id:this._nextId++,key:this._getEntryIdKey(y),data:y,lines:[T]};return T.onDispose(()=>this._removeMarkerFromLink(S,T)),this._entriesWithId.set(S.key,S),this._dataByLinkId.set(S.id,S),S.id}addLineToLink($,E){const y=this._dataByLinkId.get($);if(y&&y.lines.every(f=>f.line!==E)){const f=this._bufferService.buffer.addMarker(E);y.lines.push(f),f.onDispose(()=>this._removeMarkerFromLink(y,f))}}getLinkData($){var E;return(E=this._dataByLinkId.get($))===null||E===void 0?void 0:E.data}_getEntryIdKey($){return`${$.id};;${$.uri}`}_removeMarkerFromLink($,E){const y=$.lines.indexOf(E);y!==-1&&($.lines.splice(y,1),$.lines.length===0&&($.data.id!==void 0&&this._entriesWithId.delete($.key),this._dataByLinkId.delete($.id)))}};u.OscLinkService=b=c([d(0,_.IBufferService)],b)},8343:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.createDecorator=u.getServiceDependencies=u.serviceRegistry=void 0;const p="di$target",c="di$dependencies";u.serviceRegistry=new Map,u.getServiceDependencies=function(d){return d[c]||[]},u.createDecorator=function(d){if(u.serviceRegistry.has(d))return u.serviceRegistry.get(d);const _=function(b,$,E){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(y,f,v){f[p]===f?f[c].push({id:y,index:v}):(f[c]=[{id:y,index:v}],f[p]=f)})(_,b,E)};return _.toString=()=>d,u.serviceRegistry.set(d,_),_}},2585:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.IDecorationService=u.IUnicodeService=u.IOscLinkService=u.IOptionsService=u.ILogService=u.LogLevelEnum=u.IInstantiationService=u.ICharsetService=u.ICoreService=u.ICoreMouseService=u.IBufferService=void 0;const c=p(8343);var d;u.IBufferService=(0,c.createDecorator)("BufferService"),u.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),u.ICoreService=(0,c.createDecorator)("CoreService"),u.ICharsetService=(0,c.createDecorator)("CharsetService"),u.IInstantiationService=(0,c.createDecorator)("InstantiationService"),function(_){_[_.TRACE=0]="TRACE",_[_.DEBUG=1]="DEBUG",_[_.INFO=2]="INFO",_[_.WARN=3]="WARN",_[_.ERROR=4]="ERROR",_[_.OFF=5]="OFF"}(d||(u.LogLevelEnum=d={})),u.ILogService=(0,c.createDecorator)("LogService"),u.IOptionsService=(0,c.createDecorator)("OptionsService"),u.IOscLinkService=(0,c.createDecorator)("OscLinkService"),u.IUnicodeService=(0,c.createDecorator)("UnicodeService"),u.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(m,u,p)=>{Object.defineProperty(u,"__esModule",{value:true}),u.UnicodeService=void 0;const c=p(8460),d=p(225);u.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;const _=new d.UnicodeV6;this.register(_),this._active=_.version,this._activeProvider=_}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(_){if(!this._providers[_])throw new Error(`unknown Unicode version "${_}"`);this._active=_,this._activeProvider=this._providers[_],this._onChange.fire(_)}register(_){this._providers[_.version]=_}wcwidth(_){return this._activeProvider.wcwidth(_)}getStringCellWidth(_){let b=0;const $=_.length;for(let E=0;E<$;++E){let y=_.charCodeAt(E);if(55296<=y&&y<=56319){if(++E>=$)return b+this.wcwidth(y);const f=_.charCodeAt(E);56320<=f&&f<=57343?y=1024*(y-55296)+f-56320+65536:b+=this.wcwidth(f)}b+=this.wcwidth(y)}return b}}}},o={};function l(m){var u=o[m];if(u!==void 0)return u.exports;var p=o[m]={exports:{}};return i[m].call(p.exports,p,p.exports,l),p.exports}var g={};return(()=>{var m=g;Object.defineProperty(m,"__esModule",{value:true}),m.Terminal=void 0;const u=l(9042),p=l(3236),c=l(844),d=l(5741),_=l(8285),b=l(7975),$=l(7090),E=["cols","rows"];class y extends c.Disposable{constructor(v){super(),this._core=this.register(new p.Terminal(v)),this._addonManager=this.register(new d.AddonManager),this._publicOptions=Object.assign({},this._core.options);const T=R=>this._core.options[R],S=(R,O)=>{this._checkReadonlyOptions(R),this._core.options[R]=O};for(const R in this._core.options){const O={get:T.bind(this,R),set:S.bind(this,R)};Object.defineProperty(this._publicOptions,R,O)}}_checkReadonlyOptions(v){if(E.includes(v))throw new Error(`Option "${v}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new b.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new $.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new _.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const v=this._core.coreService.decPrivateModes;let T="none";switch(this._core.coreMouseService.activeProtocol){case"X10":T="x10";break;case"VT200":T="vt200";break;case"DRAG":T="drag";break;case"ANY":T="any"}return{applicationCursorKeysMode:v.applicationCursorKeys,applicationKeypadMode:v.applicationKeypad,bracketedPasteMode:v.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:T,originMode:v.origin,reverseWraparoundMode:v.reverseWraparound,sendFocusMode:v.sendFocus,wraparoundMode:v.wraparound}}get options(){return this._publicOptions}set options(v){for(const T in v)this._publicOptions[T]=v[T]}blur(){this._core.blur()}focus(){this._core.focus()}resize(v,T){this._verifyIntegers(v,T),this._core.resize(v,T)}open(v){this._core.open(v)}attachCustomKeyEventHandler(v){this._core.attachCustomKeyEventHandler(v)}registerLinkProvider(v){return this._core.registerLinkProvider(v)}registerCharacterJoiner(v){return this._checkProposedApi(),this._core.registerCharacterJoiner(v)}deregisterCharacterJoiner(v){this._checkProposedApi(),this._core.deregisterCharacterJoiner(v)}registerMarker(v=0){return this._verifyIntegers(v),this._core.registerMarker(v)}registerDecoration(v){var T,S,R;return this._checkProposedApi(),this._verifyPositiveIntegers((T=v.x)!==null&&T!==void 0?T:0,(S=v.width)!==null&&S!==void 0?S:0,(R=v.height)!==null&&R!==void 0?R:0),this._core.registerDecoration(v)}hasSelection(){return this._core.hasSelection()}select(v,T,S){this._verifyIntegers(v,T,S),this._core.select(v,T,S)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(v,T){this._verifyIntegers(v,T),this._core.selectLines(v,T)}dispose(){super.dispose()}scrollLines(v){this._verifyIntegers(v),this._core.scrollLines(v)}scrollPages(v){this._verifyIntegers(v),this._core.scrollPages(v)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(v){this._verifyIntegers(v),this._core.scrollToLine(v)}clear(){this._core.clear()}write(v,T){this._core.write(v,T)}writeln(v,T){this._core.write(v),this._core.write(`\r
`,T)}paste(v){this._core.paste(v)}refresh(v,T){this._verifyIntegers(v,T),this._core.refresh(v,T)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(v){this._addonManager.loadAddon(this,v)}static get strings(){return u}_verifyIntegers(...v){for(const T of v)if(T===1/0||isNaN(T)||T%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...v){for(const T of v)if(T&&(T===1/0||isNaN(T)||T%1!=0||T<0))throw new Error("This API only accepts positive integers")}}m.Terminal=y})(),g})())}(Sg)),Sg.exports}var UF=PF();const FF=Xe({__name:"build",props:["blocklyInformation","current"],setup(s,{expose:n}){const i=new UF.Terminal,o=Ee(null),l={log:(...g)=>{i.writeln(g.join(" "))},error:(...g)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;31m"+g.join(" ")+"\x1B[0m")},warn:(...g)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;33m"+g.join(" ")+"\x1B[0m")},success:(...g)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;32m"+g.join(" ")+"\x1B[0m")},info:(...g)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;32m"+g.join(" ")+"\x1B[0m")},clear:()=>{i.clear()}};return Ws(()=>{i.open(o.value),l.info('请点击左侧"编译插件"开始编译')}),n({logger:l}),(g,m)=>(oe(),be("div",{ref_key:"terminalRef",ref:o},null,512))}});var $g,I$;function ER(){if(I$)return $g;I$=1;function s(q){return q instanceof Map?q.clear=q.delete=q.set=function(){throw new Error("map is read-only")}:q instanceof Set&&(q.add=q.clear=q.delete=function(){throw new Error("set is read-only")}),Object.freeze(q),Object.getOwnPropertyNames(q).forEach(fe=>{const Ae=q[fe],Qe=typeof Ae;(Qe==="object"||Qe==="function")&&!Object.isFrozen(Ae)&&s(Ae)}),q}class n{constructor(fe){fe.data===void 0&&(fe.data={}),this.data=fe.data,this.isMatchIgnored=false}ignoreMatch(){this.isMatchIgnored=true}}function i(q){return q.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function o(q,...fe){const Ae=Object.create(null);for(const Qe in q)Ae[Qe]=q[Qe];return fe.forEach(function(Qe){for(const Ht in Qe)Ae[Ht]=Qe[Ht]}),Ae}const l="</span>",g=q=>!!q.scope,m=(q,{prefix:fe})=>{if(q.startsWith("language:"))return q.replace("language:","language-");if(q.includes(".")){const Ae=q.split(".");return[`${fe}${Ae.shift()}`,...Ae.map((Qe,Ht)=>`${Qe}${"_".repeat(Ht+1)}`)].join(" ")}return`${fe}${q}`};class u{constructor(fe,Ae){this.buffer="",this.classPrefix=Ae.classPrefix,fe.walk(this)}addText(fe){this.buffer+=i(fe)}openNode(fe){if(!g(fe))return;const Ae=m(fe.scope,{prefix:this.classPrefix});this.span(Ae)}closeNode(fe){g(fe)&&(this.buffer+=l)}value(){return this.buffer}span(fe){this.buffer+=`<span class="${fe}">`}}const p=(q={})=>{const fe={children:[]};return Object.assign(fe,q),fe};class c{constructor(){this.rootNode=p(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(fe){this.top.children.push(fe)}openNode(fe){const Ae=p({scope:fe});this.add(Ae),this.stack.push(Ae)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(fe){return this.constructor._walk(fe,this.rootNode)}static _walk(fe,Ae){return typeof Ae=="string"?fe.addText(Ae):Ae.children&&(fe.openNode(Ae),Ae.children.forEach(Qe=>this._walk(fe,Qe)),fe.closeNode(Ae)),fe}static _collapse(fe){typeof fe!="string"&&fe.children&&(fe.children.every(Ae=>typeof Ae=="string")?fe.children=[fe.children.join("")]:fe.children.forEach(Ae=>{c._collapse(Ae)}))}}class d extends c{constructor(fe){super(),this.options=fe}addText(fe){fe!==""&&this.add(fe)}startScope(fe){this.openNode(fe)}endScope(){this.closeNode()}__addSublanguage(fe,Ae){const Qe=fe.root;Ae&&(Qe.scope=`language:${Ae}`),this.add(Qe)}toHTML(){return new u(this,this.options).value()}finalize(){return this.closeAllNodes(),true}}function _(q){return q?typeof q=="string"?q:q.source:null}function b(q){return y("(?=",q,")")}function $(q){return y("(?:",q,")*")}function E(q){return y("(?:",q,")?")}function y(...q){return q.map(Ae=>_(Ae)).join("")}function f(q){const fe=q[q.length-1];return typeof fe=="object"&&fe.constructor===Object?(q.splice(q.length-1,1),fe):{}}function v(...q){return"("+(f(q).capture?"":"?:")+q.map(Qe=>_(Qe)).join("|")+")"}function T(q){return new RegExp(q.toString()+"|").exec("").length-1}function S(q,fe){const Ae=q&&q.exec(fe);return Ae&&Ae.index===0}const R=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function O(q,{joinWith:fe}){let Ae=0;return q.map(Qe=>{Ae+=1;const Ht=Ae;let Ot=_(Qe),Ue="";for(;Ot.length>0;){const Be=R.exec(Ot);if(!Be){Ue+=Ot;break}Ue+=Ot.substring(0,Be.index),Ot=Ot.substring(Be.index+Be[0].length),Be[0][0]==="\\"&&Be[1]?Ue+="\\"+String(Number(Be[1])+Ht):(Ue+=Be[0],Be[0]==="("&&Ae++)}return Ue}).map(Qe=>`(${Qe})`).join(fe)}const A=/\b\B/,L="[a-zA-Z]\\w*",I="[a-zA-Z_]\\w*",k="\\b\\d+(\\.\\d+)?",B="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",U="\\b(0b[01]+)",P="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",z=(q={})=>{const fe=/^#![ ]*\//;return q.binary&&(q.begin=y(fe,/.*\b/,q.binary,/\b.*/)),o({scope:"meta",begin:fe,end:/$/,relevance:0,"on:begin":(Ae,Qe)=>{Ae.index!==0&&Qe.ignoreMatch()}},q)},W={begin:"\\\\[\\s\\S]",relevance:0},j={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[W]},K={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[W]},ee={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},M=function(q,fe,Ae={}){const Qe=o({scope:"comment",begin:q,end:fe,contains:[]},Ae);Qe.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:true,relevance:0});const Ht=v("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return Qe.contains.push({begin:y(/[ ]+/,"(",Ht,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),Qe},F=M("//","$"),V=M("/\\*","\\*/"),X=M("#","$"),H={scope:"number",begin:k,relevance:0},ne={scope:"number",begin:B,relevance:0},Ie={scope:"number",begin:U,relevance:0},de={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[W,{begin:/\[/,end:/\]/,relevance:0,contains:[W]}]},ot={scope:"title",begin:L,relevance:0},x={scope:"title",begin:I,relevance:0},te={begin:"\\.\\s*"+I,relevance:0};var ae=Object.freeze({__proto__:null,APOS_STRING_MODE:j,BACKSLASH_ESCAPE:W,BINARY_NUMBER_MODE:Ie,BINARY_NUMBER_RE:U,COMMENT:M,C_BLOCK_COMMENT_MODE:V,C_LINE_COMMENT_MODE:F,C_NUMBER_MODE:ne,C_NUMBER_RE:B,END_SAME_AS_BEGIN:function(q){return Object.assign(q,{"on:begin":(fe,Ae)=>{Ae.data._beginMatch=fe[1]},"on:end":(fe,Ae)=>{Ae.data._beginMatch!==fe[1]&&Ae.ignoreMatch()}})},HASH_COMMENT_MODE:X,IDENT_RE:L,MATCH_NOTHING_RE:A,METHOD_GUARD:te,NUMBER_MODE:H,NUMBER_RE:k,PHRASAL_WORDS_MODE:ee,QUOTE_STRING_MODE:K,REGEXP_MODE:de,RE_STARTERS_RE:P,SHEBANG:z,TITLE_MODE:ot,UNDERSCORE_IDENT_RE:I,UNDERSCORE_TITLE_MODE:x});function De(q,fe){q.input[q.index-1]==="."&&fe.ignoreMatch()}function $e(q,fe){q.className!==void 0&&(q.scope=q.className,delete q.className)}function st(q,fe){fe&&q.beginKeywords&&(q.begin="\\b("+q.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",q.__beforeBegin=De,q.keywords=q.keywords||q.beginKeywords,delete q.beginKeywords,q.relevance===void 0&&(q.relevance=0))}function bt(q,fe){Array.isArray(q.illegal)&&(q.illegal=v(...q.illegal))}function Ut(q,fe){if(q.match){if(q.begin||q.end)throw new Error("begin & end are not supported with match");q.begin=q.match,delete q.match}}function jt(q,fe){q.relevance===void 0&&(q.relevance=1)}const Ve=(q,fe)=>{if(!q.beforeMatch)return;if(q.starts)throw new Error("beforeMatch cannot be used with starts");const Ae=Object.assign({},q);Object.keys(q).forEach(Qe=>{delete q[Qe]}),q.keywords=Ae.keywords,q.begin=y(Ae.beforeMatch,b(Ae.begin)),q.starts={relevance:0,contains:[Object.assign(Ae,{endsParent:true})]},q.relevance=0,delete Ae.beforeMatch},Ss=["of","and","for","in","not","or","if","then","parent","list","value"],Cs="keyword";function Os(q,fe,Ae=Cs){const Qe=Object.create(null);return typeof q=="string"?Ht(Ae,q.split(" ")):Array.isArray(q)?Ht(Ae,q):Object.keys(q).forEach(function(Ot){Object.assign(Qe,Os(q[Ot],fe,Ot))}),Qe;function Ht(Ot,Ue){fe&&(Ue=Ue.map(Be=>Be.toLowerCase())),Ue.forEach(function(Be){const ye=Be.split("|");Qe[ye[0]]=[Ot,zs(ye[0],ye[1])]})}}function zs(q,fe){return fe?Number(fe):xs(q)?0:1}function xs(q){return Ss.includes(q.toLowerCase())}const kt={},ts=q=>{console.error(q)},me=(q,...fe)=>{console.log(`WARN: ${q}`,...fe)},He=(q,fe)=>{kt[`${q}/${fe}`]||(console.log(`Deprecated as of ${q}. ${fe}`),kt[`${q}/${fe}`]=true)},Dt=new Error;function ve(q,fe,{key:Ae}){let Qe=0;const Ht=q[Ae],Ot={},Ue={};for(let Be=1;Be<=fe.length;Be++)Ue[Be+Qe]=Ht[Be],Ot[Be+Qe]=true,Qe+=T(fe[Be-1]);q[Ae]=Ue,q[Ae]._emit=Ot,q[Ae]._multi=true}function Bs(q){if(Array.isArray(q.begin)){if(q.skip||q.excludeBegin||q.returnBegin)throw ts("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),Dt;if(typeof q.beginScope!="object"||q.beginScope===null)throw ts("beginScope must be object"),Dt;ve(q,q.begin,{key:"beginScope"}),q.begin=O(q.begin,{joinWith:""})}}function vs(q){if(Array.isArray(q.end)){if(q.skip||q.excludeEnd||q.returnEnd)throw ts("skip, excludeEnd, returnEnd not compatible with endScope: {}"),Dt;if(typeof q.endScope!="object"||q.endScope===null)throw ts("endScope must be object"),Dt;ve(q,q.end,{key:"endScope"}),q.end=O(q.end,{joinWith:""})}}function ks(q){q.scope&&typeof q.scope=="object"&&q.scope!==null&&(q.beginScope=q.scope,delete q.scope)}function Rt(q){ks(q),typeof q.beginScope=="string"&&(q.beginScope={_wrap:q.beginScope}),typeof q.endScope=="string"&&(q.endScope={_wrap:q.endScope}),Bs(q),vs(q)}function Li(q){function fe(Ue,Be){return new RegExp(_(Ue),"m"+(q.case_insensitive?"i":"")+(q.unicodeRegex?"u":"")+(Be?"g":""))}class Ae{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(Be,ye){ye.position=this.position++,this.matchIndexes[this.matchAt]=ye,this.regexes.push([ye,Be]),this.matchAt+=T(Be)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const Be=this.regexes.map(ye=>ye[1]);this.matcherRe=fe(O(Be,{joinWith:"|"}),true),this.lastIndex=0}exec(Be){this.matcherRe.lastIndex=this.lastIndex;const ye=this.matcherRe.exec(Be);if(!ye)return null;const fs=ye.findIndex((ir,Eo)=>Eo>0&&ir!==void 0),Vt=this.matchIndexes[fs];return ye.splice(0,fs),Object.assign(ye,Vt)}}class Qe{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(Be){if(this.multiRegexes[Be])return this.multiRegexes[Be];const ye=new Ae;return this.rules.slice(Be).forEach(([fs,Vt])=>ye.addRule(fs,Vt)),ye.compile(),this.multiRegexes[Be]=ye,ye}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(Be,ye){this.rules.push([Be,ye]),ye.type==="begin"&&this.count++}exec(Be){const ye=this.getMatcher(this.regexIndex);ye.lastIndex=this.lastIndex;let fs=ye.exec(Be);if(this.resumingScanAtSamePosition()&&!(fs&&fs.index===this.lastIndex)){const Vt=this.getMatcher(0);Vt.lastIndex=this.lastIndex+1,fs=Vt.exec(Be)}return fs&&(this.regexIndex+=fs.position+1,this.regexIndex===this.count&&this.considerAll()),fs}}function Ht(Ue){const Be=new Qe;return Ue.contains.forEach(ye=>Be.addRule(ye.begin,{rule:ye,type:"begin"})),Ue.terminatorEnd&&Be.addRule(Ue.terminatorEnd,{type:"end"}),Ue.illegal&&Be.addRule(Ue.illegal,{type:"illegal"}),Be}function Ot(Ue,Be){const ye=Ue;if(Ue.isCompiled)return ye;[$e,Ut,Rt,Ve].forEach(Vt=>Vt(Ue,Be)),q.compilerExtensions.forEach(Vt=>Vt(Ue,Be)),Ue.__beforeBegin=null,[st,bt,jt].forEach(Vt=>Vt(Ue,Be)),Ue.isCompiled=true;let fs=null;return typeof Ue.keywords=="object"&&Ue.keywords.$pattern&&(Ue.keywords=Object.assign({},Ue.keywords),fs=Ue.keywords.$pattern,delete Ue.keywords.$pattern),fs=fs||/\w+/,Ue.keywords&&(Ue.keywords=Os(Ue.keywords,q.case_insensitive)),ye.keywordPatternRe=fe(fs,true),Be&&(Ue.begin||(Ue.begin=/\B|\b/),ye.beginRe=fe(ye.begin),!Ue.end&&!Ue.endsWithParent&&(Ue.end=/\B|\b/),Ue.end&&(ye.endRe=fe(ye.end)),ye.terminatorEnd=_(ye.end)||"",Ue.endsWithParent&&Be.terminatorEnd&&(ye.terminatorEnd+=(Ue.end?"|":"")+Be.terminatorEnd)),Ue.illegal&&(ye.illegalRe=fe(Ue.illegal)),Ue.contains||(Ue.contains=[]),Ue.contains=[].concat(...Ue.contains.map(function(Vt){return N(Vt==="self"?Ue:Vt)})),Ue.contains.forEach(function(Vt){Ot(Vt,ye)}),Ue.starts&&Ot(Ue.starts,Be),ye.matcher=Ht(ye),ye}if(q.compilerExtensions||(q.compilerExtensions=[]),q.contains&&q.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return q.classNameAliases=o(q.classNameAliases||{}),Ot(q)}function as(q){return q?q.endsWithParent||as(q.starts):false}function N(q){return q.variants&&!q.cachedVariants&&(q.cachedVariants=q.variants.map(function(fe){return o(q,{variants:null},fe)})),q.cachedVariants?q.cachedVariants:as(q)?o(q,{starts:q.starts?o(q.starts):null}):Object.isFrozen(q)?o(q):q}var G="11.10.0";class J extends Error{constructor(fe,Ae){super(fe),this.name="HTMLInjectionError",this.html=Ae}}const ie=i,le=o,at=Symbol("nomatch"),Xi=7,ka=function(q){const fe=Object.create(null),Ae=Object.create(null),Qe=[];let Ht=true;const Ot="Could not find the language '{}', did you forget to load/include a language module?",Ue={disableAutodetect:true,name:"Plain text",contains:[]};let Be={ignoreUnescapedHTML:false,throwUnescapedHTML:false,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:d};function ye(Re){return Be.noHighlightRe.test(Re)}function fs(Re){let Ke=Re.className+" ";Ke+=Re.parentNode?Re.parentNode.className:"";const Te=Be.languageDetectRe.exec(Ke);if(Te){const Nt=Ni(Te[1]);return Nt||(me(Ot.replace("{}",Te[1])),me("Falling back to no-highlight mode for this block.",Re)),Nt?Te[1]:"no-highlight"}return Ke.split(/\s+/).find(Nt=>ye(Nt)||Ni(Nt))}function Vt(Re,Ke,Te){let Nt="",cs="";typeof Ke=="object"?(Nt=Re,Te=Ke.ignoreIllegals,cs=Ke.language):(He("10.7.0","highlight(lang, code, ...args) has been deprecated."),He("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),cs=Re,Nt=Ke),Te===void 0&&(Te=true);const gi={code:Nt,language:cs};To("before:highlight",gi);const _n=gi.result?gi.result:ir(gi.language,gi.code,Te);return _n.code=gi.code,To("after:highlight",_n),_n}function ir(Re,Ke,Te,Nt){const cs=Object.create(null);function gi(we,Fe){return we.keywords[Fe]}function _n(){if(!nt.keywords){us.addText(wt);return}let we=0;nt.keywordPatternRe.lastIndex=0;let Fe=nt.keywordPatternRe.exec(wt),lt="";for(;Fe;){lt+=wt.substring(we,Fe.index);const At=Mi.case_insensitive?Fe[0].toLowerCase():Fe[0],ms=gi(nt,At);if(ms){const[hs,bc]=ms;if(us.addText(lt),lt="",cs[At]=(cs[At]||0)+1,cs[At]<=Xi&&(Nr+=bc),hs.startsWith("_"))lt+=Fe[0];else{const mi=Mi.classNameAliases[hs]||hs;fi(Fe[0],mi)}}else lt+=Fe[0];we=nt.keywordPatternRe.lastIndex,Fe=nt.keywordPatternRe.exec(wt)}lt+=wt.substring(we),us.addText(lt)}function _t(){if(wt==="")return;let we=null;if(typeof nt.subLanguage=="string"){if(!fe[nt.subLanguage]){us.addText(wt);return}we=ir(nt.subLanguage,wt,true,vc[nt.subLanguage]),vc[nt.subLanguage]=we._top}else we=dn(wt,nt.subLanguage.length?nt.subLanguage:null);nt.relevance>0&&(Nr+=we.relevance),us.__addSublanguage(we._emitter,we.language)}function ss(){nt.subLanguage!=null?_t():_n(),wt=""}function fi(we,Fe){we!==""&&(us.startScope(Fe),us.addText(we),us.endScope())}function wa(we,Fe){let lt=1;const At=Fe.length-1;for(;lt<=At;){if(!we._emit[lt]){lt++;continue}const ms=Mi.classNameAliases[we[lt]]||we[lt],hs=Fe[lt];ms?fi(hs,ms):(wt=hs,_n(),wt=""),lt++}}function Lr(we,Fe){return we.scope&&typeof we.scope=="string"&&us.openNode(Mi.classNameAliases[we.scope]||we.scope),we.beginScope&&(we.beginScope._wrap?(fi(wt,Mi.classNameAliases[we.beginScope._wrap]||we.beginScope._wrap),wt=""):we.beginScope._multi&&(wa(we.beginScope,Fe),wt="")),nt=Object.create(we,{parent:{value:nt}}),nt}function Ec(we,Fe,lt){let At=S(we.endRe,lt);if(At){if(we["on:end"]){const ms=new n(we);we["on:end"](Fe,ms),ms.isMatchIgnored&&(At=false)}if(At){for(;we.endsParent&&we.parent;)we=we.parent;return we}}if(we.endsWithParent)return Ec(we.parent,Fe,lt)}function Aa(we){return nt.matcher.regexIndex===0?(wt+=we[0],1):(Io=true,0)}function kh(we){const Fe=we[0],lt=we.rule,At=new n(lt),ms=[lt.__beforeBegin,lt["on:begin"]];for(const hs of ms)if(hs&&(hs(we,At),At.isMatchIgnored))return Aa(Fe);return lt.skip?wt+=Fe:(lt.excludeBegin&&(wt+=Fe),ss(),!lt.returnBegin&&!lt.excludeBegin&&(wt=Fe)),Lr(lt,we),lt.returnBegin?0:Fe.length}function wh(we){const Fe=we[0],lt=Ke.substring(we.index),At=Ec(nt,we,lt);if(!At)return at;const ms=nt;nt.endScope&&nt.endScope._wrap?(ss(),fi(Fe,nt.endScope._wrap)):nt.endScope&&nt.endScope._multi?(ss(),wa(nt.endScope,we)):ms.skip?wt+=Fe:(ms.returnEnd||ms.excludeEnd||(wt+=Fe),ss(),ms.excludeEnd&&(wt=Fe));do nt.scope&&us.closeNode(),!nt.skip&&!nt.subLanguage&&(Nr+=nt.relevance),nt=nt.parent;while(nt!==At.parent);return At.starts&&Lr(At.starts,we),ms.returnEnd?0:Fe.length}function La(){const we=[];for(let Fe=nt;Fe!==Mi;Fe=Fe.parent)Fe.scope&&we.unshift(Fe.scope);we.forEach(Fe=>us.openNode(Fe))}let $o={};function yo(we,Fe){const lt=Fe&&Fe[0];if(wt+=we,lt==null)return ss(),0;if($o.type==="begin"&&Fe.type==="end"&&$o.index===Fe.index&&lt===""){if(wt+=Ke.slice(Fe.index,Fe.index+1),!Ht){const At=new Error(`0 width match regex (${Re})`);throw At.languageName=Re,At.badRule=$o.rule,At}return 1}if($o=Fe,Fe.type==="begin")return kh(Fe);if(Fe.type==="illegal"&&!Te){const At=new Error('Illegal lexeme "'+lt+'" for mode "'+(nt.scope||"<unnamed>")+'"');throw At.mode=nt,At}else if(Fe.type==="end"){const At=wh(Fe);if(At!==at)return At}if(Fe.type==="illegal"&&lt==="")return 1;if(Ma>1e5&&Ma>Fe.index*3)throw new Error("potential infinite loop, way more iterations than matches");return wt+=lt,lt.length}const Mi=Ni(Re);if(!Mi)throw ts(Ot.replace("{}",Re)),new Error('Unknown language: "'+Re+'"');const Na=Li(Mi);let Ro="",nt=Nt||Na;const vc={},us=new Be.__emitter(Be);La();let wt="",Nr=0,Ki=0,Ma=0,Io=false;try{if(Mi.__emitTokens)Mi.__emitTokens(Ke,us);else{for(nt.matcher.considerAll();;){Ma++,Io?Io=false:nt.matcher.considerAll(),nt.matcher.lastIndex=Ki;const we=nt.matcher.exec(Ke);if(!we)break;const Fe=Ke.substring(Ki,we.index),lt=yo(Fe,we);Ki=we.index+lt}yo(Ke.substring(Ki))}return us.finalize(),Ro=us.toHTML(),{language:Re,value:Ro,relevance:Nr,illegal:false,_emitter:us,_top:nt}}catch(we){if(we.message&&we.message.includes("Illegal"))return{language:Re,value:ie(Ke),illegal:true,relevance:0,_illegalBy:{message:we.message,index:Ki,context:Ke.slice(Ki-100,Ki+100),mode:we.mode,resultSoFar:Ro},_emitter:us};if(Ht)return{language:Re,value:ie(Ke),illegal:false,relevance:0,errorRaised:we,_emitter:us,_top:nt};throw we}}function Eo(Re){const Ke={value:ie(Re),illegal:false,relevance:0,_top:Ue,_emitter:new Be.__emitter(Be)};return Ke._emitter.addText(Re),Ke}function dn(Re,Ke){Ke=Ke||Be.languages||Object.keys(fe);const Te=Eo(Re),Nt=Ke.filter(Ni).filter(Zt).map(ss=>ir(ss,Re,false));Nt.unshift(Te);const cs=Nt.sort((ss,fi)=>{if(ss.relevance!==fi.relevance)return fi.relevance-ss.relevance;if(ss.language&&fi.language){if(Ni(ss.language).supersetOf===fi.language)return 1;if(Ni(fi.language).supersetOf===ss.language)return-1}return 0}),[gi,_n]=cs,_t=gi;return _t.secondBest=_n,_t}function vo(Re,Ke,Te){const Nt=Ke&&Ae[Ke]||Te;Re.classList.add("hljs"),Re.classList.add(`language-${Nt}`)}function wr(Re){let Ke=null;const Te=fs(Re);if(ye(Te))return;if(To("before:highlightElement",{el:Re,language:Te}),Re.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",Re);return}if(Re.children.length>0&&(Be.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(Re)),Be.throwUnescapedHTML))throw new J("One of your code blocks includes unescaped HTML.",Re.innerHTML);Ke=Re;const Nt=Ke.textContent,cs=Te?Vt(Nt,{language:Te,ignoreIllegals:true}):dn(Nt);Re.innerHTML=cs.value,Re.dataset.highlighted="yes",vo(Re,Te,cs.language),Re.result={language:cs.language,re:cs.relevance,relevance:cs.relevance},cs.secondBest&&(Re.secondBest={language:cs.secondBest.language,relevance:cs.secondBest.relevance}),To("after:highlightElement",{el:Re,result:cs,text:Nt})}function si(Re){Be=le(Be,Re)}const Ar=()=>{Us(),He("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function pi(){Us(),He("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let Ps=false;function Us(){if(document.readyState==="loading"){Ps=true;return}document.querySelectorAll(Be.cssSelector).forEach(wr)}function Pe(){Ps&&Us()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",Pe,false);function Oh(Re,Ke){let Te=null;try{Te=Ke(q)}catch(Nt){if(ts("Language definition for '{}' could not be registered.".replace("{}",Re)),Ht)ts(Nt);else throw Nt;Te=Ue}Te.name||(Te.name=Re),fe[Re]=Te,Te.rawDefinition=Ke.bind(null,q),Te.aliases&&Jt(Te.aliases,{languageName:Re})}function mc(Re){delete fe[Re];for(const Ke of Object.keys(Ae))Ae[Ke]===Re&&delete Ae[Ke]}function bo(){return Object.keys(fe)}function Ni(Re){return Re=(Re||"").toLowerCase(),fe[Re]||fe[Ae[Re]]}function Jt(Re,{languageName:Ke}){typeof Re=="string"&&(Re=[Re]),Re.forEach(Te=>{Ae[Te.toLowerCase()]=Ke})}function Zt(Re){const Ke=Ni(Re);return Ke&&!Ke.disableAutodetect}function ls(Re){Re["before:highlightBlock"]&&!Re["before:highlightElement"]&&(Re["before:highlightElement"]=Ke=>{Re["before:highlightBlock"](Object.assign({block:Ke.el},Ke))}),Re["after:highlightBlock"]&&!Re["after:highlightElement"]&&(Re["after:highlightElement"]=Ke=>{Re["after:highlightBlock"](Object.assign({block:Ke.el},Ke))})}function Ft(Re){ls(Re),Qe.push(Re)}function We(Re){const Ke=Qe.indexOf(Re);Ke!==-1&&Qe.splice(Ke,1)}function To(Re,Ke){const Te=Re;Qe.forEach(function(Nt){Nt[Te]&&Nt[Te](Ke)})}function So(Re){return He("10.7.0","highlightBlock will be removed entirely in v12.0"),He("10.7.0","Please use highlightElement now."),wr(Re)}Object.assign(q,{highlight:Vt,highlightAuto:dn,highlightAll:Us,highlightElement:wr,highlightBlock:So,configure:si,initHighlighting:Ar,initHighlightingOnLoad:pi,registerLanguage:Oh,unregisterLanguage:mc,listLanguages:bo,getLanguage:Ni,registerAliases:Jt,autoDetection:Zt,inherit:le,addPlugin:Ft,removePlugin:We}),q.debugMode=function(){Ht=false},q.safeMode=function(){Ht=true},q.versionString=G,q.regex={concat:y,lookahead:b,either:v,optional:E,anyNumberOfTimes:$};for(const Re in ae)typeof ae[Re]=="object"&&s(ae[Re]);return Object.assign(q,ae),q},Ln=ka({});return Ln.newInstance=()=>ka({}),$g=Ln,Ln.HighlightJS=Ln,Ln.default=Ln,$g}var yg,C$;function GF(){if(C$)return yg;C$=1;function s(n){const i=n.regex,o=i.concat(/[\p{L}_]/u,i.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),l=/[\p{L}0-9._:-]+/u,g={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},m={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},u=n.inherit(m,{begin:/\(/,end:/\)/}),p=n.inherit(n.APOS_STRING_MODE,{className:"string"}),c=n.inherit(n.QUOTE_STRING_MODE,{className:"string"}),d={endsWithParent:true,illegal:/</,relevance:0,contains:[{className:"attr",begin:l,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:true,variants:[{begin:/"/,end:/"/,contains:[g]},{begin:/'/,end:/'/,contains:[g]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:true,unicodeRegex:true,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[m,c,p,u,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[m,u,c,p]}]}]},n.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},g,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[c]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[d],starts:{end:/<\/style>/,returnEnd:true,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[d],starts:{end:/<\/script>/,returnEnd:true,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:i.concat(/</,i.lookahead(i.concat(o,i.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:o,relevance:0,starts:d}]},{className:"tag",begin:i.concat(/<\//,i.lookahead(i.concat(o,/>/))),contains:[{className:"name",begin:o,relevance:0},{begin:/>/,relevance:0,endsParent:true}]}]}}return yg=s,yg}var Rg,O$;function HF(){if(O$)return Rg;O$=1;function s(n){const i=n.regex,o={},l={begin:/\$\{/,end:/\}/,contains:["self",{begin:/:-/,contains:[o]}]};Object.assign(o,{className:"variable",variants:[{begin:i.concat(/\$[\w\d#@][\w\d_]*/,"(?![\\w\\d])(?![$])")},l]});const g={className:"subst",begin:/\$\(/,end:/\)/,contains:[n.BACKSLASH_ESCAPE]},m=n.inherit(n.COMMENT(),{match:[/(^|\s)/,/#.*$/],scope:{2:"comment"}}),u={begin:/<<-?\s*(?=\w+)/,starts:{contains:[n.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,className:"string"})]}},p={className:"string",begin:/"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,o,g]};g.contains.push(p);const c={match:/\\"/},d={className:"string",begin:/'/,end:/'/},_={match:/\\'/},b={begin:/\$?\(\(/,end:/\)\)/,contains:[{begin:/\d+#[0-9a-f]+/,className:"number"},n.NUMBER_MODE,o]},$=["fish","bash","zsh","sh","csh","ksh","tcsh","dash","scsh"],E=n.SHEBANG({binary:`(${$.join("|")})`,relevance:10}),y={className:"function",begin:/\w[\w\d_]*\s*\(\s*\)\s*\{/,returnBegin:true,contains:[n.inherit(n.TITLE_MODE,{begin:/\w[\w\d_]*/})],relevance:0},f=["if","then","else","elif","fi","for","while","until","in","do","done","case","esac","function","select"],v=["true","false"],T={match:/(\/[a-z._-]+)+/},S=["break","cd","continue","eval","exec","exit","export","getopts","hash","pwd","readonly","return","shift","test","times","trap","umask","unset"],R=["alias","bind","builtin","caller","command","declare","echo","enable","help","let","local","logout","mapfile","printf","read","readarray","source","sudo","type","typeset","ulimit","unalias"],O=["autoload","bg","bindkey","bye","cap","chdir","clone","comparguments","compcall","compctl","compdescribe","compfiles","compgroups","compquote","comptags","comptry","compvalues","dirs","disable","disown","echotc","echoti","emulate","fc","fg","float","functions","getcap","getln","history","integer","jobs","kill","limit","log","noglob","popd","print","pushd","pushln","rehash","sched","setcap","setopt","stat","suspend","ttyctl","unfunction","unhash","unlimit","unsetopt","vared","wait","whence","where","which","zcompile","zformat","zftp","zle","zmodload","zparseopts","zprof","zpty","zregexparse","zsocket","zstyle","ztcp"],A=["chcon","chgrp","chown","chmod","cp","dd","df","dir","dircolors","ln","ls","mkdir","mkfifo","mknod","mktemp","mv","realpath","rm","rmdir","shred","sync","touch","truncate","vdir","b2sum","base32","base64","cat","cksum","comm","csplit","cut","expand","fmt","fold","head","join","md5sum","nl","numfmt","od","paste","ptx","pr","sha1sum","sha224sum","sha256sum","sha384sum","sha512sum","shuf","sort","split","sum","tac","tail","tr","tsort","unexpand","uniq","wc","arch","basename","chroot","date","dirname","du","echo","env","expr","factor","groups","hostid","id","link","logname","nice","nohup","nproc","pathchk","pinky","printenv","printf","pwd","readlink","runcon","seq","sleep","stat","stdbuf","stty","tee","test","timeout","tty","uname","unlink","uptime","users","who","whoami","yes"];return{name:"Bash",aliases:["sh","zsh"],keywords:{$pattern:/\b[a-z][a-z0-9._-]+\b/,keyword:f,literal:v,built_in:[...S,...R,"set","shopt",...O,...A]},contains:[E,n.SHEBANG(),y,b,m,u,T,p,c,d,_,o]}}return Rg=s,Rg}var Ig,k$;function VF(){if(k$)return Ig;k$=1;function s(n){const i=n.regex,o=n.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),l="decltype\\(auto\\)",g="[a-zA-Z_]\\w*::",m="<[^<>]+>",u="("+l+"|"+i.optional(g)+"[a-zA-Z_]\\w*"+i.optional(m)+")",p={className:"type",variants:[{begin:"\\b[a-z\\d_]*_t\\b"},{match:/\batomic_[a-z]{3,6}\b/}]},c="\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)",d={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[n.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+c+"|.)",end:"'",illegal:"."},n.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},_={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)((ll|LL|l|L)(u|U)?|(u|U)(ll|LL|l|L)?|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},b={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef elifdef elifndef include"},contains:[{begin:/\\\n/,relevance:0},n.inherit(d,{className:"string"}),{className:"string",begin:/<.*?>/},o,n.C_BLOCK_COMMENT_MODE]},$={className:"title",begin:i.optional(g)+n.IDENT_RE,relevance:0},E=i.optional(g)+n.IDENT_RE+"\\s*\\(",v={keyword:["asm","auto","break","case","continue","default","do","else","enum","extern","for","fortran","goto","if","inline","register","restrict","return","sizeof","typeof","typeof_unqual","struct","switch","typedef","union","volatile","while","_Alignas","_Alignof","_Atomic","_Generic","_Noreturn","_Static_assert","_Thread_local","alignas","alignof","noreturn","static_assert","thread_local","_Pragma"],type:["float","double","signed","unsigned","int","short","long","char","void","_Bool","_BitInt","_Complex","_Imaginary","_Decimal32","_Decimal64","_Decimal96","_Decimal128","_Decimal64x","_Decimal128x","_Float16","_Float32","_Float64","_Float128","_Float32x","_Float64x","_Float128x","const","static","constexpr","complex","bool","imaginary"],literal:"true false NULL",built_in:"std string wstring cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set pair bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap priority_queue make_pair array shared_ptr abort terminate abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf future isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf endl initializer_list unique_ptr"},T=[b,p,o,n.C_BLOCK_COMMENT_MODE,_,d],S={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:v,contains:T.concat([{begin:/\(/,end:/\)/,keywords:v,contains:T.concat(["self"]),relevance:0}]),relevance:0},R={begin:"("+u+"[\\*&\\s]+)+"+E,returnBegin:true,end:/[{;=]/,excludeEnd:true,keywords:v,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:l,keywords:v,relevance:0},{begin:E,returnBegin:true,contains:[n.inherit($,{className:"title.function"})],relevance:0},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:v,relevance:0,contains:[o,n.C_BLOCK_COMMENT_MODE,d,_,p,{begin:/\(/,end:/\)/,keywords:v,relevance:0,contains:["self",o,n.C_BLOCK_COMMENT_MODE,d,_,p]}]},p,o,n.C_BLOCK_COMMENT_MODE,b]};return{name:"C",aliases:["h"],keywords:v,disableAutodetect:true,illegal:"</",contains:[].concat(S,R,T,[b,{begin:n.IDENT_RE+"::",keywords:v},{className:"class",beginKeywords:"enum class struct union",end:/[{;:<>=]/,contains:[{beginKeywords:"final class struct"},n.TITLE_MODE]}]),exports:{preprocessor:b,strings:d,keywords:v}}}return Ig=s,Ig}var Cg,w$;function WF(){if(w$)return Cg;w$=1;function s(n){const i=n.regex,o=n.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),l="decltype\\(auto\\)",g="[a-zA-Z_]\\w*::",m="<[^<>]+>",u="(?!struct)("+l+"|"+i.optional(g)+"[a-zA-Z_]\\w*"+i.optional(m)+")",p={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},c="\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)",d={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[n.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+c+"|.)",end:"'",illegal:"."},n.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},_={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},b={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},n.inherit(d,{className:"string"}),{className:"string",begin:/<.*?>/},o,n.C_BLOCK_COMMENT_MODE]},$={className:"title",begin:i.optional(g)+n.IDENT_RE,relevance:0},E=i.optional(g)+n.IDENT_RE+"\\s*\\(",y=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],f=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],v=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],T=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],O={type:f,keyword:y,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:v},A={className:"function.dispatch",relevance:0,keywords:{_hint:T},begin:i.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,n.IDENT_RE,i.lookahead(/(<[^<>]+>|)\s*\(/))},L=[A,b,p,o,n.C_BLOCK_COMMENT_MODE,_,d],I={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:O,contains:L.concat([{begin:/\(/,end:/\)/,keywords:O,contains:L.concat(["self"]),relevance:0}]),relevance:0},k={className:"function",begin:"("+u+"[\\*&\\s]+)+"+E,returnBegin:true,end:/[{;=]/,excludeEnd:true,keywords:O,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:l,keywords:O,relevance:0},{begin:E,returnBegin:true,contains:[$],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:true,contains:[d,_]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:O,relevance:0,contains:[o,n.C_BLOCK_COMMENT_MODE,d,_,p,{begin:/\(/,end:/\)/,keywords:O,relevance:0,contains:["self",o,n.C_BLOCK_COMMENT_MODE,d,_,p]}]},p,o,n.C_BLOCK_COMMENT_MODE,b]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:O,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(I,k,A,L,[b,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function)\\s*<(?!<)",end:">",keywords:O,contains:["self",p]},{begin:n.IDENT_RE+"::",keywords:O},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}return Cg=s,Cg}var Og,A$;function zF(){if(A$)return Og;A$=1;function s(n){const i=["bool","byte","char","decimal","delegate","double","dynamic","enum","float","int","long","nint","nuint","object","sbyte","short","string","ulong","uint","ushort"],o=["public","private","protected","static","internal","protected","abstract","async","extern","override","unsafe","virtual","new","sealed","partial"],l=["default","false","null","true"],g=["abstract","as","base","break","case","catch","class","const","continue","do","else","event","explicit","extern","finally","fixed","for","foreach","goto","if","implicit","in","interface","internal","is","lock","namespace","new","operator","out","override","params","private","protected","public","readonly","record","ref","return","scoped","sealed","sizeof","stackalloc","static","struct","switch","this","throw","try","typeof","unchecked","unsafe","using","virtual","void","volatile","while"],m=["add","alias","and","ascending","async","await","by","descending","equals","from","get","global","group","init","into","join","let","nameof","not","notnull","on","or","orderby","partial","remove","select","set","unmanaged","value|0","var","when","where","with","yield"],u={keyword:g.concat(m),built_in:i,literal:l},p=n.inherit(n.TITLE_MODE,{begin:"[a-zA-Z](\\.?\\w)*"}),c={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)(u|U|l|L|ul|UL|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},d={className:"string",begin:/"""("*)(?!")(.|\n)*?"""\1/,relevance:1},_={className:"string",begin:'@"',end:'"',contains:[{begin:'""'}]},b=n.inherit(_,{illegal:/\n/}),$={className:"subst",begin:/\{/,end:/\}/,keywords:u},E=n.inherit($,{illegal:/\n/}),y={className:"string",begin:/\$"/,end:'"',illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},n.BACKSLASH_ESCAPE,E]},f={className:"string",begin:/\$@"/,end:'"',contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},$]},v=n.inherit(f,{illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},E]});$.contains=[f,y,_,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE,c,n.C_BLOCK_COMMENT_MODE],E.contains=[v,y,b,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE,c,n.inherit(n.C_BLOCK_COMMENT_MODE,{illegal:/\n/})];const T={variants:[d,f,y,_,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE]},S={begin:"<",end:">",contains:[{beginKeywords:"in out"},p]},R=n.IDENT_RE+"(<"+n.IDENT_RE+"(\\s*,\\s*"+n.IDENT_RE+")*>)?(\\[\\])?",O={begin:"@"+n.IDENT_RE,relevance:0};return{name:"C#",aliases:["cs","c#"],keywords:u,illegal:/::/,contains:[n.COMMENT("///","$",{returnBegin:true,contains:[{className:"doctag",variants:[{begin:"///",relevance:0},{begin:"<!--|-->"},{begin:"</?",end:">"}]}]}),n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE,{className:"meta",begin:"#",end:"$",keywords:{keyword:"if else elif endif define undef warning error line region endregion pragma checksum"}},T,c,{beginKeywords:"class interface",relevance:0,end:/[{;=]/,illegal:/[^\s:,]/,contains:[{beginKeywords:"where class"},p,S,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{beginKeywords:"namespace",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[p,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{beginKeywords:"record",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[p,S,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{className:"meta",begin:"^\\s*\\[(?=[\\w])",excludeBegin:true,end:"\\]",excludeEnd:true,contains:[{className:"string",begin:/"/,end:/"/}]},{beginKeywords:"new return throw await else",relevance:0},{className:"function",begin:"("+R+"\\s+)+"+n.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:true,end:/\s*[{;=]/,excludeEnd:true,keywords:u,contains:[{beginKeywords:o.join(" "),relevance:0},{begin:n.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:true,contains:[n.TITLE_MODE,S],relevance:0},{match:/\(\)/},{className:"params",begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:u,relevance:0,contains:[T,c,n.C_BLOCK_COMMENT_MODE]},n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},O]}}return Og=s,Og}var kg,L$;function jF(){if(L$)return kg;L$=1;const s=c=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:c.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[c.APOS_STRING_MODE,c.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:c.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),n=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],i=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],o=[...n,...i],l=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),g=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),m=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),u=["accent-color","align-content","align-items","align-self","alignment-baseline","all","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-end-end-radius","border-end-start-radius","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","cx","cy","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","content-visibility","counter-increment","counter-reset","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","empty-cells","enable-background","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flow","flood-color","flood-opacity","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-smoothing","font-stretch","font-style","font-synthesis","font-variant","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","inline-size","inset","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","kerning","justify-content","justify-items","justify-self","left","letter-spacing","lighting-color","line-break","line-height","list-style","list-style-image","list-style-position","list-style-type","marker","marker-end","marker-mid","marker-start","mask","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","perspective","perspective-origin","pointer-events","position","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","scale","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","speak","speak-as","src","tab-size","table-layout","text-anchor","text-align","text-align-all","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-transform","text-underline-offset","text-underline-position","top","transform","transform-box","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","vector-effect","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index"].sort().reverse();function p(c){const d=c.regex,_=s(c),b={begin:/-(webkit|moz|ms|o)-(?=[a-z])/},$="and or not only",E=/@-?\w[\w]*(-\w+)*/,y="[a-zA-Z-][a-zA-Z0-9_-]*",f=[c.APOS_STRING_MODE,c.QUOTE_STRING_MODE];return{name:"CSS",case_insensitive:true,illegal:/[=|'\$]/,keywords:{keyframePosition:"from to"},classNameAliases:{keyframePosition:"selector-tag"},contains:[_.BLOCK_COMMENT,b,_.CSS_NUMBER_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/,relevance:0},{className:"selector-class",begin:"\\."+y,relevance:0},_.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",variants:[{begin:":("+g.join("|")+")"},{begin:":(:)?("+m.join("|")+")"}]},_.CSS_VARIABLE,{className:"attribute",begin:"\\b("+u.join("|")+")\\b"},{begin:/:/,end:/[;}{]/,contains:[_.BLOCK_COMMENT,_.HEXCOLOR,_.IMPORTANT,_.CSS_NUMBER_MODE,...f,{begin:/(url|data-uri)\(/,end:/\)/,relevance:0,keywords:{built_in:"url data-uri"},contains:[...f,{className:"string",begin:/[^)]/,endsWithParent:true,excludeEnd:true}]},_.FUNCTION_DISPATCH]},{begin:d.lookahead(/@/),end:"[{;]",relevance:0,illegal:/:/,contains:[{className:"keyword",begin:E},{begin:/\s/,endsWithParent:true,excludeEnd:true,relevance:0,keywords:{$pattern:/[a-z-]+/,keyword:$,attribute:l.join(" ")},contains:[{begin:/[a-z-]+(?=:)/,className:"attribute"},...f,_.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"\\b("+o.join("|")+")\\b"}]}}return kg=p,kg}var wg,N$;function XF(){if(N$)return wg;N$=1;function s(n){const i=n.regex,o={begin:/<\/?[A-Za-z_]/,end:">",subLanguage:"xml",relevance:0},l={begin:"^[-\\*]{3,}",end:"$"},g={className:"code",variants:[{begin:"(`{3,})[^`](.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})[^~](.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},m={className:"bullet",begin:"^[ 	]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:true},u={begin:/^\[[^\n]+\]:/,returnBegin:true,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:true,excludeEnd:true},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:true}]},p=/[A-Za-z][A-Za-z0-9+.-]*/,c={variants:[{begin:/\[.+?\]\[.*?\]/,relevance:0},{begin:/\[.+?\]\(((data|javascript|mailto):|(?:http|ftp)s?:\/\/).*?\)/,relevance:2},{begin:i.concat(/\[.+?\]\(/,p,/:\/\/.*?\)/),relevance:2},{begin:/\[.+?\]\([./?&#].*?\)/,relevance:1},{begin:/\[.*?\]\(.*?\)/,relevance:0}],returnBegin:true,contains:[{match:/\[(?=\])/},{className:"string",relevance:0,begin:"\\[",end:"\\]",excludeBegin:true,returnEnd:true},{className:"link",relevance:0,begin:"\\]\\(",end:"\\)",excludeBegin:true,excludeEnd:true},{className:"symbol",relevance:0,begin:"\\]\\[",end:"\\]",excludeBegin:true,excludeEnd:true}]},d={className:"strong",contains:[],variants:[{begin:/_{2}(?!\s)/,end:/_{2}/},{begin:/\*{2}(?!\s)/,end:/\*{2}/}]},_={className:"emphasis",contains:[],variants:[{begin:/\*(?![*\s])/,end:/\*/},{begin:/_(?![_\s])/,end:/_/,relevance:0}]},b=n.inherit(d,{contains:[]}),$=n.inherit(_,{contains:[]});d.contains.push($),_.contains.push(b);let E=[o,c];return[d,_,b,$].forEach(T=>{T.contains=T.contains.concat(E)}),E=E.concat(d,_),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:E},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:E}]}]},o,m,d,_,{className:"quote",begin:"^>\\s+",contains:E,end:"$"},g,l,c,u,{scope:"literal",match:/&([a-zA-Z0-9]+|#[0-9]{1,7}|#[Xx][0-9a-fA-F]{1,6});/}]}}return wg=s,wg}var Ag,M$;function KF(){if(M$)return Ag;M$=1;function s(n){const i=n.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:i.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:i.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}return Ag=s,Ag}var Lg,D$;function YF(){if(D$)return Lg;D$=1;function s(n){const i=n.regex,o="([a-zA-Z_]\\w*[!?=]?|[-+~]@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?)",l=i.either(/\b([A-Z]+[a-z0-9]+)+/,/\b([A-Z]+[a-z0-9]+)+[A-Z]+/),g=i.concat(l,/(::\w+)*/),u={"variable.constant":["__FILE__","__LINE__","__ENCODING__"],"variable.language":["self","super"],keyword:["alias","and","begin","BEGIN","break","case","class","defined","do","else","elsif","end","END","ensure","for","if","in","module","next","not","or","redo","require","rescue","retry","return","then","undef","unless","until","when","while","yield",...["include","extend","prepend","public","private","protected","raise","throw"]],built_in:["proc","lambda","attr_accessor","attr_reader","attr_writer","define_method","private_constant","module_function"],literal:["true","false","nil"]},p={className:"doctag",begin:"@[A-Za-z]+"},c={begin:"#<",end:">"},d=[n.COMMENT("#","$",{contains:[p]}),n.COMMENT("^=begin","^=end",{contains:[p],relevance:10}),n.COMMENT("^__END__",n.MATCH_NOTHING_RE)],_={className:"subst",begin:/#\{/,end:/\}/,keywords:u},b={className:"string",contains:[n.BACKSLASH_ESCAPE,_],variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/`/,end:/`/},{begin:/%[qQwWx]?\(/,end:/\)/},{begin:/%[qQwWx]?\[/,end:/\]/},{begin:/%[qQwWx]?\{/,end:/\}/},{begin:/%[qQwWx]?</,end:/>/},{begin:/%[qQwWx]?\//,end:/\//},{begin:/%[qQwWx]?%/,end:/%/},{begin:/%[qQwWx]?-/,end:/-/},{begin:/%[qQwWx]?\|/,end:/\|/},{begin:/\B\?(\\\d{1,3})/},{begin:/\B\?(\\x[A-Fa-f0-9]{1,2})/},{begin:/\B\?(\\u\{?[A-Fa-f0-9]{1,6}\}?)/},{begin:/\B\?(\\M-\\C-|\\M-\\c|\\c\\M-|\\M-|\\C-\\M-)[\x20-\x7e]/},{begin:/\B\?\\(c|C-)[\x20-\x7e]/},{begin:/\B\?\\?\S/},{begin:i.concat(/<<[-~]?'?/,i.lookahead(/(\w+)(?=\W)[^\n]*\n(?:[^\n]*\n)*?\s*\1\b/)),contains:[n.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,contains:[n.BACKSLASH_ESCAPE,_]})]}]},$="[1-9](_?[0-9])*|0",E="[0-9](_?[0-9])*",y={className:"number",relevance:0,variants:[{begin:`\\b(${$})(\\.(${E}))?([eE][+-]?(${E})|r)?i?\\b`},{begin:"\\b0[dD][0-9](_?[0-9])*r?i?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*r?i?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*r?i?\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*r?i?\\b"},{begin:"\\b0(_?[0-7])+r?i?\\b"}]},f={variants:[{match:/\(\)/},{className:"params",begin:/\(/,end:/(?=\))/,excludeBegin:true,endsParent:true,keywords:u}]},L=[b,{variants:[{match:[/class\s+/,g,/\s+<\s+/,g]},{match:[/\b(class|module)\s+/,g]}],scope:{2:"title.class",4:"title.class.inherited"},keywords:u},{match:[/(include|extend)\s+/,g],scope:{2:"title.class"},keywords:u},{relevance:0,match:[g,/\.new[. (]/],scope:{1:"title.class"}},{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},{relevance:0,match:l,scope:"title.class"},{match:[/def/,/\s+/,o],scope:{1:"keyword",3:"title.function"},contains:[f]},{begin:n.IDENT_RE+"::"},{className:"symbol",begin:n.UNDERSCORE_IDENT_RE+"(!|\\?)?:",relevance:0},{className:"symbol",begin:":(?!\\s)",contains:[b,{begin:o}],relevance:0},y,{className:"variable",begin:"(\\$\\W)|((\\$|@@?)(\\w+))(?=[^@$?])(?![A-Za-z])(?![@$?'])"},{className:"params",begin:/\|/,end:/\|/,excludeBegin:true,excludeEnd:true,relevance:0,keywords:u},{begin:"("+n.RE_STARTERS_RE+"|unless)\\s*",keywords:"unless",contains:[{className:"regexp",contains:[n.BACKSLASH_ESCAPE,_],illegal:/\n/,variants:[{begin:"/",end:"/[a-z]*"},{begin:/%r\{/,end:/\}[a-z]*/},{begin:"%r\\(",end:"\\)[a-z]*"},{begin:"%r!",end:"![a-z]*"},{begin:"%r\\[",end:"\\][a-z]*"}]}].concat(c,d),relevance:0}].concat(c,d);_.contains=L,f.contains=L;const I="[>?]>",k="[\\w#]+\\(\\w+\\):\\d+:\\d+[>*]",B="(\\w+-)?\\d+\\.\\d+\\.\\d+(p\\d+)?[^\\d][^>]+>",U=[{begin:/^\s*=>/,starts:{end:"$",contains:L}},{className:"meta.prompt",begin:"^("+I+"|"+k+"|"+B+")(?=[ ])",starts:{end:"$",keywords:u,contains:L}}];return d.unshift(c),{name:"Ruby",aliases:["rb","gemspec","podspec","thor","irb"],keywords:u,illegal:/\/\*/,contains:[n.SHEBANG({binary:"ruby"})].concat(U).concat(d).concat(L)}}return Lg=s,Lg}var Ng,x$;function qF(){if(x$)return Ng;x$=1;function s(n){const m={keyword:["break","case","chan","const","continue","default","defer","else","fallthrough","for","func","go","goto","if","import","interface","map","package","range","return","select","struct","switch","type","var"],type:["bool","byte","complex64","complex128","error","float32","float64","int8","int16","int32","int64","string","uint8","uint16","uint32","uint64","int","uint","uintptr","rune"],literal:["true","false","iota","nil"],built_in:["append","cap","close","complex","copy","imag","len","make","new","panic","print","println","real","recover","delete"]};return{name:"Go",aliases:["golang"],keywords:m,illegal:"</",contains:[n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE,{className:"string",variants:[n.QUOTE_STRING_MODE,n.APOS_STRING_MODE,{begin:"`",end:"`"}]},{className:"number",variants:[{match:/-?\b0[xX]\.[a-fA-F0-9](_?[a-fA-F0-9])*[pP][+-]?\d(_?\d)*i?/,relevance:0},{match:/-?\b0[xX](_?[a-fA-F0-9])+((\.([a-fA-F0-9](_?[a-fA-F0-9])*)?)?[pP][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b0[oO](_?[0-7])*i?/,relevance:0},{match:/-?\.\d(_?\d)*([eE][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b\d(_?\d)*(\.(\d(_?\d)*)?)?([eE][+-]?\d(_?\d)*)?i?/,relevance:0}]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:true,contains:[n.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,endsParent:true,keywords:m,illegal:/["']/}]}]}}return Ng=s,Ng}var Mg,B$;function JF(){if(B$)return Mg;B$=1;function s(n){const i=n.regex,o=/[_A-Za-z][_0-9A-Za-z]*/;return{name:"GraphQL",aliases:["gql"],case_insensitive:true,disableAutodetect:false,keywords:{keyword:["query","mutation","subscription","type","input","schema","directive","interface","union","scalar","fragment","enum","on"],literal:["true","false","null"]},contains:[n.HASH_COMMENT_MODE,n.QUOTE_STRING_MODE,n.NUMBER_MODE,{scope:"punctuation",match:/[.]{3}/,relevance:0},{scope:"punctuation",begin:/[\!\(\)\:\=\[\]\{\|\}]{1}/,relevance:0},{scope:"variable",begin:/\$/,end:/\W/,excludeEnd:true,relevance:0},{scope:"meta",match:/@\w+/,excludeEnd:true},{scope:"symbol",begin:i.concat(o,i.lookahead(/\s*:/)),relevance:0}],illegal:[/[;<']/,/BEGIN/]}}return Mg=s,Mg}var Dg,P$;function ZF(){if(P$)return Dg;P$=1;function s(n){const i=n.regex,o={className:"number",relevance:0,variants:[{begin:/([+-]+)?[\d]+_[\d_]+/},{begin:n.NUMBER_RE}]},l=n.COMMENT();l.variants=[{begin:/;/,end:/$/},{begin:/#/,end:/$/}];const g={className:"variable",variants:[{begin:/\$[\w\d"][\w\d_]*/},{begin:/\$\{(.*?)\}/}]},m={className:"literal",begin:/\bon|off|true|false|yes|no\b/},u={className:"string",contains:[n.BACKSLASH_ESCAPE],variants:[{begin:"'''",end:"'''",relevance:10},{begin:'"""',end:'"""',relevance:10},{begin:'"',end:'"'},{begin:"'",end:"'"}]},p={begin:/\[/,end:/\]/,contains:[l,m,g,u,o,"self"],relevance:0},c=/[A-Za-z0-9_-]+/,d=/"(\\"|[^"])*"/,_=/'[^']*'/,b=i.either(c,d,_),$=i.concat(b,"(\\s*\\.\\s*",b,")*",i.lookahead(/\s*=\s*[^#\s]/));return{name:"TOML, also INI",aliases:["toml"],case_insensitive:true,illegal:/\S/,contains:[l,{className:"section",begin:/\[+/,end:/\]+/},{begin:$,className:"attr",starts:{end:/$/,contains:[l,p,m,g,u,o]}}]}}return Dg=s,Dg}var xg,U$;function QF(){if(U$)return xg;U$=1;var s="[0-9](_*[0-9])*",n=`\\.(${s})`,i="[0-9a-fA-F](_*[0-9a-fA-F])*",o={className:"number",variants:[{begin:`(\\b(${s})((${n})|\\.)?|(${n}))[eE][+-]?(${s})[fFdD]?\\b`},{begin:`\\b(${s})((${n})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${n})[fFdD]?\\b`},{begin:`\\b(${s})[fFdD]\\b`},{begin:`\\b0[xX]((${i})\\.?|(${i})?\\.(${i}))[pP][+-]?(${s})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${i})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function l(m,u,p){return p===-1?"":m.replace(u,c=>l(m,u,p-1))}function g(m){const u=m.regex,p="[À-ʸa-zA-Z_$][À-ʸa-zA-Z_$0-9]*",c=p+l("(?:<"+p+"~~~(?:\\s*,\\s*"+p+"~~~)*>)?",/~~~/g,2),E={keyword:["synchronized","abstract","private","var","static","if","const ","for","while","strictfp","finally","protected","import","native","final","void","enum","else","break","transient","catch","instanceof","volatile","case","assert","package","default","public","try","switch","continue","throws","protected","public","private","module","requires","exports","do","sealed","yield","permits","goto"],literal:["false","true","null"],type:["char","boolean","long","float","int","byte","short","double"],built_in:["super","this"]},y={className:"meta",begin:"@"+p,contains:[{begin:/\(/,end:/\)/,contains:["self"]}]},f={className:"params",begin:/\(/,end:/\)/,keywords:E,relevance:0,contains:[m.C_BLOCK_COMMENT_MODE],endsParent:true};return{name:"Java",aliases:["jsp"],keywords:E,illegal:/<\/|#/,contains:[m.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{begin:/\w+@/,relevance:0},{className:"doctag",begin:"@[A-Za-z]+"}]}),{begin:/import java\.[a-z]+\./,keywords:"import",relevance:2},m.C_LINE_COMMENT_MODE,m.C_BLOCK_COMMENT_MODE,{begin:/"""/,end:/"""/,className:"string",contains:[m.BACKSLASH_ESCAPE]},m.APOS_STRING_MODE,m.QUOTE_STRING_MODE,{match:[/\b(?:class|interface|enum|extends|implements|new)/,/\s+/,p],className:{1:"keyword",3:"title.class"}},{match:/non-sealed/,scope:"keyword"},{begin:[u.concat(/(?!else)/,p),/\s+/,p,/\s+/,/=(?!=)/],className:{1:"type",3:"variable",5:"operator"}},{begin:[/record/,/\s+/,p],className:{1:"keyword",3:"title.class"},contains:[f,m.C_LINE_COMMENT_MODE,m.C_BLOCK_COMMENT_MODE]},{beginKeywords:"new throw return else",relevance:0},{begin:["(?:"+c+"\\s+)",m.UNDERSCORE_IDENT_RE,/\s*(?=\()/],className:{2:"title.function"},keywords:E,contains:[{className:"params",begin:/\(/,end:/\)/,keywords:E,relevance:0,contains:[y,m.APOS_STRING_MODE,m.QUOTE_STRING_MODE,o,m.C_BLOCK_COMMENT_MODE]},m.C_LINE_COMMENT_MODE,m.C_BLOCK_COMMENT_MODE]},o,y]}}return xg=g,xg}var Bg,F$;function eG(){if(F$)return Bg;F$=1;const s="[A-Za-z$_][0-9A-Za-z$_]*",n=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends"],i=["true","false","null","undefined","NaN","Infinity"],o=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],l=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],g=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],m=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],u=[].concat(g,o,l);function p(c){const d=c.regex,_=(x,{after:te})=>{const ce="</"+x[0].slice(1);return x.input.indexOf(ce,te)!==-1},b=s,$={begin:"<>",end:"</>"},E=/<[A-Za-z0-9\\._:-]+\s*\/>/,y={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(x,te)=>{const ce=x[0].length+x.index,ae=x.input[ce];if(ae==="<"||ae===","){te.ignoreMatch();return}ae===">"&&(_(x,{after:ce})||te.ignoreMatch());let De;const $e=x.input.substring(ce);if(De=$e.match(/^\s*=/)){te.ignoreMatch();return}if((De=$e.match(/^\s+extends\s+/))&&De.index===0){te.ignoreMatch();return}}},f={$pattern:s,keyword:n,literal:i,built_in:u,"variable.language":m},v="[0-9](_?[0-9])*",T=`\\.(${v})`,S="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",R={className:"number",variants:[{begin:`(\\b(${S})((${T})|\\.)?|(${T}))[eE][+-]?(${v})\\b`},{begin:`\\b(${S})\\b((${T})\\b|\\.)?|(${T})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},O={className:"subst",begin:"\\$\\{",end:"\\}",keywords:f,contains:[]},A={begin:".?html`",end:"",starts:{end:"`",returnEnd:false,contains:[c.BACKSLASH_ESCAPE,O],subLanguage:"xml"}},L={begin:".?css`",end:"",starts:{end:"`",returnEnd:false,contains:[c.BACKSLASH_ESCAPE,O],subLanguage:"css"}},I={begin:".?gql`",end:"",starts:{end:"`",returnEnd:false,contains:[c.BACKSLASH_ESCAPE,O],subLanguage:"graphql"}},k={className:"string",begin:"`",end:"`",contains:[c.BACKSLASH_ESCAPE,O]},U={className:"comment",variants:[c.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:true,excludeBegin:true,relevance:0},{className:"variable",begin:b+"(?=\\s*(-)|$)",endsParent:true,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),c.C_BLOCK_COMMENT_MODE,c.C_LINE_COMMENT_MODE]},P=[c.APOS_STRING_MODE,c.QUOTE_STRING_MODE,A,L,I,k,{match:/\$\d+/},R];O.contains=P.concat({begin:/\{/,end:/\}/,keywords:f,contains:["self"].concat(P)});const z=[].concat(U,O.contains),W=z.concat([{begin:/(\s*)\(/,end:/\)/,keywords:f,contains:["self"].concat(z)}]),j={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:f,contains:W},K={variants:[{match:[/class/,/\s+/,b,/\s+/,/extends/,/\s+/,d.concat(b,"(",d.concat(/\./,b),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,b],scope:{1:"keyword",3:"title.class"}}]},ee={relevance:0,match:d.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...o,...l]}},M={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},F={variants:[{match:[/function/,/\s+/,b,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[j],illegal:/%/},V={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function X(x){return d.concat("(?!",x.join("|"),")")}const H={match:d.concat(/\b/,X([...g,"super","import"].map(x=>`${x}\\s*\\(`)),b,d.lookahead(/\s*\(/)),className:"title.function",relevance:0},ne={begin:d.concat(/\./,d.lookahead(d.concat(b,/(?![0-9A-Za-z$_(])/))),end:b,excludeBegin:true,keywords:"prototype",className:"property",relevance:0},Ie={match:[/get|set/,/\s+/,b,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},j]},de="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+c.UNDERSCORE_IDENT_RE+")\\s*=>",ot={match:[/const|var|let/,/\s+/,b,/\s*/,/=\s*/,/(async\s*)?/,d.lookahead(de)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[j]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:f,exports:{PARAMS_CONTAINS:W,CLASS_REFERENCE:ee},illegal:/#(?![$_A-z])/,contains:[c.SHEBANG({label:"shebang",binary:"node",relevance:5}),M,c.APOS_STRING_MODE,c.QUOTE_STRING_MODE,A,L,I,k,U,{match:/\$\d+/},R,ee,{className:"attr",begin:b+d.lookahead(":"),relevance:0},ot,{begin:"("+c.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[U,c.REGEXP_MODE,{className:"function",begin:de,returnBegin:true,end:"\\s*=>",contains:[{className:"params",variants:[{begin:c.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:true},{begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:f,contains:W}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:$.begin,end:$.end},{match:E},{begin:y.begin,"on:begin":y.isTrulyOpeningTag,end:y.end}],subLanguage:"xml",contains:[{begin:y.begin,end:y.end,skip:true,contains:["self"]}]}]},F,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+c.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:true,label:"func.def",contains:[j,c.inherit(c.TITLE_MODE,{begin:b,className:"title.function"})]},{match:/\.\.\./,relevance:0},ne,{match:"\\$"+b,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[j]},H,V,K,Ie,{match:/\$[(.]/}]}}return Bg=p,Bg}var Pg,G$;function tG(){if(G$)return Pg;G$=1;function s(n){const i={className:"attr",begin:/"(\\.|[^\\"\r\n])*"(?=\s*:)/,relevance:1.01},o={match:/[{}[\],:]/,className:"punctuation",relevance:0},l=["true","false","null"],g={scope:"literal",beginKeywords:l.join(" ")};return{name:"JSON",aliases:["jsonc"],keywords:{literal:l},contains:[i,o,n.QUOTE_STRING_MODE,g,n.C_NUMBER_MODE,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE],illegal:"\\S"}}return Pg=s,Pg}var Ug,H$;function sG(){if(H$)return Ug;H$=1;var s="[0-9](_*[0-9])*",n=`\\.(${s})`,i="[0-9a-fA-F](_*[0-9a-fA-F])*",o={className:"number",variants:[{begin:`(\\b(${s})((${n})|\\.)?|(${n}))[eE][+-]?(${s})[fFdD]?\\b`},{begin:`\\b(${s})((${n})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${n})[fFdD]?\\b`},{begin:`\\b(${s})[fFdD]\\b`},{begin:`\\b0[xX]((${i})\\.?|(${i})?\\.(${i}))[pP][+-]?(${s})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${i})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function l(g){const m={keyword:"abstract as val var vararg get set class object open private protected public noinline crossinline dynamic final enum if else do while for when throw try catch finally import package is in fun override companion reified inline lateinit init interface annotation data sealed internal infix operator out by constructor super tailrec where const inner suspend typealias external expect actual",built_in:"Byte Short Char Int Long Boolean Float Double Void Unit Nothing",literal:"true false null"},u={className:"keyword",begin:/\b(break|continue|return|this)\b/,starts:{contains:[{className:"symbol",begin:/@\w+/}]}},p={className:"symbol",begin:g.UNDERSCORE_IDENT_RE+"@"},c={className:"subst",begin:/\$\{/,end:/\}/,contains:[g.C_NUMBER_MODE]},d={className:"variable",begin:"\\$"+g.UNDERSCORE_IDENT_RE},_={className:"string",variants:[{begin:'"""',end:'"""(?=[^"])',contains:[d,c]},{begin:"'",end:"'",illegal:/\n/,contains:[g.BACKSLASH_ESCAPE]},{begin:'"',end:'"',illegal:/\n/,contains:[g.BACKSLASH_ESCAPE,d,c]}]};c.contains.push(_);const b={className:"meta",begin:"@(?:file|property|field|get|set|receiver|param|setparam|delegate)\\s*:(?:\\s*"+g.UNDERSCORE_IDENT_RE+")?"},$={className:"meta",begin:"@"+g.UNDERSCORE_IDENT_RE,contains:[{begin:/\(/,end:/\)/,contains:[g.inherit(_,{className:"string"}),"self"]}]},E=o,y=g.COMMENT("/\\*","\\*/",{contains:[g.C_BLOCK_COMMENT_MODE]}),f={variants:[{className:"type",begin:g.UNDERSCORE_IDENT_RE},{begin:/\(/,end:/\)/,contains:[]}]},v=f;return v.variants[1].contains=[f],f.variants[1].contains=[v],{name:"Kotlin",aliases:["kt","kts"],keywords:m,contains:[g.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"}]}),g.C_LINE_COMMENT_MODE,y,u,p,b,$,{className:"function",beginKeywords:"fun",end:"[(]|$",returnBegin:true,excludeEnd:true,keywords:m,relevance:5,contains:[{begin:g.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:true,relevance:0,contains:[g.UNDERSCORE_TITLE_MODE]},{className:"type",begin:/</,end:/>/,keywords:"reified",relevance:0},{className:"params",begin:/\(/,end:/\)/,endsParent:true,keywords:m,relevance:0,contains:[{begin:/:/,end:/[=,\/]/,endsWithParent:true,contains:[f,g.C_LINE_COMMENT_MODE,y],relevance:0},g.C_LINE_COMMENT_MODE,y,b,$,_,g.C_NUMBER_MODE]},y]},{begin:[/class|interface|trait/,/\s+/,g.UNDERSCORE_IDENT_RE],beginScope:{3:"title.class"},keywords:"class interface trait",end:/[:\{(]|$/,excludeEnd:true,illegal:"extends implements",contains:[{beginKeywords:"public protected internal private constructor"},g.UNDERSCORE_TITLE_MODE,{className:"type",begin:/</,end:/>/,excludeBegin:true,excludeEnd:true,relevance:0},{className:"type",begin:/[,:]\s*/,end:/[<\(,){\s]|$/,excludeBegin:true,returnEnd:true},b,$]},_,{className:"meta",begin:"^#!/usr/bin/env",end:"$",illegal:`
`},E]}}return Ug=l,Ug}var Fg,V$;function iG(){if(V$)return Fg;V$=1;const s=d=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:d.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[d.APOS_STRING_MODE,d.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:d.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),n=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],i=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],o=[...n,...i],l=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),g=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),m=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),u=["accent-color","align-content","align-items","align-self","alignment-baseline","all","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-end-end-radius","border-end-start-radius","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","cx","cy","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","content-visibility","counter-increment","counter-reset","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","empty-cells","enable-background","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flow","flood-color","flood-opacity","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-smoothing","font-stretch","font-style","font-synthesis","font-variant","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","inline-size","inset","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","kerning","justify-content","justify-items","justify-self","left","letter-spacing","lighting-color","line-break","line-height","list-style","list-style-image","list-style-position","list-style-type","marker","marker-end","marker-mid","marker-start","mask","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","perspective","perspective-origin","pointer-events","position","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","scale","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","speak","speak-as","src","tab-size","table-layout","text-anchor","text-align","text-align-all","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-transform","text-underline-offset","text-underline-position","top","transform","transform-box","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","vector-effect","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index"].sort().reverse(),p=g.concat(m).sort().reverse();function c(d){const _=s(d),b=p,$="and or not only",E="[\\w-]+",y="("+E+"|@\\{"+E+"\\})",f=[],v=[],T=function(z){return{className:"string",begin:"~?"+z+".*?"+z}},S=function(z,W,j){return{className:z,begin:W,relevance:j}},R={$pattern:/[a-z-]+/,keyword:$,attribute:l.join(" ")},O={begin:"\\(",end:"\\)",contains:v,keywords:R,relevance:0};v.push(d.C_LINE_COMMENT_MODE,d.C_BLOCK_COMMENT_MODE,T("'"),T('"'),_.CSS_NUMBER_MODE,{begin:"(url|data-uri)\\(",starts:{className:"string",end:"[\\)\\n]",excludeEnd:true}},_.HEXCOLOR,O,S("variable","@@?"+E,10),S("variable","@\\{"+E+"\\}"),S("built_in","~?`[^`]*?`"),{className:"attribute",begin:E+"\\s*:",end:":",returnBegin:true,excludeEnd:true},_.IMPORTANT,{beginKeywords:"and not"},_.FUNCTION_DISPATCH);const A=v.concat({begin:/\{/,end:/\}/,contains:f}),L={beginKeywords:"when",endsWithParent:true,contains:[{beginKeywords:"and not"}].concat(v)},I={begin:y+"\\s*:",returnBegin:true,end:/[;}]/,relevance:0,contains:[{begin:/-(webkit|moz|ms|o)-/},_.CSS_VARIABLE,{className:"attribute",begin:"\\b("+u.join("|")+")\\b",end:/(?=:)/,starts:{endsWithParent:true,illegal:"[<=$]",relevance:0,contains:v}}]},k={className:"keyword",begin:"@(import|media|charset|font-face|(-[a-z]+-)?keyframes|supports|document|namespace|page|viewport|host)\\b",starts:{end:"[;{}]",keywords:R,returnEnd:true,contains:v,relevance:0}},B={className:"variable",variants:[{begin:"@"+E+"\\s*:",relevance:15},{begin:"@"+E}],starts:{end:"[;}]",returnEnd:true,contains:A}},U={variants:[{begin:"[\\.#:&\\[>]",end:"[;{}]"},{begin:y,end:/\{/}],returnBegin:true,returnEnd:true,illegal:`[<='$"]`,relevance:0,contains:[d.C_LINE_COMMENT_MODE,d.C_BLOCK_COMMENT_MODE,L,S("keyword","all\\b"),S("variable","@\\{"+E+"\\}"),{begin:"\\b("+o.join("|")+")\\b",className:"selector-tag"},_.CSS_NUMBER_MODE,S("selector-tag",y,0),S("selector-id","#"+y),S("selector-class","\\."+y,0),S("selector-tag","&",0),_.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",begin:":("+g.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+m.join("|")+")"},{begin:/\(/,end:/\)/,relevance:0,contains:A},{begin:"!important"},_.FUNCTION_DISPATCH]},P={begin:E+`:(:)?(${b.join("|")})`,returnBegin:true,contains:[U]};return f.push(d.C_LINE_COMMENT_MODE,d.C_BLOCK_COMMENT_MODE,k,B,P,I,U,L,_.FUNCTION_DISPATCH),{name:"Less",case_insensitive:true,illegal:`[=>'/<($"]`,contains:f}}return Fg=c,Fg}var Gg,W$;function nG(){if(W$)return Gg;W$=1;function s(n){const i="\\[=*\\[",o="\\]=*\\]",l={begin:i,end:o,contains:["self"]},g=[n.COMMENT("--(?!"+i+")","$"),n.COMMENT("--"+i,o,{contains:[l],relevance:10})];return{name:"Lua",keywords:{$pattern:n.UNDERSCORE_IDENT_RE,literal:"true false nil",keyword:"and break do else elseif end for goto if in local not or repeat return then until while",built_in:"_G _ENV _VERSION __index __newindex __mode __call __metatable __tostring __len __gc __add __sub __mul __div __mod __pow __concat __unm __eq __lt __le assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall arg self coroutine resume yield status wrap create running debug getupvalue debug sethook getmetatable gethook setmetatable setlocal traceback setfenv getinfo setupvalue getlocal getregistry getfenv io lines write close flush open output type read stderr stdin input stdout popen tmpfile math log max acos huge ldexp pi cos tanh pow deg tan cosh sinh random randomseed frexp ceil floor rad abs sqrt modf asin min mod fmod log10 atan2 exp sin atan os exit setlocale date getenv difftime remove time clock tmpname rename execute package preload loadlib loaded loaders cpath config path seeall string sub upper len gfind rep find match char dump gmatch reverse byte format gsub lower table setn insert getn foreachi maxn foreach concat sort remove"},contains:g.concat([{className:"function",beginKeywords:"function",end:"\\)",contains:[n.inherit(n.TITLE_MODE,{begin:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{className:"params",begin:"\\(",endsWithParent:true,contains:g}].concat(g)},n.C_NUMBER_MODE,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE,{className:"string",begin:i,end:o,contains:[l],relevance:5}])}}return Gg=s,Gg}var Hg,z$;function rG(){if(z$)return Hg;z$=1;function s(n){const i={className:"variable",variants:[{begin:"\\$\\("+n.UNDERSCORE_IDENT_RE+"\\)",contains:[n.BACKSLASH_ESCAPE]},{begin:/\$[@%<?\^\+\*]/}]},o={className:"string",begin:/"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,i]},l={className:"variable",begin:/\$\([\w-]+\s/,end:/\)/,keywords:{built_in:"subst patsubst strip findstring filter filter-out sort word wordlist firstword lastword dir notdir suffix basename addsuffix addprefix join wildcard realpath abspath error warning shell origin flavor foreach if or and call eval file value"},contains:[i]},g={begin:"^"+n.UNDERSCORE_IDENT_RE+"\\s*(?=[:+?]?=)"},m={className:"meta",begin:/^\.PHONY:/,end:/$/,keywords:{$pattern:/[\.\w]+/,keyword:".PHONY"}},u={className:"section",begin:/^[^\s]+:/,end:/$/,contains:[i]};return{name:"Makefile",aliases:["mk","mak","make"],keywords:{$pattern:/[\w-]+/,keyword:"define endef undefine ifdef ifndef ifeq ifneq else endif include -include sinclude override export unexport private vpath"},contains:[n.HASH_COMMENT_MODE,i,o,l,g,m,u]}}return Hg=s,Hg}var Vg,j$;function oG(){if(j$)return Vg;j$=1;function s(n){const i=n.regex,o=["abs","accept","alarm","and","atan2","bind","binmode","bless","break","caller","chdir","chmod","chomp","chop","chown","chr","chroot","class","close","closedir","connect","continue","cos","crypt","dbmclose","dbmopen","defined","delete","die","do","dump","each","else","elsif","endgrent","endhostent","endnetent","endprotoent","endpwent","endservent","eof","eval","exec","exists","exit","exp","fcntl","field","fileno","flock","for","foreach","fork","format","formline","getc","getgrent","getgrgid","getgrnam","gethostbyaddr","gethostbyname","gethostent","getlogin","getnetbyaddr","getnetbyname","getnetent","getpeername","getpgrp","getpriority","getprotobyname","getprotobynumber","getprotoent","getpwent","getpwnam","getpwuid","getservbyname","getservbyport","getservent","getsockname","getsockopt","given","glob","gmtime","goto","grep","gt","hex","if","index","int","ioctl","join","keys","kill","last","lc","lcfirst","length","link","listen","local","localtime","log","lstat","lt","ma","map","method","mkdir","msgctl","msgget","msgrcv","msgsnd","my","ne","next","no","not","oct","open","opendir","or","ord","our","pack","package","pipe","pop","pos","print","printf","prototype","push","q|0","qq","quotemeta","qw","qx","rand","read","readdir","readline","readlink","readpipe","recv","redo","ref","rename","require","reset","return","reverse","rewinddir","rindex","rmdir","say","scalar","seek","seekdir","select","semctl","semget","semop","send","setgrent","sethostent","setnetent","setpgrp","setpriority","setprotoent","setpwent","setservent","setsockopt","shift","shmctl","shmget","shmread","shmwrite","shutdown","sin","sleep","socket","socketpair","sort","splice","split","sprintf","sqrt","srand","stat","state","study","sub","substr","symlink","syscall","sysopen","sysread","sysseek","system","syswrite","tell","telldir","tie","tied","time","times","tr","truncate","uc","ucfirst","umask","undef","unless","unlink","unpack","unshift","untie","until","use","utime","values","vec","wait","waitpid","wantarray","warn","when","while","write","x|0","xor","y|0"],l=/[dualxmsipngr]{0,12}/,g={$pattern:/[\w.]+/,keyword:o.join(" ")},m={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:g},u={begin:/->\{/,end:/\}/},p={scope:"attr",match:/\s+:\s*\w+(\s*\(.*?\))?/},c={scope:"variable",variants:[{begin:/\$\d/},{begin:i.concat(/[$%@](?!")(\^\w\b|#\w+(::\w+)*|\{\w+\}|\w+(::\w*)*)/,"(?![A-Za-z])(?![@$%])")},{begin:/[$%@](?!")[^\s\w{=]|\$=/,relevance:0}],contains:[p]},d={className:"number",variants:[{match:/0?\.[0-9][0-9_]+\b/},{match:/\bv?(0|[1-9][0-9_]*(\.[0-9_]+)?|[1-9][0-9_]*)\b/},{match:/\b0[0-7][0-7_]*\b/},{match:/\b0x[0-9a-fA-F][0-9a-fA-F_]*\b/},{match:/\b0b[0-1][0-1_]*\b/}],relevance:0},_=[n.BACKSLASH_ESCAPE,m,c],b=[/!/,/\//,/\|/,/\?/,/'/,/"/,/#/],$=(f,v,T="\\1")=>{const S=T==="\\1"?T:i.concat(T,v);return i.concat(i.concat("(?:",f,")"),v,/(?:\\.|[^\\\/])*?/,S,/(?:\\.|[^\\\/])*?/,T,l)},E=(f,v,T)=>i.concat(i.concat("(?:",f,")"),v,/(?:\\.|[^\\\/])*?/,T,l),y=[c,n.HASH_COMMENT_MODE,n.COMMENT(/^=\w/,/=cut/,{endsWithParent:true}),u,{className:"string",contains:_,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*<",end:">",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[n.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[n.BACKSLASH_ESCAPE]},{begin:/\{\w+\}/,relevance:0},{begin:"-?\\w+\\s*=>",relevance:0}]},d,{begin:"(\\/\\/|"+n.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[n.HASH_COMMENT_MODE,{className:"regexp",variants:[{begin:$("s|tr|y",i.either(...b,{capture:true}))},{begin:$("s|tr|y","\\(","\\)")},{begin:$("s|tr|y","\\[","\\]")},{begin:$("s|tr|y","\\{","\\}")}],relevance:2},{className:"regexp",variants:[{begin:/(m|qr)\/\//,relevance:0},{begin:E("(?:m|qr)?",/\//,/\//)},{begin:E("m|qr",i.either(...b,{capture:true}),/\1/)},{begin:E("m|qr",/\(/,/\)/)},{begin:E("m|qr",/\[/,/\]/)},{begin:E("m|qr",/\{/,/\}/)}]}]},{className:"function",beginKeywords:"sub method",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:true,relevance:5,contains:[n.TITLE_MODE,p]},{className:"class",beginKeywords:"class",end:"[;{]",excludeEnd:true,relevance:5,contains:[n.TITLE_MODE,p,d]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return m.contains=y,u.contains=y,{name:"Perl",aliases:["pl","pm"],keywords:g,contains:y}}return Vg=s,Vg}var Wg,X$;function aG(){if(X$)return Wg;X$=1;function s(n){const i={className:"built_in",begin:"\\b(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)\\w+"},o=/[a-zA-Z@][a-zA-Z0-9_]*/,p={"variable.language":["this","super"],$pattern:o,keyword:["while","export","sizeof","typedef","const","struct","for","union","volatile","static","mutable","if","do","return","goto","enum","else","break","extern","asm","case","default","register","explicit","typename","switch","continue","inline","readonly","assign","readwrite","self","@synchronized","id","typeof","nonatomic","IBOutlet","IBAction","strong","weak","copy","in","out","inout","bycopy","byref","oneway","__strong","__weak","__block","__autoreleasing","@private","@protected","@public","@try","@property","@end","@throw","@catch","@finally","@autoreleasepool","@synthesize","@dynamic","@selector","@optional","@required","@encode","@package","@import","@defs","@compatibility_alias","__bridge","__bridge_transfer","__bridge_retained","__bridge_retain","__covariant","__contravariant","__kindof","_Nonnull","_Nullable","_Null_unspecified","__FUNCTION__","__PRETTY_FUNCTION__","__attribute__","getter","setter","retain","unsafe_unretained","nonnull","nullable","null_unspecified","null_resettable","class","instancetype","NS_DESIGNATED_INITIALIZER","NS_UNAVAILABLE","NS_REQUIRES_SUPER","NS_RETURNS_INNER_POINTER","NS_INLINE","NS_AVAILABLE","NS_DEPRECATED","NS_ENUM","NS_OPTIONS","NS_SWIFT_UNAVAILABLE","NS_ASSUME_NONNULL_BEGIN","NS_ASSUME_NONNULL_END","NS_REFINED_FOR_SWIFT","NS_SWIFT_NAME","NS_SWIFT_NOTHROW","NS_DURING","NS_HANDLER","NS_ENDHANDLER","NS_VALUERETURN","NS_VOIDRETURN"],literal:["false","true","FALSE","TRUE","nil","YES","NO","NULL"],built_in:["dispatch_once_t","dispatch_queue_t","dispatch_sync","dispatch_async","dispatch_once"],type:["int","float","char","unsigned","signed","short","long","double","wchar_t","unichar","void","bool","BOOL","id|0","_Bool"]},c={$pattern:o,keyword:["@interface","@class","@protocol","@implementation"]};return{name:"Objective-C",aliases:["mm","objc","obj-c","obj-c++","objective-c++"],keywords:p,illegal:"</",contains:[i,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE,n.C_NUMBER_MODE,n.QUOTE_STRING_MODE,n.APOS_STRING_MODE,{className:"string",variants:[{begin:'@"',end:'"',illegal:"\\n",contains:[n.BACKSLASH_ESCAPE]}]},{className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},n.inherit(n.QUOTE_STRING_MODE,{className:"string"}),{className:"string",begin:/<.*?>/,end:/$/,illegal:"\\n"},n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{className:"class",begin:"("+c.keyword.join("|")+")\\b",end:/(\{|$)/,excludeEnd:true,keywords:c,contains:[n.UNDERSCORE_TITLE_MODE]},{begin:"\\."+n.UNDERSCORE_IDENT_RE,relevance:0}]}}return Wg=s,Wg}var zg,K$;function lG(){if(K$)return zg;K$=1;function s(n){const i=n.regex,o=/(?![A-Za-z0-9])(?![$])/,l=i.concat(/[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/,o),g=i.concat(/(\\?[A-Z][a-z0-9_\x7f-\xff]+|\\?[A-Z]+(?=[A-Z][a-z0-9_\x7f-\xff])){1,}/,o),m={scope:"variable",match:"\\$+"+l},u={scope:"meta",variants:[{begin:/<\?php/,relevance:10},{begin:/<\?=/},{begin:/<\?/,relevance:.1},{begin:/\?>/}]},p={scope:"subst",variants:[{begin:/\$\w+/},{begin:/\{\$/,end:/\}/}]},c=n.inherit(n.APOS_STRING_MODE,{illegal:null}),d=n.inherit(n.QUOTE_STRING_MODE,{illegal:null,contains:n.QUOTE_STRING_MODE.contains.concat(p)}),_={begin:/<<<[ \t]*(?:(\w+)|"(\w+)")\n/,end:/[ \t]*(\w+)\b/,contains:n.QUOTE_STRING_MODE.contains.concat(p),"on:begin":(W,j)=>{j.data._beginMatch=W[1]||W[2]},"on:end":(W,j)=>{j.data._beginMatch!==W[1]&&j.ignoreMatch()}},b=n.END_SAME_AS_BEGIN({begin:/<<<[ \t]*'(\w+)'\n/,end:/[ \t]*(\w+)\b/}),$=`[ 	
]`,E={scope:"string",variants:[d,c,_,b]},y={scope:"number",variants:[{begin:"\\b0[bB][01]+(?:_[01]+)*\\b"},{begin:"\\b0[oO][0-7]+(?:_[0-7]+)*\\b"},{begin:"\\b0[xX][\\da-fA-F]+(?:_[\\da-fA-F]+)*\\b"},{begin:"(?:\\b\\d+(?:_\\d+)*(\\.(?:\\d+(?:_\\d+)*))?|\\B\\.\\d+)(?:[eE][+-]?\\d+)?"}],relevance:0},f=["false","null","true"],v=["__CLASS__","__DIR__","__FILE__","__FUNCTION__","__COMPILER_HALT_OFFSET__","__LINE__","__METHOD__","__NAMESPACE__","__TRAIT__","die","echo","exit","include","include_once","print","require","require_once","array","abstract","and","as","binary","bool","boolean","break","callable","case","catch","class","clone","const","continue","declare","default","do","double","else","elseif","empty","enddeclare","endfor","endforeach","endif","endswitch","endwhile","enum","eval","extends","final","finally","float","for","foreach","from","global","goto","if","implements","instanceof","insteadof","int","integer","interface","isset","iterable","list","match|0","mixed","new","never","object","or","private","protected","public","readonly","real","return","string","switch","throw","trait","try","unset","use","var","void","while","xor","yield"],T=["Error|0","AppendIterator","ArgumentCountError","ArithmeticError","ArrayIterator","ArrayObject","AssertionError","BadFunctionCallException","BadMethodCallException","CachingIterator","CallbackFilterIterator","CompileError","Countable","DirectoryIterator","DivisionByZeroError","DomainException","EmptyIterator","ErrorException","Exception","FilesystemIterator","FilterIterator","GlobIterator","InfiniteIterator","InvalidArgumentException","IteratorIterator","LengthException","LimitIterator","LogicException","MultipleIterator","NoRewindIterator","OutOfBoundsException","OutOfRangeException","OuterIterator","OverflowException","ParentIterator","ParseError","RangeException","RecursiveArrayIterator","RecursiveCachingIterator","RecursiveCallbackFilterIterator","RecursiveDirectoryIterator","RecursiveFilterIterator","RecursiveIterator","RecursiveIteratorIterator","RecursiveRegexIterator","RecursiveTreeIterator","RegexIterator","RuntimeException","SeekableIterator","SplDoublyLinkedList","SplFileInfo","SplFileObject","SplFixedArray","SplHeap","SplMaxHeap","SplMinHeap","SplObjectStorage","SplObserver","SplPriorityQueue","SplQueue","SplStack","SplSubject","SplTempFileObject","TypeError","UnderflowException","UnexpectedValueException","UnhandledMatchError","ArrayAccess","BackedEnum","Closure","Fiber","Generator","Iterator","IteratorAggregate","Serializable","Stringable","Throwable","Traversable","UnitEnum","WeakReference","WeakMap","Directory","__PHP_Incomplete_Class","parent","php_user_filter","self","static","stdClass"],R={keyword:v,literal:(W=>{const j=[];return W.forEach(K=>{j.push(K),K.toLowerCase()===K?j.push(K.toUpperCase()):j.push(K.toLowerCase())}),j})(f),built_in:T},O=W=>W.map(j=>j.replace(/\|\d+$/,"")),A={variants:[{match:[/new/,i.concat($,"+"),i.concat("(?!",O(T).join("\\b|"),"\\b)"),g],scope:{1:"keyword",4:"title.class"}}]},L=i.concat(l,"\\b(?!\\()"),I={variants:[{match:[i.concat(/::/,i.lookahead(/(?!class\b)/)),L],scope:{2:"variable.constant"}},{match:[/::/,/class/],scope:{2:"variable.language"}},{match:[g,i.concat(/::/,i.lookahead(/(?!class\b)/)),L],scope:{1:"title.class",3:"variable.constant"}},{match:[g,i.concat("::",i.lookahead(/(?!class\b)/))],scope:{1:"title.class"}},{match:[g,/::/,/class/],scope:{1:"title.class",3:"variable.language"}}]},k={scope:"attr",match:i.concat(l,i.lookahead(":"),i.lookahead(/(?!::)/))},B={relevance:0,begin:/\(/,end:/\)/,keywords:R,contains:[k,m,I,n.C_BLOCK_COMMENT_MODE,E,y,A]},U={relevance:0,match:[/\b/,i.concat("(?!fn\\b|function\\b|",O(v).join("\\b|"),"|",O(T).join("\\b|"),"\\b)"),l,i.concat($,"*"),i.lookahead(/(?=\()/)],scope:{3:"title.function.invoke"},contains:[B]};B.contains.push(U);const P=[k,I,n.C_BLOCK_COMMENT_MODE,E,y,A],z={begin:i.concat(/#\[\s*/,g),beginScope:"meta",end:/]/,endScope:"meta",keywords:{literal:f,keyword:["new","array"]},contains:[{begin:/\[/,end:/]/,keywords:{literal:f,keyword:["new","array"]},contains:["self",...P]},...P,{scope:"meta",match:g}]};return{case_insensitive:false,keywords:R,contains:[z,n.HASH_COMMENT_MODE,n.COMMENT("//","$"),n.COMMENT("/\\*","\\*/",{contains:[{scope:"doctag",match:"@[A-Za-z]+"}]}),{match:/__halt_compiler\(\);/,keywords:"__halt_compiler",starts:{scope:"comment",end:n.MATCH_NOTHING_RE,contains:[{match:/\?>/,scope:"meta",endsParent:true}]}},u,{scope:"variable.language",match:/\$this\b/},m,U,I,{match:[/const/,/\s/,l],scope:{1:"keyword",3:"variable.constant"}},A,{scope:"function",relevance:0,beginKeywords:"fn function",end:/[;{]/,excludeEnd:true,illegal:"[$%\\[]",contains:[{beginKeywords:"use"},n.UNDERSCORE_TITLE_MODE,{begin:"=>",endsParent:true},{scope:"params",begin:"\\(",end:"\\)",excludeBegin:true,excludeEnd:true,keywords:R,contains:["self",m,I,n.C_BLOCK_COMMENT_MODE,E,y]}]},{scope:"class",variants:[{beginKeywords:"enum",illegal:/[($"]/},{beginKeywords:"class interface trait",illegal:/[:($"]/}],relevance:0,end:/\{/,excludeEnd:true,contains:[{beginKeywords:"extends implements"},n.UNDERSCORE_TITLE_MODE]},{beginKeywords:"namespace",relevance:0,end:";",illegal:/[.']/,contains:[n.inherit(n.UNDERSCORE_TITLE_MODE,{scope:"title.class"})]},{beginKeywords:"use",relevance:0,end:";",contains:[{match:/\b(as|const|function)\b/,scope:"keyword"},n.UNDERSCORE_TITLE_MODE]},E,y]}}return zg=s,zg}var jg,Y$;function cG(){if(Y$)return jg;Y$=1;function s(n){return{name:"PHP template",subLanguage:"xml",contains:[{begin:/<\?(php|=)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:true},{begin:'b"',end:'"',skip:true},{begin:"b'",end:"'",skip:true},n.inherit(n.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:true}),n.inherit(n.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:true})]}]}}return jg=s,jg}var Xg,q$;function uG(){if(q$)return Xg;q$=1;function s(n){return{name:"Plain text",aliases:["text","txt"],disableAutodetect:true}}return Xg=s,Xg}var Kg,J$;function hG(){if(J$)return Kg;J$=1;function s(n){const i=n.regex,o=/[\p{XID_Start}_]\p{XID_Continue}*/u,l=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],p={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:l,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},c={className:"meta",begin:/^(>>>|\.\.\.) /},d={className:"subst",begin:/\{/,end:/\}/,keywords:p,illegal:/#/},_={begin:/\{\{/,relevance:0},b={className:"string",contains:[n.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[n.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[n.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[n.BACKSLASH_ESCAPE,c,_,d]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[n.BACKSLASH_ESCAPE,c,_,d]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[n.BACKSLASH_ESCAPE,_,d]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,_,d]},n.APOS_STRING_MODE,n.QUOTE_STRING_MODE]},$="[0-9](_?[0-9])*",E=`(\\b(${$}))?\\.(${$})|\\b(${$})\\.`,y=`\\b|${l.join("|")}`,f={className:"number",relevance:0,variants:[{begin:`(\\b(${$})|(${E}))[eE][+-]?(${$})[jJ]?(?=${y})`},{begin:`(${E})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${y})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${y})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${y})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${y})`},{begin:`\\b(${$})[jJ](?=${y})`}]},v={className:"comment",begin:i.lookahead(/# type:/),end:/$/,keywords:p,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:true}]},T={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:true},{begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:p,contains:["self",c,f,b,n.HASH_COMMENT_MODE]}]};return d.contains=[b,f,c],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:true,keywords:p,illegal:/(<\/|\?)|=>/,contains:[c,f,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},b,v,n.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,o],scope:{1:"keyword",3:"title.function"},contains:[T]},{variants:[{match:[/\bclass/,/\s+/,o,/\s*/,/\(\s*/,o,/\s*\)/]},{match:[/\bclass/,/\s+/,o]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[f,T,b]}]}}return Kg=s,Kg}var Yg,Z$;function dG(){if(Z$)return Yg;Z$=1;function s(n){return{aliases:["pycon"],contains:[{className:"meta.prompt",starts:{end:/ |$/,starts:{end:"$",subLanguage:"python"}},variants:[{begin:/^>>>(?=[ ]|$)/},{begin:/^\.\.\.(?=[ ]|$)/}]}]}}return Yg=s,Yg}var qg,Q$;function _G(){if(Q$)return qg;Q$=1;function s(n){const i=n.regex,o=/(?:(?:[a-zA-Z]|\.[._a-zA-Z])[._a-zA-Z0-9]*)|\.(?!\d)/,l=i.either(/0[xX][0-9a-fA-F]+\.[0-9a-fA-F]*[pP][+-]?\d+i?/,/0[xX][0-9a-fA-F]+(?:[pP][+-]?\d+)?[Li]?/,/(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?[Li]?/),g=/[=!<>:]=|\|\||&&|:::?|<-|<<-|->>|->|\|>|[-+*\/?!$&|:<=>@^~]|\*\*/,m=i.either(/[()]/,/[{}]/,/\[\[/,/[[\]]/,/\\/,/,/);return{name:"R",keywords:{$pattern:o,keyword:"function if in break next repeat else for while",literal:"NULL NA TRUE FALSE Inf NaN NA_integer_|10 NA_real_|10 NA_character_|10 NA_complex_|10",built_in:"LETTERS letters month.abb month.name pi T F abs acos acosh all any anyNA Arg as.call as.character as.complex as.double as.environment as.integer as.logical as.null.default as.numeric as.raw asin asinh atan atanh attr attributes baseenv browser c call ceiling class Conj cos cosh cospi cummax cummin cumprod cumsum digamma dim dimnames emptyenv exp expression floor forceAndCall gamma gc.time globalenv Im interactive invisible is.array is.atomic is.call is.character is.complex is.double is.environment is.expression is.finite is.function is.infinite is.integer is.language is.list is.logical is.matrix is.na is.name is.nan is.null is.numeric is.object is.pairlist is.raw is.recursive is.single is.symbol lazyLoadDBfetch length lgamma list log max min missing Mod names nargs nzchar oldClass on.exit pos.to.env proc.time prod quote range Re rep retracemem return round seq_along seq_len seq.int sign signif sin sinh sinpi sqrt standardGeneric substitute sum switch tan tanh tanpi tracemem trigamma trunc unclass untracemem UseMethod xtfrm"},contains:[n.COMMENT(/#'/,/$/,{contains:[{scope:"doctag",match:/@examples/,starts:{end:i.lookahead(i.either(/\n^#'\s*(?=@[a-zA-Z]+)/,/\n^(?!#')/)),endsParent:true}},{scope:"doctag",begin:"@param",end:/$/,contains:[{scope:"variable",variants:[{match:o},{match:/`(?:\\.|[^`\\])+`/}],endsParent:true}]},{scope:"doctag",match:/@[a-zA-Z]+/},{scope:"keyword",match:/\\[a-zA-Z]+/}]}),n.HASH_COMMENT_MODE,{scope:"string",contains:[n.BACKSLASH_ESCAPE],variants:[n.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\(/,end:/\)(-*)"/}),n.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\{/,end:/\}(-*)"/}),n.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\[/,end:/\](-*)"/}),n.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\(/,end:/\)(-*)'/}),n.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\{/,end:/\}(-*)'/}),n.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\[/,end:/\](-*)'/}),{begin:'"',end:'"',relevance:0},{begin:"'",end:"'",relevance:0}]},{relevance:0,variants:[{scope:{1:"operator",2:"number"},match:[g,l]},{scope:{1:"operator",2:"number"},match:[/%[^%]*%/,l]},{scope:{1:"punctuation",2:"number"},match:[m,l]},{scope:{2:"number"},match:[/[^a-zA-Z0-9._]|^/,l]}]},{scope:{3:"operator"},match:[o,/\s+/,/<-/,/\s+/]},{scope:"operator",relevance:0,variants:[{match:g},{match:/%[^%]*%/}]},{scope:"punctuation",relevance:0,match:m},{begin:"`",end:"`",contains:[{begin:/\\./}]}]}}return qg=s,qg}var Jg,ey;function pG(){if(ey)return Jg;ey=1;function s(n){const i=n.regex,o=/(r#)?/,l=i.concat(o,n.UNDERSCORE_IDENT_RE),g=i.concat(o,n.IDENT_RE),m={className:"title.function.invoke",relevance:0,begin:i.concat(/\b/,/(?!let|for|while|if|else|match\b)/,g,i.lookahead(/\s*\(/))},u="([ui](8|16|32|64|128|size)|f(32|64))?",p=["abstract","as","async","await","become","box","break","const","continue","crate","do","dyn","else","enum","extern","false","final","fn","for","if","impl","in","let","loop","macro","match","mod","move","mut","override","priv","pub","ref","return","self","Self","static","struct","super","trait","true","try","type","typeof","union","unsafe","unsized","use","virtual","where","while","yield"],c=["true","false","Some","None","Ok","Err"],d=["drop ","Copy","Send","Sized","Sync","Drop","Fn","FnMut","FnOnce","ToOwned","Clone","Debug","PartialEq","PartialOrd","Eq","Ord","AsRef","AsMut","Into","From","Default","Iterator","Extend","IntoIterator","DoubleEndedIterator","ExactSizeIterator","SliceConcatExt","ToString","assert!","assert_eq!","bitflags!","bytes!","cfg!","col!","concat!","concat_idents!","debug_assert!","debug_assert_eq!","env!","eprintln!","panic!","file!","format!","format_args!","include_bytes!","include_str!","line!","local_data_key!","module_path!","option_env!","print!","println!","select!","stringify!","try!","unimplemented!","unreachable!","vec!","write!","writeln!","macro_rules!","assert_ne!","debug_assert_ne!"],_=["i8","i16","i32","i64","i128","isize","u8","u16","u32","u64","u128","usize","f32","f64","str","char","bool","Box","Option","Result","String","Vec"];return{name:"Rust",aliases:["rs"],keywords:{$pattern:n.IDENT_RE+"!?",type:_,keyword:p,literal:c,built_in:d},illegal:"</",contains:[n.C_LINE_COMMENT_MODE,n.COMMENT("/\\*","\\*/",{contains:["self"]}),n.inherit(n.QUOTE_STRING_MODE,{begin:/b?"/,illegal:null}),{className:"string",variants:[{begin:/b?r(#*)"(.|\n)*?"\1(?!#)/},{begin:/b?'\\?(x\w{2}|u\w{4}|U\w{8}|.)'/}]},{className:"symbol",begin:/'[a-zA-Z_][a-zA-Z0-9_]*/},{className:"number",variants:[{begin:"\\b0b([01_]+)"+u},{begin:"\\b0o([0-7_]+)"+u},{begin:"\\b0x([A-Fa-f0-9_]+)"+u},{begin:"\\b(\\d[\\d_]*(\\.[0-9_]+)?([eE][+-]?[0-9_]+)?)"+u}],relevance:0},{begin:[/fn/,/\s+/,l],className:{1:"keyword",3:"title.function"}},{className:"meta",begin:"#!?\\[",end:"\\]",contains:[{className:"string",begin:/"/,end:/"/,contains:[n.BACKSLASH_ESCAPE]}]},{begin:[/let/,/\s+/,/(?:mut\s+)?/,l],className:{1:"keyword",3:"keyword",4:"variable"}},{begin:[/for/,/\s+/,l,/\s+/,/in/],className:{1:"keyword",3:"variable",5:"keyword"}},{begin:[/type/,/\s+/,l],className:{1:"keyword",3:"title.class"}},{begin:[/(?:trait|enum|struct|union|impl|for)/,/\s+/,l],className:{1:"keyword",3:"title.class"}},{begin:n.IDENT_RE+"::",keywords:{keyword:"Self",built_in:d,type:_}},{className:"punctuation",begin:"->"},m]}}return Jg=s,Jg}var Zg,ty;function gG(){if(ty)return Zg;ty=1;const s=c=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:c.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[c.APOS_STRING_MODE,c.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:c.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),n=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],i=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],o=[...n,...i],l=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),g=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),m=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),u=["accent-color","align-content","align-items","align-self","alignment-baseline","all","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-end-end-radius","border-end-start-radius","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","cx","cy","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","content-visibility","counter-increment","counter-reset","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","empty-cells","enable-background","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flow","flood-color","flood-opacity","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-smoothing","font-stretch","font-style","font-synthesis","font-variant","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","inline-size","inset","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","kerning","justify-content","justify-items","justify-self","left","letter-spacing","lighting-color","line-break","line-height","list-style","list-style-image","list-style-position","list-style-type","marker","marker-end","marker-mid","marker-start","mask","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","perspective","perspective-origin","pointer-events","position","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","scale","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","speak","speak-as","src","tab-size","table-layout","text-anchor","text-align","text-align-all","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-transform","text-underline-offset","text-underline-position","top","transform","transform-box","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","vector-effect","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index"].sort().reverse();function p(c){const d=s(c),_=m,b=g,$="@[a-z-]+",E="and or not only",f={className:"variable",begin:"(\\$[a-zA-Z-][a-zA-Z0-9_-]*)\\b",relevance:0};return{name:"SCSS",case_insensitive:true,illegal:"[=/|']",contains:[c.C_LINE_COMMENT_MODE,c.C_BLOCK_COMMENT_MODE,d.CSS_NUMBER_MODE,{className:"selector-id",begin:"#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},d.ATTRIBUTE_SELECTOR_MODE,{className:"selector-tag",begin:"\\b("+o.join("|")+")\\b",relevance:0},{className:"selector-pseudo",begin:":("+b.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+_.join("|")+")"},f,{begin:/\(/,end:/\)/,contains:[d.CSS_NUMBER_MODE]},d.CSS_VARIABLE,{className:"attribute",begin:"\\b("+u.join("|")+")\\b"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:/:/,end:/[;}{]/,relevance:0,contains:[d.BLOCK_COMMENT,f,d.HEXCOLOR,d.CSS_NUMBER_MODE,c.QUOTE_STRING_MODE,c.APOS_STRING_MODE,d.IMPORTANT,d.FUNCTION_DISPATCH]},{begin:"@(page|font-face)",keywords:{$pattern:$,keyword:"@page @font-face"}},{begin:"@",end:"[{;]",returnBegin:true,keywords:{$pattern:/[a-z-]+/,keyword:E,attribute:l.join(" ")},contains:[{begin:$,className:"keyword"},{begin:/[a-z-]+(?=:)/,className:"attribute"},f,c.QUOTE_STRING_MODE,c.APOS_STRING_MODE,d.HEXCOLOR,d.CSS_NUMBER_MODE]},d.FUNCTION_DISPATCH]}}return Zg=p,Zg}var Qg,sy;function fG(){if(sy)return Qg;sy=1;function s(n){return{name:"Shell Session",aliases:["console","shellsession"],contains:[{className:"meta.prompt",begin:/^\s{0,3}[/~\w\d[\]()@-]*[>%$#][ ]?/,starts:{end:/[^\\](?=\s*$)/,subLanguage:"bash"}}]}}return Qg=s,Qg}var ef,iy;function mG(){if(iy)return ef;iy=1;function s(n){const i=n.regex,o=n.COMMENT("--","$"),l={className:"string",variants:[{begin:/'/,end:/'/,contains:[{begin:/''/}]}]},g={begin:/"/,end:/"/,contains:[{begin:/""/}]},m=["true","false","unknown"],u=["double precision","large object","with timezone","without timezone"],p=["bigint","binary","blob","boolean","char","character","clob","date","dec","decfloat","decimal","float","int","integer","interval","nchar","nclob","national","numeric","real","row","smallint","time","timestamp","varchar","varying","varbinary"],c=["add","asc","collation","desc","final","first","last","view"],d=["abs","acos","all","allocate","alter","and","any","are","array","array_agg","array_max_cardinality","as","asensitive","asin","asymmetric","at","atan","atomic","authorization","avg","begin","begin_frame","begin_partition","between","bigint","binary","blob","boolean","both","by","call","called","cardinality","cascaded","case","cast","ceil","ceiling","char","char_length","character","character_length","check","classifier","clob","close","coalesce","collate","collect","column","commit","condition","connect","constraint","contains","convert","copy","corr","corresponding","cos","cosh","count","covar_pop","covar_samp","create","cross","cube","cume_dist","current","current_catalog","current_date","current_default_transform_group","current_path","current_role","current_row","current_schema","current_time","current_timestamp","current_path","current_role","current_transform_group_for_type","current_user","cursor","cycle","date","day","deallocate","dec","decimal","decfloat","declare","default","define","delete","dense_rank","deref","describe","deterministic","disconnect","distinct","double","drop","dynamic","each","element","else","empty","end","end_frame","end_partition","end-exec","equals","escape","every","except","exec","execute","exists","exp","external","extract","false","fetch","filter","first_value","float","floor","for","foreign","frame_row","free","from","full","function","fusion","get","global","grant","group","grouping","groups","having","hold","hour","identity","in","indicator","initial","inner","inout","insensitive","insert","int","integer","intersect","intersection","interval","into","is","join","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","language","large","last_value","lateral","lead","leading","left","like","like_regex","listagg","ln","local","localtime","localtimestamp","log","log10","lower","match","match_number","match_recognize","matches","max","member","merge","method","min","minute","mod","modifies","module","month","multiset","national","natural","nchar","nclob","new","no","none","normalize","not","nth_value","ntile","null","nullif","numeric","octet_length","occurrences_regex","of","offset","old","omit","on","one","only","open","or","order","out","outer","over","overlaps","overlay","parameter","partition","pattern","per","percent","percent_rank","percentile_cont","percentile_disc","period","portion","position","position_regex","power","precedes","precision","prepare","primary","procedure","ptf","range","rank","reads","real","recursive","ref","references","referencing","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","release","result","return","returns","revoke","right","rollback","rollup","row","row_number","rows","running","savepoint","scope","scroll","search","second","seek","select","sensitive","session_user","set","show","similar","sin","sinh","skip","smallint","some","specific","specifictype","sql","sqlexception","sqlstate","sqlwarning","sqrt","start","static","stddev_pop","stddev_samp","submultiset","subset","substring","substring_regex","succeeds","sum","symmetric","system","system_time","system_user","table","tablesample","tan","tanh","then","time","timestamp","timezone_hour","timezone_minute","to","trailing","translate","translate_regex","translation","treat","trigger","trim","trim_array","true","truncate","uescape","union","unique","unknown","unnest","update","upper","user","using","value","values","value_of","var_pop","var_samp","varbinary","varchar","varying","versioning","when","whenever","where","width_bucket","window","with","within","without","year"],_=["abs","acos","array_agg","asin","atan","avg","cast","ceil","ceiling","coalesce","corr","cos","cosh","count","covar_pop","covar_samp","cume_dist","dense_rank","deref","element","exp","extract","first_value","floor","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","last_value","lead","listagg","ln","log","log10","lower","max","min","mod","nth_value","ntile","nullif","percent_rank","percentile_cont","percentile_disc","position","position_regex","power","rank","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","row_number","sin","sinh","sqrt","stddev_pop","stddev_samp","substring","substring_regex","sum","tan","tanh","translate","translate_regex","treat","trim","trim_array","unnest","upper","value_of","var_pop","var_samp","width_bucket"],b=["current_catalog","current_date","current_default_transform_group","current_path","current_role","current_schema","current_transform_group_for_type","current_user","session_user","system_time","system_user","current_time","localtime","current_timestamp","localtimestamp"],$=["create table","insert into","primary key","foreign key","not null","alter table","add constraint","grouping sets","on overflow","character set","respect nulls","ignore nulls","nulls first","nulls last","depth first","breadth first"],E=_,y=[...d,...c].filter(R=>!_.includes(R)),f={className:"variable",begin:/@[a-z0-9][a-z0-9_]*/},v={className:"operator",begin:/[-+*/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?/,relevance:0},T={begin:i.concat(/\b/,i.either(...E),/\s*\(/),relevance:0,keywords:{built_in:E}};function S(R,{exceptions:O,when:A}={}){const L=A;return O=O||[],R.map(I=>I.match(/\|\d+$/)||O.includes(I)?I:L(I)?`${I}|0`:I)}return{name:"SQL",case_insensitive:true,illegal:/[{}]|<\//,keywords:{$pattern:/\b[\w\.]+/,keyword:S(y,{when:R=>R.length<3}),literal:m,type:p,built_in:b},contains:[{begin:i.either(...$),relevance:0,keywords:{$pattern:/[\w\.]+/,keyword:y.concat($),literal:m,type:p}},{className:"type",begin:i.either(...u)},T,f,l,g,n.C_NUMBER_MODE,n.C_BLOCK_COMMENT_MODE,o,v]}}return ef=s,ef}var tf,ny;function EG(){if(ny)return tf;ny=1;function s(I){return I?typeof I=="string"?I:I.source:null}function n(I){return i("(?=",I,")")}function i(...I){return I.map(B=>s(B)).join("")}function o(I){const k=I[I.length-1];return typeof k=="object"&&k.constructor===Object?(I.splice(I.length-1,1),k):{}}function l(...I){return"("+(o(I).capture?"":"?:")+I.map(U=>s(U)).join("|")+")"}const g=I=>i(/\b/,I,/\w$/.test(I)?/\b/:/\B/),m=["Protocol","Type"].map(g),u=["init","self"].map(g),p=["Any","Self"],c=["actor","any","associatedtype","async","await",/as\?/,/as!/,"as","borrowing","break","case","catch","class","consume","consuming","continue","convenience","copy","default","defer","deinit","didSet","distributed","do","dynamic","each","else","enum","extension","fallthrough",/fileprivate\(set\)/,"fileprivate","final","for","func","get","guard","if","import","indirect","infix",/init\?/,/init!/,"inout",/internal\(set\)/,"internal","in","is","isolated","nonisolated","lazy","let","macro","mutating","nonmutating",/open\(set\)/,"open","operator","optional","override","package","postfix","precedencegroup","prefix",/private\(set\)/,"private","protocol",/public\(set\)/,"public","repeat","required","rethrows","return","set","some","static","struct","subscript","super","switch","throws","throw",/try\?/,/try!/,"try","typealias",/unowned\(safe\)/,/unowned\(unsafe\)/,"unowned","var","weak","where","while","willSet"],d=["false","nil","true"],_=["assignment","associativity","higherThan","left","lowerThan","none","right"],b=["#colorLiteral","#column","#dsohandle","#else","#elseif","#endif","#error","#file","#fileID","#fileLiteral","#filePath","#function","#if","#imageLiteral","#keyPath","#line","#selector","#sourceLocation","#warning"],$=["abs","all","any","assert","assertionFailure","debugPrint","dump","fatalError","getVaList","isKnownUniquelyReferenced","max","min","numericCast","pointwiseMax","pointwiseMin","precondition","preconditionFailure","print","readLine","repeatElement","sequence","stride","swap","swift_unboxFromSwiftValueWithType","transcode","type","unsafeBitCast","unsafeDowncast","withExtendedLifetime","withUnsafeMutablePointer","withUnsafePointer","withVaList","withoutActuallyEscaping","zip"],E=l(/[/=\-+!*%<>&|^~?]/,/[\u00A1-\u00A7]/,/[\u00A9\u00AB]/,/[\u00AC\u00AE]/,/[\u00B0\u00B1]/,/[\u00B6\u00BB\u00BF\u00D7\u00F7]/,/[\u2016-\u2017]/,/[\u2020-\u2027]/,/[\u2030-\u203E]/,/[\u2041-\u2053]/,/[\u2055-\u205E]/,/[\u2190-\u23FF]/,/[\u2500-\u2775]/,/[\u2794-\u2BFF]/,/[\u2E00-\u2E7F]/,/[\u3001-\u3003]/,/[\u3008-\u3020]/,/[\u3030]/),y=l(E,/[\u0300-\u036F]/,/[\u1DC0-\u1DFF]/,/[\u20D0-\u20FF]/,/[\uFE00-\uFE0F]/,/[\uFE20-\uFE2F]/),f=i(E,y,"*"),v=l(/[a-zA-Z_]/,/[\u00A8\u00AA\u00AD\u00AF\u00B2-\u00B5\u00B7-\u00BA]/,/[\u00BC-\u00BE\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF]/,/[\u0100-\u02FF\u0370-\u167F\u1681-\u180D\u180F-\u1DBF]/,/[\u1E00-\u1FFF]/,/[\u200B-\u200D\u202A-\u202E\u203F-\u2040\u2054\u2060-\u206F]/,/[\u2070-\u20CF\u2100-\u218F\u2460-\u24FF\u2776-\u2793]/,/[\u2C00-\u2DFF\u2E80-\u2FFF]/,/[\u3004-\u3007\u3021-\u302F\u3031-\u303F\u3040-\uD7FF]/,/[\uF900-\uFD3D\uFD40-\uFDCF\uFDF0-\uFE1F\uFE30-\uFE44]/,/[\uFE47-\uFEFE\uFF00-\uFFFD]/),T=l(v,/\d/,/[\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]/),S=i(v,T,"*"),R=i(/[A-Z]/,T,"*"),O=["attached","autoclosure",i(/convention\(/,l("swift","block","c"),/\)/),"discardableResult","dynamicCallable","dynamicMemberLookup","escaping","freestanding","frozen","GKInspectable","IBAction","IBDesignable","IBInspectable","IBOutlet","IBSegueAction","inlinable","main","nonobjc","NSApplicationMain","NSCopying","NSManaged",i(/objc\(/,S,/\)/),"objc","objcMembers","propertyWrapper","requires_stored_property_inits","resultBuilder","Sendable","testable","UIApplicationMain","unchecked","unknown","usableFromInline","warn_unqualified_access"],A=["iOS","iOSApplicationExtension","macOS","macOSApplicationExtension","macCatalyst","macCatalystApplicationExtension","watchOS","watchOSApplicationExtension","tvOS","tvOSApplicationExtension","swift"];function L(I){const k={match:/\s+/,relevance:0},B=I.COMMENT("/\\*","\\*/",{contains:["self"]}),U=[I.C_LINE_COMMENT_MODE,B],P={match:[/\./,l(...m,...u)],className:{2:"keyword"}},z={match:i(/\./,l(...c)),relevance:0},W=c.filter(ie=>typeof ie=="string").concat(["_|0"]),j=c.filter(ie=>typeof ie!="string").concat(p).map(g),K={variants:[{className:"keyword",match:l(...j,...u)}]},ee={$pattern:l(/\b\w+/,/#\w+/),keyword:W.concat(b),literal:d},M=[P,z,K],F={match:i(/\./,l(...$)),relevance:0},V={className:"built_in",match:i(/\b/,l(...$),/(?=\()/)},X=[F,V],H={match:/->/,relevance:0},ne={className:"operator",relevance:0,variants:[{match:f},{match:`\\.(\\.|${y})+`}]},Ie=[H,ne],de="([0-9]_*)+",ot="([0-9a-fA-F]_*)+",x={className:"number",relevance:0,variants:[{match:`\\b(${de})(\\.(${de}))?([eE][+-]?(${de}))?\\b`},{match:`\\b0x(${ot})(\\.(${ot}))?([pP][+-]?(${de}))?\\b`},{match:/\b0o([0-7]_*)+\b/},{match:/\b0b([01]_*)+\b/}]},te=(ie="")=>({className:"subst",variants:[{match:i(/\\/,ie,/[0\\tnr"']/)},{match:i(/\\/,ie,/u\{[0-9a-fA-F]{1,8}\}/)}]}),ce=(ie="")=>({className:"subst",match:i(/\\/,ie,/[\t ]*(?:[\r\n]|\r\n)/)}),ae=(ie="")=>({className:"subst",label:"interpol",begin:i(/\\/,ie,/\(/),end:/\)/}),De=(ie="")=>({begin:i(ie,/"""/),end:i(/"""/,ie),contains:[te(ie),ce(ie),ae(ie)]}),$e=(ie="")=>({begin:i(ie,/"/),end:i(/"/,ie),contains:[te(ie),ae(ie)]}),st={className:"string",variants:[De(),De("#"),De("##"),De("###"),$e(),$e("#"),$e("##"),$e("###")]},bt=[I.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[I.BACKSLASH_ESCAPE]}],Ut={begin:/\/[^\s](?=[^/\n]*\/)/,end:/\//,contains:bt},jt=ie=>{const le=i(ie,/\//),at=i(/\//,ie);return{begin:le,end:at,contains:[...bt,{scope:"comment",begin:`#(?!.*${at})`,end:/$/}]}},Ve={scope:"regexp",variants:[jt("###"),jt("##"),jt("#"),Ut]},Ss={match:i(/`/,S,/`/)},Cs={className:"variable",match:/\$\d+/},Os={className:"variable",match:`\\$${T}+`},zs=[Ss,Cs,Os],xs={match:/(@|#(un)?)available/,scope:"keyword",starts:{contains:[{begin:/\(/,end:/\)/,keywords:A,contains:[...Ie,x,st]}]}},kt={scope:"keyword",match:i(/@/,l(...O),n(l(/\(/,/\s+/)))},ts={scope:"meta",match:i(/@/,S)},me=[xs,kt,ts],He={match:n(/\b[A-Z]/),relevance:0,contains:[{className:"type",match:i(/(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)/,T,"+")},{className:"type",match:R,relevance:0},{match:/[?!]+/,relevance:0},{match:/\.\.\./,relevance:0},{match:i(/\s+&\s+/,n(R)),relevance:0}]},Dt={begin:/</,end:/>/,keywords:ee,contains:[...U,...M,...me,H,He]};He.contains.push(Dt);const ve={match:i(S,/\s*:/),keywords:"_|0",relevance:0},Bs={begin:/\(/,end:/\)/,relevance:0,keywords:ee,contains:["self",ve,...U,Ve,...M,...X,...Ie,x,st,...zs,...me,He]},vs={begin:/</,end:/>/,keywords:"repeat each",contains:[...U,He]},ks={begin:l(n(i(S,/\s*:/)),n(i(S,/\s+/,S,/\s*:/))),end:/:/,relevance:0,contains:[{className:"keyword",match:/\b_\b/},{className:"params",match:S}]},Rt={begin:/\(/,end:/\)/,keywords:ee,contains:[ks,...U,...M,...Ie,x,st,...me,He,Bs],endsParent:true,illegal:/["']/},Li={match:[/(func|macro)/,/\s+/,l(Ss.match,S,f)],className:{1:"keyword",3:"title.function"},contains:[vs,Rt,k],illegal:[/\[/,/%/]},as={match:[/\b(?:subscript|init[?!]?)/,/\s*(?=[<(])/],className:{1:"keyword"},contains:[vs,Rt,k],illegal:/\[|%/},N={match:[/operator/,/\s+/,f],className:{1:"keyword",3:"title"}},G={begin:[/precedencegroup/,/\s+/,R],className:{1:"keyword",3:"title"},contains:[He],keywords:[..._,...d],end:/}/},J={begin:[/(struct|protocol|class|extension|enum|actor)/,/\s+/,S,/\s*/],beginScope:{1:"keyword",3:"title.class"},keywords:ee,contains:[vs,...M,{begin:/:/,end:/\{/,keywords:ee,contains:[{scope:"title.class.inherited",match:R},...M],relevance:0}]};for(const ie of st.variants){const le=ie.contains.find(Xi=>Xi.label==="interpol");le.keywords=ee;const at=[...M,...X,...Ie,x,st,...zs];le.contains=[...at,{begin:/\(/,end:/\)/,contains:["self",...at]}]}return{name:"Swift",keywords:ee,contains:[...U,Li,as,J,N,G,{beginKeywords:"import",end:/$/,contains:[...U],relevance:0},Ve,...M,...X,...Ie,x,st,...zs,...me,He,Bs]}}return tf=L,tf}var sf,ry;function vG(){if(ry)return sf;ry=1;function s(n){const i="true false yes no null",o="[\\w#;/?:@&=+$,.~*'()[\\]]+",l={className:"attr",variants:[{begin:/\w[\w :()\./-]*:(?=[ \t]|$)/},{begin:/"\w[\w :()\./-]*":(?=[ \t]|$)/},{begin:/'\w[\w :()\./-]*':(?=[ \t]|$)/}]},g={className:"template-variable",variants:[{begin:/\{\{/,end:/\}\}/},{begin:/%\{/,end:/\}/}]},m={className:"string",relevance:0,variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/\S+/}],contains:[n.BACKSLASH_ESCAPE,g]},u=n.inherit(m,{variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/[^\s,{}[\]]+/}]}),p="[0-9]{4}(-[0-9][0-9]){0,2}",c="([Tt \\t][0-9][0-9]?(:[0-9][0-9]){2})?",d="(\\.[0-9]*)?",_="([ \\t])*(Z|[-+][0-9][0-9]?(:[0-9][0-9])?)?",b={className:"number",begin:"\\b"+p+c+d+_+"\\b"},$={end:",",endsWithParent:true,excludeEnd:true,keywords:i,relevance:0},E={begin:/\{/,end:/\}/,contains:[$],illegal:"\\n",relevance:0},y={begin:"\\[",end:"\\]",contains:[$],illegal:"\\n",relevance:0},f=[l,{className:"meta",begin:"^---\\s*$",relevance:10},{className:"string",begin:"[\\|>]([1-9]?[+-])?[ ]*\\n( +)[^ ][^\\n]*\\n(\\2[^\\n]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:true,excludeEnd:true,relevance:0},{className:"type",begin:"!\\w+!"+o},{className:"type",begin:"!<"+o+">"},{className:"type",begin:"!"+o},{className:"type",begin:"!!"+o},{className:"meta",begin:"&"+n.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+n.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"-(?=[ ]|$)",relevance:0},n.HASH_COMMENT_MODE,{beginKeywords:i,keywords:{literal:i}},b,{className:"number",begin:n.C_NUMBER_RE+"\\b",relevance:0},E,y,m],v=[...f];return v.pop(),v.push(u),$.contains=v,{name:"YAML",case_insensitive:true,aliases:["yml"],contains:f}}return sf=s,sf}var nf,oy;function bG(){if(oy)return nf;oy=1;const s="[A-Za-z$_][0-9A-Za-z$_]*",n=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends"],i=["true","false","null","undefined","NaN","Infinity"],o=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],l=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],g=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],m=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],u=[].concat(g,o,l);function p(d){const _=d.regex,b=(te,{after:ce})=>{const ae="</"+te[0].slice(1);return te.input.indexOf(ae,ce)!==-1},$=s,E={begin:"<>",end:"</>"},y=/<[A-Za-z0-9\\._:-]+\s*\/>/,f={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(te,ce)=>{const ae=te[0].length+te.index,De=te.input[ae];if(De==="<"||De===","){ce.ignoreMatch();return}De===">"&&(b(te,{after:ae})||ce.ignoreMatch());let $e;const st=te.input.substring(ae);if($e=st.match(/^\s*=/)){ce.ignoreMatch();return}if(($e=st.match(/^\s+extends\s+/))&&$e.index===0){ce.ignoreMatch();return}}},v={$pattern:s,keyword:n,literal:i,built_in:u,"variable.language":m},T="[0-9](_?[0-9])*",S=`\\.(${T})`,R="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",O={className:"number",variants:[{begin:`(\\b(${R})((${S})|\\.)?|(${S}))[eE][+-]?(${T})\\b`},{begin:`\\b(${R})\\b((${S})\\b|\\.)?|(${S})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},A={className:"subst",begin:"\\$\\{",end:"\\}",keywords:v,contains:[]},L={begin:".?html`",end:"",starts:{end:"`",returnEnd:false,contains:[d.BACKSLASH_ESCAPE,A],subLanguage:"xml"}},I={begin:".?css`",end:"",starts:{end:"`",returnEnd:false,contains:[d.BACKSLASH_ESCAPE,A],subLanguage:"css"}},k={begin:".?gql`",end:"",starts:{end:"`",returnEnd:false,contains:[d.BACKSLASH_ESCAPE,A],subLanguage:"graphql"}},B={className:"string",begin:"`",end:"`",contains:[d.BACKSLASH_ESCAPE,A]},P={className:"comment",variants:[d.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:true,excludeBegin:true,relevance:0},{className:"variable",begin:$+"(?=\\s*(-)|$)",endsParent:true,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),d.C_BLOCK_COMMENT_MODE,d.C_LINE_COMMENT_MODE]},z=[d.APOS_STRING_MODE,d.QUOTE_STRING_MODE,L,I,k,B,{match:/\$\d+/},O];A.contains=z.concat({begin:/\{/,end:/\}/,keywords:v,contains:["self"].concat(z)});const W=[].concat(P,A.contains),j=W.concat([{begin:/(\s*)\(/,end:/\)/,keywords:v,contains:["self"].concat(W)}]),K={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:v,contains:j},ee={variants:[{match:[/class/,/\s+/,$,/\s+/,/extends/,/\s+/,_.concat($,"(",_.concat(/\./,$),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,$],scope:{1:"keyword",3:"title.class"}}]},M={relevance:0,match:_.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...o,...l]}},F={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},V={variants:[{match:[/function/,/\s+/,$,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[K],illegal:/%/},X={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function H(te){return _.concat("(?!",te.join("|"),")")}const ne={match:_.concat(/\b/,H([...g,"super","import"].map(te=>`${te}\\s*\\(`)),$,_.lookahead(/\s*\(/)),className:"title.function",relevance:0},Ie={begin:_.concat(/\./,_.lookahead(_.concat($,/(?![0-9A-Za-z$_(])/))),end:$,excludeBegin:true,keywords:"prototype",className:"property",relevance:0},de={match:[/get|set/,/\s+/,$,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},K]},ot="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+d.UNDERSCORE_IDENT_RE+")\\s*=>",x={match:[/const|var|let/,/\s+/,$,/\s*/,/=\s*/,/(async\s*)?/,_.lookahead(ot)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[K]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:v,exports:{PARAMS_CONTAINS:j,CLASS_REFERENCE:M},illegal:/#(?![$_A-z])/,contains:[d.SHEBANG({label:"shebang",binary:"node",relevance:5}),F,d.APOS_STRING_MODE,d.QUOTE_STRING_MODE,L,I,k,B,P,{match:/\$\d+/},O,M,{className:"attr",begin:$+_.lookahead(":"),relevance:0},x,{begin:"("+d.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[P,d.REGEXP_MODE,{className:"function",begin:ot,returnBegin:true,end:"\\s*=>",contains:[{className:"params",variants:[{begin:d.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:true},{begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:v,contains:j}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:E.begin,end:E.end},{match:y},{begin:f.begin,"on:begin":f.isTrulyOpeningTag,end:f.end}],subLanguage:"xml",contains:[{begin:f.begin,end:f.end,skip:true,contains:["self"]}]}]},V,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+d.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:true,label:"func.def",contains:[K,d.inherit(d.TITLE_MODE,{begin:$,className:"title.function"})]},{match:/\.\.\./,relevance:0},Ie,{match:"\\$"+$,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[K]},ne,X,ee,de,{match:/\$[(.]/}]}}function c(d){const _=p(d),b=s,$=["any","void","number","boolean","string","object","never","symbol","bigint","unknown"],E={begin:[/namespace/,/\s+/,d.IDENT_RE],beginScope:{1:"keyword",3:"title.class"}},y={beginKeywords:"interface",end:/\{/,excludeEnd:true,keywords:{keyword:"interface extends",built_in:$},contains:[_.exports.CLASS_REFERENCE]},f={className:"meta",relevance:10,begin:/^\s*['"]use strict['"]/},v=["type","interface","public","private","protected","implements","declare","abstract","readonly","enum","override","satisfies"],T={$pattern:s,keyword:n.concat(v),literal:i,built_in:u.concat($),"variable.language":m},S={className:"meta",begin:"@"+b},R=(L,I,k)=>{const B=L.contains.findIndex(U=>U.label===I);if(B===-1)throw new Error("can not find mode to replace");L.contains.splice(B,1,k)};Object.assign(_.keywords,T),_.exports.PARAMS_CONTAINS.push(S);const O=_.contains.find(L=>L.className==="attr");_.exports.PARAMS_CONTAINS.push([_.exports.CLASS_REFERENCE,O]),_.contains=_.contains.concat([S,E,y]),R(_,"shebang",d.SHEBANG()),R(_,"use_strict",f);const A=_.contains.find(L=>L.label==="func.def");return A.relevance=0,Object.assign(_,{name:"TypeScript",aliases:["ts","tsx","mts","cts"]}),_}return nf=c,nf}var rf,ay;function TG(){if(ay)return rf;ay=1;function s(n){const i=n.regex,o={className:"string",begin:/"(""|[^/n])"C\b/},l={className:"string",begin:/"/,end:/"/,illegal:/\n/,contains:[{begin:/""/}]},g=/\d{1,2}\/\d{1,2}\/\d{4}/,m=/\d{4}-\d{1,2}-\d{1,2}/,u=/(\d|1[012])(:\d+){0,2} *(AM|PM)/,p=/\d{1,2}(:\d{1,2}){1,2}/,c={className:"literal",variants:[{begin:i.concat(/# */,i.either(m,g),/ *#/)},{begin:i.concat(/# */,p,/ *#/)},{begin:i.concat(/# */,u,/ *#/)},{begin:i.concat(/# */,i.either(m,g),/ +/,i.either(u,p),/ *#/)}]},d={className:"number",relevance:0,variants:[{begin:/\b\d[\d_]*((\.[\d_]+(E[+-]?[\d_]+)?)|(E[+-]?[\d_]+))[RFD@!#]?/},{begin:/\b\d[\d_]*((U?[SIL])|[%&])?/},{begin:/&H[\dA-F_]+((U?[SIL])|[%&])?/},{begin:/&O[0-7_]+((U?[SIL])|[%&])?/},{begin:/&B[01_]+((U?[SIL])|[%&])?/}]},_={className:"label",begin:/^\w+:/},b=n.COMMENT(/'''/,/$/,{contains:[{className:"doctag",begin:/<\/?/,end:/>/}]}),$=n.COMMENT(null,/$/,{variants:[{begin:/'/},{begin:/([\t ]|^)REM(?=\s)/}]});return{name:"Visual Basic .NET",aliases:["vb"],case_insensitive:true,classNameAliases:{label:"symbol"},keywords:{keyword:"addhandler alias aggregate ansi as async assembly auto binary by byref byval call case catch class compare const continue custom declare default delegate dim distinct do each equals else elseif end enum erase error event exit explicit finally for friend from function get global goto group handles if implements imports in inherits interface into iterator join key let lib loop me mid module mustinherit mustoverride mybase myclass namespace narrowing new next notinheritable notoverridable of off on operator option optional order overloads overridable overrides paramarray partial preserve private property protected public raiseevent readonly redim removehandler resume return select set shadows shared skip static step stop structure strict sub synclock take text then throw to try unicode until using when where while widening with withevents writeonly yield",built_in:"addressof and andalso await directcast gettype getxmlnamespace is isfalse isnot istrue like mod nameof new not or orelse trycast typeof xor cbool cbyte cchar cdate cdbl cdec cint clng cobj csbyte cshort csng cstr cuint culng cushort",type:"boolean byte char date decimal double integer long object sbyte short single string uinteger ulong ushort",literal:"true false nothing"},illegal:"//|\\{|\\}|endif|gosub|variant|wend|^\\$ ",contains:[o,l,c,d,_,b,$,{className:"meta",begin:/[\t ]*#(const|disable|else|elseif|enable|end|externalsource|if|region)\b/,end:/$/,keywords:{keyword:"const disable else elseif enable end externalsource if region then"},contains:[$]}]}}return rf=s,rf}var of,ly;function SG(){if(ly)return of;ly=1;function s(n){n.regex;const i=n.COMMENT(/\(;/,/;\)/);i.contains.push("self");const o=n.COMMENT(/;;/,/$/),l=["anyfunc","block","br","br_if","br_table","call","call_indirect","data","drop","elem","else","end","export","func","global.get","global.set","local.get","local.set","local.tee","get_global","get_local","global","if","import","local","loop","memory","memory.grow","memory.size","module","mut","nop","offset","param","result","return","select","set_global","set_local","start","table","tee_local","then","type","unreachable"],g={begin:[/(?:func|call|call_indirect)/,/\s+/,/\$[^\s)]+/],className:{1:"keyword",3:"title.function"}},m={className:"variable",begin:/\$[\w_]+/},u={match:/(\((?!;)|\))+/,className:"punctuation",relevance:0},p={className:"number",relevance:0,match:/[+-]?\b(?:\d(?:_?\d)*(?:\.\d(?:_?\d)*)?(?:[eE][+-]?\d(?:_?\d)*)?|0x[\da-fA-F](?:_?[\da-fA-F])*(?:\.[\da-fA-F](?:_?[\da-fA-D])*)?(?:[pP][+-]?\d(?:_?\d)*)?)\b|\binf\b|\bnan(?::0x[\da-fA-F](?:_?[\da-fA-D])*)?\b/},c={match:/(i32|i64|f32|f64)(?!\.)/,className:"type"},d={className:"keyword",match:/\b(f32|f64|i32|i64)(?:\.(?:abs|add|and|ceil|clz|const|convert_[su]\/i(?:32|64)|copysign|ctz|demote\/f64|div(?:_[su])?|eqz?|extend_[su]\/i32|floor|ge(?:_[su])?|gt(?:_[su])?|le(?:_[su])?|load(?:(?:8|16|32)_[su])?|lt(?:_[su])?|max|min|mul|nearest|neg?|or|popcnt|promote\/f32|reinterpret\/[fi](?:32|64)|rem_[su]|rot[lr]|shl|shr_[su]|store(?:8|16|32)?|sqrt|sub|trunc(?:_[su]\/f(?:32|64))?|wrap\/i64|xor))\b/};return{name:"WebAssembly",keywords:{$pattern:/[\w.]+/,keyword:l},contains:[o,i,{match:[/(?:offset|align)/,/\s*/,/=/],className:{1:"keyword",3:"operator"}},m,u,g,n.QUOTE_STRING_MODE,c,d,p]}}return of=s,of}var af,cy;function $G(){if(cy)return af;cy=1;var s=ER();return s.registerLanguage("xml",GF()),s.registerLanguage("bash",HF()),s.registerLanguage("c",VF()),s.registerLanguage("cpp",WF()),s.registerLanguage("csharp",zF()),s.registerLanguage("css",jF()),s.registerLanguage("markdown",XF()),s.registerLanguage("diff",KF()),s.registerLanguage("ruby",YF()),s.registerLanguage("go",qF()),s.registerLanguage("graphql",JF()),s.registerLanguage("ini",ZF()),s.registerLanguage("java",QF()),s.registerLanguage("javascript",eG()),s.registerLanguage("json",tG()),s.registerLanguage("kotlin",sG()),s.registerLanguage("less",iG()),s.registerLanguage("lua",nG()),s.registerLanguage("makefile",rG()),s.registerLanguage("perl",oG()),s.registerLanguage("objectivec",aG()),s.registerLanguage("php",lG()),s.registerLanguage("php-template",cG()),s.registerLanguage("plaintext",uG()),s.registerLanguage("python",hG()),s.registerLanguage("python-repl",dG()),s.registerLanguage("r",_G()),s.registerLanguage("rust",pG()),s.registerLanguage("scss",gG()),s.registerLanguage("shell",fG()),s.registerLanguage("sql",mG()),s.registerLanguage("swift",EG()),s.registerLanguage("yaml",vG()),s.registerLanguage("typescript",bG()),s.registerLanguage("vbnet",TG()),s.registerLanguage("wasm",SG()),s.HighlightJS=s,s.default=s,af=s,af}var yG=$G();const RG=em(yG),uy="[A-Za-z$_][0-9A-Za-z$_]*",IG=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends"],CG=["true","false","null","undefined","NaN","Infinity"],vR=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],bR=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],TR=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],OG=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],kG=[].concat(TR,vR,bR);function wG(s){const n=s.regex,i=(M,{after:F})=>{const V="</"+M[0].slice(1);return M.input.indexOf(V,F)!==-1},o=uy,l={begin:"<>",end:"</>"},g=/<[A-Za-z0-9\\._:-]+\s*\/>/,m={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(M,F)=>{const V=M[0].length+M.index,X=M.input[V];if(X==="<"||X===","){F.ignoreMatch();return}X===">"&&(i(M,{after:V})||F.ignoreMatch());let H;const ne=M.input.substring(V);if(H=ne.match(/^\s*=/)){F.ignoreMatch();return}if((H=ne.match(/^\s+extends\s+/))&&H.index===0){F.ignoreMatch();return}}},u={$pattern:uy,keyword:IG,literal:CG,built_in:kG,"variable.language":OG},p="[0-9](_?[0-9])*",c=`\\.(${p})`,d="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",_={className:"number",variants:[{begin:`(\\b(${d})((${c})|\\.)?|(${c}))[eE][+-]?(${p})\\b`},{begin:`\\b(${d})\\b((${c})\\b|\\.)?|(${c})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},b={className:"subst",begin:"\\$\\{",end:"\\}",keywords:u,contains:[]},$={begin:".?html`",end:"",starts:{end:"`",returnEnd:false,contains:[s.BACKSLASH_ESCAPE,b],subLanguage:"xml"}},E={begin:".?css`",end:"",starts:{end:"`",returnEnd:false,contains:[s.BACKSLASH_ESCAPE,b],subLanguage:"css"}},y={begin:".?gql`",end:"",starts:{end:"`",returnEnd:false,contains:[s.BACKSLASH_ESCAPE,b],subLanguage:"graphql"}},f={className:"string",begin:"`",end:"`",contains:[s.BACKSLASH_ESCAPE,b]},T={className:"comment",variants:[s.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:true,excludeBegin:true,relevance:0},{className:"variable",begin:o+"(?=\\s*(-)|$)",endsParent:true,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),s.C_BLOCK_COMMENT_MODE,s.C_LINE_COMMENT_MODE]},S=[s.APOS_STRING_MODE,s.QUOTE_STRING_MODE,$,E,y,f,{match:/\$\d+/},_];b.contains=S.concat({begin:/\{/,end:/\}/,keywords:u,contains:["self"].concat(S)});const R=[].concat(T,b.contains),O=R.concat([{begin:/(\s*)\(/,end:/\)/,keywords:u,contains:["self"].concat(R)}]),A={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:u,contains:O},L={variants:[{match:[/class/,/\s+/,o,/\s+/,/extends/,/\s+/,n.concat(o,"(",n.concat(/\./,o),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,o],scope:{1:"keyword",3:"title.class"}}]},I={relevance:0,match:n.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...vR,...bR]}},k={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},B={variants:[{match:[/function/,/\s+/,o,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[A],illegal:/%/},U={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function P(M){return n.concat("(?!",M.join("|"),")")}const z={match:n.concat(/\b/,P([...TR,"super","import"].map(M=>`${M}\\s*\\(`)),o,n.lookahead(/\s*\(/)),className:"title.function",relevance:0},W={begin:n.concat(/\./,n.lookahead(n.concat(o,/(?![0-9A-Za-z$_(])/))),end:o,excludeBegin:true,keywords:"prototype",className:"property",relevance:0},j={match:[/get|set/,/\s+/,o,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},A]},K="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+s.UNDERSCORE_IDENT_RE+")\\s*=>",ee={match:[/const|var|let/,/\s+/,o,/\s*/,/=\s*/,/(async\s*)?/,n.lookahead(K)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[A]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:u,exports:{PARAMS_CONTAINS:O,CLASS_REFERENCE:I},illegal:/#(?![$_A-z])/,contains:[s.SHEBANG({label:"shebang",binary:"node",relevance:5}),k,s.APOS_STRING_MODE,s.QUOTE_STRING_MODE,$,E,y,f,T,{match:/\$\d+/},_,I,{className:"attr",begin:o+n.lookahead(":"),relevance:0},ee,{begin:"("+s.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[T,s.REGEXP_MODE,{className:"function",begin:K,returnBegin:true,end:"\\s*=>",contains:[{className:"params",variants:[{begin:s.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:true},{begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:u,contains:O}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:l.begin,end:l.end},{match:g},{begin:m.begin,"on:begin":m.isTrulyOpeningTag,end:m.end}],subLanguage:"xml",contains:[{begin:m.begin,end:m.end,skip:true,contains:["self"]}]}]},B,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+s.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:true,label:"func.def",contains:[A,s.inherit(s.TITLE_MODE,{begin:o,className:"title.function"})]},{match:/\.\.\./,relevance:0},W,{match:"\\$"+o,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[A]},z,U,L,j,{match:/\$[(.]/}]}}var AG=ER();const lf=em(AG);var hy=Xe({props:{code:{type:String,required:true},language:{type:String,default:""},autodetect:{type:Boolean,default:true},ignoreIllegals:{type:Boolean,default:true}},setup:function(s){var n=Ee(s.language);Ct(function(){return s.language},function(l){n.value=l});var i=_e(function(){return s.autodetect||!n.value}),o=_e(function(){return!i.value&&!lf.getLanguage(n.value)});return{className:_e(function(){return o.value?"":"hljs "+n.value}),highlightedCode:_e(function(){var l;if(o.value)return console.warn('The language "'+n.value+'" you specified could not be found.'),s.code.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;");if(i.value){var g=lf.highlightAuto(s.code);return n.value=(l=g.language)!==null&&l!==void 0?l:"",g.value}return(g=lf.highlight(s.code,{language:n.value,ignoreIllegals:s.ignoreIllegals})).value})}},render:function(){return Yu("pre",{},[Yu("code",{class:this.className,innerHTML:this.highlightedCode,tabindex:"0"})])}}),LG={install:function(s){s.component("highlightjs",hy)},component:hy};const NG=Xe({__name:"code",props:["blocklyInformation","current"],setup(s){RG.registerLanguage("javascript",wG);const n=LG.component;return(i,o)=>s.blocklyInformation.code?(oe(),Je(ue(n),{key:0,code:s.blocklyInformation.code,lang:"javascript"},null,8,["code"])):qe("v-if",true)}}),MG={},DG={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"};function xG(s,n){return oe(),be("svg",DG,[qe("! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. "),n[0]||(n[0]=he("path",{d:"M7.724 65.49C13.36 55.11 21.79 46.47 32 40.56C39.63 36.15 48.25 33.26 57.46 32.33C59.61 32.11 61.79 32 64 32H448C483.3 32 512 60.65 512 96V416C512 451.3 483.3 480 448 480H64C28.65 480 0 451.3 0 416V96C0 93.79 .112 91.61 .3306 89.46C1.204 80.85 3.784 72.75 7.724 65.49V65.49zM48 416C48 424.8 55.16 432 64 432H448C456.8 432 464 424.8 464 416V224H48V416z"},null,-1))])}const BG=sr(MG,[["render",xG]]);let Uu;const PG=new Uint8Array(16);function UG(){if(!Uu&&(Uu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Uu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Uu(PG)}const Ls=[];for(let s=0;s<256;++s)Ls.push((s+256).toString(16).slice(1));function FG(s,n=0){return Ls[s[n+0]]+Ls[s[n+1]]+Ls[s[n+2]]+Ls[s[n+3]]+"-"+Ls[s[n+4]]+Ls[s[n+5]]+"-"+Ls[s[n+6]]+Ls[s[n+7]]+"-"+Ls[s[n+8]]+Ls[s[n+9]]+"-"+Ls[s[n+10]]+Ls[s[n+11]]+Ls[s[n+12]]+Ls[s[n+13]]+Ls[s[n+14]]+Ls[s[n+15]]}const GG=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),dy={randomUUID:GG};function Zn(s,n,i){if(dy.randomUUID&&!n&&!s)return dy.randomUUID();s=s||{};const o=s.random||(s.rng||UG)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,n){i=i||0;for(let l=0;l<16;++l)n[i+l]=o[l];return n}return FG(o)}class co{constructor(){this.listenerMap=new Map,this._listeners=[],this.proxyMap=new Map,this.proxies=[]}get listeners(){return this._listeners.concat(this.proxies.flatMap(n=>n()))}subscribe(n,i){this.listenerMap.has(n)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different handlers for the same event/hook.`),this.unsubscribe(n)),this.listenerMap.set(n,i),this._listeners.push(i)}unsubscribe(n){if(this.listenerMap.has(n)){const i=this.listenerMap.get(n);this.listenerMap.delete(n);const o=this._listeners.indexOf(i);o>=0&&this._listeners.splice(o,1)}}registerProxy(n,i){this.proxyMap.has(n)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different proxies for the same event/hook.`),this.unregisterProxy(n)),this.proxyMap.set(n,i),this.proxies.push(i)}unregisterProxy(n){if(!this.proxyMap.has(n))return;const i=this.proxyMap.get(n);this.proxyMap.delete(n);const o=this.proxies.indexOf(i);o>=0&&this.proxies.splice(o,1)}}class qt extends co{constructor(n){super(),this.entity=n}emit(n){this.listeners.forEach(i=>i(n,this.entity))}}class Zs extends co{constructor(n){super(),this.entity=n}emit(n){let i=false;const o=()=>[i=true];for(const l of Array.from(this.listeners.values()))if(l(n,o,this.entity),i)return{prevented:true};return{prevented:false}}}class HG extends co{execute(n,i){let o=n;for(const l of this.listeners)o=l(o,i);return o}}class zi extends HG{constructor(n){super(),this.entity=n}execute(n){return super.execute(n,this.entity)}}class VG extends co{constructor(n){super(),this.entity=n}execute(n){const i=[];for(const o of this.listeners)i.push(o(n,this.entity));return i}}function In(){const s=Symbol(),n=new Map,i=new Set,o=(p,c)=>{c instanceof co&&c.registerProxy(s,()=>{var d,_;return(_=(d=n.get(p))===null||d===void 0?void 0:d.listeners)!==null&&_!==void 0?_:[]})},l=p=>{const c=new co;n.set(p,c),i.forEach(d=>o(p,d[p]))},g=p=>{i.add(p);for(const c of n.keys())o(c,p[c])},m=p=>{for(const c of n.keys())p[c]instanceof co&&p[c].unregisterProxy(s);i.delete(p)},u=()=>{i.forEach(p=>m(p)),n.clear()};return new Proxy({},{get(p,c){return c==="addTarget"?g:c==="removeTarget"?m:c==="destroy"?u:typeof c!="string"||c.startsWith("_")?p[c]:(n.has(c)||l(c),n.get(c))}})}class _y{constructor(n,i){if(this.destructed=false,this.events={destruct:new qt(this)},!n||!i)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=Zn(),this.from=n,this.to=i,this.from.connectionCount++,this.to.connectionCount++}destruct(){this.events.destruct.emit(),this.from.connectionCount--,this.to.connectionCount--,this.destructed=true}}class WG{constructor(n,i){if(!n||!i)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=Zn(),this.from=n,this.to=i}}function Lf(s,n){return Object.fromEntries(Object.entries(s).map(([i,o])=>[i,n(o)]))}class SR{constructor(){this._title="",this.id=Zn(),this.events={loaded:new qt(this),beforeAddInput:new Zs(this),addInput:new qt(this),beforeRemoveInput:new Zs(this),removeInput:new qt(this),beforeAddOutput:new Zs(this),addOutput:new qt(this),beforeRemoveOutput:new Zs(this),removeOutput:new qt(this),beforeTitleChanged:new Zs(this),titleChanged:new qt(this),update:new qt(this)},this.hooks={beforeLoad:new zi(this),afterSave:new zi(this)}}get graph(){return this.graphInstance}get title(){return this._title}set title(n){this.events.beforeTitleChanged.emit(n).prevented||(this._title=n,this.events.titleChanged.emit(n))}addInput(n,i){return this.addInterface("input",n,i)}addOutput(n,i){return this.addInterface("output",n,i)}removeInput(n){return this.removeInterface("input",n)}removeOutput(n){return this.removeInterface("output",n)}registerGraph(n){this.graphInstance=n}load(n){this.hooks.beforeLoad.execute(n),this.id=n.id,this._title=n.title,Object.entries(n.inputs).forEach(([i,o])=>{this.inputs[i]&&(this.inputs[i].load(o),this.inputs[i].nodeId=this.id)}),Object.entries(n.outputs).forEach(([i,o])=>{this.outputs[i]&&(this.outputs[i].load(o),this.outputs[i].nodeId=this.id)}),this.events.loaded.emit(this)}save(){const n=Lf(this.inputs,l=>l.save()),i=Lf(this.outputs,l=>l.save()),o={type:this.type,id:this.id,title:this.title,inputs:n,outputs:i};return this.hooks.afterSave.execute(o)}onPlaced(){}onDestroy(){}initializeIo(){Object.entries(this.inputs).forEach(([n,i])=>this.initializeIntf("input",n,i)),Object.entries(this.outputs).forEach(([n,i])=>this.initializeIntf("output",n,i))}initializeIntf(n,i,o){o.isInput=n==="input",o.nodeId=this.id,o.events.setValue.subscribe(this,()=>this.events.update.emit({type:n,name:i,intf:o}))}addInterface(n,i,o){const l=n==="input"?this.events.beforeAddInput:this.events.beforeAddOutput,g=n==="input"?this.events.addInput:this.events.addOutput,m=n==="input"?this.inputs:this.outputs;return l.emit(o).prevented?false:(m[i]=o,this.initializeIntf(n,i,o),g.emit(o),true)}removeInterface(n,i){const o=n==="input"?this.events.beforeRemoveInput:this.events.beforeRemoveOutput,l=n==="input"?this.events.removeInput:this.events.removeOutput,g=n==="input"?this.inputs[i]:this.outputs[i];if(!g||o.emit(g).prevented)return false;if(g.connectionCount>0)if(this.graphInstance)this.graphInstance.connections.filter(u=>u.from===g||u.to===g).forEach(u=>{this.graphInstance.removeConnection(u)});else throw new Error("Interface is connected, but no graph instance is specified. Unable to delete interface");return g.events.setValue.unsubscribe(this),n==="input"?delete this.inputs[i]:delete this.outputs[i],l.emit(g),true}}let mm=class extends SR{load(n){super.load(n)}save(){return super.save()}};function An(s){return class extends mm{constructor(){var n,i;super(),this.type=s.type,this.inputs={},this.outputs={},this.calculate=s.calculate?(o,l)=>s.calculate.call(this,o,l):void 0,this._title=(n=s.title)!==null&&n!==void 0?n:s.type,this.executeFactory("input",s.inputs),this.executeFactory("output",s.outputs),(i=s.onCreate)===null||i===void 0||i.call(this)}onPlaced(){var n;(n=s.onPlaced)===null||n===void 0||n.call(this)}onDestroy(){var n;(n=s.onDestroy)===null||n===void 0||n.call(this)}executeFactory(n,i){Object.keys(i||{}).forEach(o=>{const l=i[o]();n==="input"?this.addInput(o,l):this.addOutput(o,l)})}}}class zG extends mm{}function Em(s){return class extends zG{constructor(){var n,i,o,l;super(),this.type=s.type,this.inputs={},this.outputs={},this.preventUpdate=false,this.staticInputKeys=Object.keys((n=s.inputs)!==null&&n!==void 0?n:{}),this.staticOutputKeys=Object.keys((i=s.outputs)!==null&&i!==void 0?i:{}),this._title=(o=s.title)!==null&&o!==void 0?o:s.type,this.executeFactory("input",s.inputs),this.executeFactory("output",s.outputs),s.calculate&&(this.calculate=(g,m)=>{var u;return(u=s.calculate)===null||u===void 0?void 0:u.call(this,g,m)}),(l=s.onCreate)===null||l===void 0||l.call(this)}onPlaced(){var n;this.events.update.subscribe(this,i=>{i&&(i.type==="input"&&this.staticInputKeys.includes(i.name)||i.type==="output"&&this.staticOutputKeys.includes(i.name))&&this.onUpdate()}),this.onUpdate(),(n=s.onPlaced)===null||n===void 0||n.call(this)}onDestroy(){var n;(n=s.onDestroy)===null||n===void 0||n.call(this)}load(n){this.preventUpdate=true,this.hooks.beforeLoad.execute(n),this.id=n.id,this.title=n.title;for(const i of this.staticInputKeys)this.inputs[i].load(n.inputs[i]),this.inputs[i].nodeId=this.id;for(const i of this.staticOutputKeys)this.outputs[i].load(n.outputs[i]),this.outputs[i].nodeId=this.id;this.preventUpdate=false,this.onUpdate(),this.preventUpdate=true;for(const i of Object.keys(n.inputs))this.staticInputKeys.includes(i)||(this.inputs[i].load(n.inputs[i]),this.inputs[i].nodeId=this.id);for(const i of Object.keys(n.outputs))this.staticOutputKeys.includes(i)||(this.outputs[i].load(n.outputs[i]),this.outputs[i].nodeId=this.id);this.preventUpdate=false,this.events.loaded.emit(this)}onUpdate(){var n,i,o,l;if(this.preventUpdate)return;this.graph&&this.graph.activeTransactions++;const g=this.getStaticValues(this.staticInputKeys,this.inputs),m=this.getStaticValues(this.staticOutputKeys,this.outputs),u=s.onUpdate.call(this,g,m);this.updateInterfaces("input",(n=u.inputs)!==null&&n!==void 0?n:{},(i=u.forceUpdateInputs)!==null&&i!==void 0?i:[]),this.updateInterfaces("output",(o=u.outputs)!==null&&o!==void 0?o:{},(l=u.forceUpdateOutputs)!==null&&l!==void 0?l:[]),this.graph&&this.graph.activeTransactions--}getStaticValues(n,i){const o={};for(const l of n)o[l]=i[l].value;return o}updateInterfaces(n,i,o){const l=n==="input"?this.staticInputKeys:this.staticOutputKeys,g=n==="input"?this.inputs:this.outputs;for(const m of Object.keys(g))l.includes(m)||i[m]&&!o.includes(m)||(n==="input"?this.removeInput(m):this.removeOutput(m));for(const m of Object.keys(i)){if(g[m])continue;const u=i[m]();n==="input"?this.addInput(m,u):this.addOutput(m,u)}}executeFactory(n,i){Object.keys(i||{}).forEach(o=>{const l=i[o]();n==="input"?this.addInput(o,l):this.addOutput(o,l)})}}}class dt{set connectionCount(n){this._connectionCount=n,this.events.setConnectionCount.emit(n)}get connectionCount(){return this._connectionCount}set value(n){this.events.beforeSetValue.emit(n).prevented||(this._value=n,this.events.setValue.emit(n))}get value(){return this._value}constructor(n,i){this.id=Zn(),this.nodeId="",this.port=true,this.hidden=false,this.events={setConnectionCount:new qt(this),beforeSetValue:new Zs(this),setValue:new qt(this),updated:new qt(this)},this.hooks={load:new zi(this),save:new zi(this)},this._connectionCount=0,this.name=n,this._value=i}load(n){this.id=n.id,this.templateId=n.templateId,this.value=n.value,this.hooks.load.execute(n)}save(){const n={id:this.id,templateId:this.templateId,value:this.value};return this.hooks.save.execute(n)}setComponent(n){return this.component=n,this}setPort(n){return this.port=n,this}setHidden(n){return this.hidden=n,this}use(n,...i){return n(this,...i),this}}const fa="__baklava_SubgraphInputNode",ma="__baklava_SubgraphOutputNode";class $R extends mm{constructor(){super(),this.graphInterfaceId=Zn()}onPlaced(){super.onPlaced(),this.initializeIo()}save(){return{...super.save(),graphInterfaceId:this.graphInterfaceId}}load(n){super.load(n),this.graphInterfaceId=n.graphInterfaceId}}class vm extends $R{constructor(){super(...arguments),this.type=fa,this.inputs={name:new dt("Name","Input")},this.outputs={placeholder:new dt("Value",void 0)}}static isGraphInputNode(n){return n.type===fa}}class bm extends $R{constructor(){super(...arguments),this.type=ma,this.inputs={name:new dt("Name","Output"),placeholder:new dt("Value",void 0)},this.outputs={output:new dt("Output",void 0).setHidden(true)},this.calculate=({placeholder:n})=>({output:n})}static isGraphOutputNode(n){return n.type===ma}}class Ih{get nodes(){return this._nodes}get connections(){return this._connections}get loading(){return this._loading}get destroying(){return this._destroying}get inputs(){return this.nodes.filter(i=>i.type===fa).map(i=>({id:i.graphInterfaceId,name:i.inputs.name.value,nodeId:i.id,nodeInterfaceId:i.outputs.placeholder.id}))}get outputs(){return this.nodes.filter(i=>i.type===ma).map(i=>({id:i.graphInterfaceId,name:i.inputs.name.value,nodeId:i.id,nodeInterfaceId:i.outputs.output.id}))}constructor(n,i){this.id=Zn(),this.activeTransactions=0,this._nodes=[],this._connections=[],this._loading=false,this._destroying=false,this.events={beforeAddNode:new Zs(this),addNode:new qt(this),beforeRemoveNode:new Zs(this),removeNode:new qt(this),beforeAddConnection:new Zs(this),addConnection:new qt(this),checkConnection:new Zs(this),beforeRemoveConnection:new Zs(this),removeConnection:new qt(this)},this.hooks={save:new zi(this),load:new zi(this),checkConnection:new VG(this)},this.nodeEvents=In(),this.nodeHooks=In(),this.connectionEvents=In(),this.editor=n,this.template=i,n.registerGraph(this)}addNode(n){if(!this.events.beforeAddNode.emit(n).prevented)return this.nodeEvents.addTarget(n.events),this.nodeHooks.addTarget(n.hooks),n.registerGraph(this),this._nodes.push(n),n=this.nodes.find(i=>i.id===n.id),n.onPlaced(),this.events.addNode.emit(n),n}removeNode(n){if(this.nodes.includes(n)){if(this.events.beforeRemoveNode.emit(n).prevented)return;const i=[...Object.values(n.inputs),...Object.values(n.outputs)];this.connections.filter(o=>i.includes(o.from)||i.includes(o.to)).forEach(o=>this.removeConnection(o)),this._nodes.splice(this.nodes.indexOf(n),1),this.events.removeNode.emit(n),n.onDestroy(),this.nodeEvents.removeTarget(n.events),this.nodeHooks.removeTarget(n.hooks)}}addConnection(n,i){const o=this.checkConnection(n,i);if(!o.connectionAllowed||this.events.beforeAddConnection.emit({from:n,to:i}).prevented)return;for(const g of o.connectionsInDanger){const m=this.connections.find(u=>u.id===g.id);m&&this.removeConnection(m)}const l=new _y(o.dummyConnection.from,o.dummyConnection.to);return this.internalAddConnection(l),l}removeConnection(n){if(this.connections.includes(n)){if(this.events.beforeRemoveConnection.emit(n).prevented)return;n.destruct(),this._connections.splice(this.connections.indexOf(n),1),this.events.removeConnection.emit(n),this.connectionEvents.removeTarget(n.events)}}checkConnection(n,i){if(!n||!i)return{connectionAllowed:false};const o=this.findNodeById(n.nodeId),l=this.findNodeById(i.nodeId);if(o&&l&&o===l)return{connectionAllowed:false};if(n.isInput&&!i.isInput){const u=n;n=i,i=u}if(n.isInput||!i.isInput)return{connectionAllowed:false};if(this.connections.some(u=>u.from===n&&u.to===i))return{connectionAllowed:false};if(this.events.checkConnection.emit({from:n,to:i}).prevented)return{connectionAllowed:false};const g=this.hooks.checkConnection.execute({from:n,to:i});if(g.some(u=>!u.connectionAllowed))return{connectionAllowed:false};const m=Array.from(new Set(g.flatMap(u=>u.connectionsInDanger)));return{connectionAllowed:true,dummyConnection:new WG(n,i),connectionsInDanger:m}}findNodeInterface(n){for(const i of this.nodes){for(const o in i.inputs){const l=i.inputs[o];if(l.id===n)return l}for(const o in i.outputs){const l=i.outputs[o];if(l.id===n)return l}}}findNodeById(n){return this.nodes.find(i=>i.id===n)}load(n){try{this._loading=true;const i=[];for(let o=this.connections.length-1;o>=0;o--)this.removeConnection(this.connections[o]);for(let o=this.nodes.length-1;o>=0;o--)this.removeNode(this.nodes[o]);this.id=n.id;for(const o of n.nodes){const l=this.editor.nodeTypes.get(o.type);if(!l){i.push(`Node type ${o.type} is not registered`);continue}const g=new l.type;this.addNode(g),g.load(o)}for(const o of n.connections){const l=this.findNodeInterface(o.from),g=this.findNodeInterface(o.to);if(l)if(g){const m=new _y(l,g);m.id=o.id,this.internalAddConnection(m)}else{i.push(`Could not find interface with id ${o.to}`);continue}else{i.push(`Could not find interface with id ${o.from}`);continue}}return this.hooks.load.execute(n),i}finally{this._loading=false}}save(){const n={id:this.id,nodes:this.nodes.map(i=>i.save()),connections:this.connections.map(i=>({id:i.id,from:i.from.id,to:i.to.id})),inputs:this.inputs,outputs:this.outputs};return this.hooks.save.execute(n)}destroy(){this._destroying=true;for(const n of this.nodes)this.removeNode(n);this.editor.unregisterGraph(this)}internalAddConnection(n){this.connectionEvents.addTarget(n.events),this._connections.push(n),this.events.addConnection.emit(n)}}const ic="__baklava_GraphNode-";function Ea(s){return ic+s.id}const jG=["component","connectionCount","events","hidden","hooks","id","isInput","name","nodeId","port","templateId","value"];function XG(s){return class extends SR{constructor(){super(...arguments),this.type=Ea(s),this.inputs={},this.outputs={},this.template=s,this.calculate=async(i,o)=>{var l;if(!this.subgraph)throw new Error(`GraphNode ${this.id}: calculate called without subgraph being initialized`);if(!o.engine||typeof o.engine!="object")throw new Error(`GraphNode ${this.id}: calculate called but no engine provided in context`);const g=o.engine.getInputValues(this.subgraph);for(const p of this.subgraph.inputs)g.set(p.nodeInterfaceId,i[p.id]);const m=await o.engine.runGraph(this.subgraph,g,o.globalValues),u={};for(const p of this.subgraph.outputs)u[p.id]=(l=m.get(p.nodeId))===null||l===void 0?void 0:l.get("output");return u._calculationResults=m,u}}get title(){return this._title}set title(i){this.template.name=i}load(i){if(!this.subgraph)throw new Error("Cannot load a graph node without a graph");if(!this.template)throw new Error("Unable to load graph node without graph template");this.subgraph.load(i.graphState),super.load(i)}save(){if(!this.subgraph)throw new Error("Cannot save a graph node without a graph");return{...super.save(),graphState:this.subgraph.save()}}onPlaced(){this.template.events.updated.subscribe(this,()=>this.initialize()),this.template.events.nameChanged.subscribe(this,i=>{this._title=i}),this.initialize()}onDestroy(){var i;this.template.events.updated.unsubscribe(this),this.template.events.nameChanged.unsubscribe(this),(i=this.subgraph)===null||i===void 0||i.destroy()}initialize(){this.subgraph&&this.subgraph.destroy(),this.subgraph=this.template.createGraph(),this._title=this.template.name,this.updateInterfaces(),this.events.update.emit(null)}updateInterfaces(){if(!this.subgraph)throw new Error("Trying to update interfaces without graph instance");for(const i of this.subgraph.inputs)i.id in this.inputs?this.inputs[i.id].name=i.name:this.addInput(i.id,this.createProxyInterface(i,true));for(const i of Object.keys(this.inputs))this.subgraph.inputs.some(o=>o.id===i)||this.removeInput(i);for(const i of this.subgraph.outputs)i.id in this.outputs?this.outputs[i.id].name=i.name:this.addOutput(i.id,this.createProxyInterface(i,false));for(const i of Object.keys(this.outputs))this.subgraph.outputs.some(o=>o.id===i)||this.removeOutput(i);this.addOutput("_calculationResults",new dt("_calculationResults",void 0).setHidden(true))}createProxyInterface(i,o){const l=new dt(i.name,void 0);return new Proxy(l,{get:(g,m)=>{var u,p,c;if(jG.includes(m)||m in g||typeof m=="string"&&m.startsWith("__v_"))return Reflect.get(g,m);let d;if(o){const $=(u=this.subgraph)===null||u===void 0?void 0:u.nodes.find(E=>vm.isGraphInputNode(E)&&E.graphInterfaceId===i.id);d=$==null?void 0:$.outputs.placeholder.id}else{const $=(p=this.subgraph)===null||p===void 0?void 0:p.nodes.find(E=>bm.isGraphOutputNode(E)&&E.graphInterfaceId===i.id);d=$==null?void 0:$.inputs.placeholder.id}const _=(c=this.subgraph)===null||c===void 0?void 0:c.connections.find($=>{var E;return d===((E=o?$.from:$.to)===null||E===void 0?void 0:E.id)}),b=o?_==null?void 0:_.to:_==null?void 0:_.from;if(b)return Reflect.get(b,m)}})}}}class Ch{static fromGraph(n,i){return new Ch(n.save(),i)}get name(){return this._name}set name(n){this._name=n,this.events.nameChanged.emit(n);const i=this.editor.nodeTypes.get(Ea(this));i&&(i.title=n)}get inputs(){return this.nodes.filter(i=>i.type===fa).map(i=>({id:i.graphInterfaceId,name:i.inputs.name.value,nodeId:i.id,nodeInterfaceId:i.outputs.placeholder.id}))}get outputs(){return this.nodes.filter(i=>i.type===ma).map(i=>({id:i.graphInterfaceId,name:i.inputs.name.value,nodeId:i.id,nodeInterfaceId:i.outputs.output.id}))}constructor(n,i){this.id=Zn(),this._name="Subgraph",this.events={nameChanged:new qt(this),updated:new qt(this)},this.hooks={beforeLoad:new zi(this),afterSave:new zi(this)},this.editor=i,n.id&&(this.id=n.id),n.name&&(this._name=n.name),this.update(n)}update(n){this.nodes=n.nodes,this.connections=n.connections,this.events.updated.emit()}save(){return{id:this.id,name:this.name,nodes:this.nodes,connections:this.connections,inputs:this.inputs,outputs:this.outputs}}createGraph(n){const i=new Map,o=b=>{const $=Zn();return i.set(b,$),$},l=b=>{const $=i.get(b);if(!$)throw new Error(`Unable to create graph from template: Could not map old id ${b} to new id`);return $},g=b=>Lf(b,$=>({id:o($.id),templateId:$.id,value:$.value})),m=this.nodes.map(b=>({...b,id:o(b.id),inputs:g(b.inputs),outputs:g(b.outputs)})),u=this.connections.map(b=>({id:o(b.id),from:l(b.from),to:l(b.to)})),p=this.inputs.map(b=>({id:b.id,name:b.name,nodeId:l(b.nodeId),nodeInterfaceId:l(b.nodeInterfaceId)})),c=this.outputs.map(b=>({id:b.id,name:b.name,nodeId:l(b.nodeId),nodeInterfaceId:l(b.nodeInterfaceId)})),d={id:Zn(),nodes:m,connections:u,inputs:p,outputs:c};return n||(n=new Ih(this.editor)),n.load(d).forEach(b=>console.warn(b)),n.template=this,n}}class KG{get nodeTypes(){return this._nodeTypes}get graph(){return this._graph}get graphTemplates(){return this._graphTemplates}get graphs(){return this._graphs}get loading(){return this._loading}constructor(){this.events={loaded:new qt(this),beforeRegisterNodeType:new Zs(this),registerNodeType:new qt(this),beforeUnregisterNodeType:new Zs(this),unregisterNodeType:new qt(this),beforeAddGraphTemplate:new Zs(this),addGraphTemplate:new qt(this),beforeRemoveGraphTemplate:new Zs(this),removeGraphTemplate:new qt(this),registerGraph:new qt(this),unregisterGraph:new qt(this)},this.hooks={save:new zi(this),load:new zi(this)},this.graphTemplateEvents=In(),this.graphTemplateHooks=In(),this.graphEvents=In(),this.graphHooks=In(),this.nodeEvents=In(),this.nodeHooks=In(),this.connectionEvents=In(),this._graphs=new Set,this._nodeTypes=new Map,this._graph=new Ih(this),this._graphTemplates=[],this._loading=false,this.registerNodeType(vm),this.registerNodeType(bm)}registerNodeType(n,i){var o,l;if(this.events.beforeRegisterNodeType.emit({type:n,options:i}).prevented)return;const g=new n;this._nodeTypes.set(g.type,{type:n,category:(o=i==null?void 0:i.category)!==null&&o!==void 0?o:"default",title:(l=i==null?void 0:i.title)!==null&&l!==void 0?l:g.title}),this.events.registerNodeType.emit({type:n,options:i})}unregisterNodeType(n){const i=typeof n=="string"?n:new n().type;if(this.nodeTypes.has(i)){if(this.events.beforeUnregisterNodeType.emit(i).prevented)return;this._nodeTypes.delete(i),this.events.unregisterNodeType.emit(i)}}addGraphTemplate(n){if(this.events.beforeAddGraphTemplate.emit(n).prevented)return;this._graphTemplates.push(n),this.graphTemplateEvents.addTarget(n.events),this.graphTemplateHooks.addTarget(n.hooks);const i=XG(n);this.registerNodeType(i,{category:"Subgraphs",title:n.name}),this.events.addGraphTemplate.emit(n)}removeGraphTemplate(n){if(this.graphTemplates.includes(n)){if(this.events.beforeRemoveGraphTemplate.emit(n).prevented)return;const i=Ea(n);for(const o of[this.graph,...this.graphs.values()]){const l=o.nodes.filter(g=>g.type===i);for(const g of l)o.removeNode(g)}this.unregisterNodeType(i),this._graphTemplates.splice(this._graphTemplates.indexOf(n),1),this.graphTemplateEvents.removeTarget(n.events),this.graphTemplateHooks.removeTarget(n.hooks),this.events.removeGraphTemplate.emit(n)}}registerGraph(n){this.graphEvents.addTarget(n.events),this.graphHooks.addTarget(n.hooks),this.nodeEvents.addTarget(n.nodeEvents),this.nodeHooks.addTarget(n.nodeHooks),this.connectionEvents.addTarget(n.connectionEvents),this.events.registerGraph.emit(n),this._graphs.add(n)}unregisterGraph(n){this.graphEvents.removeTarget(n.events),this.graphHooks.removeTarget(n.hooks),this.nodeEvents.removeTarget(n.nodeEvents),this.nodeHooks.removeTarget(n.nodeHooks),this.connectionEvents.removeTarget(n.connectionEvents),this.events.unregisterGraph.emit(n),this._graphs.delete(n)}load(n){try{for(this._loading=true,n=this.hooks.load.execute(n);this.graphTemplates.length>0;)this.removeGraphTemplate(this.graphTemplates[0]);n.graphTemplates.forEach(o=>{const l=new Ch(o,this);this.addGraphTemplate(l)});const i=this._graph.load(n.graph);return this.events.loaded.emit(),i.forEach(o=>console.warn(o)),i}finally{this._loading=false}}save(){const n={graph:this.graph.save(),graphTemplates:this.graphTemplates.map(i=>i.save())};return this.hooks.save.execute(n)}}var py;(function(s){s.Running="Running",s.Idle="Idle",s.Paused="Paused",s.Stopped="Stopped"})(py||(py={}));const YG=["INPUT","TEXTAREA","SELECT"];function yR(s){return YG.includes(s.tagName)}let Nf=null;function qG(s){Nf=s}function Ai(){if(!Nf)throw new Error("providePlugin() must be called before usePlugin()");return{viewModel:Nf}}function ji(){const{viewModel:s}=Ai();return{graph:cn(s.value,"displayedGraph"),switchGraph:s.value.switchGraph}}function RR(s){const{graph:n}=ji(),i=Ee(null),o=Ee(null);return{dragging:_e(()=>!!i.value),onPointerDown:p=>{i.value={x:p.pageX,y:p.pageY},o.value={x:s.value.x,y:s.value.y}},onPointerMove:p=>{if(i.value){const c=p.pageX-i.value.x,d=p.pageY-i.value.y;s.value.x=o.value.x+c/n.value.scaling,s.value.y=o.value.y+d/n.value.scaling}},onPointerUp:()=>{i.value=null,o.value=null}}}function IR(s,n,i){if(!n.template)return false;if(Ea(n.template)===i)return true;const o=s.graphTemplates.find(g=>Ea(g)===i);return o?o.nodes.filter(g=>g.type.startsWith(ic)).some(g=>IR(s,n,g.type)):false}function CR(s){return _e(()=>{const n=Array.from(s.value.editor.nodeTypes.entries()),i=new Set(n.map(([,l])=>l.category)),o=[];for(const l of i.values()){let g=n.filter(([,m])=>m.category===l);s.value.displayedGraph.template?g=g.filter(([m])=>!IR(s.value.editor,s.value.displayedGraph,m)):g=g.filter(([m])=>![fa,ma].includes(m)),g.length>0&&o.push({name:l,nodeTypes:Object.fromEntries(g)})}return o.sort((l,g)=>l.name==="default"?-1:g.name==="default"||l.name>g.name?1:-1),o})}function OR(){const{graph:s}=ji();return{transform:(i,o)=>{const l=i/s.value.scaling-s.value.panning.x,g=o/s.value.scaling-s.value.panning.y;return[l,g]}}}function JG(){const{graph:s}=ji();let n=[],i=-1,o={x:0,y:0};const l=_e(()=>s.value.panning),g=RR(l),m=_e(()=>({"transform-origin":"0 0",transform:`scale(${s.value.scaling}) translate(${s.value.panning.x}px, ${s.value.panning.y}px)`})),u=($,E,y)=>{const f=[$/s.value.scaling-s.value.panning.x,E/s.value.scaling-s.value.panning.y],v=[$/y-s.value.panning.x,E/y-s.value.panning.y],T=[v[0]-f[0],v[1]-f[1]];s.value.panning.x+=T[0],s.value.panning.y+=T[1],s.value.scaling=y},p=$=>{$.preventDefault();let E=$.deltaY;$.deltaMode===1&&(E*=32);const y=s.value.scaling*(1-E/3e3);u($.offsetX,$.offsetY,y)},c=()=>({ax:n[0].clientX,ay:n[0].clientY,bx:n[1].clientX,by:n[1].clientY});return{styles:m,...g,onPointerDown:$=>{if(n.push($),g.onPointerDown($),n.length===2){const{ax:E,ay:y,bx:f,by:v}=c();o={x:E+(f-E)/2,y:y+(v-y)/2}}},onPointerMove:$=>{for(let E=0;E<n.length;E++)if($.pointerId==n[E].pointerId){n[E]=$;break}if(n.length==2){const{ax:E,ay:y,bx:f,by:v}=c(),T=E-f,S=y-v,R=Math.sqrt(T*T+S*S);if(i>0){const O=s.value.scaling*(1+(R-i)/500);u(o.x,o.y,O)}i=R}else g.onPointerMove($)},onPointerUp:$=>{n=n.filter(E=>E.pointerId!==$.pointerId),i=-1,g.onPointerUp()},onMouseWheel:p}}var Hi=(s=>(s[s.NONE=0]="NONE",s[s.ALLOWED=1]="ALLOWED",s[s.FORBIDDEN=2]="FORBIDDEN",s))(Hi||{});const kR=Symbol();function ZG(){const{graph:s}=ji(),n=Ee(null),i=Ee(null),o=u=>{n.value&&(n.value.mx=u.offsetX/s.value.scaling-s.value.panning.x,n.value.my=u.offsetY/s.value.scaling-s.value.panning.y)},l=()=>{if(i.value){if(n.value)return;const u=s.value.connections.find(p=>p.to===i.value);i.value.isInput&&u?(n.value={status:Hi.NONE,from:u.from},s.value.removeConnection(u)):n.value={status:Hi.NONE,from:i.value},n.value.mx=void 0,n.value.my=void 0}},g=()=>{if(n.value&&i.value){if(n.value.from===i.value)return;s.value.addConnection(n.value.from,n.value.to)}n.value=null},m=u=>{if(i.value=u??null,u&&n.value){n.value.to=u;const p=s.value.checkConnection(n.value.from,n.value.to);if(n.value.status=p.connectionAllowed?Hi.ALLOWED:Hi.FORBIDDEN,p.connectionAllowed){const c=p.connectionsInDanger.map(d=>d.id);s.value.connections.forEach(d=>{c.includes(d.id)&&(d.isInDanger=true)})}}else!u&&n.value&&(n.value.to=void 0,n.value.status=Hi.NONE,s.value.connections.forEach(p=>{p.isInDanger=false}))};return rc(kR,{temporaryConnection:n,hoveredOver:m}),{temporaryConnection:n,onMouseMove:o,onMouseDown:l,onMouseUp:g,hoveredOver:m}}function QG(s){const n=Ee(false),i=Ee(0),o=Ee(0),l=CR(s),{transform:g}=OR(),m=_e(()=>{let d=[];const _={};for(const $ of l.value){const E=Object.entries($.nodeTypes).map(([y,f])=>({label:f.title,value:"addNode:"+y}));$.name==="default"?d=E:_[$.name]=E}const b=[...Object.entries(_).map(([$,E])=>({label:$,submenu:E}))];return b.length>0&&d.length>0&&b.push({isDivider:true}),b.push(...d),b}),u=_e(()=>s.value.settings.contextMenu.additionalItems.length===0?m.value:[{label:"Add node",submenu:m.value},...s.value.settings.contextMenu.additionalItems.map(d=>"isDivider"in d||"submenu"in d?d:{label:d.label,value:"command:"+d.command,disabled:!s.value.commandHandler.canExecuteCommand(d.command)})]);function p(d){const _=d.target;if(!(_ instanceof Element)||yR(_))return;d.preventDefault(),n.value=true;const b=_.getBoundingClientRect(),E=_.closest(".baklava-editor").getBoundingClientRect();i.value=b.x+d.offsetX-E.x,o.value=b.y+d.offsetY-E.y}function c(d){if(d.startsWith("addNode:")){const _=d.substring(8),b=s.value.editor.nodeTypes.get(_);if(!b)return;const $=Vi(new b.type);s.value.displayedGraph.addNode($);const[E,y]=g(i.value,o.value);$.position.x=E,$.position.y=y}else if(d.startsWith("command:")){const _=d.substring(8);s.value.commandHandler.canExecuteCommand(_)&&s.value.commandHandler.executeCommand(_)}}return{show:n,x:i,y:o,items:u,open:p,onClick:c}}const Xu="START_SELECTION_BOX";function eH(s){const{viewModel:n}=Ai(),{graph:i}=ji(),o=_e(()=>i.value.nodes),l=Ee(false),g=Ee(false),m=Ee([0,0]),u=Ee([0,0]);Ct(n,()=>{n.value.commandHandler.hasCommand(Xu)||(n.value.commandHandler.registerCommand(Xu,{canExecute:()=>true,execute(){l.value=true}}),n.value.commandHandler.registerHotkey(["b"],Xu))},{immediate:true});function p(v){return[v.clientX-s.value.getBoundingClientRect().left,v.clientY-s.value.getBoundingClientRect().top]}function c(v){return l.value?(g.value=true,l.value=false,m.value=p(v),u.value=p(v),document.addEventListener("pointermove",d),document.addEventListener("pointerup",_),true):false}function d(v){m.value=p(v)}function _(v){document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",_),m.value=p(v),g.value=false;const T=b();for(const S of T)n.value.displayedGraph.selectedNodes.push(S)}function b(){const v=$(),S=document.querySelector(".baklava-editor").getBoundingClientRect();return o.value.filter(R=>{const O=E(R,S);return y(v,O)})}function $(){return{left:Math.min(m.value[0],u.value[0]),top:Math.min(m.value[1],u.value[1]),right:Math.max(m.value[0],u.value[0]),bottom:Math.max(m.value[1],u.value[1])}}function E(v,T){const S=document.getElementById(v.id),R=S?S.getBoundingClientRect():{x:0,y:0,width:0,height:0},O=R.x-T.left,A=R.y-T.top;return{left:O,top:A,right:O+R.width,bottom:A+R.height}}function y(v,T){return v.left<T.right&&v.right>T.left&&v.top<T.bottom&&v.bottom>T.top}function f(){return{width:Math.abs(u.value[0]-m.value[0])+"px",height:Math.abs(u.value[1]-m.value[1])+"px",left:(u.value[0]>m.value[0]?m.value[0]:u.value[0])+"px",top:(u.value[1]>m.value[1]?m.value[1]:u.value[1])+"px"}}return Vi({startSelection:l,isSelecting:g,start:m,end:u,onPointerDown:c,getStyles:f})}const tH=Xe({setup(){const{viewModel:s}=Ai(),{graph:n}=ji();return{styles:_e(()=>{const o=s.value.settings.background,l=n.value.panning.x*n.value.scaling,g=n.value.panning.y*n.value.scaling,m=n.value.scaling*o.gridSize,u=m/o.gridDivision,p=`${m}px ${m}px, ${m}px ${m}px`,c=n.value.scaling>o.subGridVisibleThreshold?`, ${u}px ${u}px, ${u}px ${u}px`:"";return{backgroundPosition:`left ${l}px top ${g}px`,backgroundSize:`${p} ${c}`}})}}}),gs=(s,n)=>{const i=s.__vccOpts||s;for(const[o,l]of n)i[o]=l;return i};function sH(s,n,i,o,l,g){return oe(),be("div",{class:"background",style:Js(s.styles)},null,4)}const iH=gs(tH,[["render",sH]]);function nH(s){return dk()?($y(s),true):false}function Tm(s){return typeof s=="function"?s():ue(s)}const wR=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const rH=Object.prototype.toString,oH=s=>rH.call(s)==="[object Object]",Ku=()=>{},aH=lH();function lH(){var s,n;return wR&&((s=window==null?void 0:window.navigator)==null?void 0:s.userAgent)&&(/iP(ad|hone|od)/.test(window.navigator.userAgent)||((n=window==null?void 0:window.navigator)==null?void 0:n.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function cH(s,n,i=false){return n.reduce((o,l)=>(l in s&&(!i||s[l]!==void 0)&&(o[l]=s[l]),o),{})}function uH(s,n={}){if(!Hl(s))return Ry(s);const i=Array.isArray(s.value)?Array.from({length:s.value.length}):{};for(const o in s.value)i[o]=_k(()=>({get(){return s.value[o]},set(l){var g;if((g=Tm(n.replaceRef))!=null?g:true)if(Array.isArray(s.value)){const u=[...s.value];u[o]=l,s.value=u}else{const u={...s.value,[o]:l};Object.setPrototypeOf(u,Object.getPrototypeOf(s.value)),s.value=u}else s.value[o]=l}}));return i}function xl(s){var n;const i=Tm(s);return(n=i==null?void 0:i.$el)!=null?n:i}const Sm=wR?window:void 0;function Gl(...s){let n,i,o,l;if(typeof s[0]=="string"||Array.isArray(s[0])?([i,o,l]=s,n=Sm):[n,i,o,l]=s,!n)return Ku;Array.isArray(i)||(i=[i]),Array.isArray(o)||(o=[o]);const g=[],m=()=>{g.forEach(d=>d()),g.length=0},u=(d,_,b,$)=>(d.addEventListener(_,b,$),()=>d.removeEventListener(_,b,$)),p=Ct(()=>[xl(n),Tm(l)],([d,_])=>{if(m(),!d)return;const b=oH(_)?{..._}:_;g.push(...i.flatMap($=>o.map(E=>u(d,$,E,b))))},{immediate:true,flush:"post"}),c=()=>{p(),m()};return nH(c),c}let gy=false;function AR(s,n,i={}){const{window:o=Sm,ignore:l=[],capture:g=true,detectIframe:m=false}=i;if(!o)return Ku;aH&&!gy&&(gy=true,Array.from(o.document.body.children).forEach(b=>b.addEventListener("click",Ku)),o.document.documentElement.addEventListener("click",Ku));let u=true;const p=b=>l.some($=>{if(typeof $=="string")return Array.from(o.document.querySelectorAll($)).some(E=>E===b.target||b.composedPath().includes(E));{const E=xl($);return E&&(b.target===E||b.composedPath().includes(E))}}),d=[Gl(o,"click",b=>{const $=xl(s);if(!(!$||$===b.target||b.composedPath().includes($))){if(b.detail===0&&(u=!p(b)),!u){u=true;return}n(b)}},{passive:true,capture:g}),Gl(o,"pointerdown",b=>{const $=xl(s);u=!p(b)&&!!($&&!b.composedPath().includes($))},{passive:true}),m&&Gl(o,"blur",b=>{setTimeout(()=>{var $;const E=xl(s);(($=o.document.activeElement)==null?void 0:$.tagName)==="IFRAME"&&!(E!=null&&E.contains(o.document.activeElement))&&n(b)},0)})].filter(Boolean);return()=>d.forEach(b=>b())}const LR={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},hH=Object.keys(LR);function dH(s={}){const{target:n=Sm}=s,i=Ee(false),o=Ee(s.initialValue||{});Object.assign(o.value,LR,o.value);const l=g=>{i.value=true,!(s.pointerTypes&&!s.pointerTypes.includes(g.pointerType))&&(o.value=cH(g,hH,false))};if(n){const g={passive:true};Gl(n,["pointerdown","pointermove","pointerup"],l,g),Gl(n,"pointerleave",()=>i.value=false,g)}return{...uH(o),isInside:i}}const _H=["onMouseenter","onMouseleave","onClick"],pH={class:"flex-fill"},gH={key:0,class:"__submenu-icon",style:{"line-height":"1em"}},fH=he("svg",{width:"13",height:"13",viewBox:"-60 120 250 250"},[he("path",{d:"M160.875 279.5625 L70.875 369.5625 L70.875 189.5625 L160.875 279.5625 Z",stroke:"none",fill:"white"})],-1),mH=[fH],$m=Xe({__name:"ContextMenu",props:{modelValue:{type:Boolean},items:{},x:{default:0},y:{default:0},isNested:{type:Boolean,default:false},isFlipped:{default:()=>({x:false,y:false})},flippable:{type:Boolean,default:false}},emits:["update:modelValue","click"],setup(s,{emit:n}){const i=s,o=n;let l=null;const g=Ee(null),m=Ee(-1),u=Ee(0),p=Ee({x:false,y:false}),c=_e(()=>i.flippable&&(p.value.x||i.isFlipped.x)),d=_e(()=>i.flippable&&(p.value.y||i.isFlipped.y)),_=_e(()=>{const T={};return i.isNested||(T.top=(d.value?i.y-u.value:i.y)+"px",T.left=i.x+"px"),T}),b=_e(()=>({"--flipped-x":c.value,"--flipped-y":d.value,"--nested":i.isNested})),$=_e(()=>i.items.map(T=>({...T,hover:false})));Ct([()=>i.y,()=>i.items],()=>{var T,S,R,O;u.value=i.items.length*30;const A=((S=(T=g.value)==null?void 0:T.parentElement)==null?void 0:S.offsetWidth)??0,L=((O=(R=g.value)==null?void 0:R.parentElement)==null?void 0:O.offsetHeight)??0;p.value.x=!i.isNested&&i.x>A*.75,p.value.y=!i.isNested&&i.y+u.value>L-20}),AR(g,()=>{i.modelValue&&o("update:modelValue",false)});const E=T=>{!T.submenu&&T.value&&(o("click",T.value),o("update:modelValue",false))},y=T=>{o("click",T),m.value=-1,i.isNested||o("update:modelValue",false)},f=(T,S)=>{i.items[S].submenu&&(m.value=S,l!==null&&(clearTimeout(l),l=null))},v=(T,S)=>{i.items[S].submenu&&(l=window.setTimeout(()=>{m.value=-1,l=null},200))};return(T,S)=>{const R=ht("ContextMenu",true);return oe(),Je(oc,{name:"slide-fade"},{default:je(()=>[ci(he("div",{ref_key:"el",ref:g,class:tt(["baklava-context-menu",b.value]),style:Js(_.value)},[(oe(true),be(Pt,null,di($.value,(O,A)=>(oe(),be(Pt,null,[O.isDivider?(oe(),be("div",{key:`d-${A}`,class:"divider"})):(oe(),be("div",{key:`i-${A}`,class:tt(["item",{submenu:!!O.submenu,"--disabled":!!O.disabled}]),onMouseenter:L=>f(L,A),onMouseleave:L=>v(L,A),onClick:Is(L=>E(O),["stop","prevent"])},[he("div",pH,Bt(O.label),1),O.submenu?(oe(),be("div",gH,mH)):qe("",true),O.submenu?(oe(),Je(R,{key:1,"model-value":m.value===A,items:O.submenu,"is-nested":true,"is-flipped":{x:c.value,y:d.value},flippable:T.flippable,onClick:y},null,8,["model-value","items","is-flipped","flippable"])):qe("",true)],42,_H))],64))),256))],6),[[Fi,T.modelValue]])]),_:1})}}}),EH={},vH={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"16",height:"16",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},bH=he("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),TH=he("circle",{cx:"12",cy:"12",r:"1"},null,-1),SH=he("circle",{cx:"12",cy:"19",r:"1"},null,-1),$H=he("circle",{cx:"12",cy:"5",r:"1"},null,-1),yH=[bH,TH,SH,$H];function RH(s,n){return oe(),be("svg",vH,yH)}const NR=gs(EH,[["render",RH]]),IH=["id"],CH={key:0,class:"__tooltip"},OH={key:2,class:"align-middle"},fy=Xe({__name:"NodeInterface",props:{node:{},intf:{}},setup(s){const n=(f,v=100)=>{const T=typeof(f==null?void 0:f.toString)=="function"?String(f):"";return T.length>v?T.slice(0,v)+"...":T},i=s,{viewModel:o}=Ai(),{hoveredOver:l,temporaryConnection:g}=Vs(kR),m=Ee(null),u=_e(()=>i.intf.connectionCount>0),p=Ee(false),c=_e(()=>o.value.settings.displayValueOnHover&&p.value),d=_e(()=>({"--input":i.intf.isInput,"--output":!i.intf.isInput,"--connected":u.value})),_=_e(()=>i.intf.component&&(!i.intf.isInput||!i.intf.port||i.intf.connectionCount===0)),b=()=>{p.value=true,l(i.intf)},$=()=>{p.value=false,l(void 0)},E=()=>{m.value&&o.value.hooks.renderInterface.execute({intf:i.intf,el:m.value})},y=()=>{const f=o.value.displayedGraph.sidebar;f.nodeId=i.node.id,f.optionName=i.intf.name,f.visible=true};return Ws(E),Oy(E),(f,v)=>{var T;return oe(),be("div",{id:f.intf.id,ref_key:"el",ref:m,class:tt(["baklava-node-interface",d.value])},[f.intf.port?(oe(),be("div",{key:0,class:tt(["__port",{"--selected":((T=ue(g))==null?void 0:T.from)===f.intf}]),onPointerover:b,onPointerout:$},[Mt(f.$slots,"portTooltip",{showTooltip:c.value},()=>[c.value===true?(oe(),be("span",CH,Bt(n(f.intf.value)),1)):qe("",true)])],34)):qe("",true),_.value?(oe(),Je(ui(f.intf.component),{key:1,modelValue:f.intf.value,"onUpdate:modelValue":v[0]||(v[0]=S=>f.intf.value=S),node:f.node,intf:f.intf,onOpenSidebar:y},null,40,["modelValue","node","intf"])):(oe(),be("span",OH,Bt(f.intf.name),1))],10,IH)}}}),kH=["id","data-node-type"],wH={class:"__title-label"},AH={class:"__menu"},LH={class:"__outputs"},NH={class:"__inputs"},MH=Xe({__name:"Node",props:{node:{},selected:{type:Boolean,default:false},dragging:{type:Boolean}},emits:["select","start-drag"],setup(s,{emit:n}){const i=s,o=n,{viewModel:l}=Ai(),{graph:g,switchGraph:m}=ji(),u=Ee(null),p=Ee(false),c=Ee(""),d=Ee(null),_=Ee(false),b=Ee(false),$=_e(()=>{const P=[{value:"rename",label:"Rename"},{value:"delete",label:"Delete"}];return i.node.type.startsWith(ic)&&P.push({value:"editSubgraph",label:"Edit Subgraph"}),P}),E=_e(()=>({"--selected":i.selected,"--dragging":i.dragging,"--two-column":!!i.node.twoColumn})),y=_e(()=>({"--reverse-y":i.node.reverseY??l.value.settings.nodes.reverseY})),f=_e(()=>{var P,z;return{top:`${((P=i.node.position)==null?void 0:P.y)??0}px`,left:`${((z=i.node.position)==null?void 0:z.x)??0}px`,"--width":`${i.node.width??l.value.settings.nodes.defaultWidth}px`}}),v=_e(()=>Object.values(i.node.inputs).filter(P=>!P.hidden)),T=_e(()=>Object.values(i.node.outputs).filter(P=>!P.hidden)),S=()=>{o("select")},R=P=>{i.selected||S(),o("start-drag",P)},O=()=>{b.value=true},A=async P=>{var z;switch(P){case"delete":g.value.removeNode(i.node);break;case"rename":c.value=i.node.title,p.value=true,await rs(),(z=d.value)==null||z.focus();break;case"editSubgraph":m(i.node.template);break}},L=()=>{i.node.title=c.value,p.value=false},I=()=>{u.value&&l.value.hooks.renderNode.execute({node:i.node,el:u.value})},k=P=>{_.value=true,P.preventDefault()},B=P=>{if(!_.value)return;const z=i.node.width+P.movementX/g.value.scaling,W=l.value.settings.nodes.minWidth,j=l.value.settings.nodes.maxWidth;i.node.width=Math.max(W,Math.min(j,z))},U=()=>{_.value=false};return Ws(()=>{I(),window.addEventListener("mousemove",B),window.addEventListener("mouseup",U)}),Oy(I),kr(()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",U)}),(P,z)=>(oe(),be("div",{id:P.node.id,ref_key:"el",ref:u,class:tt(["baklava-node",E.value]),style:Js(f.value),"data-node-type":P.node.type,onPointerdown:S},[ue(l).settings.nodes.resizable?(oe(),be("div",{key:0,class:"__resize-handle",onMousedown:k},null,32)):qe("",true),Mt(P.$slots,"title",{},()=>[he("div",{class:"__title",onPointerdown:Is(R,["self","stop"])},[p.value?ci((oe(),be("input",{key:1,ref_key:"renameInputEl",ref:d,"onUpdate:modelValue":z[1]||(z[1]=W=>c.value=W),type:"text",class:"baklava-input",placeholder:"Node Name",onBlur:L,onKeydown:io(L,["enter"])},null,544)),[[ky,c.value]]):(oe(),be(Pt,{key:0},[he("div",wH,Bt(P.node.title),1),he("div",AH,[Me(NR,{class:"--clickable",onClick:O}),Me(ue($m),{modelValue:b.value,"onUpdate:modelValue":z[0]||(z[0]=W=>b.value=W),x:0,y:0,items:$.value,onClick:A},null,8,["modelValue","items"])])],64))],32)]),Mt(P.$slots,"content",{},()=>[he("div",{class:tt(["__content",y.value]),onKeydown:z[2]||(z[2]=io(Is(()=>{},["stop"]),["delete"]))},[he("div",LH,[(oe(true),be(Pt,null,di(T.value,W=>Mt(P.$slots,"nodeInterface",{key:W.id,type:"output",node:P.node,intf:W},()=>[Me(fy,{node:P.node,intf:W},null,8,["node","intf"])])),128))]),he("div",NH,[(oe(true),be(Pt,null,di(v.value,W=>Mt(P.$slots,"nodeInterface",{key:W.id,type:"input",node:P.node,intf:W},()=>[Me(fy,{node:P.node,intf:W},null,8,["node","intf"])])),128))])],34)])],46,kH))}}),DH=Xe({props:{x1:{type:Number,required:true},y1:{type:Number,required:true},x2:{type:Number,required:true},y2:{type:Number,required:true},state:{type:Number,default:Hi.NONE},isTemporary:{type:Boolean,default:false}},setup(s){const{viewModel:n}=Ai(),{graph:i}=ji(),o=(m,u)=>{const p=(m+i.value.panning.x)*i.value.scaling,c=(u+i.value.panning.y)*i.value.scaling;return[p,c]},l=_e(()=>{const[m,u]=o(s.x1,s.y1),[p,c]=o(s.x2,s.y2);if(n.value.settings.useStraightConnections)return`M ${m} ${u} L ${p} ${c}`;{const d=.3*Math.abs(m-p);return`M ${m} ${u} C ${m+d} ${u}, ${p-d} ${c}, ${p} ${c}`}}),g=_e(()=>({"--temporary":s.isTemporary,"--allowed":s.state===Hi.ALLOWED,"--forbidden":s.state===Hi.FORBIDDEN}));return{d:l,classes:g}}}),xH=["d"];function BH(s,n,i,o,l,g){return oe(),be("path",{class:tt(["baklava-connection",s.classes]),d:s.d},null,10,xH)}const MR=gs(DH,[["render",BH]]);function PH(s){return document.getElementById(s.id)}function va(s){const n=document.getElementById(s.id),i=n==null?void 0:n.getElementsByClassName("__port");return{node:(n==null?void 0:n.closest(".baklava-node"))??null,interface:n,port:i&&i.length>0?i[0]:null}}const UH=Xe({components:{"connection-view":MR},props:{connection:{type:Object,required:true}},setup(s){const{graph:n}=ji();let i;const o=Ee({x1:0,y1:0,x2:0,y2:0}),l=_e(()=>s.connection.isInDanger?Hi.FORBIDDEN:Hi.NONE),g=_e(()=>{var c;return(c=n.value.findNodeById(s.connection.from.nodeId))==null?void 0:c.position}),m=_e(()=>{var c;return(c=n.value.findNodeById(s.connection.to.nodeId))==null?void 0:c.position}),u=c=>c.node&&c.interface&&c.port?[c.node.offsetLeft+c.interface.offsetLeft+c.port.offsetLeft+c.port.clientWidth/2,c.node.offsetTop+c.interface.offsetTop+c.port.offsetTop+c.port.clientHeight/2]:[0,0],p=()=>{const c=va(s.connection.from),d=va(s.connection.to);c.node&&d.node&&(i||(i=new ResizeObserver(()=>{p()}),i.observe(c.node),i.observe(d.node)));const[_,b]=u(c),[$,E]=u(d);o.value={x1:_,y1:b,x2:$,y2:E}};return Ws(async()=>{await rs(),p()}),kr(()=>{i&&i.disconnect()}),Ct([g,m],()=>p(),{deep:true}),{d:o,state:l}}});function FH(s,n,i,o,l,g){const m=ht("connection-view");return oe(),Je(m,{x1:s.d.x1,y1:s.d.y1,x2:s.d.x2,y2:s.d.y2,state:s.state},null,8,["x1","y1","x2","y2","state"])}const GH=gs(UH,[["render",FH]]);function ch(s){return s.node&&s.interface&&s.port?[s.node.offsetLeft+s.interface.offsetLeft+s.port.offsetLeft+s.port.clientWidth/2,s.node.offsetTop+s.interface.offsetTop+s.port.offsetTop+s.port.clientHeight/2]:[0,0]}const HH=Xe({components:{"connection-view":MR},props:{connection:{type:Object,required:true}},setup(s){const n=_e(()=>s.connection?s.connection.status:Hi.NONE);return{d:_e(()=>{if(!s.connection)return{input:[0,0],output:[0,0]};const o=ch(va(s.connection.from)),l=s.connection.to?ch(va(s.connection.to)):[s.connection.mx||o[0],s.connection.my||o[1]];return s.connection.from.isInput?{input:l,output:o}:{input:o,output:l}}),status:n}}});function VH(s,n,i,o,l,g){const m=ht("connection-view");return oe(),Je(m,{x1:s.d.input[0],y1:s.d.input[1],x2:s.d.output[0],y2:s.d.output[1],state:s.status,"is-temporary":""},null,8,["x1","y1","x2","y2","state"])}const WH=gs(HH,[["render",VH]]),zH=Xe({setup(){const{viewModel:s}=Ai(),{graph:n}=ji(),i=Ee(null),o=cn(s.value.settings.sidebar,"width"),l=_e(()=>s.value.settings.sidebar.resizable),g=_e(()=>{const _=n.value.sidebar.nodeId;return n.value.nodes.find(b=>b.id===_)}),m=_e(()=>({width:`${o.value}px`})),u=_e(()=>g.value?[...Object.values(g.value.inputs),...Object.values(g.value.outputs)].filter(b=>b.displayInSidebar&&b.component):[]),p=()=>{n.value.sidebar.visible=false},c=()=>{window.addEventListener("mousemove",d),window.addEventListener("mouseup",()=>{window.removeEventListener("mousemove",d)},{once:true})},d=_=>{var b,$;const E=(($=(b=i.value)==null?void 0:b.parentElement)==null?void 0:$.getBoundingClientRect().width)??500;let y=o.value-_.movementX;y<300?y=300:y>.9*E&&(y=.9*E),o.value=y};return{el:i,graph:n,resizable:l,node:g,styles:m,displayedInterfaces:u,startResize:c,close:p}}}),jH={class:"__header"},XH={class:"__node-name"};function KH(s,n,i,o,l,g){return oe(),be("div",{ref:"el",class:tt(["baklava-sidebar",{"--open":s.graph.sidebar.visible}]),style:Js(s.styles)},[s.resizable?(oe(),be("div",{key:0,class:"__resizer",onMousedown:n[0]||(n[0]=(...m)=>s.startResize&&s.startResize(...m))},null,32)):qe("",true),he("div",jH,[he("button",{tabindex:"-1",class:"__close",onClick:n[1]||(n[1]=(...m)=>s.close&&s.close(...m))},"×"),he("div",XH,[he("b",null,Bt(s.node?s.node.title:""),1)])]),(oe(true),be(Pt,null,di(s.displayedInterfaces,m=>(oe(),be("div",{key:m.id,class:"__interface"},[(oe(),Je(ui(m.component),{modelValue:m.value,"onUpdate:modelValue":u=>m.value=u,node:s.node,intf:m},null,8,["modelValue","onUpdate:modelValue","node","intf"]))]))),128))],6)}const YH=gs(zH,[["render",KH]]),qH=Xe({__name:"Minimap",setup(s){const{viewModel:n}=Ai(),{graph:i}=ji(),o=Ee(null),l=Ee(false);let g,m=false,u={x1:0,y1:0,x2:0,y2:0},p;const c=()=>{var A,L;if(!g)return;g.canvas.width=o.value.offsetWidth,g.canvas.height=o.value.offsetHeight;const I=new Map,k=new Map;for(const W of i.value.nodes){const j=PH(W),K=(j==null?void 0:j.offsetWidth)??0,ee=(j==null?void 0:j.offsetHeight)??0,M=((A=W.position)==null?void 0:A.x)??0,F=((L=W.position)==null?void 0:L.y)??0;I.set(W,{x1:M,y1:F,x2:M+K,y2:F+ee}),k.set(W,j)}const B={x1:Number.MAX_SAFE_INTEGER,y1:Number.MAX_SAFE_INTEGER,x2:Number.MIN_SAFE_INTEGER,y2:Number.MIN_SAFE_INTEGER};for(const W of I.values())W.x1<B.x1&&(B.x1=W.x1),W.y1<B.y1&&(B.y1=W.y1),W.x2>B.x2&&(B.x2=W.x2),W.y2>B.y2&&(B.y2=W.y2);const U=50;B.x1-=U,B.y1-=U,B.x2+=U,B.y2+=U,u=B;const P=g.canvas.width/g.canvas.height,z=(u.x2-u.x1)/(u.y2-u.y1);if(P>z){const W=(P-z)*(u.y2-u.y1)*.5;u.x1-=W,u.x2+=W}else{const W=u.x2-u.x1,j=u.y2-u.y1,K=(W-P*j)/P*.5;u.y1-=K,u.y2+=K}g.clearRect(0,0,g.canvas.width,g.canvas.height),g.strokeStyle="white";for(const W of i.value.connections){const[j,K]=ch(va(W.from)),[ee,M]=ch(va(W.to)),[F,V]=d(j,K),[X,H]=d(ee,M);if(g.beginPath(),g.moveTo(F,V),n.value.settings.useStraightConnections)g.lineTo(X,H);else{const ne=.3*Math.abs(F-X);g.bezierCurveTo(F+ne,V,X-ne,H,X,H)}g.stroke()}g.strokeStyle="lightgray";for(const[W,j]of I.entries()){const[K,ee]=d(j.x1,j.y1),[M,F]=d(j.x2,j.y2);g.fillStyle=b(k.get(W)),g.beginPath(),g.rect(K,ee,M-K,F-ee),g.fill(),g.stroke()}if(l.value){const W=E(),[j,K]=d(W.x1,W.y1),[ee,M]=d(W.x2,W.y2);g.fillStyle="rgba(255, 255, 255, 0.2)",g.fillRect(j,K,ee-j,M-K)}},d=(A,L)=>[(A-u.x1)/(u.x2-u.x1)*g.canvas.width,(L-u.y1)/(u.y2-u.y1)*g.canvas.height],_=(A,L)=>[A*(u.x2-u.x1)/g.canvas.width+u.x1,L*(u.y2-u.y1)/g.canvas.height+u.y1],b=A=>{if(A){const L=A.querySelector(".__content");if(L){const k=$(L);if(k)return k}const I=$(A);if(I)return I}return"gray"},$=A=>{const L=getComputedStyle(A).backgroundColor;if(L&&L!=="rgba(0, 0, 0, 0)")return L},E=()=>{const A=o.value.parentElement.offsetWidth,L=o.value.parentElement.offsetHeight,I=A/i.value.scaling-i.value.panning.x,k=L/i.value.scaling-i.value.panning.y;return{x1:-i.value.panning.x,y1:-i.value.panning.y,x2:I,y2:k}},y=A=>{A.button===0&&(m=true,f(A))},f=A=>{if(m){const[L,I]=_(A.offsetX,A.offsetY),k=E(),B=(k.x2-k.x1)/2,U=(k.y2-k.y1)/2;i.value.panning.x=-(L-B),i.value.panning.y=-(I-U)}},v=()=>{m=false},T=()=>{l.value=true},S=()=>{l.value=false,v()};Ct([l,i.value.panning,()=>i.value.scaling,()=>i.value.connections.length],()=>{c()});const R=_e(()=>i.value.nodes.map(A=>A.position)),O=_e(()=>i.value.nodes.map(A=>A.width));return Ct([R,O],()=>{c()},{deep:true}),Ws(()=>{g=o.value.getContext("2d"),g.imageSmoothingQuality="high",c(),p=setInterval(c,500)}),kr(()=>{clearInterval(p)}),(A,L)=>(oe(),be("canvas",{ref_key:"canvas",ref:o,class:"baklava-minimap",onMouseenter:T,onMouseleave:S,onMousedown:Is(y,["self"]),onMousemove:Is(f,["self"]),onMouseup:v,onContextmenu:L[0]||(L[0]=Is(()=>{},["stop","prevent"]))},null,544))}}),JH=Xe({components:{ContextMenu:$m,VerticalDots:NR},props:{type:{type:String,required:true},title:{type:String,required:true}},setup(s){const{viewModel:n}=Ai(),{switchGraph:i}=ji(),o=Ee(false),l=_e(()=>s.type.startsWith(ic));return{showContextMenu:o,hasContextMenu:l,contextMenuItems:[{label:"Edit Subgraph",value:"editSubgraph"},{label:"Delete Subgraph",value:"deleteSubgraph"}],openContextMenu:()=>{o.value=true},onContextMenuClick:p=>{const c=s.type.substring(ic.length),d=n.value.editor.graphTemplates.find(_=>_.id===c);if(d)switch(p){case"editSubgraph":i(d);break;case"deleteSubgraph":n.value.editor.removeGraphTemplate(d);break}}}}}),ZH=["data-node-type"],QH={class:"__title"},eV={class:"__title-label"},tV={key:0,class:"__menu"};function sV(s,n,i,o,l,g){const m=ht("vertical-dots"),u=ht("context-menu");return oe(),be("div",{class:"baklava-node --palette","data-node-type":s.type},[he("div",QH,[he("div",eV,Bt(s.title),1),s.hasContextMenu?(oe(),be("div",tV,[Me(m,{class:"--clickable",onPointerdown:n[0]||(n[0]=Is(()=>{},["stop","prevent"])),onClick:Is(s.openContextMenu,["stop","prevent"])},null,8,["onClick"]),Me(u,{modelValue:s.showContextMenu,"onUpdate:modelValue":n[1]||(n[1]=p=>s.showContextMenu=p),x:-100,y:0,items:s.contextMenuItems,onClick:s.onContextMenuClick,onPointerdown:n[2]||(n[2]=Is(()=>{},["stop","prevent"]))},null,8,["modelValue","items","onClick"])])):qe("",true)])],8,ZH)}const my=gs(JH,[["render",sV]]),iV={key:0},nV=Xe({__name:"NodePalette",setup(s){const{viewModel:n}=Ai(),{x:i,y:o}=dH(),{transform:l}=OR(),g=CR(n),m=Vs("editorEl"),u=Ee(null),p=_e(()=>{if(!u.value||!(m!=null&&m.value))return{};const{left:d,top:_}=m.value.getBoundingClientRect();return{top:`${o.value-_}px`,left:`${i.value-d}px`}}),c=(d,_)=>{u.value={type:d,nodeInformation:_};const b=()=>{const $=Vi(new _.type);n.value.displayedGraph.addNode($);const E=m.value.getBoundingClientRect(),[y,f]=l(i.value-E.left,o.value-E.top);$.position.x=y,$.position.y=f,u.value=null,document.removeEventListener("pointerup",b)};document.addEventListener("pointerup",b)};return(d,_)=>(oe(),be(Pt,null,[he("div",{class:"baklava-node-palette",onContextmenu:_[0]||(_[0]=Is(()=>{},["stop","prevent"]))},[(oe(true),be(Pt,null,di(ue(g),b=>(oe(),be("section",{key:b.name},[b.name!=="default"?(oe(),be("h1",iV,Bt(b.name),1)):qe("",true),(oe(true),be(Pt,null,di(b.nodeTypes,($,E)=>(oe(),Je(my,{key:E,type:E,title:$.title,onPointerdown:y=>c(E,$)},null,8,["type","title","onPointerdown"]))),128))]))),128))],32),Me(oc,{name:"fade"},{default:je(()=>[u.value?(oe(),be("div",{key:0,class:"baklava-dragged-node",style:Js(p.value)},[Me(my,{type:u.value.type,title:u.value.nodeInformation.title},null,8,["type","title"])],4)):qe("",true)]),_:1})],64))}});let Fu;const rV=new Uint8Array(16);function oV(){if(!Fu&&(Fu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Fu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Fu(rV)}const Ns=[];for(let s=0;s<256;++s)Ns.push((s+256).toString(16).slice(1));function aV(s,n=0){return Ns[s[n+0]]+Ns[s[n+1]]+Ns[s[n+2]]+Ns[s[n+3]]+"-"+Ns[s[n+4]]+Ns[s[n+5]]+"-"+Ns[s[n+6]]+Ns[s[n+7]]+"-"+Ns[s[n+8]]+Ns[s[n+9]]+"-"+Ns[s[n+10]]+Ns[s[n+11]]+Ns[s[n+12]]+Ns[s[n+13]]+Ns[s[n+14]]+Ns[s[n+15]]}const lV=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ey={randomUUID:lV};function uh(s,n,i){if(Ey.randomUUID&&!n&&!s)return Ey.randomUUID();s=s||{};const o=s.random||(s.rng||oV)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,n){i=i||0;for(let l=0;l<16;++l)n[i+l]=o[l];return n}return aV(o)}const nc="SAVE_SUBGRAPH";function cV(s,n){const i=()=>{const o=s.value;if(!o.template)throw new Error("Graph template property not set");o.template.update(o.save()),o.template.panning=o.panning,o.template.scaling=o.scaling};n.registerCommand(nc,{canExecute:()=>{var o;return s.value!==((o=s.value.editor)==null?void 0:o.graph)},execute:i})}Xe({props:{intf:{type:Object,required:true}},setup(s){return{onClick:()=>{s.intf.callback&&s.intf.callback()}}}});const vy=9;function uV(s){return"validate"in s}const DR=(s,n=3)=>{const i=Ee(null),o=Ee(false),l=Ee(false),g=Ee("0"),m=_e(()=>{const _=s.value.value.toFixed(n);return _.length>vy?s.value.value.toExponential(vy-5):_}),u=_=>Number.isNaN(_)?false:uV(s.value)?s.value.validate(_):true,p=_=>{u(_)&&(s.value.value=_)};return Ct(g,()=>{l.value=false}),{editMode:o,invalid:l,tempValue:g,inputEl:i,stringRepresentation:m,validate:u,setValue:p,enterEditMode:async()=>{g.value=s.value.value.toFixed(n),o.value=true,await rs(),i.value&&i.value.focus()},leaveEditMode:()=>{const _=parseFloat(g.value);u(_)?(p(_),o.value=false):l.value=true}}},hV={},dV={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},_V=he("polyline",{points:"6 9 12 15 18 9"},null,-1),pV=[_V];function gV(s,n){return oe(),be("svg",dV,pV)}const xR=gs(hV,[["render",gV]]);Xe({components:{"i-arrow":xR},props:{intf:{type:Object,required:true}},setup(s){const n=DR(cn(s,"intf"),0);return{...n,increment:()=>{n.setValue(s.intf.value+1)},decrement:()=>{n.setValue(s.intf.value-1)}}}});const fV=Xe({components:{"i-arrow":xR},props:{intf:{type:Object,required:true}},setup(s){const n=Ee(null),i=Ee(false),o=_e(()=>s.intf.items.find(m=>typeof m=="string"?m===s.intf.value:m.value===s.intf.value)),l=_e(()=>o.value?typeof o.value=="string"?o.value:o.value.text:""),g=m=>{s.intf.value=typeof m=="string"?m:m.value};return AR(n,()=>{i.value=false}),{el:n,open:i,selectedItem:o,selectedText:l,setSelected:g}}}),mV=["title"],EV={class:"__selected"},vV={class:"__text"},bV={class:"__icon"},TV={class:"__dropdown"},SV={class:"item --header"},$V=["onClick"];function yV(s,n,i,o,l,g){const m=ht("i-arrow");return oe(),be("div",{ref:"el",class:tt(["baklava-select",{"--open":s.open}]),title:s.intf.name,onClick:n[0]||(n[0]=u=>s.open=!s.open)},[he("div",EV,[he("div",vV,Bt(s.selectedText),1),he("div",bV,[Me(m)])]),Me(oc,{name:"slide-fade"},{default:je(()=>[ci(he("div",TV,[he("div",SV,Bt(s.intf.name),1),(oe(true),be(Pt,null,di(s.intf.items,(u,p)=>(oe(),be("div",{key:p,class:tt(["item",{"--active":u===s.selectedItem}]),onClick:c=>s.setSelected(u)},Bt(typeof u=="string"?u:u.text),11,$V))),128))],512),[[Fi,s.open]])]),_:1})],10,mV)}const RV=gs(fV,[["render",yV]]);class ym extends dt{constructor(n,i,o){super(n,i),this.component=qu(RV),this.items=o}}Xe({props:{intf:{type:Object,required:true}},setup(s){const n=Ee(null),i=DR(cn(s,"intf")),o=Ee(false),l=Ee(false),g=_e(()=>Math.min(100,Math.max(0,(s.intf.value-s.intf.min)*100/(s.intf.max-s.intf.min))));return{...i,el:n,percentage:g,mousedown:()=>{i.editMode.value||(l.value=true)},mouseup:()=>{i.editMode.value||(o.value||i.enterEditMode(),l.value=false,o.value=false)},mousemove:d=>{if(i.editMode.value)return;const _=Math.max(s.intf.min,Math.min(s.intf.max,(s.intf.max-s.intf.min)*(d.offsetX/n.value.clientWidth)+s.intf.min));l.value&&(i.setValue(_),o.value=true)},mouseleave:d=>{i.editMode.value||(l.value&&(d.offsetX>=n.value.clientWidth?i.setValue(s.intf.max):d.offsetX<=0&&i.setValue(s.intf.min)),l.value=false,o.value=false)}}}});Xe({props:{intf:{type:Object,required:true}}});const IV=Xe({props:{intf:{type:Object,required:true},modelValue:{type:String,required:true}},emits:["update:modelValue"],setup(s,{emit:n}){return{v:_e({get:()=>s.modelValue,set:o=>{n("update:modelValue",o)}})}}}),CV=["placeholder","title"];function OV(s,n,i,o,l,g){return oe(),be("div",null,[ci(he("input",{"onUpdate:modelValue":n[0]||(n[0]=m=>s.v=m),type:"text",class:"baklava-input",placeholder:s.intf.name,title:s.intf.name},null,8,CV),[[ky,s.v]])])}const kV=gs(IV,[["render",OV]]);class ei extends dt{constructor(){super(...arguments),this.component=qu(kV)}}Xe({props:{intf:{type:Object,required:true},modelValue:{type:String,required:true}},emits:["update:modelValue"],setup(s,{emit:n}){return{v:_e({get:()=>s.modelValue,set:o=>{n("update:modelValue",o)}})}}});class BR extends vm{constructor(){super(...arguments),this._title="Subgraph Input",this.inputs={name:new ei("Name","Input").setPort(false)},this.outputs={placeholder:new dt("Connection",void 0)}}}class PR extends bm{constructor(){super(...arguments),this._title="Subgraph Output",this.inputs={name:new ei("Name","Output").setPort(false),placeholder:new dt("Connection",void 0)},this.outputs={output:new dt("Output",void 0).setHidden(true)}}}const UR="CREATE_SUBGRAPH",by=[fa,ma];function wV(s,n,i){const o=()=>s.value.selectedNodes.filter(g=>!by.includes(g.type)).length>0,l=()=>{const{viewModel:g}=Ai(),m=s.value,u=s.value.editor;if(m.selectedNodes.length===0)return;const p=m.selectedNodes.filter(k=>!by.includes(k.type)),c=p.flatMap(k=>Object.values(k.inputs)),d=p.flatMap(k=>Object.values(k.outputs)),_=m.connections.filter(k=>!d.includes(k.from)&&c.includes(k.to)),b=m.connections.filter(k=>d.includes(k.from)&&!c.includes(k.to)),$=m.connections.filter(k=>d.includes(k.from)&&c.includes(k.to)),E=p.map(k=>k.save()),y=$.map(k=>({id:k.id,from:k.from.id,to:k.to.id})),f=new Map,{xLeft:v,xRight:T,yTop:S}=AV(p);for(const[k,B]of _.entries()){const U=new BR;U.inputs.name.value=B.to.name,E.push({...U.save(),position:{x:T-g.value.settings.nodes.defaultWidth-100,y:S+k*200}}),y.push({id:uh(),from:U.outputs.placeholder.id,to:B.to.id}),f.set(B.to.id,U.graphInterfaceId)}for(const[k,B]of b.entries()){const U=new PR;U.inputs.name.value=B.from.name,E.push({...U.save(),position:{x:v+100,y:S+k*200}}),y.push({id:uh(),from:B.from.id,to:U.inputs.placeholder.id}),f.set(B.from.id,U.graphInterfaceId)}const R=Vi(new Ch({connections:y,nodes:E,inputs:[],outputs:[]},u));u.addGraphTemplate(R);const O=u.nodeTypes.get(Ea(R));if(!O)throw new Error("Unable to create subgraph: Could not find corresponding graph node type");m.activeTransactions++;const A=Vi(new O.type);m.addNode(A);const L=Math.round(p.map(k=>k.position.x).reduce((k,B)=>k+B,0)/p.length),I=Math.round(p.map(k=>k.position.y).reduce((k,B)=>k+B,0)/p.length);A.position.x=L,A.position.y=I,_.forEach(k=>{m.removeConnection(k),m.addConnection(k.from,A.inputs[f.get(k.to.id)])}),b.forEach(k=>{m.removeConnection(k),m.addConnection(A.outputs[f.get(k.from.id)],k.to)}),p.forEach(k=>m.removeNode(k)),m.activeTransactions--,n.canExecuteCommand(nc)&&n.executeCommand(nc),i(R),s.value.panning={...m.panning},s.value.scaling=m.scaling};n.registerCommand(UR,{canExecute:o,execute:l})}function AV(s){const n=s.reduce((l,g)=>{const m=g.position.x;return m<l?m:l},1/0),i=s.reduce((l,g)=>{const m=g.position.y;return m<l?m:l},1/0);return{xLeft:s.reduce((l,g)=>{const m=g.position.x+g.width;return m>l?m:l},-1/0),xRight:n,yTop:i}}class Ty{constructor(n,i){this.type=n,n==="addNode"?this.nodeId=i:this.nodeState=i}undo(n){this.type==="addNode"?this.removeNode(n):this.addNode(n)}redo(n){this.type==="addNode"&&this.nodeState?this.addNode(n):this.type==="removeNode"&&this.nodeId&&this.removeNode(n)}addNode(n){const i=n.editor.nodeTypes.get(this.nodeState.type);if(!i)return;const o=new i.type;n.addNode(o),o.load(this.nodeState),this.nodeId=o.id}removeNode(n){const i=n.nodes.find(o=>o.id===this.nodeId);i&&(this.nodeState=i.save(),n.removeNode(i))}}class Sy{constructor(n,i){if(this.type=n,n==="addConnection")this.connectionId=i;else{const o=i;this.connectionState={id:o.id,from:o.from.id,to:o.to.id}}}undo(n){this.type==="addConnection"?this.removeConnection(n):this.addConnection(n)}redo(n){this.type==="addConnection"&&this.connectionState?this.addConnection(n):this.type==="removeConnection"&&this.connectionId&&this.removeConnection(n)}addConnection(n){const i=n.findNodeInterface(this.connectionState.from),o=n.findNodeInterface(this.connectionState.to);if(!i||!o)return;const l=n.addConnection(i,o);l&&(l.id=this.connectionState.id),this.connectionId=l==null?void 0:l.id}removeConnection(n){const i=n.connections.find(o=>o.id===this.connectionId);i&&(this.connectionState={id:i.id,from:i.from.id,to:i.to.id},n.removeConnection(i))}}class LV{constructor(n){if(this.type="transaction",n.length===0)throw new Error("Can't create a transaction with no steps");this.steps=n}undo(n){for(let i=this.steps.length-1;i>=0;i--)this.steps[i].undo(n)}redo(n){for(let i=0;i<this.steps.length;i++)this.steps[i].redo(n)}}const Mf="UNDO",Df="REDO",Rm="START_TRANSACTION",Im="COMMIT_TRANSACTION";function NV(s,n){const i=Symbol("HistoryToken"),o=Ee(200),l=Ee([]),g=Ee(false),m=Ee(-1),u=Ee(false),p=Ee([]),c=f=>{if(!g.value)if(u.value)p.value.push(f);else for(m.value!==l.value.length-1&&(l.value=l.value.slice(0,m.value+1)),l.value.push(f),m.value++;l.value.length>o.value;)l.value.shift()},d=()=>{u.value=true},_=()=>{u.value=false,p.value.length>0&&(c(new LV(p.value)),p.value=[])},b=()=>l.value.length!==0&&m.value!==-1,$=()=>{b()&&(g.value=true,l.value[m.value--].undo(s.value),g.value=false)},E=()=>l.value.length!==0&&m.value<l.value.length-1,y=()=>{E()&&(g.value=true,l.value[++m.value].redo(s.value),g.value=false)};return Ct(s,(f,v)=>{v&&(v.events.addNode.unsubscribe(i),v.events.removeNode.unsubscribe(i),v.events.addConnection.unsubscribe(i),v.events.removeConnection.unsubscribe(i)),f&&(f.events.addNode.subscribe(i,T=>{c(new Ty("addNode",T.id))}),f.events.removeNode.subscribe(i,T=>{c(new Ty("removeNode",T.save()))}),f.events.addConnection.subscribe(i,T=>{c(new Sy("addConnection",T.id))}),f.events.removeConnection.subscribe(i,T=>{c(new Sy("removeConnection",T))}))},{immediate:true}),n.registerCommand(Mf,{canExecute:b,execute:$}),n.registerCommand(Df,{canExecute:E,execute:y}),n.registerCommand(Rm,{canExecute:()=>!u.value,execute:d}),n.registerCommand(Im,{canExecute:()=>u.value,execute:_}),n.registerHotkey(["Control","z"],Mf),n.registerHotkey(["Control","y"],Df),Vi({maxSteps:o})}const xf="DELETE_NODES";function MV(s,n){n.registerCommand(xf,{canExecute:()=>s.value.selectedNodes.length>0,execute(){n.executeCommand(Rm);for(let i=s.value.selectedNodes.length-1;i>=0;i--){const o=s.value.selectedNodes[i];s.value.removeNode(o)}n.executeCommand(Im)}}),n.registerHotkey(["Delete"],xf)}const FR="SWITCH_TO_MAIN_GRAPH";function DV(s,n,i){n.registerCommand(FR,{canExecute:()=>s.value!==s.value.editor.graph,execute:()=>{n.executeCommand(nc),i(s.value.editor.graph)}})}function xV(s,n,i){MV(s,n),wV(s,n,i),cV(s,n),DV(s,n,i)}const Bf="COPY",Pf="PASTE",BV="CLEAR_CLIPBOARD";function PV(s,n,i){const o=Symbol("ClipboardToken"),l=Ee(""),g=Ee(""),m=_e(()=>!l.value),u=()=>{l.value="",g.value=""},p=()=>{const _=s.value.selectedNodes.flatMap($=>[...Object.values($.inputs),...Object.values($.outputs)]),b=s.value.connections.filter($=>_.includes($.from)||_.includes($.to)).map($=>({from:$.from.id,to:$.to.id}));g.value=JSON.stringify(b),l.value=JSON.stringify(s.value.selectedNodes.map($=>$.save()))},c=(_,b,$)=>{for(const E of _){let y;if((!$||$==="input")&&(y=Object.values(E.inputs).find(f=>f.id===b)),!y&&(!$||$==="output")&&(y=Object.values(E.outputs).find(f=>f.id===b)),y)return y}},d=()=>{if(m.value)return;const _=new Map,b=JSON.parse(l.value),$=JSON.parse(g.value),E=[],y=[],f=s.value;i.executeCommand(Rm);for(const v of b){const T=n.value.nodeTypes.get(v.type);if(!T){console.warn(`Node type ${v.type} not registered`);return}const S=new T.type,R=S.id;E.push(S),S.hooks.beforeLoad.subscribe(o,O=>{const A=O;return A.position&&(A.position.x+=100,A.position.y+=100),S.hooks.beforeLoad.unsubscribe(o),A}),f.addNode(S),S.load({...v,id:R}),S.id=R,_.set(v.id,R);for(const O of Object.values(S.inputs)){const A=uh();_.set(O.id,A),O.id=A}for(const O of Object.values(S.outputs)){const A=uh();_.set(O.id,A),O.id=A}}for(const v of $){const T=c(E,_.get(v.from),"output"),S=c(E,_.get(v.to),"input");if(!T||!S)continue;const R=f.addConnection(T,S);R&&y.push(R)}return s.value.selectedNodes=E,i.executeCommand(Im),{newNodes:E,newConnections:y}};return i.registerCommand(Bf,{canExecute:()=>s.value.selectedNodes.length>0,execute:p}),i.registerHotkey(["Control","c"],Bf),i.registerCommand(Pf,{canExecute:()=>!m.value,execute:d}),i.registerHotkey(["Control","v"],Pf),i.registerCommand(BV,{canExecute:()=>true,execute:u}),Vi({isEmpty:m})}const UV="OPEN_SIDEBAR";function FV(s,n){n.registerCommand(UV,{execute:i=>{s.value.sidebar.nodeId=i,s.value.sidebar.visible=true},canExecute:()=>true})}function GV(s,n){FV(s,n)}const HV={},VV={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},WV=he("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),zV=he("path",{d:"M9 13l-4 -4l4 -4m-4 4h11a4 4 0 0 1 0 8h-1"},null,-1),jV=[WV,zV];function XV(s,n){return oe(),be("svg",VV,jV)}const KV=gs(HV,[["render",XV]]),YV={},qV={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},JV=he("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),ZV=he("path",{d:"M15 13l4 -4l-4 -4m4 4h-11a4 4 0 0 0 0 8h1"},null,-1),QV=[JV,ZV];function e3(s,n){return oe(),be("svg",qV,QV)}const t3=gs(YV,[["render",e3]]),s3={},i3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},n3=he("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),r3=he("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1),o3=he("line",{x1:"5",y1:"12",x2:"11",y2:"18"},null,-1),a3=he("line",{x1:"5",y1:"12",x2:"11",y2:"6"},null,-1),l3=[n3,r3,o3,a3];function c3(s,n){return oe(),be("svg",i3,l3)}const u3=gs(s3,[["render",c3]]),h3={},d3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},_3=he("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),p3=he("path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"},null,-1),g3=he("rect",{x:"9",y:"3",width:"6",height:"4",rx:"2"},null,-1),f3=[_3,p3,g3];function m3(s,n){return oe(),be("svg",d3,f3)}const E3=gs(h3,[["render",m3]]),v3={},b3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},T3=he("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),S3=he("rect",{x:"8",y:"8",width:"12",height:"12",rx:"2"},null,-1),$3=he("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"},null,-1),y3=[T3,S3,$3];function R3(s,n){return oe(),be("svg",b3,y3)}const I3=gs(v3,[["render",R3]]),C3={},O3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},k3=he("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),w3=he("path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"},null,-1),A3=he("circle",{cx:"12",cy:"14",r:"2"},null,-1),L3=he("polyline",{points:"14 4 14 8 8 8 8 4"},null,-1),N3=[k3,w3,A3,L3];function M3(s,n){return oe(),be("svg",O3,N3)}const D3=gs(C3,[["render",M3]]),x3={},B3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},P3=Uf('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 3h4v4h-4z"></path><path d="M3 17h4v4h-4z"></path><path d="M17 17h4v4h-4z"></path><path d="M7 17l5 -4l5 4"></path><line x1="12" y1="7" x2="12" y2="13"></line>',6),U3=[P3];function F3(s,n){return oe(),be("svg",B3,U3)}const G3=gs(x3,[["render",F3]]),H3={},V3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},W3=Uf('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M8 8m0 1a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1z"></path><path d="M12 20v.01"></path><path d="M16 20v.01"></path><path d="M8 20v.01"></path><path d="M4 20v.01"></path><path d="M4 16v.01"></path><path d="M4 12v.01"></path><path d="M4 8v.01"></path><path d="M4 4v.01"></path><path d="M8 4v.01"></path><path d="M12 4v.01"></path><path d="M16 4v.01"></path><path d="M20 4v.01"></path><path d="M20 8v.01"></path><path d="M20 12v.01"></path><path d="M20 16v.01"></path><path d="M20 20v.01"></path>',18),z3=[W3];function j3(s,n){return oe(),be("svg",V3,z3)}const X3=gs(H3,[["render",j3]]),K3={},Y3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},q3=Uf('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 7l16 0"></path><path d="M10 11l0 6"></path><path d="M14 11l0 6"></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path>',6),J3=[q3];function Z3(s,n){return oe(),be("svg",Y3,J3)}const Q3=gs(K3,[["render",Z3]]),e4=Xe({props:{command:{type:String,required:true},title:{type:String,required:true},icon:{type:Object,required:false,default:void 0}},setup(){const{viewModel:s}=Ai();return{viewModel:s}}}),t4=["disabled","title"];function s4(s,n,i,o,l,g){return oe(),be("button",{class:"baklava-toolbar-entry baklava-toolbar-button",disabled:!s.viewModel.commandHandler.canExecuteCommand(s.command),title:s.title,onClick:n[0]||(n[0]=m=>s.viewModel.commandHandler.executeCommand(s.command))},[s.icon?(oe(),Je(ui(s.icon),{key:0})):(oe(),be(Pt,{key:1},[xt(Bt(s.title),1)],64))],8,t4)}const i4=gs(e4,[["render",s4]]),n4=Xe({components:{ToolbarButton:i4},setup(){const{viewModel:s}=Ai();return{isSubgraph:_e(()=>s.value.displayedGraph!==s.value.editor.graph),commands:[{command:Bf,title:"Copy",icon:I3},{command:Pf,title:"Paste",icon:E3},{command:xf,title:"Delete selected nodes",icon:Q3},{command:Mf,title:"Undo",icon:KV},{command:Df,title:"Redo",icon:t3},{command:Xu,title:"Box Select",icon:X3},{command:UR,title:"Create Subgraph",icon:G3}],subgraphCommands:[{command:nc,title:"Save Subgraph",icon:D3},{command:FR,title:"Back to Main Graph",icon:u3}]}}});function r4(s,n,i,o,l,g){const m=ht("toolbar-button");return oe(),be("div",{class:"baklava-toolbar",onContextmenu:n[0]||(n[0]=Is(()=>{},["stop","prevent"]))},[(oe(true),be(Pt,null,di(s.commands,u=>(oe(),Je(m,{key:u.command,command:u.command,title:u.title,icon:u.icon},null,8,["command","title","icon"]))),128)),s.isSubgraph?(oe(true),be(Pt,{key:0},di(s.subgraphCommands,u=>(oe(),Je(m,{key:u.command,command:u.command,title:u.title,icon:u.icon},null,8,["command","title","icon"]))),128)):qe("",true)],32)}const o4=gs(n4,[["render",r4]]),a4={class:"connections-container"},l4=Xe({__name:"Editor",props:{viewModel:{}},setup(s){const n=s,i=Symbol("EditorToken"),o=cn(n,"viewModel");qG(o);const l=Ee(null);rc("editorEl",l);const g=_e(()=>n.viewModel.displayedGraph.nodes),m=_e(()=>n.viewModel.displayedGraph.nodes.map(I=>RR(cn(I,"position")))),u=_e(()=>n.viewModel.displayedGraph.connections),p=_e(()=>n.viewModel.displayedGraph.selectedNodes),c=JG(),d=ZG(),_=QG(o),b=eH(l),$=_e(()=>({...c.styles.value})),E=Ee(0);n.viewModel.editor.hooks.load.subscribe(i,I=>(E.value++,I));const y=I=>{c.onPointerMove(I),d.onMouseMove(I)},f=I=>{if(I.button===0){if(b.onPointerDown(I))return;I.target===l.value&&(O(),c.onPointerDown(I)),d.onMouseDown()}},v=I=>{c.onPointerUp(I),d.onMouseUp()},T=I=>{I.key==="Tab"&&I.preventDefault(),n.viewModel.commandHandler.handleKeyDown(I)},S=I=>{n.viewModel.commandHandler.handleKeyUp(I)},R=I=>{["Control","Shift"].some(k=>n.viewModel.commandHandler.pressedKeys.includes(k))||O(),n.viewModel.displayedGraph.selectedNodes.push(I)},O=()=>{n.viewModel.displayedGraph.selectedNodes=[]},A=I=>{for(const k of n.viewModel.displayedGraph.selectedNodes){const B=g.value.indexOf(k),U=m.value[B];U.onPointerDown(I),document.addEventListener("pointermove",U.onPointerMove)}document.addEventListener("pointerup",L)},L=()=>{for(const I of n.viewModel.displayedGraph.selectedNodes){const k=g.value.indexOf(I),B=m.value[k];B.onPointerUp(),document.removeEventListener("pointermove",B.onPointerMove)}document.removeEventListener("pointerup",L)};return(I,k)=>(oe(),be("div",{ref_key:"el",ref:l,tabindex:"-1",class:tt(["baklava-editor",{"baklava-ignore-mouse":!!ue(d).temporaryConnection.value||ue(c).dragging.value,"--temporary-connection":!!ue(d).temporaryConnection.value,"--start-selection-box":ue(b).startSelection}]),onPointermove:Is(y,["self"]),onPointerdown:f,onPointerup:v,onWheel:k[1]||(k[1]=Is((...B)=>ue(c).onMouseWheel&&ue(c).onMouseWheel(...B),["self"])),onKeydown:T,onKeyup:S,onContextmenu:k[2]||(k[2]=(...B)=>ue(_).open&&ue(_).open(...B))},[Mt(I.$slots,"background",{},()=>[Me(iH)]),Mt(I.$slots,"toolbar",{},()=>[I.viewModel.settings.toolbar.enabled?(oe(),Je(o4,{key:0})):qe("",true)]),Mt(I.$slots,"palette",{},()=>[I.viewModel.settings.palette.enabled?(oe(),Je(nV,{key:0})):qe("",true)]),(oe(),be("svg",a4,[(oe(true),be(Pt,null,di(u.value,B=>(oe(),be("g",{key:B.id+E.value.toString()},[Mt(I.$slots,"connection",{connection:B},()=>[Me(GH,{connection:B},null,8,["connection"])])]))),128)),Mt(I.$slots,"temporaryConnection",{temporaryConnection:ue(d).temporaryConnection.value},()=>[ue(d).temporaryConnection.value?(oe(),Je(WH,{key:0,connection:ue(d).temporaryConnection.value},null,8,["connection"])):qe("",true)])])),he("div",{class:"node-container",style:Js($.value)},[Me(uk,{name:"fade"},{default:je(()=>[(oe(true),be(Pt,null,di(g.value,(B,U)=>Mt(I.$slots,"node",{key:B.id+E.value.toString(),node:B,selected:p.value.includes(B),dragging:m.value[U].dragging.value,onSelect:P=>R(B),onStartDrag:A},()=>[Me(MH,{node:B,selected:p.value.includes(B),dragging:m.value[U].dragging.value,onSelect:P=>R(B),onStartDrag:A},null,8,["node","selected","dragging","onSelect"])])),128))]),_:3})],4),Mt(I.$slots,"sidebar",{},()=>[I.viewModel.settings.sidebar.enabled?(oe(),Je(YH,{key:0})):qe("",true)]),Mt(I.$slots,"minimap",{},()=>[I.viewModel.settings.enableMinimap?(oe(),Je(qH,{key:0})):qe("",true)]),Mt(I.$slots,"contextMenu",{contextMenu:ue(_)},()=>[I.viewModel.settings.contextMenu.enabled?(oe(),Je($m,{key:0,modelValue:ue(_).show.value,"onUpdate:modelValue":k[0]||(k[0]=B=>ue(_).show.value=B),items:ue(_).items.value,x:ue(_).x.value,y:ue(_).y.value,onClick:ue(_).onClick},null,8,["modelValue","items","x","y","onClick"])):qe("",true)]),ue(b).isSelecting?(oe(),be("div",{key:0,class:"selection-box",style:Js(ue(b).getStyles())},null,4)):qe("",true)],34))}});function c4(s){const n=Ee([]),i=Ee([]);return{pressedKeys:n,handleKeyDown:m=>{n.value.includes(m.key)||n.value.push(m.key),!(document.activeElement&&yR(document.activeElement))&&i.value.forEach(u=>{var p,c;u.keys.every(d=>n.value.includes(d))&&((p=u.options)!=null&&p.preventDefault&&m.preventDefault(),(c=u.options)!=null&&c.stopPropagation&&m.stopPropagation(),s(u.commandName))})},handleKeyUp:m=>{const u=n.value.indexOf(m.key);u>=0&&n.value.splice(u,1)},registerHotkey:(m,u,p)=>{i.value.push({keys:m,commandName:u,options:p})}}}const u4=()=>{const s=Ee(new Map),n=m=>s.value.has(m),i=(m,u)=>{if(s.value.has(m))throw new Error(`Command "${m}" already exists`);s.value.set(m,u)},o=(m,u=false,...p)=>{if(!s.value.has(m)){if(u)throw new Error(`[CommandHandler] Command ${m} not registered`);return}return s.value.get(m).execute(...p)},l=(m,u=false,...p)=>{if(!s.value.has(m)){if(u)throw new Error(`[CommandHandler] Command ${m} not registered`);return false}return s.value.get(m).canExecute(p)},g=c4(o);return Vi({hasCommand:n,registerCommand:i,executeCommand:o,canExecuteCommand:l,...g})},h4=s=>!(s instanceof Ih);function d4(s,n){return{switchGraph:o=>{let l;if(h4(o))l=new Ih(s.value),o.createGraph(l);else{if(o!==s.value.graph)throw new Error("Can only switch using 'Graph' instance when it is the root graph. Otherwise a 'GraphTemplate' must be used.");l=o}n.value&&n.value!==s.value.graph&&n.value.destroy(),l.panning=l.panning??o.panning??{x:0,y:0},l.scaling=l.scaling??o.scaling??1,l.selectedNodes=l.selectedNodes??[],l.sidebar=l.sidebar??{visible:false,nodeId:"",optionName:""},n.value=l}}}function _4(s,n){s.position=s.position??{x:0,y:0},s.disablePointerEvents=false,s.twoColumn=s.twoColumn??false,s.width=s.width??n.defaultWidth}const p4=()=>({useStraightConnections:false,enableMinimap:false,toolbar:{enabled:true},palette:{enabled:true},background:{gridSize:100,gridDivision:5,subGridVisibleThreshold:.6},sidebar:{enabled:true,width:300,resizable:true},displayValueOnHover:false,nodes:{defaultWidth:200,maxWidth:320,minWidth:150,resizable:false,reverseY:false},contextMenu:{enabled:true,additionalItems:[]}});function g4(s){const n=Ee(s??new KG),i=Symbol("ViewModelToken"),o=Ee(null),l=hk(o),{switchGraph:g}=d4(n,o),m=_e(()=>l.value&&l.value!==n.value.graph),u=Vi(p4()),p=u4(),c=NV(l,p),d=PV(l,n,p),_={renderNode:new zi(null),renderInterface:new zi(null)};return xV(l,p,g),GV(l,p),Ct(n,(b,$)=>{$&&($.events.registerGraph.unsubscribe(i),$.graphEvents.beforeAddNode.unsubscribe(i),b.nodeHooks.beforeLoad.unsubscribe(i),b.nodeHooks.afterSave.unsubscribe(i),b.graphTemplateHooks.beforeLoad.unsubscribe(i),b.graphTemplateHooks.afterSave.unsubscribe(i),b.graph.hooks.load.unsubscribe(i),b.graph.hooks.save.unsubscribe(i)),b&&(b.nodeHooks.beforeLoad.subscribe(i,(E,y)=>(y.position=E.position??{x:0,y:0},y.width=E.width??u.nodes.defaultWidth,y.twoColumn=E.twoColumn??false,E)),b.nodeHooks.afterSave.subscribe(i,(E,y)=>(E.position=y.position,E.width=y.width,E.twoColumn=y.twoColumn,E)),b.graphTemplateHooks.beforeLoad.subscribe(i,(E,y)=>(y.panning=E.panning,y.scaling=E.scaling,E)),b.graphTemplateHooks.afterSave.subscribe(i,(E,y)=>(E.panning=y.panning,E.scaling=y.scaling,E)),b.graph.hooks.load.subscribe(i,(E,y)=>(y.panning=E.panning,y.scaling=E.scaling,E)),b.graph.hooks.save.subscribe(i,(E,y)=>(E.panning=y.panning,E.scaling=y.scaling,E)),b.graphEvents.beforeAddNode.subscribe(i,E=>_4(E,{defaultWidth:u.nodes.defaultWidth})),n.value.registerNodeType(BR,{category:"Subgraphs"}),n.value.registerNodeType(PR,{category:"Subgraphs"}),g(b.graph))},{immediate:true}),Vi({editor:n,displayedGraph:l,isSubgraph:m,settings:u,commandHandler:p,history:c,clipboard:d,hooks:_,switchGraph:g})}function f4(s){let n;return pk({setup(){const i=g4();return n=i,{viewModel:i}},render(){return Yu(l4,{viewModel:this.viewModel})}}).mount(s),n}const m4=An({type:"输入",inputs:{name:()=>new ei("字段名称","").setPort(false)},outputs:{output:()=>new dt("输入值",0)},calculate(){return{}}}),E4=An({type:"输出",inputs:{output:()=>new dt("输出值",0)},calculate(){return{}}}),v4=[m4,E4].map(s=>[s,"输入与输出"]),b4=An({type:"获取对象属性",inputs:{object:()=>new dt("对象",0),property:()=>new ei("属性","")},outputs:{value:()=>new dt("值",0)},calculate(){return{}}}),T4=An({type:"设置对象属性",inputs:{object:()=>new dt("对象",0),property:()=>new ei("属性",""),value:()=>new ei("值","")},outputs:{value:()=>new dt("改变后的对象",0)},calculate(s,n){return{}}}),S4=Em({type:"创建对象",inputs:{prototype:()=>new ei("原型，用逗号分隔","").setPort(false)},outputs:{value:()=>new dt("对象",0)},onUpdate(){var s;return{inputs:Object.fromEntries((s=this.inputs.prototype.value)==null?void 0:s.split(",").filter(n=>n).map(n=>[n,()=>new dt(n,0)]))}}}),$4=Em({type:"分离对象",inputs:{value:()=>new dt("对象",0),prototype:()=>new ei("原型，用逗号分隔","").setPort(false)},onUpdate(){var s;return{outputs:Object.fromEntries((s=this.inputs.prototype.value)==null?void 0:s.split(",").filter(n=>n).map(n=>[n,()=>new dt(n,0)]))}}}),y4=[S4,$4,b4,T4].map(s=>[s,"对象"]),R4=An({type:"二元逻辑运算",inputs:{left:()=>new dt("A",0),right:()=>new dt("B",0),operator:()=>new ym("运算符","A大于B",["A大于B","A小于B","A等于B","A不等于B","A大于等于B","A小于等于B"])},outputs:{value:()=>new dt("输出值",0)}}),I4=An({type:"单元逻辑运算",inputs:{value:()=>new dt("值",0),operator:()=>new ym("运算符","!",["取反"])},outputs:{value:()=>new dt("输出值",0)}}),C4=An({type:"三元逻辑运算",inputs:{condition:()=>new dt("条件",0),trueValue:()=>new ei("真值",""),falseValue:()=>new ei("假值","")},outputs:{value:()=>new dt("输出值",0)}}),O4=[R4,I4,C4].map(s=>[s,"逻辑"]),k4=Em({type:"字符串模板",inputs:{template:()=>new ei("模板","").setPort(false)},outputs:{value:()=>new dt("输出","")},onUpdate({template:s}){const n=s.match(/%.+?%/g);return{inputs:n?Object.fromEntries(n.map(i=>i.slice(1,-1)).map(i=>[i,()=>new ei(i,"")])):void 0}}}),w4=[k4].map(s=>[s,"字符串"]),A4=An({type:"数字常量/转为数字",inputs:{value:()=>new ei("输入","0")},outputs:{value:()=>new dt("输出","0")}}),L4=[A4].map(s=>[s,"数字"]),N4=An({type:"队列",inputs:{value:()=>new dt("输入值",0),length:()=>new ei("长度","10").setPort(false)},outputs:{value:()=>new dt("队列输出",0),overflow:()=>new dt("溢出",0)}}),M4=[N4].map(s=>[s,"数据结构"]),D4=An({type:"HTTP",inputs:{url:()=>new ei("URL",""),method:()=>new ym("方法","GET",["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS"]).setPort(false),headers:()=>new dt("头部",0),body:()=>new dt("主体",0)},outputs:{code:()=>new dt("状态码",0),body:()=>new dt("返回体",0),headers:()=>new dt("返回头部",0)}}),x4=[D4].map(s=>[s,"接口"]),B4=[...v4,...y4,...O4,...w4,...L4,...M4,...x4],P4={style:{height:"100%",width:"100%"}},U4={style:{width:"100%",height:"100%"}},F4=Xe({__name:"data-flow",setup(s){const n=Ee(null);return Ws(()=>{const i=f4(ue(n));console.info(i),B4.forEach(o=>i.editor.registerNodeType(o[0],{category:o[1]}))}),(i,o)=>(oe(),be("div",P4,[o[0]||(o[0]=he("div",{style:{width:"100%",padding:"5px","padding-left":"20px",height:"25px"}},[he("button",{class:"menu-button"},"退出编辑模式")],-1)),he("div",U4,[he("div",{style:{height:"100%"},ref_key:"baklava_workspace",ref:n},null,512)])]))}});const G4=sr(F4,[["__scopeId","data-v-ce5b8a22"]]),H4={style:{display:"flex","flex-flow":"column nowrap",height:"100%",width:"100%"}},V4={style:{height:"100%",display:"flex","flex-flow":"column"}},W4={style:{height:"100%"}},z4={style:{position:"fixed",bottom:"0",top:"0",right:"0",width:"400px","background-color":"#ffffff7a","z-index":"1000","backdrop-filter":"blur(50px)","box-shadow":"9px -7px 20px 0px black","background-size":"50px"}},j4={style:{height:"25px",background:"var(--bg1)",display:"flex",width:"100%","z-index":"999"}},X4={style:{"margin-left":"auto","align-self":"center",height:"100%","margin-right":"20px"}},K4=Xe({__name:"index",setup(s){const n=Ee({import:false,export:false}),i=Ee(null),o=Ee(void 0),l=Ee(false),g=Ee(false),m=Ee(false),u=Ee("blockly"),p=Ee({}),c=Ee(null),d=Ee("hidden");let _=Ee({build:'点击左侧"编译插件"查看'}),b=null;async function $(){await rR(o.value,i.value)}function E(){b&&clearTimeout(b),b=setTimeout(()=>{$(),b=null},1e3)}Ws(()=>{Ct(o,async(f,v)=>{if(!f)return;l.value=true;const T=await wn("load-blockly-block",parseInt(f.toString()));l.value=false,await rs(()=>{i.value.load(T)}),_.value.build='点击左侧"编译插件"查看'}),Ct(d,async(f,v)=>{if(![f,v].includes("hidden"))return;const T=setInterval(()=>{console.info("resize"),i.value.updateSize()},10);setTimeout(()=>{clearInterval(T)},1e3)}),rs(()=>{i.value.setAutoSaveListener(E)})});async function y(f,v){const T=await iB(f,v);T&&(o.value=T)}return(f,v)=>{const T=ht("k-empty"),S=ht("k-layout");return oe(),be(Pt,null,[Me(vk,{modelValue:n.value.import,"onUpdate:modelValue":v[0]||(v[0]=R=>n.value.import=R),onCallback:y},null,8,["modelValue"]),Me(bk,{modelValue:n.value.export,"onUpdate:modelValue":v[1]||(v[1]=R=>n.value.export=R)},null,8,["modelValue"]),Me(S,{class:"page-blockly"},{header:je(()=>{var R,O;return[xt(" Blockly - "+Bt(((O=(R=ue(Jn).blockly.filter(A=>{var L,I;return((L=A.id)==null?void 0:L.toString())===((I=o.value)==null?void 0:I.toString())}))==null?void 0:R[0])==null?void 0:O.name)??"主页")+" "+Bt(m.value?"保存中...":""),1)]}),left:je(()=>[Me(lB,{blocks:ue(Jn).blockly,current:o.value,"onUpdate:current":v[2]||(v[2]=R=>o.value=R),workspace:i.value,panel:ue(_),dialog:n.value,logger:c.value},null,8,["blocks","current","workspace","panel","dialog","logger"])]),default:je(()=>[he("div",H4,[he("div",V4,[o.value===void 0&&!g.value?(oe(),Je(T,{key:0},{default:je(()=>v[13]||(v[13]=[he("div",null,"在左侧选择或创建一个Blockly代码",-1)])),_:1})):qe("v-if",true),ci((oe(),Je(gk,null,[Me(BF,{ref_key:"editor",ref:i,flow:p.value,"onUpdate:flow":v[3]||(v[3]=R=>p.value=R),workspace:u.value,"onUpdate:workspace":v[4]||(v[4]=R=>u.value=R)},null,8,["flow","workspace"])],1536)),[[Fi,(u.value==="blockly"||u.value==="meta")&&o.value!=null&&!l.value||g.value]]),ci(he("div",W4,[Me(G4,{flow:p.value,"onUpdate:flow":v[5]||(v[5]=R=>p.value=R),workspace:u.value,"onUpdate:workspace":v[6]||(v[6]=R=>u.value=R)},null,8,["flow","workspace"])],512),[[Fi,u.value==="data-flow"&&o.value!=null&&!l.value||g.value]]),Me(oc,{name:"meta-ui-change",persisted:""},{default:je(()=>[ci(he("div",z4,[Me(bB,{workspace:u.value,"onUpdate:workspace":v[7]||(v[7]=R=>u.value=R),current:o.value,onMetaChange:v[8]||(v[8]=R=>E())},null,8,["workspace","current"])],512),[[Fi,u.value==="meta"&&o.value!=null&&!l.value||g.value]])]),_:1}),qe(` <div v-show="workspaceType === 'meta' && (currentId!=null && !loading )|| init" style="height: 100%">\r
        <plugin-meta v-model:workspace="workspaceType" :current="currentId" @metaChange="save()"></plugin-meta>\r
      </div> `),ci(he("div",null,[o.value===void 0&&!g.value?(oe(),Je(T,{key:0},{default:je(()=>v[14]||(v[14]=[he("div",null,"Loading...",-1)])),_:1})):qe("v-if",true)],512),[[Fi,l.value&&!g.value]])]),o.value!=null?(oe(),be("div",{key:0,class:"transition-animation",style:Js([{"border-top":"3px solid var(--bg1)",display:"flex","flex-flow":"column nowrap"},{height:d.value.toString()==="hidden"?"25px":"40%"}])},[he("div",j4,[he("div",{style:Js([{height:"100%",display:"inline-flex","align-self":"center","padding-left":"20px","padding-right":"20px","border-radius":"4px 4px 0px 0px",cursor:"pointer"},{background:d.value=="build"?"var(--bg3)":""}]),onClick:v[9]||(v[9]=R=>d.value="build")},"编译",4),he("div",{style:Js([{height:"100%",display:"inline-flex","align-self":"center","padding-left":"20px","padding-right":"20px","border-radius":"4px 4px 0px 0px",cursor:"pointer"},{background:d.value=="result"?"var(--bg3)":""}]),onClick:v[10]||(v[10]=R=>d.value="result")},"代码结果",4),he("div",{style:Js([{height:"100%",display:"inline-flex","align-self":"center","padding-left":"20px","padding-right":"20px","border-radius":"4px 4px 0px 0px",cursor:"pointer"},{background:d.value=="log"?"var(--bg3)":""}]),onClick:v[11]||(v[11]=R=>d.value="log")},"运行日志",4),he("div",X4,[he("div",{style:{height:"18px",width:"18px",background:"var(--bg1)",padding:"2px",margin:"2px"},onClick:v[12]||(v[12]=R=>d.value="hidden")},[Me(BG)])])]),ci(he("div",{style:Js([{overflow:"scroll",color:"var(--fg2)",height:"100%",width:"100%",contain:"size"},{background:d.value==="build"?"black":"var(--bg2)"}]),class:"scroll"},[ci(Me(FF,{current:o.value,ref_key:"build_console",ref:c,style:{margin:"6px"}},null,8,["current"]),[[Fi,d.value==="build"]]),d.value!="hidden"?ci((oe(),Je(NG,{key:0,current:o.value,blocklyInformation:ue(_)},null,8,["current","blocklyInformation"])),[[Fi,d.value==="result"]]):qe("v-if",true)],4),[[Fi,d.value!="hidden"]])],4)):qe("v-if",true)])]),_:1})],64)}}});const Y4=sr(K4,[["__scopeId","data-v-a29ffaa1"]]),q4={},J4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"};function Z4(s,n){return oe(),be("svg",J4,n[0]||(n[0]=[he("path",{fill:"currentColor",d:"M411.8 207.8C406.2 217.8 395.5 223.1 384 223.1H192C180.5 223.1 169.8 217.8 164.2 207.8C158.5 197.7 158.6 185.4 164.6 175.5L260.6 15.54C266.3 5.897 276.8 0 288 0C299.2 0 309.7 5.898 315.4 15.54L411.4 175.5C417.4 185.4 417.5 197.7 411.8 207.8V207.8zM288 31.1L192 191.1H384L288 31.1zM472 271.1C494.1 271.1 512 289.9 512 311.1V456C512 478.1 494.1 496 472 496H328C305.9 496 288 478.1 288 456V311.1C288 289.9 305.9 271.1 328 271.1H472zM472 303.1H328C323.6 303.1 320 307.6 320 311.1V456C320 460.4 323.6 464 328 464H472C476.4 464 480 460.4 480 456V311.1C480 307.6 476.4 303.1 472 303.1zM256 384C256 454.7 198.7 512 128 512C57.31 512 0 454.7 0 384C0 313.3 57.31 255.1 128 255.1C198.7 255.1 256 313.3 256 384zM128 287.1C74.98 287.1 32 330.1 32 384C32 437 74.98 480 128 480C181 480 224 437 224 384C224 330.1 181 287.1 128 287.1z"},null,-1)]))}const Q4=sr(q4,[["render",Z4]]);nk.register("blockly",Q4);const d5=s=>{s.page({name:"Blockly 可视化编程",path:"/blockly",icon:"blockly",authority:5,component:Y4,fields:["blockly"]})};export{d5 as default};
